---
title: Ordinal date
jupyter:
  jupytext:
    encoding: '// -*- coding: utf-8 -*-'
    text_representation:
      extension: .qmd
      format_name: quarto
      format_version: '1.0'
      jupytext_version: 1.16.4
  kernelspec:
    display_name: Deno
    language: typescript
    name: deno
    path: /Users/martinlaptev/Library/Jupyter/kernels/deno
---


\| [Martin Laptev]()  
2024+194

My website serves as a demonstration of both the
[Quarto](https://quarto.org) publishing system and the [Dec](../../dec)
measurement system. I use several clever hacks to get Quarto to display
all of the dates on my website in the Dec `year+day` format. Even if you
are not interested in Dec dates, you may still benefit from learning
about Quarto document customization via
[filters](https://quarto.org/docs/extensions/filters.html), [render
scripts](https://quarto.org/docs/projects/scripts.html#pre-and-post-render),
and [include
files](https://quarto.org/docs/output-formats/html-basics.html#includes).

### Dec dates

Dec dates are similar to [ISO
8601](https://en.wikipedia.org/wiki/ISO_8601#:~:text=an%20international%20standard%20covering%20the%20worldwide%20exchange%20and%20communication%20of%20date%20and%20time%2Drelated%20data)
[ordinal
dates](https://en.wikipedia.org/wiki/ISO_8601#Ordinal_dates:~:text=an%20ordinal%20format%20for%20the%20multiples%20of%20a%20day%20elapsed%20since%20the%20start%20of%20year)
in that both count the days since the start of the year. Despite this
similarity, ISO 8601 and Dec dates differ in their
[epoch](https://en.wikipedia.org/wiki/Epoch#:~:text=an%20instant%20in%20time%20chosen%20as%20the%20origin%20of%20a%20particular%20calendar%20era),
[intercalation](https://en.wikipedia.org/wiki/Intercalation_(timekeeping)#:~:text=the%20insertion%20of%20a%20leap%20day%2C%20week%2C%20or%20month)
system, and choice of
[delimiter](https://en.wikipedia.org/wiki/Delimiter#:~:text=a%20sequence%20of%20one%20or%20more%20characters%20for%20specifying%20the%20boundary%20between%20separate%2C%20independent%20regions%20in%20plain%20text).

The Dec epoch, <span class="blue" data-bs-toggle="tooltip"
data-bs-title="0000-03-01"><u>Year 0 Day 0</u></span>, is 60 days after
the ISO 8601 epoch, <span class="blue" data-bs-toggle="tooltip"
data-bs-title="0000-01-01"><u>Year -1 Day 306</u></span>. This 60-day
shift enables the `day` in `year+day` to function independently of the
`year` as the date of annual events such as anniversaries.

Use the sliders below to select a special date like your birthdayüéÇ! You
can also press the Play‚ñ∂Ô∏èbutton and then sit back and watch the sliders
cycleüîÑback and forth through every day of the year and see the
corresponding month and day of the month values.

The sliders cycle through an entire year in 36.5 beats, a million times
fasterüèéÔ∏èthan the actual speed of time! A Dec beat is a centimilliday (1%
of a milliday) and 86.4% as long as a second and can be thought of as a
heart‚ù§Ô∏èbeat or
musicalüéµ[beat](https://en.wikipedia.org/wiki/Beat_(music)#:~:text=the%20beat%20is%20the%20basic%20unit%20of%20time)
with a constant
[rate](https://en.wikipedia.org/wiki/Heart_rate#:~:text=The%20American%20Heart%20Association%20states%20the%20normal%20resting%20adult%20human%20heart%20rate%20is%2060%2D100%20bpm.)
or
[tempo](https://en.wikipedia.org/wiki/Tempo#Basic_tempo_markings:~:text=Adagietto%20%E2%80%93%20slower%20than,56%E2%80%93108%C2%A0bpm)
of 69.4ÃÖ beats per minute. In addition to displaying time on
clocksüï∞Ô∏èand‚åöÔ∏èwatches, `beats` can be used to measure durations, such as
the time since this webpage was loaded:
<span id="ojs-element-id-1"></span>.



For example, the current day of the year (doty) is Day
<span id="ojs-element-id-2"></span>.

simplest way to describe Dec dates my website are based on the
[Gregorian
calendar](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world),
but any calendar with fixed rules can be turned in a Dec calendar
(Decalendar) by expressing its dates as zero-based moving its starting
point ().

The various Decalendars can have different
[epochs](https://en.wikipedia.org/wiki/Epoch#:~:text=an%20instant%20in%20time%20chosen%20as%20the%20origin%20of%20a%20particular%20calendar%20era),
[year
lengths](https://en.wikipedia.org/wiki/Year#:~:text=the%20mean%20length%20of%20the%20Gregorian%20calendar%20year%20is%20365.2425%20days),
and [leap year
rules](https://en.wikipedia.org/wiki/Leap_year#:~:text=Every%20year%20that%20is%20exactly%20divisible%20by%20four%20is%20a%20leap%20year%2C%20except%20for%20years%20that%20are%20exactly%20divisible%20by%20100%2C%20but%20these%20centurial%20years%20are%20leap%20years%20if%20they%20are%20exactly%20divisible%20by%20400).
It should be possible to decalenderize any
[rule-based](https://en.wikipedia.org/wiki/Rule-based_system#:~:text=a%20computer%20system%20in%20which%20domain%2Dspecific%20knowledge%20is%20represented%20in%20the%20form%20of%20rules%20and%20general%2Dpurpose%20reasoning%20is%20used%20to%20solve%20problems%20in%20the%20domain)
calendar system, but
[lunisolar](https://en.wikipedia.org/wiki/Lunisolar_calendar#:~:text=indicates%20both%20the%20Moon%20phase%20and%20the%20time%20of%20the%20solar%20year)
decalendars are likely to be more difficult to implement than
[solar](https://en.wikipedia.org/wiki/Solar_calendar#:~:text=a%20calendar%20whose%20dates%20indicate%20the%20season)
and
[lunar](https://en.wikipedia.org/wiki/Lunar_calendar#:~:text=a%20calendar%20based%20on%20the%20monthly%20cycles%20of%20the%20Moon%27s%20phases)
decalendars because of the complexity of their
[intercalation](https://en.wikipedia.org/wiki/Intercalation_%28timekeeping%29#:~:text=the%20insertion%20of%20a%20leap%20day%2C%20week%2C%20or%20month%20into%20some%20calendar%20years%20to%20make%20the%20calendar%20follow%20the%20seasons%20or%20moon%20phases)
calculations.

with simple arithmetic, Decalendar is
[perennial](https://en.wikipedia.org/wiki/Perennial_calendar#:~:text=applies%20to%20any%20year%2C%20keeping%20the%20same%20dates),
meaning that its features remain the same every year. Any

Unlike ISO 8601 ordinal dates, Dec dates are based on the Dec calendar
(Decalendar), a [perennial
calendar](https://en.wikipedia.org/wiki/Perennial_calendar#:~:text=applies%20to%20any%20year%2C%20keeping%20the%20same%20dates),
meaning that they are the same in every year, and thus can omit the year
without becoming ambiguous. In contrast, ISO 8601 ordinal dates is
omitted, susceptible to [off-by-one
errors](https://en.wikipedia.org/wiki/Off-by-one_error#:~:text=a%20logic%20error%20that%20involves%20a%20number%20that%20differs%20from%20its%20intended%20value%20by%20%2B1%20or%20%E2%88%921).
For example, the current day of the year.

This major Dec dates can be omit the year and still be unequivocally
converted into a month and a day [start counting days from
zero](https://en.wikipedia.org/wiki/Zero-based_numbering#:~:text=a%20way%20of%20numbering%20in%20which%20the%20initial%20element%20of%20a%20sequence%20is%20assigned%20the%20index%C2%A00)
and do not need omit the year .

The first of the Dec year, [Day 0](), corresponds to Day 59 or Day 60
have a different starting point while ISO 8601 ordinal dates start
counting [from one](). Unlike ISO 8601 ordinal dates, Dec dates can omit
the year and still be useful. are zero-based and can the ordinal day
component of Dec dates can be unequivocally converted into [Gregorian
calendar](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)
dates Dec addresses the two major flaws of the by moving the start of
the year to March 1. When Leap Day is the last day of the year, the day
numbers (indexes) used by Decalendar remain constant year to year.
Starting the year on March 1 also brings Decalendar in better alignment
with the [metereological
seasons](https://en.wikipedia.org/wiki/Season#:~:text=meteorological%20seasons%20are%20reckoned%20by%20temperature%2C%20with%20summer%20being%20the%20hottest%20quarter%20of%20the%20year%20and%20winter%20the%20coldest%20quarter%20of%20the%20year).

Dec dates overcome several major flaws with the Gregorian calendar. The
`day` in `year+day` dates is referred to as the ‚Äúday of the year‚Äù or
doty.

a single number that can identify specific days of the year (like months
and days of the month) and coordinate schedules of work and rest days
(like weeks and days of the week). Essentially, Dec greatly simplifies
the [Gregorian
calendar](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)
by replacing months and weeks with units called deks.

[Gregorian
calendar](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)
dates are not aligned with the days of the week. In contrast, the day of
the dek (dotd) is simply the last digit of the `day` number in the .y
format.

The `day` in `year+day` dates is a single number that can identify
specific days of the year (like months and days of the month) and
coordinate schedules of work and rest days (like weeks and days of the
week). Essentially, Dec greatly simplifies the [Gregorian
calendar](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)
by replacing months and weeks with units called deks.

Unlike months and weeks, deks are 10 days long and thus work well with
our decimal number system. The dek and day of the dek are provided by
the first two digits and the last digit of the 3-digit `day` number in
Dec dates, respectively. For example, the current dek is Dek
<span id="ojs-element-id-7"></span> and the current day of the dek is
Day <span id="ojs-element-id-3"></span>.

The most prominent Dec date on my site is the one in the Dec
[timestamp](https://en.wikipedia.org/wiki/Timestamp#:~:text=a%20sequence%20of%20characters%20or%20encoded%20information%20identifying%20when%20a%20certain%20event%20occurred)
in [navigation
bar](https://en.wikipedia.org/wiki/Navigation_bar#:~:text=a%20section%20of%20a%20graphical%20user%20interface%20intended%20to%20aid%20visitors%20in%20accessing%20information)
(navbar) above: <span id="ojs-element-id-4"></span>. In this article, I
will focus only on Dec dates (<span id="ojs-element-id-5"></span>), but
I will discuss Dec times (<span id="ojs-element-id-6"></span>) in the
[next article](../../dec/time) in the [Measurement section](../../dec).

Dec dates are based on the decimal year date equation:
$\lfloor\colorbox{yellow}{y}\rfloor{+}\colorbox{cyan}{d}{\div}\colorbox{orange}{n}{=}\colorbox{yellow}{y}$.
In this equation, $\lfloor\colorbox{yellow}{y}\rfloor$ is the year,
$\colorbox{cyan}{d}$ is the day of the year, $\colorbox{orange}{n}$ is
the total number of days in the year, and the $\colorbox{yellow}{y}$ is
the decimal year.

Dates in the `year+day` format only include the first two terms from the
decimal year date equation ($\colorbox{yellow}{y}$ and
$\colorbox{cyan}{d}$), because $\colorbox{orange}{n}$ is not needed to
identify a specific date in time, only has 2 possible values (365 or
366), remains constant for long periods of time (366, 1095, or 2920
days), and can be determined by applying the [Gregorian
calendar](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)
[leap year
rule](https://en.wikipedia.org/wiki/Leap_year#:~:text=Every%20year%20that%20is%20exactly%20divisible%20by%20four%20is%20a%20leap%20year%2C%20except%20for%20years%20that%20are%20exactly%20divisible%20by%20100%2C%20but%20these%20centurial%20years%20are%20leap%20years%20if%20they%20are%20exactly%20divisible%20by%20400)
to the subsequent year ($\lfloor\colorbox{yellow}{y}\rfloor{+}1$):

$\colorbox{orange}{n}=\begin{cases}
  366&{\begin{align}\text{if } (\lfloor \colorbox{yellow}{y}\rfloor+1)\text{ \% }4=0\\
  \land(\lfloor \colorbox{yellow}{y}\rfloor+1)\text{ \% }100\neq0\\
  \lor(\lfloor \colorbox{yellow}{y}\rfloor+1)\text{ \% }400=0\end{align}}\\
  365&{\text{otherwise.}}\end{cases}$

I generate all of the dates on my site from [UNIX
time](https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201st%C2%A0January%201970%2C%20the%20Unix%20epoch)
using calculations that I adapted from the
[`civil_from_days`](https://howardhinnant.github.io/date_algorithms.html#civil_from_days)
function in [Howard Hinnant](https://howardhinnant.github.io)‚Äôs [`date`
library](https://howardhinnant.github.io/date/date.html). Each tab in
the [tabset
panel](https://quarto.org/docs/interactive/layout.html#:~:text=Tabset%20Panel,-If%20you%20want%20to%20allow)
below shows a different implementation of a function called `unix2date`
which converts UNIX time into `year+day` dates.

In this function, `socy` is an abbreviation for solar cycle and `dote`,
`dotc`, and `yotc` are acronyms for ‚Äúday of the era‚Äù, ‚Äúday of the
cycle‚Äù, and ‚Äúday of the cycle‚Äù, respectively. A solar cycle in the
Gregorian calendar is [400
years](https://en.wikipedia.org/wiki/Solar_cycle_%28calendar%29#:~:text=400%2Dyear%20cycle%20of%20the%20Gregorian%20calendar).
A [calendar
era](https://en.wikipedia.org/wiki/Calendar_era#:~:text=the%20period%20of%20time%20elapsed%20since%20one%20epoch%20of%20a%20calendar)
is the time that has passed since a starting point called a [calendar
epoch](https://en.wikipedia.org/wiki/Epoch#:~:text=an%20instant%20in%20time%20chosen%20as%20the%20origin%20of%20a%20particular%20calendar%20era).
The Dec epoch is <span class="blue" data-bs-toggle="tooltip"
data-bs-title="0000-03-01"><u>Year 0 Day 0</u></span>.

# JavaScript

```{typescript}
//| eval: false
//| tags: [js, func]
function unix2date(unix) {
  const dote = unix / 86400 + 719468,
    socy = Math.floor((
      dote >= 0 ? dote
      : dote - 146096
    ) / 146097),
  dotc = dote - socy * 146097,
  yotc = Math.floor((dotc
    - Math.floor(dotc / 1460)
    + Math.floor(dotc / 36524)
    - Math.floor(dotc / 146096)
  ) / 365);
  return [
    yotc + socy * 400,
    dotc - (yotc * 365
      + Math.floor(yotc / 4)
      - Math.floor(yotc / 100)
  )]}
```

```{typescript}
//| eval: false
//| tags: [js, out0]
unix2date(1728000000)
```

```{typescript}
//| eval: false
//| tags: [js, out1]
unix2date(1890000000)
```

I use different programming languages to convert UNIX time in various
places on my site. More specifically, I use a
[Python](https://en.wikipedia.org/wiki/Python_%28programming_language%29#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%20programming%20language)
[post-render
script](https://quarto.org/docs/projects/scripts.html#pre-and-post-render)
([date.py](../../asset/date.py)) for the dates on the [page that lists
all of the articles on my site](../../list), a
[Lua](https://en.wikipedia.org/wiki/Lua_(programming_language)#:~:text=a%20lightweight%2C%20high%2Dlevel%2C%20multi%2Dparadigm%20programming%20language%20designed%20mainly%20for%20embedded%20use%20in%20applications)
[filter](https://quarto.org/docs/extensions/filters.html)
([date.lua](../../asset/date.lua)) for the PUBLISHED date at the top of
each article, and an [include-after-body
file](https://quarto.org/docs/output-formats/html-basics.html#includes)
that sources a
[JavaScript](https://en.wikipedia.org/wiki/JavaScript#:~:text=a%20programming%20language%20and%20core%20technology%20of%20the%20Web)
file ([stamp.js](../../asset/stamp.js)) for the date in the above.
[citation](http://localhost:4207/dec/date/#citation) information at the
bottom of each article.


```{typescript}
transformInput = function(target, {bind: source, transform = identity, involutory = false, invert = involutory ? transform : inverse(transform)} = {}){
  if (source === undefined) {
    source = target;
    target = html`<div>${source}</div>`;
  }
  function sourceInputHandler() {
    target.removeEventListener("input", targetInputHandler);
    setTransform(target).to(transform(source.value)).andDispatchEvent();
    target.addEventListener("input", targetInputHandler);
  }
  function targetInputHandler() {
    source.removeEventListener("input", sourceInputHandler);
    setTransform(source).to(invert(target.value)).andDispatchEvent();
    source.addEventListener("input", sourceInputHandler);
  }
  source.addEventListener("input", sourceInputHandler);
  target.addEventListener("input", targetInputHandler);
  invalidation.then(() => {
    source.removeEventListener("input", sourceInputHandler);
    target.removeEventListener("input", targetInputHandler);
  });
  sourceInputHandler();
  return target;
}
setTransform = (input) => ({to: (value) => (input.value = value, {andDispatchEvent: (event = new Event("input")) => input.dispatchEvent(event)})});
function inverse(f) {
  switch (f) {
    case identity:  return identity;
    case Math.sqrt: return square;
    case Math.log:  return Math.exp;
    case Math.exp:  return Math.log;
    default:        return (x => solve(f, x, x));
  }
  function solve(f, y, x = 0) {
    const dx = 1e-6;
    let steps = 100, deltax, fx, dfx;
    do {
      fx = f(x)
      dfx = (f(x + dx) - fx) || dx;
      deltax = dx * (fx - y)/dfx
      x -= deltax;
    } while (Math.abs(deltax) > dx && --steps > 0);
    return steps === 0 ? NaN : x;
  }
function square(x) {
    return x * x;
  }
}
function identity(x) {
  return x;
}
function doty2month(doty = 0) {
    const m = Math.floor((5 * doty + 2) / 153);
    return Math.floor(m < 10 ? m + 3 : m - 9);
}
function month2doty(month = 1) {
    return Math.floor(
        (153 * (month > 2 ? month - 3 : month + 9) + 2) / 5
)}
function doty2dotm(doty = 0) {
    const m = Math.floor((5 * doty + 2) / 153);
    return doty - Math.floor((153 * m + 2) / 5) + 1;
}
numbers = Array.from({length: 366}, (_, i) => i)
set(viewof inputDoty, scrubberDoty)
```

<script type='ojs-module-contents'>
eyJjb250ZW50cyI6WyAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c3R5bGVkVGlja1RpbWV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNvRGF0ZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTIifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY29bN119PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzdHlsZWREZWNvWWVhcjB9KyR7c3R5bGVkRGVjb0RhdGUwfSR7c3R5bGVkRGVjb1RpbWUwfS0ke3N0eWxlZFRpbWVab25lMH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTQifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3N0eWxlZERlY29ZZWFyMX0rJHtzdHlsZWREZWNvRGF0ZTF9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC01In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzdHlsZWREZWNvVGltZTF9LSR7c3R5bGVkVGltZVpvbmUxfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjby5zbGljZSg1LCA3KX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTcifV19
</script>
