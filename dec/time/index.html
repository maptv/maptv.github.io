<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Martin Laptev">
<meta name="description" content="Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.">
<title>Martin Laptev</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../dec/snap/index.html" rel="next">
<link href="../../dec/date/index.html" rel="prev">
<link href="../../asset/deidec.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-96bd41036a82b70f7743c798f1c088b0.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-ce626a2e7710b083b6b57c11c3078de5.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-96bd41036a82b70f7743c798f1c088b0.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b8561fa87ebd7d3b2115f6ffb148cf60.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-5f07e9596218e2c7fd069475271df3c7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-b8561fa87ebd7d3b2115f6ffb148cf60.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<meta name="mermaid-theme" content="default">
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<meta name="quarto:status" content="draft">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../asset/style.css">
<meta name="twitter:title" content="Martin Laptev">
<meta name="twitter:description" content="Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.">
<meta name="twitter:image" content="https://maptv.github.io/asset/daywide.svg">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><div id="quarto-draft-alert" class="alert alert-warning"><i class="bi bi-pencil-square"></i>Draft</div><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../asset/deidec.svg" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Martin Laptev</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <h1 class="quarto-secondary-nav-title no-breadcrumbs">Dec Time</h1>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-tools-main tools-wide">
    <a href="https://www.github.com/maptv" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/maptv" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-linkedin"></i></a>
    <a href="mailto:maptv@ireni.co" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope-at"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-house-door" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-info-circle" role="img">
</i> 
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cv/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-person" role="img">
</i> 
 <span class="menu-text">CV/R√©sum√©</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../list/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-grid-3x3-gap" role="img">
</i> 
 <span class="menu-text">Article List</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../dec/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-arrow-repeat" role="img">
</i> 
 <span class="menu-text">Dec</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/date/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-date" role="img">
</i> 
 <span class="menu-text">Date</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/time/index.html" class="sidebar-item-text sidebar-link active"><i class="bi bi-clock" role="img">
</i> 
 <span class="menu-text">Time</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/snap/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-postage" role="img">
</i> 
 <span class="menu-text">Snap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/span/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-range" role="img">
</i> 
 <span class="menu-text">Span</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false"><i class="bi bi-hourglass-split" role="img">
</i> 
 <span class="menu-text">History</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../history/ww2/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-2-square" role="img">
</i> 
 <span class="menu-text">World War 2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false"><i class="bi bi-robot" role="img">
</i> 
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ml/prob/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-dice-5" role="img">
</i> 
 <span class="menu-text">Probablity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ml/llm/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-translate" role="img">
</i> 
 <span class="menu-text">Language Models</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">Software</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../git/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-git" role="img">
</i> 
 <span class="menu-text">Git</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../jupyter/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-journal-richtext" role="img">
</i> 
 <span class="menu-text">Jupyter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../observable/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-0-circle" role="img">
</i> 
 <span class="menu-text">Observable</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../positron/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-p-square" role="img">
</i> 
 <span class="menu-text">Positron</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../quarto/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-markdown" role="img">
</i> 
 <span class="menu-text">Quarto</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/filter/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-funnel" role="img">
</i> 
 <span class="menu-text">Filter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/include/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-plus" role="img">
</i> 
 <span class="menu-text">Include</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/script/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-code" role="img">
</i> 
 <span class="menu-text">Script</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../reveal/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-slides" role="img">
</i> 
 <span class="menu-text">Reveal</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#fdt" id="toc-fdt" class="nav-link active" data-scroll-target="#fdt">Fractional day time</a>
  <ul>
<li><a href="#tac" id="toc-tac" class="nav-link" data-scroll-target="#tac">Ticking analog clocks</a></li>
  <li><a href="#bcc" id="toc-bcc" class="nav-link" data-scroll-target="#bcc">Bar chart clocks</a></li>
  <li><a href="#llm" id="toc-llm" class="nav-link" data-scroll-target="#llm">Longitude latitude map</a></li>
  <li><a href="#dac" id="toc-dac" class="nav-link" data-scroll-target="#dac">Daylight area chart</a></li>
  <li><a href="#tod" id="toc-tod" class="nav-link" data-scroll-target="#tod">Time of day (tod)</a></li>
  <li><a href="#doe" id="toc-doe" class="nav-link" data-scroll-target="#doe">Day of era (doe)</a></li>
  <li><a href="#hms" id="toc-hms" class="nav-link" data-scroll-target="#hms">Hour minute second</a></li>
  <li><a href="#tzo" id="toc-tzo" class="nav-link" data-scroll-target="#tzo">Time zone offset</a></li>
  <li><a href="#rdn" id="toc-rdn" class="nav-link" data-scroll-target="#rdn">Repeating decimal numbers</a></li>
  </ul>
</li>
  <li><a href="#utc" id="toc-utc" class="nav-link" data-scroll-target="#utc">Coordinated Universal Time (UTC)</a></li>
  <li><a href="#unit" id="toc-unit" class="nav-link" data-scroll-target="#unit">Unit</a></li>
  <li><a href="#next" id="toc-next" class="nav-link" data-scroll-target="#next">Next</a></li>
  <li><a href="#cite" id="toc-cite" class="nav-link" data-scroll-target="#cite">Cite</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/maptv/maptv.github.io/blob/main/dec/time/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Dec Time</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    <p>Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.</p>
  </div>
</div>


<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://maptv.github.io">Martin Laptev</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025+131</p>
    </div>
  </div>
  
    
  </div>
  


</header><div id="timenav">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {'theme': 'default', 'themeVariables': { 'fontSize': '32px'}}}%%
flowchart LR
   A[Dec]--&gt;B[date]--&gt;C[time]--&gt;D[snap]--&gt;E[span]
   click A "/dec"
   click B "/dec/date"
   click C "/dec/time"
   click D "/dec/snap"
   click E "/dec/span"
</pre>
</div>
<p></p>
</div>
</div>
</div>
</div>
<p>My website provides many examples of the <a href="https://quarto.org">Quarto</a> publishing and the <a href="../../dec">Dec</a> measurement systems in action. I leverage Quarto support for the <a href="https://observablehq.com/">Observable</a> data analysis and visualization system to create animated and interactive graphics like the <a href="https://en.wikipedia.org/wiki/Clock#:~:text=indicate%20time%20with%20a%20traditional%20clock%20face%20and%20moving%20hands">analog clocks</a>üïì, <a href="https://en.wikipedia.org/wiki/Bar_chart">barüìächarts</a>, <a href="https://en.wikipedia.org/wiki/Terminator_%28solar%29#:~:text=a%20moving%20line%20that%20divides%20the%20daylit%20side%20and%20the%20dark%20night%20side%20of%20a%20planetary%20body">solar‚òÄÔ∏èterminator</a> map, <a href="https://en.wikipedia.org/wiki/Earth%27s_orbit">Earthüåçorbit</a> diagram, and <a href="https://en.wikipedia.org/wiki/Daylight#:~:text=the%20combination%20of%20all%20direct%20and%20indirect%20sunlight%20during%20the%20daytime">daylight</a> <a href="https://en.wikipedia.org/wiki/Area_chart">area chart</a> below.</p>
<section id="fdt" class="level4 hiddenheading"><h4 class="hiddenheading anchored" data-anchor-id="fdt">Fractional day time</h4>
<p>Dec times are measured in <a href="https://en.wikipedia.org/wiki/Decimal_time#Fractional_days:~:text=a%20decimal%20fraction%20of%20a%20day">fractional days</a>. The shortest, longest, and thinnest clocküïìhands and the top, middle, and bottom barsüìäindicate the <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="thousandths of a day">millidays</span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day">centimillidays</span>, respectively, of the time since the start, <span class="point1"><span>+<span id="ojs-element-id-1"></span></span></span>, or until the end, <span class="point0"><span>-<span id="ojs-element-id-2"></span></span></span>, of the day in the Dec <a href="https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time">time zone</a>, <span><span id="ojs-element-id-3"></span>,</span> at the location of the red‚≠ïÔ∏ècircle on the mapüó∫Ô∏èbeneath the barsüìä.</p>
<section id="tac" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="tac">Ticking analog clocks</h5>
<div class="clocks">
<p><span><span id="ojs-element-id-4"></span></span></p>
</div>
</section><section id="bcc" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="bcc">Bar chart clocks</h5>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="58" data-source-offset="-51"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 57;"><span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>barChart <span class="op">=</span> {</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeats)))</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeats))</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDD)<span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDD))</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMils)<span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMils))</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 550 ? 12 : W &lt; 650 ? 14 : W &lt; 750 ? 16 : W &lt; 850 ? 18 : 20}px`)</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`+</span><span class="sc">${</span>barDD<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMils<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeats<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topbar"</span>)<span class="op">;</span></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>barChart1 <span class="op">=</span> {</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const scaleDek = d3.scaleLinear()</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .domain([0, 37])</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .range(xRange);</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>      <span class="co">// 'dek', 'dotd',</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeatsN)))</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeatsN))</span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDDN)<span class="op">+</span><span class="bu">Number</span>(barMilsN)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDDN))</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMilsN)<span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMilsN))</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 350 ? 12 : W &lt; 450 ? 14 : W &lt; 550 ? 16 : W &lt; 650 ? 18 : 20}px`)</span></span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`-</span><span class="sc">${</span>barDDN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMilsN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeatsN<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmbar"</span>)<span class="op">;</span></span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-325"><a href="#cb1-325" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</section><section id="llm" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="llm">Longitude latitude map</h5>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="331" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 330;"><span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>viewof location <span class="op">=</span> <span class="fu">worldMapCoordinates</span>([<span class="dv">162</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [width <span class="op">*</span> <span class="op">.</span><span class="dv">998</span><span class="op">,</span> ((<span class="dv">21</span> <span class="op">/</span> <span class="dv">40</span>) <span class="op">*</span> width)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
</section><section id="dac" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="dac">Daylight area chart</h5>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="340" data-source-offset="-68"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 339;"><span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> {</span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(width<span class="op">,</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">97</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">96</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">94</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">.</span><span class="dv">93</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">.</span><span class="dv">92</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">.</span><span class="dv">86</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">.</span><span class="dv">82</span> <span class="op">:</span> <span class="op">.</span><span class="dv">78</span>)))<span class="op">;</span></span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">style</span>(<span class="st">"user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"-webkit-user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"daylightapp"</span>)<span class="op">;</span></span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> {<span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">inner</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">;</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> contentWidth <span class="op">=</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">inner</span><span class="op">;</span></span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> columnWidth <span class="op">=</span> contentWidth <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> selection <span class="op">=</span> {</span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> date2022<span class="op">,</span></span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hour</span><span class="op">:</span> date2022<span class="op">.</span><span class="fu">getHours</span>()</span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderPlot <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#plot *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">select</span>(<span class="st">"#plot"</span>)<span class="op">.</span><span class="fu">call</span>(daylightPlot<span class="op">,</span> {</span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vizwidth</span><span class="op">:</span> columnWidth <span class="op">/</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.25</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.4</span> <span class="op">:</span> <span class="fl">1.48</span>)<span class="op">,</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>      <span class="dt">height</span><span class="op">:</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.6</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.58</span> <span class="op">:</span> <span class="fl">1.56</span>)<span class="op">,</span></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>      <span class="dt">year</span><span class="op">:</span> <span class="dv">2022</span><span class="op">,</span></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>      <span class="dt">latitude</span><span class="op">:</span> location[<span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultDate</span><span class="op">:</span> selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultHour</span><span class="op">:</span> selection<span class="op">.</span><span class="at">hour</span></span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderSolarSystem <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system"</span>)<span class="op">.</span><span class="fu">call</span>(solarSystem<span class="op">,</span></span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>                                        columnWidth <span class="op">*</span> <span class="fl">2.02</span><span class="op">,</span></span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>                                        location<span class="op">,</span></span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">hour</span><span class="op">,</span></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>                                        <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span>)<span class="op">;</span></span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const renderGlobe = () =&gt; {</span></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe *").remove();</span></span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe").call(globe, { vizwidth: columnWidth / 1.28, location, ...selection });</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> setSelection <span class="op">=</span> (newSelection<span class="op">,</span> forceRender <span class="op">=</span> <span class="kw">false</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prev <span class="op">=</span> {<span class="op">...</span>selection}<span class="op">;</span></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> newSelection<span class="op">;</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="at">value</span> <span class="op">=</span> selection<span class="op">;</span></span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedDate<span class="op">,</span> selection<span class="op">.</span><span class="at">date</span>)<span class="op">;</span></span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedHour<span class="op">,</span> selection<span class="op">.</span><span class="at">hour</span>)<span class="op">;</span></span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (forceRender) {</span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderPlot</span>()<span class="op">;</span></span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (prev<span class="op">.</span><span class="at">hour</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">hour</span> <span class="op">||</span> prev<span class="op">.</span><span class="at">date</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">date</span>) {</span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plot <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"plot"</span>)</span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">0</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>height <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">12</span> <span class="op">:</span> <span class="dv">5</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"solar-system"</span>)</span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">12</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">22</span> <span class="op">-</span> <span class="dv">6</span> <span class="op">-</span> <span class="dv">5</span> <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>  <span class="co">// svg.append("g")</span></span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("id", "globe")</span></span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("transform", `translate(${margin.left + margin.inner + columnWidth / 2 + 20}, ${margin.top + height / 1.2 + 4})`);</span></span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setSelection</span>(selection<span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateHourChange <span class="op">=</span> ({ target<span class="op">,</span> <span class="dt">detail</span><span class="op">:</span> { date<span class="op">,</span> hour }}) <span class="kw">=&gt;</span> {</span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (date <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> hour <span class="op">!=</span> <span class="kw">null</span>) <span class="fu">setSelection</span>({<span class="op">...</span>selection<span class="op">,</span> date<span class="op">,</span> hour})<span class="op">;</span></span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">addEventListener</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> handleDateHourChange<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@d3/simple-clock</span></span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@drio/lets-build-an-analog-clock</span></span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a>clock <span class="op">=</span> {</span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTime[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topclock"</span>)<span class="op">;</span></span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`+</span><span class="sc">${</span>decTime<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a>clock1 <span class="op">=</span> {</span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-677"><a href="#cb3-677" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb3-678"><a href="#cb3-678" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-679"><a href="#cb3-679" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-680"><a href="#cb3-680" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb3-681"><a href="#cb3-681" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb3-682"><a href="#cb3-682" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-683"><a href="#cb3-683" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-684"><a href="#cb3-684" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-685"><a href="#cb3-685" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-686"><a href="#cb3-686" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb3-687"><a href="#cb3-687" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-688"><a href="#cb3-688" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb3-689"><a href="#cb3-689" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-690"><a href="#cb3-690" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb3-691"><a href="#cb3-691" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-692"><a href="#cb3-692" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-693"><a href="#cb3-693" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-694"><a href="#cb3-694" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb3-695"><a href="#cb3-695" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-696"><a href="#cb3-696" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb3-697"><a href="#cb3-697" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-698"><a href="#cb3-698" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-699"><a href="#cb3-699" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-700"><a href="#cb3-700" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-701"><a href="#cb3-701" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb3-702"><a href="#cb3-702" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb3-703"><a href="#cb3-703" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb3-704"><a href="#cb3-704" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-705"><a href="#cb3-705" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-706"><a href="#cb3-706" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb3-707"><a href="#cb3-707" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb3-708"><a href="#cb3-708" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-709"><a href="#cb3-709" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-710"><a href="#cb3-710" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb3-711"><a href="#cb3-711" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTimeN[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-712"><a href="#cb3-712" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb3-713"><a href="#cb3-713" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb3-714"><a href="#cb3-714" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-715"><a href="#cb3-715" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb3-716"><a href="#cb3-716" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb3-717"><a href="#cb3-717" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb3-718"><a href="#cb3-718" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb3-719"><a href="#cb3-719" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb3-720"><a href="#cb3-720" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmclock"</span>)<span class="op">;</span></span>
<span id="cb3-721"><a href="#cb3-721" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb3-722"><a href="#cb3-722" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-723"><a href="#cb3-723" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`-</span><span class="sc">${</span>decTimeN<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb3-724"><a href="#cb3-724" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb3-725"><a href="#cb3-725" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb3-726"><a href="#cb3-726" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-727"><a href="#cb3-727" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb3-728"><a href="#cb3-728" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb3-729"><a href="#cb3-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb3-730"><a href="#cb3-730" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb3-731"><a href="#cb3-731" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb3-732"><a href="#cb3-732" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb3-733"><a href="#cb3-733" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb3-734"><a href="#cb3-734" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb3-735"><a href="#cb3-735" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-736"><a href="#cb3-736" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb3-737"><a href="#cb3-737" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-738"><a href="#cb3-738" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb3-739"><a href="#cb3-739" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-740"><a href="#cb3-740" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p>To rotate the globeüåêin the Earthüåèorbit diagram, drag the red‚≠ïÔ∏ècircle horizontally‚ÜîÔ∏éÔ∏èor slide the redüî¥dot on the daylight area chart vertically‚Üï. The red‚≠ïÔ∏ècircle‚Äôs vertical‚Üïposition determines the yearly daylight pattern visualized by the area chart. Shift the red<font color="red">‚Äî</font>line on the area chart horizontally‚ÜîÔ∏éÔ∏èto move the globeüåêalong the ellipse of the Earthüåéorbit.</p>
</section><section id="tod" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="tod">Time of day (tod)</h5>
<p>Dec times consist of a time-of-day (<span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span>) and a time zone: <span><span id="ojs-element-id-5"></span></span><span style="font-family:monospace;">‚Äì</span><span><span id="ojs-element-id-6"></span>.</span> The <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> denoted by the redüî¥dot is <span><span id="ojs-element-id-7"></span></span> days or <span><span id="ojs-element-id-8"></span></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>. The day-of-year (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day-of-year">doy</span>) indicated by the red<font color="red">‚Äî</font>line is <span><span id="ojs-element-id-9"></span>.</span> Together, a <span class="tool" data-bs-toggle="tooltip" data-bs-title="day-of-year">doy</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> form a floatingüõüsnapü´∞. Like <span class="tool" data-bs-toggle="tooltip" data-bs-title="times-of-day">tods</span>, floatingüõüsnapsü´∞can be expressed in days, <span><span id="ojs-element-id-10"></span>,</span> or <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>: <span><span id="ojs-element-id-11"></span>.</span></p>
<p>A floatingüõüsnapü´∞identifies a day in an unspecified year with its first three digits, classifies that day as a work or rest day with its third digit, and specifies a point in that day with its remaining digits, thus serving the same purposes as a <a href="https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world">Gregorian calendar</a> month and day-of-month (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day-of-month">dom</span>) pair, a day-of-week (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day-of-week">dow</span>), and an hour-minute-second (<span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span>) triplet.</p>
</section><section id="doe" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="doe">Day of era (doe)</h5>
<p>To turn a floatingüõüsnapü´∞into a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span>, we keep the remainder after dividing days by one or <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> by ten. We can use this same approach to obtain a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> from a day-of-<a href="https://en.wikipedia.org/wiki/Calendar_era#:~:text=the%20period%20of%20time%20elapsed%20since%20one%20epoch%20of%20a%20calendar">era</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="times-of-day">doe</span>), <span><span id="ojs-element-id-12"></span></span> <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 = <span><span id="ojs-element-id-13"></span>,</span> or <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span>-of-<a href="https://en.wikipedia.org/wiki/Calendar_era#:~:text=the%20period%20of%20time%20elapsed%20since%20one%20epoch%20of%20a%20calendar">era</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="times-of-day">ddoe</span>): <span><span id="ojs-element-id-15"></span></span> <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 10 = <span><span id="ojs-element-id-14"></span>.</span> The current <span class="tool" data-bs-toggle="tooltip" data-bs-title="day-of-era">doe</span> tells us how many days have passed since the Dec <a href="https://en.wikipedia.org/wiki/Epoch#:~:text=an%20instant%20in%20time%20chosen%20as%20the%20origin%20of%20a%20particular%20calendar%20era">epoch</a>.</p>
<p>Similarly, <a href="https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970%2C%20the%20Unix%20epoch">UNIX time</a> counts the seconds since the <a href="https://en.wikipedia.org/wiki/Unix_time#:~:text=00%3A00%3A00%20UTC%20on%201%C2%A0January%201970">UNIX epoch</a>. To get the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> in Zone <span class="color0">0</span>, the Dec time zone that is in between the two leftmost vertical lines on the mapüó∫Ô∏èabove, we can divide UNIX time by the <a href="https://en.wikipedia.org/wiki/Day#:~:text=average%2C%20this%20is-,24%20hours%20(86%2C400%20seconds),-.%20As%20a%20day">number of seconds in a day</a> or a <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> and then keep the remainder after dividing the resulting days by one or the resulting <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> by ten:</p>
<p><span class="math display">\[\text{day} = \text{unix} \div 86400 \text{ mod } 1\]</span></p>
<p><span class="math display">\[\text{deciday} = \text{unix} \div 8640 \text{ mod } 10\]</span></p>
<p>We can also derive a Zone <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> from a <a href="https://en.wikipedia.org/wiki/Julian_day#:~:text=the%20Julian%20day%20number%20plus%20the%20fraction%20of%20a%20day%20since%20the%20preceding%20noon">Julian date</a> simply by keeping the remainder after dividing by one. To convert days (<span class="tool" data-bs-toggle="tooltip" data-bs-title="days">d</span>) into <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>), we multiply by ten. If we want a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> instead of a Zone <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span>, we should add half a day (0.5 <span class="tool" data-bs-toggle="tooltip" data-bs-title="days">d</span>) to the Julian date before converting it to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> to ensure that the result is less than one <span class="tool" data-bs-toggle="tooltip" data-bs-title="days">d</span> or ten <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>:</p>
<p><span class="math display">\[\text{day} = (\text{julian} + 0.5) \text{ mod } 1\]</span></p>
<p><span class="math display">\[\text{deciday} = \text{day} \times 10\]</span></p>
<p>UNIX time and Julian dates yield <span class="tool" data-bs-toggle="tooltip" data-bs-title="times-of-day">tods</span> that are 5 <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span> apart because the UNIX epoch occurred at midnight (<span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>) and the Julian period started at <span class="color5" data-bs-toggle="tooltip" data-bs-title="decidays">noon</span> (<span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>). The table below shows the Dec, UNIX, Julian date, and <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) epochs in the <span style="font-family:monospace;">year+doy.tod-z</span> format of anchored‚öìÔ∏èsnapsü´∞, where <span style="font-family:monospace;">z</span> is a Dec time zone:</p>
<table class="table">
<colgroup>
<col style="width: 62%">
<col style="width: 37%">
</colgroup>
<thead><tr class="header">
<th>Epoch</th>
<th>&nbsp;<span style="font-weight:normal;"><span class="colorBkg" data-bs-toggle="tooltip" data-bs-title="Dec year">year</span><span style="font-family:monospace;">+</span><span class="colorBkg" data-bs-toggle="tooltip" data-bs-title="day-of-year">doy</span><span style="font-family:monospace;">.</span><span class="colorBkg" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span><span style="font-family:monospace;">-</span><span class="colorBkg" data-bs-toggle="tooltip" data-bs-title="Dec time zone">z</span></span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Dec</td>
<td>&nbsp;<span class="color0" data-bs-toggle="tooltip" data-bs-title="1 BC">0000</span><span style="font-family:monospace;">+</span><span class="color0" data-bs-toggle="tooltip" data-bs-title="March 1">000</span><span style="font-family:monospace;">.</span><span class="color0" data-bs-toggle="tooltip" data-bs-title="midnight">000</span><span style="font-family:monospace;">-</span><span class="color0" data-bs-toggle="tooltip" data-bs-title="Zone 0">0</span>
</td>
</tr>
<tr class="even">
<td>UNIX</td>
<td>&nbsp;<span class="color969">1969</span><span style="font-family:monospace;">+</span><span class="colorD306" data-bs-toggle="tooltip" data-bs-title="January 1">306</span><span style="font-family:monospace;">.</span><span class="color0" data-bs-toggle="tooltip" data-bs-title="midnight">000</span><span style="font-family:monospace;">-</span><span class="color0">0</span>
</td>
</tr>
<tr class="odd">
<td>Julian Day</td>
<td>-<span class="color287" data-bs-toggle="tooltip" data-bs-title="4714 BCE">4713</span><span style="font-family:monospace;">+</span><span class="colorD268" data-bs-toggle="tooltip" data-bs-title="November 24">268</span><span style="font-family:monospace;">.</span><span class="color5" data-bs-toggle="tooltip" data-bs-title="noon">500</span><span style="font-family:monospace;">-</span><span class="color0">0</span>
</td>
</tr>
<tr class="even">
<td>UTC</td>
<td>-<span class="color999" data-bs-toggle="tooltip" data-bs-title="2 BCE">0001</span><span style="font-family:monospace;">+</span><span class="colorD306" data-bs-toggle="tooltip" data-bs-title="January 1">306</span><span style="font-family:monospace;">.</span><span class="color0" data-bs-toggle="tooltip" data-bs-title="midnight">000</span><span style="font-family:monospace;">-</span><span class="color0">0</span>
</td>
</tr>
</tbody>
</table>
<p>In <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>, the length of Day <span class="colorD121" data-bs-toggle="tooltip" data-bs-title="June 30">121</span> or Day <span class="colorD305" data-bs-toggle="tooltip" data-bs-title="December 31">305</span> can vary due to <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>. In Dec, every day in always 86400 seconds or 100000 <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundred thousands of a day">centimillidays</span> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="centimillidays">beats</span>) long. If needed, Dec can include any number of leap seconds as part of a time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>. According to Dec, the <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color0">+00:00</span></a> time zone does not include any leap seconds because it has an offset of <span class="color0">0</span>.</p>
<p>To indicate that a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone includes the 27 leap seconds that have been added to <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> so far, Dec appends <span class="color1by320">:27</span> to its offset. The Dec equivalent of the <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color1by320">+00:00:27</span></a> time zone is Zone <span class="color1by320">1/320</span>.</p>
<p>this offset as T To represent the 27 leap seconds that have been added to <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> so far, Dec uses an offset of <span class="color1by320">1/320</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>. Dec refers to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone that has this offset as <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color1by320">+00:00:32</span></a>.</p>
<p>either or secon Since 1972+121, 27 positive leap seconds have been added to UTC, and 0 negative leap seconds have been whave been in a Julian date or a <span class="tool" data-bs-toggle="tooltip" data-bs-title="times-of-day">doe</span> i Dec does not allow The time in the ten Dec time zones never include</p>
<p>o depending on whether the leap second is p.&nbsp;Dec uses to represent <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> without changing the length of a day in the same way as leap days changes the length of a year. Instead of allowing the length of a day included, some <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> days will be 86401 or 86399 seconds long. So far, 27 positive leap seconds have been added, some <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> days will differ in length. includes of seconds, Dec uses beats. 100000 The programming languages that the <a href="https://quarto.org/docs/faq">Quarto FAQ</a> refers to as <a href="https://quarto.org/docs/faq/#:~:text=The%20principal%20languages%20supported%20by%20Quarto%20are%20Python%2C%20R%2C%20Julia%2C%20and%20Observable%20JavaScript">principal languages supported by Quarto</a>, <a href="https://en.wikipedia.org/wiki/Python_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%20programming%20language">Python</a> (Quarto principal languages), <a href="https://en.wikipedia.org/wiki/R_(programming_language)#:~:text=a%20programming%20language%20for%20statistical%20computing%20and%20data%20visualization">R</a>, <a href="https://en.wikipedia.org/wiki/Julia_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%5B17%5D%20dynamic%20programming%20language">Julia</a>, and <a href="http://observablehq.com">Observable</a> <a href="https://en.wikipedia.org/wiki/JavaScript#:~:text=a%20programming%20language%20and%20core%20technology%20of%20the%20World%20Wide%20Web">JavaScript</a>, do not include <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> in <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time. Therefore, a day in Even though the Dec, UNIX, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> epochs all occurred at midnight, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time may be shifted in relation to Dec or UNIX time because of <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>. Since 1972+121, 27</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Observable</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Julia</a></li>
</ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timezone</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> datetime.now(timezone.utc)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> hms.timestamp() <span class="op">/</span> <span class="dv">86400</span> <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>utc <span class="op">=</span> (</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    hms.hour <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    hms.minute <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    hms.second <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    hms.microsecond <span class="op">/</span> <span class="fl">864e8</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>hms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>datetime.datetime(2025, 7, 9, 18, 43, 4, 402241, tzinfo=datetime.timezone.utc)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>utc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.779912062974537</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>unix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7799120629751997</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">hms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span><span class="op">(</span><span class="va">sys</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span><span class="va">unix</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">sys</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">86400</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">1</span></span>
<span><span class="va">utc</span> <span class="op">&lt;-</span> <span class="va">hms</span><span class="op">$</span><span class="va">hour</span> <span class="op">/</span> <span class="fl">24</span> <span class="op">+</span></span>
<span>       <span class="va">hms</span><span class="op">$</span><span class="va">min</span> <span class="op">/</span> <span class="fl">1440</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">hms</span><span class="op">$</span><span class="va">sec</span><span class="op">)</span> <span class="op">/</span> <span class="fl">86400</span></span>
<span><span class="va">sys</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-07-09 13:45:51 CDT"</code></pre>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2025-07-09 18:45:51 UTC"</code></pre>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">utc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7818498</code></pre>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">unix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7818498</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-startfrom="831" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 830;"><span id="cb18-831"><a href="#cb18-831" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb18-832"><a href="#cb18-832" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> hms<span class="op">.</span><span class="fu">getTime</span>() <span class="op">/</span> <span class="fl">864e5</span> <span class="op">%</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb18-833"><a href="#cb18-833" aria-hidden="true" tabindex="-1"></a>utc <span class="op">=</span> hms<span class="op">.</span><span class="fu">getUTCHours</span>() <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span></span>
<span id="cb18-834"><a href="#cb18-834" aria-hidden="true" tabindex="-1"></a>      hms<span class="op">.</span><span class="fu">getUTCMinutes</span>() <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span></span>
<span id="cb18-835"><a href="#cb18-835" aria-hidden="true" tabindex="-1"></a>      hms<span class="op">.</span><span class="fu">getUTCSeconds</span>() <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span></span>
<span id="cb18-836"><a href="#cb18-836" aria-hidden="true" tabindex="-1"></a>      hms<span class="op">.</span><span class="fu">getUTCMilliseconds</span>() <span class="op">/</span> <span class="fl">864e5</span><span class="op">;</span></span>
<span id="cb18-837"><a href="#cb18-837" aria-hidden="true" tabindex="-1"></a>hms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-4" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb19" data-startfrom="838" data-source-offset="-198"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 837;"><span id="cb19-838"><a href="#cb19-838" aria-hidden="true" tabindex="-1"></a>unix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-5" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb20" data-startfrom="839" data-source-offset="-203"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 838;"><span id="cb20-839"><a href="#cb20-839" aria-hidden="true" tabindex="-1"></a>utc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-6" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Dates</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="fu">now</span>(UTC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-07-09T18:45:57.440</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> <span class="fu">datetime2unix</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">%</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7819148148155364</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>utc <span class="op">=</span> <span class="fu">hour</span>(hms) <span class="op">/</span> <span class="fl">24</span> <span class="op">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">minute</span>(hms) <span class="op">/</span> <span class="fl">1440</span> <span class="op">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">second</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">millisecond</span>(hms) <span class="op">/</span> <span class="fl">86400000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7819148148148148</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="hms" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="hms">Hour minute second</h5>
<p>We can make the time in any Dec time zone match UNIX by subtracting its time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>. The time in the Zone <span class="color0">0</span> Dec time zone always matches UNIX time. because neither includes <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>. Dec considers <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <a href="https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time">time zone</a> to also match UNIX time. If there is a <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> are not included. Dec handles leap seconds like an additional time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>. <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00:00</a></span> with 27 leap seconds is referred to as Zone 1/320 in Dec and . which</p>
<p><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color0">+00:00</span></a></p>
<p>To produce a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> from an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet, we get the difference between the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>, convert its components to either days or <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>, and sum the converted components.</p>
<p>and</p>
<p><span class="math display">\[\text{deciday} = \frac{\text{hour}}{2.4} + \frac{\text{minute}}{144} + \frac{\text{second}}{8640}\]</span></p>
<p><span class="math display">\[\text{day} = \frac{\text{hour}}{24} + \frac{\text{minute}}{1440} + \frac{\text{second}}{86400}\]</span></p>
<p>does not include <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> or a <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) <a href="https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time">time zone</a> <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> and</p>
<p>than <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12</a></span> will not match the time in any of the ten Dec time zones. We can create a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> by summing the components of an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet after</p>
<p>that were added a <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> time zone. A <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet that includes <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> or a</p>
</section><section id="tzo" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="tzo">Time zone offset</h5>
<p>To be compatible with Dec, a time zone offset must be equivalent to one of the ten positive single-digit integer <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> Dec offsets. The Zone <span class="color5">5</span> Dec time zone and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span> time zone have equivalent offsets: <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> = <span class="color5">12</span> hours. Likewise, the Zone <span class="color0">0</span> Dec time zone, UNIX time, and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> time zone all have an offset of <span class="color0">0</span>.</p>
<p>Apart from <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span>, all of the other <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones are incompatible with Dec.&nbsp;To find the <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> time difference <span class="math inline">\(\Delta\)</span> between a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone and its closest Dec time zone, convert the offset of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> and then calculate how much the converted offset changes after rounding it to the nearest <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span>.</p>
<p><span class="math display">\[\Delta = \text{offset} - \lfloor\text{offset} + 0.5\rfloor\]</span></p>
</section><section id="rdn" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="rdn">Repeating decimal numbers</h5>
<p>Dec expresses incompatible offsets as positive or negative fractions or multi-digit integers. <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets are either <a href="https://en.wikipedia.org/wiki/Repeating_decimal">repeating</a> or terminating decimal numbers. Dec displays repeating decimal offsets as fractions and terminating decimal offsets as integers. <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color333"><a href="https://en.wikipedia.org/wiki/UTC%2B08:00">+08:00</a></span>, the most populous <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone, has an offset of <span class="color333">.</span><span class="vinculum">3</span> days and is called Zone <span class="color333">1/3</span> in Dec.&nbsp;In contrast, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color125"><a href="https://en.wikipedia.org/wiki/UTC%2B03:00">+03:00</a></span> has an offset of <span class="color125">.125</span> days and is called Zone <span class="color125">125</span> in Dec.</p>
<p>Terminating decimal number offsets can be displayed by Dec provided there is enough space for the additional digits. Dec displays repeating decimal number offsets as fractions. The second most populous <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color333"><a href="https://en.wikipedia.org/wiki/UTC%2B05:30">+05:30</a></span>, translates to Zone <span class="color55by24">55/24</span> or Zone <span class="color55by24">2.291</span><span class="vinculum">6</span> in Dec.&nbsp;The top six most populous <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones all have positive offsets.</p>
<p>When it is midnight (tod=<span class="color0">0</span>) in Zone <span class="color0">0</span>, it is noon (tod=<span class="color5">5</span>) in Zone <span class="color5">5</span> and the time in every other time zone is equal to it it is ~<span class="color533">5.33</span> in Zone <span class="color333">10/3</span>, ~<span class="color429">4.29</span> in Zone <span class="color55by24">55/24</span>, and</p>
<p>To obtain the Zone <span class="color0">0</span> time, we evaluate any Dec time as a math expression, add 10, and then get the remainder after dividing by 10 to make sure the result is less than 10 <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>.</p>
<p>The use of incompatible offsets makes mental calculations involving time zones much harder. Also, incompatible offsets are more difficult to display and read in the format of Dec times. Despite these clear disadvantages, Dec will attempt to parse, process, and display any time zone offset that is provided. Incompatible offset that are repeating decimal numbers can be displayed as fractions, truncated numbers</p>
<p>noon in <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color333"><a href="https://en.wikipedia.org/wiki/UTC%2B08:00">+08:00</a></span> could be written as <span class="color5">5.00</span><span style="font-family:monospace;">-</span><span class="color333">10/3</span> or <span class="color5">5.00</span><span style="font-family:monospace;">-</span><span class="color333">3.</span><span class="vinculum">3</span>.</p>
<p>Dec does not set a hard limit on the number of time zones, but negative time zones offsets to improve its compability with <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bad Pun Alert
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sorry if reading this takes a long <strong><em>time</em></strong>; I hope you don‚Äôt <strong><em>zone</em></strong> out!</p>
</div>
</div>
<p>If a Dec time zone offset is not specified, we can detected a time zone using Whether or not negative time zones offsets are worth the trouble is a matter of that the offer little to no benefit. The <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude">-12:00</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span> time zones and the Zone <span class="color5">5</span> and <span class="color5">-5</span> Dec time zones all have the same time, but their dates do not match, because <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude">-12:00</a></span> and Zone <span class="color5">-5</span> are one day behind <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span> and Zone <span class="color5">5</span>. Dec discourages the use of time zones with negative offsets.</p>
<div class="cell /togs">
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="912" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 911;"><span id="cb27-912"><a href="#cb27-912" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb27-913"><a href="#cb27-913" aria-hidden="true" tabindex="-1"></a>viewof sortParams <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb27-914"><a href="#cb27-914" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort ascending"</span> })<span class="op">,</span></span>
<span id="cb27-915"><a href="#cb27-915" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort by offset"</span> })<span class="op">,</span></span>
<span id="cb27-916"><a href="#cb27-916" aria-hidden="true" tabindex="-1"></a>  ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="timezonepoptoggles" class="cell-output cell-output-display">
<div id="ojs-cell-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell stackedBar">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="923" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 922;"><span id="cb28-923"><a href="#cb28-923" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb28-924"><a href="#cb28-924" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb28-925"><a href="#cb28-925" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> width<span class="op">,</span></span>
<span id="cb28-926"><a href="#cb28-926" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb28-927"><a href="#cb28-927" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> <span class="vs">`overflow: visible;font-size:16px;`</span><span class="op">,</span></span>
<span id="cb28-928"><a href="#cb28-928" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {<span class="dt">scheme</span><span class="op">:</span> <span class="st">"RdBu"</span><span class="op">,</span> <span class="dt">className</span><span class="op">:</span> <span class="st">"barPlotLegend"</span>}<span class="op">,</span></span>
<span id="cb28-929"><a href="#cb28-929" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">75</span><span class="op">,</span></span>
<span id="cb28-930"><a href="#cb28-930" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span> }<span class="op">,</span></span>
<span id="cb28-931"><a href="#cb28-931" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Population (billions)"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">38</span><span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> d <span class="kw">=&gt;</span> d <span class="op">/</span> <span class="fl">1e9</span> }<span class="op">,</span></span>
<span id="cb28-932"><a href="#cb28-932" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb28-933"><a href="#cb28-933" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barX</span>(sortedPop<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"pop"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Sign"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"Offset"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">tip</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">,</span></span>
<span id="cb28-934"><a href="#cb28-934" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb28-935"><a href="#cb28-935" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="timezonepopstackedbar" class="cell-output cell-output-display">
<div id="ojs-cell-6" data-nodetype="expression">

</div>
</div>
</div>
</section></section><section id="utc" class="level4"><h4 class="anchored" data-anchor-id="utc">Coordinated Universal Time (UTC)</h4>
<p>The <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude">-12:00</a></span> time zone contains only <a href="https://en.wikipedia.org/wiki/Strict_nature_reserve#:~:text=the%20highest%20category%20of%20protected%20area%20recognised%20by%20the%20World%20Commission%20on%20Protected%20Areas">strict nature reserves</a> and thus does not have any inhabited territory.</p>
<p>The remaining UTC time zones with negative offsets</p>
<p>If we disregard leap seconds, the <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone is synchronized with UNIX time and the Zone <span class="color0">0</span> Dec time zone. The <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00">-12</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets have the same time but their dates are one day apart.</p>
<p>We can honor this difference by translating <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12</a></span> compatible <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets">37 <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets</a>, only 3 are integers after they are converted to time zones. Conversion between Dec time zones and UTC offsets is inexact, because UTC offsets depend on geographic and political boundaries, whereas Dec time zones are determined solely by longitude.</p>
<p>because UNIX time, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span>, and Zone <span class="color0">0</span> are all synchronized.</p>
<p>Similarly, a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet yields a Zone <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span>.</p>
<p><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span></p>
<p>Instead of passing an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> equation separately, we can subtract the offset from the triplet to produce a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet. In other words, we can avoid converting time zone offsets if we always first shift the input <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet to <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">+00:00</a></span>.</p>
<p>To obtain the Zone 0 time, we evaluate a Dec time as a math expression, add 10, and get the remainder after dividing by 10 to make sure the result is less than 10 <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a>: (<span class="cyan"><span><span id="ojs-element-id-16"></span></span></span> <span><span id="ojs-element-id-17"></span></span> <span class="lime"><span><span id="ojs-element-id-18"></span></span></span> + 10) <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 10 = <span class="cyan"><span><span id="ojs-element-id-19"></span></span></span>.</p>
<p>Instead of passing both a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplets and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span> equation.</p>
<p>Instead of performing this calculation on both a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>, we should subtract the offset from the triplet.</p>
<p>equation should be a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet so that we do not have to convert a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> to <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a>.</p>
<p>When we add a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offset to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet, with the resulting <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> time.</p>
<p>The time in Zone <span class="color0">0</span> matches UTC time with the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> offset. UNIX time and three <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets are called <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">UTC</a></span><span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00">UTC</a></span><span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00">-12:00</a></span>. Starting with a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet results in Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time-of-day">tod</span>.</p>
<p>only three out of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones are synchronized with a Dec time zone it will most likely be easier to shift the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour-minute-second">hms</span> triplet to will result in days instead of decidays if we divide by the most Dec and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones are not aligned. Whereas UNIX time is always synchronized with Zone <span class="color0">0</span> and <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC<span class="color0">+00:00</span></a>, This method ensure that the result matches</p>
<p><a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">UTC time zone offsets</a></p>
<p>Drag the red‚≠ïÔ∏ècircle across the <a href="https://en.wikipedia.org/wiki/Meridian_%28geography%29#:~:text=words%2C%20it%20is-,a%20line%20of%20longitude,-.%20The%20position%20of">meridians</a> (vertical‚Üïgray lines) on the mapüó∫Ô∏èto see how changing time zones affects the time. Only the first digit of the Dec times shown above, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span>, varies across time zones, because the 10 Dec time zones, numbered 0 through 9 on the mapüó∫Ô∏è, are each 1 <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a turn">deci<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees">turn</a></span> (<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn">dt</a>) wide. Simply put, a <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a turn">deciturn</span> of longitude translates into a <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> of time.</p>
<p>The leftmost vertical‚Üïline on the mapüó∫Ô∏èis <a href="https://en.wikipedia.org/wiki/18th_meridian_west#:~:text=a%20line%20of%20longitude%20that%20extends%20from%20the%20North%20Pole%20across%20the%20Arctic%20Ocean%2C%20Greenland%2C%20Iceland%2C%20the%20Atlantic%20Ocean%2C%20the%20Canary%20Islands%2C%20the%20Southern%20Ocean%2C%20and%20Antarctica%20to%20the%20South%20Pole">Meridian 0</a>, the Dec <a href="https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next">International Date Line</a> and <a href="https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0">prime meridian</a>, which cuts across the Atlantic Ocean through IcelandüáÆüá∏just West of Africaüåçand is the boundary between Zone 9 and Zone 0, the rightmost and leftmost Dec time zones on the mapüó∫Ô∏è, respectively. Arranging Dec time zones from 0 to 9 yields a <a href="https://en.wikipedia.org/wiki/World_map#:~:text=south%2Dup%20map-,Pacific%2Dcentric%20map,-(more%20commonly%20used)">Pacific-centric</a> mapüó∫Ô∏è.</p>
<p>While only positive Dec time zones are shown on the mapüó∫Ô∏è, every Dec time zone can also be expressed as a negative number. Each pair of time zone numbers produces the same Dec time, but result in <a href="../../dec/date">Dec dates</a>üóìÔ∏èthat are 1 day apart. Negative time zone numbers can be useful for getting <a href="../../dec/date">Dec dates</a>üóìÔ∏èto match <a href="https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world">Gregorian calendar</a> datesüóìÔ∏èwith negative <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">UTC offsets</a>.</p>
<p>If you know your longitude in degrees (¬∞) or <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundredths of a turn">centi<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees">turns</a></span> (<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn">ct</a>), you can look up your Dec time zone (TZ) in the table below.</p>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">TZ<br>+</th>
<th style="text-align: center;">TZ<br>-</th>
<th style="text-align: center;">Start<br>¬∞</th>
<th style="text-align: center;">Mid<br>¬∞</th>
<th style="text-align: center;">End<br>¬∞</th>
<th style="text-align: center;">Start<br><span class="math inline">\(ct\)</span>
</th>
<th style="text-align: center;">Mid<br><span class="math inline">\(ct\)</span>
</th>
<th style="text-align: center;">End<br><span class="math inline">\(ct\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-54</td>
<td style="text-align: center;">-36</td>
<td style="text-align: center;">-18</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-90</td>
<td style="text-align: center;">-72</td>
<td style="text-align: center;">-54</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">90</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">-126</td>
<td style="text-align: center;">-108</td>
<td style="text-align: center;">-90</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">75</td>
<td style="text-align: center;">80</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">-4</td>
<td style="text-align: center;">-162</td>
<td style="text-align: center;">-144</td>
<td style="text-align: center;">-126</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">-5</td>
<td style="text-align: center;">162</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">-162</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">60</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">-6</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">144</td>
<td style="text-align: center;">162</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">50</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">-7</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">108</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">-8</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">72</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">30</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">-9</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">-10</td>
<td style="text-align: center;">-18</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
</tr>
</tbody>
</table>
<p>Dec times in Zone 0 and 5 can be directly converted to and from UTC times with an offset of 0 and 12 <span class="teal">hours</span>, respectively. The other Dec time zones</p>
</section><section id="unit" class="level4"><h4 class="anchored" data-anchor-id="unit">Unit</h4>
<p>Dec uses <a href="https://en.wikipedia.org/wiki/Metric_prefix#:~:text=a%20unit%20prefix%20that%20precedes%20a%20basic%20unit%20of%20measure%20to%20indicate%20a%20multiple%20or%20submultiple%20of%20the%20unit">metric prefixes</a> to create <a href="https://en.wikipedia.org/wiki/Multiple_%28mathematics%29#Submultiple:~:text=of%20%22a%20being-,a%20unit%20fraction,-of%20b%22%20">submultiples</a> of a day that can naturally be combined together into a single <a href="https://en.wikipedia.org/wiki/Decimal#:~:text=system%20for%20denoting%20integer%20and%20non%2Dinteger%20numbers">decimal</a> number. Conversion between decimal units is as simple as moving‚ÜîÔ∏éÔ∏èor removing‚ùåthe <a href="https://en.wikipedia.org/wiki/Decimal_separator#:~:text=a%20symbol%20that%20separates%20the%20integer%20part%20from%20the%20fractional%20part%20of%20a%20number">decimal separator</a>. In contrast, an <span class="teal">hh</span>:<span class="olive">mm</span>:<span class="purple">ss</span> time is a <a href="https://en.wikipedia.org/wiki/Mixed_radix#:~:text=non%2Dstandard%20positional%20numeral%20systems%20in%20which%20the%20numerical%20base%20varies%20from%20position%20to%20position">mixed-radix</a> number, where <span class="teal">hh</span> is the <a href="https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=12-,Duodecimal,-%2C%20dozenal">base-12</a> or <a href="https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=24-,Quadravigesimal,-%5B48%5D">base-24</a> <span class="teal">hour</span>, <span class="olive">mm</span> is the <a href="https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=60-,Sexagesimal,-Babylonian%20numerals%20and">base-60</a> <span class="olive">minute</span>, and <span class="purple">ss</span> is the base-60 <span class="purple">second</span>.</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 31%">
</colgroup>
<thead><tr class="header">
<th>Prefix</th>
<th>Power</th>
<th>Day</th>
<th>
<span class="teal">hh</span>:<span class="olive">mm</span>:<span class="purple">ss</span>.<span class="purple">sss</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td></td>
<td>0</td>
<td>1</td>
<td>24:00:00.000</td>
</tr>
<tr class="even">
<td>deci</td>
<td>-1</td>
<td>.1</td>
<td>02:24:00.000</td>
</tr>
<tr class="odd">
<td>centi</td>
<td>-2</td>
<td>.01</td>
<td>00:14:24.000</td>
</tr>
<tr class="even">
<td>milli</td>
<td>-3</td>
<td>.001</td>
<td>00:01:26.400</td>
</tr>
<tr class="odd">
<td>decimilli</td>
<td>-4</td>
<td>.0001</td>
<td>00:00:08.640</td>
</tr>
<tr class="even">
<td>centimilli</td>
<td>-5</td>
<td>.00001</td>
<td>00:00:00.864</td>
</tr>
</tbody>
</table>
<p>To convert the <span class="teal">hour</span> <span class="teal">h</span>, <span class="olive">minute</span> <span class="olive">m</span>, and <span class="purple">second</span> <span class="purple">s</span> into the <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</a> <span class="cyan">d</span>, Dec uses the following equation: <span class="cyan">d</span> = <span class="teal">h</span> √∑ 2.4 + <span class="olive">m</span> √∑ 144 + <span class="purple">s</span> √∑ 8640. The current equation values in Zone <span class="lime"><span><span id="ojs-element-id-20"></span></span></span> are: <span class="cyan"><span><span id="ojs-element-id-21"></span></span></span> = <span class="teal"><span><span id="ojs-element-id-22"></span></span></span> √∑ 2.4 + <span class="olive"><span><span id="ojs-element-id-23"></span></span></span> √∑ 144 + <span class="purple"><span><span id="ojs-element-id-24"></span></span></span> √∑ 8640. Inversely, we can convert <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a> into <span class="teal">hours</span>: <span class="teal">h</span> = <span class="cyan">d</span> √ó 2.4, <span class="olive">minutes</span>: <span class="olive">m</span> = <span class="teal">h</span> <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 √ó 60, and <span class="purple">seconds</span>: <span class="purple">s</span> = <span class="olive">m</span> <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 √ó 60.</p>
<p>Instead of dealing with <span class="teal">hours</span>, <span class="olive">minutes</span>, and <span class="purple">seconds</span>, we can convert the <a href="https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970">UNIX timestamp</a> <span class="purple">u</span> into the Dec time <span class="cyan">d</span>+<span class="lime">0</span>. First, we divide <span class="purple">u</span> by 86400 to convert seconds to days, then isolate the <a href="https://en.wikipedia.org/wiki/Fractional_part#:~:text=the%20excess%20beyond%20that%20number%27s%20integer%20part">decimal part</a> of the <a href="https://en.wikipedia.org/wiki/Quotient#:~:text=a%20quantity%20produced%20by%20the%20division%20of%20two%20numbers">quotient</a>, and finally multiply by 10: <span class="cyan">d</span> + <span class="lime">0</span> = <span class="purple">u</span> √∑ 86400 <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 √ó 10. The current values in this equation are <span class="cyan"><span><span id="ojs-element-id-25"></span></span></span> + <span class="lime">0</span> = <span class="purple"><span><span id="ojs-element-id-26"></span></span></span> √∑ 86400 <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 √ó 10.</p>
<p>The concept of measuring time in decimal days is not novel. In the late 1700s, the <a href="https://en.wikipedia.org/wiki/French_Republican_calendar#:~:text=a%20calendar%20created%20and%20implemented%20during%20the%20French%20Revolution">French Republican calendar</a> time system referred to <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a> as decimal <span class="teal">hours</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundredths of a day">centidays</span> as <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=into%20tenths%2C%20or-,d%C3%A9cimes,-%2C%20instead%20of%20minutes">d√©cimes</a>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="thousandths of a day">millidays</span> as decimal <span class="olive">minutes</span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day">centimillidays</span> as decimal <span class="purple">seconds</span>. Similarly, <a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#:~:text=a%20decimal%20time%20system%20introduced%20in%201998%20by%20the%20Swatch%20corporation">Swatch Internet Time</a>, a <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=the%20representation%20of%20the%20time%20of%20day%20using%20units%20which%20are%20decimally%20related">decimal time</a> system introduced in 1998, uses the term ‚Äú.beats‚Äù for <span class="tool" data-bs-toggle="tooltip" data-bs-title="thousandths of a day">millidays</span>.</p>
<p>Swatch Internet Time differs from Dec in that it <a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=There%20are%20no%20time%20zones%20in%20Swatch%20Internet%20Time">has no time zones</a> and is obtained from the <span class="teal"><a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1">hours</a></span><a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1">, <span class="olive">minutes</span>, and <span class="purple">seconds</span></a> of <a href="https://en.wikipedia.org/wiki/UTC%2B01:00#:~:text=a%20time%20offset%20from%20UTC%20of%20%2B01%3A00">UTC+01:00</a>. In contrast, the major innovations described in this article are the Dec time zone system and the simple equation for obtaining the Dec time in Zone 0 from a UNIX timestamp, but Dec has much more to offer than <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</a> times and zones.</p>
</section><section id="next" class="level4"><h4 class="anchored" data-anchor-id="next">Next</h4>
<p>The next article in the <a href="../../dec">Dec section</a> of my site compares Dec to the <a href="https://en.wikipedia.org/wiki/ISO_8601#:~:text=an%20international%20standard%20covering%20the%20worldwide%20exchange%20and%20communication%20of%20date%20and%20time%2Drelated%20data">ISO 8601</a> international standard for dates and times. Like ISO 8601, Dec allows for <a href="https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations">combined date and time representations</a> that can be paired up to express <a href="https://en.wikipedia.org/wiki/ISO_8601#Time_intervals:~:text=the%20intervening%20time%20between%20two%20time%20points">time intervals</a>. In Dec, the combination of a date and time is called a snapü´∞and a time interval expressed as a pair of snaps is called a spanüåà.</p>
<p>My <a href="../../dec/iso">ISO 8601 article</a> is unique because it avoids the use of Observable in favor of leveraging <a href="https://jupyter.org">Jupyter</a> support in Quarto to make the code underlying Dec available in multiple programming languages. Observable is a great visualization tool but does not translate well into Jupyter notebooks. After the next article, I return to the use of Observable in my Dec <a href="../../dec/span">snap</a>ü´∞and <a href="../../dec/span">span</a>üåàarticles.</p>
<div id="timenav">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {'theme': 'default', 'themeVariables': { 'fontSize': '32px'}}}%%
flowchart LR
   A[Dec]--&gt;B[date]--&gt;C[time]--&gt;D[snap]--&gt;E[span]
   click A "/dec"
   click B "/dec/date"
   click C "/dec/time"
   click D "/dec/snap"
   click E "/dec/span"
</pre>
</div>
<p></p>
</div>
</div>
</div>
</div>
</section><section id="cite" class="level4"><h4 class="anchored" data-anchor-id="cite">Cite</h4>
<p>Please spread the good word about Dec using the citation information at the bottom of this article. You may also want to cite the Observable notebooks that I adapted into the clocküïì, barüìächart, mapüó∫Ô∏è, and daylight‚òÄÔ∏èplot visualizations in this article or the 2014 blog post which proposed a system of 20 decimal time zones, each 5 <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundredths of a day">centidays</span> wide, based on the <a href="https://en.wikipedia.org/wiki/Prime_meridian_(Greenwich)#:~:text=a%20geographical%20reference%20line%20that%20passes%20through%20the%20Royal%20Observatory%2C%20Greenwich%2C%20in%20London%2C%20England">Greenwich Meridian</a>:</p>
<ul>
<li>
<a href="https://www.2x2.graphics">Pearson, Tom</a>. <span class="yellow"><u>2013</u></span><u>+<span class="cyan">124</span></u>. ‚ÄúSimple D3 clock.‚Äù <span class="yellow"><span><span id="ojs-element-id-27"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-28"></span></span></span>. <a href="https://observablehq.com/@d3/simple-clock" class="uri">https://observablehq.com/@d3/simple-clock</a>.</li>
<li>
<a href="https://fheyen.github.io">Heyen, Frank</a>. <span class="yellow"><u>2021</u></span><u>+<span class="cyan">246</span></u>. ‚ÄúBarChart Clock.‚Äù <span class="yellow"><span><span id="ojs-element-id-29"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-30"></span></span></span>. <a href="https://observablehq.com/@fheyen/barchart-clock" class="uri">https://observablehq.com/@fheyen/barchart-clock</a>.</li>
<li>
<a href="https://enjalot.github.io">Johnson, Ian</a>. <span class="yellow"><u>2021</u></span><u>+<span class="cyan">090</span></u>. ‚ÄúDraggable World Map Coordinates Input.‚Äù <span class="yellow"><span><span id="ojs-element-id-31"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-32"></span></span></span>. <a href="https://observablehq.com/@enjalot/draggable-world-map-coordinates-input" class="uri">https://observablehq.com/@enjalot/draggable-world-map-coordinates-input</a>.</li>
<li>
<a href="https://www.danbridges.org">Bridges, Dan</a>. <span class="yellow"><u>2021</u></span><u>+<span class="cyan">311</span></u>. ‚ÄúVisualizing Seasonal Daylight.‚Äù <span class="yellow"><span><span id="ojs-element-id-33"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-34"></span></span></span>. <a href="https://observablehq.com/@dbridges/visualizing-seasonal-daylight" class="uri">https://observablehq.com/@dbridges/visualizing-seasonal-daylight</a>.</li>
<li>
<a href="https://www.brinckerhoff.org">Clements, John</a>. <span class="yellow"><u>2014</u></span><u>+<span class="cyan">091</span></u>, ‚ÄúDecimal Time Zones.‚Äù <span class="yellow"><span><span id="ojs-element-id-35"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-36"></span></span></span>. <a href="https://www.brinckerhoff.org/blog/2014/05/31/decimal-time-zones" class="uri">https://www.brinckerhoff.org/blog/2014/05/31/decimal-time-zones</a>.</li>
</ul>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="1040" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1039;"><span id="cb29-1040"><a href="#cb29-1040" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb29-1041"><a href="#cb29-1041" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [(unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> (</span>
<span id="cb29-1042"><a href="#cb29-1042" aria-hidden="true" tabindex="-1"></a>    zone <span class="op">=</span> zone <span class="op">??</span> <span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb29-1043"><a href="#cb29-1043" aria-hidden="true" tabindex="-1"></a>      (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)</span>
<span id="cb29-1044"><a href="#cb29-1044" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb29-1045"><a href="#cb29-1045" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1046"><a href="#cb29-1046" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote1</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb29-1047"><a href="#cb29-1047" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb29-1048"><a href="#cb29-1048" aria-hidden="true" tabindex="-1"></a>    (unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span></span>
<span id="cb29-1049"><a href="#cb29-1049" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> (zone <span class="op">=</span> zone <span class="op">??</span> (<span class="dv">10</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb29-1050"><a href="#cb29-1050" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb29-1051"><a href="#cb29-1051" aria-hidden="true" tabindex="-1"></a>      ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb29-1052"><a href="#cb29-1052" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1053"><a href="#cb29-1053" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2date</span>(dote<span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb29-1054"><a href="#cb29-1054" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cote <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((</span>
<span id="cb29-1055"><a href="#cb29-1055" aria-hidden="true" tabindex="-1"></a>      dote <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> dote</span>
<span id="cb29-1056"><a href="#cb29-1056" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> dote <span class="op">-</span> <span class="dv">146096</span></span>
<span id="cb29-1057"><a href="#cb29-1057" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb29-1058"><a href="#cb29-1058" aria-hidden="true" tabindex="-1"></a>  dotc <span class="op">=</span> dote <span class="op">-</span> cote <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb29-1059"><a href="#cb29-1059" aria-hidden="true" tabindex="-1"></a>  yotc <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dotc</span>
<span id="cb29-1060"><a href="#cb29-1060" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>)</span>
<span id="cb29-1061"><a href="#cb29-1061" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>)</span>
<span id="cb29-1062"><a href="#cb29-1062" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)</span>
<span id="cb29-1063"><a href="#cb29-1063" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">/</span> <span class="dv">365</span>)<span class="op">;</span></span>
<span id="cb29-1064"><a href="#cb29-1064" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb29-1065"><a href="#cb29-1065" aria-hidden="true" tabindex="-1"></a>    yotc <span class="op">+</span> cote <span class="op">*</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb29-1066"><a href="#cb29-1066" aria-hidden="true" tabindex="-1"></a>    dotc <span class="op">-</span> (yotc <span class="op">*</span> <span class="dv">365</span></span>
<span id="cb29-1067"><a href="#cb29-1067" aria-hidden="true" tabindex="-1"></a>      <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">4</span>)</span>
<span id="cb29-1068"><a href="#cb29-1068" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb29-1069"><a href="#cb29-1069" aria-hidden="true" tabindex="-1"></a>  )<span class="op">,</span> zone]}</span>
<span id="cb29-1070"><a href="#cb29-1070" aria-hidden="true" tabindex="-1"></a>dz <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb29-1071"><a href="#cb29-1071" aria-hidden="true" tabindex="-1"></a>decYear <span class="op">=</span> ydz[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span>)</span>
<span id="cb29-1072"><a href="#cb29-1072" aria-hidden="true" tabindex="-1"></a>zeroDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="dv">0</span>)[<span class="dv">0</span>]</span>
<span id="cb29-1073"><a href="#cb29-1073" aria-hidden="true" tabindex="-1"></a>zeroTime <span class="op">=</span> zeroDote <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb29-1074"><a href="#cb29-1074" aria-hidden="true" tabindex="-1"></a>zeroDate <span class="op">=</span> <span class="fu">dote2date</span>(zeroDote)</span>
<span id="cb29-1075"><a href="#cb29-1075" aria-hidden="true" tabindex="-1"></a>zeroYear <span class="op">=</span> zeroDate[<span class="dv">0</span>]</span>
<span id="cb29-1076"><a href="#cb29-1076" aria-hidden="true" tabindex="-1"></a>zeroDoty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(zeroDate[<span class="dv">1</span>])</span>
<span id="cb29-1077"><a href="#cb29-1077" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb29-1078"><a href="#cb29-1078" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb29-1079"><a href="#cb29-1079" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl2 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb29-1080"><a href="#cb29-1080" aria-hidden="true" tabindex="-1"></a>zeroDotyHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroDoty<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroDoty <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> zeroIsLeap)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb29-1081"><a href="#cb29-1081" aria-hidden="true" tabindex="-1"></a>zeroYearHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroYear<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroYear <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb29-1082"><a href="#cb29-1082" aria-hidden="true" tabindex="-1"></a>zeroIsLeap <span class="op">=</span> zeroYear <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> zeroYear <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> zeroYear <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb29-1083"><a href="#cb29-1083" aria-hidden="true" tabindex="-1"></a>browserDote <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb29-1084"><a href="#cb29-1084" aria-hidden="true" tabindex="-1"></a>browserTime <span class="op">=</span> browserDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb29-1085"><a href="#cb29-1085" aria-hidden="true" tabindex="-1"></a>browserZone <span class="op">=</span> browserDote[<span class="dv">1</span>]</span>
<span id="cb29-1086"><a href="#cb29-1086" aria-hidden="true" tabindex="-1"></a>browserSign <span class="op">=</span> browserZone <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb29-1087"><a href="#cb29-1087" aria-hidden="true" tabindex="-1"></a>zone0time <span class="op">=</span> (browserTime <span class="op">-</span> browserZone <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb29-1088"><a href="#cb29-1088" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> browserTime <span class="op">*</span> <span class="fl">2.4</span></span>
<span id="cb29-1089"><a href="#cb29-1089" aria-hidden="true" tabindex="-1"></a>minutes <span class="op">=</span> hours <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb29-1090"><a href="#cb29-1090" aria-hidden="true" tabindex="-1"></a>seconds <span class="op">=</span> minutes <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb29-1091"><a href="#cb29-1091" aria-hidden="true" tabindex="-1"></a>selectedDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="fu">long2zone</span>(location[<span class="dv">0</span>]))</span>
<span id="cb29-1092"><a href="#cb29-1092" aria-hidden="true" tabindex="-1"></a>selectedExact <span class="op">=</span> selectedDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb29-1093"><a href="#cb29-1093" aria-hidden="true" tabindex="-1"></a>selectedExactN <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> selectedExact) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb29-1094"><a href="#cb29-1094" aria-hidden="true" tabindex="-1"></a>selectedZone <span class="op">=</span> selectedDote[<span class="dv">1</span>]</span>
<span id="cb29-1095"><a href="#cb29-1095" aria-hidden="true" tabindex="-1"></a>ydz <span class="op">=</span> <span class="fu">dote2date</span>(<span class="op">...</span>selectedDote)</span>
<span id="cb29-1096"><a href="#cb29-1096" aria-hidden="true" tabindex="-1"></a>decDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(ydz[<span class="dv">1</span>])</span>
<span id="cb29-1097"><a href="#cb29-1097" aria-hidden="true" tabindex="-1"></a>decTime <span class="op">=</span> (selectedExact <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb29-1098"><a href="#cb29-1098" aria-hidden="true" tabindex="-1"></a>decTimeN <span class="op">=</span> (selectedExactN <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb29-1099"><a href="#cb29-1099" aria-hidden="true" tabindex="-1"></a>barDD <span class="op">=</span> decTime[<span class="dv">0</span>]</span>
<span id="cb29-1100"><a href="#cb29-1100" aria-hidden="true" tabindex="-1"></a>barDDN <span class="op">=</span> decTimeN[<span class="dv">0</span>]</span>
<span id="cb29-1101"><a href="#cb29-1101" aria-hidden="true" tabindex="-1"></a>barMils <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb29-1102"><a href="#cb29-1102" aria-hidden="true" tabindex="-1"></a>barMilsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb29-1103"><a href="#cb29-1103" aria-hidden="true" tabindex="-1"></a>barBeats <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb29-1104"><a href="#cb29-1104" aria-hidden="true" tabindex="-1"></a>barBeatsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb29-1105"><a href="#cb29-1105" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">lati2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb29-1106"><a href="#cb29-1106" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb29-1107"><a href="#cb29-1107" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb29-1108"><a href="#cb29-1108" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1109"><a href="#cb29-1109" aria-hidden="true" tabindex="-1"></a>graticule <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoGraticule</span>()<span class="op">.</span><span class="fu">stepMinor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])<span class="op">.</span><span class="fu">stepMajor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])()</span>
<span id="cb29-1110"><a href="#cb29-1110" aria-hidden="true" tabindex="-1"></a>graticule<span class="op">.</span><span class="at">coordinates</span> <span class="op">=</span> graticule<span class="op">.</span><span class="at">coordinates</span><span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb29-1111"><a href="#cb29-1111" aria-hidden="true" tabindex="-1"></a>  i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="fu">map</span>(j <span class="kw">=&gt;</span> j<span class="op">.</span><span class="fu">map</span>((k<span class="op">,</span> index<span class="op">,</span> arr) <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> index <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> k <span class="op">-</span> <span class="dv">18</span> <span class="op">:</span> k))</span>
<span id="cb29-1112"><a href="#cb29-1112" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-29" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-30" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-31" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-32" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-33" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-34" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-35" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-36" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-37" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-38" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-39" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-40" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-41" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb30" data-startfrom="1113" data-source-offset="-2750"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1112;"><span id="cb30-1113"><a href="#cb30-1113" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb30-1114"><a href="#cb30-1114" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb30-1115"><a href="#cb30-1115" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (((degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> degrees <span class="op">+</span> <span class="dv">360</span> <span class="op">:</span> degrees) <span class="op">+</span> <span class="dv">18</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb30-1116"><a href="#cb30-1116" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1117"><a href="#cb30-1117" aria-hidden="true" tabindex="-1"></a><span class="co">// https://github.com/topojson/world-atlas</span></span>
<span id="cb30-1118"><a href="#cb30-1118" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> d3<span class="op">.</span><span class="fu">json</span>(<span class="st">"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json"</span>)</span>
<span id="cb30-1119"><a href="#cb30-1119" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">countries</span>)</span>
<span id="cb30-1120"><a href="#cb30-1120" aria-hidden="true" tabindex="-1"></a>topojson <span class="op">=</span> <span class="pp">require</span>(<span class="st">"topojson-client@3"</span>)</span>
<span id="cb30-1121"><a href="#cb30-1121" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2zone</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span>) {</span>
<span id="cb30-1122"><a href="#cb30-1122" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">long2turn</span>(degrees<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb30-1123"><a href="#cb30-1123" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1124"><a href="#cb30-1124" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">year2leap</span>(year <span class="op">=</span> <span class="dv">1970</span>) {</span>
<span id="cb30-1125"><a href="#cb30-1125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> year <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> year <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> year <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb30-1126"><a href="#cb30-1126" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1127"><a href="#cb30-1127" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb30-1128"><a href="#cb30-1128" aria-hidden="true" tabindex="-1"></a>solarSystem <span class="op">=</span> (<span class="bu">root</span><span class="op">,</span> vizwidth<span class="op">,</span> location<span class="op">,</span> date<span class="op">,</span> hour<span class="op">,</span> darkmode) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1129"><a href="#cb30-1129" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthRadius <span class="op">=</span> <span class="fl">0.065</span> <span class="op">*</span> vizwidth<span class="op">;</span></span>
<span id="cb30-1130"><a href="#cb30-1130" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const sunRadius = 0.015 * vizwidth;</span></span>
<span id="cb30-1131"><a href="#cb30-1131" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystemRadius <span class="op">=</span> vizwidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (vizwidth <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb30-1132"><a href="#cb30-1132" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stretch <span class="op">=</span> <span class="fl">0.06</span><span class="op">;</span></span>
<span id="cb30-1133"><a href="#cb30-1133" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(date)<span class="op">;</span></span>
<span id="cb30-1134"><a href="#cb30-1134" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngleDeg <span class="op">=</span> (solarAngle <span class="op">*</span> <span class="dv">180</span>) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb30-1135"><a href="#cb30-1135" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(solarAngle)<span class="op">;</span></span>
<span id="cb30-1136"><a href="#cb30-1136" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> stretch <span class="op">*</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(solarAngle)<span class="op">;</span></span>
<span id="cb30-1137"><a href="#cb30-1137" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> spin <span class="op">=</span> <span class="dv">180</span> <span class="op">+</span> <span class="op">-</span>location[<span class="dv">0</span>] <span class="op">+</span> solarAngleDeg <span class="op">+</span> <span class="dv">360</span> <span class="op">*</span> ((hour <span class="op">+</span> <span class="dv">12</span>) <span class="op">/</span> <span class="dv">24</span>)<span class="op">;</span></span>
<span id="cb30-1138"><a href="#cb30-1138" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthGeo <span class="op">=</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> }<span class="op">;</span></span>
<span id="cb30-1139"><a href="#cb30-1139" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb30-1140"><a href="#cb30-1140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb30-1141"><a href="#cb30-1141" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb30-1142"><a href="#cb30-1142" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([spin<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="fl">23.5</span>])</span>
<span id="cb30-1143"><a href="#cb30-1143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb30-1144"><a href="#cb30-1144" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticProjection <span class="op">=</span> d3</span>
<span id="cb30-1145"><a href="#cb30-1145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb30-1146"><a href="#cb30-1146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb30-1147"><a href="#cb30-1147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([solarAngleDeg <span class="op">-</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">0</span>])</span>
<span id="cb30-1148"><a href="#cb30-1148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb30-1149"><a href="#cb30-1149" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">1.5</span>)<span class="op">;</span></span>
<span id="cb30-1150"><a href="#cb30-1150" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticPath <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(staticProjection)<span class="op">;</span></span>
<span id="cb30-1151"><a href="#cb30-1151" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> oceanColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb30-1152"><a href="#cb30-1152" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> landColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb30-1153"><a href="#cb30-1153" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> borderColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb30-1154"><a href="#cb30-1154" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystem <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb30-1155"><a href="#cb30-1155" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-1156"><a href="#cb30-1156" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>vizwidth <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb30-1157"><a href="#cb30-1157" aria-hidden="true" tabindex="-1"></a>  <span class="co">// solarSystem.append("circle").attr("r", sunRadius).attr("fill", colors.sun);</span></span>
<span id="cb30-1158"><a href="#cb30-1158" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Draw orbit */</span></span>
<span id="cb30-1159"><a href="#cb30-1159" aria-hidden="true" tabindex="-1"></a>    solarSystem</span>
<span id="cb30-1160"><a href="#cb30-1160" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"ellipse"</span>)</span>
<span id="cb30-1161"><a href="#cb30-1161" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> solarSystemRadius)</span>
<span id="cb30-1162"><a href="#cb30-1162" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> stretch <span class="op">*</span> solarSystemRadius)</span>
<span id="cb30-1163"><a href="#cb30-1163" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb30-1164"><a href="#cb30-1164" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.25"</span>)</span>
<span id="cb30-1165"><a href="#cb30-1165" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb30-1166"><a href="#cb30-1166" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* Draw month ticks */</span></span>
<span id="cb30-1167"><a href="#cb30-1167" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">12</span>)<span class="op">.</span><span class="fu">map</span>((m) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1168"><a href="#cb30-1168" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> d <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb30-1169"><a href="#cb30-1169" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> angle <span class="op">=</span> <span class="fu">getSolarAngle</span>(d)<span class="op">;</span></span>
<span id="cb30-1170"><a href="#cb30-1170" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb30-1171"><a href="#cb30-1171" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb30-1172"><a href="#cb30-1172" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb30-1173"><a href="#cb30-1173" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb30-1174"><a href="#cb30-1174" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb30-1175"><a href="#cb30-1175" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb30-1176"><a href="#cb30-1176" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.75"</span>)</span>
<span id="cb30-1177"><a href="#cb30-1177" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb30-1178"><a href="#cb30-1178" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> startMonthAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(<span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb30-1179"><a href="#cb30-1179" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb30-1180"><a href="#cb30-1180" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-1181"><a href="#cb30-1181" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="fu">date2doty</span>(d))</span>
<span id="cb30-1182"><a href="#cb30-1182" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">18</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(startMonthAngle) <span class="op">*</span> <span class="fl">1.1</span>)</span>
<span id="cb30-1183"><a href="#cb30-1183" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb30-1184"><a href="#cb30-1184" aria-hidden="true" tabindex="-1"></a>          <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb30-1185"><a href="#cb30-1185" aria-hidden="true" tabindex="-1"></a>          (solarSystemRadius <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">3</span>) <span class="op">*</span> <span class="fl">6.2</span> <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle)) <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb30-1186"><a href="#cb30-1186" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb30-1187"><a href="#cb30-1187" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb30-1188"><a href="#cb30-1188" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb30-1189"><a href="#cb30-1189" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> <span class="fl">1.2</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1190"><a href="#cb30-1190" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb30-1191"><a href="#cb30-1191" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb30-1192"><a href="#cb30-1192" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb30-1193"><a href="#cb30-1193" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> earth <span class="op">=</span> solarSystem</span>
<span id="cb30-1194"><a href="#cb30-1194" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-1195"><a href="#cb30-1195" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>y<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb30-1196"><a href="#cb30-1196" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">drawEarth</span>() {</span>
<span id="cb30-1197"><a href="#cb30-1197" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`rotate(-23.5)`</span>)<span class="op">;</span></span>
<span id="cb30-1198"><a href="#cb30-1198" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(earthGeo))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeOcean"</span>)<span class="op">;</span></span>
<span id="cb30-1199"><a href="#cb30-1199" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(land))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeLand"</span>)<span class="op">;</span></span>
<span id="cb30-1200"><a href="#cb30-1200" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(countries))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">".08"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeBorders"</span>)<span class="op">;</span></span>
<span id="cb30-1201"><a href="#cb30-1201" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">5.5</span>)<span class="op">;</span></span>
<span id="cb30-1202"><a href="#cb30-1202" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb30-1203"><a href="#cb30-1203" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">4.5</span>)<span class="op">;</span></span>
<span id="cb30-1204"><a href="#cb30-1204" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">2.25</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb30-1205"><a href="#cb30-1205" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-1206"><a href="#cb30-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb30-1207"><a href="#cb30-1207" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1208"><a href="#cb30-1208" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greg2doty</span>(month <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> day <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb30-1209"><a href="#cb30-1209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb30-1210"><a href="#cb30-1210" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> day <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb30-1211"><a href="#cb30-1211" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb30-1212"><a href="#cb30-1212" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty</span>(date) {</span>
<span id="cb30-1213"><a href="#cb30-1213" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb30-1214"><a href="#cb30-1214" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1215"><a href="#cb30-1215" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty1</span>(date) {</span>
<span id="cb30-1216"><a href="#cb30-1216" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb30-1217"><a href="#cb30-1217" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1218"><a href="#cb30-1218" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb30-1219"><a href="#cb30-1219" aria-hidden="true" tabindex="-1"></a><span class="co">// globe = (root, { vizwidth, location, date, hour }) =&gt; {</span></span>
<span id="cb30-1220"><a href="#cb30-1220" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngle = getSolarAngle(date);</span></span>
<span id="cb30-1221"><a href="#cb30-1221" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngleDeg = toDegrees(solarAngle);</span></span>
<span id="cb30-1222"><a href="#cb30-1222" aria-hidden="true" tabindex="-1"></a><span class="co">//   const hourSpin = 360 * ((hour + 12) / 24);</span></span>
<span id="cb30-1223"><a href="#cb30-1223" aria-hidden="true" tabindex="-1"></a><span class="co">//   const spin = (180 + -location[0] + solarAngleDeg + hourSpin);</span></span>
<span id="cb30-1224"><a href="#cb30-1224" aria-hidden="true" tabindex="-1"></a><span class="co">//   const tilt = -15;</span></span>
<span id="cb30-1225"><a href="#cb30-1225" aria-hidden="true" tabindex="-1"></a><span class="co">//   const projection = d3.geoOrthographic()</span></span>
<span id="cb30-1226"><a href="#cb30-1226" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .fitWidth(vizwidth, graticule)</span></span>
<span id="cb30-1227"><a href="#cb30-1227" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb30-1228"><a href="#cb30-1228" aria-hidden="true" tabindex="-1"></a><span class="co">//   const path = d3.geoPath(projection);</span></span>
<span id="cb30-1229"><a href="#cb30-1229" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedProjection = d3.geoOrthographic()</span></span>
<span id="cb30-1230"><a href="#cb30-1230" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .clipAngle(null)</span></span>
<span id="cb30-1231"><a href="#cb30-1231" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .fitWidth(vizwidth, graticule)</span></span>
<span id="cb30-1232"><a href="#cb30-1232" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb30-1233"><a href="#cb30-1233" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedPath = d3.geoPath(unClippedProjection);</span></span>
<span id="cb30-1234"><a href="#cb30-1234" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticProjection = d3.geoOrthographic()</span></span>
<span id="cb30-1235"><a href="#cb30-1235" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .fitWidth(vizwidth, graticule)</span></span>
<span id="cb30-1236"><a href="#cb30-1236" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .rotate([solarAngleDeg - 90, tilt]);</span></span>
<span id="cb30-1237"><a href="#cb30-1237" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticPath = d3.geoPath(staticProjection);</span></span>
<span id="cb30-1238"><a href="#cb30-1238" aria-hidden="true" tabindex="-1"></a><span class="co">//   const background = root.append("g");</span></span>
<span id="cb30-1239"><a href="#cb30-1239" aria-hidden="true" tabindex="-1"></a><span class="co">//   const earth = root.append("g").style("opacity", 0.75);</span></span>
<span id="cb30-1240"><a href="#cb30-1240" aria-hidden="true" tabindex="-1"></a><span class="co">//   const foreground = root.append("g");</span></span>
<span id="cb30-1241"><a href="#cb30-1241" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb30-1242"><a href="#cb30-1242" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Sphere"}))</span></span>
<span id="cb30-1243"><a href="#cb30-1243" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.ocean)</span></span>
<span id="cb30-1244"><a href="#cb30-1244" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#9ecbda");</span></span>
<span id="cb30-1245"><a href="#cb30-1245" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb30-1246"><a href="#cb30-1246" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(land))</span></span>
<span id="cb30-1247"><a href="#cb30-1247" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.land);</span></span>
<span id="cb30-1248"><a href="#cb30-1248" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb30-1249"><a href="#cb30-1249" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(countries))</span></span>
<span id="cb30-1250"><a href="#cb30-1250" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", "1")</span></span>
<span id="cb30-1251"><a href="#cb30-1251" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb30-1252"><a href="#cb30-1252" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#000");</span></span>
<span id="cb30-1253"><a href="#cb30-1253" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb30-1254"><a href="#cb30-1254" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath({type: "Point", coordinates: location}))</span></span>
<span id="cb30-1255"><a href="#cb30-1255" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb30-1256"><a href="#cb30-1256" aria-hidden="true" tabindex="-1"></a><span class="co">//   const latitudeCoords = (latitude, start, end) =&gt; {</span></span>
<span id="cb30-1257"><a href="#cb30-1257" aria-hidden="true" tabindex="-1"></a><span class="co">//     const longitudes = d3.range(start, end, 2).concat(end);</span></span>
<span id="cb30-1258"><a href="#cb30-1258" aria-hidden="true" tabindex="-1"></a><span class="co">//     return longitudes.map(d =&gt; [d, latitude]);</span></span>
<span id="cb30-1259"><a href="#cb30-1259" aria-hidden="true" tabindex="-1"></a><span class="co">//   }</span></span>
<span id="cb30-1260"><a href="#cb30-1260" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctSpin = d3.geoRotation([-hourSpin, 0]);</span></span>
<span id="cb30-1261"><a href="#cb30-1261" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctTilt = d3.geoRotation([6, 0, 0]);</span></span>
<span id="cb30-1262"><a href="#cb30-1262" aria-hidden="true" tabindex="-1"></a><span class="co">//   /* total angular extent of day/night */</span></span>
<span id="cb30-1263"><a href="#cb30-1263" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayExtent = 360 * dayLength(date, location[1]) / 24;</span></span>
<span id="cb30-1264"><a href="#cb30-1264" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightExtent = 360 - dayExtent;</span></span>
<span id="cb30-1265"><a href="#cb30-1265" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayLine = {</span></span>
<span id="cb30-1266"><a href="#cb30-1266" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb30-1267"><a href="#cb30-1267" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb30-1268"><a href="#cb30-1268" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2,</span></span>
<span id="cb30-1269"><a href="#cb30-1269" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] + dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb30-1270"><a href="#cb30-1270" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb30-1271"><a href="#cb30-1271" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightLine = {</span></span>
<span id="cb30-1272"><a href="#cb30-1272" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb30-1273"><a href="#cb30-1273" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb30-1274"><a href="#cb30-1274" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2 - nightExtent,</span></span>
<span id="cb30-1275"><a href="#cb30-1275" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb30-1276"><a href="#cb30-1276" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb30-1277"><a href="#cb30-1277" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb30-1278"><a href="#cb30-1278" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(dayLine))</span></span>
<span id="cb30-1279"><a href="#cb30-1279" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb30-1280"><a href="#cb30-1280" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb30-1281"><a href="#cb30-1281" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb30-1282"><a href="#cb30-1282" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb30-1283"><a href="#cb30-1283" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(nightLine))</span></span>
<span id="cb30-1284"><a href="#cb30-1284" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb30-1285"><a href="#cb30-1285" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb30-1286"><a href="#cb30-1286" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb30-1287"><a href="#cb30-1287" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb30-1288"><a href="#cb30-1288" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(dayLine))</span></span>
<span id="cb30-1289"><a href="#cb30-1289" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb30-1290"><a href="#cb30-1290" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb30-1291"><a href="#cb30-1291" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb30-1292"><a href="#cb30-1292" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb30-1293"><a href="#cb30-1293" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(nightLine))</span></span>
<span id="cb30-1294"><a href="#cb30-1294" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb30-1295"><a href="#cb30-1295" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb30-1296"><a href="#cb30-1296" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb30-1297"><a href="#cb30-1297" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb30-1298"><a href="#cb30-1298" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Point", coordinates: location}))</span></span>
<span id="cb30-1299"><a href="#cb30-1299" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", .5)</span></span>
<span id="cb30-1300"><a href="#cb30-1300" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "black")</span></span>
<span id="cb30-1301"><a href="#cb30-1301" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb30-1302"><a href="#cb30-1302" aria-hidden="true" tabindex="-1"></a><span class="co">//   const shadowPolygon = [[0, -90], [0, 0], [0, 90], [180, 0], [0, -90]].map(d =&gt; correctTilt(d));</span></span>
<span id="cb30-1303"><a href="#cb30-1303" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb30-1304"><a href="#cb30-1304" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", staticPath({type: "Polygon", coordinates: [shadowPolygon]}))</span></span>
<span id="cb30-1305"><a href="#cb30-1305" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "rgba(0, 0, 0, 0.25)");</span></span>
<span id="cb30-1306"><a href="#cb30-1306" aria-hidden="true" tabindex="-1"></a><span class="co">// }</span></span>
<span id="cb30-1307"><a href="#cb30-1307" aria-hidden="true" tabindex="-1"></a>dayOfYear <span class="op">=</span> (date) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1308"><a href="#cb30-1308" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb30-1309"><a href="#cb30-1309" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb30-1310"><a href="#cb30-1310" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1311"><a href="#cb30-1311" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb30-1312"><a href="#cb30-1312" aria-hidden="true" tabindex="-1"></a>daylightPlot <span class="op">=</span> (</span>
<span id="cb30-1313"><a href="#cb30-1313" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span><span class="op">,</span></span>
<span id="cb30-1314"><a href="#cb30-1314" aria-hidden="true" tabindex="-1"></a>  { vizwidth<span class="op">,</span> height<span class="op">,</span> year<span class="op">,</span> latitude<span class="op">,</span> defaultDate<span class="op">,</span> defaultHour }</span>
<span id="cb30-1315"><a href="#cb30-1315" aria-hidden="true" tabindex="-1"></a>) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1316"><a href="#cb30-1316" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">;</span></span>
<span id="cb30-1317"><a href="#cb30-1317" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartWidth <span class="op">=</span> vizwidth <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">;</span></span>
<span id="cb30-1318"><a href="#cb30-1318" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartHeight <span class="op">=</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb30-1319"><a href="#cb30-1319" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yTickValues <span class="op">=</span></span>
<span id="cb30-1320"><a href="#cb30-1320" aria-hidden="true" tabindex="-1"></a>    width <span class="op">&gt;</span> <span class="dv">380</span> <span class="op">?</span> [<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">21</span>] <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">90</span> <span class="op">?</span> [<span class="dv">6</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">18</span>] <span class="op">:</span> [<span class="dv">12</span>]<span class="op">;</span></span>
<span id="cb30-1321"><a href="#cb30-1321" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yScale <span class="op">=</span> d3</span>
<span id="cb30-1322"><a href="#cb30-1322" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb30-1323"><a href="#cb30-1323" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">24</span>])</span>
<span id="cb30-1324"><a href="#cb30-1324" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth])</span>
<span id="cb30-1325"><a href="#cb30-1325" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb30-1326"><a href="#cb30-1326" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis scale</span></span>
<span id="cb30-1327"><a href="#cb30-1327" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xScale <span class="op">=</span> d3</span>
<span id="cb30-1328"><a href="#cb30-1328" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleTime</span>()</span>
<span id="cb30-1329"><a href="#cb30-1329" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">61</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">91</span>)])</span>
<span id="cb30-1330"><a href="#cb30-1330" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">top</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight])</span>
<span id="cb30-1331"><a href="#cb30-1331" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb30-1332"><a href="#cb30-1332" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis labels</span></span>
<span id="cb30-1333"><a href="#cb30-1333" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3</span>
<span id="cb30-1334"><a href="#cb30-1334" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisBottom</span>(xScale)</span>
<span id="cb30-1335"><a href="#cb30-1335" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(d3<span class="op">.</span><span class="at">timeMonth</span><span class="op">.</span><span class="fu">range</span>(<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">60</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">57</span>)))</span>
<span id="cb30-1336"><a href="#cb30-1336" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartWidth)</span>
<span id="cb30-1337"><a href="#cb30-1337" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(date2doty1)<span class="op">;</span></span>
<span id="cb30-1338"><a href="#cb30-1338" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3</span>
<span id="cb30-1339"><a href="#cb30-1339" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisLeft</span>(yScale)</span>
<span id="cb30-1340"><a href="#cb30-1340" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(yTickValues)</span>
<span id="cb30-1341"><a href="#cb30-1341" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartHeight)</span>
<span id="cb30-1342"><a href="#cb30-1342" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>((d) <span class="kw">=&gt;</span> { <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>d <span class="op">/</span> <span class="op">.</span><span class="bn">024</span><span class="sc">}</span><span class="vs">`</span> })<span class="op">;</span></span>
<span id="cb30-1343"><a href="#cb30-1343" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> date <span class="op">=</span> defaultDate <span class="op">||</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb30-1344"><a href="#cb30-1344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> hour <span class="op">=</span> defaultHour <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> defaultHour <span class="op">:</span> date<span class="op">.</span><span class="fu">getHours</span>()<span class="op">;</span></span>
<span id="cb30-1345"><a href="#cb30-1345" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleMouseMove <span class="op">=</span> (e) <span class="kw">=&gt;</span> {}<span class="op">;</span></span>
<span id="cb30-1346"><a href="#cb30-1346" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb30-1347"><a href="#cb30-1347" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb30-1348"><a href="#cb30-1348" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span>)</span>
<span id="cb30-1349"><a href="#cb30-1349" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb30-1350"><a href="#cb30-1350" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb30-1351"><a href="#cb30-1351" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> chartHeight)</span>
<span id="cb30-1352"><a href="#cb30-1352" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> <span class="fl">0.05</span> <span class="op">*</span> vizwidth)</span>
<span id="cb30-1353"><a href="#cb30-1353" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb30-1354"><a href="#cb30-1354" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb30-1355"><a href="#cb30-1355" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-1356"><a href="#cb30-1356" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb30-1357"><a href="#cb30-1357" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb30-1358"><a href="#cb30-1358" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb30-1359"><a href="#cb30-1359" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb30-1360"><a href="#cb30-1360" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">7</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">.</span><span class="dv">725</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">75</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> <span class="fl">1.4</span>) <span class="op">*</span> fontSize))</span>
<span id="cb30-1361"><a href="#cb30-1361" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb30-1362"><a href="#cb30-1362" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb30-1363"><a href="#cb30-1363" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb30-1364"><a href="#cb30-1364" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-1365"><a href="#cb30-1365" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartHeight<span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb30-1366"><a href="#cb30-1366" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb30-1367"><a href="#cb30-1367" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb30-1368"><a href="#cb30-1368" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb30-1369"><a href="#cb30-1369" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.3</span>) <span class="op">*</span> fontSize))</span>
<span id="cb30-1370"><a href="#cb30-1370" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb30-1371"><a href="#cb30-1371" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb30-1372"><a href="#cb30-1372" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb30-1373"><a href="#cb30-1373" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-1374"><a href="#cb30-1374" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Time of day"</span>)</span>
<span id="cb30-1375"><a href="#cb30-1375" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="op">-</span><span class="dv">102</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">-</span><span class="dv">106</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">-</span><span class="dv">108</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">-</span><span class="dv">115</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">-</span><span class="dv">120</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">128</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">425</span> <span class="op">?</span> <span class="op">-</span><span class="dv">130</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">-</span><span class="dv">132</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="op">-</span><span class="dv">136</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">141</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">525</span> <span class="op">?</span> <span class="op">-</span><span class="dv">142</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">-</span><span class="dv">148</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">575</span> <span class="op">?</span> <span class="op">-</span><span class="dv">149</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">154</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">675</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">-</span><span class="dv">161</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">725</span> <span class="op">?</span> <span class="op">-</span><span class="dv">160</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="op">-</span><span class="dv">165</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">775</span> <span class="op">?</span> <span class="op">-</span><span class="dv">169</span> <span class="op">:</span> <span class="op">-</span><span class="dv">173</span>))</span>
<span id="cb30-1376"><a href="#cb30-1376" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">33</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">35</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">42</span>))</span>
<span id="cb30-1377"><a href="#cb30-1377" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb30-1378"><a href="#cb30-1378" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1379"><a href="#cb30-1379" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb30-1380"><a href="#cb30-1380" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb30-1381"><a href="#cb30-1381" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb30-1382"><a href="#cb30-1382" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb30-1383"><a href="#cb30-1383" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-1384"><a href="#cb30-1384" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day of year"</span>)</span>
<span id="cb30-1385"><a href="#cb30-1385" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">28</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> <span class="dv">22</span>))</span>
<span id="cb30-1386"><a href="#cb30-1386" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight <span class="op">/</span> <span class="dv">4</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">39</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">51</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">43</span>))</span>
<span id="cb30-1387"><a href="#cb30-1387" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb30-1388"><a href="#cb30-1388" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1389"><a href="#cb30-1389" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb30-1390"><a href="#cb30-1390" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb30-1391"><a href="#cb30-1391" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="fu">yearDates</span>(year)</span>
<span id="cb30-1392"><a href="#cb30-1392" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">,</span> <span class="fu">dayLength</span>(d<span class="op">,</span> latitude)])</span>
<span id="cb30-1393"><a href="#cb30-1393" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(([_<span class="op">,</span> d]) <span class="kw">=&gt;</span> d <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb30-1394"><a href="#cb30-1394" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Render separate polygons for each continuous sequence of</span></span>
<span id="cb30-1395"><a href="#cb30-1395" aria-hidden="true" tabindex="-1"></a><span class="co">   * days with more than 0 hours of day light</span></span>
<span id="cb30-1396"><a href="#cb30-1396" aria-hidden="true" tabindex="-1"></a><span class="co">   */</span></span>
<span id="cb30-1397"><a href="#cb30-1397" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> polys <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb30-1398"><a href="#cb30-1398" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> currentPoly <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb30-1399"><a href="#cb30-1399" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> data<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb30-1400"><a href="#cb30-1400" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> currentDate <span class="op">=</span> data[i][<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb30-1401"><a href="#cb30-1401" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prevDate <span class="op">=</span> (data[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">||</span> [])[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb30-1402"><a href="#cb30-1402" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb30-1403"><a href="#cb30-1403" aria-hidden="true" tabindex="-1"></a>      i <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span></span>
<span id="cb30-1404"><a href="#cb30-1404" aria-hidden="true" tabindex="-1"></a>      currentDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> prevDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">&lt;</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb30-1405"><a href="#cb30-1405" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb30-1406"><a href="#cb30-1406" aria-hidden="true" tabindex="-1"></a>      currentPoly<span class="op">.</span><span class="fu">push</span>(data[i])<span class="op">;</span></span>
<span id="cb30-1407"><a href="#cb30-1407" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb30-1408"><a href="#cb30-1408" aria-hidden="true" tabindex="-1"></a>      polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb30-1409"><a href="#cb30-1409" aria-hidden="true" tabindex="-1"></a>      currentPoly <span class="op">=</span> [data[i]]<span class="op">;</span></span>
<span id="cb30-1410"><a href="#cb30-1410" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-1411"><a href="#cb30-1411" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-1412"><a href="#cb30-1412" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb30-1413"><a href="#cb30-1413" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">forEach</span>((p) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1414"><a href="#cb30-1414" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> points <span class="op">=</span> [</span>
<span id="cb30-1415"><a href="#cb30-1415" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">-</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">,</span></span>
<span id="cb30-1416"><a href="#cb30-1416" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">reverse</span>()<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">+</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb30-1417"><a href="#cb30-1417" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">.</span><span class="fu">join</span>(<span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb30-1418"><a href="#cb30-1418" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"polygon"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"points"</span><span class="op">,</span> points)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb30-1419"><a href="#cb30-1419" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb30-1420"><a href="#cb30-1420" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Legend */</span></span>
<span id="cb30-1421"><a href="#cb30-1421" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb30-1422"><a href="#cb30-1422" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb30-1423"><a href="#cb30-1423" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">64</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb30-1424"><a href="#cb30-1424" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb30-1425"><a href="#cb30-1425" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb30-1426"><a href="#cb30-1426" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">63</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">61</span> <span class="op">:</span> <span class="dv">60</span>)</span>
<span id="cb30-1427"><a href="#cb30-1427" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb30-1428"><a href="#cb30-1428" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb30-1429"><a href="#cb30-1429" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1430"><a href="#cb30-1430" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1431"><a href="#cb30-1431" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb30-1432"><a href="#cb30-1432" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb30-1433"><a href="#cb30-1433" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-1434"><a href="#cb30-1434" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">82</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">85</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">87</span> <span class="op">:</span> <span class="dv">90</span>)</span>
<span id="cb30-1435"><a href="#cb30-1435" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb30-1436"><a href="#cb30-1436" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1437"><a href="#cb30-1437" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb30-1438"><a href="#cb30-1438" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day"</span>)<span class="op">;</span></span>
<span id="cb30-1439"><a href="#cb30-1439" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb30-1440"><a href="#cb30-1440" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb30-1441"><a href="#cb30-1441" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">40</span> <span class="op">:</span> <span class="op">-</span><span class="dv">39</span>)</span>
<span id="cb30-1442"><a href="#cb30-1442" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb30-1443"><a href="#cb30-1443" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb30-1444"><a href="#cb30-1444" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1445"><a href="#cb30-1445" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1446"><a href="#cb30-1446" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb30-1447"><a href="#cb30-1447" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb30-1448"><a href="#cb30-1448" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb30-1449"><a href="#cb30-1449" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">11</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">12</span> <span class="op">:</span> <span class="op">-</span><span class="dv">9</span>)</span>
<span id="cb30-1450"><a href="#cb30-1450" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb30-1451"><a href="#cb30-1451" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb30-1452"><a href="#cb30-1452" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb30-1453"><a href="#cb30-1453" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Night"</span>)<span class="op">;</span></span>
<span id="cb30-1454"><a href="#cb30-1454" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Time and date controls */</span></span>
<span id="cb30-1455"><a href="#cb30-1455" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dateLine <span class="op">=</span> <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb30-1456"><a href="#cb30-1456" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updateControlPositions <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb30-1457"><a href="#cb30-1457" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb30-1458"><a href="#cb30-1458" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"line"</span>)</span>
<span id="cb30-1459"><a href="#cb30-1459" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb30-1460"><a href="#cb30-1460" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScale</span>(date))</span>
<span id="cb30-1461"><a href="#cb30-1461" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">24</span>))</span>
<span id="cb30-1462"><a href="#cb30-1462" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb30-1463"><a href="#cb30-1463" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb30-1464"><a href="#cb30-1464" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"rect"</span>)</span>
<span id="cb30-1465"><a href="#cb30-1465" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb30-1466"><a href="#cb30-1466" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">xScale</span>(date) <span class="op">-</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb30-1467"><a href="#cb30-1467" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span></span>
<span id="cb30-1468"><a href="#cb30-1468" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#time-control"</span>)</span>
<span id="cb30-1469"><a href="#cb30-1469" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">yScale</span>(hour))</span>
<span id="cb30-1470"><a href="#cb30-1470" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb30-1471"><a href="#cb30-1471" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb30-1472"><a href="#cb30-1472" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dispatchDateHourChange <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb30-1473"><a href="#cb30-1473" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> detail <span class="op">=</span> { date<span class="op">,</span> hour }<span class="op">;</span></span>
<span id="cb30-1474"><a href="#cb30-1474" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> changeEvent <span class="op">=</span> <span class="kw">new</span> <span class="bu">CustomEvent</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> {</span>
<span id="cb30-1475"><a href="#cb30-1475" aria-hidden="true" tabindex="-1"></a>      detail<span class="op">,</span></span>
<span id="cb30-1476"><a href="#cb30-1476" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb30-1477"><a href="#cb30-1477" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb30-1478"><a href="#cb30-1478" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">dispatchEvent</span>(changeEvent)<span class="op">;</span></span>
<span id="cb30-1479"><a href="#cb30-1479" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb30-1480"><a href="#cb30-1480" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateLineDrag <span class="op">=</span> ({ x }) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1481"><a href="#cb30-1481" aria-hidden="true" tabindex="-1"></a>    date <span class="op">=</span> xScale<span class="op">.</span><span class="fu">invert</span>(x)<span class="op">;</span></span>
<span id="cb30-1482"><a href="#cb30-1482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb30-1483"><a href="#cb30-1483" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb30-1484"><a href="#cb30-1484" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb30-1485"><a href="#cb30-1485" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleTimeCircleDrag <span class="op">=</span> ({ y }) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1486"><a href="#cb30-1486" aria-hidden="true" tabindex="-1"></a>    hour <span class="op">=</span> yScale<span class="op">.</span><span class="fu">invert</span>(y)<span class="op">;</span></span>
<span id="cb30-1487"><a href="#cb30-1487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb30-1488"><a href="#cb30-1488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb30-1489"><a href="#cb30-1489" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb30-1490"><a href="#cb30-1490" aria-hidden="true" tabindex="-1"></a>  dateLine<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb30-1491"><a href="#cb30-1491" aria-hidden="true" tabindex="-1"></a>  dateLine</span>
<span id="cb30-1492"><a href="#cb30-1492" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb30-1493"><a href="#cb30-1493" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb30-1494"><a href="#cb30-1494" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb30-1495"><a href="#cb30-1495" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"rgba(0, 0, 0, 0)"</span>)</span>
<span id="cb30-1496"><a href="#cb30-1496" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"row-resize"</span>)</span>
<span id="cb30-1497"><a href="#cb30-1497" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleDateLineDrag))<span class="op">;</span></span>
<span id="cb30-1498"><a href="#cb30-1498" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb30-1499"><a href="#cb30-1499" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb30-1500"><a href="#cb30-1500" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"time-control"</span>)</span>
<span id="cb30-1501"><a href="#cb30-1501" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">12</span>)</span>
<span id="cb30-1502"><a href="#cb30-1502" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"red"</span>)</span>
<span id="cb30-1503"><a href="#cb30-1503" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)</span>
<span id="cb30-1504"><a href="#cb30-1504" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb30-1505"><a href="#cb30-1505" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"pointer"</span>)</span>
<span id="cb30-1506"><a href="#cb30-1506" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleTimeCircleDrag))<span class="op">;</span></span>
<span id="cb30-1507"><a href="#cb30-1507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb30-1508"><a href="#cb30-1508" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1509"><a href="#cb30-1509" aria-hidden="true" tabindex="-1"></a>fontSize <span class="op">=</span> <span class="dv">14</span><span class="op">;</span></span>
<span id="cb30-1510"><a href="#cb30-1510" aria-hidden="true" tabindex="-1"></a>getSolarAngle <span class="op">=</span> (date) <span class="kw">=&gt;</span> (<span class="fu">dayOfYear</span>(date) <span class="op">+</span> <span class="dv">10</span>) <span class="op">/</span> <span class="dv">365</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb30-1511"><a href="#cb30-1511" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb30-1512"><a href="#cb30-1512" aria-hidden="true" tabindex="-1"></a><span class="co"> * Formulas uses the CBM model as reviewed here:</span></span>
<span id="cb30-1513"><a href="#cb30-1513" aria-hidden="true" tabindex="-1"></a><span class="co"> * https://www.ikhebeenvraag.be/mediastorage/FSDocument/171/Forsythe+-+A+model+comparison+for+daylength+as+a+function+of+latitude+and+day+of+year+-+1995.pdf</span></span>
<span id="cb30-1514"><a href="#cb30-1514" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb30-1515"><a href="#cb30-1515" aria-hidden="true" tabindex="-1"></a>dayLength <span class="op">=</span> (date<span class="op">,</span> latitude) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1516"><a href="#cb30-1516" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb30-1517"><a href="#cb30-1517" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dayOfYear <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb30-1518"><a href="#cb30-1518" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> revAngle <span class="op">=</span> <span class="fl">0.2163108</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>(<span class="fl">0.9671396</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">tan</span>(<span class="fl">0.00860</span> <span class="op">*</span> (dayOfYear <span class="op">-</span> <span class="dv">186</span>)))<span class="op">;</span></span>
<span id="cb30-1519"><a href="#cb30-1519" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decAngle <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">asin</span>(<span class="fl">0.39795</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(revAngle))<span class="op">;</span></span>
<span id="cb30-1520"><a href="#cb30-1520" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* daylight coefficient selected for apparent sunrise/sunset */</span></span>
<span id="cb30-1521"><a href="#cb30-1521" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> p <span class="op">=</span> <span class="fl">0.8333</span></span>
<span id="cb30-1522"><a href="#cb30-1522" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> intResult <span class="op">=</span></span>
<span id="cb30-1523"><a href="#cb30-1523" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((p <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">+</span></span>
<span id="cb30-1524"><a href="#cb30-1524" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(decAngle)) <span class="op">/</span></span>
<span id="cb30-1525"><a href="#cb30-1525" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(decAngle))<span class="op">;</span></span>
<span id="cb30-1526"><a href="#cb30-1526" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&gt;=</span> <span class="dv">1</span>) <span class="cf">return</span> <span class="dv">24</span><span class="op">;</span></span>
<span id="cb30-1527"><a href="#cb30-1527" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&lt;=</span> <span class="op">-</span><span class="dv">1</span>) <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb30-1528"><a href="#cb30-1528" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">24</span> <span class="op">-</span> <span class="dv">24</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">acos</span>(intResult) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb30-1529"><a href="#cb30-1529" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1530"><a href="#cb30-1530" aria-hidden="true" tabindex="-1"></a>yearDates <span class="op">=</span> (year) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1531"><a href="#cb30-1531" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> startDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb30-1532"><a href="#cb30-1532" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> endDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb30-1533"><a href="#cb30-1533" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d3<span class="op">.</span><span class="at">timeDay</span><span class="op">.</span><span class="fu">range</span>(startDate<span class="op">,</span> endDate)<span class="op">;</span></span>
<span id="cb30-1534"><a href="#cb30-1534" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1535"><a href="#cb30-1535" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="fl">0.65</span> <span class="op">*</span> width<span class="op">;</span></span>
<span id="cb30-1536"><a href="#cb30-1536" aria-hidden="true" tabindex="-1"></a>EventType <span class="op">=</span> ({</span>
<span id="cb30-1537"><a href="#cb30-1537" aria-hidden="true" tabindex="-1"></a>  <span class="dt">LocationChange</span><span class="op">:</span> <span class="st">"LOCATION_CHANGE"</span><span class="op">,</span></span>
<span id="cb30-1538"><a href="#cb30-1538" aria-hidden="true" tabindex="-1"></a>  <span class="dt">DateHourChange</span><span class="op">:</span> <span class="st">"DATE_HOUR_CHANGE"</span></span>
<span id="cb30-1539"><a href="#cb30-1539" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb30-1540"><a href="#cb30-1540" aria-hidden="true" tabindex="-1"></a>mapcolors <span class="op">=</span> ({</span>
<span id="cb30-1541"><a href="#cb30-1541" aria-hidden="true" tabindex="-1"></a>  <span class="dt">night</span><span class="op">:</span> <span class="st">"#719fb6"</span><span class="op">,</span></span>
<span id="cb30-1542"><a href="#cb30-1542" aria-hidden="true" tabindex="-1"></a>  <span class="dt">day</span><span class="op">:</span> <span class="st">"#ffe438"</span><span class="op">,</span></span>
<span id="cb30-1543"><a href="#cb30-1543" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="st">"#4b6a79"</span><span class="op">,</span></span>
<span id="cb30-1544"><a href="#cb30-1544" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ocean</span><span class="op">:</span> <span class="st">"#adeeff"</span><span class="op">,</span></span>
<span id="cb30-1545"><a href="#cb30-1545" aria-hidden="true" tabindex="-1"></a>  <span class="dt">land</span><span class="op">:</span> <span class="st">"#90ff7888"</span><span class="op">,</span></span>
<span id="cb30-1546"><a href="#cb30-1546" aria-hidden="true" tabindex="-1"></a>  <span class="dt">sun</span><span class="op">:</span> <span class="st">"#ffb438"</span></span>
<span id="cb30-1547"><a href="#cb30-1547" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb30-1548"><a href="#cb30-1548" aria-hidden="true" tabindex="-1"></a>toRadians <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span></span>
<span id="cb30-1549"><a href="#cb30-1549" aria-hidden="true" tabindex="-1"></a>toDegrees <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="dv">180</span> <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb30-1550"><a href="#cb30-1550" aria-hidden="true" tabindex="-1"></a>land <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">land</span>)<span class="op">;</span></span>
<span id="cb30-1551"><a href="#cb30-1551" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3@7"</span><span class="op">,</span> <span class="st">"d3-geo-projection@3"</span>)</span>
<span id="cb30-1552"><a href="#cb30-1552" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">input</span>(config) {</span>
<span id="cb30-1553"><a href="#cb30-1553" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> {</span>
<span id="cb30-1554"><a href="#cb30-1554" aria-hidden="true" tabindex="-1"></a>    form<span class="op">,</span></span>
<span id="cb30-1555"><a href="#cb30-1555" aria-hidden="true" tabindex="-1"></a>    type <span class="op">=</span> <span class="st">"text"</span><span class="op">,</span></span>
<span id="cb30-1556"><a href="#cb30-1556" aria-hidden="true" tabindex="-1"></a>    attributes <span class="op">=</span> {}<span class="op">,</span></span>
<span id="cb30-1557"><a href="#cb30-1557" aria-hidden="true" tabindex="-1"></a>    action<span class="op">,</span></span>
<span id="cb30-1558"><a href="#cb30-1558" aria-hidden="true" tabindex="-1"></a>    getValue<span class="op">,</span></span>
<span id="cb30-1559"><a href="#cb30-1559" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb30-1560"><a href="#cb30-1560" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb30-1561"><a href="#cb30-1561" aria-hidden="true" tabindex="-1"></a>    format<span class="op">,</span></span>
<span id="cb30-1562"><a href="#cb30-1562" aria-hidden="true" tabindex="-1"></a>    display<span class="op">,</span></span>
<span id="cb30-1563"><a href="#cb30-1563" aria-hidden="true" tabindex="-1"></a>    submit<span class="op">,</span></span>
<span id="cb30-1564"><a href="#cb30-1564" aria-hidden="true" tabindex="-1"></a>    options</span>
<span id="cb30-1565"><a href="#cb30-1565" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> config<span class="op">;</span></span>
<span id="cb30-1566"><a href="#cb30-1566" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> wrapper <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb30-1567"><a href="#cb30-1567" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>form)</span>
<span id="cb30-1568"><a href="#cb30-1568" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form&gt;</span></span>
<span id="cb30-1569"><a href="#cb30-1569" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;input name=input type=</span><span class="sc">${</span>type<span class="sc">}</span><span class="vs"> /&gt;</span></span>
<span id="cb30-1570"><a href="#cb30-1570" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb30-1571"><a href="#cb30-1571" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(attributes)<span class="op">.</span><span class="fu">forEach</span>(key <span class="kw">=&gt;</span> {</span>
<span id="cb30-1572"><a href="#cb30-1572" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> val <span class="op">=</span> attributes[key]<span class="op">;</span></span>
<span id="cb30-1573"><a href="#cb30-1573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="op">!=</span> <span class="kw">null</span>) form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="fu">setAttribute</span>(key<span class="op">,</span> val)<span class="op">;</span></span>
<span id="cb30-1574"><a href="#cb30-1574" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb30-1575"><a href="#cb30-1575" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (submit)</span>
<span id="cb30-1576"><a href="#cb30-1576" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb30-1577"><a href="#cb30-1577" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;input name=submit type=submit style="margin: 0 0.75em" value="</span><span class="sc">${</span></span>
<span id="cb30-1578"><a href="#cb30-1578" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typeof</span> submit <span class="op">==</span> <span class="st">"string"</span> <span class="op">?</span> submit <span class="op">:</span> <span class="st">"Submit"</span></span>
<span id="cb30-1579"><a href="#cb30-1579" aria-hidden="true" tabindex="-1"></a>      <span class="sc">}</span><span class="vs">" /&gt;`</span></span>
<span id="cb30-1580"><a href="#cb30-1580" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb30-1581"><a href="#cb30-1581" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb30-1582"><a href="#cb30-1582" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html</span><span class="vs">`&lt;output name=output style="font: 14px Menlo, Consolas, monospace; margin-left: 0.1em; text-align:center;"&gt;&lt;/output&gt;`</span></span>
<span id="cb30-1583"><a href="#cb30-1583" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb30-1584"><a href="#cb30-1584" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (title)</span>
<span id="cb30-1585"><a href="#cb30-1585" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">prepend</span>(</span>
<span id="cb30-1586"><a href="#cb30-1586" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"&gt;</span><span class="sc">${</span>title<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb30-1587"><a href="#cb30-1587" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb30-1588"><a href="#cb30-1588" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (description)</span>
<span id="cb30-1589"><a href="#cb30-1589" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb30-1590"><a href="#cb30-1590" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font-size: 0.85rem; font-style: italic; margin-top: 3px;"&gt;</span><span class="sc">${</span>description<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb30-1591"><a href="#cb30-1591" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb30-1592"><a href="#cb30-1592" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (format)</span>
<span id="cb30-1593"><a href="#cb30-1593" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> <span class="kw">typeof</span> format <span class="op">===</span> <span class="st">"function"</span> <span class="op">?</span> format <span class="op">:</span> d3format<span class="op">.</span><span class="fu">format</span>(format)<span class="op">;</span></span>
<span id="cb30-1594"><a href="#cb30-1594" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (action) {</span>
<span id="cb30-1595"><a href="#cb30-1595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">action</span>(form)<span class="op">;</span></span>
<span id="cb30-1596"><a href="#cb30-1596" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb30-1597"><a href="#cb30-1597" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> verb <span class="op">=</span> submit</span>
<span id="cb30-1598"><a href="#cb30-1598" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onsubmit"</span></span>
<span id="cb30-1599"><a href="#cb30-1599" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"button"</span></span>
<span id="cb30-1600"><a href="#cb30-1600" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onclick"</span></span>
<span id="cb30-1601"><a href="#cb30-1601" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"checkbox"</span> <span class="op">||</span> type <span class="op">==</span> <span class="st">"radio"</span></span>
<span id="cb30-1602"><a href="#cb30-1602" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onchange"</span></span>
<span id="cb30-1603"><a href="#cb30-1603" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="st">"oninput"</span><span class="op">;</span></span>
<span id="cb30-1604"><a href="#cb30-1604" aria-hidden="true" tabindex="-1"></a>    form[verb] <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb30-1605"><a href="#cb30-1605" aria-hidden="true" tabindex="-1"></a>      e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb30-1606"><a href="#cb30-1606" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> value <span class="op">=</span> getValue <span class="op">?</span> <span class="fu">getValue</span>(form<span class="op">.</span><span class="at">input</span>) <span class="op">:</span> form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb30-1607"><a href="#cb30-1607" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (form<span class="op">.</span><span class="at">output</span>) {</span>
<span id="cb30-1608"><a href="#cb30-1608" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> out <span class="op">=</span> display <span class="op">?</span> <span class="fu">display</span>(value) <span class="op">:</span> format <span class="op">?</span> <span class="fu">format</span>(value) <span class="op">:</span> value<span class="op">;</span></span>
<span id="cb30-1609"><a href="#cb30-1609" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (out <span class="kw">instanceof</span> <span class="bu">window</span><span class="op">.</span><span class="at">Element</span>) {</span>
<span id="cb30-1610"><a href="#cb30-1610" aria-hidden="true" tabindex="-1"></a>          <span class="cf">while</span> (form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">hasChildNodes</span>()) {</span>
<span id="cb30-1611"><a href="#cb30-1611" aria-hidden="true" tabindex="-1"></a>            form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">removeChild</span>(form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">lastChild</span>)<span class="op">;</span></span>
<span id="cb30-1612"><a href="#cb30-1612" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb30-1613"><a href="#cb30-1613" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">append</span>(out)<span class="op">;</span></span>
<span id="cb30-1614"><a href="#cb30-1614" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb30-1615"><a href="#cb30-1615" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> out<span class="op">;</span></span>
<span id="cb30-1616"><a href="#cb30-1616" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb30-1617"><a href="#cb30-1617" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb30-1618"><a href="#cb30-1618" aria-hidden="true" tabindex="-1"></a>      form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb30-1619"><a href="#cb30-1619" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb30-1620"><a href="#cb30-1620" aria-hidden="true" tabindex="-1"></a>        form<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb30-1621"><a href="#cb30-1621" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb30-1622"><a href="#cb30-1622" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb30-1623"><a href="#cb30-1623" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">stopPropagation</span>() <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb30-1624"><a href="#cb30-1624" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"onsubmit"</span>) form<span class="op">.</span><span class="at">onsubmit</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb30-1625"><a href="#cb30-1625" aria-hidden="true" tabindex="-1"></a>    form[verb]()<span class="op">;</span></span>
<span id="cb30-1626"><a href="#cb30-1626" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-1627"><a href="#cb30-1627" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (form<span class="op">.</span><span class="at">childNodes</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb30-1628"><a href="#cb30-1628" aria-hidden="true" tabindex="-1"></a>    wrapper<span class="op">.</span><span class="fu">appendChild</span>(form<span class="op">.</span><span class="at">childNodes</span>[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb30-1629"><a href="#cb30-1629" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-1630"><a href="#cb30-1630" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(wrapper)<span class="op">;</span></span>
<span id="cb30-1631"><a href="#cb30-1631" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb30-1632"><a href="#cb30-1632" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1633"><a href="#cb30-1633" aria-hidden="true" tabindex="-1"></a>d3format <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3-format@1"</span>)</span>
<span id="cb30-1634"><a href="#cb30-1634" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@enjalot/draggable-world-map-coordinates-input</span></span>
<span id="cb30-1635"><a href="#cb30-1635" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">worldMapCoordinates</span>(config <span class="op">=</span> {}<span class="op">,</span> dimensions) {</span>
<span id="cb30-1636"><a href="#cb30-1636" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb30-1637"><a href="#cb30-1637" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> []<span class="op">,</span> title<span class="op">,</span> description<span class="op">,</span> width <span class="op">=</span> dimensions[<span class="dv">0</span>]</span>
<span id="cb30-1638"><a href="#cb30-1638" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(config) <span class="op">?</span> {<span class="dt">value</span><span class="op">:</span> config} <span class="op">:</span> config<span class="op">;</span></span>
<span id="cb30-1639"><a href="#cb30-1639" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> dimensions[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb30-1640"><a href="#cb30-1640" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> [lon<span class="op">,</span> lat] <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb30-1641"><a href="#cb30-1641" aria-hidden="true" tabindex="-1"></a>  lon <span class="op">=</span> lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb30-1642"><a href="#cb30-1642" aria-hidden="true" tabindex="-1"></a>  lat <span class="op">=</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb30-1643"><a href="#cb30-1643" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formEl <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form id="formEl" style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px;"&gt;&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb30-1644"><a href="#cb30-1644" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> context <span class="op">=</span> DOM<span class="op">.</span><span class="fu">context2d</span>(width<span class="op">,</span> height<span class="op">-</span>width<span class="op">/</span><span class="dv">14</span>)<span class="op">;</span></span>
<span id="cb30-1645"><a href="#cb30-1645" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> canvas <span class="op">=</span> context<span class="op">.</span><span class="at">canvas</span><span class="op">;</span></span>
<span id="cb30-1646"><a href="#cb30-1646" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">margin</span> <span class="op">=</span> <span class="vs">`0px 0px -26px 0px`</span><span class="op">;</span></span>
<span id="cb30-1647"><a href="#cb30-1647" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb30-1648"><a href="#cb30-1648" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoEquirectangular</span>()</span>
<span id="cb30-1649"><a href="#cb30-1649" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">precision</span>(<span class="fl">0.1</span>)</span>
<span id="cb30-1650"><a href="#cb30-1650" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitSize</span>([width<span class="op">,</span> height]<span class="op">,</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> })<span class="op">.</span><span class="fu">rotate</span>([<span class="op">-</span><span class="dv">153</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb30-1651"><a href="#cb30-1651" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection<span class="op">,</span> context)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">2.5</span>)<span class="op">;</span></span>
<span id="cb30-1652"><a href="#cb30-1652" aria-hidden="true" tabindex="-1"></a>  formEl<span class="op">.</span><span class="fu">append</span>(canvas)<span class="op">;</span></span>
<span id="cb30-1653"><a href="#cb30-1653" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">draw</span>() {</span>
<span id="cb30-1654"><a href="#cb30-1654" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">;</span></span>
<span id="cb30-1655"><a href="#cb30-1655" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fillRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb30-1656"><a href="#cb30-1656" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span>})<span class="op">;</span></span>
<span id="cb30-1657"><a href="#cb30-1657" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb30-1658"><a href="#cb30-1658" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb30-1659"><a href="#cb30-1659" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb30-1660"><a href="#cb30-1660" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(graticule)<span class="op">;</span></span>
<span id="cb30-1661"><a href="#cb30-1661" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">;</span></span>
<span id="cb30-1662"><a href="#cb30-1662" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="vs">`#aaa`</span><span class="op">;</span></span>
<span id="cb30-1663"><a href="#cb30-1663" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb30-1664"><a href="#cb30-1664" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb30-1665"><a href="#cb30-1665" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(land)<span class="op">;</span></span>
<span id="cb30-1666"><a href="#cb30-1666" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb30-1667"><a href="#cb30-1667" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb30-1668"><a href="#cb30-1668" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb30-1669"><a href="#cb30-1669" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(countries)<span class="op">;</span></span>
<span id="cb30-1670"><a href="#cb30-1670" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="op">.</span><span class="dv">95</span><span class="op">;</span></span>
<span id="cb30-1671"><a href="#cb30-1671" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#aaa"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb30-1672"><a href="#cb30-1672" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb30-1673"><a href="#cb30-1673" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#fff"</span> <span class="op">:</span> <span class="st">"#000"</span><span class="op">;</span></span>
<span id="cb30-1674"><a href="#cb30-1674" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">font</span> <span class="op">=</span> width <span class="op">&lt;</span> <span class="dv">760</span> <span class="op">?</span> <span class="st">"14px serif"</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">990</span> <span class="op">?</span> <span class="st">"17px serif"</span> <span class="op">:</span> <span class="st">"23px serif"</span><span class="op">;</span></span>
<span id="cb30-1675"><a href="#cb30-1675" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="dv">82</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">8.8</span>])))<span class="op">;</span></span>
<span id="cb30-1676"><a href="#cb30-1676" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="op">-</span><span class="dv">66</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">1.1</span>])))<span class="op">;</span></span>
<span id="cb30-1677"><a href="#cb30-1677" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">,</span> <span class="fu">path</span>(night)<span class="op">,</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"rgba(0,0,255,0.1)"</span><span class="op">,</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb30-1678"><a href="#cb30-1678" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> sun})<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"#0008"</span><span class="op">;</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"#ff08"</span><span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb30-1679"><a href="#cb30-1679" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> lat <span class="op">!=</span> <span class="kw">null</span>) {</span>
<span id="cb30-1680"><a href="#cb30-1680" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">;</span></span>
<span id="cb30-1681"><a href="#cb30-1681" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb30-1682"><a href="#cb30-1682" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb30-1683"><a href="#cb30-1683" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">14</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">;</span></span>
<span id="cb30-1684"><a href="#cb30-1684" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb30-1685"><a href="#cb30-1685" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb30-1686"><a href="#cb30-1686" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-1687"><a href="#cb30-1687" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> drag <span class="op">=</span> d3<span class="op">.</span><span class="fu">drag</span>()</span>
<span id="cb30-1688"><a href="#cb30-1688" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> (<span class="bu">event</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb30-1689"><a href="#cb30-1689" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([<span class="bu">event</span><span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb30-1690"><a href="#cb30-1690" aria-hidden="true" tabindex="-1"></a>      lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb30-1691"><a href="#cb30-1691" aria-hidden="true" tabindex="-1"></a>      lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb30-1692"><a href="#cb30-1692" aria-hidden="true" tabindex="-1"></a>      <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb30-1693"><a href="#cb30-1693" aria-hidden="true" tabindex="-1"></a>      canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb30-1694"><a href="#cb30-1694" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb30-1695"><a href="#cb30-1695" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(canvas)<span class="op">.</span><span class="fu">call</span>(drag)</span>
<span id="cb30-1696"><a href="#cb30-1696" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span>(ev) {</span>
<span id="cb30-1697"><a href="#cb30-1697" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> { offsetX<span class="op">,</span> offsetY } <span class="op">=</span> ev<span class="op">;</span></span>
<span id="cb30-1698"><a href="#cb30-1698" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([offsetX<span class="op">,</span> offsetY])<span class="op">;</span></span>
<span id="cb30-1699"><a href="#cb30-1699" aria-hidden="true" tabindex="-1"></a>    lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb30-1700"><a href="#cb30-1700" aria-hidden="true" tabindex="-1"></a>    lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb30-1701"><a href="#cb30-1701" aria-hidden="true" tabindex="-1"></a>    <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb30-1702"><a href="#cb30-1702" aria-hidden="true" tabindex="-1"></a>    canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb30-1703"><a href="#cb30-1703" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb30-1704"><a href="#cb30-1704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb30-1705"><a href="#cb30-1705" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">input</span>({</span>
<span id="cb30-1706"><a href="#cb30-1706" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"worldMapCoordinates"</span><span class="op">,</span></span>
<span id="cb30-1707"><a href="#cb30-1707" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb30-1708"><a href="#cb30-1708" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb30-1709"><a href="#cb30-1709" aria-hidden="true" tabindex="-1"></a>    <span class="dt">display</span><span class="op">:</span> v <span class="kw">=&gt;</span> (width <span class="op">&gt;</span> <span class="dv">300</span>) <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;div style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px; white-space: nowrap; color: window.darkmode ? #fff : #000; text-align: center; font: </span><span class="sc">${</span>width <span class="op">/</span> <span class="dv">40</span><span class="sc">}</span><span class="vs">px monospace; position: relative; top: </span><span class="sc">${</span><span class="op">-</span><span class="dv">16</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span><span class="sc">}</span><span class="vs">px;  margin-bottom: -.4em;"&gt;</span></span>
<span id="cb30-1710"><a href="#cb30-1710" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Zone:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> <span class="fu">long2zone</span>(lon) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb30-1711"><a href="#cb30-1711" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb30-1712"><a href="#cb30-1712" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Longitude:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">long2turn</span>(lon))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb30-1713"><a href="#cb30-1713" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb30-1714"><a href="#cb30-1714" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Latitude:&lt;/span&gt; </span><span class="sc">${</span>lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">lati2turn</span>(lat))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb30-1715"><a href="#cb30-1715" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="op">,</span></span>
<span id="cb30-1716"><a href="#cb30-1716" aria-hidden="true" tabindex="-1"></a>    <span class="dt">getValue</span><span class="op">:</span> () <span class="kw">=&gt;</span> [lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span>]<span class="op">,</span></span>
<span id="cb30-1717"><a href="#cb30-1717" aria-hidden="true" tabindex="-1"></a>    <span class="dt">form</span><span class="op">:</span> formEl</span>
<span id="cb30-1718"><a href="#cb30-1718" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb30-1719"><a href="#cb30-1719" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb30-1720"><a href="#cb30-1720" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-1721"><a href="#cb30-1721" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-42" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-43" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-44" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-45" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-46" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-47" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-48" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-49" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-50" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-51" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-52" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-53" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-54" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-55" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-56" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-57" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-58" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-59" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-60" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-61" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-62" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-63" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-64" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-65" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-66" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-67" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-68" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="1722" data-source-offset="-28649"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1721;"><span id="cb31-1722"><a href="#cb31-1722" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByClassName</span>(<span class="st">"quarto-color-scheme-toggle"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span> (e) {</span>
<span id="cb31-1723"><a href="#cb31-1723" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">quartoToggleColorScheme</span>()<span class="op">;</span></span>
<span id="cb31-1724"><a href="#cb31-1724" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb31-1725"><a href="#cb31-1725" aria-hidden="true" tabindex="-1"></a>  worldMapCoordinates<span class="op">.</span><span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb31-1726"><a href="#cb31-1726" aria-hidden="true" tabindex="-1"></a>  app<span class="op">.</span><span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb31-1727"><a href="#cb31-1727" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb31-1728"><a href="#cb31-1728" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-69" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb32" data-startfrom="1729" data-source-offset="-28951"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1728;"><span id="cb32-1729"><a href="#cb32-1729" aria-hidden="true" tabindex="-1"></a>sun <span class="op">=</span> {</span>
<span id="cb32-1730"><a href="#cb32-1730" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> now <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span><span class="op">;</span></span>
<span id="cb32-1731"><a href="#cb32-1731" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> day <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="op">+</span>now)<span class="op">.</span><span class="fu">setUTCHours</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb32-1732"><a href="#cb32-1732" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> t <span class="op">=</span> solar<span class="op">.</span><span class="fu">century</span>(now)<span class="op">;</span></span>
<span id="cb32-1733"><a href="#cb32-1733" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> longitude <span class="op">=</span> (day <span class="op">-</span> now) <span class="op">/</span> <span class="fl">864e5</span> <span class="op">*</span> <span class="dv">360</span> <span class="op">-</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb32-1734"><a href="#cb32-1734" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [longitude <span class="op">-</span> solar<span class="op">.</span><span class="fu">equationOfTime</span>(t) <span class="op">/</span> <span class="dv">4</span><span class="op">,</span> solar<span class="op">.</span><span class="fu">declination</span>(t)]<span class="op">;</span></span>
<span id="cb32-1735"><a href="#cb32-1735" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-1736"><a href="#cb32-1736" aria-hidden="true" tabindex="-1"></a>night <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoCircle</span>()</span>
<span id="cb32-1737"><a href="#cb32-1737" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">radius</span>(<span class="dv">90</span>)</span>
<span id="cb32-1738"><a href="#cb32-1738" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">center</span>(<span class="fu">antipode</span>(sun))</span>
<span id="cb32-1739"><a href="#cb32-1739" aria-hidden="true" tabindex="-1"></a>  ()</span>
<span id="cb32-1740"><a href="#cb32-1740" aria-hidden="true" tabindex="-1"></a>antipode <span class="op">=</span> ([longitude<span class="op">,</span> latitude]) <span class="kw">=&gt;</span> [longitude <span class="op">+</span> <span class="dv">180</span><span class="op">,</span> <span class="op">-</span>latitude]</span>
<span id="cb32-1741"><a href="#cb32-1741" aria-hidden="true" tabindex="-1"></a>solar <span class="op">=</span> <span class="pp">require</span>(<span class="st">"solar-calculator@0.3/dist/solar-calculator.min.js"</span>)</span>
<span id="cb32-1742"><a href="#cb32-1742" aria-hidden="true" tabindex="-1"></a>viewof fancySecondsOFF <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({</span>
<span id="cb32-1743"><a href="#cb32-1743" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Ticking clock"</span><span class="op">,</span></span>
<span id="cb32-1744"><a href="#cb32-1744" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb32-1745"><a href="#cb32-1745" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-1746"><a href="#cb32-1746" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setStyle</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb32-1747"><a href="#cb32-1747" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb32-1748"><a href="#cb32-1748" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb32-1749"><a href="#cb32-1749" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb32-1750"><a href="#cb32-1750" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-1751"><a href="#cb32-1751" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb32-1752"><a href="#cb32-1752" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb32-1753"><a href="#cb32-1753" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;=</span> <span class="fl">0.6</span> <span class="op">?</span> <span class="st">"#111"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb32-1754"><a href="#cb32-1754" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 1px"</span><span class="op">,</span></span>
<span id="cb32-1755"><a href="#cb32-1755" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb32-1756"><a href="#cb32-1756" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb32-1757"><a href="#cb32-1757" aria-hidden="true" tabindex="-1"></a>    fontSize <span class="op">=</span> <span class="st">"1em"</span><span class="op">,</span></span>
<span id="cb32-1758"><a href="#cb32-1758" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb32-1759"><a href="#cb32-1759" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb32-1760"><a href="#cb32-1760" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb32-1761"><a href="#cb32-1761" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb32-1762"><a href="#cb32-1762" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb32-1763"><a href="#cb32-1763" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb32-1764"><a href="#cb32-1764" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb32-1765"><a href="#cb32-1765" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb32-1766"><a href="#cb32-1766" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb32-1767"><a href="#cb32-1767" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb32-1768"><a href="#cb32-1768" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-1769"><a href="#cb32-1769" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb32-1770"><a href="#cb32-1770" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb32-1771"><a href="#cb32-1771" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb32-1772"><a href="#cb32-1772" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-1773"><a href="#cb32-1773" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">textcolor</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb32-1774"><a href="#cb32-1774" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb32-1775"><a href="#cb32-1775" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb32-1776"><a href="#cb32-1776" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"#000"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb32-1777"><a href="#cb32-1777" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 5px"</span><span class="op">,</span></span>
<span id="cb32-1778"><a href="#cb32-1778" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb32-1779"><a href="#cb32-1779" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb32-1780"><a href="#cb32-1780" aria-hidden="true" tabindex="-1"></a>    fontFamily <span class="op">=</span> <span class="st">"monospace"</span><span class="op">,</span></span>
<span id="cb32-1781"><a href="#cb32-1781" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb32-1782"><a href="#cb32-1782" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb32-1783"><a href="#cb32-1783" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb32-1784"><a href="#cb32-1784" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb32-1785"><a href="#cb32-1785" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb32-1786"><a href="#cb32-1786" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb32-1787"><a href="#cb32-1787" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb32-1788"><a href="#cb32-1788" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb32-1789"><a href="#cb32-1789" aria-hidden="true" tabindex="-1"></a>    fontFamily<span class="op">,</span></span>
<span id="cb32-1790"><a href="#cb32-1790" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb32-1791"><a href="#cb32-1791" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb32-1792"><a href="#cb32-1792" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-1793"><a href="#cb32-1793" aria-hidden="true" tabindex="-1"></a>elapsed <span class="op">=</span> {</span>
<span id="cb32-1794"><a href="#cb32-1794" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-1795"><a href="#cb32-1795" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb32-1796"><a href="#cb32-1796" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> Promises<span class="op">.</span><span class="fu">tick</span>(<span class="dv">864</span><span class="op">,</span> <span class="op">++</span>i)<span class="op">;</span></span>
<span id="cb32-1797"><a href="#cb32-1797" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-1798"><a href="#cb32-1798" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-1799"><a href="#cb32-1799" aria-hidden="true" tabindex="-1"></a>piecewiseColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">piecewise</span>(d3<span class="op">.</span><span class="at">interpolateRgb</span><span class="op">,</span> [</span>
<span id="cb32-1800"><a href="#cb32-1800" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0   0 red</span></span>
<span id="cb32-1801"><a href="#cb32-1801" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f50"</span><span class="op">,</span>    <span class="co">//  0.25  20 yr</span></span>
<span id="cb32-1802"><a href="#cb32-1802" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f60"</span><span class="op">,</span>    <span class="co">//  0.5   24 yr orangered</span></span>
<span id="cb32-1803"><a href="#cb32-1803" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f70"</span><span class="op">,</span>    <span class="co">//  0.75  28 yr</span></span>
<span id="cb32-1804"><a href="#cb32-1804" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f90"</span><span class="op">,</span>    <span class="co">//  1     36 yr orange</span></span>
<span id="cb32-1805"><a href="#cb32-1805" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fb0"</span><span class="op">,</span>    <span class="co">//  1.25  44 yr</span></span>
<span id="cb32-1806"><a href="#cb32-1806" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fc0"</span><span class="op">,</span>    <span class="co">//  1.5   48 yr yelloworange</span></span>
<span id="cb32-1807"><a href="#cb32-1807" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fd0"</span><span class="op">,</span>    <span class="co">//  1.75  52 yr</span></span>
<span id="cb32-1808"><a href="#cb32-1808" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ff0"</span><span class="op">,</span>    <span class="co">//  2     60 yellow</span></span>
<span id="cb32-1809"><a href="#cb32-1809" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ef0"</span><span class="op">,</span>    <span class="co">//  2.25  64 gy</span></span>
<span id="cb32-1810"><a href="#cb32-1810" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#df0"</span><span class="op">,</span>    <span class="co">//  2.5   68 gy limeyellow</span></span>
<span id="cb32-1811"><a href="#cb32-1811" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#cf0"</span><span class="op">,</span>    <span class="co">//  2.75  72 gy</span></span>
<span id="cb32-1812"><a href="#cb32-1812" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#af0"</span><span class="op">,</span>    <span class="co">//  3     80 gy lime</span></span>
<span id="cb32-1813"><a href="#cb32-1813" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#8f0"</span><span class="op">,</span>    <span class="co">//  3.25  88 gy</span></span>
<span id="cb32-1814"><a href="#cb32-1814" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#7f0"</span><span class="op">,</span>    <span class="co">//  3.5   92 gy greenlime</span></span>
<span id="cb32-1815"><a href="#cb32-1815" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#6f0"</span><span class="op">,</span>    <span class="co">//  3.75  96 gy</span></span>
<span id="cb32-1816"><a href="#cb32-1816" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f0"</span><span class="op">,</span>    <span class="co">//  4    120 green</span></span>
<span id="cb32-1817"><a href="#cb32-1817" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f7"</span><span class="op">,</span>    <span class="co">//  4.25 148 cg</span></span>
<span id="cb32-1818"><a href="#cb32-1818" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f9"</span><span class="op">,</span>    <span class="co">//  4.5  156 cg cyangreen</span></span>
<span id="cb32-1819"><a href="#cb32-1819" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0fb"</span><span class="op">,</span>    <span class="co">//  4.75 164 cg</span></span>
<span id="cb32-1820"><a href="#cb32-1820" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0ff"</span><span class="op">,</span>    <span class="co">//  5    180 cyan</span></span>
<span id="cb32-1821"><a href="#cb32-1821" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0cf"</span><span class="op">,</span>    <span class="co">//  5.25 192 bc</span></span>
<span id="cb32-1822"><a href="#cb32-1822" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0bf"</span><span class="op">,</span>    <span class="co">//  5.5  196 bc azurecyan</span></span>
<span id="cb32-1823"><a href="#cb32-1823" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0af"</span><span class="op">,</span>    <span class="co">//  5.75 200 bc</span></span>
<span id="cb32-1824"><a href="#cb32-1824" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#08f"</span><span class="op">,</span>    <span class="co">//  6    208 bc azure</span></span>
<span id="cb32-1825"><a href="#cb32-1825" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#06f"</span><span class="op">,</span>    <span class="co">//  6.25 216 bc</span></span>
<span id="cb32-1826"><a href="#cb32-1826" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#05f"</span><span class="op">,</span>    <span class="co">//  6.5  220 bc blueazure</span></span>
<span id="cb32-1827"><a href="#cb32-1827" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#04f"</span><span class="op">,</span>    <span class="co">//  6.75 224 bc</span></span>
<span id="cb32-1828"><a href="#cb32-1828" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#00f"</span><span class="op">,</span>    <span class="co">//  7    240 blue</span></span>
<span id="cb32-1829"><a href="#cb32-1829" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#50f"</span><span class="op">,</span>    <span class="co">//  7.25 260 mb</span></span>
<span id="cb32-1830"><a href="#cb32-1830" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#60f"</span><span class="op">,</span>    <span class="co">//  7.5  264 mb purpleblue</span></span>
<span id="cb32-1831"><a href="#cb32-1831" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#70f"</span><span class="op">,</span>    <span class="co">//  7.75 268 mb</span></span>
<span id="cb32-1832"><a href="#cb32-1832" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#90f"</span><span class="op">,</span>    <span class="co">//  8    276 mb purple</span></span>
<span id="cb32-1833"><a href="#cb32-1833" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#b0f"</span><span class="op">,</span>    <span class="co">//  8.25 284 mb</span></span>
<span id="cb32-1834"><a href="#cb32-1834" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#c0f"</span><span class="op">,</span>    <span class="co">//  8.5  288 mb violetpurple</span></span>
<span id="cb32-1835"><a href="#cb32-1835" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#d0f"</span><span class="op">,</span>    <span class="co">//  8.75 292 mb</span></span>
<span id="cb32-1836"><a href="#cb32-1836" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0f"</span><span class="op">,</span>    <span class="co">//  9    300 magenta</span></span>
<span id="cb32-1837"><a href="#cb32-1837" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0a"</span><span class="op">,</span>    <span class="co">//  9.25 320 rm</span></span>
<span id="cb32-1838"><a href="#cb32-1838" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f08"</span><span class="op">,</span>    <span class="co">//  9.5  328 rm</span></span>
<span id="cb32-1839"><a href="#cb32-1839" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f06"</span><span class="op">,</span>    <span class="co">//  9.75 336 rm</span></span>
<span id="cb32-1840"><a href="#cb32-1840" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0        0 red</span></span>
<span id="cb32-1841"><a href="#cb32-1841" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb32-1842"><a href="#cb32-1842" aria-hidden="true" tabindex="-1"></a>slStr <span class="op">=</span> <span class="vs">`, 100%, 50%)`</span></span>
<span id="cb32-1843"><a href="#cb32-1843" aria-hidden="true" tabindex="-1"></a>elaTime <span class="op">=</span> elapsed <span class="op">%</span> <span class="fl">1e5</span></span>
<span id="cb32-1844"><a href="#cb32-1844" aria-hidden="true" tabindex="-1"></a>elaTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(elaTime<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(elaTime <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb32-1845"><a href="#cb32-1845" aria-hidden="true" tabindex="-1"></a>decMoty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> decDate <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)</span>
<span id="cb32-1846"><a href="#cb32-1846" aria-hidden="true" tabindex="-1"></a>isoYear <span class="op">=</span> decYear <span class="op">+</span> (decMoty <span class="op">&gt;</span> <span class="dv">9</span>)</span>
<span id="cb32-1847"><a href="#cb32-1847" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> decMoty <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> decMoty <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> decMoty <span class="op">-</span> <span class="dv">9</span></span>
<span id="cb32-1848"><a href="#cb32-1848" aria-hidden="true" tabindex="-1"></a>decHour <span class="op">=</span> decTime <span class="op">*</span> <span class="dv">24</span></span>
<span id="cb32-1849"><a href="#cb32-1849" aria-hidden="true" tabindex="-1"></a>decMinute <span class="op">=</span> (decHour <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb32-1850"><a href="#cb32-1850" aria-hidden="true" tabindex="-1"></a>decSecond <span class="op">=</span> (decMinute <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb32-1851"><a href="#cb32-1851" aria-hidden="true" tabindex="-1"></a>isoHour <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decHour)</span>
<span id="cb32-1852"><a href="#cb32-1852" aria-hidden="true" tabindex="-1"></a>isoMinute <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decMinute)</span>
<span id="cb32-1853"><a href="#cb32-1853" aria-hidden="true" tabindex="-1"></a>isoSecond <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decSecond)</span>
<span id="cb32-1854"><a href="#cb32-1854" aria-hidden="true" tabindex="-1"></a>decDek <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">/</span> <span class="dv">10</span>)</span>
<span id="cb32-1855"><a href="#cb32-1855" aria-hidden="true" tabindex="-1"></a>decDod <span class="op">=</span> decDate <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb32-1856"><a href="#cb32-1856" aria-hidden="true" tabindex="-1"></a>decDotm <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">-</span> (<span class="dv">153</span> <span class="op">*</span> decMoty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb32-1857"><a href="#cb32-1857" aria-hidden="true" tabindex="-1"></a>selDote <span class="op">=</span> <span class="fu">unix2dote</span>(selectedDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> <span class="dv">86400000</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb32-1858"><a href="#cb32-1858" aria-hidden="true" tabindex="-1"></a>selDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">dote2date</span>(<span class="op">...</span>selDote)[<span class="dv">1</span>])</span>
<span id="cb32-1859"><a href="#cb32-1859" aria-hidden="true" tabindex="-1"></a>selTime <span class="op">=</span> selectedHour <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb32-1860"><a href="#cb32-1860" aria-hidden="true" tabindex="-1"></a>selTimeOne <span class="op">=</span> selTime <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb32-1861"><a href="#cb32-1861" aria-hidden="true" tabindex="-1"></a>selTimeTen <span class="op">=</span> selTime <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb32-1862"><a href="#cb32-1862" aria-hidden="true" tabindex="-1"></a>selSnap <span class="op">=</span> selDate <span class="op">+</span> selTime</span>
<span id="cb32-1863"><a href="#cb32-1863" aria-hidden="true" tabindex="-1"></a>selLati <span class="op">=</span> <span class="fu">lati2turn</span>(location[<span class="dv">1</span>])</span>
<span id="cb32-1864"><a href="#cb32-1864" aria-hidden="true" tabindex="-1"></a>decDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(decDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decDate <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> isLeapYear)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1865"><a href="#cb32-1865" aria-hidden="true" tabindex="-1"></a>decTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(decTime<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decTime <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1866"><a href="#cb32-1866" aria-hidden="true" tabindex="-1"></a>selDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(selDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selDate <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1867"><a href="#cb32-1867" aria-hidden="true" tabindex="-1"></a>selLatiHsl <span class="op">=</span> <span class="fu">textcolor</span>(selLati<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>((selLati <span class="op">+</span> <span class="dv">250</span>) <span class="op">%</span> <span class="dv">250</span> <span class="op">/</span> <span class="dv">250</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1868"><a href="#cb32-1868" aria-hidden="true" tabindex="-1"></a>selTimeDay <span class="op">=</span> <span class="fu">textcolor</span>(selTimeOne<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1869"><a href="#cb32-1869" aria-hidden="true" tabindex="-1"></a>selTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1870"><a href="#cb32-1870" aria-hidden="true" tabindex="-1"></a>selTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1871"><a href="#cb32-1871" aria-hidden="true" tabindex="-1"></a>selZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1872"><a href="#cb32-1872" aria-hidden="true" tabindex="-1"></a>selSnapDay <span class="op">=</span> <span class="fu">textcolor</span>(selSnap<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">9</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1873"><a href="#cb32-1873" aria-hidden="true" tabindex="-1"></a>selSnapDec <span class="op">=</span> <span class="fu">textcolor</span>((selSnap <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">9</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1874"><a href="#cb32-1874" aria-hidden="true" tabindex="-1"></a>decZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb32-1875"><a href="#cb32-1875" aria-hidden="true" tabindex="-1"></a>isLeapYear <span class="op">=</span> decYear <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> decYear <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> decYear <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb32-1876"><a href="#cb32-1876" aria-hidden="true" tabindex="-1"></a>viewof selectedDate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022)</span>
<span id="cb32-1877"><a href="#cb32-1877" aria-hidden="true" tabindex="-1"></a>viewof selectedHour <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb32-1878"><a href="#cb32-1878" aria-hidden="true" tabindex="-1"></a>date2022 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getMonth</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getDate</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb32-1879"><a href="#cb32-1879" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">set</span>(input<span class="op">,</span> value) {</span>
<span id="cb32-1880"><a href="#cb32-1880" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb32-1881"><a href="#cb32-1881" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb32-1882"><a href="#cb32-1882" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-1883"><a href="#cb32-1883" aria-hidden="true" tabindex="-1"></a>hD121 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">121</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb32-1884"><a href="#cb32-1884" aria-hidden="true" tabindex="-1"></a>hD268 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">268</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb32-1885"><a href="#cb32-1885" aria-hidden="true" tabindex="-1"></a>hD305 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">305</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb32-1886"><a href="#cb32-1886" aria-hidden="true" tabindex="-1"></a>hD306 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">306</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb32-1887"><a href="#cb32-1887" aria-hidden="true" tabindex="-1"></a>h1by320 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">1</span> <span class="op">/</span> <span class="dv">320</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb32-1888"><a href="#cb32-1888" aria-hidden="true" tabindex="-1"></a>hues <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">fromEntries</span>([</span>
<span id="cb32-1889"><a href="#cb32-1889" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0083</span><span class="op">,</span></span>
<span id="cb32-1890"><a href="#cb32-1890" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0166</span><span class="op">,</span></span>
<span id="cb32-1891"><a href="#cb32-1891" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0229</span><span class="op">,</span></span>
<span id="cb32-1892"><a href="#cb32-1892" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">025</span><span class="op">,</span></span>
<span id="cb32-1893"><a href="#cb32-1893" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">287</span><span class="op">,</span></span>
<span id="cb32-1894"><a href="#cb32-1894" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0333</span><span class="op">,</span></span>
<span id="cb32-1895"><a href="#cb32-1895" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0416</span><span class="op">,</span></span>
<span id="cb32-1896"><a href="#cb32-1896" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">05</span><span class="op">,</span></span>
<span id="cb32-1897"><a href="#cb32-1897" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">125</span><span class="op">,</span></span>
<span id="cb32-1898"><a href="#cb32-1898" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">333</span><span class="op">,</span></span>
<span id="cb32-1899"><a href="#cb32-1899" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">375</span><span class="op">,</span></span>
<span id="cb32-1900"><a href="#cb32-1900" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">429</span><span class="op">,</span></span>
<span id="cb32-1901"><a href="#cb32-1901" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">533</span><span class="op">,</span></span>
<span id="cb32-1902"><a href="#cb32-1902" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">969</span><span class="op">,</span></span>
<span id="cb32-1903"><a href="#cb32-1903" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">999</span><span class="op">,</span></span>
<span id="cb32-1904"><a href="#cb32-1904" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> [i<span class="op">,</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(i))<span class="op">.</span><span class="at">h</span>])</span>
<span id="cb32-1905"><a href="#cb32-1905" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb32-1906"><a href="#cb32-1906" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb32-1907"><a href="#cb32-1907" aria-hidden="true" tabindex="-1"></a>populationByTimeZone <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"../../asset/populationByTimeZone.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb32-1908"><a href="#cb32-1908" aria-hidden="true" tabindex="-1"></a>sortedPop <span class="op">=</span> populationByTimeZone<span class="op">.</span><span class="fu">sort</span>(</span>
<span id="cb32-1909"><a href="#cb32-1909" aria-hidden="true" tabindex="-1"></a>  (a<span class="op">,</span> b) <span class="kw">=&gt;</span> sortParams[<span class="dv">1</span>] <span class="op">?</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">number</span><span class="op">,</span> b<span class="op">.</span><span class="at">number</span>) <span class="op">:</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">pop</span><span class="op">,</span> b<span class="op">.</span><span class="at">pop</span>)</span>
<span id="cb32-1910"><a href="#cb32-1910" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-1911"><a href="#cb32-1911" aria-hidden="true" tabindex="-1"></a>sortFunc <span class="op">=</span> sortParams[<span class="dv">0</span>] <span class="op">?</span> d3<span class="op">.</span><span class="at">ascending</span> <span class="op">:</span> d3<span class="op">.</span><span class="at">descending</span></span>
<span id="cb32-1912"><a href="#cb32-1912" aria-hidden="true" tabindex="-1"></a>popBySign <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(sortedPop<span class="op">,</span> v <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">sum</span>(v<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Sign</span>)</span>
<span id="cb32-1913"><a href="#cb32-1913" aria-hidden="true" tabindex="-1"></a>totalPop <span class="op">=</span> d3<span class="op">.</span><span class="fu">sum</span>(sortedPop<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-70" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-71" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-72" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-73" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-74" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-75" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-76" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-77" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-78" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-79" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-80" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-81" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-82" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-83" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-84" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-85" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-86" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-87" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-88" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-89" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-90" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-91" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-92" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-93" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-94" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-95" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-96" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-97" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-98" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-99" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-100" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-101" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-102" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-103" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-104" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-105" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-106" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-107" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-108" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-109" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-110" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-111" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-112" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-113" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-114" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-115" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-116" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-117" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-118" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-119" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-120" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-121" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-122" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-123" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-124" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-125" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-126" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-127" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-7-128" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="1918" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1917;"><span id="cb33-1918"><a href="#cb33-1918" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb33-1919"><a href="#cb33-1919" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb33-1920"><a href="#cb33-1920" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorNight {</span></span>
<span id="cb33-1921"><a href="#cb33-1921" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #416f86;</span></span>
<span id="cb33-1922"><a href="#cb33-1922" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: white;</span></span>
<span id="cb33-1923"><a href="#cb33-1923" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 2px 0px 4px;</span></span>
<span id="cb33-1924"><a href="#cb33-1924" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1925"><a href="#cb33-1925" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1926"><a href="#cb33-1926" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1927"><a href="#cb33-1927" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1928"><a href="#cb33-1928" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorDay {</span></span>
<span id="cb33-1929"><a href="#cb33-1929" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #ffe438;</span></span>
<span id="cb33-1930"><a href="#cb33-1930" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: black;</span></span>
<span id="cb33-1931"><a href="#cb33-1931" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 3px 0px 4px;</span></span>
<span id="cb33-1932"><a href="#cb33-1932" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1933"><a href="#cb33-1933" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1934"><a href="#cb33-1934" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1935"><a href="#cb33-1935" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1936"><a href="#cb33-1936" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorBkg {</span></span>
<span id="cb33-1937"><a href="#cb33-1937" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1938"><a href="#cb33-1938" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"white"</span> <span class="op">:</span> <span class="st">"black"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1939"><a href="#cb33-1939" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1940"><a href="#cb33-1940" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1941"><a href="#cb33-1941" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1942"><a href="#cb33-1942" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1943"><a href="#cb33-1943" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1944"><a href="#cb33-1944" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0 {</span></span>
<span id="cb33-1945"><a href="#cb33-1945" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(0 100% 50%);</span></span>
<span id="cb33-1946"><a href="#cb33-1946" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(0, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1947"><a href="#cb33-1947" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1948"><a href="#cb33-1948" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1949"><a href="#cb33-1949" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1950"><a href="#cb33-1950" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1951"><a href="#cb33-1951" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1952"><a href="#cb33-1952" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1 {</span></span>
<span id="cb33-1953"><a href="#cb33-1953" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(300 100% 50%);</span></span>
<span id="cb33-1954"><a href="#cb33-1954" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(300, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1955"><a href="#cb33-1955" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1956"><a href="#cb33-1956" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1957"><a href="#cb33-1957" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1958"><a href="#cb33-1958" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1959"><a href="#cb33-1959" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1960"><a href="#cb33-1960" aria-hidden="true" tabindex="-1"></a><span class="vs">.color2 {</span></span>
<span id="cb33-1961"><a href="#cb33-1961" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(280 100% 50%);</span></span>
<span id="cb33-1962"><a href="#cb33-1962" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(280, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1963"><a href="#cb33-1963" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1964"><a href="#cb33-1964" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1965"><a href="#cb33-1965" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1966"><a href="#cb33-1966" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1967"><a href="#cb33-1967" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1968"><a href="#cb33-1968" aria-hidden="true" tabindex="-1"></a><span class="vs">.color3 {</span></span>
<span id="cb33-1969"><a href="#cb33-1969" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(240 100% 50%);</span></span>
<span id="cb33-1970"><a href="#cb33-1970" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(240, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1971"><a href="#cb33-1971" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1972"><a href="#cb33-1972" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1973"><a href="#cb33-1973" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1974"><a href="#cb33-1974" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1975"><a href="#cb33-1975" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1976"><a href="#cb33-1976" aria-hidden="true" tabindex="-1"></a><span class="vs">.color4 {</span></span>
<span id="cb33-1977"><a href="#cb33-1977" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(200 100% 50%);</span></span>
<span id="cb33-1978"><a href="#cb33-1978" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(200, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1979"><a href="#cb33-1979" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1980"><a href="#cb33-1980" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1981"><a href="#cb33-1981" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1982"><a href="#cb33-1982" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1983"><a href="#cb33-1983" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1984"><a href="#cb33-1984" aria-hidden="true" tabindex="-1"></a><span class="vs">.color5 {</span></span>
<span id="cb33-1985"><a href="#cb33-1985" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(180 100% 50%);</span></span>
<span id="cb33-1986"><a href="#cb33-1986" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(180, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1987"><a href="#cb33-1987" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1988"><a href="#cb33-1988" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1989"><a href="#cb33-1989" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1990"><a href="#cb33-1990" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1991"><a href="#cb33-1991" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-1992"><a href="#cb33-1992" aria-hidden="true" tabindex="-1"></a><span class="vs">.color6 {</span></span>
<span id="cb33-1993"><a href="#cb33-1993" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(120 100% 50%);</span></span>
<span id="cb33-1994"><a href="#cb33-1994" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(120, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-1995"><a href="#cb33-1995" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-1996"><a href="#cb33-1996" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-1997"><a href="#cb33-1997" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-1998"><a href="#cb33-1998" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-1999"><a href="#cb33-1999" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2000"><a href="#cb33-2000" aria-hidden="true" tabindex="-1"></a><span class="vs">.color7 {</span></span>
<span id="cb33-2001"><a href="#cb33-2001" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(80 100% 50%);</span></span>
<span id="cb33-2002"><a href="#cb33-2002" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(80, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2003"><a href="#cb33-2003" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2004"><a href="#cb33-2004" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2005"><a href="#cb33-2005" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2006"><a href="#cb33-2006" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2007"><a href="#cb33-2007" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2008"><a href="#cb33-2008" aria-hidden="true" tabindex="-1"></a><span class="vs">.color8 {</span></span>
<span id="cb33-2009"><a href="#cb33-2009" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(60 100% 50%);</span></span>
<span id="cb33-2010"><a href="#cb33-2010" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(60, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2011"><a href="#cb33-2011" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2012"><a href="#cb33-2012" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2013"><a href="#cb33-2013" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2014"><a href="#cb33-2014" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2015"><a href="#cb33-2015" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2016"><a href="#cb33-2016" aria-hidden="true" tabindex="-1"></a><span class="vs">.color9 {</span></span>
<span id="cb33-2017"><a href="#cb33-2017" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(40 100% 50%);</span></span>
<span id="cb33-2018"><a href="#cb33-2018" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(40, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2019"><a href="#cb33-2019" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2020"><a href="#cb33-2020" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2021"><a href="#cb33-2021" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2022"><a href="#cb33-2022" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2023"><a href="#cb33-2023" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2024"><a href="#cb33-2024" aria-hidden="true" tabindex="-1"></a><span class="vs">.color375 {</span></span>
<span id="cb33-2025"><a href="#cb33-2025" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2026"><a href="#cb33-2026" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2027"><a href="#cb33-2027" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2028"><a href="#cb33-2028" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2029"><a href="#cb33-2029" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2030"><a href="#cb33-2030" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2031"><a href="#cb33-2031" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2032"><a href="#cb33-2032" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0083 {</span></span>
<span id="cb33-2033"><a href="#cb33-2033" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2034"><a href="#cb33-2034" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2035"><a href="#cb33-2035" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2036"><a href="#cb33-2036" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2037"><a href="#cb33-2037" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2038"><a href="#cb33-2038" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2039"><a href="#cb33-2039" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2040"><a href="#cb33-2040" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0166 {</span></span>
<span id="cb33-2041"><a href="#cb33-2041" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2042"><a href="#cb33-2042" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2043"><a href="#cb33-2043" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2044"><a href="#cb33-2044" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2045"><a href="#cb33-2045" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2046"><a href="#cb33-2046" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2047"><a href="#cb33-2047" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2048"><a href="#cb33-2048" aria-hidden="true" tabindex="-1"></a><span class="vs">.color55by24 {</span></span>
<span id="cb33-2049"><a href="#cb33-2049" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2050"><a href="#cb33-2050" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2051"><a href="#cb33-2051" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2052"><a href="#cb33-2052" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2053"><a href="#cb33-2053" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2054"><a href="#cb33-2054" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2055"><a href="#cb33-2055" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2056"><a href="#cb33-2056" aria-hidden="true" tabindex="-1"></a><span class="vs">.color125 {</span></span>
<span id="cb33-2057"><a href="#cb33-2057" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2058"><a href="#cb33-2058" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2059"><a href="#cb33-2059" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2060"><a href="#cb33-2060" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2061"><a href="#cb33-2061" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2062"><a href="#cb33-2062" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2063"><a href="#cb33-2063" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2064"><a href="#cb33-2064" aria-hidden="true" tabindex="-1"></a><span class="vs">.color025 {</span></span>
<span id="cb33-2065"><a href="#cb33-2065" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2066"><a href="#cb33-2066" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2067"><a href="#cb33-2067" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2068"><a href="#cb33-2068" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2069"><a href="#cb33-2069" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2070"><a href="#cb33-2070" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2071"><a href="#cb33-2071" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2072"><a href="#cb33-2072" aria-hidden="true" tabindex="-1"></a><span class="vs">.color287 {</span></span>
<span id="cb33-2073"><a href="#cb33-2073" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2074"><a href="#cb33-2074" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2075"><a href="#cb33-2075" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2076"><a href="#cb33-2076" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2077"><a href="#cb33-2077" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2078"><a href="#cb33-2078" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2079"><a href="#cb33-2079" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2080"><a href="#cb33-2080" aria-hidden="true" tabindex="-1"></a><span class="vs">.color333 {</span></span>
<span id="cb33-2081"><a href="#cb33-2081" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2082"><a href="#cb33-2082" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2083"><a href="#cb33-2083" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2084"><a href="#cb33-2084" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2085"><a href="#cb33-2085" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2086"><a href="#cb33-2086" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2087"><a href="#cb33-2087" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2088"><a href="#cb33-2088" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0333 {</span></span>
<span id="cb33-2089"><a href="#cb33-2089" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2090"><a href="#cb33-2090" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2091"><a href="#cb33-2091" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2092"><a href="#cb33-2092" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2093"><a href="#cb33-2093" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2094"><a href="#cb33-2094" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2095"><a href="#cb33-2095" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2096"><a href="#cb33-2096" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0416 {</span></span>
<span id="cb33-2097"><a href="#cb33-2097" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2098"><a href="#cb33-2098" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2099"><a href="#cb33-2099" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2100"><a href="#cb33-2100" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2101"><a href="#cb33-2101" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2102"><a href="#cb33-2102" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2103"><a href="#cb33-2103" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2104"><a href="#cb33-2104" aria-hidden="true" tabindex="-1"></a><span class="vs">.color429 {</span></span>
<span id="cb33-2105"><a href="#cb33-2105" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2106"><a href="#cb33-2106" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2107"><a href="#cb33-2107" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2108"><a href="#cb33-2108" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2109"><a href="#cb33-2109" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2110"><a href="#cb33-2110" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2111"><a href="#cb33-2111" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2112"><a href="#cb33-2112" aria-hidden="true" tabindex="-1"></a><span class="vs">.color05 {</span></span>
<span id="cb33-2113"><a href="#cb33-2113" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2114"><a href="#cb33-2114" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2115"><a href="#cb33-2115" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2116"><a href="#cb33-2116" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2117"><a href="#cb33-2117" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2118"><a href="#cb33-2118" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2119"><a href="#cb33-2119" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2120"><a href="#cb33-2120" aria-hidden="true" tabindex="-1"></a><span class="vs">.color533 {</span></span>
<span id="cb33-2121"><a href="#cb33-2121" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2122"><a href="#cb33-2122" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2123"><a href="#cb33-2123" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2124"><a href="#cb33-2124" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2125"><a href="#cb33-2125" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2126"><a href="#cb33-2126" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2127"><a href="#cb33-2127" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2128"><a href="#cb33-2128" aria-hidden="true" tabindex="-1"></a><span class="vs">.color969 {</span></span>
<span id="cb33-2129"><a href="#cb33-2129" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2130"><a href="#cb33-2130" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2131"><a href="#cb33-2131" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2132"><a href="#cb33-2132" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2133"><a href="#cb33-2133" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2134"><a href="#cb33-2134" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2135"><a href="#cb33-2135" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2136"><a href="#cb33-2136" aria-hidden="true" tabindex="-1"></a><span class="vs">.color999 {</span></span>
<span id="cb33-2137"><a href="#cb33-2137" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2138"><a href="#cb33-2138" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2139"><a href="#cb33-2139" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2140"><a href="#cb33-2140" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2141"><a href="#cb33-2141" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2142"><a href="#cb33-2142" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2143"><a href="#cb33-2143" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2144"><a href="#cb33-2144" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1by320 {</span></span>
<span id="cb33-2145"><a href="#cb33-2145" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2146"><a href="#cb33-2146" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2147"><a href="#cb33-2147" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2148"><a href="#cb33-2148" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2149"><a href="#cb33-2149" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2150"><a href="#cb33-2150" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2151"><a href="#cb33-2151" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2152"><a href="#cb33-2152" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD121 {</span></span>
<span id="cb33-2153"><a href="#cb33-2153" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2154"><a href="#cb33-2154" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2155"><a href="#cb33-2155" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2156"><a href="#cb33-2156" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2157"><a href="#cb33-2157" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2158"><a href="#cb33-2158" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2159"><a href="#cb33-2159" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2160"><a href="#cb33-2160" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD268 {</span></span>
<span id="cb33-2161"><a href="#cb33-2161" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2162"><a href="#cb33-2162" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2163"><a href="#cb33-2163" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2164"><a href="#cb33-2164" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2165"><a href="#cb33-2165" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2166"><a href="#cb33-2166" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2167"><a href="#cb33-2167" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2168"><a href="#cb33-2168" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD305 {</span></span>
<span id="cb33-2169"><a href="#cb33-2169" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2170"><a href="#cb33-2170" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2171"><a href="#cb33-2171" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2172"><a href="#cb33-2172" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2173"><a href="#cb33-2173" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2174"><a href="#cb33-2174" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2175"><a href="#cb33-2175" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2176"><a href="#cb33-2176" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD306 {</span></span>
<span id="cb33-2177"><a href="#cb33-2177" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb33-2178"><a href="#cb33-2178" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb33-2179"><a href="#cb33-2179" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb33-2180"><a href="#cb33-2180" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb33-2181"><a href="#cb33-2181" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb33-2182"><a href="#cb33-2182" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb33-2183"><a href="#cb33-2183" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb33-2184"><a href="#cb33-2184" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb33-2185"><a href="#cb33-2185" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-8" data-nodetype="expression">

</div>
</div>
</div>
<style>
svg.barclock {
  width: 100%;
  overflow: visible;
}
.tickLabel, .tickLabel1, .tickLabel2, .timeLabel {
  font-family: monospace;
  text-anchor: middle;
}
.timeLabel {
  text-anchor: start;
}
.timeBar, .timeBarFull, .timeBarFullN {
  x: 1px;
  height: 25px;
  rx: 5px;
  stroke: #aaa;
}
.tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB, .tickB1 {
  stroke: none;
  fill: #666;
  width: 1px;
}
.analogclock {
  stroke: #000;
  font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
  overflow: visible;
}
.analogclock #rim {
  fill: none;
  stroke: #999;
  stroke-width: 3px;
}
.analogclock .second-hand {
  stroke-width: 3;
}
.analogclock .minute-hand {
  stroke-width: 8;
  stroke-linecap: round;
}
.analogclock .hour-hand {
  stroke-width: 12;
  stroke-linecap: round;
}
.analogclock .hands-cover {
  stroke-width: 3;
  fill: #fff;
}
.analogclock .second-tick {
  stroke-width: 3;
  fill: #000;
}
.analogclock .hour-tick {
  stroke-width: 8; // same as the minute hand
}
.analogclock .second-label {
  font-size: 18px;
}
.analogclock .hour-label {
  font-size: 32px
}
.clocks * {
  margin: -10px 0px 10px 0px;
  padding: 0px;
}
#title-block-header > div:nth-child(2) {
  display: none;
}
h4.hiddenheading, h5.hiddenheading {
  display: none;
}
div.cell-output:has(#daylightapp) {
  overflow: visible;
}
div.cell-output:has(#formEl) {
  overflow: visible;
}
#daylightapp {
  overflow: visible;
}
#daylightapp * {
  overflow: visible;
}
#solar-system * {
  overflow: visible;
}
#timezonepopstackedbar {
  overflow: visible;
}
#timezonepoptoggles div {
  display: flex;
}
#timezonepoptoggles div form {
  max-width: 180px;
}
#timezonepoptoggles div form label {
  max-width: 120px;
}
#timezonepoptoggles div form:nth-child(1) {
  margin-right: 8px;
}
#timezonepoptoggles div form:nth-child(2) label {
  max-width: 110px;
}
#timezonepoptoggles input[type=checkbox] {
  margin-top: 8px;
}
</style>


<!-- -->

<div class="ojs-auto-generated hidden">
<script type="ojs-module-contents">
eyJjb250ZW50cyI6WyAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjVGltZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTEifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY1RpbWVOfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjWm9uZUhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTMifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2Nsb2NrfSR7Y2xvY2sxfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c2VsVGltZUhzbDF9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC01In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzZWxab25lSHNsfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c2VsVGltZURheX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTcifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NlbFRpbWVIc2wwfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtOCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c2VsRGF0ZUhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTkifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NlbFNuYXBEYXl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xMCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c2VsU25hcERlY308L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTExIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHt6ZXJvRG90ZS50b0ZpeGVkKDUpfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTIifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3plcm9UaW1lSHNsMH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTEzIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHt6ZXJvVGltZUhzbDF9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xNCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7KHplcm9Eb3RlICogMTApLnRvRml4ZWQoNCl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xNSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclRpbWUudG9GaXhlZCg0KX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTE2In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHticm93c2VyU2lnbn08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTE3In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmFicyhicm93c2VyWm9uZSl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xOCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7em9uZTB0aW1lLnRvRml4ZWQoNCl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xOSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclpvbmV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yMCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclRpbWUudG9GaXhlZCg0KX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTIxIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmZsb29yKGhvdXJzKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTIyIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmZsb29yKG1pbnV0ZXMpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjMifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke01hdGguZmxvb3Ioc2Vjb25kcykudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIil9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yNCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclRpbWUudG9GaXhlZCg0KX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTI1In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmZsb29yKG5vdyAvIDEwMDApfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjYifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY1llYXJ9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yNyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjRGF0ZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTI4In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNZZWFyfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjkifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY0RhdGV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zMCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjWWVhcn08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTMxIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNEYXRlfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMzIifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY1llYXJ9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zMyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjRGF0ZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTM0In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNZZWFyfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMzUifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY0RhdGV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zNiJ9XX0=
</script>
</div>
</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{laptev2024,
  author = {Laptev, Martin},
  title = {Dec {Time}},
  date = {2024},
  urldate = {2024},
  url = {https://maptv.github.io/dec/time},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-laptev2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Laptev, Martin. 2024. <span>‚ÄúDec Time.‚Äù</span> 2024. <a href="https://maptv.github.io/dec/time">https://maptv.github.io/dec/time</a>.
</div></div></section></div></main><!-- /main --><script src="../../asset/cite.js"></script><style>
#title-block-header > div.quarto-title-banner.page-columns.page-full { margin: 0px; padding: 0px; }
#title-block-header { margin: 0px; }
main#quarto-document-content { margin: 0px; padding: 0px; }
ul.navbar-nav.navbar-nav-scroll { -webkit-flex-direction: row; }
#quarto-sidebar { padding: 0px; overflow-x: hidden !important; }
#quarto-sidebar > * { padding: 0px; }
div.quarto-title-meta { padding-bottom: 8px; }
h2, h3 { margin: 0px; }
h3 { margin-top: 17px !important; }
div.cell.page-columns.page-full { height: 0px !important; }
@media only screen and (max-width: 991px) { #quarto-search { display: none !important; } #quarto-sidebar { padding: 0px 9px 0px 9px !important; } }
@media only screen and (max-width: 767px) { div.cell.page-columns.page-full { display: none !important; } }
nav.quarto-secondary-nav { padding: 0px !important; }
nav.quarto-secondary-nav > div.container-fluid.d-flex { margin-top: -12px !important; margin-bottom: -14px !important; }
.quarto-secondary-nav-title { margin-top: 10px !important; }
.navbar-logo { max-height: 40px !important; }
section#cite a.uri { word-break: break-all !important; }
a.navbar-brand { overflow: visible !important; }
.vinculum { position: relative; }
.vinculum::before { content: ""; position: absolute; top: .5px; left: 0; width: 100%; border-top: 1.5px solid; }
</style>
<script src="../../asset/stamp.js"></script><script>
const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
</script><script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZmhleWVuL2JhcmNoYXJ0LWNsb2NrXG5iYXJDaGFydCA9IHtcbiAgY29uc3QgVyA9IDgwMDtcbiAgY29uc3QgSCA9IDg4O1xuICBjb25zdCBiYXJYID0gMTtcbiAgY29uc3QgZmlyc3RCYXJZID0gMTtcbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCBXKVxuICAgIC5hdHRyKFwidmlld0JveFwiLCBbMCwgMCwgVyAvIDEuMTQsIEhdKTtcbiAgY29uc3QgeFJhbmdlID0gWzAsIFcgLSAxMDBdO1xuICBjb25zdCBzY2FsZUREID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzAsIDEwXSlcbiAgICAucmFuZ2UoeFJhbmdlKTtcbiAgY29uc3Qgc2NhbGVNYW5kQiA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFswLCAxMDBdKVxuICAgIC5yYW5nZSh4UmFuZ2UpO1xuICAvLyBCYWNrZ3JvdW5kIGJhcnMgdG8gc2hvdyB3aGVyZSAxMDAlIGxpZXNcbiAgc3ZnLnNlbGVjdEFsbCgnLmJhY2tncm91bmQnKVxuICAgIC5kYXRhKFtcbiAgICAgICdkZCcsIFwibWlsc1wiLCAnYmVhdHMnXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICdiYWNrZ3JvdW5kIHRpbWVCYXInKVxuICAgIC5hdHRyKCd3aWR0aCcsIFctMTAwKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKVxuICAvLyBCZWF0c1xuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKE51bWJlcihiYXJCZWF0cykpKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhckZ1bGwnKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzYwKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVNYW5kQihiYXJCZWF0cykpXG4gIC8vIENlbnRzL01pbHNcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVERChOdW1iZXIoYmFyREQpK051bWJlcihiYXJNaWxzKS8xMDArTnVtYmVyKGJhckJlYXRzKS8xMDAwMCkpXG4gIHN2Z1xuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lQmFyRnVsbCcpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkpXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZUREKGJhckREKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzMwKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVNYW5kQihOdW1iZXIoYmFyTWlscykrTnVtYmVyKGJhckJlYXRzKS8xMDApKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhckZ1bGwnKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzMwKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVNYW5kQihiYXJNaWxzKSlcbiAgLy8gQ2VudCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0MnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQycpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDg6NSlcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tCMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tCMScpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBkPT5kJTI9PT0wPyBmaXJzdEJhclkrNzc6Zmlyc3RCYXJZKzgwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCBkPT5kJTI9PT0wPyA4OjUpXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrQzEnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQzEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkLzEwKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZD0+ZCUyPT09MD8gZmlyc3RCYXJZKzQ3OmZpcnN0QmFyWSs1MClcbiAgICAuYXR0cignaGVpZ2h0JywgZD0+ZCUyPT09MD8gODo1KVxuICAvLyBNaWwgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tNJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDEgOiAxLCAxMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja00nKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzIwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCA2KVxuICBzdmcuc2VsZWN0QWxsKCcudGlja0xhYmVsMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxIDogMSwgMTApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgndGV4dCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tMYWJlbDEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKy41KVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzE4KVxuICAgIC8vLnN0eWxlKFwiZm9udC1zaXplXCIsIGB7VyA8IDU1MCA/IDEyIDogVyA8IDY1MCA/IDE0IDogVyA8IDc1MCA/IDE2IDogVyA8IDg1MCA/IDE4IDogMjB9cHhgKVxuICAgIC50ZXh0KGQ9PmQpXG4gIC8vIENlbnQgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tDMicpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tDMicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMTApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gQmVhdCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0InKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gTGFiZWxzXG4gIHN2Zy5zZWxlY3RBbGwoJy50aW1lTGFiZWwnKVxuICAgIC5kYXRhKFtgKyR7YmFyRER9YCwgYCR7YmFyTWlsc31gLCBgJHtiYXJCZWF0c31gXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lTGFiZWwnKVxuICAgIC5hdHRyKCd4JywgYmFyWCsyKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKzIwKVxuICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBgJHtXIDwgMzAwID8gMTQgOiBXIDwgNDAwID8gMTYgOiBXIDwgNTAwID8gMTggOiBXIDwgNjAwID8gMjAgOiAyMn1weGApXG4gICAgLnRleHQoZD0+ZCk7XG4gIHN2Zy5hdHRyKFwiaWRcIiwgXCJ0b3BiYXJcIik7XG4gIHN2Zy5hdHRyKCdjbGFzcycsICdiYXJjbG9jaycpXG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuYmFyQ2hhcnQxID0ge1xuICBjb25zdCBXID0gODAwO1xuICBjb25zdCBIID0gODg7XG4gIGNvbnN0IGJhclggPSAxO1xuICBjb25zdCBmaXJzdEJhclkgPSAxO1xuICBjb25zdCBzdmcgPSBkM1xuICAgIC5jcmVhdGUoXCJzdmdcIilcbiAgICAuYXR0cihcIndpZHRoXCIsIFcpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCBXIC8gMS4xNCwgSF0pO1xuICBjb25zdCB4UmFuZ2UgPSBbMCwgVyAtIDEwMF07XG4gIGNvbnN0IHNjYWxlREQgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgLmRvbWFpbihbMCwgMTBdKVxuICAgIC5yYW5nZSh4UmFuZ2UpO1xuICBjb25zdCBzY2FsZU1hbmRCID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzAsIDEwMF0pXG4gICAgLnJhbmdlKHhSYW5nZSk7XG4gIC8vIGNvbnN0IHNjYWxlRGVrID0gZDMuc2NhbGVMaW5lYXIoKVxuICAvLyAgLmRvbWFpbihbMCwgMzddKVxuICAvLyAgLnJhbmdlKHhSYW5nZSk7XG4gIC8vIEJhY2tncm91bmQgYmFycyB0byBzaG93IHdoZXJlIDEwMCUgbGllc1xuICBzdmcuc2VsZWN0QWxsKCcuYmFja2dyb3VuZCcpXG4gICAgLmRhdGEoW1xuICAgICAgLy8gJ2RlaycsICdkb3RkJyxcbiAgICAgICdkZCcsIFwibWlsc1wiLCAnYmVhdHMnXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICdiYWNrZ3JvdW5kIHRpbWVCYXInKVxuICAgIC5hdHRyKCd3aWR0aCcsIFctMTAwKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKVxuICAvLyBCZWF0c1xuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKE51bWJlcihiYXJCZWF0c04pKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXJGdWxsTicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKGJhckJlYXRzTikpXG4gIC8vIENlbnRzL01pbHNcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVERChOdW1iZXIoYmFyREROKStOdW1iZXIoYmFyTWlsc04pLzEwMCtOdW1iZXIoYmFyQmVhdHNOKS8xMDAwMCkpXG4gIHN2Z1xuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lQmFyRnVsbE4nKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVERChiYXJERE4pKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKE51bWJlcihiYXJNaWxzTikrTnVtYmVyKGJhckJlYXRzTikvMTAwKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXJGdWxsTicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKGJhck1pbHNOKSlcbiAgLy8gQ2VudCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0MnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQycpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDg6NSlcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tCMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tCMScpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBkPT5kJTI9PT0wPyBmaXJzdEJhclkrNzc6Zmlyc3RCYXJZKzgwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCBkPT5kJTI9PT0wPyA4OjUpXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrQzEnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQzEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkLzEwKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZD0+ZCUyPT09MD8gZmlyc3RCYXJZKzQ3OmZpcnN0QmFyWSs1MClcbiAgICAuYXR0cignaGVpZ2h0JywgZD0+ZCUyPT09MD8gODo1KVxuICAvLyBNaWwgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tNJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDEgOiAxLCAxMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja00nKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzIwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCA2KVxuICBzdmcuc2VsZWN0QWxsKCcudGlja0xhYmVsMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxIDogMSwgMTApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgndGV4dCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tMYWJlbDEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKy41KVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzE4KVxuICAgIC8vLnN0eWxlKFwiZm9udC1zaXplXCIsIGB7VyA8IDM1MCA/IDEyIDogVyA8IDQ1MCA/IDE0IDogVyA8IDU1MCA/IDE2IDogVyA8IDY1MCA/IDE4IDogMjB9cHhgKVxuICAgIC50ZXh0KGQ9PmQpXG4gIC8vIENlbnQgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tDMicpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tDMicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMTApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gQmVhdCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0InKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gTGFiZWxzXG4gIHN2Zy5zZWxlY3RBbGwoJy50aW1lTGFiZWwnKVxuICAgIC5kYXRhKFtgLSR7YmFyREROfWAsIGAke2Jhck1pbHNOfWAsIGAke2JhckJlYXRzTn1gXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lTGFiZWwnKVxuICAgIC5hdHRyKCd4JywgYmFyWCsyKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKzIwKVxuICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBgJHtXIDwgMzAwID8gMTQgOiBXIDwgNDAwID8gMTYgOiBXIDwgNTAwID8gMTggOiBXIDwgNjAwID8gMjAgOiAyMn1weGApXG4gICAgLnRleHQoZD0+ZCk7XG4gIHN2Zy5hdHRyKFwiaWRcIiwgXCJidG1iYXJcIik7XG4gIHN2Zy5hdHRyKCdjbGFzcycsICdiYXJjbG9jaycpXG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGxvY2F0aW9uID0gd29ybGRNYXBDb29yZGluYXRlcyhbMTYyLCAwXSwgW3dpZHRoICogLjk5OCwgKCgyMSAvIDQwKSAqIHdpZHRoKV0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBodHRwczovL29ic2VydmFibGVocS5jb20vQGRicmlkZ2VzL3Zpc3VhbGl6aW5nLXNlYXNvbmFsLWRheWxpZ2h0XG5hcHAgPSB7XG4gIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdChET00uc3ZnKHdpZHRoLCBoZWlnaHQgKiAod2lkdGggPCAzMDAgPyAuOTcgOiB3aWR0aCA8IDM1MCA/IC45NiA6IHdpZHRoIDwgNDAwID8gLjk1IDogd2lkdGggPCA0NTAgPyAuOTQgOiB3aWR0aCA8IDUwMCA/IC45MyA6IHdpZHRoIDwgNTUwID8gLjkyIDogd2lkdGggPCA2MDAgPyAuOSA6IHdpZHRoIDwgNjUwID8gLjg2IDogd2lkdGggPCA3MDAgPyAuODIgOiAuNzgpKSk7XG4gIHN2Zy5zdHlsZShcInVzZXItc2VsZWN0XCIsIFwibm9uZVwiKS5zdHlsZShcIi13ZWJraXQtdXNlci1zZWxlY3RcIiwgXCJub25lXCIpLmF0dHIoXCJpZFwiLCBcImRheWxpZ2h0YXBwXCIpO1xuICBjb25zdCBtYXJnaW4gPSB7dG9wOiAyMCwgbGVmdDogMTYsIHJpZ2h0OiAxNiwgYm90dG9tOiAwLCBpbm5lcjogMzJ9O1xuICBjb25zdCBjb250ZW50V2lkdGggPSB3aWR0aCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0IC0gbWFyZ2luLmlubmVyO1xuICBjb25zdCBjb2x1bW5XaWR0aCA9IGNvbnRlbnRXaWR0aCAvIDI7XG4gIGxldCBzZWxlY3Rpb24gPSB7XG4gICAgZGF0ZTogZGF0ZTIwMjIsXG4gICAgaG91cjogZGF0ZTIwMjIuZ2V0SG91cnMoKVxuICB9XG4gIGNvbnN0IHJlbmRlclBsb3QgPSAoKSA9PiB7XG4gICAgc3ZnLnNlbGVjdEFsbChcIiNwbG90ICpcIikucmVtb3ZlKCk7XG4gICAgc3ZnLnNlbGVjdChcIiNwbG90XCIpLmNhbGwoZGF5bGlnaHRQbG90LCB7XG4gICAgdml6d2lkdGg6IGNvbHVtbldpZHRoIC8gKHdpZHRoIDwgMzAwID8gMSA6IHdpZHRoIDwgNDAwID8gMS4wNSA6IHdpZHRoIDwgNDUwID8gMS4xIDogd2lkdGggPCA1MDAgPyAxLjE1IDogd2lkdGggPCA1NTAgPyAxLjIgOiB3aWR0aCA8IDYwMCA/IDEuMjUgOiB3aWR0aCA8IDY1MCA/IDEuMyA6IHdpZHRoIDwgNzAwID8gMS40IDogMS40OCksXG4gICAgICBoZWlnaHQ6IGhlaWdodCAqICh3aWR0aCA8IDQwMCA/IDEuNjIgOiB3aWR0aCA8IDUwMCA/IDEuNiA6IHdpZHRoIDwgNzAwID8gMS41OCA6IDEuNTYpLFxuICAgICAgeWVhcjogMjAyMixcbiAgICAgIGxhdGl0dWRlOiBsb2NhdGlvblsxXSxcbiAgICAgIGRlZmF1bHREYXRlOiBzZWxlY3Rpb24uZGF0ZSxcbiAgICAgIGRlZmF1bHRIb3VyOiBzZWxlY3Rpb24uaG91clxuICAgIH0pXG4gIH1cbiAgY29uc3QgcmVuZGVyU29sYXJTeXN0ZW0gPSAoKSA9PiB7XG4gICAgc3ZnLnNlbGVjdEFsbChcIiNzb2xhci1zeXN0ZW0gKlwiKS5yZW1vdmUoKTtcbiAgICBzdmcuc2VsZWN0QWxsKFwiI3NvbGFyLXN5c3RlbVwiKS5jYWxsKHNvbGFyU3lzdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbldpZHRoICogMi4wMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uaG91cixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGFya21vZGUpO1xuICB9XG4gIC8vIGNvbnN0IHJlbmRlckdsb2JlID0gKCkgPT4ge1xuICAvLyAgIHN2Zy5zZWxlY3RBbGwoXCIjZ2xvYmUgKlwiKS5yZW1vdmUoKTtcbiAgLy8gICBzdmcuc2VsZWN0QWxsKFwiI2dsb2JlXCIpLmNhbGwoZ2xvYmUsIHsgdml6d2lkdGg6IGNvbHVtbldpZHRoIC8gMS4yOCwgbG9jYXRpb24sIC4uLnNlbGVjdGlvbiB9KTtcbiAgLy8gfVxuICBjb25zdCBzZXRTZWxlY3Rpb24gPSAobmV3U2VsZWN0aW9uLCBmb3JjZVJlbmRlciA9IGZhbHNlKSA9PiB7XG4gICAgY29uc3QgcHJldiA9IHsuLi5zZWxlY3Rpb259O1xuICAgIHNlbGVjdGlvbiA9IG5ld1NlbGVjdGlvbjtcbiAgICBzdmcubm9kZSgpLnZhbHVlID0gc2VsZWN0aW9uO1xuICAgIHNldCh2aWV3b2Ygc2VsZWN0ZWREYXRlLCBzZWxlY3Rpb24uZGF0ZSk7XG4gICAgc2V0KHZpZXdvZiBzZWxlY3RlZEhvdXIsIHNlbGVjdGlvbi5ob3VyKTtcbiAgICBpZiAoZm9yY2VSZW5kZXIpIHtcbiAgICAgIHJlbmRlclBsb3QoKTtcbiAgICAgIHJlbmRlclNvbGFyU3lzdGVtKCk7XG4gIC8vICAgIHJlbmRlckdsb2JlKCk7XG4gICAgfSBlbHNlIGlmIChwcmV2LmhvdXIgIT09IHNlbGVjdGlvbi5ob3VyIHx8IHByZXYuZGF0ZSAhPT0gc2VsZWN0aW9uLmRhdGUpIHtcbiAgICAgIHJlbmRlclNvbGFyU3lzdGVtKCk7XG4gIC8vICAgIHJlbmRlckdsb2JlKCk7XG59XG4gIH1cbiAgY29uc3QgcGxvdCA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJpZFwiLCBcInBsb3RcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnQgKyAwfSwgJHtoZWlnaHQgLyA1ICsgKHdpZHRoIDwgNjAwID8gMTIgOiA1KX0pYCk7XG4gIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJpZFwiLCBcInNvbGFyLXN5c3RlbVwiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdCArIDEyfSwgJHttYXJnaW4udG9wICsgd2lkdGggLyAyMiAtIDYgLSA1ICogKHdpZHRoIDwgNDAwKX0pYCk7XG4gIC8vIHN2Zy5hcHBlbmQoXCJnXCIpXG4gIC8vICAgLmF0dHIoXCJpZFwiLCBcImdsb2JlXCIpXG4gIC8vICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0ICsgbWFyZ2luLmlubmVyICsgY29sdW1uV2lkdGggLyAyICsgMjB9LCAke21hcmdpbi50b3AgKyBoZWlnaHQgLyAxLjIgKyA0fSlgKTtcbiAgc2V0U2VsZWN0aW9uKHNlbGVjdGlvbiwgdHJ1ZSk7XG4gIGNvbnN0IGhhbmRsZURhdGVIb3VyQ2hhbmdlID0gKHsgdGFyZ2V0LCBkZXRhaWw6IHsgZGF0ZSwgaG91ciB9fSkgPT4ge1xuICAgIGlmIChkYXRlICE9IG51bGwgJiYgaG91ciAhPSBudWxsKSBzZXRTZWxlY3Rpb24oey4uLnNlbGVjdGlvbiwgZGF0ZSwgaG91cn0pO1xuICB9XG4gIHN2Zy5ub2RlKCkuYWRkRXZlbnRMaXN0ZW5lcihFdmVudFR5cGUuRGF0ZUhvdXJDaGFuZ2UsIGhhbmRsZURhdGVIb3VyQ2hhbmdlLCBmYWxzZSk7XG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BkMy9zaW1wbGUtY2xvY2tcbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZHJpby9sZXRzLWJ1aWxkLWFuLWFuYWxvZy1jbG9ja1xuY2xvY2sgPSB7XG4gIGNvbnN0IGNsb2NrUmFkaXVzID0gMjAwLFxuICAgIG1hcmdpbiA9IDUwLFxuICAgIHcgPSAoY2xvY2tSYWRpdXMgKyBtYXJnaW4pICogMixcbiAgICBoID0gKGNsb2NrUmFkaXVzICsgbWFyZ2luKSAqIDIsXG4gICAgaG91ckhhbmRMZW5ndGggPSAoMiAqIGNsb2NrUmFkaXVzKSAvIDMsXG4gICAgbWludXRlSGFuZExlbmd0aCA9IGNsb2NrUmFkaXVzLFxuICAgIHNlY29uZEhhbmRMZW5ndGggPSBjbG9ja1JhZGl1cyAtIDEyLFxuICAgIHNlY29uZEhhbmRCYWxhbmNlID0gMzAsXG4gICAgc2Vjb25kVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgc2Vjb25kVGlja0xlbmd0aCA9IC0xMCxcbiAgICBob3VyVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgaG91clRpY2tMZW5ndGggPSAtMTgsXG4gICAgc2Vjb25kTGFiZWxSYWRpdXMgPSBjbG9ja1JhZGl1cyArIDE2LFxuICAgIHNlY29uZExhYmVsWU9mZnNldCA9IDUsXG4gICAgaG91ckxhYmVsUmFkaXVzID0gY2xvY2tSYWRpdXMgLSA0MCxcbiAgICBob3VyTGFiZWxZT2Zmc2V0ID0gNyxcbiAgICByYWRpYW5zID0gTWF0aC5QSSAvIDE4MDtcbiAgY29uc3QgdGVuID0gZDNcbiAgICAuc2NhbGVMaW5lYXIoKVxuICAgIC5yYW5nZShbMCwgMzYwXSlcbiAgICAuZG9tYWluKFswLCAxMF0pO1xuICBjb25zdCBzdG8gPSBkM1xuICAgIC5zY2FsZUxpbmVhcigpXG4gICAgLnJhbmdlKFswLCAzNjBdKVxuICAgIC5kb21haW4oWzAsIDEwMF0pO1xuICBjb25zdCBoYW5kRGF0YSA9IFtcbiAgICB7XG4gICAgICB0eXBlOiBcImhvdXJcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtaG91ckhhbmRMZW5ndGgsXG4gICAgICBzY2FsZTogdGVuXG4gICAgfSxcbiAgICB7XG4gICAgICB0eXBlOiBcIm1pbnV0ZVwiLFxuICAgICAgdmFsdWU6IDAsXG4gICAgICBsZW5ndGg6IC1taW51dGVIYW5kTGVuZ3RoLFxuICAgICAgc2NhbGU6IHN0b1xuICAgIH0sXG4gICAge1xuICAgICAgdHlwZTogXCJzZWNvbmRcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtc2Vjb25kSGFuZExlbmd0aCxcbiAgICAgIHNjYWxlOiBzdG8sXG4gICAgICBiYWxhbmNlOiBzZWNvbmRIYW5kQmFsYW5jZVxuICAgIH1cbiAgXTtcbiAgZnVuY3Rpb24gZHJhd0Nsb2NrKCkge1xuICAgIC8vIGNyZWF0ZSBhbGwgdGhlIGNsb2NrIGVsZW1lbnRzXG4gICAgdXBkYXRlRGF0YSgpOyAvL2RyYXcgdGhlbSBpbiB0aGUgY29ycmVjdCBzdGFydGluZyBwb3NpdGlvblxuICAgIGNvbnN0IGZhY2UgPSBzdmdcbiAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcImlkXCIsIFwiY2xvY2stZmFjZVwiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke1t3IC8gMiwgaCAvIDJdfSlgKTtcbiAgICAvLyBhZGQgbWFya3MgZm9yIHNlY29uZHNcbiAgICBmYWNlXG4gICAgICAuc2VsZWN0QWxsKFwiLnNlY29uZC10aWNrXCIpXG4gICAgICAuZGF0YShkMy5yYW5nZSgwLCAxMDApKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwic2Vjb25kLXRpY2tcIilcbiAgICAgIC5hdHRyKFwieDFcIiwgMClcbiAgICAgIC5hdHRyKFwieDJcIiwgMClcbiAgICAgIC5hdHRyKFwieTFcIiwgc2Vjb25kVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBzZWNvbmRUaWNrU3RhcnQgKyBzZWNvbmRUaWNrTGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7c3RvKGQpfSlgKTtcbiAgICAvLyBhbmQgbGFiZWxzLi4uXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5zZWNvbmQtbGFiZWxcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwMCwgNSkpXG4gICAgICAuZW50ZXIoKVxuICAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJzZWNvbmQtbGFiZWxcIilcbiAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgIC5hdHRyKFwieFwiLCBkID0+IHNlY29uZExhYmVsUmFkaXVzICogTWF0aC5zaW4oc3RvKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT5cbiAgICAgICAgICAtc2Vjb25kTGFiZWxSYWRpdXMgKiBNYXRoLmNvcyhzdG8oZCkgKiByYWRpYW5zKSArIHNlY29uZExhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICAvLyAuLi4gYW5kIGhvdXJzXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5ob3VyLXRpY2tcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwLCAxKSlcbiAgICAgIC5lbnRlcigpXG4gICAgICAuYXBwZW5kKFwibGluZVwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImhvdXItdGlja1wiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBob3VyVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBob3VyVGlja1N0YXJ0ICsgaG91clRpY2tMZW5ndGgpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGByb3RhdGUoJHt0ZW4oZCl9KWApO1xuICAgIGZhY2VcbiAgICAgIC5zZWxlY3RBbGwoXCIuaG91ci1sYWJlbFwiKVxuICAgICAgLmRhdGEoZDMucmFuZ2UoMCwgMTAsIDEpKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwiaG91ci1sYWJlbFwiKVxuICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIGQgPT4gaG91ckxhYmVsUmFkaXVzICogTWF0aC5zaW4odGVuKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT4gLWhvdXJMYWJlbFJhZGl1cyAqIE1hdGguY29zKHRlbihkKSAqIHJhZGlhbnMpICsgaG91ckxhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICBjb25zdCBoYW5kcyA9IGZhY2UuYXBwZW5kKFwiZ1wiKS5hdHRyKFwiaWRcIiwgXCJjbG9jay1oYW5kc1wiKTtcbiAgICBoYW5kc1xuICAgICAgLnNlbGVjdEFsbChcImxpbmVcIilcbiAgICAgIC5kYXRhKGhhbmREYXRhKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIGQgPT4gZC50eXBlICsgXCItaGFuZFwiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBkID0+IGQuYmFsYW5jZSB8fCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MlwiLCBkID0+IGQubGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7ZC5zY2FsZShkLnZhbHVlKX0pYCk7XG4gICAgZmFjZVxuICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgIC5hdHRyKFwiaWRcIiwgXCJmYWNlLW92ZXJsYXlcIilcbiAgICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJoYW5kcy1jb3ZlclwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIDApXG4gICAgICAuYXR0cihcInlcIiwgMClcbiAgICAgIC5hdHRyKFwiclwiLCBjbG9ja1JhZGl1cyAvIDIwKTtcbiAgfVxuICBmdW5jdGlvbiBtb3ZlSGFuZHMoKSB7XG4gICAgY29uc3Qgc2VsID0gZDNcbiAgICAgIC5zZWxlY3QoXCIjY2xvY2staGFuZHMtZmluYWxcIilcbiAgICAgIC5zZWxlY3RBbGwoXCJsaW5lXCIpXG4gICAgICAuZGF0YShoYW5kRGF0YSlcbiAgICAgIC50cmFuc2l0aW9uKCk7XG4gICAgaWYgKGZhbmN5U2Vjb25kc09GRikgc2VsLmVhc2UoZDMuZWFzZUVsYXN0aWMucGVyaW9kKDAuNSkpO1xuICAgIHNlbC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHJvdGF0ZSgke2Quc2NhbGUoZC52YWx1ZSl9KWApO1xuICB9XG4gIGZ1bmN0aW9uIHVwZGF0ZURhdGEoKSB7XG4gICAgaGFuZERhdGFbMF0udmFsdWUgPSAhZmFuY3lTZWNvbmRzT0ZGID8gTWF0aC5mbG9vcihzZWxlY3RlZEV4YWN0ICogMTApIDogZGVjVGltZVswXTtcbiAgICBoYW5kRGF0YVsxXS52YWx1ZSA9ICFmYW5jeVNlY29uZHNPRkYgPyBNYXRoLmZsb29yKHNlbGVjdGVkRXhhY3QgKiAxMCAlIDEgKiAxMDApIDogZGVjVGltZS5zbGljZSgyLCA0KTtcbiAgICBoYW5kRGF0YVsyXS52YWx1ZSA9ICFmYW5jeVNlY29uZHNPRkYgPyBzZWxlY3RlZEV4YWN0ICogMTAgJSAxICogMTAwICUgMSAqIDEwMCA6IGRlY1RpbWUuc2xpY2UoNCwgNik7XG4gIH1cbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3LCBoXSlcbiAgICAuc3R5bGUoXCJtYXgtd2lkdGhcIiwgYCR7d2lkdGggLyAyLjF9cHhgKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJhbmFsb2djbG9ja1wiKVxuICAgIC5hdHRyKFwiaWRcIiwgXCJ0b3BjbG9ja1wiKTtcbiAgc3ZnXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAudGV4dChgKyR7ZGVjVGltZX0tJHtzZWxlY3RlZFpvbmV9YClcbiAgICAuYXR0cihcInhcIiwgY2xvY2tSYWRpdXMgKyBtYXJnaW4pXG4gICAgLmF0dHIoXCJ5XCIsIGNsb2NrUmFkaXVzICogMiArIG1hcmdpbiAqIDIuMSlcbiAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgLmF0dHIoXCJmb250LXNpemVcIiwgMzIpXG4gICAgLmF0dHIoXCJmb250LWZhbWlseVwiLCBcIm1vbm9zcGFjZVwiKTtcbiAgZHJhd0Nsb2NrKCk7XG4gIC8vIEFuaW1hdGlvblxuICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKFxuICAgICgpID0+IHtcbiAgICAgIHVwZGF0ZURhdGEoKTtcbiAgICAgIG1vdmVIYW5kcygpO1xuICAgIH0sXG4gICAgIWZhbmN5U2Vjb25kc09GRiA/IDEwIDogODY0XG4gICk7XG4gIGludmFsaWRhdGlvbi50aGVuKCgpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpKTtcbiAgcmV0dXJuIHN2Zy5ub2RlKCk7XG59XG5jbG9jazEgPSB7XG4gIGNvbnN0IGNsb2NrUmFkaXVzID0gMjAwLFxuICAgIG1hcmdpbiA9IDUwLFxuICAgIHcgPSAoY2xvY2tSYWRpdXMgKyBtYXJnaW4pICogMixcbiAgICBoID0gKGNsb2NrUmFkaXVzICsgbWFyZ2luKSAqIDIsXG4gICAgaG91ckhhbmRMZW5ndGggPSAoMiAqIGNsb2NrUmFkaXVzKSAvIDMsXG4gICAgbWludXRlSGFuZExlbmd0aCA9IGNsb2NrUmFkaXVzLFxuICAgIHNlY29uZEhhbmRMZW5ndGggPSBjbG9ja1JhZGl1cyAtIDEyLFxuICAgIHNlY29uZEhhbmRCYWxhbmNlID0gMzAsXG4gICAgc2Vjb25kVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgc2Vjb25kVGlja0xlbmd0aCA9IC0xMCxcbiAgICBob3VyVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgaG91clRpY2tMZW5ndGggPSAtMTgsXG4gICAgc2Vjb25kTGFiZWxSYWRpdXMgPSBjbG9ja1JhZGl1cyArIDE2LFxuICAgIHNlY29uZExhYmVsWU9mZnNldCA9IDUsXG4gICAgaG91ckxhYmVsUmFkaXVzID0gY2xvY2tSYWRpdXMgLSA0MCxcbiAgICBob3VyTGFiZWxZT2Zmc2V0ID0gNyxcbiAgICByYWRpYW5zID0gTWF0aC5QSSAvIDE4MDtcbiAgY29uc3QgdGVuID0gZDNcbiAgICAuc2NhbGVMaW5lYXIoKVxuICAgIC5yYW5nZShbMCwgMzYwXSlcbiAgICAuZG9tYWluKFswLCAxMF0pO1xuICBjb25zdCBzdG8gPSBkM1xuICAgIC5zY2FsZUxpbmVhcigpXG4gICAgLnJhbmdlKFswLCAzNjBdKVxuICAgIC5kb21haW4oWzAsIDEwMF0pO1xuICBjb25zdCBoYW5kRGF0YSA9IFtcbiAgICB7XG4gICAgICB0eXBlOiBcImhvdXJcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtaG91ckhhbmRMZW5ndGgsXG4gICAgICBzY2FsZTogdGVuXG4gICAgfSxcbiAgICB7XG4gICAgICB0eXBlOiBcIm1pbnV0ZVwiLFxuICAgICAgdmFsdWU6IDAsXG4gICAgICBsZW5ndGg6IC1taW51dGVIYW5kTGVuZ3RoLFxuICAgICAgc2NhbGU6IHN0b1xuICAgIH0sXG4gICAge1xuICAgICAgdHlwZTogXCJzZWNvbmRcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtc2Vjb25kSGFuZExlbmd0aCxcbiAgICAgIHNjYWxlOiBzdG8sXG4gICAgICBiYWxhbmNlOiBzZWNvbmRIYW5kQmFsYW5jZVxuICAgIH1cbiAgXTtcbiAgZnVuY3Rpb24gZHJhd0Nsb2NrKCkge1xuICAgIC8vIGNyZWF0ZSBhbGwgdGhlIGNsb2NrIGVsZW1lbnRzXG4gICAgdXBkYXRlRGF0YSgpOyAvL2RyYXcgdGhlbSBpbiB0aGUgY29ycmVjdCBzdGFydGluZyBwb3NpdGlvblxuICAgIGNvbnN0IGZhY2UgPSBzdmdcbiAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcImlkXCIsIFwiY2xvY2stZmFjZVwiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke1t3IC8gMiwgaCAvIDJdfSlgKTtcbiAgICAvLyBhZGQgbWFya3MgZm9yIHNlY29uZHNcbiAgICBmYWNlXG4gICAgICAuc2VsZWN0QWxsKFwiLnNlY29uZC10aWNrXCIpXG4gICAgICAuZGF0YShkMy5yYW5nZSgwLCAxMDApKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwic2Vjb25kLXRpY2tcIilcbiAgICAgIC5hdHRyKFwieDFcIiwgMClcbiAgICAgIC5hdHRyKFwieDJcIiwgMClcbiAgICAgIC5hdHRyKFwieTFcIiwgc2Vjb25kVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBzZWNvbmRUaWNrU3RhcnQgKyBzZWNvbmRUaWNrTGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7c3RvKGQpfSlgKTtcbiAgICAvLyBhbmQgbGFiZWxzLi4uXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5zZWNvbmQtbGFiZWxcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwMCwgNSkpXG4gICAgICAuZW50ZXIoKVxuICAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJzZWNvbmQtbGFiZWxcIilcbiAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgIC5hdHRyKFwieFwiLCBkID0+IHNlY29uZExhYmVsUmFkaXVzICogTWF0aC5zaW4oc3RvKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT5cbiAgICAgICAgICAtc2Vjb25kTGFiZWxSYWRpdXMgKiBNYXRoLmNvcyhzdG8oZCkgKiByYWRpYW5zKSArIHNlY29uZExhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICAvLyAuLi4gYW5kIGhvdXJzXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5ob3VyLXRpY2tcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwLCAxKSlcbiAgICAgIC5lbnRlcigpXG4gICAgICAuYXBwZW5kKFwibGluZVwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImhvdXItdGlja1wiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBob3VyVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBob3VyVGlja1N0YXJ0ICsgaG91clRpY2tMZW5ndGgpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGByb3RhdGUoJHt0ZW4oZCl9KWApO1xuICAgIGZhY2VcbiAgICAgIC5zZWxlY3RBbGwoXCIuaG91ci1sYWJlbFwiKVxuICAgICAgLmRhdGEoZDMucmFuZ2UoMCwgMTAsIDEpKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwiaG91ci1sYWJlbFwiKVxuICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIGQgPT4gaG91ckxhYmVsUmFkaXVzICogTWF0aC5zaW4odGVuKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT4gLWhvdXJMYWJlbFJhZGl1cyAqIE1hdGguY29zKHRlbihkKSAqIHJhZGlhbnMpICsgaG91ckxhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICBjb25zdCBoYW5kcyA9IGZhY2UuYXBwZW5kKFwiZ1wiKS5hdHRyKFwiaWRcIiwgXCJjbG9jay1oYW5kc1wiKTtcbiAgICBoYW5kc1xuICAgICAgLnNlbGVjdEFsbChcImxpbmVcIilcbiAgICAgIC5kYXRhKGhhbmREYXRhKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIGQgPT4gZC50eXBlICsgXCItaGFuZFwiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBkID0+IGQuYmFsYW5jZSB8fCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MlwiLCBkID0+IGQubGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7ZC5zY2FsZShkLnZhbHVlKX0pYCk7XG4gICAgZmFjZVxuICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgIC5hdHRyKFwiaWRcIiwgXCJmYWNlLW92ZXJsYXlcIilcbiAgICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJoYW5kcy1jb3ZlclwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIDApXG4gICAgICAuYXR0cihcInlcIiwgMClcbiAgICAgIC5hdHRyKFwiclwiLCBjbG9ja1JhZGl1cyAvIDIwKTtcbiAgfVxuICBmdW5jdGlvbiBtb3ZlSGFuZHMoKSB7XG4gICAgY29uc3Qgc2VsID0gZDNcbiAgICAgIC5zZWxlY3QoXCIjY2xvY2staGFuZHMtZmluYWxcIilcbiAgICAgIC5zZWxlY3RBbGwoXCJsaW5lXCIpXG4gICAgICAuZGF0YShoYW5kRGF0YSlcbiAgICAgIC50cmFuc2l0aW9uKCk7XG4gICAgaWYgKGZhbmN5U2Vjb25kc09GRikgc2VsLmVhc2UoZDMuZWFzZUVsYXN0aWMucGVyaW9kKDAuNSkpO1xuICAgIHNlbC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHJvdGF0ZSgke2Quc2NhbGUoZC52YWx1ZSl9KWApO1xuICB9XG4gIGZ1bmN0aW9uIHVwZGF0ZURhdGEoKSB7XG4gICAgaGFuZERhdGFbMF0udmFsdWUgPSAhZmFuY3lTZWNvbmRzT0ZGID8gTWF0aC5mbG9vcihzZWxlY3RlZEV4YWN0TiAqIDEwKSA6IGRlY1RpbWVOWzBdO1xuICAgIGhhbmREYXRhWzFdLnZhbHVlID0gIWZhbmN5U2Vjb25kc09GRiA/IE1hdGguZmxvb3Ioc2VsZWN0ZWRFeGFjdE4gKiAxMCAlIDEgKiAxMDApIDogZGVjVGltZU4uc2xpY2UoMiwgNCk7XG4gICAgaGFuZERhdGFbMl0udmFsdWUgPSAhZmFuY3lTZWNvbmRzT0ZGID8gc2VsZWN0ZWRFeGFjdE4gKiAxMCAlIDEgKiAxMDAgJSAxICogMTAwIDogZGVjVGltZU4uc2xpY2UoNCwgNik7XG4gIH1cbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3LCBoXSlcbiAgICAuc3R5bGUoXCJtYXgtd2lkdGhcIiwgYCR7d2lkdGggLyAyLjF9cHhgKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJhbmFsb2djbG9ja1wiKVxuICAgIC5hdHRyKFwiaWRcIiwgXCJidG1jbG9ja1wiKTtcbiAgc3ZnXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAudGV4dChgLSR7ZGVjVGltZU59LSR7c2VsZWN0ZWRab25lfWApXG4gICAgLmF0dHIoXCJ4XCIsIGNsb2NrUmFkaXVzICsgbWFyZ2luKVxuICAgIC5hdHRyKFwieVwiLCBjbG9ja1JhZGl1cyAqIDIgKyBtYXJnaW4gKiAyLjEpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIDMyKVxuICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJtb25vc3BhY2VcIik7XG4gIGRyYXdDbG9jaygpO1xuICAvLyBBbmltYXRpb25cbiAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChcbiAgICAoKSA9PiB7XG4gICAgICB1cGRhdGVEYXRhKCk7XG4gICAgICBtb3ZlSGFuZHMoKTtcbiAgICB9LFxuICAgICFmYW5jeVNlY29uZHNPRkYgPyAxMCA6IDg2NFxuICApO1xuICBpbnZhbGlkYXRpb24udGhlbigoKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKSk7XG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaG1zID0gbmV3IERhdGUoKTtcbnVuaXggPSBobXMuZ2V0VGltZSgpIC8gODY0ZTUgJSAxO1xudXRjID0gaG1zLmdldFVUQ0hvdXJzKCkgLyAyNCArXG4gICAgICBobXMuZ2V0VVRDTWludXRlcygpIC8gMTQ0MCArXG4gICAgICBobXMuZ2V0VVRDU2Vjb25kcygpIC8gODY0MDAgK1xuICAgICAgaG1zLmdldFVUQ01pbGxpc2Vjb25kcygpIC8gODY0ZTU7XG5obXNcbnVuaXhcbnV0Y1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BtYXR0ZHp1Z2FuL3BvcHVsYXRpb24tYnktdGltZS16b25lLWNyZWF0aW5nLWEtZGF0YXNldFxudmlld29mIHNvcnRQYXJhbXMgPSBJbnB1dHMuZm9ybShbXG4gIElucHV0cy50b2dnbGUoeyBsYWJlbDogXCJTb3J0IGFzY2VuZGluZ1wiIH0pLFxuICBJbnB1dHMudG9nZ2xlKHsgbGFiZWw6IFwiU29ydCBieSBvZmZzZXRcIiB9KSxcbiAgXSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AbWF0dGR6dWdhbi9wb3B1bGF0aW9uLWJ5LXRpbWUtem9uZS1jcmVhdGluZy1hLWRhdGFzZXRcblBsb3QucGxvdCh7XG4gIHdpZHRoOiB3aWR0aCxcbiAgbWFyZ2luQm90dG9tOiA1MCxcbiAgc3R5bGU6IGBvdmVyZmxvdzogdmlzaWJsZTtmb250LXNpemU6MTZweDtgLFxuICBjb2xvcjoge3NjaGVtZTogXCJSZEJ1XCIsIGNsYXNzTmFtZTogXCJiYXJQbG90TGVnZW5kXCJ9LFxuICBtYXJnaW5MZWZ0OiA3NSxcbiAgeTogeyBsYWJlbDogbnVsbCB9LFxuICB4OiB7IGdyaWQ6IHRydWUsIGxhYmVsOiBcIlBvcHVsYXRpb24gKGJpbGxpb25zKVwiLCBsYWJlbE9mZnNldDogMzgsIHRyYW5zZm9ybTogZCA9PiBkIC8gMWU5IH0sXG4gIG1hcmtzOiBbXG4gICAgUGxvdC5iYXJYKHNvcnRlZFBvcCwge3g6IFwicG9wXCIsIHk6IFwiU2lnblwiLCBmaWxsOiBcIk9mZnNldFwiLCBzdHJva2U6IFwiYmxhY2tcIiwgdGlwOiB0cnVlIH0pLFxuICBdXG59KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gdW5peDJkb3RlKHVuaXgsIHpvbmUsIG9mZnNldCA9IDcxOTQ2OCkge1xuICByZXR1cm4gWyh1bml4ID8/IERhdGUubm93KCkpIC8gODY0MDAwMDAgKyAoXG4gICAgem9uZSA9IHpvbmUgPz8gLU1hdGgucm91bmQoXG4gICAgICAobmV3IERhdGUpLmdldFRpbWV6b25lT2Zmc2V0KCkgLyAxNDQpXG4gICAgKSAvIDEwICsgb2Zmc2V0LCB6b25lXVxufVxuZnVuY3Rpb24gdW5peDJkb3RlMSh1bml4LCB6b25lLCBvZmZzZXQgPSA3MTk0NjgpIHtcbiAgcmV0dXJuIFtcbiAgICAodW5peCA/PyBEYXRlLm5vdygpKSAvIDg2NDAwMDAwXG4gICAgKyAoem9uZSA9IHpvbmUgPz8gKDEwIC0gTWF0aC5yb3VuZChcbiAgICAgICAgKG5ldyBEYXRlKS5nZXRUaW1lem9uZU9mZnNldCgpIC8gMTQ0KSkgJSAxMFxuICAgICAgKSAvIDEwICsgb2Zmc2V0LCB6b25lXVxufVxuZnVuY3Rpb24gZG90ZTJkYXRlKGRvdGUsIHpvbmUgPSAwKSB7XG4gIGNvbnN0IGNvdGUgPSBNYXRoLmZsb29yKChcbiAgICAgIGRvdGUgPj0gMCA/IGRvdGVcbiAgICAgIDogZG90ZSAtIDE0NjA5NlxuICAgICkgLyAxNDYwOTcpLFxuICBkb3RjID0gZG90ZSAtIGNvdGUgKiAxNDYwOTcsXG4gIHlvdGMgPSBNYXRoLmZsb29yKChkb3RjXG4gICAgLSBNYXRoLmZsb29yKGRvdGMgLyAxNDYwKVxuICAgICsgTWF0aC5mbG9vcihkb3RjIC8gMzY1MjQpXG4gICAgLSBNYXRoLmZsb29yKGRvdGMgLyAxNDYwOTYpXG4gICkgLyAzNjUpO1xuICByZXR1cm4gW1xuICAgIHlvdGMgKyBjb3RlICogNDAwLFxuICAgIGRvdGMgLSAoeW90YyAqIDM2NVxuICAgICAgKyBNYXRoLmZsb29yKHlvdGMgLyA0KVxuICAgICAgLSBNYXRoLmZsb29yKHlvdGMgLyAxMDApXG4gICksIHpvbmVdfVxuZHogPSB1bml4MmRvdGUobm93KVxuZGVjWWVhciA9IHlkelswXS50b1N0cmluZygpLnBhZFN0YXJ0KDQsIFwiMFwiKVxuemVyb0RvdGUgPSB1bml4MmRvdGUobm93LCAwKVswXVxuemVyb1RpbWUgPSB6ZXJvRG90ZSAlIDFcbnplcm9EYXRlID0gZG90ZTJkYXRlKHplcm9Eb3RlKVxuemVyb1llYXIgPSB6ZXJvRGF0ZVswXVxuemVyb0RvdHkgPSBNYXRoLmZsb29yKHplcm9EYXRlWzFdKVxuemVyb1RpbWVIc2wwID0gdGV4dGNvbG9yKHplcm9UaW1lLnRvRml4ZWQoNSkuc2xpY2UoMSksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHplcm9UaW1lKSkuZm9ybWF0SGV4KCkpXG56ZXJvVGltZUhzbDEgPSB0ZXh0Y29sb3IoKHplcm9UaW1lICogMTApLnRvRml4ZWQoNCksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHplcm9UaW1lKSkuZm9ybWF0SGV4KCkpXG56ZXJvVGltZUhzbDIgPSB0ZXh0Y29sb3IoemVyb1RpbWUudG9GaXhlZCg1KS5zbGljZSgyKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoemVyb1RpbWUpKS5mb3JtYXRIZXgoKSlcbnplcm9Eb3R5SHNsID0gdGV4dGNvbG9yKHplcm9Eb3R5LnRvU3RyaW5nKCkucGFkU3RhcnQoMywgXCIwXCIpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcih6ZXJvRG90eSAvICgzNjUgKyB6ZXJvSXNMZWFwKSkpLmZvcm1hdEhleCgpKVxuemVyb1llYXJIc2wgPSB0ZXh0Y29sb3IoemVyb1llYXIsIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHplcm9ZZWFyICUgMTAwMCAvIDEwMDApKS5mb3JtYXRIZXgoKSlcbnplcm9Jc0xlYXAgPSB6ZXJvWWVhciAlIDQgPT0gMCAmJiB6ZXJvWWVhciAlIDEwMCAhPSAwIHx8IHplcm9ZZWFyICUgNDAwID09IDA7XG5icm93c2VyRG90ZSA9IHVuaXgyZG90ZShub3cpXG5icm93c2VyVGltZSA9IGJyb3dzZXJEb3RlWzBdICUgMSAqIDEwXG5icm93c2VyWm9uZSA9IGJyb3dzZXJEb3RlWzFdXG5icm93c2VyU2lnbiA9IGJyb3dzZXJab25lID4gMCA/IFwiLVwiIDogXCIrXCJcbnpvbmUwdGltZSA9IChicm93c2VyVGltZSAtIGJyb3dzZXJab25lICsgMTApICUgMTBcbmhvdXJzID0gYnJvd3NlclRpbWUgKiAyLjRcbm1pbnV0ZXMgPSBob3VycyAlIDEgKiA2MFxuc2Vjb25kcyA9IG1pbnV0ZXMgJSAxICogNjBcbnNlbGVjdGVkRG90ZSA9IHVuaXgyZG90ZShub3csIGxvbmcyem9uZShsb2NhdGlvblswXSkpXG5zZWxlY3RlZEV4YWN0ID0gc2VsZWN0ZWREb3RlWzBdICUgMVxuc2VsZWN0ZWRFeGFjdE4gPSAoMSAtIHNlbGVjdGVkRXhhY3QpICUgMVxuc2VsZWN0ZWRab25lID0gc2VsZWN0ZWREb3RlWzFdXG55ZHogPSBkb3RlMmRhdGUoLi4uc2VsZWN0ZWREb3RlKVxuZGVjRGF0ZSA9IE1hdGguZmxvb3IoeWR6WzFdKVxuZGVjVGltZSA9IChzZWxlY3RlZEV4YWN0ICogMTApLnRvRml4ZWQoNClcbmRlY1RpbWVOID0gKHNlbGVjdGVkRXhhY3ROICogMTApLnRvRml4ZWQoNClcbmJhckREID0gZGVjVGltZVswXVxuYmFyREROID0gZGVjVGltZU5bMF1cbmJhck1pbHMgPSBkZWNUaW1lLnNsaWNlKDIsIDQpXG5iYXJNaWxzTiA9IGRlY1RpbWVOLnNsaWNlKDIsIDQpXG5iYXJCZWF0cyA9IGRlY1RpbWUuc2xpY2UoNCwgNilcbmJhckJlYXRzTiA9IGRlY1RpbWVOLnNsaWNlKDQsIDYpXG5mdW5jdGlvbiBsYXRpMnR1cm4oZGVncmVlcyA9IC0xODAsIGUgPSAzKSB7XG4gIC8vIHR1cm5zOiBlPTAsIGRlY2l0dXJuczogZT0xLCBldGMuXG4gIHJldHVybiAoZGVncmVlcyAlPSAzNjApIC8gKDM2MCAvIDEwKiplKSAlIDEwKiplO1xufVxuZ3JhdGljdWxlID0gZDMuZ2VvR3JhdGljdWxlKCkuc3RlcE1pbm9yKFszNiwzNl0pLnN0ZXBNYWpvcihbMzYsMzZdKSgpXG5ncmF0aWN1bGUuY29vcmRpbmF0ZXMgPSBncmF0aWN1bGUuY29vcmRpbmF0ZXMubWFwKFxuICBpID0+IGkubWFwKGogPT4gai5tYXAoKGssIGluZGV4LCBhcnIpID0+IGkubGVuZ3RoID09PSAzICYmIGluZGV4ID09PSAwID8gayAtIDE4IDogaykpXG4pXG5mdW5jdGlvbiBsb25nMnR1cm4oZGVncmVlcyA9IC0xODAsIGUgPSAzKSB7XG4gIC8vIHR1cm5zOiBlPTAsIGRlY2l0dXJuczogZT0xLCBldGMuXG4gIHJldHVybiAoKChkZWdyZWVzICU9IDM2MCkgPCAwID8gZGVncmVlcyArIDM2MCA6IGRlZ3JlZXMpICsgMTgpIC8gKDM2MCAvIDEwKiplKSAlIDEwKiplO1xufVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3RvcG9qc29uL3dvcmxkLWF0bGFzXG53b3JsZCA9IGQzLmpzb24oXCJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL3dvcmxkLWF0bGFzQDIvY291bnRyaWVzLTExMG0uanNvblwiKVxuY291bnRyaWVzID0gdG9wb2pzb24uZmVhdHVyZSh3b3JsZCwgd29ybGQub2JqZWN0cy5jb3VudHJpZXMpXG50b3BvanNvbiA9IHJlcXVpcmUoXCJ0b3BvanNvbi1jbGllbnRAM1wiKVxuZnVuY3Rpb24gbG9uZzJ6b25lKGRlZ3JlZXMgPSAtMTgwKSB7XG4gIHJldHVybiBNYXRoLmZsb29yKGxvbmcydHVybihkZWdyZWVzLCAxKSk7XG59XG5mdW5jdGlvbiB5ZWFyMmxlYXAoeWVhciA9IDE5NzApIHtcbiAgICByZXR1cm4geWVhciAlIDQgPT0gMCAmJiB5ZWFyICUgMTAwICE9IDAgfHwgeWVhciAlIDQwMCA9PSAwO1xufVxuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BkYnJpZGdlcy92aXN1YWxpemluZy1zZWFzb25hbC1kYXlsaWdodFxuc29sYXJTeXN0ZW0gPSAocm9vdCwgdml6d2lkdGgsIGxvY2F0aW9uLCBkYXRlLCBob3VyLCBkYXJrbW9kZSkgPT4ge1xuICBjb25zdCBlYXJ0aFJhZGl1cyA9IDAuMDY1ICogdml6d2lkdGg7XG4gIC8vIGNvbnN0IHN1blJhZGl1cyA9IDAuMDE1ICogdml6d2lkdGg7XG4gIGNvbnN0IHNvbGFyU3lzdGVtUmFkaXVzID0gdml6d2lkdGggLyAyIC0gKHZpendpZHRoIDwgNTAwID8gNCA6IDIwKTtcbiAgY29uc3Qgc3RyZXRjaCA9IDAuMDY7XG4gIGNvbnN0IHNvbGFyQW5nbGUgPSBnZXRTb2xhckFuZ2xlKGRhdGUpO1xuICBjb25zdCBzb2xhckFuZ2xlRGVnID0gKHNvbGFyQW5nbGUgKiAxODApIC8gTWF0aC5QSTtcbiAgY29uc3QgeCA9IHNvbGFyU3lzdGVtUmFkaXVzICogTWF0aC5zaW4oc29sYXJBbmdsZSk7XG4gIGNvbnN0IHkgPSBzdHJldGNoICogc29sYXJTeXN0ZW1SYWRpdXMgKiBNYXRoLmNvcyhzb2xhckFuZ2xlKTtcbiAgY29uc3Qgc3BpbiA9IDE4MCArIC1sb2NhdGlvblswXSArIHNvbGFyQW5nbGVEZWcgKyAzNjAgKiAoKGhvdXIgKyAxMikgLyAyNCk7XG4gIGNvbnN0IGVhcnRoR2VvID0geyB0eXBlOiBcIlNwaGVyZVwiIH07XG4gIGNvbnN0IHByb2plY3Rpb24gPSBkM1xuICAgIC5nZW9PcnRob2dyYXBoaWMoKVxuICAgIC5maXRXaWR0aChlYXJ0aFJhZGl1cyAqIDIsIGVhcnRoR2VvKVxuICAgIC5yb3RhdGUoW3NwaW4sIDAsIDIzLjVdKVxuICAgIC50cmFuc2xhdGUoWzAsIDBdKTtcbiAgY29uc3Qgc3RhdGljUHJvamVjdGlvbiA9IGQzXG4gICAgLmdlb09ydGhvZ3JhcGhpYygpXG4gICAgLmZpdFdpZHRoKGVhcnRoUmFkaXVzICogMiwgZWFydGhHZW8pXG4gICAgLnJvdGF0ZShbc29sYXJBbmdsZURlZyAtIDkwLCAwXSlcbiAgICAudHJhbnNsYXRlKFswLCAwXSk7XG4gIGNvbnN0IHBhdGggPSBkMy5nZW9QYXRoKHByb2plY3Rpb24pLnBvaW50UmFkaXVzKDEuNSk7XG4gIGNvbnN0IHN0YXRpY1BhdGggPSBkMy5nZW9QYXRoKHN0YXRpY1Byb2plY3Rpb24pO1xuICBjb25zdCBvY2VhbkNvbG9yID0gZGFya21vZGUgPyBcIiMwMDdGRkZcIiA6IG1hcGNvbG9ycy5vY2VhbjtcbiAgY29uc3QgbGFuZENvbG9yID0gZGFya21vZGUgPyBcIiMwODA4XCIgOiBtYXBjb2xvcnMubGFuZDtcbiAgY29uc3QgYm9yZGVyQ29sb3IgPSBkYXJrbW9kZSA/IFwiI2VlZVwiIDogXCIjMzMzXCI7XG4gIGNvbnN0IHNvbGFyU3lzdGVtID0gcm9vdFxuICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke3ZpendpZHRoIC8gMn0pYCk7XG4gIC8vIHNvbGFyU3lzdGVtLmFwcGVuZChcImNpcmNsZVwiKS5hdHRyKFwiclwiLCBzdW5SYWRpdXMpLmF0dHIoXCJmaWxsXCIsIGNvbG9ycy5zdW4pO1xuICAvKiBEcmF3IG9yYml0ICovXG4gICAgc29sYXJTeXN0ZW1cbiAgICAgIC5hcHBlbmQoXCJlbGxpcHNlXCIpXG4gICAgICAuYXR0cihcInJ4XCIsIHNvbGFyU3lzdGVtUmFkaXVzKVxuICAgICAgLmF0dHIoXCJyeVwiLCBzdHJldGNoICogc29sYXJTeXN0ZW1SYWRpdXMpXG4gICAgICAuYXR0cihcImZpbGxcIiwgXCJub25lXCIpXG4gICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCBcIjEuMjVcIilcbiAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiYmxhY2tcIik7XG4gICAgLyogRHJhdyBtb250aCB0aWNrcyAqL1xuICAgIGQzLnJhbmdlKDEyKS5tYXAoKG0pID0+IHtcbiAgICAgIGNvbnN0IGQgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIG0sIDEpO1xuICAgICAgY29uc3QgYW5nbGUgPSBnZXRTb2xhckFuZ2xlKGQpO1xuICAgICAgc29sYXJTeXN0ZW1cbiAgICAgICAgLmFwcGVuZChcImxpbmVcIilcbiAgICAgICAgLmF0dHIoXCJ4MVwiLCAoc29sYXJTeXN0ZW1SYWRpdXMgKyA5KSAqIE1hdGguc2luKGFuZ2xlKSlcbiAgICAgICAgLmF0dHIoXCJ5MVwiLCAoc29sYXJTeXN0ZW1SYWRpdXMgKyA5KSAqIHN0cmV0Y2ggKiBNYXRoLmNvcyhhbmdsZSkpXG4gICAgICAgIC5hdHRyKFwieDJcIiwgKHNvbGFyU3lzdGVtUmFkaXVzIC0gOSkgKiBNYXRoLnNpbihhbmdsZSkpXG4gICAgICAgIC5hdHRyKFwieTJcIiwgKHNvbGFyU3lzdGVtUmFkaXVzIC0gOSkgKiBzdHJldGNoICogTWF0aC5jb3MoYW5nbGUpKVxuICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCBcIjEuNzVcIilcbiAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgXCJibGFja1wiKTtcbiAgICAgIGNvbnN0IHN0YXJ0TW9udGhBbmdsZSA9IGdldFNvbGFyQW5nbGUobmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCBtLCAxKSk7XG4gICAgICBzb2xhclN5c3RlbVxuICAgICAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAudGV4dChkYXRlMmRvdHkoZCkpXG4gICAgICAgIC5hdHRyKFwieFwiLCAoc29sYXJTeXN0ZW1SYWRpdXMgKyAxOCAtIHdpZHRoIC8gNTApICogTWF0aC5zaW4oc3RhcnRNb250aEFuZ2xlKSAqIDEuMSlcbiAgICAgICAgLmF0dHIoXG4gICAgICAgICAgXCJ5XCIsXG4gICAgICAgICAgKHNvbGFyU3lzdGVtUmFkaXVzICsgMiAtIHdpZHRoIC8gMykgKiA2LjIgKiBzdHJldGNoICogTWF0aC5jb3Moc3RhcnRNb250aEFuZ2xlKSArIE1hdGguc2lnbihNYXRoLmNvcyhzdGFydE1vbnRoQW5nbGUpKSAqIDEyXG4gICAgICAgIClcbiAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAuYXR0cihcImRvbWluYW50LWJhc2VsaW5lXCIsIFwibWlkZGxlXCIpXG4gICAgICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIGZvbnRTaXplICogKHdpZHRoIDwgMzAwID8gLjkgOiB3aWR0aCA8IDQwMCA/IC45NSA6IHdpZHRoIDwgNTAwID8gMSA6IHdpZHRoIDwgNjAwID8gMS4wNSA6IHdpZHRoIDwgNzAwID8gMS4xIDogMS4yKSArIHdpZHRoIC8gMTAwKVxuICAgICAgICAuYXR0cihcImZvbnQtZmFtaWx5XCIsIFwic2Fucy1zZXJpZlwiKVxuICAgICAgICAuYXR0cihcImZpbGxcIiwgXCJibGFja1wiKTtcbiAgICB9KTtcbiAgICBjb25zdCBlYXJ0aCA9IHNvbGFyU3lzdGVtXG4gICAgICAuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke3h9LCAke3l9KWApO1xuICAgIGZ1bmN0aW9uIGRyYXdFYXJ0aCgpIHtcbiAgICAgIGVhcnRoLmFwcGVuZChcImxpbmVcIikuYXR0cihcInkxXCIsIC0xLjUgKiBlYXJ0aFJhZGl1cykuYXR0cihcInkyXCIsIDEuNSAqIGVhcnRoUmFkaXVzKS5hdHRyKFwic3Ryb2tlXCIsIFwiYmx1ZVwiKS5hdHRyKFwidHJhbnNmb3JtXCIsIGByb3RhdGUoLTIzLjUpYCk7XG4gICAgICBlYXJ0aC5hcHBlbmQoXCJwYXRoXCIpLmF0dHIoXCJkXCIsIHBhdGgoZWFydGhHZW8pKS5hdHRyKFwiZmlsbFwiLCBkYXJrbW9kZSA/IFwiIzAwN0ZGRlwiIDogbWFwY29sb3JzLm9jZWFuKS5hdHRyKFwiaWRcIiwgXCJnbG9iZU9jZWFuXCIpO1xuICAgICAgZWFydGguYXBwZW5kKFwicGF0aFwiKS5hdHRyKFwiZFwiLCBwYXRoKGxhbmQpKS5hdHRyKFwiZmlsbFwiLCBkYXJrbW9kZSA/IFwiIzA4MDhcIiA6IG1hcGNvbG9ycy5sYW5kKS5hdHRyKFwiaWRcIiwgXCJnbG9iZUxhbmRcIik7XG4gICAgICBlYXJ0aC5hcHBlbmQoXCJwYXRoXCIpLmF0dHIoXCJkXCIsIHBhdGgoY291bnRyaWVzKSkuYXR0cihcInN0cm9rZS13aWR0aFwiLCBcIi4wOFwiKS5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIikuYXR0cihcInN0cm9rZVwiLCBkYXJrbW9kZSA/IFwiI2VlZVwiIDogXCIjMzMzXCIpLmF0dHIoXCJpZFwiLCBcImdsb2JlQm9yZGVyc1wiKTtcbiAgICAgIHBhdGgucG9pbnRSYWRpdXMoNS41KTtcbiAgICAgIGVhcnRoLmFwcGVuZChcInBhdGhcIikuYXR0cihcImRcIiwgcGF0aCh7IHR5cGU6IFwiUG9pbnRcIiwgY29vcmRpbmF0ZXM6IGxvY2F0aW9uIH0pKS5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIikuYXR0cihcInN0cm9rZS13aWR0aFwiLCAuNikuYXR0cihcInN0cm9rZVwiLCBcImJsYWNrXCIpO1xuICAgICAgcGF0aC5wb2ludFJhZGl1cyg0LjUpO1xuICAgICAgZWFydGguYXBwZW5kKFwicGF0aFwiKS5hdHRyKFwiZFwiLCBwYXRoKHsgdHlwZTogXCJQb2ludFwiLCBjb29yZGluYXRlczogbG9jYXRpb24gfSkpLmF0dHIoXCJmaWxsXCIsIFwibm9uZVwiKS5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDIuMjUpLmF0dHIoXCJzdHJva2VcIiwgXCJyZWRcIik7XG4gIH1cbiAgZHJhd0VhcnRoKCk7XG59XG5mdW5jdGlvbiBncmVnMmRvdHkobW9udGggPSAxLCBkYXkgPSAxKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoXG4gICAgICAgICgxNTMgKiAobW9udGggPiAyID8gbW9udGggLSAzIDogbW9udGggKyA5KSArIDIpIC8gNSArIGRheSAtIDFcbil9XG5mdW5jdGlvbiBkYXRlMmRvdHkoZGF0ZSkge1xuICByZXR1cm4gZ3JlZzJkb3R5KGRhdGUuZ2V0TW9udGgoKSArIDEsIGRhdGUuZ2V0RGF0ZSgpKVxufVxuZnVuY3Rpb24gZGF0ZTJkb3R5MShkYXRlKSB7XG4gIHJldHVybiBncmVnMmRvdHkoZGF0ZS5nZXRNb250aCgpICsgMSwgZGF0ZS5nZXREYXRlKCkpXG59XG4vLyBodHRwczovL29ic2VydmFibGVocS5jb20vQGRicmlkZ2VzL3Zpc3VhbGl6aW5nLXNlYXNvbmFsLWRheWxpZ2h0XG4vLyBnbG9iZSA9IChyb290LCB7IHZpendpZHRoLCBsb2NhdGlvbiwgZGF0ZSwgaG91ciB9KSA9PiB7XG4vLyAgIGNvbnN0IHNvbGFyQW5nbGUgPSBnZXRTb2xhckFuZ2xlKGRhdGUpO1xuLy8gICBjb25zdCBzb2xhckFuZ2xlRGVnID0gdG9EZWdyZWVzKHNvbGFyQW5nbGUpO1xuLy8gICBjb25zdCBob3VyU3BpbiA9IDM2MCAqICgoaG91ciArIDEyKSAvIDI0KTtcbi8vICAgY29uc3Qgc3BpbiA9ICgxODAgKyAtbG9jYXRpb25bMF0gKyBzb2xhckFuZ2xlRGVnICsgaG91clNwaW4pO1xuLy8gICBjb25zdCB0aWx0ID0gLTE1O1xuLy8gICBjb25zdCBwcm9qZWN0aW9uID0gZDMuZ2VvT3J0aG9ncmFwaGljKClcbi8vICAgICAgICAgICAgICAgICAgICAgICAgLmZpdFdpZHRoKHZpendpZHRoLCBncmF0aWN1bGUpXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIC5yb3RhdGUoW3NwaW4sIHRpbHQsIDIzLjVdKTtcbi8vICAgY29uc3QgcGF0aCA9IGQzLmdlb1BhdGgocHJvamVjdGlvbik7XG4vLyAgIGNvbnN0IHVuQ2xpcHBlZFByb2plY3Rpb24gPSBkMy5nZW9PcnRob2dyYXBoaWMoKVxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xpcEFuZ2xlKG51bGwpXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maXRXaWR0aCh2aXp3aWR0aCwgZ3JhdGljdWxlKVxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucm90YXRlKFtzcGluLCB0aWx0LCAyMy41XSk7XG4vLyAgIGNvbnN0IHVuQ2xpcHBlZFBhdGggPSBkMy5nZW9QYXRoKHVuQ2xpcHBlZFByb2plY3Rpb24pO1xuLy8gICBjb25zdCBzdGF0aWNQcm9qZWN0aW9uID0gZDMuZ2VvT3J0aG9ncmFwaGljKClcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpdFdpZHRoKHZpendpZHRoLCBncmF0aWN1bGUpXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yb3RhdGUoW3NvbGFyQW5nbGVEZWcgLSA5MCwgdGlsdF0pO1xuLy8gICBjb25zdCBzdGF0aWNQYXRoID0gZDMuZ2VvUGF0aChzdGF0aWNQcm9qZWN0aW9uKTtcbi8vICAgY29uc3QgYmFja2dyb3VuZCA9IHJvb3QuYXBwZW5kKFwiZ1wiKTtcbi8vICAgY29uc3QgZWFydGggPSByb290LmFwcGVuZChcImdcIikuc3R5bGUoXCJvcGFjaXR5XCIsIDAuNzUpO1xuLy8gICBjb25zdCBmb3JlZ3JvdW5kID0gcm9vdC5hcHBlbmQoXCJnXCIpO1xuLy8gICBlYXJ0aC5hcHBlbmQoXCJwYXRoXCIpXG4vLyAgICAgLmF0dHIoXCJkXCIsIHBhdGgoe3R5cGU6IFwiU3BoZXJlXCJ9KSlcbi8vICAgICAuYXR0cihcImZpbGxcIiwgbWFwY29sb3JzLm9jZWFuKVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiIzllY2JkYVwiKTtcbi8vICAgZWFydGguYXBwZW5kKFwicGF0aFwiKVxuLy8gICAgIC5hdHRyKFwiZFwiLCBwYXRoKGxhbmQpKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBtYXBjb2xvcnMubGFuZCk7XG4vLyAgIGVhcnRoLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgcGF0aChjb3VudHJpZXMpKVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIFwiMVwiKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcbi8vICAgICAuYXR0cihcInN0cm9rZVwiLCBcIiMwMDBcIik7XG4vLyAgIGJhY2tncm91bmQuYXBwZW5kKFwicGF0aFwiKVxuLy8gICAgIC5hdHRyKFwiZFwiLCB1bkNsaXBwZWRQYXRoKHt0eXBlOiBcIlBvaW50XCIsIGNvb3JkaW5hdGVzOiBsb2NhdGlvbn0pKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJlZFwiKTtcbi8vICAgY29uc3QgbGF0aXR1ZGVDb29yZHMgPSAobGF0aXR1ZGUsIHN0YXJ0LCBlbmQpID0+IHtcbi8vICAgICBjb25zdCBsb25naXR1ZGVzID0gZDMucmFuZ2Uoc3RhcnQsIGVuZCwgMikuY29uY2F0KGVuZCk7XG4vLyAgICAgcmV0dXJuIGxvbmdpdHVkZXMubWFwKGQgPT4gW2QsIGxhdGl0dWRlXSk7XG4vLyAgIH1cbi8vICAgY29uc3QgY29ycmVjdFNwaW4gPSBkMy5nZW9Sb3RhdGlvbihbLWhvdXJTcGluLCAwXSk7XG4vLyAgIGNvbnN0IGNvcnJlY3RUaWx0ID0gZDMuZ2VvUm90YXRpb24oWzYsIDAsIDBdKTtcbi8vICAgLyogdG90YWwgYW5ndWxhciBleHRlbnQgb2YgZGF5L25pZ2h0ICovXG4vLyAgIGNvbnN0IGRheUV4dGVudCA9IDM2MCAqIGRheUxlbmd0aChkYXRlLCBsb2NhdGlvblsxXSkgLyAyNDtcbi8vICAgY29uc3QgbmlnaHRFeHRlbnQgPSAzNjAgLSBkYXlFeHRlbnQ7XG4vLyAgIGNvbnN0IGRheUxpbmUgPSB7XG4vLyAgICAgdHlwZTogXCJMaW5lU3RyaW5nXCIsXG4vLyAgICAgY29vcmRpbmF0ZXM6IGxhdGl0dWRlQ29vcmRzKGxvY2F0aW9uWzFdLFxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvblswXSAtIGRheUV4dGVudCAvIDIsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uWzBdICsgZGF5RXh0ZW50IC8gMikubWFwKGQgPT4gY29ycmVjdFNwaW4oZCkpXG4vLyAgIH07XG4vLyAgIGNvbnN0IG5pZ2h0TGluZSA9IHtcbi8vICAgICB0eXBlOiBcIkxpbmVTdHJpbmdcIixcbi8vICAgICBjb29yZGluYXRlczogbGF0aXR1ZGVDb29yZHMobG9jYXRpb25bMV0sXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uWzBdIC0gZGF5RXh0ZW50IC8gMiAtIG5pZ2h0RXh0ZW50LFxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvblswXSAtIGRheUV4dGVudCAvIDIpLm1hcChkID0+IGNvcnJlY3RTcGluKGQpKVxuLy8gICB9O1xuLy8gICBiYWNrZ3JvdW5kLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgdW5DbGlwcGVkUGF0aChkYXlMaW5lKSlcbi8vICAgICAuYXR0cihcImZpbGxcIiwgXCJub25lXCIpXG4vLyAgICAgLmF0dHIoXCJzdHJva2VcIiwgbWFwY29sb3JzLmRheSlcbi8vICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAzKTtcbi8vICAgYmFja2dyb3VuZC5hcHBlbmQoXCJwYXRoXCIpXG4vLyAgICAgLmF0dHIoXCJkXCIsIHVuQ2xpcHBlZFBhdGgobmlnaHRMaW5lKSlcbi8vICAgICAuYXR0cihcImZpbGxcIiwgXCJub25lXCIpXG4vLyAgICAgLmF0dHIoXCJzdHJva2VcIiwgbWFwY29sb3JzLm5pZ2h0KVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDMpO1xuLy8gICBmb3JlZ3JvdW5kLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgcGF0aChkYXlMaW5lKSlcbi8vICAgICAuYXR0cihcImZpbGxcIiwgXCJub25lXCIpXG4vLyAgICAgLmF0dHIoXCJzdHJva2VcIiwgbWFwY29sb3JzLmRheSlcbi8vICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAzKTtcbi8vICAgZm9yZWdyb3VuZC5hcHBlbmQoXCJwYXRoXCIpXG4vLyAgICAgLmF0dHIoXCJkXCIsIHBhdGgobmlnaHRMaW5lKSlcbi8vICAgICAuYXR0cihcImZpbGxcIiwgXCJub25lXCIpXG4vLyAgICAgLmF0dHIoXCJzdHJva2VcIiwgbWFwY29sb3JzLm5pZ2h0KVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDMpO1xuLy8gICBmb3JlZ3JvdW5kLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgcGF0aCh7dHlwZTogXCJQb2ludFwiLCBjb29yZGluYXRlczogbG9jYXRpb259KSlcbi8vICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAuNSlcbi8vICAgICAuYXR0cihcInN0cm9rZVwiLCBcImJsYWNrXCIpXG4vLyAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmVkXCIpO1xuLy8gICBjb25zdCBzaGFkb3dQb2x5Z29uID0gW1swLCAtOTBdLCBbMCwgMF0sIFswLCA5MF0sIFsxODAsIDBdLCBbMCwgLTkwXV0ubWFwKGQgPT4gY29ycmVjdFRpbHQoZCkpO1xuLy8gICBmb3JlZ3JvdW5kLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgc3RhdGljUGF0aCh7dHlwZTogXCJQb2x5Z29uXCIsIGNvb3JkaW5hdGVzOiBbc2hhZG93UG9seWdvbl19KSlcbi8vICAgICAuYXR0cihcImZpbGxcIiwgXCJyZ2JhKDAsIDAsIDAsIDAuMjUpXCIpO1xuLy8gfVxuZGF5T2ZZZWFyID0gKGRhdGUpID0+IHtcbiAgY29uc3QgeWVhclN0YXJ0ID0gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCAwLCAxKzYwKTtcbiAgcmV0dXJuIE1hdGguZmxvb3IoKGRhdGUuZ2V0VGltZSgpIC0geWVhclN0YXJ0LmdldFRpbWUoKSkvODY0MDAwMDApICsgMVxufVxuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BkYnJpZGdlcy92aXN1YWxpemluZy1zZWFzb25hbC1kYXlsaWdodFxuZGF5bGlnaHRQbG90ID0gKFxuICByb290LFxuICB7IHZpendpZHRoLCBoZWlnaHQsIHllYXIsIGxhdGl0dWRlLCBkZWZhdWx0RGF0ZSwgZGVmYXVsdEhvdXIgfVxuKSA9PiB7XG4gIGNvbnN0IG1hcmdpbiA9IHsgdG9wOiAzMiwgYm90dG9tOiAzMiwgbGVmdDogMzIsIHJpZ2h0OiAwIH07XG4gIGNvbnN0IGNoYXJ0V2lkdGggPSB2aXp3aWR0aCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0O1xuICBjb25zdCBjaGFydEhlaWdodCA9IGhlaWdodCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tO1xuICBjb25zdCB5VGlja1ZhbHVlcyA9XG4gICAgd2lkdGggPiAzODAgPyBbMywgNiwgOSwgMTIsIDE1LCAxOCwgMjFdIDogd2lkdGggPiA5MCA/IFs2LCAxMiwgMThdIDogWzEyXTtcbiAgY29uc3QgeVNjYWxlID0gZDNcbiAgICAuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzAsIDI0XSlcbiAgICAucmFuZ2UoW21hcmdpbi5sZWZ0LCBtYXJnaW4ubGVmdCArIGNoYXJ0V2lkdGhdKVxuICAgIC5jbGFtcCh0cnVlKTtcbiAgLy8geS1heGlzIHNjYWxlXG4gIGNvbnN0IHhTY2FsZSA9IGQzXG4gICAgLnNjYWxlVGltZSgpXG4gICAgLmRvbWFpbihbbmV3IERhdGUoeWVhciwgMCwgNjEpLCBuZXcgRGF0ZSh5ZWFyLCAxMSwgOTEpXSlcbiAgICAucmFuZ2UoW21hcmdpbi50b3AsIG1hcmdpbi50b3AgKyBjaGFydEhlaWdodF0pXG4gICAgLmNsYW1wKHRydWUpO1xuICAvLyB5LWF4aXMgbGFiZWxzXG4gIGNvbnN0IHhBeGlzID0gZDNcbiAgICAuYXhpc0JvdHRvbSh4U2NhbGUpXG4gICAgLnRpY2tWYWx1ZXMoZDMudGltZU1vbnRoLnJhbmdlKG5ldyBEYXRlKHllYXIsIDAsIDYwKSwgbmV3IERhdGUoeWVhciwgMTIsIDU3KSkpXG4gICAgLnRpY2tTaXplKGNoYXJ0V2lkdGgpXG4gICAgLnRpY2tGb3JtYXQoZGF0ZTJkb3R5MSk7XG4gIGNvbnN0IHlBeGlzID0gZDNcbiAgICAuYXhpc0xlZnQoeVNjYWxlKVxuICAgIC50aWNrVmFsdWVzKHlUaWNrVmFsdWVzKVxuICAgIC50aWNrU2l6ZShjaGFydEhlaWdodClcbiAgICAudGlja0Zvcm1hdCgoZCkgPT4geyByZXR1cm4gYCR7ZCAvIC4wMjR9YCB9KTtcbiAgbGV0IGRhdGUgPSBkZWZhdWx0RGF0ZSB8fCBuZXcgRGF0ZSgpO1xuICBsZXQgaG91ciA9IGRlZmF1bHRIb3VyICE9IG51bGwgPyBkZWZhdWx0SG91ciA6IGRhdGUuZ2V0SG91cnMoKTtcbiAgY29uc3QgaGFuZGxlTW91c2VNb3ZlID0gKGUpID0+IHt9O1xuICByb290XG4gICAgLmFwcGVuZChcInJlY3RcIilcbiAgICAuYXR0cihcInlcIiwgbWFyZ2luLmxlZnQpXG4gICAgLmF0dHIoXCJ4XCIsIG1hcmdpbi50b3ApXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgY2hhcnRXaWR0aClcbiAgICAuYXR0cihcIndpZHRoXCIsIGNoYXJ0SGVpZ2h0KVxuICAgIC5hdHRyKFwicnlcIiwgMC4wNSAqIHZpendpZHRoKVxuICAgIC5hdHRyKFwiZmlsbFwiLCBtYXBjb2xvcnMubmlnaHQpO1xuICByb290XG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKDAsICR7bWFyZ2luLnRvcH0pYClcbiAgICAuY2FsbCh4QXhpcylcbiAgICAuY2FsbCgoZykgPT4gZy5zZWxlY3QoXCIuZG9tYWluXCIpLnJlbW92ZSgpKVxuICAgIC5jYWxsKChnKSA9PiBnLnNlbGVjdEFsbChcIi50aWNrXCIpLmF0dHIoXCJjb2xvclwiLCBtYXBjb2xvcnMuZ3JpZCkpXG4gICAgLmNhbGwoKGcpID0+IGcuc2VsZWN0QWxsKFwiLnRpY2sgdGV4dFwiKS5hdHRyKFwiZm9udC1zaXplXCIsICh3aWR0aCA8IDMwMCA/IC43IDogd2lkdGggPCAzMjUgPyAuNzI1IDogd2lkdGggPCAzNTAgPyAuNzUgOiB3aWR0aCA8IDM3NSA/IC44IDogd2lkdGggPCA0MDAgPyAuOSA6IHdpZHRoIDwgNDUwID8gLjk1IDogd2lkdGggPCA1MDAgPyAxIDogd2lkdGggPCA2MDAgPyAxLjIgOiB3aWR0aCA8IDcwMCA/IDEuMyA6IDEuNCkgKiBmb250U2l6ZSkpXG4gICAgLmNhbGwoKGcpID0+IGcuc2VsZWN0QWxsKFwiLnRpY2sgdGV4dFwiKS5hdHRyKFwiY29sb3JcIiwgXCJibGFja1wiKSlcbiAgICAuY2FsbCgoZykgPT4gZy5zZWxlY3RBbGwoXCIudGljayBsaW5lXCIpLmF0dHIoXCJzdHJva2UtZGFzaGFycmF5XCIsIFwiNSAzXCIpKTtcbiAgcm9vdFxuICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0ICsgY2hhcnRIZWlnaHR9LCAwKWApXG4gICAgLmNhbGwoeUF4aXMpXG4gICAgLmNhbGwoKGcpID0+IGcuc2VsZWN0KFwiLmRvbWFpblwiKS5yZW1vdmUoKSlcbiAgICAuY2FsbCgoZykgPT4gZy5zZWxlY3RBbGwoXCIudGlja1wiKS5hdHRyKFwiY29sb3JcIiwgbWFwY29sb3JzLmdyaWQpKVxuICAgIC5jYWxsKChnKSA9PiBnLnNlbGVjdEFsbChcIi50aWNrIHRleHRcIikuYXR0cihcImZvbnQtc2l6ZVwiLCAod2lkdGggPCA0MDAgPyAuOSA6IHdpZHRoIDwgNTAwID8gMSA6IHdpZHRoIDwgNjAwID8gMS4xIDogd2lkdGggPCA3MDAgPyAxLjIgOiAxLjMpICogZm9udFNpemUpKVxuICAgIC5jYWxsKChnKSA9PiBnLnNlbGVjdEFsbChcIi50aWNrIHRleHRcIikuYXR0cihcImNvbG9yXCIsIFwiYmxhY2tcIikpXG4gICAgLmNhbGwoKGcpID0+IGcuc2VsZWN0QWxsKFwiLnRpY2sgbGluZVwiKS5hdHRyKFwic3Ryb2tlLWRhc2hhcnJheVwiLCBcIjUgM1wiKSk7XG4gIHJvb3RcbiAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgIC50ZXh0KFwiVGltZSBvZiBkYXlcIilcbiAgICAuYXR0cihcInhcIiwgbWFyZ2luLmJvdHRvbSArICh3aWR0aCA8IDI3NSA/IC0xMDIgOiB3aWR0aCA8IDMwMCA/IC0xMDYgOiB3aWR0aCA8IDMyNSA/IC0xMDggOiB3aWR0aCA8IDM1MCA/IC0xMTUgOiB3aWR0aCA8IDM3NSA/IC0xMjAgOiB3aWR0aCA8IDQwMCA/IC0xMjggOiB3aWR0aCA8IDQyNSA/IC0xMzAgOiB3aWR0aCA8IDQ1MCA/IC0xMzIgOiB3aWR0aCA8IDQ3NSA/IC0xMzYgOiB3aWR0aCA8IDUwMCA/IC0xNDEgOiB3aWR0aCA8IDUyNSA/IC0xNDIgOiB3aWR0aCA8IDU1MCA/IC0xNDggOiB3aWR0aCA8IDU3NSA/IC0xNDkgOiB3aWR0aCA8IDYwMCA/IC0xNTQgOiB3aWR0aCA8IDY1MCA/IC0xNTcgOiB3aWR0aCA8IDY3NSA/IC0xNTcgOiB3aWR0aCA8IDcwMCA/IC0xNjEgOiB3aWR0aCA8IDcyNSA/IC0xNjAgOiB3aWR0aCA8IDc1MCA/IC0xNjUgOiB3aWR0aCA8IDc3NSA/IC0xNjkgOiAtMTczKSlcbiAgICAuYXR0cihcInlcIiwgbWFyZ2luLnRvcCAtICh3aWR0aCA8IDQwMCA/IDMzIDogd2lkdGggPCA1MDAgPyAzNSA6IHdpZHRoIDwgNjAwID8gMzcgOiB3aWR0aCA8IDcwMCA/IDQwIDogNDIpKVxuICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCBmb250U2l6ZSAqICh3aWR0aCA8IDMwMCA/IC44IDogd2lkdGggPCA0MDAgPyAuOSA6IHdpZHRoIDwgNTAwID8gMSA6IHdpZHRoIDwgNjAwID8gMS4xIDogd2lkdGggPCA3MDAgPyAxLjIgOiAxLjI1KSArIHdpZHRoIC8gMTAwKVxuICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJzYW5zLXNlcmlmXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJyb3RhdGUoLTkwKVwiKVxuICAgIC5hdHRyKFwiZmlsbFwiLCBcImJsYWNrXCIpO1xuICByb290XG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAudGV4dChcIkRheSBvZiB5ZWFyXCIpXG4gICAgLmF0dHIoXCJ4XCIsIG1hcmdpbi5sZWZ0ICsgd2lkdGggLyAyIC0gKHdpZHRoIDwgNTAwID8gMzAgOiB3aWR0aCA8IDYwMCA/IDI4IDogd2lkdGggPCA3MDAgPyAyNCA6IDIyKSlcbiAgICAuYXR0cihcInlcIiwgbWFyZ2luLnRvcCArIGNoYXJ0SGVpZ2h0IC8gNCArIG1hcmdpbi5ib3R0b20gKyAod2lkdGggPCAyNzUgPyAxMCA6IHdpZHRoIDwgMzAwID8gMTggOiB3aWR0aCA8IDMyNSA/IDE5IDogd2lkdGggPCAzNTAgPyAyMiA6IHdpZHRoIDwgMzc1ID8gMzAgOiB3aWR0aCA8IDQwMCA/IDM3IDogd2lkdGggPCA0NTAgPyAzOSA6IHdpZHRoIDwgNDc1ID8gNDAgOiB3aWR0aCA8IDUwMCA/IDQ0IDogd2lkdGggPCA1NTAgPyA1MCA6IHdpZHRoIDwgNjAwID8gNTEgOiB3aWR0aCA8IDY1MCA/IDUwIDogd2lkdGggPCA3MDAgPyA0NCA6IHdpZHRoIDwgNzUwID8gNDAgOiA0MykpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIGZvbnRTaXplICogKHdpZHRoIDwgMzAwID8gLjk1IDogd2lkdGggPCA0MDAgPyAxIDogd2lkdGggPCA1MDAgPyAxLjA1IDogd2lkdGggPCA2MDAgPyAxLjE1IDogd2lkdGggPCA3MDAgPyAxLjIgOiAxLjI1KSArIHdpZHRoIC8gMTAwKVxuICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJzYW5zLXNlcmlmXCIpXG4gICAgLmF0dHIoXCJmaWxsXCIsIFwiYmxhY2tcIik7XG4gIGNvbnN0IGRhdGEgPSB5ZWFyRGF0ZXMoeWVhcilcbiAgICAubWFwKChkKSA9PiBbZCwgZGF5TGVuZ3RoKGQsIGxhdGl0dWRlKV0pXG4gICAgLmZpbHRlcigoW18sIGRdKSA9PiBkID4gMCk7XG4gIC8qIFJlbmRlciBzZXBhcmF0ZSBwb2x5Z29ucyBmb3IgZWFjaCBjb250aW51b3VzIHNlcXVlbmNlIG9mXG4gICAqIGRheXMgd2l0aCBtb3JlIHRoYW4gMCBob3VycyBvZiBkYXkgbGlnaHRcbiAgICovXG4gIGNvbnN0IHBvbHlzID0gW107XG4gIGxldCBjdXJyZW50UG9seSA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IGRhdGFbaV1bMF07XG4gICAgY29uc3QgcHJldkRhdGUgPSAoZGF0YVtpIC0gMV0gfHwgW10pWzBdO1xuICAgIGlmIChcbiAgICAgIGkgPT09IDAgfHxcbiAgICAgIGN1cnJlbnREYXRlLmdldFRpbWUoKSAtIHByZXZEYXRlLmdldFRpbWUoKSA8IDM2MDAgKiAyNCAqIDEwMDAgKiAxLjVcbiAgICApIHtcbiAgICAgIGN1cnJlbnRQb2x5LnB1c2goZGF0YVtpXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvbHlzLnB1c2goY3VycmVudFBvbHkpO1xuICAgICAgY3VycmVudFBvbHkgPSBbZGF0YVtpXV07XG4gICAgfVxuICB9XG4gIHBvbHlzLnB1c2goY3VycmVudFBvbHkpO1xuICBwb2x5cy5mb3JFYWNoKChwKSA9PiB7XG4gICAgY29uc3QgcG9pbnRzID0gW1xuICAgICAgLi4ucC5tYXAoKFtkLCBsXSkgPT4gYCR7eFNjYWxlKGQpfSwke3lTY2FsZSgxMiAtIGwgLyAyKX1gKSxcbiAgICAgIC4uLnAucmV2ZXJzZSgpLm1hcCgoW2QsIGxdKSA9PiBgJHt4U2NhbGUoZCl9LCR7eVNjYWxlKDEyICsgbCAvIDIpfWApXG4gICAgXS5qb2luKFwiIFwiKTtcbiAgICByb290LmFwcGVuZChcInBvbHlnb25cIikuYXR0cihcInBvaW50c1wiLCBwb2ludHMpLmF0dHIoXCJmaWxsXCIsIG1hcGNvbG9ycy5kYXkpO1xuICB9KTtcbiAgLyogTGVnZW5kICovXG4gIGNvbnN0IGxlZ2VuZCA9IHJvb3RcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdCArIGNoYXJ0V2lkdGggLyAyIC0gNjR9KWApO1xuICBsZWdlbmRcbiAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgIC5hdHRyKFwieFwiLCB3aWR0aCA8IDMwMCA/IDYzIDogd2lkdGggPCA1MDAgPyA2MiA6IHdpZHRoIDwgNjAwID8gNjEgOiA2MClcbiAgICAuYXR0cihcInlcIiwgd2lkdGggPCA0NTAgPyA4IDogMSlcbiAgICAuYXR0cihcInJ4XCIsIDUpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCBmb250U2l6ZSAqICh3aWR0aCA8IDMwMCA/IC45NSA6IHdpZHRoIDwgNDAwID8gMSA6IHdpZHRoIDwgNTAwID8gMS4wNSA6IHdpZHRoIDwgNjAwID8gMS4xNSA6IHdpZHRoIDwgNzAwID8gMS4yIDogMS4yNSkgKyB3aWR0aCAvIDEwMClcbiAgICAuYXR0cihcImhlaWdodFwiLCBmb250U2l6ZSAqICh3aWR0aCA8IDMwMCA/IC45NSA6IHdpZHRoIDwgNDAwID8gMSA6IHdpZHRoIDwgNTAwID8gMS4wNSA6IHdpZHRoIDwgNjAwID8gMS4xNSA6IHdpZHRoIDwgNzAwID8gMS4yIDogMS4yNSkgKyB3aWR0aCAvIDEwMClcbiAgICAuYXR0cihcImZpbGxcIiwgbWFwY29sb3JzLmRheSk7XG4gIGxlZ2VuZFxuICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIHdpZHRoIDwgNDAwID8gODIgOiB3aWR0aCA8IDUwMCA/IDg1IDogd2lkdGggPCA2MDAgPyA4NyA6IDkwKVxuICAgIC5hdHRyKFwieVwiLCB3aWR0aCA8IDMwMCA/IDIyIDogd2lkdGggPCA0MDAgPyAyMyA6IHdpZHRoIDwgNDUwID8gMjQgOiB3aWR0aCA8IDUwMCA/IDE4IDogd2lkdGggPCA2MDAgPyAyMCA6IHdpZHRoIDwgNzAwID8gMjEgOiAyMylcbiAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCBmb250U2l6ZSAqICh3aWR0aCA8IDMwMCA/IC45NSA6IHdpZHRoIDwgNDAwID8gMSA6IHdpZHRoIDwgNTAwID8gMS4wNSA6IHdpZHRoIDwgNjAwID8gMS4xNSA6IHdpZHRoIDwgNzAwID8gMS4yIDogMS4yNSkgKyB3aWR0aCAvIDEwMClcbiAgICAuYXR0cihcImZvbnQtZmFtaWx5XCIsIFwic2Fucy1zZXJpZlwiKVxuICAgIC50ZXh0KFwiRGF5XCIpO1xuICBsZWdlbmRcbiAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgIC5hdHRyKFwieFwiLCB3aWR0aCA8IDQwMCA/IC0xMCA6IHdpZHRoIDwgNTAwID8gLTIwIDogd2lkdGggPCA2MDAgPyAtNDAgOiAtMzkpXG4gICAgLmF0dHIoXCJ5XCIsIHdpZHRoIDwgNDUwID8gOCA6IDEpXG4gICAgLmF0dHIoXCJyeFwiLCA1KVxuICAgIC5hdHRyKFwid2lkdGhcIiwgZm9udFNpemUgKiAod2lkdGggPCAzMDAgPyAuOTUgOiB3aWR0aCA8IDQwMCA/IDEgOiB3aWR0aCA8IDUwMCA/IDEuMDUgOiB3aWR0aCA8IDYwMCA/IDEuMTUgOiB3aWR0aCA8IDcwMCA/IDEuMiA6IDEuMjUpICsgd2lkdGggLyAxMDApXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgZm9udFNpemUgKiAod2lkdGggPCAzMDAgPyAuOTUgOiB3aWR0aCA8IDQwMCA/IDEgOiB3aWR0aCA8IDUwMCA/IDEuMDUgOiB3aWR0aCA8IDYwMCA/IDEuMTUgOiB3aWR0aCA8IDcwMCA/IDEuMiA6IDEuMjUpICsgd2lkdGggLyAxMDApXG4gICAgLmF0dHIoXCJmaWxsXCIsIG1hcGNvbG9ycy5uaWdodCk7XG4gIGxlZ2VuZFxuICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIHdpZHRoIDwgNDAwID8gMTEgOiB3aWR0aCA8IDUwMCA/IDQgOiB3aWR0aCA8IDYwMCA/IC0xMiA6IC05KVxuICAgIC5hdHRyKFwieVwiLCB3aWR0aCA8IDMwMCA/IDIyIDogd2lkdGggPCA0MDAgPyAyMyA6IHdpZHRoIDwgNDUwID8gMjQgOiB3aWR0aCA8IDUwMCA/IDE4IDogd2lkdGggPCA2MDAgPyAxOSA6IHdpZHRoIDwgNzAwID8gMjEgOiAyMylcbiAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCBmb250U2l6ZSAqICh3aWR0aCA8IDMwMCA/IC45NSA6IHdpZHRoIDwgNDAwID8gMSA6IHdpZHRoIDwgNTAwID8gMS4wNSA6IHdpZHRoIDwgNjAwID8gMS4xNSA6IHdpZHRoIDwgNzAwID8gMS4yIDogMS4yNSkgKyB3aWR0aCAvIDEwMClcbiAgICAuYXR0cihcImZvbnQtZmFtaWx5XCIsIFwic2Fucy1zZXJpZlwiKVxuICAgIC50ZXh0KFwiTmlnaHRcIik7XG4gIC8qIFRpbWUgYW5kIGRhdGUgY29udHJvbHMgKi9cbiAgY29uc3QgZGF0ZUxpbmUgPSByb290LmFwcGVuZChcImdcIik7XG4gIGNvbnN0IHVwZGF0ZUNvbnRyb2xQb3NpdGlvbnMgPSAoKSA9PiB7XG4gICAgZGF0ZUxpbmVcbiAgICAgIC5zZWxlY3QoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcInkxXCIsIHlTY2FsZSgwKSlcbiAgICAgIC5hdHRyKFwieDFcIiwgeFNjYWxlKGRhdGUpKVxuICAgICAgLmF0dHIoXCJ5MlwiLCB5U2NhbGUoMjQpKVxuICAgICAgLmF0dHIoXCJ4MlwiLCB4U2NhbGUoZGF0ZSkpO1xuICAgIGRhdGVMaW5lXG4gICAgICAuc2VsZWN0KFwicmVjdFwiKVxuICAgICAgLmF0dHIoXCJ5XCIsIHlTY2FsZSgwKSlcbiAgICAgIC5hdHRyKFwieFwiLCB4U2NhbGUoZGF0ZSkgLSA0KTtcbiAgICByb290XG4gICAgICAuc2VsZWN0KFwiI3RpbWUtY29udHJvbFwiKVxuICAgICAgLmF0dHIoXCJjeVwiLCB5U2NhbGUoaG91cikpXG4gICAgICAuYXR0cihcImN4XCIsIHhTY2FsZShkYXRlKSk7XG4gIH07XG4gIGNvbnN0IGRpc3BhdGNoRGF0ZUhvdXJDaGFuZ2UgPSAoKSA9PiB7XG4gICAgY29uc3QgZGV0YWlsID0geyBkYXRlLCBob3VyIH07XG4gICAgY29uc3QgY2hhbmdlRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoRXZlbnRUeXBlLkRhdGVIb3VyQ2hhbmdlLCB7XG4gICAgICBkZXRhaWwsXG4gICAgICBidWJibGVzOiB0cnVlXG4gICAgfSk7XG4gICAgcm9vdC5ub2RlKCkuZGlzcGF0Y2hFdmVudChjaGFuZ2VFdmVudCk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZURhdGVMaW5lRHJhZyA9ICh7IHggfSkgPT4ge1xuICAgIGRhdGUgPSB4U2NhbGUuaW52ZXJ0KHgpO1xuICAgIHVwZGF0ZUNvbnRyb2xQb3NpdGlvbnMoKTtcbiAgICBkaXNwYXRjaERhdGVIb3VyQ2hhbmdlKCk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZVRpbWVDaXJjbGVEcmFnID0gKHsgeSB9KSA9PiB7XG4gICAgaG91ciA9IHlTY2FsZS5pbnZlcnQoeSk7XG4gICAgdXBkYXRlQ29udHJvbFBvc2l0aW9ucygpO1xuICAgIGRpc3BhdGNoRGF0ZUhvdXJDaGFuZ2UoKTtcbiAgfTtcbiAgZGF0ZUxpbmUuYXBwZW5kKFwibGluZVwiKS5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDQpLmF0dHIoXCJzdHJva2VcIiwgXCJyZWRcIik7XG4gIGRhdGVMaW5lXG4gICAgLmFwcGVuZChcInJlY3RcIilcbiAgICAuYXR0cihcImhlaWdodFwiLCBjaGFydFdpZHRoKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgOClcbiAgICAuYXR0cihcImZpbGxcIiwgXCJyZ2JhKDAsIDAsIDAsIDApXCIpXG4gICAgLnN0eWxlKFwiY3Vyc29yXCIsIFwicm93LXJlc2l6ZVwiKVxuICAgIC5jYWxsKGQzLmRyYWcoKS5vbihcImRyYWdcIiwgaGFuZGxlRGF0ZUxpbmVEcmFnKSk7XG4gIHJvb3RcbiAgICAuYXBwZW5kKFwiY2lyY2xlXCIpXG4gICAgLmF0dHIoXCJpZFwiLCBcInRpbWUtY29udHJvbFwiKVxuICAgIC5hdHRyKFwiclwiLCAxMilcbiAgICAuYXR0cihcImZpbGxcIiwgXCJyZWRcIilcbiAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAuNilcbiAgICAuYXR0cihcInN0cm9rZVwiLCBcImJsYWNrXCIpXG4gICAgLnN0eWxlKFwiY3Vyc29yXCIsIFwicG9pbnRlclwiKVxuICAgIC5jYWxsKGQzLmRyYWcoKS5vbihcImRyYWdcIiwgaGFuZGxlVGltZUNpcmNsZURyYWcpKTtcbiAgdXBkYXRlQ29udHJvbFBvc2l0aW9ucygpO1xufVxuZm9udFNpemUgPSAxNDtcbmdldFNvbGFyQW5nbGUgPSAoZGF0ZSkgPT4gKGRheU9mWWVhcihkYXRlKSArIDEwKSAvIDM2NSAqIE1hdGguUEkgKiAyIC0gTWF0aC5QSSAvIDI7XG4vKlxuICogRm9ybXVsYXMgdXNlcyB0aGUgQ0JNIG1vZGVsIGFzIHJldmlld2VkIGhlcmU6XG4gKiBodHRwczovL3d3dy5pa2hlYmVlbnZyYWFnLmJlL21lZGlhc3RvcmFnZS9GU0RvY3VtZW50LzE3MS9Gb3JzeXRoZSstK0ErbW9kZWwrY29tcGFyaXNvbitmb3IrZGF5bGVuZ3RoK2FzK2ErZnVuY3Rpb24rb2YrbGF0aXR1ZGUrYW5kK2RheStvZit5ZWFyKy0rMTk5NS5wZGZcbiAqL1xuZGF5TGVuZ3RoID0gKGRhdGUsIGxhdGl0dWRlKSA9PiB7XG4gIGNvbnN0IHllYXJTdGFydCA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgMCwgMSk7XG4gIGNvbnN0IGRheU9mWWVhciA9IE1hdGguZmxvb3IoKGRhdGUuZ2V0VGltZSgpIC0geWVhclN0YXJ0LmdldFRpbWUoKSkvODY0MDAwMDApICsgMTtcbiAgY29uc3QgcmV2QW5nbGUgPSAwLjIxNjMxMDggKyAyICogTWF0aC5hdGFuKDAuOTY3MTM5NiAqIE1hdGgudGFuKDAuMDA4NjAgKiAoZGF5T2ZZZWFyIC0gMTg2KSkpO1xuICBjb25zdCBkZWNBbmdsZSA9IE1hdGguYXNpbigwLjM5Nzk1ICogTWF0aC5jb3MocmV2QW5nbGUpKTtcbiAgLyogZGF5bGlnaHQgY29lZmZpY2llbnQgc2VsZWN0ZWQgZm9yIGFwcGFyZW50IHN1bnJpc2Uvc3Vuc2V0ICovXG4gIGNvbnN0IHAgPSAwLjgzMzNcbiAgY29uc3QgaW50UmVzdWx0ID1cbiAgICAoTWF0aC5zaW4oKHAgKiBNYXRoLlBJKSAvIDE4MCkgK1xuICAgICAgTWF0aC5zaW4oKGxhdGl0dWRlICogTWF0aC5QSSkgLyAxODApICogTWF0aC5zaW4oZGVjQW5nbGUpKSAvXG4gICAgKE1hdGguY29zKChsYXRpdHVkZSAqIE1hdGguUEkpIC8gMTgwKSAqIE1hdGguY29zKGRlY0FuZ2xlKSk7XG4gIGlmIChpbnRSZXN1bHQgPj0gMSkgcmV0dXJuIDI0O1xuICBpZiAoaW50UmVzdWx0IDw9IC0xKSByZXR1cm4gMDtcbiAgcmV0dXJuIDI0IC0gMjQgKiBNYXRoLmFjb3MoaW50UmVzdWx0KSAvIE1hdGguUEk7XG59XG55ZWFyRGF0ZXMgPSAoeWVhcikgPT4ge1xuICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZSh5ZWFyLCAwLCAxKzYwKTtcbiAgY29uc3QgZW5kRGF0ZSA9IG5ldyBEYXRlKHllYXIgKyAxLCAwLCAxKzYwKTtcbiAgcmV0dXJuIGQzLnRpbWVEYXkucmFuZ2Uoc3RhcnREYXRlLCBlbmREYXRlKTtcbn1cbmhlaWdodCA9IDAuNjUgKiB3aWR0aDtcbkV2ZW50VHlwZSA9ICh7XG4gIExvY2F0aW9uQ2hhbmdlOiBcIkxPQ0FUSU9OX0NIQU5HRVwiLFxuICBEYXRlSG91ckNoYW5nZTogXCJEQVRFX0hPVVJfQ0hBTkdFXCJcbn0pXG5tYXBjb2xvcnMgPSAoe1xuICBuaWdodDogXCIjNzE5ZmI2XCIsXG4gIGRheTogXCIjZmZlNDM4XCIsXG4gIGdyaWQ6IFwiIzRiNmE3OVwiLFxuICBvY2VhbjogXCIjYWRlZWZmXCIsXG4gIGxhbmQ6IFwiIzkwZmY3ODg4XCIsXG4gIHN1bjogXCIjZmZiNDM4XCJcbn0pXG50b1JhZGlhbnMgPSAodmFsKSA9PiB2YWwgKiBNYXRoLlBJIC8gMTgwXG50b0RlZ3JlZXMgPSAodmFsKSA9PiB2YWwgKiAxODAgLyBNYXRoLlBJO1xubGFuZCA9IHRvcG9qc29uLmZlYXR1cmUod29ybGQsIHdvcmxkLm9iamVjdHMubGFuZCk7XG5kMyA9IHJlcXVpcmUoXCJkM0A3XCIsIFwiZDMtZ2VvLXByb2plY3Rpb25AM1wiKVxuZnVuY3Rpb24gaW5wdXQoY29uZmlnKSB7XG4gIGxldCB7XG4gICAgZm9ybSxcbiAgICB0eXBlID0gXCJ0ZXh0XCIsXG4gICAgYXR0cmlidXRlcyA9IHt9LFxuICAgIGFjdGlvbixcbiAgICBnZXRWYWx1ZSxcbiAgICB0aXRsZSxcbiAgICBkZXNjcmlwdGlvbixcbiAgICBmb3JtYXQsXG4gICAgZGlzcGxheSxcbiAgICBzdWJtaXQsXG4gICAgb3B0aW9uc1xuICB9ID0gY29uZmlnO1xuICBjb25zdCB3cmFwcGVyID0gaHRtbGA8ZGl2PjwvZGl2PmA7XG4gIGlmICghZm9ybSlcbiAgICBmb3JtID0gaHRtbGA8Zm9ybT5cbiAgPGlucHV0IG5hbWU9aW5wdXQgdHlwZT0ke3R5cGV9IC8+XG4gIDwvZm9ybT5gO1xuICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgY29uc3QgdmFsID0gYXR0cmlidXRlc1trZXldO1xuICAgIGlmICh2YWwgIT0gbnVsbCkgZm9ybS5pbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWwpO1xuICB9KTtcbiAgaWYgKHN1Ym1pdClcbiAgICBmb3JtLmFwcGVuZChcbiAgICAgIGh0bWxgPGlucHV0IG5hbWU9c3VibWl0IHR5cGU9c3VibWl0IHN0eWxlPVwibWFyZ2luOiAwIDAuNzVlbVwiIHZhbHVlPVwiJHtcbiAgICAgICAgdHlwZW9mIHN1Ym1pdCA9PSBcInN0cmluZ1wiID8gc3VibWl0IDogXCJTdWJtaXRcIlxuICAgICAgfVwiIC8+YFxuICAgICk7XG4gIGZvcm0uYXBwZW5kKFxuICAgIGh0bWxgPG91dHB1dCBuYW1lPW91dHB1dCBzdHlsZT1cImZvbnQ6IDE0cHggTWVubG8sIENvbnNvbGFzLCBtb25vc3BhY2U7IG1hcmdpbi1sZWZ0OiAwLjFlbTsgdGV4dC1hbGlnbjpjZW50ZXI7XCI+PC9vdXRwdXQ+YFxuICApO1xuICBpZiAodGl0bGUpXG4gICAgZm9ybS5wcmVwZW5kKFxuICAgICAgaHRtbGA8ZGl2IHN0eWxlPVwiZm9udDogNzAwIDAuOXJlbSBzYW5zLXNlcmlmOyBtYXJnaW4tYm90dG9tOiAzcHg7XCI+JHt0aXRsZX08L2Rpdj5gXG4gICAgKTtcbiAgaWYgKGRlc2NyaXB0aW9uKVxuICAgIGZvcm0uYXBwZW5kKFxuICAgICAgaHRtbGA8ZGl2IHN0eWxlPVwiZm9udC1zaXplOiAwLjg1cmVtOyBmb250LXN0eWxlOiBpdGFsaWM7IG1hcmdpbi10b3A6IDNweDtcIj4ke2Rlc2NyaXB0aW9ufTwvZGl2PmBcbiAgICApO1xuICBpZiAoZm9ybWF0KVxuICAgIGZvcm1hdCA9IHR5cGVvZiBmb3JtYXQgPT09IFwiZnVuY3Rpb25cIiA/IGZvcm1hdCA6IGQzZm9ybWF0LmZvcm1hdChmb3JtYXQpO1xuICBpZiAoYWN0aW9uKSB7XG4gICAgYWN0aW9uKGZvcm0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHZlcmIgPSBzdWJtaXRcbiAgICAgID8gXCJvbnN1Ym1pdFwiXG4gICAgICA6IHR5cGUgPT0gXCJidXR0b25cIlxuICAgICAgPyBcIm9uY2xpY2tcIlxuICAgICAgOiB0eXBlID09IFwiY2hlY2tib3hcIiB8fCB0eXBlID09IFwicmFkaW9cIlxuICAgICAgPyBcIm9uY2hhbmdlXCJcbiAgICAgIDogXCJvbmlucHV0XCI7XG4gICAgZm9ybVt2ZXJiXSA9IGUgPT4ge1xuICAgICAgZSAmJiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCB2YWx1ZSA9IGdldFZhbHVlID8gZ2V0VmFsdWUoZm9ybS5pbnB1dCkgOiBmb3JtLmlucHV0LnZhbHVlO1xuICAgICAgaWYgKGZvcm0ub3V0cHV0KSB7XG4gICAgICAgIGNvbnN0IG91dCA9IGRpc3BsYXkgPyBkaXNwbGF5KHZhbHVlKSA6IGZvcm1hdCA/IGZvcm1hdCh2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgaWYgKG91dCBpbnN0YW5jZW9mIHdpbmRvdy5FbGVtZW50KSB7XG4gICAgICAgICAgd2hpbGUgKGZvcm0ub3V0cHV0Lmhhc0NoaWxkTm9kZXMoKSkge1xuICAgICAgICAgICAgZm9ybS5vdXRwdXQucmVtb3ZlQ2hpbGQoZm9ybS5vdXRwdXQubGFzdENoaWxkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZm9ybS5vdXRwdXQuYXBwZW5kKG91dCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9ybS5vdXRwdXQudmFsdWUgPSBvdXQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvcm0udmFsdWUgPSB2YWx1ZTtcbiAgICAgIGlmICh2ZXJiICE9PSBcIm9uaW5wdXRcIilcbiAgICAgICAgZm9ybS5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImlucHV0XCIsIHsgYnViYmxlczogdHJ1ZSB9KSk7XG4gICAgfTtcbiAgICBpZiAodmVyYiAhPT0gXCJvbmlucHV0XCIpXG4gICAgICB3cmFwcGVyLm9uaW5wdXQgPSBlID0+IGUgJiYgZS5zdG9wUHJvcGFnYXRpb24oKSAmJiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKHZlcmIgIT09IFwib25zdWJtaXRcIikgZm9ybS5vbnN1Ym1pdCA9IGUgPT4gZSAmJiBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZm9ybVt2ZXJiXSgpO1xuICB9XG4gIHdoaWxlIChmb3JtLmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChmb3JtLmNoaWxkTm9kZXNbMF0pO1xuICB9XG4gIGZvcm0uYXBwZW5kKHdyYXBwZXIpO1xuICByZXR1cm4gZm9ybTtcbn1cbmQzZm9ybWF0ID0gcmVxdWlyZShcImQzLWZvcm1hdEAxXCIpXG4vLyBodHRwczovL29ic2VydmFibGVocS5jb20vQGVuamFsb3QvZHJhZ2dhYmxlLXdvcmxkLW1hcC1jb29yZGluYXRlcy1pbnB1dFxuZnVuY3Rpb24gd29ybGRNYXBDb29yZGluYXRlcyhjb25maWcgPSB7fSwgZGltZW5zaW9ucykge1xuICBjb25zdCB7XG4gICAgdmFsdWUgPSBbXSwgdGl0bGUsIGRlc2NyaXB0aW9uLCB3aWR0aCA9IGRpbWVuc2lvbnNbMF1cbiAgfSA9IEFycmF5LmlzQXJyYXkoY29uZmlnKSA/IHt2YWx1ZTogY29uZmlnfSA6IGNvbmZpZztcbiAgY29uc3QgaGVpZ2h0ID0gZGltZW5zaW9uc1sxXTtcbiAgbGV0IFtsb24sIGxhdF0gPSB2YWx1ZTtcbiAgbG9uID0gbG9uICE9IG51bGwgPyBsb24gOiBudWxsO1xuICBsYXQgPSBsYXQgIT0gbnVsbCA/IGxhdCA6IG51bGw7XG4gIGNvbnN0IGZvcm1FbCA9IGh0bWxgPGZvcm0gaWQ9XCJmb3JtRWxcIiBzdHlsZT1cIndpZHRoOiAke3dpZHRofXB4O1wiPjwvZm9ybT5gO1xuICBjb25zdCBjb250ZXh0ID0gRE9NLmNvbnRleHQyZCh3aWR0aCwgaGVpZ2h0LXdpZHRoLzE0KTtcbiAgY29uc3QgY2FudmFzID0gY29udGV4dC5jYW52YXM7XG4gIGNhbnZhcy5zdHlsZS5tYXJnaW4gPSBgMHB4IDBweCAtMjZweCAwcHhgO1xuICBjb25zdCBwcm9qZWN0aW9uID0gZDNcbiAgICAuZ2VvRXF1aXJlY3Rhbmd1bGFyKClcbiAgICAucHJlY2lzaW9uKDAuMSlcbiAgICAuZml0U2l6ZShbd2lkdGgsIGhlaWdodF0sIHsgdHlwZTogXCJTcGhlcmVcIiB9KS5yb3RhdGUoWy0xNTMsIDBdKTtcbiAgY29uc3QgcGF0aCA9IGQzLmdlb1BhdGgocHJvamVjdGlvbiwgY29udGV4dCkucG9pbnRSYWRpdXMoMi41KTtcbiAgZm9ybUVsLmFwcGVuZChjYW52YXMpO1xuICBmdW5jdGlvbiBkcmF3KCkge1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gd2luZG93LmRhcmttb2RlID8gXCJibGFja1wiIDogXCJ3aGl0ZVwiO1xuICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgY29udGV4dC5iZWdpblBhdGgoKTsgcGF0aCh7dHlwZTogXCJTcGhlcmVcIn0pO1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gd2luZG93LmRhcmttb2RlID8gXCIjMDA3RkZGXCIgOiBtYXBjb2xvcnMub2NlYW47XG4gICAgY29udGV4dC5maWxsKCk7XG4gICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICBwYXRoKGdyYXRpY3VsZSk7XG4gICAgY29udGV4dC5saW5lV2lkdGggPSAwLjk1O1xuICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBgI2FhYWA7XG4gICAgY29udGV4dC5zdHJva2UoKTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIHBhdGgobGFuZCk7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSB3aW5kb3cuZGFya21vZGUgPyBcIiMwODA4XCIgOiBtYXBjb2xvcnMubGFuZDtcbiAgICBjb250ZXh0LmZpbGwoKTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIHBhdGgoY291bnRyaWVzKTtcbiAgICBjb250ZXh0LmxpbmVXaWR0aCA9IC45NTtcbiAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gd2luZG93LmRhcmttb2RlID8gXCIjYWFhXCIgOiBcIiMzMzNcIjtcbiAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gd2luZG93LmRhcmttb2RlID8gXCIjZmZmXCIgOiBcIiMwMDBcIjtcbiAgICBjb250ZXh0LmZvbnQgPSB3aWR0aCA8IDc2MCA/IFwiMTRweCBzZXJpZlwiIDogd2lkdGggPCA5OTAgPyBcIjE3cHggc2VyaWZcIiA6IFwiMjNweCBzZXJpZlwiO1xuICAgIGQzLnJhbmdlKC0xLjUsIDM0MiArIDEsIDM2KS5tYXAoeCA9PiAgY29udGV4dC5maWxsVGV4dChsb25nMnpvbmUoeCksIC4uLnByb2plY3Rpb24oW3gsIDgyIC0gKHdpZHRoIDwgNTAwKSAqIDguOF0pKSk7XG4gICAgZDMucmFuZ2UoLTEuNSwgMzQyICsgMSwgMzYpLm1hcCh4ID0+ICBjb250ZXh0LmZpbGxUZXh0KGxvbmcyem9uZSh4KSwgLi4ucHJvamVjdGlvbihbeCwgLTY2ICsgKHdpZHRoIDwgNTAwKSAqIDEuMV0pKSk7XG4gICAgY29udGV4dC5iZWdpblBhdGgoKSwgcGF0aChuaWdodCksIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKDAsMCwyNTUsMC4xKVwiLCBjb250ZXh0LmZpbGwoKTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpOyBwYXRoLnBvaW50UmFkaXVzKDE3KTsgcGF0aCh7dHlwZTogXCJQb2ludFwiLCBjb29yZGluYXRlczogc3VufSk7IGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiMwMDA4XCI7IGNvbnRleHQuZmlsbFN0eWxlID0gXCIjZmYwOFwiOyBjb250ZXh0LmxpbmVXaWR0aCA9IDE7IGNvbnRleHQuc3Ryb2tlKCk7IGNvbnRleHQuZmlsbCgpO1xuICAgIGlmIChsb24gIT0gbnVsbCAmJiBsYXQgIT0gbnVsbCkge1xuICAgICAgcGF0aC5wb2ludFJhZGl1cygxNyk7IGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcImJsYWNrXCI7XG4gICAgICBjb250ZXh0LmJlZ2luUGF0aCgpOyBwYXRoKHt0eXBlOiBcIlBvaW50XCIsIGNvb3JkaW5hdGVzOiBbbG9uLCBsYXRdfSk7IGNvbnRleHQubGluZVdpZHRoID0gMTsgY29udGV4dC5zdHJva2UoKTtcbiAgICAgIGNvbnRleHQubGluZVdpZHRoID0gNjtcbiAgICAgIHBhdGgucG9pbnRSYWRpdXMoMTQpOyBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCJyZWRcIjtcbiAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7IHBhdGgoe3R5cGU6IFwiUG9pbnRcIiwgY29vcmRpbmF0ZXM6IFtsb24sIGxhdF19KTsgY29udGV4dC5zdHJva2UoKTtcbiAgICB9XG4gIH1cbiAgbGV0IGRyYWcgPSBkMy5kcmFnKClcbiAgICAub24oXCJkcmFnXCIsIChldmVudCkgPT4ge1xuICAgICAgbGV0IGNvb3JkcyA9IHByb2plY3Rpb24uaW52ZXJ0KFtldmVudC54LCBldmVudC55XSk7XG4gICAgICBsb24gPSArY29vcmRzWzBdLnRvRml4ZWQoMik7XG4gICAgICBsYXQgPSArY29vcmRzWzFdLnRvRml4ZWQoMik7XG4gICAgICBkcmF3KCk7XG4gICAgICBjYW52YXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJpbnB1dFwiLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAgIH0pXG4gIGQzLnNlbGVjdChjYW52YXMpLmNhbGwoZHJhZylcbiAgY2FudmFzLm9uY2xpY2sgPSBmdW5jdGlvbihldikge1xuICAgIGNvbnN0IHsgb2Zmc2V0WCwgb2Zmc2V0WSB9ID0gZXY7XG4gICAgbGV0IGNvb3JkcyA9IHByb2plY3Rpb24uaW52ZXJ0KFtvZmZzZXRYLCBvZmZzZXRZXSk7XG4gICAgbG9uID0gK2Nvb3Jkc1swXS50b0ZpeGVkKDIpO1xuICAgIGxhdCA9ICtjb29yZHNbMV0udG9GaXhlZCgyKTtcbiAgICBkcmF3KCk7XG4gICAgY2FudmFzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIiwgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgfTtcbiAgZHJhdygpO1xuICBjb25zdCBmb3JtID0gaW5wdXQoe1xuICAgIHR5cGU6IFwid29ybGRNYXBDb29yZGluYXRlc1wiLFxuICAgIHRpdGxlLFxuICAgIGRlc2NyaXB0aW9uLFxuICAgIGRpc3BsYXk6IHYgPT4gKHdpZHRoID4gMzAwKSA/IGh0bWxgPGRpdiBzdHlsZT1cIndpZHRoOiAke3dpZHRofXB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBjb2xvcjogd2luZG93LmRhcmttb2RlID8gI2ZmZiA6ICMwMDA7IHRleHQtYWxpZ246IGNlbnRlcjsgZm9udDogJHt3aWR0aCAvIDQwfXB4IG1vbm9zcGFjZTsgcG9zaXRpb246IHJlbGF0aXZlOyB0b3A6ICR7LTE2IC0gd2lkdGggLyA1MH1weDsgIG1hcmdpbi1ib3R0b206IC0uNGVtO1wiPlxuICAgICAgICAgICAgPHNwYW4gc3R5bGU9XCJjb2xvcjogd2luZG93LmRhcmttb2RlID8gI2ZmZiA6ICMwMDA7XCI+Wm9uZTo8L3NwYW4+ICR7bG9uICE9IG51bGwgPyBsb25nMnpvbmUobG9uKSA6IFwiXCJ9XG4gICAgICAgICAgICAmbmJzcDsgJm5ic3A7XG4gICAgICAgICAgICA8c3BhbiBzdHlsZT1cImNvbG9yOiB3aW5kb3cuZGFya21vZGUgPyAjZmZmIDogIzAwMDtcIj5Mb25naXR1ZGU6PC9zcGFuPiAke2xvbiAhPSBudWxsID8gKGxvbmcydHVybihsb24pKS50b0ZpeGVkKDApIDogXCJcIn1cbiAgICAgICAgICAgICZuYnNwOyAmbmJzcDtcbiAgICAgICAgICAgIDxzcGFuIHN0eWxlPVwiY29sb3I6IHdpbmRvdy5kYXJrbW9kZSA/ICNmZmYgOiAjMDAwO1wiPkxhdGl0dWRlOjwvc3Bhbj4gJHtsYXQgIT0gbnVsbCA/IChsYXRpMnR1cm4obGF0KSkudG9GaXhlZCgwKSA6IFwiXCJ9XG4gICAgICAgICAgPC9kaXY+YCA6ICcnLFxuICAgIGdldFZhbHVlOiAoKSA9PiBbbG9uICE9IG51bGwgPyBsb24gOiBudWxsLCBsYXQgIT0gbnVsbCA/IGxhdCA6IG51bGxdLFxuICAgIGZvcm06IGZvcm1FbFxuICB9KTtcbiAgcmV0dXJuIGZvcm07XG59XG53aW5kb3cuZGFya21vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImJvZHlcIilbMF0uY2xhc3NOYW1lLm1hdGNoKC9xdWFydG8tZGFyay8pID8gdHJ1ZSA6IGZhbHNlO1xuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInF1YXJ0by1jb2xvci1zY2hlbWUtdG9nZ2xlXCIpWzBdLm9uY2xpY2sgPSBmdW5jdGlvbiAoZSkge1xuICB3aW5kb3cucXVhcnRvVG9nZ2xlQ29sb3JTY2hlbWUoKTtcbiAgd2luZG93LmRhcmttb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJib2R5XCIpWzBdLmNsYXNzTmFtZS5tYXRjaCgvcXVhcnRvLWRhcmsvKSA/IHRydWUgOiBmYWxzZTtcbiAgd29ybGRNYXBDb29yZGluYXRlcy5kcmF3KCk7XG4gIGFwcC5kcmF3RWFydGgoKTtcbiAgcmV0dXJuIGZhbHNlO1xufTtcbnN1biA9IHtcbiAgY29uc3Qgbm93ID0gbmV3IERhdGU7XG4gIGNvbnN0IGRheSA9IG5ldyBEYXRlKCtub3cpLnNldFVUQ0hvdXJzKDAsIDAsIDAsIDApO1xuICBjb25zdCB0ID0gc29sYXIuY2VudHVyeShub3cpO1xuICBjb25zdCBsb25naXR1ZGUgPSAoZGF5IC0gbm93KSAvIDg2NGU1ICogMzYwIC0gMTgwO1xuICByZXR1cm4gW2xvbmdpdHVkZSAtIHNvbGFyLmVxdWF0aW9uT2ZUaW1lKHQpIC8gNCwgc29sYXIuZGVjbGluYXRpb24odCldO1xufVxubmlnaHQgPSBkMy5nZW9DaXJjbGUoKVxuICAgIC5yYWRpdXMoOTApXG4gICAgLmNlbnRlcihhbnRpcG9kZShzdW4pKVxuICAoKVxuYW50aXBvZGUgPSAoW2xvbmdpdHVkZSwgbGF0aXR1ZGVdKSA9PiBbbG9uZ2l0dWRlICsgMTgwLCAtbGF0aXR1ZGVdXG5zb2xhciA9IHJlcXVpcmUoXCJzb2xhci1jYWxjdWxhdG9yQDAuMy9kaXN0L3NvbGFyLWNhbGN1bGF0b3IubWluLmpzXCIpXG52aWV3b2YgZmFuY3lTZWNvbmRzT0ZGID0gSW5wdXRzLnRvZ2dsZSh7XG4gIGxhYmVsOiBcIlRpY2tpbmcgY2xvY2tcIixcbiAgdmFsdWU6IHRydWUsXG59KVxuZnVuY3Rpb24gc2V0U3R5bGUoY29udGVudCwgc3R5bGUgPSB7fSkge1xuICBmdW5jdGlvbiB5aXEoY29sb3IpIHtcbiAgICBjb25zdCB7ciwgZywgYn0gPSBkMy5yZ2IoY29sb3IpO1xuICAgIHJldHVybiAociAqIDI5OSArIGcgKiA1ODcgKyBiICogMTE0KSAvIDEwMDAgLyAyNTU7IC8vIHJldHVybnMgdmFsdWVzIGJldHdlZW4gMCBhbmQgMVxuICB9XG4gIGNvbnN0IHtcbiAgICBiYWNrZ3JvdW5kLFxuICAgIGNvbG9yID0geWlxKGJhY2tncm91bmQpID49IDAuNiA/IFwiIzExMVwiIDogXCJ3aGl0ZVwiLFxuICAgIHBhZGRpbmcgPSBcIjAgMXB4XCIsXG4gICAgYm9yZGVyUmFkaXVzID0gXCI0cHhcIixcbiAgICBmb250V2VpZ2h0ID0gOTAwLFxuICAgIGZvbnRTaXplID0gXCIxZW1cIixcbiAgICAuLi5yZXN0XG4gIH0gPSB0eXBlb2Ygc3R5bGUgPT09IFwic3RyaW5nXCIgPyB7YmFja2dyb3VuZDogc3R5bGV9IDogc3R5bGU7XG4gIHJldHVybiBodGwuaHRtbGA8c3BhbiBzdHlsZT0ke3tcbiAgICBiYWNrZ3JvdW5kLFxuICAgIGNvbG9yLFxuICAgIHBhZGRpbmcsXG4gICAgYm9yZGVyUmFkaXVzLFxuICAgIGZvbnRXZWlnaHQsXG4gICAgLi4ucmVzdFxuICB9fT4ke2NvbnRlbnR9PC9zcGFuPmA7XG59XG5mdW5jdGlvbiB5aXEoY29sb3IpIHtcbiAgY29uc3Qge3IsIGcsIGJ9ID0gZDMucmdiKGNvbG9yKTtcbiAgcmV0dXJuIChyICogMjk5ICsgZyAqIDU4NyArIGIgKiAxMTQpIC8gMTAwMCAvIDI1NTsgLy8gcmV0dXJucyB2YWx1ZXMgYmV0d2VlbiAwIGFuZCAxXG59XG5mdW5jdGlvbiB0ZXh0Y29sb3IoY29udGVudCwgc3R5bGUgPSB7fSkge1xuICBjb25zdCB7XG4gICAgYmFja2dyb3VuZCxcbiAgICBjb2xvciA9IHlpcShiYWNrZ3JvdW5kKSA+IDAuNTEgPyBcIiMwMDBcIiA6IFwid2hpdGVcIixcbiAgICBwYWRkaW5nID0gXCIwIDVweFwiLFxuICAgIGJvcmRlclJhZGl1cyA9IFwiNHB4XCIsXG4gICAgZm9udFdlaWdodCA9IDQwMCxcbiAgICBmb250RmFtaWx5ID0gXCJtb25vc3BhY2VcIixcbiAgICAuLi5yZXN0XG4gIH0gPSB0eXBlb2Ygc3R5bGUgPT09IFwic3RyaW5nXCIgPyB7YmFja2dyb3VuZDogc3R5bGV9IDogc3R5bGU7XG4gIHJldHVybiBodGwuaHRtbGA8c3BhbiBzdHlsZT0ke3tcbiAgICBiYWNrZ3JvdW5kLFxuICAgIGNvbG9yLFxuICAgIHBhZGRpbmcsXG4gICAgYm9yZGVyUmFkaXVzLFxuICAgIGZvbnRXZWlnaHQsXG4gICAgZm9udEZhbWlseSxcbiAgICAuLi5yZXN0XG4gIH19PiR7Y29udGVudH08L3NwYW4+YDtcbn1cbmVsYXBzZWQgPSB7XG4gIGxldCBpID0gMDtcbiAgd2hpbGUgKHRydWUpIHtcbiAgICB5aWVsZCBQcm9taXNlcy50aWNrKDg2NCwgKytpKTtcbiAgfVxufVxucGllY2V3aXNlQ29sb3IgPSBkMy5waWVjZXdpc2UoZDMuaW50ZXJwb2xhdGVSZ2IsIFtcbiAgXCIjZjAwXCIsICAgIC8vICAwICAgMCByZWRcbiAgXCIjZjUwXCIsICAgIC8vICAwLjI1ICAyMCB5clxuICBcIiNmNjBcIiwgICAgLy8gIDAuNSAgIDI0IHlyIG9yYW5nZXJlZFxuICBcIiNmNzBcIiwgICAgLy8gIDAuNzUgIDI4IHlyXG4gIFwiI2Y5MFwiLCAgICAvLyAgMSAgICAgMzYgeXIgb3JhbmdlXG4gIFwiI2ZiMFwiLCAgICAvLyAgMS4yNSAgNDQgeXJcbiAgXCIjZmMwXCIsICAgIC8vICAxLjUgICA0OCB5ciB5ZWxsb3dvcmFuZ2VcbiAgXCIjZmQwXCIsICAgIC8vICAxLjc1ICA1MiB5clxuICBcIiNmZjBcIiwgICAgLy8gIDIgICAgIDYwIHllbGxvd1xuICBcIiNlZjBcIiwgICAgLy8gIDIuMjUgIDY0IGd5XG4gIFwiI2RmMFwiLCAgICAvLyAgMi41ICAgNjggZ3kgbGltZXllbGxvd1xuICBcIiNjZjBcIiwgICAgLy8gIDIuNzUgIDcyIGd5XG4gIFwiI2FmMFwiLCAgICAvLyAgMyAgICAgODAgZ3kgbGltZVxuICBcIiM4ZjBcIiwgICAgLy8gIDMuMjUgIDg4IGd5XG4gIFwiIzdmMFwiLCAgICAvLyAgMy41ICAgOTIgZ3kgZ3JlZW5saW1lXG4gIFwiIzZmMFwiLCAgICAvLyAgMy43NSAgOTYgZ3lcbiAgXCIjMGYwXCIsICAgIC8vICA0ICAgIDEyMCBncmVlblxuICBcIiMwZjdcIiwgICAgLy8gIDQuMjUgMTQ4IGNnXG4gIFwiIzBmOVwiLCAgICAvLyAgNC41ICAxNTYgY2cgY3lhbmdyZWVuXG4gIFwiIzBmYlwiLCAgICAvLyAgNC43NSAxNjQgY2dcbiAgXCIjMGZmXCIsICAgIC8vICA1ICAgIDE4MCBjeWFuXG4gIFwiIzBjZlwiLCAgICAvLyAgNS4yNSAxOTIgYmNcbiAgXCIjMGJmXCIsICAgIC8vICA1LjUgIDE5NiBiYyBhenVyZWN5YW5cbiAgXCIjMGFmXCIsICAgIC8vICA1Ljc1IDIwMCBiY1xuICBcIiMwOGZcIiwgICAgLy8gIDYgICAgMjA4IGJjIGF6dXJlXG4gIFwiIzA2ZlwiLCAgICAvLyAgNi4yNSAyMTYgYmNcbiAgXCIjMDVmXCIsICAgIC8vICA2LjUgIDIyMCBiYyBibHVlYXp1cmVcbiAgXCIjMDRmXCIsICAgIC8vICA2Ljc1IDIyNCBiY1xuICBcIiMwMGZcIiwgICAgLy8gIDcgICAgMjQwIGJsdWVcbiAgXCIjNTBmXCIsICAgIC8vICA3LjI1IDI2MCBtYlxuICBcIiM2MGZcIiwgICAgLy8gIDcuNSAgMjY0IG1iIHB1cnBsZWJsdWVcbiAgXCIjNzBmXCIsICAgIC8vICA3Ljc1IDI2OCBtYlxuICBcIiM5MGZcIiwgICAgLy8gIDggICAgMjc2IG1iIHB1cnBsZVxuICBcIiNiMGZcIiwgICAgLy8gIDguMjUgMjg0IG1iXG4gIFwiI2MwZlwiLCAgICAvLyAgOC41ICAyODggbWIgdmlvbGV0cHVycGxlXG4gIFwiI2QwZlwiLCAgICAvLyAgOC43NSAyOTIgbWJcbiAgXCIjZjBmXCIsICAgIC8vICA5ICAgIDMwMCBtYWdlbnRhXG4gIFwiI2YwYVwiLCAgICAvLyAgOS4yNSAzMjAgcm1cbiAgXCIjZjA4XCIsICAgIC8vICA5LjUgIDMyOCBybVxuICBcIiNmMDZcIiwgICAgLy8gIDkuNzUgMzM2IHJtXG4gIFwiI2YwMFwiLCAgICAvLyAgMCAgICAgICAgMCByZWRcbl0pXG5zbFN0ciA9IGAsIDEwMCUsIDUwJSlgXG5lbGFUaW1lID0gZWxhcHNlZCAlIDFlNVxuZWxhVGltZUhzbCA9IHRleHRjb2xvcihlbGFUaW1lLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKGVsYVRpbWUgJSAxMDAwIC8gMTAwMCkpLmh9YCArIHNsU3RyKVxuZGVjTW90eSA9IE1hdGguZmxvb3IoKDUgKiBkZWNEYXRlICsgMikgLyAxNTMpXG5pc29ZZWFyID0gZGVjWWVhciArIChkZWNNb3R5ID4gOSlcbm1vbnRoID0gZGVjTW90eSA8IDEwID8gZGVjTW90eSArIDMgOiBkZWNNb3R5IC0gOVxuZGVjSG91ciA9IGRlY1RpbWUgKiAyNFxuZGVjTWludXRlID0gKGRlY0hvdXIgJSAxKSAqIDYwXG5kZWNTZWNvbmQgPSAoZGVjTWludXRlICUgMSkgKiA2MFxuaXNvSG91ciA9IE1hdGguZmxvb3IoZGVjSG91cilcbmlzb01pbnV0ZSA9IE1hdGguZmxvb3IoZGVjTWludXRlKVxuaXNvU2Vjb25kID0gTWF0aC5mbG9vcihkZWNTZWNvbmQpXG5kZWNEZWsgPSBNYXRoLmZsb29yKGRlY0RhdGUgLyAxMClcbmRlY0RvZCA9IGRlY0RhdGUgJSAxMFxuZGVjRG90bSA9IE1hdGguZmxvb3IoZGVjRGF0ZSAtICgxNTMgKiBkZWNNb3R5ICsgMikgLyA1ICsgMSlcbnNlbERvdGUgPSB1bml4MmRvdGUoc2VsZWN0ZWREYXRlLmdldFRpbWUoKSAtIDg2NDAwMDAwLCAwKVxuc2VsRGF0ZSA9IE1hdGguZmxvb3IoZG90ZTJkYXRlKC4uLnNlbERvdGUpWzFdKVxuc2VsVGltZSA9IHNlbGVjdGVkSG91ciAvIDI0XG5zZWxUaW1lT25lID0gc2VsVGltZSAlIDFcbnNlbFRpbWVUZW4gPSBzZWxUaW1lICogMTAgJSAxMFxuc2VsU25hcCA9IHNlbERhdGUgKyBzZWxUaW1lXG5zZWxMYXRpID0gbGF0aTJ0dXJuKGxvY2F0aW9uWzFdKVxuZGVjRGF0ZUhzbCA9IHRleHRjb2xvcihkZWNEYXRlLnRvU3RyaW5nKCkucGFkU3RhcnQoMywgXCIwXCIpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihkZWNEYXRlIC8gKDM2NSArIGlzTGVhcFllYXIpKSkuZm9ybWF0SGV4KCkpXG5kZWNUaW1lSHNsID0gdGV4dGNvbG9yKGRlY1RpbWUsIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKGRlY1RpbWUgLyAxMCkpLmZvcm1hdEhleCgpKVxuc2VsRGF0ZUhzbCA9IHRleHRjb2xvcihzZWxEYXRlLnRvU3RyaW5nKCkucGFkU3RhcnQoMywgXCIwXCIpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihzZWxEYXRlIC8gMzY1KSkuZm9ybWF0SGV4KCkpXG5zZWxMYXRpSHNsID0gdGV4dGNvbG9yKHNlbExhdGkudG9GaXhlZCgwKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoKHNlbExhdGkgKyAyNTApICUgMjUwIC8gMjUwKSkuZm9ybWF0SGV4KCkpXG5zZWxUaW1lRGF5ID0gdGV4dGNvbG9yKHNlbFRpbWVPbmUudG9GaXhlZCg1KS5zbGljZSgxKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3Ioc2VsVGltZSkpLmZvcm1hdEhleCgpKVxuc2VsVGltZUhzbDAgPSB0ZXh0Y29sb3Ioc2VsVGltZVRlbi50b0ZpeGVkKDQpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihzZWxUaW1lKSkuZm9ybWF0SGV4KCkpXG5zZWxUaW1lSHNsMSA9IHRleHRjb2xvcihzZWxUaW1lVGVuLnRvRml4ZWQoNCksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHNlbFRpbWUpKS5mb3JtYXRIZXgoKSlcbnNlbFpvbmVIc2wgPSB0ZXh0Y29sb3Ioc2VsZWN0ZWRab25lLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihzZWxlY3RlZFpvbmUgLyAxMCkpLmZvcm1hdEhleCgpKVxuc2VsU25hcERheSA9IHRleHRjb2xvcihzZWxTbmFwLnRvRml4ZWQoNSkucGFkU3RhcnQoOSwgXCIwXCIpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihzZWxTbmFwIC8gMzY1KSkuZm9ybWF0SGV4KCkpXG5zZWxTbmFwRGVjID0gdGV4dGNvbG9yKChzZWxTbmFwICogMTApLnRvRml4ZWQoNCkucGFkU3RhcnQoOSwgXCIwXCIpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihzZWxTbmFwIC8gMzY1KSkuZm9ybWF0SGV4KCkpXG5kZWNab25lSHNsID0gdGV4dGNvbG9yKHNlbGVjdGVkWm9uZSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3Ioc2VsZWN0ZWRab25lIC8gMTApKS5mb3JtYXRIZXgoKSlcbmlzTGVhcFllYXIgPSBkZWNZZWFyICUgNCA9PSAwICYmIGRlY1llYXIgJSAxMDAgIT0gMCB8fCBkZWNZZWFyICUgNDAwID09IDA7XG52aWV3b2Ygc2VsZWN0ZWREYXRlID0gSW5wdXRzLmlucHV0KGRhdGUyMDIyKVxudmlld29mIHNlbGVjdGVkSG91ciA9IElucHV0cy5pbnB1dChkYXRlMjAyMi5nZXRIb3VycygpKVxuZGF0ZTIwMjIgPSBuZXcgRGF0ZSgyMDIyLCBuZXcgRGF0ZSgpLmdldE1vbnRoKCksIG5ldyBEYXRlKCkuZ2V0RGF0ZSgpLCBuZXcgRGF0ZSgpLmdldEhvdXJzKCkpXG5mdW5jdGlvbiBzZXQoaW5wdXQsIHZhbHVlKSB7XG4gIGlucHV0LnZhbHVlID0gdmFsdWU7XG4gIGlucHV0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiaW5wdXRcIiwge2J1YmJsZXM6IHRydWV9KSk7XG59XG5oRDEyMSA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigxMjEgLyAzNjUpKS5oXG5oRDI2OCA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigyNjggLyAzNjUpKS5oXG5oRDMwNSA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigzMDUgLyAzNjUpKS5oXG5oRDMwNiA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigzMDYgLyAzNjUpKS5oXG5oMWJ5MzIwID0gZDMuaHNsKHBpZWNld2lzZUNvbG9yKDEgLyAzMjApKS5oXG5odWVzID0gT2JqZWN0LmZyb21FbnRyaWVzKFtcbiAgLjAwODMsXG4gIC4wMTY2LFxuICAuMDIyOSxcbiAgLjAyNSxcbiAgLjI4NyxcbiAgLjAzMzMsXG4gIC4wNDE2LFxuICAuMDUsXG4gIC4xMjUsXG4gIC4zMzMsXG4gIC4zNzUsXG4gIC40MjksXG4gIC41MzMsXG4gIC45NjksXG4gIC45OTksXG4gIF0ubWFwKGkgPT4gW2ksIGQzLmhzbChwaWVjZXdpc2VDb2xvcihpKSkuaF0pXG4pO1xuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BtYXR0ZHp1Z2FuL3BvcHVsYXRpb24tYnktdGltZS16b25lLWNyZWF0aW5nLWEtZGF0YXNldFxucG9wdWxhdGlvbkJ5VGltZVpvbmUgPSBGaWxlQXR0YWNobWVudChcIi4uLy4uL2Fzc2V0L3BvcHVsYXRpb25CeVRpbWVab25lLmpzb25cIikuanNvbigpO1xuc29ydGVkUG9wID0gcG9wdWxhdGlvbkJ5VGltZVpvbmUuc29ydChcbiAgKGEsIGIpID0+IHNvcnRQYXJhbXNbMV0gPyBzb3J0RnVuYyhhLm51bWJlciwgYi5udW1iZXIpIDogc29ydEZ1bmMoYS5wb3AsIGIucG9wKVxuKVxuc29ydEZ1bmMgPSBzb3J0UGFyYW1zWzBdID8gZDMuYXNjZW5kaW5nIDogZDMuZGVzY2VuZGluZ1xucG9wQnlTaWduID0gZDMucm9sbHVwKHNvcnRlZFBvcCwgdiA9PiBkMy5zdW0odiwgZCA9PiBkLnBvcCAvIDFlOSksIGQgPT4gZC5TaWduKVxudG90YWxQb3AgPSBkMy5zdW0oc29ydGVkUG9wLCBkID0+IGQucG9wIC8gMWU5KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGBcbjxzdHlsZT5cbi5jb2xvck5pZ2h0IHtcbiAgYmFja2dyb3VuZDogIzQxNmY4NjtcbiAgY29sb3I6IHdoaXRlO1xuICBwYWRkaW5nOiAwcHggMnB4IDBweCA0cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvckRheSB7XG4gIGJhY2tncm91bmQ6ICNmZmU0Mzg7XG4gIGNvbG9yOiBibGFjaztcbiAgcGFkZGluZzogMHB4IDNweCAwcHggNHB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3JCa2cge1xuICBiYWNrZ3JvdW5kOiAke3dpbmRvdy5kYXJrbW9kZSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIGNvbG9yOiAke3dpbmRvdy5kYXJrbW9kZSA/IFwid2hpdGVcIiA6IFwiYmxhY2tcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjAge1xuICBiYWNrZ3JvdW5kOiBoc2woMCAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKDAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IxIHtcbiAgYmFja2dyb3VuZDogaHNsKDMwMCAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKDMwMCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjIge1xuICBiYWNrZ3JvdW5kOiBoc2woMjgwIDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woMjgwLCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMyB7XG4gIGJhY2tncm91bmQ6IGhzbCgyNDAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgyNDAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I0IHtcbiAgYmFja2dyb3VuZDogaHNsKDIwMCAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKDIwMCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjUge1xuICBiYWNrZ3JvdW5kOiBoc2woMTgwIDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woMTgwLCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yNiB7XG4gIGJhY2tncm91bmQ6IGhzbCgxMjAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgxMjAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I3IHtcbiAgYmFja2dyb3VuZDogaHNsKDgwIDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woODAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I4IHtcbiAgYmFja2dyb3VuZDogaHNsKDYwIDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woNjAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I5IHtcbiAgYmFja2dyb3VuZDogaHNsKDQwIDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woNDAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IzNzUge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuMzc1XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4zNzVdfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjAwODMge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuMDA4M119IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtodWVzWzAuMDA4M119LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMDE2NiB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC4wMTY2XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4wMTY2XX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I1NWJ5MjQge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWy4wMjI5XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbLjAyMjldfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjEyNSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbLjEyNV19IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtodWVzWy4xMjVdfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjAyNSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC4wMjVdfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjAyNV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMjg3IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1swLjI4N119IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtodWVzWzAuMjg3XX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IzMzMge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuMzMzXX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4zMzNdfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjAzMzMge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuMDMzM119IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtodWVzWzAuMDMzM119LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMDQxNiB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC4wNDE2XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4wNDE2XX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I0Mjkge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuNDI5XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC40MjldfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjA1IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1swLjA1XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4wNV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yNTMzIHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1swLjUzM119IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtodWVzWzAuNTMzXX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I5Njkge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuOTY5XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC45NjldfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjk5OSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC45OTldfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjk5OV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMWJ5MzIwIHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aDFieTMyMH0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2gxYnkzMjB9LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yRDEyMSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2hEMTIxfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aEQxMjF9LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yRDI2OCB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2hEMjY4fSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aEQyNjh9LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yRDMwNSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2hEMzA1fSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aEQzMDV9LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yRDMwNiB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2hEMzA2fSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aEQzMDZ9LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuPC9zdHlsZT5cbmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbG9jYXRpb24nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc29ydFBhcmFtcycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmYW5jeVNlY29uZHNPRkYnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2VsZWN0ZWREYXRlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdGVkSG91cicpIn1dfQ==
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../dec/time";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/maptv\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../../dec/date/index.html" class="pagination-link" aria-label="Date">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Date</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../dec/snap/index.html" class="pagination-link" aria-label="Snap">
        <span class="nav-page-text">Snap</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb34" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Dec Time</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Martin Laptev</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://maptv.github.io</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> /asset/daywide.svg</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> &gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> true</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">  url: https://maptv.github.io/dec/time</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="an">aliases:</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - /dec/time</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - /d/t</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - /time</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - /t</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="an">license:</span><span class="co"> CC BY-SA</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> false</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 5</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="an">bread-crumbs:</span><span class="co"> false</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="co">    grid:</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="co">      body-width: 850px</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="co">    shift-heading-level-by: 3</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co">    include-after-body:</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/cite.html</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/style.html</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/stamp.html</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/tooltip.html</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="co">  commonmark: default</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="co">  - ../../asset/date.lua</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>::: {#timenav}</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>{{&lt; include /asset/_decnav.qmd &gt;}}</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>My website provides many examples of the <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://quarto.org)</span> publishing and the <span class="co">[</span><span class="ot">Dec</span><span class="co">](/dec)</span> measurement systems in action. I leverage Quarto support for the <span class="co">[</span><span class="ot">Observable</span><span class="co">](https://observablehq.com/)</span> data analysis and visualization system to create animated and interactive graphics like the <span class="co">[</span><span class="ot">analog clocks</span><span class="co">](https://en.wikipedia.org/wiki/Clock#:~:text=indicate%20time%20with%20a%20traditional%20clock%20face%20and%20moving%20hands)</span>üïì, <span class="co">[</span><span class="ot">barüìächarts</span><span class="co">](https://en.wikipedia.org/wiki/Bar_chart)</span>, <span class="co">[</span><span class="ot">solar‚òÄÔ∏èterminator</span><span class="co">](https://en.wikipedia.org/wiki/Terminator_%28solar%29#:~:text=a%20moving%20line%20that%20divides%20the%20daylit%20side%20and%20the%20dark%20night%20side%20of%20a%20planetary%20body)</span> map, <span class="co">[</span><span class="ot">Earthüåçorbit</span><span class="co">](https://en.wikipedia.org/wiki/Earth%27s_orbit)</span> diagram, and <span class="co">[</span><span class="ot">daylight</span><span class="co">](https://en.wikipedia.org/wiki/Daylight#:~:text=the%20combination%20of%20all%20direct%20and%20indirect%20sunlight%20during%20the%20daytime)</span> <span class="co">[</span><span class="ot">area chart</span><span class="co">](https://en.wikipedia.org/wiki/Area_chart)</span> below.</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fractional day time {#fdt .hiddenheading}</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>Dec times are measured in <span class="co">[</span><span class="ot">fractional days</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#Fractional_days:~:text=a%20decimal%20fraction%20of%20a%20day)</span>. The shortest, longest, and thinnest clocküïìhands and the top, middle, and bottom barsüìäindicate the <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, <span class="co">[</span><span class="ot">millidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="thousandths of a day"}, and <span class="co">[</span><span class="ot">centimillidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day"}, respectively, of the time since the start, <span class="co">[</span><span class="ot">+\${decTime}</span><span class="co">]</span>{.point1}, or until the end, <span class="co">[</span><span class="ot">-\${decTimeN}</span><span class="co">]</span>{.point0}, of the day in the Dec <span class="co">[</span><span class="ot">time zone</span><span class="co">](https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time)</span>, \${decZoneHsl}, at the location of the red‚≠ïÔ∏ècircle on the mapüó∫Ô∏èbeneath the barsüìä.</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ticking analog clocks {#tac .hiddenheading}</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>::: clocks</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>\${clock}\${clock1}</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bar chart clocks {#bcc .hiddenheading}</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@fheyen/barchart-clock</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>barChart <span class="op">=</span> {</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeats)))</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeats))</span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDD)<span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDD))</span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMils)<span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMils))</span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb34-118"><a href="#cb34-118" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb34-119"><a href="#cb34-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-120"><a href="#cb34-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-121"><a href="#cb34-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-122"><a href="#cb34-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb34-123"><a href="#cb34-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-124"><a href="#cb34-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb34-125"><a href="#cb34-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb34-126"><a href="#cb34-126" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb34-127"><a href="#cb34-127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-128"><a href="#cb34-128" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-129"><a href="#cb34-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-130"><a href="#cb34-130" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb34-131"><a href="#cb34-131" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-132"><a href="#cb34-132" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb34-133"><a href="#cb34-133" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb34-134"><a href="#cb34-134" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb34-135"><a href="#cb34-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-136"><a href="#cb34-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-137"><a href="#cb34-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-138"><a href="#cb34-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb34-139"><a href="#cb34-139" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-140"><a href="#cb34-140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb34-141"><a href="#cb34-141" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb34-142"><a href="#cb34-142" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb34-143"><a href="#cb34-143" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb34-144"><a href="#cb34-144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb34-145"><a href="#cb34-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-146"><a href="#cb34-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-147"><a href="#cb34-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb34-148"><a href="#cb34-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb34-149"><a href="#cb34-149" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb34-150"><a href="#cb34-150" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb34-151"><a href="#cb34-151" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb34-152"><a href="#cb34-152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb34-153"><a href="#cb34-153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-154"><a href="#cb34-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb34-155"><a href="#cb34-155" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb34-156"><a href="#cb34-156" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb34-157"><a href="#cb34-157" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb34-158"><a href="#cb34-158" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 550 ? 12 : W &lt; 650 ? 14 : W &lt; 750 ? 16 : W &lt; 850 ? 18 : 20}px`)</span></span>
<span id="cb34-159"><a href="#cb34-159" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb34-160"><a href="#cb34-160" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb34-161"><a href="#cb34-161" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb34-162"><a href="#cb34-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-163"><a href="#cb34-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-164"><a href="#cb34-164" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-165"><a href="#cb34-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb34-166"><a href="#cb34-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-167"><a href="#cb34-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb34-168"><a href="#cb34-168" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb34-169"><a href="#cb34-169" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb34-170"><a href="#cb34-170" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb34-171"><a href="#cb34-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-172"><a href="#cb34-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-173"><a href="#cb34-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-174"><a href="#cb34-174" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb34-175"><a href="#cb34-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-176"><a href="#cb34-176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb34-177"><a href="#cb34-177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb34-178"><a href="#cb34-178" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb34-179"><a href="#cb34-179" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb34-180"><a href="#cb34-180" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`+</span><span class="sc">${</span>barDD<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMils<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeats<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb34-181"><a href="#cb34-181" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-182"><a href="#cb34-182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb34-183"><a href="#cb34-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb34-184"><a href="#cb34-184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb34-185"><a href="#cb34-185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb34-186"><a href="#cb34-186" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb34-187"><a href="#cb34-187" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb34-188"><a href="#cb34-188" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topbar"</span>)<span class="op">;</span></span>
<span id="cb34-189"><a href="#cb34-189" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb34-190"><a href="#cb34-190" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb34-191"><a href="#cb34-191" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-192"><a href="#cb34-192" aria-hidden="true" tabindex="-1"></a>barChart1 <span class="op">=</span> {</span>
<span id="cb34-193"><a href="#cb34-193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb34-194"><a href="#cb34-194" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb34-195"><a href="#cb34-195" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-196"><a href="#cb34-196" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-197"><a href="#cb34-197" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb34-198"><a href="#cb34-198" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb34-199"><a href="#cb34-199" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb34-200"><a href="#cb34-200" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb34-201"><a href="#cb34-201" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb34-202"><a href="#cb34-202" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-203"><a href="#cb34-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb34-204"><a href="#cb34-204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb34-205"><a href="#cb34-205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-206"><a href="#cb34-206" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb34-207"><a href="#cb34-207" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb34-208"><a href="#cb34-208" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const scaleDek = d3.scaleLinear()</span></span>
<span id="cb34-209"><a href="#cb34-209" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .domain([0, 37])</span></span>
<span id="cb34-210"><a href="#cb34-210" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .range(xRange);</span></span>
<span id="cb34-211"><a href="#cb34-211" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb34-212"><a href="#cb34-212" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb34-213"><a href="#cb34-213" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb34-214"><a href="#cb34-214" aria-hidden="true" tabindex="-1"></a>      <span class="co">// 'dek', 'dotd',</span></span>
<span id="cb34-215"><a href="#cb34-215" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb34-216"><a href="#cb34-216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-217"><a href="#cb34-217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-218"><a href="#cb34-218" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb34-219"><a href="#cb34-219" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb34-220"><a href="#cb34-220" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb34-221"><a href="#cb34-221" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb34-222"><a href="#cb34-222" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-223"><a href="#cb34-223" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-224"><a href="#cb34-224" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb34-225"><a href="#cb34-225" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb34-226"><a href="#cb34-226" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeatsN)))</span>
<span id="cb34-227"><a href="#cb34-227" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-228"><a href="#cb34-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-229"><a href="#cb34-229" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb34-230"><a href="#cb34-230" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb34-231"><a href="#cb34-231" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeatsN))</span>
<span id="cb34-232"><a href="#cb34-232" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb34-233"><a href="#cb34-233" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-234"><a href="#cb34-234" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-235"><a href="#cb34-235" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb34-236"><a href="#cb34-236" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb34-237"><a href="#cb34-237" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDDN)<span class="op">+</span><span class="bu">Number</span>(barMilsN)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb34-238"><a href="#cb34-238" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-239"><a href="#cb34-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-240"><a href="#cb34-240" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb34-241"><a href="#cb34-241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb34-242"><a href="#cb34-242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDDN))</span>
<span id="cb34-243"><a href="#cb34-243" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-244"><a href="#cb34-244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-245"><a href="#cb34-245" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb34-246"><a href="#cb34-246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb34-247"><a href="#cb34-247" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMilsN)<span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb34-248"><a href="#cb34-248" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-249"><a href="#cb34-249" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-250"><a href="#cb34-250" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb34-251"><a href="#cb34-251" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb34-252"><a href="#cb34-252" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMilsN))</span>
<span id="cb34-253"><a href="#cb34-253" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb34-254"><a href="#cb34-254" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb34-255"><a href="#cb34-255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-256"><a href="#cb34-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-257"><a href="#cb34-257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-258"><a href="#cb34-258" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb34-259"><a href="#cb34-259" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-260"><a href="#cb34-260" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb34-261"><a href="#cb34-261" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb34-262"><a href="#cb34-262" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb34-263"><a href="#cb34-263" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-264"><a href="#cb34-264" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-265"><a href="#cb34-265" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-266"><a href="#cb34-266" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb34-267"><a href="#cb34-267" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-268"><a href="#cb34-268" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb34-269"><a href="#cb34-269" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb34-270"><a href="#cb34-270" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb34-271"><a href="#cb34-271" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-272"><a href="#cb34-272" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-273"><a href="#cb34-273" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-274"><a href="#cb34-274" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb34-275"><a href="#cb34-275" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-276"><a href="#cb34-276" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb34-277"><a href="#cb34-277" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb34-278"><a href="#cb34-278" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb34-279"><a href="#cb34-279" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb34-280"><a href="#cb34-280" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb34-281"><a href="#cb34-281" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-282"><a href="#cb34-282" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-283"><a href="#cb34-283" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb34-284"><a href="#cb34-284" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb34-285"><a href="#cb34-285" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb34-286"><a href="#cb34-286" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb34-287"><a href="#cb34-287" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb34-288"><a href="#cb34-288" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb34-289"><a href="#cb34-289" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-290"><a href="#cb34-290" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb34-291"><a href="#cb34-291" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb34-292"><a href="#cb34-292" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb34-293"><a href="#cb34-293" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb34-294"><a href="#cb34-294" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 350 ? 12 : W &lt; 450 ? 14 : W &lt; 550 ? 16 : W &lt; 650 ? 18 : 20}px`)</span></span>
<span id="cb34-295"><a href="#cb34-295" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb34-296"><a href="#cb34-296" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb34-297"><a href="#cb34-297" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb34-298"><a href="#cb34-298" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-299"><a href="#cb34-299" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-300"><a href="#cb34-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-301"><a href="#cb34-301" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb34-302"><a href="#cb34-302" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-303"><a href="#cb34-303" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb34-304"><a href="#cb34-304" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb34-305"><a href="#cb34-305" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb34-306"><a href="#cb34-306" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb34-307"><a href="#cb34-307" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-308"><a href="#cb34-308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-309"><a href="#cb34-309" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb34-310"><a href="#cb34-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb34-311"><a href="#cb34-311" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb34-312"><a href="#cb34-312" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb34-313"><a href="#cb34-313" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb34-314"><a href="#cb34-314" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb34-315"><a href="#cb34-315" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb34-316"><a href="#cb34-316" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`-</span><span class="sc">${</span>barDDN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMilsN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeatsN<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb34-317"><a href="#cb34-317" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-318"><a href="#cb34-318" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb34-319"><a href="#cb34-319" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb34-320"><a href="#cb34-320" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb34-321"><a href="#cb34-321" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb34-322"><a href="#cb34-322" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb34-323"><a href="#cb34-323" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb34-324"><a href="#cb34-324" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmbar"</span>)<span class="op">;</span></span>
<span id="cb34-325"><a href="#cb34-325" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb34-326"><a href="#cb34-326" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb34-327"><a href="#cb34-327" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-328"><a href="#cb34-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-329"><a href="#cb34-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-330"><a href="#cb34-330" aria-hidden="true" tabindex="-1"></a><span class="fu">## Longitude latitude map {#llm .hiddenheading}</span></span>
<span id="cb34-331"><a href="#cb34-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-334"><a href="#cb34-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-335"><a href="#cb34-335" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb34-336"><a href="#cb34-336" aria-hidden="true" tabindex="-1"></a>viewof location <span class="op">=</span> <span class="fu">worldMapCoordinates</span>([<span class="dv">162</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [width <span class="op">*</span> <span class="op">.</span><span class="dv">998</span><span class="op">,</span> ((<span class="dv">21</span> <span class="op">/</span> <span class="dv">40</span>) <span class="op">*</span> width)])</span>
<span id="cb34-337"><a href="#cb34-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-338"><a href="#cb34-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-339"><a href="#cb34-339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daylight area chart {#dac .hiddenheading}</span></span>
<span id="cb34-340"><a href="#cb34-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-343"><a href="#cb34-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-344"><a href="#cb34-344" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb34-345"><a href="#cb34-345" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb34-346"><a href="#cb34-346" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> {</span>
<span id="cb34-347"><a href="#cb34-347" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(width<span class="op">,</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">97</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">96</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">94</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">.</span><span class="dv">93</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">.</span><span class="dv">92</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">.</span><span class="dv">86</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">.</span><span class="dv">82</span> <span class="op">:</span> <span class="op">.</span><span class="dv">78</span>)))<span class="op">;</span></span>
<span id="cb34-348"><a href="#cb34-348" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">style</span>(<span class="st">"user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"-webkit-user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"daylightapp"</span>)<span class="op">;</span></span>
<span id="cb34-349"><a href="#cb34-349" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> {<span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">inner</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">;</span></span>
<span id="cb34-350"><a href="#cb34-350" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> contentWidth <span class="op">=</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">inner</span><span class="op">;</span></span>
<span id="cb34-351"><a href="#cb34-351" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> columnWidth <span class="op">=</span> contentWidth <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb34-352"><a href="#cb34-352" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> selection <span class="op">=</span> {</span>
<span id="cb34-353"><a href="#cb34-353" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> date2022<span class="op">,</span></span>
<span id="cb34-354"><a href="#cb34-354" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hour</span><span class="op">:</span> date2022<span class="op">.</span><span class="fu">getHours</span>()</span>
<span id="cb34-355"><a href="#cb34-355" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-356"><a href="#cb34-356" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderPlot <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb34-357"><a href="#cb34-357" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#plot *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb34-358"><a href="#cb34-358" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">select</span>(<span class="st">"#plot"</span>)<span class="op">.</span><span class="fu">call</span>(daylightPlot<span class="op">,</span> {</span>
<span id="cb34-359"><a href="#cb34-359" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vizwidth</span><span class="op">:</span> columnWidth <span class="op">/</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.25</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.4</span> <span class="op">:</span> <span class="fl">1.48</span>)<span class="op">,</span></span>
<span id="cb34-360"><a href="#cb34-360" aria-hidden="true" tabindex="-1"></a>      <span class="dt">height</span><span class="op">:</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.6</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.58</span> <span class="op">:</span> <span class="fl">1.56</span>)<span class="op">,</span></span>
<span id="cb34-361"><a href="#cb34-361" aria-hidden="true" tabindex="-1"></a>      <span class="dt">year</span><span class="op">:</span> <span class="dv">2022</span><span class="op">,</span></span>
<span id="cb34-362"><a href="#cb34-362" aria-hidden="true" tabindex="-1"></a>      <span class="dt">latitude</span><span class="op">:</span> location[<span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb34-363"><a href="#cb34-363" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultDate</span><span class="op">:</span> selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb34-364"><a href="#cb34-364" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultHour</span><span class="op">:</span> selection<span class="op">.</span><span class="at">hour</span></span>
<span id="cb34-365"><a href="#cb34-365" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb34-366"><a href="#cb34-366" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-367"><a href="#cb34-367" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderSolarSystem <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb34-368"><a href="#cb34-368" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb34-369"><a href="#cb34-369" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system"</span>)<span class="op">.</span><span class="fu">call</span>(solarSystem<span class="op">,</span></span>
<span id="cb34-370"><a href="#cb34-370" aria-hidden="true" tabindex="-1"></a>                                        columnWidth <span class="op">*</span> <span class="fl">2.02</span><span class="op">,</span></span>
<span id="cb34-371"><a href="#cb34-371" aria-hidden="true" tabindex="-1"></a>                                        location<span class="op">,</span></span>
<span id="cb34-372"><a href="#cb34-372" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb34-373"><a href="#cb34-373" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">hour</span><span class="op">,</span></span>
<span id="cb34-374"><a href="#cb34-374" aria-hidden="true" tabindex="-1"></a>                                        <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span>)<span class="op">;</span></span>
<span id="cb34-375"><a href="#cb34-375" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-376"><a href="#cb34-376" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const renderGlobe = () =&gt; {</span></span>
<span id="cb34-377"><a href="#cb34-377" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe *").remove();</span></span>
<span id="cb34-378"><a href="#cb34-378" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe").call(globe, { vizwidth: columnWidth / 1.28, location, ...selection });</span></span>
<span id="cb34-379"><a href="#cb34-379" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb34-380"><a href="#cb34-380" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> setSelection <span class="op">=</span> (newSelection<span class="op">,</span> forceRender <span class="op">=</span> <span class="kw">false</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb34-381"><a href="#cb34-381" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prev <span class="op">=</span> {<span class="op">...</span>selection}<span class="op">;</span></span>
<span id="cb34-382"><a href="#cb34-382" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> newSelection<span class="op">;</span></span>
<span id="cb34-383"><a href="#cb34-383" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="at">value</span> <span class="op">=</span> selection<span class="op">;</span></span>
<span id="cb34-384"><a href="#cb34-384" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedDate<span class="op">,</span> selection<span class="op">.</span><span class="at">date</span>)<span class="op">;</span></span>
<span id="cb34-385"><a href="#cb34-385" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedHour<span class="op">,</span> selection<span class="op">.</span><span class="at">hour</span>)<span class="op">;</span></span>
<span id="cb34-386"><a href="#cb34-386" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (forceRender) {</span>
<span id="cb34-387"><a href="#cb34-387" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderPlot</span>()<span class="op">;</span></span>
<span id="cb34-388"><a href="#cb34-388" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb34-389"><a href="#cb34-389" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb34-390"><a href="#cb34-390" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (prev<span class="op">.</span><span class="at">hour</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">hour</span> <span class="op">||</span> prev<span class="op">.</span><span class="at">date</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">date</span>) {</span>
<span id="cb34-391"><a href="#cb34-391" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb34-392"><a href="#cb34-392" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb34-393"><a href="#cb34-393" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-394"><a href="#cb34-394" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-395"><a href="#cb34-395" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plot <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-396"><a href="#cb34-396" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"plot"</span>)</span>
<span id="cb34-397"><a href="#cb34-397" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">0</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>height <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">12</span> <span class="op">:</span> <span class="dv">5</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-398"><a href="#cb34-398" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-399"><a href="#cb34-399" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"solar-system"</span>)</span>
<span id="cb34-400"><a href="#cb34-400" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">12</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">22</span> <span class="op">-</span> <span class="dv">6</span> <span class="op">-</span> <span class="dv">5</span> <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-401"><a href="#cb34-401" aria-hidden="true" tabindex="-1"></a>  <span class="co">// svg.append("g")</span></span>
<span id="cb34-402"><a href="#cb34-402" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("id", "globe")</span></span>
<span id="cb34-403"><a href="#cb34-403" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("transform", `translate(${margin.left + margin.inner + columnWidth / 2 + 20}, ${margin.top + height / 1.2 + 4})`);</span></span>
<span id="cb34-404"><a href="#cb34-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setSelection</span>(selection<span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb34-405"><a href="#cb34-405" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateHourChange <span class="op">=</span> ({ target<span class="op">,</span> <span class="dt">detail</span><span class="op">:</span> { date<span class="op">,</span> hour }}) <span class="kw">=&gt;</span> {</span>
<span id="cb34-406"><a href="#cb34-406" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (date <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> hour <span class="op">!=</span> <span class="kw">null</span>) <span class="fu">setSelection</span>({<span class="op">...</span>selection<span class="op">,</span> date<span class="op">,</span> hour})<span class="op">;</span></span>
<span id="cb34-407"><a href="#cb34-407" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-408"><a href="#cb34-408" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">addEventListener</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> handleDateHourChange<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb34-409"><a href="#cb34-409" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb34-410"><a href="#cb34-410" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-411"><a href="#cb34-411" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@d3/simple-clock</span></span>
<span id="cb34-412"><a href="#cb34-412" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@drio/lets-build-an-analog-clock</span></span>
<span id="cb34-413"><a href="#cb34-413" aria-hidden="true" tabindex="-1"></a>clock <span class="op">=</span> {</span>
<span id="cb34-414"><a href="#cb34-414" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb34-415"><a href="#cb34-415" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb34-416"><a href="#cb34-416" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb34-417"><a href="#cb34-417" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb34-418"><a href="#cb34-418" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb34-419"><a href="#cb34-419" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb34-420"><a href="#cb34-420" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb34-421"><a href="#cb34-421" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb34-422"><a href="#cb34-422" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb34-423"><a href="#cb34-423" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb34-424"><a href="#cb34-424" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb34-425"><a href="#cb34-425" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb34-426"><a href="#cb34-426" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb34-427"><a href="#cb34-427" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb34-428"><a href="#cb34-428" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb34-429"><a href="#cb34-429" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb34-430"><a href="#cb34-430" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb34-431"><a href="#cb34-431" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb34-432"><a href="#cb34-432" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-433"><a href="#cb34-433" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb34-434"><a href="#cb34-434" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb34-435"><a href="#cb34-435" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb34-436"><a href="#cb34-436" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-437"><a href="#cb34-437" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb34-438"><a href="#cb34-438" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb34-439"><a href="#cb34-439" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb34-440"><a href="#cb34-440" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-441"><a href="#cb34-441" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb34-442"><a href="#cb34-442" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb34-443"><a href="#cb34-443" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb34-444"><a href="#cb34-444" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb34-445"><a href="#cb34-445" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-446"><a href="#cb34-446" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-447"><a href="#cb34-447" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb34-448"><a href="#cb34-448" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb34-449"><a href="#cb34-449" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb34-450"><a href="#cb34-450" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb34-451"><a href="#cb34-451" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-452"><a href="#cb34-452" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-453"><a href="#cb34-453" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb34-454"><a href="#cb34-454" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb34-455"><a href="#cb34-455" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb34-456"><a href="#cb34-456" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb34-457"><a href="#cb34-457" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb34-458"><a href="#cb34-458" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-459"><a href="#cb34-459" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb34-460"><a href="#cb34-460" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb34-461"><a href="#cb34-461" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb34-462"><a href="#cb34-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb34-463"><a href="#cb34-463" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb34-464"><a href="#cb34-464" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-465"><a href="#cb34-465" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb34-466"><a href="#cb34-466" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-467"><a href="#cb34-467" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb34-468"><a href="#cb34-468" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-469"><a href="#cb34-469" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb34-470"><a href="#cb34-470" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-471"><a href="#cb34-471" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-472"><a href="#cb34-472" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb34-473"><a href="#cb34-473" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb34-474"><a href="#cb34-474" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-475"><a href="#cb34-475" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-476"><a href="#cb34-476" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb34-477"><a href="#cb34-477" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb34-478"><a href="#cb34-478" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-479"><a href="#cb34-479" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb34-480"><a href="#cb34-480" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-481"><a href="#cb34-481" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb34-482"><a href="#cb34-482" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb34-483"><a href="#cb34-483" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-484"><a href="#cb34-484" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-485"><a href="#cb34-485" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb34-486"><a href="#cb34-486" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-487"><a href="#cb34-487" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb34-488"><a href="#cb34-488" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb34-489"><a href="#cb34-489" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb34-490"><a href="#cb34-490" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb34-491"><a href="#cb34-491" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb34-492"><a href="#cb34-492" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-493"><a href="#cb34-493" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb34-494"><a href="#cb34-494" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb34-495"><a href="#cb34-495" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-496"><a href="#cb34-496" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb34-497"><a href="#cb34-497" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb34-498"><a href="#cb34-498" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-499"><a href="#cb34-499" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb34-500"><a href="#cb34-500" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb34-501"><a href="#cb34-501" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-502"><a href="#cb34-502" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-503"><a href="#cb34-503" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb34-504"><a href="#cb34-504" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb34-505"><a href="#cb34-505" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-506"><a href="#cb34-506" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-507"><a href="#cb34-507" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb34-508"><a href="#cb34-508" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb34-509"><a href="#cb34-509" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-510"><a href="#cb34-510" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-511"><a href="#cb34-511" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb34-512"><a href="#cb34-512" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-513"><a href="#cb34-513" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb34-514"><a href="#cb34-514" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb34-515"><a href="#cb34-515" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb34-516"><a href="#cb34-516" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb34-517"><a href="#cb34-517" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-518"><a href="#cb34-518" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb34-519"><a href="#cb34-519" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb34-520"><a href="#cb34-520" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb34-521"><a href="#cb34-521" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb34-522"><a href="#cb34-522" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb34-523"><a href="#cb34-523" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-524"><a href="#cb34-524" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb34-525"><a href="#cb34-525" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb34-526"><a href="#cb34-526" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-527"><a href="#cb34-527" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb34-528"><a href="#cb34-528" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-529"><a href="#cb34-529" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb34-530"><a href="#cb34-530" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-531"><a href="#cb34-531" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-532"><a href="#cb34-532" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-533"><a href="#cb34-533" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb34-534"><a href="#cb34-534" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb34-535"><a href="#cb34-535" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb34-536"><a href="#cb34-536" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-537"><a href="#cb34-537" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-538"><a href="#cb34-538" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb34-539"><a href="#cb34-539" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-540"><a href="#cb34-540" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb34-541"><a href="#cb34-541" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb34-542"><a href="#cb34-542" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb34-543"><a href="#cb34-543" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb34-544"><a href="#cb34-544" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb34-545"><a href="#cb34-545" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb34-546"><a href="#cb34-546" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb34-547"><a href="#cb34-547" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-548"><a href="#cb34-548" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-549"><a href="#cb34-549" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb34-550"><a href="#cb34-550" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTime[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb34-551"><a href="#cb34-551" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb34-552"><a href="#cb34-552" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb34-553"><a href="#cb34-553" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-554"><a href="#cb34-554" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb34-555"><a href="#cb34-555" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb34-556"><a href="#cb34-556" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb34-557"><a href="#cb34-557" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb34-558"><a href="#cb34-558" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb34-559"><a href="#cb34-559" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topclock"</span>)<span class="op">;</span></span>
<span id="cb34-560"><a href="#cb34-560" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-561"><a href="#cb34-561" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-562"><a href="#cb34-562" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`+</span><span class="sc">${</span>decTime<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb34-563"><a href="#cb34-563" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb34-564"><a href="#cb34-564" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb34-565"><a href="#cb34-565" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-566"><a href="#cb34-566" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb34-567"><a href="#cb34-567" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb34-568"><a href="#cb34-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb34-569"><a href="#cb34-569" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb34-570"><a href="#cb34-570" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb34-571"><a href="#cb34-571" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb34-572"><a href="#cb34-572" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb34-573"><a href="#cb34-573" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb34-574"><a href="#cb34-574" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-575"><a href="#cb34-575" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb34-576"><a href="#cb34-576" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb34-577"><a href="#cb34-577" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb34-578"><a href="#cb34-578" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb34-579"><a href="#cb34-579" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-580"><a href="#cb34-580" aria-hidden="true" tabindex="-1"></a>clock1 <span class="op">=</span> {</span>
<span id="cb34-581"><a href="#cb34-581" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb34-582"><a href="#cb34-582" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb34-583"><a href="#cb34-583" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb34-584"><a href="#cb34-584" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb34-585"><a href="#cb34-585" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb34-586"><a href="#cb34-586" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb34-587"><a href="#cb34-587" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb34-588"><a href="#cb34-588" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb34-589"><a href="#cb34-589" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb34-590"><a href="#cb34-590" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb34-591"><a href="#cb34-591" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb34-592"><a href="#cb34-592" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb34-593"><a href="#cb34-593" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb34-594"><a href="#cb34-594" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb34-595"><a href="#cb34-595" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb34-596"><a href="#cb34-596" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb34-597"><a href="#cb34-597" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb34-598"><a href="#cb34-598" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb34-599"><a href="#cb34-599" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-600"><a href="#cb34-600" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb34-601"><a href="#cb34-601" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb34-602"><a href="#cb34-602" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb34-603"><a href="#cb34-603" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-604"><a href="#cb34-604" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb34-605"><a href="#cb34-605" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb34-606"><a href="#cb34-606" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb34-607"><a href="#cb34-607" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-608"><a href="#cb34-608" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb34-609"><a href="#cb34-609" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb34-610"><a href="#cb34-610" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb34-611"><a href="#cb34-611" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb34-612"><a href="#cb34-612" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-613"><a href="#cb34-613" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-614"><a href="#cb34-614" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb34-615"><a href="#cb34-615" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb34-616"><a href="#cb34-616" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb34-617"><a href="#cb34-617" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb34-618"><a href="#cb34-618" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-619"><a href="#cb34-619" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb34-620"><a href="#cb34-620" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb34-621"><a href="#cb34-621" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb34-622"><a href="#cb34-622" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb34-623"><a href="#cb34-623" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb34-624"><a href="#cb34-624" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb34-625"><a href="#cb34-625" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-626"><a href="#cb34-626" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb34-627"><a href="#cb34-627" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb34-628"><a href="#cb34-628" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb34-629"><a href="#cb34-629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb34-630"><a href="#cb34-630" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb34-631"><a href="#cb34-631" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-632"><a href="#cb34-632" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb34-633"><a href="#cb34-633" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-634"><a href="#cb34-634" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb34-635"><a href="#cb34-635" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-636"><a href="#cb34-636" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb34-637"><a href="#cb34-637" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb34-638"><a href="#cb34-638" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-639"><a href="#cb34-639" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb34-640"><a href="#cb34-640" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb34-641"><a href="#cb34-641" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-642"><a href="#cb34-642" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-643"><a href="#cb34-643" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb34-644"><a href="#cb34-644" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb34-645"><a href="#cb34-645" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-646"><a href="#cb34-646" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb34-647"><a href="#cb34-647" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-648"><a href="#cb34-648" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb34-649"><a href="#cb34-649" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb34-650"><a href="#cb34-650" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-651"><a href="#cb34-651" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-652"><a href="#cb34-652" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb34-653"><a href="#cb34-653" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-654"><a href="#cb34-654" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb34-655"><a href="#cb34-655" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb34-656"><a href="#cb34-656" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb34-657"><a href="#cb34-657" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb34-658"><a href="#cb34-658" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb34-659"><a href="#cb34-659" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-660"><a href="#cb34-660" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb34-661"><a href="#cb34-661" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb34-662"><a href="#cb34-662" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-663"><a href="#cb34-663" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb34-664"><a href="#cb34-664" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb34-665"><a href="#cb34-665" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-666"><a href="#cb34-666" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb34-667"><a href="#cb34-667" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb34-668"><a href="#cb34-668" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-669"><a href="#cb34-669" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-670"><a href="#cb34-670" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb34-671"><a href="#cb34-671" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb34-672"><a href="#cb34-672" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-673"><a href="#cb34-673" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-674"><a href="#cb34-674" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb34-675"><a href="#cb34-675" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb34-676"><a href="#cb34-676" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-677"><a href="#cb34-677" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-678"><a href="#cb34-678" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb34-679"><a href="#cb34-679" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-680"><a href="#cb34-680" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb34-681"><a href="#cb34-681" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb34-682"><a href="#cb34-682" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb34-683"><a href="#cb34-683" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb34-684"><a href="#cb34-684" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-685"><a href="#cb34-685" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb34-686"><a href="#cb34-686" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb34-687"><a href="#cb34-687" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb34-688"><a href="#cb34-688" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb34-689"><a href="#cb34-689" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb34-690"><a href="#cb34-690" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb34-691"><a href="#cb34-691" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb34-692"><a href="#cb34-692" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb34-693"><a href="#cb34-693" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-694"><a href="#cb34-694" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb34-695"><a href="#cb34-695" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-696"><a href="#cb34-696" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb34-697"><a href="#cb34-697" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-698"><a href="#cb34-698" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb34-699"><a href="#cb34-699" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-700"><a href="#cb34-700" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb34-701"><a href="#cb34-701" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb34-702"><a href="#cb34-702" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb34-703"><a href="#cb34-703" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-704"><a href="#cb34-704" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-705"><a href="#cb34-705" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb34-706"><a href="#cb34-706" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-707"><a href="#cb34-707" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb34-708"><a href="#cb34-708" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb34-709"><a href="#cb34-709" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb34-710"><a href="#cb34-710" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb34-711"><a href="#cb34-711" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb34-712"><a href="#cb34-712" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb34-713"><a href="#cb34-713" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb34-714"><a href="#cb34-714" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-715"><a href="#cb34-715" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-716"><a href="#cb34-716" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb34-717"><a href="#cb34-717" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTimeN[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb34-718"><a href="#cb34-718" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb34-719"><a href="#cb34-719" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb34-720"><a href="#cb34-720" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-721"><a href="#cb34-721" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb34-722"><a href="#cb34-722" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb34-723"><a href="#cb34-723" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb34-724"><a href="#cb34-724" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb34-725"><a href="#cb34-725" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb34-726"><a href="#cb34-726" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmclock"</span>)<span class="op">;</span></span>
<span id="cb34-727"><a href="#cb34-727" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb34-728"><a href="#cb34-728" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-729"><a href="#cb34-729" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`-</span><span class="sc">${</span>decTimeN<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb34-730"><a href="#cb34-730" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb34-731"><a href="#cb34-731" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb34-732"><a href="#cb34-732" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-733"><a href="#cb34-733" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb34-734"><a href="#cb34-734" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb34-735"><a href="#cb34-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb34-736"><a href="#cb34-736" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb34-737"><a href="#cb34-737" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb34-738"><a href="#cb34-738" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb34-739"><a href="#cb34-739" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb34-740"><a href="#cb34-740" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb34-741"><a href="#cb34-741" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb34-742"><a href="#cb34-742" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb34-743"><a href="#cb34-743" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb34-744"><a href="#cb34-744" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb34-745"><a href="#cb34-745" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb34-746"><a href="#cb34-746" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-747"><a href="#cb34-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-748"><a href="#cb34-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-749"><a href="#cb34-749" aria-hidden="true" tabindex="-1"></a>To rotate the globeüåêin the Earthüåèorbit diagram, drag the red‚≠ïÔ∏ècircle horizontally‚ÜîÔ∏èor slide the redüî¥dot on the daylight area chart vertically‚Üï. The red‚≠ïÔ∏ècircle's vertical‚Üïposition determines the yearly daylight pattern visualized by the area chart. Shift the red<span class="dt">&lt;</span><span class="kw">font</span><span class="ot"> color</span><span class="op">=</span><span class="st">red</span><span class="dt">&gt;</span>‚Äî<span class="dt">&lt;/</span><span class="kw">font</span><span class="dt">&gt;</span>line on the area chart horizontally‚ÜîÔ∏èto move the globeüåêalong the ellipse of the Earthüåéorbit.</span>
<span id="cb34-750"><a href="#cb34-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-751"><a href="#cb34-751" aria-hidden="true" tabindex="-1"></a><span class="fu">## Time of day (tod) {#tod .hiddenheading}</span></span>
<span id="cb34-752"><a href="#cb34-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-753"><a href="#cb34-753" aria-hidden="true" tabindex="-1"></a>Dec times consist of a time-of-day (<span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"}) and a time zone: \${selTimeHsl1}<span class="co">[</span><span class="ot">--</span><span class="co">]</span>{style="font-family:monospace;"}\${selZoneHsl}. The <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} denoted by the redüî¥dot is \${selTimeDay} days or \${selTimeHsl0} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}. The day-of-year (<span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day-of-year"}) indicated by the red<span class="dt">&lt;</span><span class="kw">font</span><span class="ot"> color</span><span class="op">=</span><span class="st">red</span><span class="dt">&gt;</span>‚Äî<span class="dt">&lt;/</span><span class="kw">font</span><span class="dt">&gt;</span>line is \${selDateHsl}. Together, a <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day-of-year"} and <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} form a floatingüõüsnapü´∞. Like <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times-of-day"}, floatingüõüsnapsü´∞can be expressed in days, \${selSnapDay}, or <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}: \${selSnapDec}.</span>
<span id="cb34-754"><a href="#cb34-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-755"><a href="#cb34-755" aria-hidden="true" tabindex="-1"></a>A floatingüõüsnapü´∞identifies a day in an unspecified year with its first three digits, classifies that day as a work or rest day with its third digit, and specifies a point in that day with its remaining digits, thus serving the same purposes as a <span class="co">[</span><span class="ot">Gregorian calendar</span><span class="co">](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)</span> month and day-of-month (<span class="co">[</span><span class="ot">dom</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day-of-month"}) pair, a day-of-week (<span class="co">[</span><span class="ot">dow</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day-of-week"}), and an hour-minute-second (<span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"}) triplet.</span>
<span id="cb34-756"><a href="#cb34-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-757"><a href="#cb34-757" aria-hidden="true" tabindex="-1"></a><span class="fu">## Day of era (doe) {#doe .hiddenheading}</span></span>
<span id="cb34-758"><a href="#cb34-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-759"><a href="#cb34-759" aria-hidden="true" tabindex="-1"></a>To turn a floatingüõüsnapü´∞into a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"}, we keep the remainder after dividing days by one or <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} by ten. We can use this same approach to obtain a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} from a day-of-<span class="co">[</span><span class="ot">era</span><span class="co">](https://en.wikipedia.org/wiki/Calendar_era#:~:text=the%20period%20of%20time%20elapsed%20since%20one%20epoch%20of%20a%20calendar)</span> (<span class="co">[</span><span class="ot">doe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times-of-day"}), \${zeroDote.toFixed(5)} <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 = \${zeroTimeHsl0}, or <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"}-of-<span class="co">[</span><span class="ot">era</span><span class="co">](https://en.wikipedia.org/wiki/Calendar_era#:~:text=the%20period%20of%20time%20elapsed%20since%20one%20epoch%20of%20a%20calendar)</span> (<span class="co">[</span><span class="ot">ddoe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times-of-day"}): \${(zeroDote <span class="sc">\*</span> 10).toFixed(4)} <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 10 = \${zeroTimeHsl1}. The current <span class="co">[</span><span class="ot">doe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day-of-era"} tells us how many days have passed since the Dec <span class="co">[</span><span class="ot">epoch</span><span class="co">](https://en.wikipedia.org/wiki/Epoch#:~:text=an%20instant%20in%20time%20chosen%20as%20the%20origin%20of%20a%20particular%20calendar%20era)</span>.</span>
<span id="cb34-760"><a href="#cb34-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-761"><a href="#cb34-761" aria-hidden="true" tabindex="-1"></a>Similarly, <span class="co">[</span><span class="ot">UNIX time</span><span class="co">](https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970%2C%20the%20Unix%20epoch)</span> counts the seconds since the <span class="co">[</span><span class="ot">UNIX epoch</span><span class="co">](https://en.wikipedia.org/wiki/Unix_time#:~:text=00%3A00%3A00%20UTC%20on%201%C2%A0January%201970)</span>. To get the <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, the Dec time zone that is in between the two leftmost vertical lines on the mapüó∫Ô∏èabove, we can divide UNIX time by the <span class="co">[</span><span class="ot">number of seconds in a day</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Day#:~:text=average%2C%20this%20is-,24%20hours%20(86%2C400%20seconds),-.%20As%20a%20day) or a <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} and then keep the remainder after dividing the resulting days by one or the resulting <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} by ten:</span>
<span id="cb34-762"><a href="#cb34-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-763"><a href="#cb34-763" aria-hidden="true" tabindex="-1"></a>$$\text{day} = \text{unix} \div 86400 \text{ mod } 1$$</span>
<span id="cb34-764"><a href="#cb34-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-765"><a href="#cb34-765" aria-hidden="true" tabindex="-1"></a>$$\text{deciday} = \text{unix} \div 8640 \text{ mod } 10$$</span>
<span id="cb34-766"><a href="#cb34-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-767"><a href="#cb34-767" aria-hidden="true" tabindex="-1"></a>We can also derive a Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} from a <span class="co">[</span><span class="ot">Julian date</span><span class="co">](https://en.wikipedia.org/wiki/Julian_day#:~:text=the%20Julian%20day%20number%20plus%20the%20fraction%20of%20a%20day%20since%20the%20preceding%20noon)</span> simply by keeping the remainder after dividing by one. To convert days (<span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="days"}) into <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} (<span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}), we multiply by ten. If we want a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} instead of a Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"}, we should add half a day (0.5 <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="days"}) to the Julian date before converting it to a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} to ensure that the result is less than one <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="days"} or ten <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}:</span>
<span id="cb34-768"><a href="#cb34-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-769"><a href="#cb34-769" aria-hidden="true" tabindex="-1"></a>$$\text{day} = (\text{julian} + 0.5) \text{ mod } 1$$</span>
<span id="cb34-770"><a href="#cb34-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-771"><a href="#cb34-771" aria-hidden="true" tabindex="-1"></a>$$\text{deciday} = \text{day} \times 10$$</span>
<span id="cb34-772"><a href="#cb34-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-773"><a href="#cb34-773" aria-hidden="true" tabindex="-1"></a>UNIX time and Julian dates yield <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times-of-day"} that are 5 <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"} apart because the UNIX epoch occurred at midnight (<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}) and the Julian period started at <span class="co">[</span><span class="ot">noon</span><span class="co">]</span>{.color5 data-bs-toggle="tooltip" data-bs-title="decidays"} (<span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}). The table below shows the Dec, UNIX, Julian date, and <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) epochs in the <span class="co">[</span><span class="ot">year+doy.tod-z</span><span class="co">]</span>{style="font-family:monospace;"} format of anchored‚öìÔ∏èsnapsü´∞, where <span class="co">[</span><span class="ot">z</span><span class="co">]</span>{style="font-family:monospace;"} is a Dec time zone:</span>
<span id="cb34-774"><a href="#cb34-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-775"><a href="#cb34-775" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Epoch      <span class="pp">|</span> <span class="dv">&amp;nbsp;</span>[<span class="co">[</span><span class="ot">year</span><span class="co">]</span>{.colorBkg data-bs-toggle="tooltip" data-bs-title="Dec year"}<span class="co">[</span><span class="ot">+</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.colorBkg data-bs-toggle="tooltip" data-bs-title="day-of-year"}<span class="co">[</span><span class="ot">.</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.colorBkg data-bs-toggle="tooltip" data-bs-title="time-of-day"}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">z</span><span class="co">]</span>{.colorBkg data-bs-toggle="tooltip" data-bs-title="Dec time zone"}]{style="font-weight:normal;"}          <span class="pp">|</span></span>
<span id="cb34-776"><a href="#cb34-776" aria-hidden="true" tabindex="-1"></a><span class="pp">| ----------</span> <span class="pp">| ------</span> <span class="pp">|</span></span>
<span id="cb34-777"><a href="#cb34-777" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Dec        <span class="pp">|</span> <span class="dv">&amp;nbsp;</span><span class="co">[</span><span class="ot">0000</span><span class="co">]</span>{.color0 data-bs-toggle="tooltip" data-bs-title="1 BC"}<span class="co">[</span><span class="ot">+</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">000</span><span class="co">]</span>{.color0 data-bs-toggle="tooltip" data-bs-title="March 1"}<span class="co">[</span><span class="ot">.</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">000</span><span class="co">]</span>{.color0 data-bs-toggle="tooltip" data-bs-title="midnight"}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0 data-bs-toggle="tooltip" data-bs-title="Zone 0"}  <span class="pp">|</span></span>
<span id="cb34-778"><a href="#cb34-778" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> UNIX       <span class="pp">|</span> <span class="dv">&amp;nbsp;</span><span class="co">[</span><span class="ot">1969</span><span class="co">]</span>{.color969}<span class="co">[</span><span class="ot">+</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">306</span><span class="co">]</span>{.colorD306 data-bs-toggle="tooltip" data-bs-title="January 1"}<span class="co">[</span><span class="ot">.</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">000</span><span class="co">]</span>{.color0 data-bs-toggle="tooltip" data-bs-title="midnight"}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}  <span class="pp">|</span></span>
<span id="cb34-779"><a href="#cb34-779" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Julian Day <span class="pp">|</span> -<span class="co">[</span><span class="ot">4713</span><span class="co">]</span>{.color287 data-bs-toggle="tooltip" data-bs-title="4714 BCE"}<span class="co">[</span><span class="ot">+</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">268</span><span class="co">]</span>{.colorD268 data-bs-toggle="tooltip" data-bs-title="November 24"}<span class="co">[</span><span class="ot">.</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">500</span><span class="co">]</span>{.color5 data-bs-toggle="tooltip" data-bs-title="noon"}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}   <span class="pp">|</span></span>
<span id="cb34-780"><a href="#cb34-780" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> UTC        <span class="pp">|</span> -<span class="co">[</span><span class="ot">0001</span><span class="co">]</span>{.color999 data-bs-toggle="tooltip" data-bs-title="2 BCE"}<span class="co">[</span><span class="ot">+</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">306</span><span class="co">]</span>{.colorD306 data-bs-toggle="tooltip" data-bs-title="January 1"}<span class="co">[</span><span class="ot">.</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">000</span><span class="co">]</span>{.color0 data-bs-toggle="tooltip" data-bs-title="midnight"}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}   <span class="pp">|</span></span>
<span id="cb34-781"><a href="#cb34-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-782"><a href="#cb34-782" aria-hidden="true" tabindex="-1"></a>In <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}, the length of Day <span class="co">[</span><span class="ot">121</span><span class="co">]</span>{.colorD121 data-bs-toggle="tooltip" data-bs-title="June 30"} or Day <span class="co">[</span><span class="ot">305</span><span class="co">]</span>{.colorD305 data-bs-toggle="tooltip" data-bs-title="December 31"} can vary due to <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>. In Dec, every day in always 86400 seconds or 100000 <span class="co">[</span><span class="ot">centimillidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundred thousands of a day"} (<span class="co">[</span><span class="ot">beats</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="centimillidays"}) long. If needed, Dec can include any number of leap seconds as part of a time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place). According to Dec, the [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00</span><span class="co">]</span>{.color0}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time) time zone does not include any leap seconds because it has an offset of <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}.</span>
<span id="cb34-783"><a href="#cb34-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-784"><a href="#cb34-784" aria-hidden="true" tabindex="-1"></a>To indicate that a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone includes the 27 leap seconds that have been added to <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} so far, Dec appends <span class="co">[</span><span class="ot">:27</span><span class="co">]</span>{.color1by320} to its offset. The Dec equivalent of the [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00:27</span><span class="co">]</span>{.color1by320}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time) time zone is Zone <span class="co">[</span><span class="ot">1/320</span><span class="co">]</span>{.color1by320}.</span>
<span id="cb34-785"><a href="#cb34-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-786"><a href="#cb34-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-787"><a href="#cb34-787" aria-hidden="true" tabindex="-1"></a>this offset as</span>
<span id="cb34-788"><a href="#cb34-788" aria-hidden="true" tabindex="-1"></a>T</span>
<span id="cb34-789"><a href="#cb34-789" aria-hidden="true" tabindex="-1"></a>To represent the 27 leap seconds that have been added to <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} so far, Dec uses an offset of <span class="co">[</span><span class="ot">1/320</span><span class="co">]</span>{.color1by320} <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}. Dec refers to the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone that has this offset as [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00:32</span><span class="co">]</span>{.color1by320}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time).</span>
<span id="cb34-790"><a href="#cb34-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-791"><a href="#cb34-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-792"><a href="#cb34-792" aria-hidden="true" tabindex="-1"></a>either or secon</span>
<span id="cb34-793"><a href="#cb34-793" aria-hidden="true" tabindex="-1"></a>Since 1972+121, 27 positive leap seconds have been added to UTC, and 0 negative leap seconds have been whave been</span>
<span id="cb34-794"><a href="#cb34-794" aria-hidden="true" tabindex="-1"></a>in a Julian date or a <span class="co">[</span><span class="ot">doe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times-of-day"} i</span>
<span id="cb34-795"><a href="#cb34-795" aria-hidden="true" tabindex="-1"></a>Dec does not allow The time in the ten Dec time zones never include</span>
<span id="cb34-796"><a href="#cb34-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-797"><a href="#cb34-797" aria-hidden="true" tabindex="-1"></a>o depending on whether the leap second is p.  Dec uses to represent <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> without changing the length of a day in the same way as leap days changes the length of a year. Instead of allowing the length of a day included, some <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} days will be 86401 or 86399 seconds long. So far, 27 positive leap seconds have been added, some <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} days will differ in length.  includes  of seconds, Dec uses beats. 100000 The programming languages that the <span class="co">[</span><span class="ot">Quarto FAQ</span><span class="co">](https://quarto.org/docs/faq)</span> refers to as <span class="co">[</span><span class="ot">principal languages supported by Quarto</span><span class="co">](https://quarto.org/docs/faq/#:~:text=The%20principal%20languages%20supported%20by%20Quarto%20are%20Python%2C%20R%2C%20Julia%2C%20and%20Observable%20JavaScript)</span>, <span class="co">[</span><span class="ot">Python</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Python_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%20programming%20language) (Quarto principal languages), <span class="co">[</span><span class="ot">R</span><span class="co">]</span>(https://en.wikipedia.org/wiki/R_(programming_language)#:~:text=a%20programming%20language%20for%20statistical%20computing%20and%20data%20visualization), <span class="co">[</span><span class="ot">Julia</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Julia_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%5B17%5D%20dynamic%20programming%20language), and <span class="co">[</span><span class="ot">Observable</span><span class="co">](http://observablehq.com)</span> <span class="co">[</span><span class="ot">JavaScript</span><span class="co">](https://en.wikipedia.org/wiki/JavaScript#:~:text=a%20programming%20language%20and%20core%20technology%20of%20the%20World%20Wide%20Web)</span>, do not include <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> in <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time. Therefore, a day in</span>
<span id="cb34-798"><a href="#cb34-798" aria-hidden="true" tabindex="-1"></a>Even though the Dec, UNIX, and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} epochs all occurred at midnight, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time may be shifted in relation to Dec or UNIX time because of <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>.</span>
<span id="cb34-799"><a href="#cb34-799" aria-hidden="true" tabindex="-1"></a>Since 1972+121, 27</span>
<span id="cb34-800"><a href="#cb34-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-801"><a href="#cb34-801" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset group="language"}</span>
<span id="cb34-802"><a href="#cb34-802" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb34-803"><a href="#cb34-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-806"><a href="#cb34-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb34-807"><a href="#cb34-807" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timezone</span>
<span id="cb34-808"><a href="#cb34-808" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> datetime.now(timezone.utc)</span>
<span id="cb34-809"><a href="#cb34-809" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> hms.timestamp() <span class="op">/</span> <span class="dv">86400</span> <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb34-810"><a href="#cb34-810" aria-hidden="true" tabindex="-1"></a>utc <span class="op">=</span> (</span>
<span id="cb34-811"><a href="#cb34-811" aria-hidden="true" tabindex="-1"></a>    hms.hour <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span></span>
<span id="cb34-812"><a href="#cb34-812" aria-hidden="true" tabindex="-1"></a>    hms.minute <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span></span>
<span id="cb34-813"><a href="#cb34-813" aria-hidden="true" tabindex="-1"></a>    hms.second <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span></span>
<span id="cb34-814"><a href="#cb34-814" aria-hidden="true" tabindex="-1"></a>    hms.microsecond <span class="op">/</span> <span class="fl">864e8</span></span>
<span id="cb34-815"><a href="#cb34-815" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-816"><a href="#cb34-816" aria-hidden="true" tabindex="-1"></a>hms</span>
<span id="cb34-817"><a href="#cb34-817" aria-hidden="true" tabindex="-1"></a>utc</span>
<span id="cb34-818"><a href="#cb34-818" aria-hidden="true" tabindex="-1"></a>unix</span>
<span id="cb34-819"><a href="#cb34-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-820"><a href="#cb34-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-821"><a href="#cb34-821" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb34-822"><a href="#cb34-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-825"><a href="#cb34-825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb34-826"><a href="#cb34-826" aria-hidden="true" tabindex="-1"></a>sys <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb34-827"><a href="#cb34-827" aria-hidden="true" tabindex="-1"></a>hms <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(sys, <span class="at">tz =</span> <span class="st">"UTC"</span>)</span>
<span id="cb34-828"><a href="#cb34-828" aria-hidden="true" tabindex="-1"></a>unix <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(<span class="fu">as.POSIXct</span>(sys)) <span class="sc">/</span> <span class="dv">86400</span>) <span class="sc">%%</span> <span class="dv">1</span></span>
<span id="cb34-829"><a href="#cb34-829" aria-hidden="true" tabindex="-1"></a>utc <span class="ot">&lt;-</span> hms<span class="sc">$</span>hour <span class="sc">/</span> <span class="dv">24</span> <span class="sc">+</span></span>
<span id="cb34-830"><a href="#cb34-830" aria-hidden="true" tabindex="-1"></a>       hms<span class="sc">$</span>min <span class="sc">/</span> <span class="dv">1440</span> <span class="sc">+</span></span>
<span id="cb34-831"><a href="#cb34-831" aria-hidden="true" tabindex="-1"></a>       <span class="fu">as.numeric</span>(hms<span class="sc">$</span>sec) <span class="sc">/</span> <span class="dv">86400</span></span>
<span id="cb34-832"><a href="#cb34-832" aria-hidden="true" tabindex="-1"></a>sys</span>
<span id="cb34-833"><a href="#cb34-833" aria-hidden="true" tabindex="-1"></a>hms</span>
<span id="cb34-834"><a href="#cb34-834" aria-hidden="true" tabindex="-1"></a>utc</span>
<span id="cb34-835"><a href="#cb34-835" aria-hidden="true" tabindex="-1"></a>unix</span>
<span id="cb34-836"><a href="#cb34-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-837"><a href="#cb34-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-838"><a href="#cb34-838" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observable</span></span>
<span id="cb34-839"><a href="#cb34-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-842"><a href="#cb34-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-843"><a href="#cb34-843" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb34-844"><a href="#cb34-844" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> hms<span class="op">.</span><span class="fu">getTime</span>() <span class="op">/</span> <span class="fl">864e5</span> <span class="op">%</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-845"><a href="#cb34-845" aria-hidden="true" tabindex="-1"></a>utc <span class="op">=</span> hms<span class="op">.</span><span class="fu">getUTCHours</span>() <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span></span>
<span id="cb34-846"><a href="#cb34-846" aria-hidden="true" tabindex="-1"></a>      hms<span class="op">.</span><span class="fu">getUTCMinutes</span>() <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span></span>
<span id="cb34-847"><a href="#cb34-847" aria-hidden="true" tabindex="-1"></a>      hms<span class="op">.</span><span class="fu">getUTCSeconds</span>() <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span></span>
<span id="cb34-848"><a href="#cb34-848" aria-hidden="true" tabindex="-1"></a>      hms<span class="op">.</span><span class="fu">getUTCMilliseconds</span>() <span class="op">/</span> <span class="fl">864e5</span><span class="op">;</span></span>
<span id="cb34-849"><a href="#cb34-849" aria-hidden="true" tabindex="-1"></a>hms</span>
<span id="cb34-850"><a href="#cb34-850" aria-hidden="true" tabindex="-1"></a>unix</span>
<span id="cb34-851"><a href="#cb34-851" aria-hidden="true" tabindex="-1"></a>utc</span>
<span id="cb34-852"><a href="#cb34-852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-853"><a href="#cb34-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-854"><a href="#cb34-854" aria-hidden="true" tabindex="-1"></a><span class="fu">### Julia</span></span>
<span id="cb34-855"><a href="#cb34-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-858"><a href="#cb34-858" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb34-859"><a href="#cb34-859" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Dates</span></span>
<span id="cb34-860"><a href="#cb34-860" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="fu">now</span>(UTC)</span>
<span id="cb34-861"><a href="#cb34-861" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> <span class="fu">datetime2unix</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">%</span> <span class="fl">1</span></span>
<span id="cb34-862"><a href="#cb34-862" aria-hidden="true" tabindex="-1"></a>utc <span class="op">=</span> <span class="fu">hour</span>(hms) <span class="op">/</span> <span class="fl">24</span> <span class="op">+</span></span>
<span id="cb34-863"><a href="#cb34-863" aria-hidden="true" tabindex="-1"></a>      <span class="fu">minute</span>(hms) <span class="op">/</span> <span class="fl">1440</span> <span class="op">+</span></span>
<span id="cb34-864"><a href="#cb34-864" aria-hidden="true" tabindex="-1"></a>      <span class="fu">second</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">+</span></span>
<span id="cb34-865"><a href="#cb34-865" aria-hidden="true" tabindex="-1"></a>      <span class="fu">millisecond</span>(hms) <span class="op">/</span> <span class="fl">86400000</span></span>
<span id="cb34-866"><a href="#cb34-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-867"><a href="#cb34-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-868"><a href="#cb34-868" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-869"><a href="#cb34-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-870"><a href="#cb34-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-871"><a href="#cb34-871" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hour minute second {#hms .hiddenheading}</span></span>
<span id="cb34-872"><a href="#cb34-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-873"><a href="#cb34-873" aria-hidden="true" tabindex="-1"></a>We can make the time in any Dec time zone match UNIX by subtracting its time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place). The time in the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} Dec time zone always matches UNIX time. because neither includes <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>. Dec considers <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">time zone</span><span class="co">](https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time)</span> to also match UNIX time. If there is a <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> are not included. Dec handles leap seconds like an additional time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place). <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+00:00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} with 27 leap seconds is referred to as Zone 1/320 in Dec and . which</span>
<span id="cb34-874"><a href="#cb34-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-875"><a href="#cb34-875" aria-hidden="true" tabindex="-1"></a>[<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00</span><span class="co">]</span>{.color0}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>
<span id="cb34-876"><a href="#cb34-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-877"><a href="#cb34-877" aria-hidden="true" tabindex="-1"></a>To produce a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} from an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet, we get the difference between the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place), convert its components to either days or <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, and sum the converted components.</span>
<span id="cb34-878"><a href="#cb34-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-879"><a href="#cb34-879" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb34-880"><a href="#cb34-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-881"><a href="#cb34-881" aria-hidden="true" tabindex="-1"></a>$$\text{deciday} = \frac{\text{hour}}{2.4} + \frac{\text{minute}}{144} + \frac{\text{second}}{8640}$$</span>
<span id="cb34-882"><a href="#cb34-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-883"><a href="#cb34-883" aria-hidden="true" tabindex="-1"></a>$$\text{day} = \frac{\text{hour}}{24} + \frac{\text{minute}}{1440} + \frac{\text{second}}{86400}$$</span>
<span id="cb34-884"><a href="#cb34-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-885"><a href="#cb34-885" aria-hidden="true" tabindex="-1"></a>does not include <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> or a <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) <span class="co">[</span><span class="ot">time zone</span><span class="co">](https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time)</span> <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) and</span>
<span id="cb34-886"><a href="#cb34-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-887"><a href="#cb34-887" aria-hidden="true" tabindex="-1"></a>than [<span class="co">[</span><span class="ot">+00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} and [<span class="co">[</span><span class="ot">+12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} will not match the time in any of the ten Dec time zones. We can create a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} by summing the components of an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet after</span>
<span id="cb34-888"><a href="#cb34-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-889"><a href="#cb34-889" aria-hidden="true" tabindex="-1"></a>that were added a <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} time zone. A <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet that includes <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> or a</span>
<span id="cb34-890"><a href="#cb34-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-891"><a href="#cb34-891" aria-hidden="true" tabindex="-1"></a><span class="fu">## Time zone offset {#tzo .hiddenheading}</span></span>
<span id="cb34-892"><a href="#cb34-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-893"><a href="#cb34-893" aria-hidden="true" tabindex="-1"></a>To be compatible with Dec, a time zone offset must be equivalent to one of the ten positive single-digit integer <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} Dec offsets. The Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} Dec time zone and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} time zone have equivalent offsets: <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} = <span class="co">[</span><span class="ot">12</span><span class="co">]</span>{.color5} hours. Likewise, the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} Dec time zone, UNIX time, and the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} time zone all have an offset of <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}.</span>
<span id="cb34-894"><a href="#cb34-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-895"><a href="#cb34-895" aria-hidden="true" tabindex="-1"></a>Apart from <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} and [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5}, all of the other <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones are incompatible with Dec. To find the <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} time difference $\Delta$ between a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone and its closest Dec time zone, convert the offset of the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} and then calculate how much the converted offset changes after rounding it to the nearest <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"}.</span>
<span id="cb34-896"><a href="#cb34-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-897"><a href="#cb34-897" aria-hidden="true" tabindex="-1"></a>$$\Delta = \text{offset} - \lfloor\text{offset} + 0.5\rfloor$$</span>
<span id="cb34-898"><a href="#cb34-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-899"><a href="#cb34-899" aria-hidden="true" tabindex="-1"></a><span class="fu">## Repeating decimal numbers {#rdn .hiddenheading}</span></span>
<span id="cb34-900"><a href="#cb34-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-901"><a href="#cb34-901" aria-hidden="true" tabindex="-1"></a>Dec expresses incompatible offsets as positive or negative fractions or multi-digit integers. <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets are either <span class="co">[</span><span class="ot">repeating</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal)</span> or terminating decimal numbers. Dec displays repeating decimal offsets as fractions and terminating decimal offsets as integers. <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+08:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B08:00)</span>]{.color333}, the most populous <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone, has an offset of <span class="co">[</span><span class="ot">.</span><span class="co">]</span>{.color333}<span class="co">[</span><span class="ot">3</span><span class="co">]</span>{.vinculum} days and is called Zone <span class="co">[</span><span class="ot">1/3</span><span class="co">]</span>{.color333} in Dec. In contrast, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+03:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B03:00)</span>]{.color125} has an offset of <span class="co">[</span><span class="ot">.125</span><span class="co">]</span>{.color125} days and is called Zone <span class="co">[</span><span class="ot">125</span><span class="co">]</span>{.color125} in Dec.</span>
<span id="cb34-902"><a href="#cb34-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-903"><a href="#cb34-903" aria-hidden="true" tabindex="-1"></a>Terminating decimal number offsets can be displayed by Dec provided there is enough space for the additional digits. Dec displays repeating decimal number offsets as fractions. The second most populous <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+05:30</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B05:30)</span>]{.color333}, translates to Zone <span class="co">[</span><span class="ot">55/24</span><span class="co">]</span>{.color55by24} or Zone <span class="co">[</span><span class="ot">2.291</span><span class="co">]</span>{.color55by24}<span class="co">[</span><span class="ot">6</span><span class="co">]</span>{.vinculum} in Dec. The top six most populous <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones all have positive offsets.</span>
<span id="cb34-904"><a href="#cb34-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-905"><a href="#cb34-905" aria-hidden="true" tabindex="-1"></a>When it is midnight (tod=<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}) in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, it is noon (tod=<span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5}) in Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} and the time in every other time zone is equal to it it is \~<span class="co">[</span><span class="ot">5.33</span><span class="co">]</span>{.color533} in Zone <span class="co">[</span><span class="ot">10/3</span><span class="co">]</span>{.color333}, \~<span class="co">[</span><span class="ot">4.29</span><span class="co">]</span>{.color429} in Zone <span class="co">[</span><span class="ot">55/24</span><span class="co">]</span>{.color55by24}, and</span>
<span id="cb34-906"><a href="#cb34-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-907"><a href="#cb34-907" aria-hidden="true" tabindex="-1"></a>To obtain the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} time, we evaluate any Dec time as a math expression, add 10, and then get the remainder after dividing by 10 to make sure the result is less than 10 <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}.</span>
<span id="cb34-908"><a href="#cb34-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-909"><a href="#cb34-909" aria-hidden="true" tabindex="-1"></a>The use of incompatible offsets makes mental calculations involving time zones much harder. Also, incompatible offsets are more difficult to display and read in the format of Dec times. Despite these clear disadvantages, Dec will attempt to parse, process, and display any time zone offset that is provided. Incompatible offset that are repeating decimal numbers can be displayed as fractions, truncated numbers</span>
<span id="cb34-910"><a href="#cb34-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-911"><a href="#cb34-911" aria-hidden="true" tabindex="-1"></a>noon in <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+08:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B08:00)</span>]{.color333} could be written as <span class="co">[</span><span class="ot">5.00</span><span class="co">]</span>{.color5}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">10/3</span><span class="co">]</span>{.color333} or <span class="co">[</span><span class="ot">5.00</span><span class="co">]</span>{.color5}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{style="font-family:monospace;"}<span class="co">[</span><span class="ot">3.</span><span class="co">]</span>{.color333}<span class="co">[</span><span class="ot">3</span><span class="co">]</span>{.vinculum}.</span>
<span id="cb34-912"><a href="#cb34-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-913"><a href="#cb34-913" aria-hidden="true" tabindex="-1"></a>Dec does not set a hard limit on the number of time zones, but negative time zones offsets to improve its compability with <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}.</span>
<span id="cb34-914"><a href="#cb34-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-915"><a href="#cb34-915" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb34-916"><a href="#cb34-916" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bad Pun Alert</span></span>
<span id="cb34-917"><a href="#cb34-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-918"><a href="#cb34-918" aria-hidden="true" tabindex="-1"></a>Sorry if reading this takes a long ***time***; I hope you don‚Äôt ***zone*** out!</span>
<span id="cb34-919"><a href="#cb34-919" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-920"><a href="#cb34-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-921"><a href="#cb34-921" aria-hidden="true" tabindex="-1"></a>If a Dec time zone offset is not specified, we can detected a time zone using Whether or not negative time zones offsets are worth the trouble is a matter of that the offer little to no benefit. The <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">-12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude)</span>]{.color5} and [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} time zones and the Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} and <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5} Dec time zones all have the same time, but their dates do not match, because <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">-12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude)</span>]{.color5} and Zone <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5} are one day behind <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} and Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5}. Dec discourages the use of time zones with negative offsets.</span>
<span id="cb34-922"><a href="#cb34-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-925"><a href="#cb34-925" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-926"><a href="#cb34-926" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb34-927"><a href="#cb34-927" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: timezonepoptoggles</span></span>
<span id="cb34-928"><a href="#cb34-928" aria-hidden="true" tabindex="-1"></a><span class="co">//| class: /togs</span></span>
<span id="cb34-929"><a href="#cb34-929" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb34-930"><a href="#cb34-930" aria-hidden="true" tabindex="-1"></a>viewof sortParams <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb34-931"><a href="#cb34-931" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort ascending"</span> })<span class="op">,</span></span>
<span id="cb34-932"><a href="#cb34-932" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort by offset"</span> })<span class="op">,</span></span>
<span id="cb34-933"><a href="#cb34-933" aria-hidden="true" tabindex="-1"></a>  ])</span>
<span id="cb34-934"><a href="#cb34-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-935"><a href="#cb34-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-938"><a href="#cb34-938" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-939"><a href="#cb34-939" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb34-940"><a href="#cb34-940" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: timezonepopstackedbar</span></span>
<span id="cb34-941"><a href="#cb34-941" aria-hidden="true" tabindex="-1"></a><span class="co">//| class: stackedBar</span></span>
<span id="cb34-942"><a href="#cb34-942" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb34-943"><a href="#cb34-943" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb34-944"><a href="#cb34-944" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> width<span class="op">,</span></span>
<span id="cb34-945"><a href="#cb34-945" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb34-946"><a href="#cb34-946" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> <span class="vs">`overflow: visible;font-size:16px;`</span><span class="op">,</span></span>
<span id="cb34-947"><a href="#cb34-947" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {<span class="dt">scheme</span><span class="op">:</span> <span class="st">"RdBu"</span><span class="op">,</span> <span class="dt">className</span><span class="op">:</span> <span class="st">"barPlotLegend"</span>}<span class="op">,</span></span>
<span id="cb34-948"><a href="#cb34-948" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">75</span><span class="op">,</span></span>
<span id="cb34-949"><a href="#cb34-949" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span> }<span class="op">,</span></span>
<span id="cb34-950"><a href="#cb34-950" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Population (billions)"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">38</span><span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> d <span class="kw">=&gt;</span> d <span class="op">/</span> <span class="fl">1e9</span> }<span class="op">,</span></span>
<span id="cb34-951"><a href="#cb34-951" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb34-952"><a href="#cb34-952" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barX</span>(sortedPop<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"pop"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Sign"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"Offset"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">tip</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">,</span></span>
<span id="cb34-953"><a href="#cb34-953" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb34-954"><a href="#cb34-954" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-955"><a href="#cb34-955" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-956"><a href="#cb34-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-957"><a href="#cb34-957" aria-hidden="true" tabindex="-1"></a><span class="fu"># Coordinated Universal Time (UTC) {#utc}</span></span>
<span id="cb34-958"><a href="#cb34-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-959"><a href="#cb34-959" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">-12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude)</span>]{.color5} time zone contains only <span class="co">[</span><span class="ot">strict nature reserves</span><span class="co">](https://en.wikipedia.org/wiki/Strict_nature_reserve#:~:text=the%20highest%20category%20of%20protected%20area%20recognised%20by%20the%20World%20Commission%20on%20Protected%20Areas)</span> and thus does not have any inhabited territory.</span>
<span id="cb34-960"><a href="#cb34-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-961"><a href="#cb34-961" aria-hidden="true" tabindex="-1"></a>The remaining UTC time zones with negative offsets</span>
<span id="cb34-962"><a href="#cb34-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-963"><a href="#cb34-963" aria-hidden="true" tabindex="-1"></a>If we disregard leap seconds, the [<span class="co">[</span><span class="ot">+00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone is synchronized with UNIX time and the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} Dec time zone. The [<span class="co">[</span><span class="ot">+12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} and [<span class="co">[</span><span class="ot">-12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00)</span>]{.color5} <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets have the same time but their dates are one day apart.</span>
<span id="cb34-964"><a href="#cb34-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-965"><a href="#cb34-965" aria-hidden="true" tabindex="-1"></a>We can honor this difference by translating [<span class="co">[</span><span class="ot">+12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} compatible <span class="co">[</span><span class="ot">37 [UTC]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets)</span>, only 3 are integers after they are converted to time zones. Conversion between Dec time zones and UTC offsets is inexact, because UTC offsets depend on geographic and political boundaries, whereas Dec time zones are determined solely by longitude.</span>
<span id="cb34-966"><a href="#cb34-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-967"><a href="#cb34-967" aria-hidden="true" tabindex="-1"></a>because UNIX time, [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0}, and Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} are all synchronized.</span>
<span id="cb34-968"><a href="#cb34-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-969"><a href="#cb34-969" aria-hidden="true" tabindex="-1"></a>Similarly, a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet yields a Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"}.</span>
<span id="cb34-970"><a href="#cb34-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-971"><a href="#cb34-971" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}</span>
<span id="cb34-972"><a href="#cb34-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-973"><a href="#cb34-973" aria-hidden="true" tabindex="-1"></a>Instead of passing an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) to the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} equation separately, we can subtract the offset from the triplet to produce a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet. In other words, we can avoid converting time zone offsets if we always first shift the input <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet to [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.color0}.</span>
<span id="cb34-974"><a href="#cb34-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-975"><a href="#cb34-975" aria-hidden="true" tabindex="-1"></a>To obtain the Zone 0 time, we evaluate a Dec time as a math expression, add 10, and get the remainder after dividing by 10 to make sure the result is less than 10 <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}: (<span class="co">[</span><span class="ot">\${browserTime.toFixed(4)}</span><span class="co">]</span>{.cyan} \${browserSign} <span class="co">[</span><span class="ot">\${Math.abs(browserZone)}</span><span class="co">]</span>{.lime} + 10) <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 10 = <span class="co">[</span><span class="ot">\${zone0time.toFixed(4)}</span><span class="co">]</span>{.cyan}.</span>
<span id="cb34-976"><a href="#cb34-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-977"><a href="#cb34-977" aria-hidden="true" tabindex="-1"></a>Instead of passing both a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplets and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) to the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"} equation.</span>
<span id="cb34-978"><a href="#cb34-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-979"><a href="#cb34-979" aria-hidden="true" tabindex="-1"></a>Instead of performing this calculation on both a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place), we should subtract the offset from the triplet.</span>
<span id="cb34-980"><a href="#cb34-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-981"><a href="#cb34-981" aria-hidden="true" tabindex="-1"></a>equation should be a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet so that we do not have to convert a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) to <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}.</span>
<span id="cb34-982"><a href="#cb34-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-983"><a href="#cb34-983" aria-hidden="true" tabindex="-1"></a>When we add a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offset to a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet, with the resulting [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} time.</span>
<span id="cb34-984"><a href="#cb34-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-985"><a href="#cb34-985" aria-hidden="true" tabindex="-1"></a>The time in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} matches UTC time with the [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} offset. UNIX time and three <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets are called [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0}, [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5}, and [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">-12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00)</span>]{.color5}. Starting with a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet results in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time-of-day"}.</span>
<span id="cb34-986"><a href="#cb34-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-987"><a href="#cb34-987" aria-hidden="true" tabindex="-1"></a>only three out of the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones are synchronized with a Dec time zone it will most likely be easier to shift the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour-minute-second"} triplet to will result in days instead of decidays if we divide by the most Dec and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones are not aligned. Whereas UNIX time is always synchronized with Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} and <span class="co">[</span><span class="ot">UTC[+00:00]{.color0}</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>, This method ensure that the result matches</span>
<span id="cb34-988"><a href="#cb34-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-989"><a href="#cb34-989" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">UTC time zone offsets</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place)</span>
<span id="cb34-990"><a href="#cb34-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-991"><a href="#cb34-991" aria-hidden="true" tabindex="-1"></a>Drag the red‚≠ïÔ∏ècircle across the <span class="co">[</span><span class="ot">meridians</span><span class="co">](https://en.wikipedia.org/wiki/Meridian_%28geography%29#:~:text=words%2C%20it%20is-,a%20line%20of%20longitude,-.%20The%20position%20of)</span> (vertical‚Üïgray lines) on the mapüó∫Ô∏èto see how changing time zones affects the time. Only the first digit of the Dec times shown above, the <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"}, varies across time zones, because the 10 Dec time zones, numbered 0 through 9 on the mapüó∫Ô∏è, are each 1 <span class="co">[</span><span class="ot">deci[turn](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a turn"} (<span class="co">[</span><span class="ot">dt</span><span class="co">](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn)</span>) wide. Simply put, a <span class="co">[</span><span class="ot">deciturn</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a turn"} of longitude translates into a <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} of time.</span>
<span id="cb34-992"><a href="#cb34-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-993"><a href="#cb34-993" aria-hidden="true" tabindex="-1"></a>The leftmost vertical‚Üïline on the mapüó∫Ô∏èis <span class="co">[</span><span class="ot">Meridian 0</span><span class="co">](https://en.wikipedia.org/wiki/18th_meridian_west#:~:text=a%20line%20of%20longitude%20that%20extends%20from%20the%20North%20Pole%20across%20the%20Arctic%20Ocean%2C%20Greenland%2C%20Iceland%2C%20the%20Atlantic%20Ocean%2C%20the%20Canary%20Islands%2C%20the%20Southern%20Ocean%2C%20and%20Antarctica%20to%20the%20South%20Pole)</span>, the Dec <span class="co">[</span><span class="ot">International Date Line</span><span class="co">](https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next)</span> and <span class="co">[</span><span class="ot">prime meridian</span><span class="co">](https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0)</span>, which cuts across the Atlantic Ocean through IcelandüáÆüá∏just West of Africaüåçand is the boundary between Zone 9 and Zone 0, the rightmost and leftmost Dec time zones on the mapüó∫Ô∏è, respectively. Arranging Dec time zones from 0 to 9 yields a <span class="co">[</span><span class="ot">Pacific-centric</span><span class="co">]</span>(https://en.wikipedia.org/wiki/World_map#:~:text=south%2Dup%20map-,Pacific%2Dcentric%20map,-(more%20commonly%20used)) mapüó∫Ô∏è.</span>
<span id="cb34-994"><a href="#cb34-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-995"><a href="#cb34-995" aria-hidden="true" tabindex="-1"></a>While only positive Dec time zones are shown on the mapüó∫Ô∏è, every Dec time zone can also be expressed as a negative number. Each pair of time zone numbers produces the same Dec time, but result in <span class="co">[</span><span class="ot">Dec dates</span><span class="co">](/dec/date)</span>üóìÔ∏èthat are 1 day apart. Negative time zone numbers can be useful for getting <span class="co">[</span><span class="ot">Dec dates</span><span class="co">](/dec/date)</span>üóìÔ∏èto match <span class="co">[</span><span class="ot">Gregorian calendar</span><span class="co">](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)</span> datesüóìÔ∏èwith negative <span class="co">[</span><span class="ot">UTC offsets</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place).</span>
<span id="cb34-996"><a href="#cb34-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-997"><a href="#cb34-997" aria-hidden="true" tabindex="-1"></a>If you know your longitude in degrees (¬∞) or <span class="co">[</span><span class="ot">centi[turns](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundredths of a turn"} (<span class="co">[</span><span class="ot">ct</span><span class="co">](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn)</span>), you can look up your Dec time zone (TZ) in the table below.</span>
<span id="cb34-998"><a href="#cb34-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-999"><a href="#cb34-999" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> TZ<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>+ <span class="pp">|</span> TZ<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>- <span class="pp">|</span> Start<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>¬∞ <span class="pp">|</span> Mid<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>¬∞ <span class="pp">|</span> End<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>¬∞ <span class="pp">|</span> Start<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>$ct$ <span class="pp">|</span> Mid<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>$ct$ <span class="pp">|</span> End<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>$ct$ <span class="pp">|</span></span>
<span id="cb34-1000"><a href="#cb34-1000" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|</span></span>
<span id="cb34-1001"><a href="#cb34-1001" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 9 <span class="pp">|</span> -1 <span class="pp">|</span> -54 <span class="pp">|</span> -36 <span class="pp">|</span> -18 <span class="pp">|</span> 90 <span class="pp">|</span> 95 <span class="pp">|</span> 100 <span class="pp">|</span></span>
<span id="cb34-1002"><a href="#cb34-1002" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 8 <span class="pp">|</span> -2 <span class="pp">|</span> -90 <span class="pp">|</span> -72 <span class="pp">|</span> -54 <span class="pp">|</span> 80 <span class="pp">|</span> 85 <span class="pp">|</span> 90 <span class="pp">|</span></span>
<span id="cb34-1003"><a href="#cb34-1003" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 7 <span class="pp">|</span> -3 <span class="pp">|</span> -126 <span class="pp">|</span> -108 <span class="pp">|</span> -90 <span class="pp">|</span> 70 <span class="pp">|</span> 75 <span class="pp">|</span> 80 <span class="pp">|</span></span>
<span id="cb34-1004"><a href="#cb34-1004" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 6 <span class="pp">|</span> -4 <span class="pp">|</span> -162 <span class="pp">|</span> -144 <span class="pp">|</span> -126 <span class="pp">|</span> 60 <span class="pp">|</span> 65 <span class="pp">|</span> 70 <span class="pp">|</span></span>
<span id="cb34-1005"><a href="#cb34-1005" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5 <span class="pp">|</span> -5 <span class="pp">|</span> 162 <span class="pp">|</span> 180 <span class="pp">|</span> -162 <span class="pp">|</span> 50 <span class="pp">|</span> 55 <span class="pp">|</span> 60 <span class="pp">|</span></span>
<span id="cb34-1006"><a href="#cb34-1006" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4 <span class="pp">|</span> -6 <span class="pp">|</span> 126 <span class="pp">|</span> 144 <span class="pp">|</span> 162 <span class="pp">|</span> 40 <span class="pp">|</span> 45 <span class="pp">|</span> 50 <span class="pp">|</span></span>
<span id="cb34-1007"><a href="#cb34-1007" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3 <span class="pp">|</span> -7 <span class="pp">|</span> 90 <span class="pp">|</span> 108 <span class="pp">|</span> 126 <span class="pp">|</span> 30 <span class="pp">|</span> 35 <span class="pp">|</span> 40 <span class="pp">|</span></span>
<span id="cb34-1008"><a href="#cb34-1008" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2 <span class="pp">|</span> -8 <span class="pp">|</span> 54 <span class="pp">|</span> 72 <span class="pp">|</span> 90 <span class="pp">|</span> 20 <span class="pp">|</span> 25 <span class="pp">|</span> 30 <span class="pp">|</span></span>
<span id="cb34-1009"><a href="#cb34-1009" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1 <span class="pp">|</span> -9 <span class="pp">|</span> 18 <span class="pp">|</span> 36 <span class="pp">|</span> 54 <span class="pp">|</span> 10 <span class="pp">|</span> 15 <span class="pp">|</span> 20 <span class="pp">|</span></span>
<span id="cb34-1010"><a href="#cb34-1010" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0 <span class="pp">|</span> -10 <span class="pp">|</span> -18 <span class="pp">|</span> 0 <span class="pp">|</span> 18 <span class="pp">|</span> 0 <span class="pp">|</span> 5 <span class="pp">|</span> 10 <span class="pp">|</span></span>
<span id="cb34-1011"><a href="#cb34-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1012"><a href="#cb34-1012" aria-hidden="true" tabindex="-1"></a>Dec times in Zone 0 and 5 can be directly converted to and from UTC times with an offset of 0 and 12 <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}, respectively. The other Dec time zones</span>
<span id="cb34-1013"><a href="#cb34-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1014"><a href="#cb34-1014" aria-hidden="true" tabindex="-1"></a><span class="fu"># Unit</span></span>
<span id="cb34-1015"><a href="#cb34-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1016"><a href="#cb34-1016" aria-hidden="true" tabindex="-1"></a>Dec uses <span class="co">[</span><span class="ot">metric prefixes</span><span class="co">](https://en.wikipedia.org/wiki/Metric_prefix#:~:text=a%20unit%20prefix%20that%20precedes%20a%20basic%20unit%20of%20measure%20to%20indicate%20a%20multiple%20or%20submultiple%20of%20the%20unit)</span> to create <span class="co">[</span><span class="ot">submultiples</span><span class="co">](https://en.wikipedia.org/wiki/Multiple_%28mathematics%29#Submultiple:~:text=of%20%22a%20being-,a%20unit%20fraction,-of%20b%22%20)</span> of a day that can naturally be combined together into a single <span class="co">[</span><span class="ot">decimal</span><span class="co">](https://en.wikipedia.org/wiki/Decimal#:~:text=system%20for%20denoting%20integer%20and%20non%2Dinteger%20numbers)</span> number. Conversion between decimal units is as simple as moving‚ÜîÔ∏éÔ∏èor removing‚ùåthe <span class="co">[</span><span class="ot">decimal separator</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_separator#:~:text=a%20symbol%20that%20separates%20the%20integer%20part%20from%20the%20fractional%20part%20of%20a%20number)</span>. In contrast, an <span class="co">[</span><span class="ot">hh</span><span class="co">]</span>{.teal}:<span class="co">[</span><span class="ot">mm</span><span class="co">]</span>{.olive}:<span class="co">[</span><span class="ot">ss</span><span class="co">]</span>{.purple} time is a <span class="co">[</span><span class="ot">mixed-radix</span><span class="co">](https://en.wikipedia.org/wiki/Mixed_radix#:~:text=non%2Dstandard%20positional%20numeral%20systems%20in%20which%20the%20numerical%20base%20varies%20from%20position%20to%20position)</span> number, where <span class="co">[</span><span class="ot">hh</span><span class="co">]</span>{.teal} is the <span class="co">[</span><span class="ot">base-12</span><span class="co">](https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=12-,Duodecimal,-%2C%20dozenal)</span> or <span class="co">[</span><span class="ot">base-24</span><span class="co">](https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=24-,Quadravigesimal,-%5B48%5D)</span> <span class="co">[</span><span class="ot">hour</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">mm</span><span class="co">]</span>{.olive} is the <span class="co">[</span><span class="ot">base-60</span><span class="co">](https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=60-,Sexagesimal,-Babylonian%20numerals%20and)</span> <span class="co">[</span><span class="ot">minute</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">ss</span><span class="co">]</span>{.purple} is the base-60 <span class="co">[</span><span class="ot">second</span><span class="co">]</span>{.purple}.</span>
<span id="cb34-1017"><a href="#cb34-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1018"><a href="#cb34-1018" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Prefix <span class="pp">|</span> Power <span class="pp">|</span> Day <span class="pp">|</span> <span class="co">[</span><span class="ot">hh</span><span class="co">]</span>{.teal}:<span class="co">[</span><span class="ot">mm</span><span class="co">]</span>{.olive}:<span class="co">[</span><span class="ot">ss</span><span class="co">]</span>{.purple}.<span class="co">[</span><span class="ot">sss</span><span class="co">]</span>{.purple} <span class="pp">|</span></span>
<span id="cb34-1019"><a href="#cb34-1019" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------------------|---------------|---------------|-----------------------|</span></span>
<span id="cb34-1020"><a href="#cb34-1020" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>  <span class="pp">|</span> 0 <span class="pp">|</span> 1 <span class="pp">|</span> 24<span class="sc">:00:</span>00.000 <span class="pp">|</span></span>
<span id="cb34-1021"><a href="#cb34-1021" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> deci <span class="pp">|</span> -1 <span class="pp">|</span> .1 <span class="pp">|</span> 02<span class="sc">:24:</span>00.000 <span class="pp">|</span></span>
<span id="cb34-1022"><a href="#cb34-1022" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> centi <span class="pp">|</span> -2 <span class="pp">|</span> .01 <span class="pp">|</span> 00<span class="sc">:14:</span>24.000 <span class="pp">|</span></span>
<span id="cb34-1023"><a href="#cb34-1023" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> milli <span class="pp">|</span> -3 <span class="pp">|</span> .001 <span class="pp">|</span> 00<span class="sc">:01:</span>26.400 <span class="pp">|</span></span>
<span id="cb34-1024"><a href="#cb34-1024" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> decimilli <span class="pp">|</span> -4 <span class="pp">|</span> .0001 <span class="pp">|</span> 00<span class="sc">:00:</span>08.640 <span class="pp">|</span></span>
<span id="cb34-1025"><a href="#cb34-1025" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> centimilli <span class="pp">|</span> -5 <span class="pp">|</span> .00001 <span class="pp">|</span> 00<span class="sc">:00:</span>00.864 <span class="pp">|</span></span>
<span id="cb34-1026"><a href="#cb34-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1027"><a href="#cb34-1027" aria-hidden="true" tabindex="-1"></a>To convert the <span class="co">[</span><span class="ot">hour</span><span class="co">]</span>{.teal} <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">minute</span><span class="co">]</span>{.olive} <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">second</span><span class="co">]</span>{.purple} <span class="co">[</span><span class="ot">s</span><span class="co">]</span>{.purple} into the <span class="co">[</span><span class="ot">deciday</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan}, Dec uses the following equation: <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan} = <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal} √∑ 2.4 + <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive} √∑ 144 + <span class="co">[</span><span class="ot">s</span><span class="co">]</span>{.purple} √∑ 8640. The current equation values in Zone <span class="co">[</span><span class="ot">\${browserZone}</span><span class="co">]</span>{.lime} are: <span class="co">[</span><span class="ot">\${browserTime.toFixed(4)}</span><span class="co">]</span>{.cyan} = <span class="co">[</span><span class="ot">\${Math.floor(hours).toString().padStart(2, "0")}</span><span class="co">]</span>{.teal} √∑ 2.4 + <span class="co">[</span><span class="ot">\${Math.floor(minutes).toString().padStart(2, "0")}</span><span class="co">]</span>{.olive} √∑ 144 + <span class="co">[</span><span class="ot">\${Math.floor(seconds).toString().padStart(2, "0")}</span><span class="co">]</span>{.purple} √∑ 8640. Inversely, we can convert <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} into <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}: <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal} = <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan} √ó 2.4, <span class="co">[</span><span class="ot">minutes</span><span class="co">]</span>{.olive}: <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive} = <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal} <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 √ó 60, and <span class="co">[</span><span class="ot">seconds</span><span class="co">]</span>{.purple}: <span class="co">[</span><span class="ot">s</span><span class="co">]</span>{.purple} = <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive} <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 √ó 60.</span>
<span id="cb34-1028"><a href="#cb34-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1029"><a href="#cb34-1029" aria-hidden="true" tabindex="-1"></a>Instead of dealing with <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">minutes</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">seconds</span><span class="co">]</span>{.purple}, we can convert the <span class="co">[</span><span class="ot">UNIX timestamp</span><span class="co">](https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970)</span> <span class="co">[</span><span class="ot">u</span><span class="co">]</span>{.purple} into the Dec time <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan}+<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.lime}. First, we divide <span class="co">[</span><span class="ot">u</span><span class="co">]</span>{.purple} by 86400 to convert seconds to days, then isolate the <span class="co">[</span><span class="ot">decimal part</span><span class="co">](https://en.wikipedia.org/wiki/Fractional_part#:~:text=the%20excess%20beyond%20that%20number%27s%20integer%20part)</span> of the <span class="co">[</span><span class="ot">quotient</span><span class="co">](https://en.wikipedia.org/wiki/Quotient#:~:text=a%20quantity%20produced%20by%20the%20division%20of%20two%20numbers)</span>, and finally multiply by 10: <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan} + <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.lime} = <span class="co">[</span><span class="ot">u</span><span class="co">]</span>{.purple} √∑ 86400 <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 √ó 10. The current values in this equation are <span class="co">[</span><span class="ot">\${browserTime.toFixed(4)}</span><span class="co">]</span>{.cyan} + <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.lime} = <span class="co">[</span><span class="ot">\${Math.floor(now / 1000)}</span><span class="co">]</span>{.purple} √∑ 86400 <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 √ó 10.</span>
<span id="cb34-1030"><a href="#cb34-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1031"><a href="#cb34-1031" aria-hidden="true" tabindex="-1"></a>The concept of measuring time in decimal days is not novel. In the late 1700s, the <span class="co">[</span><span class="ot">French Republican calendar</span><span class="co">](https://en.wikipedia.org/wiki/French_Republican_calendar#:~:text=a%20calendar%20created%20and%20implemented%20during%20the%20French%20Revolution)</span> time system referred to <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} as decimal <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">centidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundredths of a day"} as <span class="co">[</span><span class="ot">d√©cimes</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=into%20tenths%2C%20or-,d%C3%A9cimes,-%2C%20instead%20of%20minutes)</span>, <span class="co">[</span><span class="ot">millidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="thousandths of a day"} as decimal <span class="co">[</span><span class="ot">minutes</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">centimillidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day"} as decimal <span class="co">[</span><span class="ot">seconds</span><span class="co">]</span>{.purple}. Similarly, <span class="co">[</span><span class="ot">Swatch Internet Time</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#:~:text=a%20decimal%20time%20system%20introduced%20in%201998%20by%20the%20Swatch%20corporation)</span>, a <span class="co">[</span><span class="ot">decimal time</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=the%20representation%20of%20the%20time%20of%20day%20using%20units%20which%20are%20decimally%20related)</span> system introduced in 1998, uses the term ".beats" for <span class="co">[</span><span class="ot">millidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="thousandths of a day"}.</span>
<span id="cb34-1032"><a href="#cb34-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1033"><a href="#cb34-1033" aria-hidden="true" tabindex="-1"></a>Swatch Internet Time differs from Dec in that it <span class="co">[</span><span class="ot">has no time zones</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=There%20are%20no%20time%20zones%20in%20Swatch%20Internet%20Time)</span> and is obtained from the [<span class="co">[</span><span class="ot">hours</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1)</span>]{.teal}<span class="co">[</span><span class="ot">, [minutes]{.olive}, and [seconds]{.purple}</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1)</span> of <span class="co">[</span><span class="ot">UTC+01:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B01:00#:~:text=a%20time%20offset%20from%20UTC%20of%20%2B01%3A00)</span>. In contrast, the major innovations described in this article are the Dec time zone system and the simple equation for obtaining the Dec time in Zone 0 from a UNIX timestamp, but Dec has much more to offer than <span class="co">[</span><span class="ot">deciday</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} times and zones.</span>
<span id="cb34-1034"><a href="#cb34-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1035"><a href="#cb34-1035" aria-hidden="true" tabindex="-1"></a><span class="fu"># Next</span></span>
<span id="cb34-1036"><a href="#cb34-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1037"><a href="#cb34-1037" aria-hidden="true" tabindex="-1"></a>The next article in the <span class="co">[</span><span class="ot">Dec section</span><span class="co">](/dec)</span> of my site compares Dec to the <span class="co">[</span><span class="ot">ISO 8601</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#:~:text=an%20international%20standard%20covering%20the%20worldwide%20exchange%20and%20communication%20of%20date%20and%20time%2Drelated%20data)</span> international standard for dates and times. Like ISO 8601, Dec allows for <span class="co">[</span><span class="ot">combined date and time representations</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations)</span> that can be paired up to express <span class="co">[</span><span class="ot">time intervals</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Time_intervals:~:text=the%20intervening%20time%20between%20two%20time%20points)</span>. In Dec, the combination of a date and time is called a snapü´∞and a time interval expressed as a pair of snaps is called a spanüåà.</span>
<span id="cb34-1038"><a href="#cb34-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1039"><a href="#cb34-1039" aria-hidden="true" tabindex="-1"></a>My <span class="co">[</span><span class="ot">ISO 8601 article</span><span class="co">](/dec/iso)</span> is unique because it avoids the use of Observable in favor of leveraging <span class="co">[</span><span class="ot">Jupyter</span><span class="co">](https://jupyter.org)</span> support in Quarto to make the code underlying Dec available in multiple programming languages. Observable is a great visualization tool but does not translate well into Jupyter notebooks. After the next article, I return to the use of Observable in my Dec <span class="co">[</span><span class="ot">snap</span><span class="co">](/dec/span)</span>ü´∞and <span class="co">[</span><span class="ot">span</span><span class="co">](/dec/span)</span>üåàarticles.</span>
<span id="cb34-1040"><a href="#cb34-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1041"><a href="#cb34-1041" aria-hidden="true" tabindex="-1"></a>::: {#timenav}</span>
<span id="cb34-1042"><a href="#cb34-1042" aria-hidden="true" tabindex="-1"></a>{{&lt; include /asset/_decnav.qmd &gt;}}</span>
<span id="cb34-1043"><a href="#cb34-1043" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb34-1044"><a href="#cb34-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1045"><a href="#cb34-1045" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cite</span></span>
<span id="cb34-1046"><a href="#cb34-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1047"><a href="#cb34-1047" aria-hidden="true" tabindex="-1"></a>Please spread the good word about Dec using the citation information at the bottom of this article. You may also want to cite the Observable notebooks that I adapted into the clocküïì, barüìächart, mapüó∫Ô∏è, and daylight‚òÄÔ∏èplot visualizations in this article or the 2014 blog post which proposed a system of 20 decimal time zones, each 5 <span class="co">[</span><span class="ot">centidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundredths of a day"} wide, based on the <span class="co">[</span><span class="ot">Greenwich Meridian</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Prime_meridian_(Greenwich)#:~:text=a%20geographical%20reference%20line%20that%20passes%20through%20the%20Royal%20Observatory%2C%20Greenwich%2C%20in%20London%2C%20England):</span>
<span id="cb34-1048"><a href="#cb34-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1049"><a href="#cb34-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Pearson, Tom</span><span class="co">](https://www.2x2.graphics)</span>. [<span class="co">[</span><span class="ot">2013</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[124]{.cyan}</span><span class="co">]</span>{.underline}. ‚ÄúSimple D3 clock.‚Äù <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@d3/simple-clock</span><span class="co">](https://observablehq.com/@d3/simple-clock)</span>{.uri}.</span>
<span id="cb34-1050"><a href="#cb34-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Heyen, Frank</span><span class="co">](https://fheyen.github.io)</span>. [<span class="co">[</span><span class="ot">2021</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[246]{.cyan}</span><span class="co">]</span>{.underline}. ‚ÄúBarChart Clock.‚Äù <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@fheyen/barchart-clock</span><span class="co">](https://observablehq.com/@fheyen/barchart-clock)</span>{.uri}.</span>
<span id="cb34-1051"><a href="#cb34-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Johnson, Ian</span><span class="co">](https://enjalot.github.io)</span>. [<span class="co">[</span><span class="ot">2021</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[090]{.cyan}</span><span class="co">]</span>{.underline}. ‚ÄúDraggable World Map Coordinates Input.‚Äù <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@enjalot/draggable-world-map-coordinates-input</span><span class="co">](https://observablehq.com/@enjalot/draggable-world-map-coordinates-input)</span>{.uri}.</span>
<span id="cb34-1052"><a href="#cb34-1052" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Bridges, Dan</span><span class="co">](https://www.danbridges.org)</span>. [<span class="co">[</span><span class="ot">2021</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[311]{.cyan}</span><span class="co">]</span>{.underline}. ‚ÄúVisualizing Seasonal Daylight.‚Äù <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@dbridges/visualizing-seasonal-daylight</span><span class="co">](https://observablehq.com/@dbridges/visualizing-seasonal-daylight)</span>{.uri}.</span>
<span id="cb34-1053"><a href="#cb34-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Clements, John</span><span class="co">](https://www.brinckerhoff.org)</span>. [<span class="co">[</span><span class="ot">2014</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[091]{.cyan}</span><span class="co">]</span>{.underline}, ‚ÄúDecimal Time Zones.‚Äù <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="ot">&lt;https://www.brinckerhoff.org/blog/2014/05/31/decimal-time-zones&gt;</span>.</span>
<span id="cb34-1054"><a href="#cb34-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1057"><a href="#cb34-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-1058"><a href="#cb34-1058" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb34-1059"><a href="#cb34-1059" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: false</span></span>
<span id="cb34-1060"><a href="#cb34-1060" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb34-1061"><a href="#cb34-1061" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [(unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> (</span>
<span id="cb34-1062"><a href="#cb34-1062" aria-hidden="true" tabindex="-1"></a>    zone <span class="op">=</span> zone <span class="op">??</span> <span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb34-1063"><a href="#cb34-1063" aria-hidden="true" tabindex="-1"></a>      (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)</span>
<span id="cb34-1064"><a href="#cb34-1064" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb34-1065"><a href="#cb34-1065" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1066"><a href="#cb34-1066" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote1</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb34-1067"><a href="#cb34-1067" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb34-1068"><a href="#cb34-1068" aria-hidden="true" tabindex="-1"></a>    (unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span></span>
<span id="cb34-1069"><a href="#cb34-1069" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> (zone <span class="op">=</span> zone <span class="op">??</span> (<span class="dv">10</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb34-1070"><a href="#cb34-1070" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb34-1071"><a href="#cb34-1071" aria-hidden="true" tabindex="-1"></a>      ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb34-1072"><a href="#cb34-1072" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1073"><a href="#cb34-1073" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2date</span>(dote<span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb34-1074"><a href="#cb34-1074" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cote <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((</span>
<span id="cb34-1075"><a href="#cb34-1075" aria-hidden="true" tabindex="-1"></a>      dote <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> dote</span>
<span id="cb34-1076"><a href="#cb34-1076" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> dote <span class="op">-</span> <span class="dv">146096</span></span>
<span id="cb34-1077"><a href="#cb34-1077" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb34-1078"><a href="#cb34-1078" aria-hidden="true" tabindex="-1"></a>  dotc <span class="op">=</span> dote <span class="op">-</span> cote <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb34-1079"><a href="#cb34-1079" aria-hidden="true" tabindex="-1"></a>  yotc <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dotc</span>
<span id="cb34-1080"><a href="#cb34-1080" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>)</span>
<span id="cb34-1081"><a href="#cb34-1081" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>)</span>
<span id="cb34-1082"><a href="#cb34-1082" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)</span>
<span id="cb34-1083"><a href="#cb34-1083" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">/</span> <span class="dv">365</span>)<span class="op">;</span></span>
<span id="cb34-1084"><a href="#cb34-1084" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb34-1085"><a href="#cb34-1085" aria-hidden="true" tabindex="-1"></a>    yotc <span class="op">+</span> cote <span class="op">*</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb34-1086"><a href="#cb34-1086" aria-hidden="true" tabindex="-1"></a>    dotc <span class="op">-</span> (yotc <span class="op">*</span> <span class="dv">365</span></span>
<span id="cb34-1087"><a href="#cb34-1087" aria-hidden="true" tabindex="-1"></a>      <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">4</span>)</span>
<span id="cb34-1088"><a href="#cb34-1088" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1089"><a href="#cb34-1089" aria-hidden="true" tabindex="-1"></a>  )<span class="op">,</span> zone]}</span>
<span id="cb34-1090"><a href="#cb34-1090" aria-hidden="true" tabindex="-1"></a>dz <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb34-1091"><a href="#cb34-1091" aria-hidden="true" tabindex="-1"></a>decYear <span class="op">=</span> ydz[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span>)</span>
<span id="cb34-1092"><a href="#cb34-1092" aria-hidden="true" tabindex="-1"></a>zeroDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="dv">0</span>)[<span class="dv">0</span>]</span>
<span id="cb34-1093"><a href="#cb34-1093" aria-hidden="true" tabindex="-1"></a>zeroTime <span class="op">=</span> zeroDote <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb34-1094"><a href="#cb34-1094" aria-hidden="true" tabindex="-1"></a>zeroDate <span class="op">=</span> <span class="fu">dote2date</span>(zeroDote)</span>
<span id="cb34-1095"><a href="#cb34-1095" aria-hidden="true" tabindex="-1"></a>zeroYear <span class="op">=</span> zeroDate[<span class="dv">0</span>]</span>
<span id="cb34-1096"><a href="#cb34-1096" aria-hidden="true" tabindex="-1"></a>zeroDoty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(zeroDate[<span class="dv">1</span>])</span>
<span id="cb34-1097"><a href="#cb34-1097" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1098"><a href="#cb34-1098" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1099"><a href="#cb34-1099" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl2 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1100"><a href="#cb34-1100" aria-hidden="true" tabindex="-1"></a>zeroDotyHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroDoty<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroDoty <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> zeroIsLeap)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1101"><a href="#cb34-1101" aria-hidden="true" tabindex="-1"></a>zeroYearHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroYear<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroYear <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1102"><a href="#cb34-1102" aria-hidden="true" tabindex="-1"></a>zeroIsLeap <span class="op">=</span> zeroYear <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> zeroYear <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> zeroYear <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-1103"><a href="#cb34-1103" aria-hidden="true" tabindex="-1"></a>browserDote <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb34-1104"><a href="#cb34-1104" aria-hidden="true" tabindex="-1"></a>browserTime <span class="op">=</span> browserDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb34-1105"><a href="#cb34-1105" aria-hidden="true" tabindex="-1"></a>browserZone <span class="op">=</span> browserDote[<span class="dv">1</span>]</span>
<span id="cb34-1106"><a href="#cb34-1106" aria-hidden="true" tabindex="-1"></a>browserSign <span class="op">=</span> browserZone <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb34-1107"><a href="#cb34-1107" aria-hidden="true" tabindex="-1"></a>zone0time <span class="op">=</span> (browserTime <span class="op">-</span> browserZone <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb34-1108"><a href="#cb34-1108" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> browserTime <span class="op">*</span> <span class="fl">2.4</span></span>
<span id="cb34-1109"><a href="#cb34-1109" aria-hidden="true" tabindex="-1"></a>minutes <span class="op">=</span> hours <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb34-1110"><a href="#cb34-1110" aria-hidden="true" tabindex="-1"></a>seconds <span class="op">=</span> minutes <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb34-1111"><a href="#cb34-1111" aria-hidden="true" tabindex="-1"></a>selectedDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="fu">long2zone</span>(location[<span class="dv">0</span>]))</span>
<span id="cb34-1112"><a href="#cb34-1112" aria-hidden="true" tabindex="-1"></a>selectedExact <span class="op">=</span> selectedDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb34-1113"><a href="#cb34-1113" aria-hidden="true" tabindex="-1"></a>selectedExactN <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> selectedExact) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb34-1114"><a href="#cb34-1114" aria-hidden="true" tabindex="-1"></a>selectedZone <span class="op">=</span> selectedDote[<span class="dv">1</span>]</span>
<span id="cb34-1115"><a href="#cb34-1115" aria-hidden="true" tabindex="-1"></a>ydz <span class="op">=</span> <span class="fu">dote2date</span>(<span class="op">...</span>selectedDote)</span>
<span id="cb34-1116"><a href="#cb34-1116" aria-hidden="true" tabindex="-1"></a>decDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(ydz[<span class="dv">1</span>])</span>
<span id="cb34-1117"><a href="#cb34-1117" aria-hidden="true" tabindex="-1"></a>decTime <span class="op">=</span> (selectedExact <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb34-1118"><a href="#cb34-1118" aria-hidden="true" tabindex="-1"></a>decTimeN <span class="op">=</span> (selectedExactN <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb34-1119"><a href="#cb34-1119" aria-hidden="true" tabindex="-1"></a>barDD <span class="op">=</span> decTime[<span class="dv">0</span>]</span>
<span id="cb34-1120"><a href="#cb34-1120" aria-hidden="true" tabindex="-1"></a>barDDN <span class="op">=</span> decTimeN[<span class="dv">0</span>]</span>
<span id="cb34-1121"><a href="#cb34-1121" aria-hidden="true" tabindex="-1"></a>barMils <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb34-1122"><a href="#cb34-1122" aria-hidden="true" tabindex="-1"></a>barMilsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb34-1123"><a href="#cb34-1123" aria-hidden="true" tabindex="-1"></a>barBeats <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb34-1124"><a href="#cb34-1124" aria-hidden="true" tabindex="-1"></a>barBeatsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb34-1125"><a href="#cb34-1125" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">lati2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb34-1126"><a href="#cb34-1126" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb34-1127"><a href="#cb34-1127" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb34-1128"><a href="#cb34-1128" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1129"><a href="#cb34-1129" aria-hidden="true" tabindex="-1"></a>graticule <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoGraticule</span>()<span class="op">.</span><span class="fu">stepMinor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])<span class="op">.</span><span class="fu">stepMajor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])()</span>
<span id="cb34-1130"><a href="#cb34-1130" aria-hidden="true" tabindex="-1"></a>graticule<span class="op">.</span><span class="at">coordinates</span> <span class="op">=</span> graticule<span class="op">.</span><span class="at">coordinates</span><span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb34-1131"><a href="#cb34-1131" aria-hidden="true" tabindex="-1"></a>  i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="fu">map</span>(j <span class="kw">=&gt;</span> j<span class="op">.</span><span class="fu">map</span>((k<span class="op">,</span> index<span class="op">,</span> arr) <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> index <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> k <span class="op">-</span> <span class="dv">18</span> <span class="op">:</span> k))</span>
<span id="cb34-1132"><a href="#cb34-1132" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-1133"><a href="#cb34-1133" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb34-1134"><a href="#cb34-1134" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb34-1135"><a href="#cb34-1135" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (((degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> degrees <span class="op">+</span> <span class="dv">360</span> <span class="op">:</span> degrees) <span class="op">+</span> <span class="dv">18</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb34-1136"><a href="#cb34-1136" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1137"><a href="#cb34-1137" aria-hidden="true" tabindex="-1"></a><span class="co">// https://github.com/topojson/world-atlas</span></span>
<span id="cb34-1138"><a href="#cb34-1138" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> d3<span class="op">.</span><span class="fu">json</span>(<span class="st">"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json"</span>)</span>
<span id="cb34-1139"><a href="#cb34-1139" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">countries</span>)</span>
<span id="cb34-1140"><a href="#cb34-1140" aria-hidden="true" tabindex="-1"></a>topojson <span class="op">=</span> <span class="pp">require</span>(<span class="st">"topojson-client@3"</span>)</span>
<span id="cb34-1141"><a href="#cb34-1141" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2zone</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span>) {</span>
<span id="cb34-1142"><a href="#cb34-1142" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">long2turn</span>(degrees<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb34-1143"><a href="#cb34-1143" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1144"><a href="#cb34-1144" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">year2leap</span>(year <span class="op">=</span> <span class="dv">1970</span>) {</span>
<span id="cb34-1145"><a href="#cb34-1145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> year <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> year <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> year <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-1146"><a href="#cb34-1146" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1147"><a href="#cb34-1147" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb34-1148"><a href="#cb34-1148" aria-hidden="true" tabindex="-1"></a>solarSystem <span class="op">=</span> (<span class="bu">root</span><span class="op">,</span> vizwidth<span class="op">,</span> location<span class="op">,</span> date<span class="op">,</span> hour<span class="op">,</span> darkmode) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1149"><a href="#cb34-1149" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthRadius <span class="op">=</span> <span class="fl">0.065</span> <span class="op">*</span> vizwidth<span class="op">;</span></span>
<span id="cb34-1150"><a href="#cb34-1150" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const sunRadius = 0.015 * vizwidth;</span></span>
<span id="cb34-1151"><a href="#cb34-1151" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystemRadius <span class="op">=</span> vizwidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (vizwidth <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb34-1152"><a href="#cb34-1152" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stretch <span class="op">=</span> <span class="fl">0.06</span><span class="op">;</span></span>
<span id="cb34-1153"><a href="#cb34-1153" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(date)<span class="op">;</span></span>
<span id="cb34-1154"><a href="#cb34-1154" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngleDeg <span class="op">=</span> (solarAngle <span class="op">*</span> <span class="dv">180</span>) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb34-1155"><a href="#cb34-1155" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(solarAngle)<span class="op">;</span></span>
<span id="cb34-1156"><a href="#cb34-1156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> stretch <span class="op">*</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(solarAngle)<span class="op">;</span></span>
<span id="cb34-1157"><a href="#cb34-1157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> spin <span class="op">=</span> <span class="dv">180</span> <span class="op">+</span> <span class="op">-</span>location[<span class="dv">0</span>] <span class="op">+</span> solarAngleDeg <span class="op">+</span> <span class="dv">360</span> <span class="op">*</span> ((hour <span class="op">+</span> <span class="dv">12</span>) <span class="op">/</span> <span class="dv">24</span>)<span class="op">;</span></span>
<span id="cb34-1158"><a href="#cb34-1158" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthGeo <span class="op">=</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> }<span class="op">;</span></span>
<span id="cb34-1159"><a href="#cb34-1159" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb34-1160"><a href="#cb34-1160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb34-1161"><a href="#cb34-1161" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb34-1162"><a href="#cb34-1162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([spin<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="fl">23.5</span>])</span>
<span id="cb34-1163"><a href="#cb34-1163" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb34-1164"><a href="#cb34-1164" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticProjection <span class="op">=</span> d3</span>
<span id="cb34-1165"><a href="#cb34-1165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb34-1166"><a href="#cb34-1166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb34-1167"><a href="#cb34-1167" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([solarAngleDeg <span class="op">-</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">0</span>])</span>
<span id="cb34-1168"><a href="#cb34-1168" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb34-1169"><a href="#cb34-1169" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">1.5</span>)<span class="op">;</span></span>
<span id="cb34-1170"><a href="#cb34-1170" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticPath <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(staticProjection)<span class="op">;</span></span>
<span id="cb34-1171"><a href="#cb34-1171" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> oceanColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb34-1172"><a href="#cb34-1172" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> landColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb34-1173"><a href="#cb34-1173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> borderColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb34-1174"><a href="#cb34-1174" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystem <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb34-1175"><a href="#cb34-1175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-1176"><a href="#cb34-1176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>vizwidth <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-1177"><a href="#cb34-1177" aria-hidden="true" tabindex="-1"></a>  <span class="co">// solarSystem.append("circle").attr("r", sunRadius).attr("fill", colors.sun);</span></span>
<span id="cb34-1178"><a href="#cb34-1178" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Draw orbit */</span></span>
<span id="cb34-1179"><a href="#cb34-1179" aria-hidden="true" tabindex="-1"></a>    solarSystem</span>
<span id="cb34-1180"><a href="#cb34-1180" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"ellipse"</span>)</span>
<span id="cb34-1181"><a href="#cb34-1181" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> solarSystemRadius)</span>
<span id="cb34-1182"><a href="#cb34-1182" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> stretch <span class="op">*</span> solarSystemRadius)</span>
<span id="cb34-1183"><a href="#cb34-1183" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb34-1184"><a href="#cb34-1184" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.25"</span>)</span>
<span id="cb34-1185"><a href="#cb34-1185" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb34-1186"><a href="#cb34-1186" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* Draw month ticks */</span></span>
<span id="cb34-1187"><a href="#cb34-1187" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">12</span>)<span class="op">.</span><span class="fu">map</span>((m) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1188"><a href="#cb34-1188" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> d <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb34-1189"><a href="#cb34-1189" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> angle <span class="op">=</span> <span class="fu">getSolarAngle</span>(d)<span class="op">;</span></span>
<span id="cb34-1190"><a href="#cb34-1190" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb34-1191"><a href="#cb34-1191" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb34-1192"><a href="#cb34-1192" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb34-1193"><a href="#cb34-1193" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb34-1194"><a href="#cb34-1194" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb34-1195"><a href="#cb34-1195" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb34-1196"><a href="#cb34-1196" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.75"</span>)</span>
<span id="cb34-1197"><a href="#cb34-1197" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb34-1198"><a href="#cb34-1198" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> startMonthAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(<span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb34-1199"><a href="#cb34-1199" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb34-1200"><a href="#cb34-1200" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-1201"><a href="#cb34-1201" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="fu">date2doty</span>(d))</span>
<span id="cb34-1202"><a href="#cb34-1202" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">18</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(startMonthAngle) <span class="op">*</span> <span class="fl">1.1</span>)</span>
<span id="cb34-1203"><a href="#cb34-1203" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb34-1204"><a href="#cb34-1204" aria-hidden="true" tabindex="-1"></a>          <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb34-1205"><a href="#cb34-1205" aria-hidden="true" tabindex="-1"></a>          (solarSystemRadius <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">3</span>) <span class="op">*</span> <span class="fl">6.2</span> <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle)) <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb34-1206"><a href="#cb34-1206" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb34-1207"><a href="#cb34-1207" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-1208"><a href="#cb34-1208" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-1209"><a href="#cb34-1209" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> <span class="fl">1.2</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1210"><a href="#cb34-1210" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb34-1211"><a href="#cb34-1211" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb34-1212"><a href="#cb34-1212" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb34-1213"><a href="#cb34-1213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> earth <span class="op">=</span> solarSystem</span>
<span id="cb34-1214"><a href="#cb34-1214" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-1215"><a href="#cb34-1215" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>y<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-1216"><a href="#cb34-1216" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">drawEarth</span>() {</span>
<span id="cb34-1217"><a href="#cb34-1217" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`rotate(-23.5)`</span>)<span class="op">;</span></span>
<span id="cb34-1218"><a href="#cb34-1218" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(earthGeo))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeOcean"</span>)<span class="op">;</span></span>
<span id="cb34-1219"><a href="#cb34-1219" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(land))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeLand"</span>)<span class="op">;</span></span>
<span id="cb34-1220"><a href="#cb34-1220" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(countries))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">".08"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeBorders"</span>)<span class="op">;</span></span>
<span id="cb34-1221"><a href="#cb34-1221" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">5.5</span>)<span class="op">;</span></span>
<span id="cb34-1222"><a href="#cb34-1222" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb34-1223"><a href="#cb34-1223" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">4.5</span>)<span class="op">;</span></span>
<span id="cb34-1224"><a href="#cb34-1224" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">2.25</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb34-1225"><a href="#cb34-1225" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1226"><a href="#cb34-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb34-1227"><a href="#cb34-1227" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1228"><a href="#cb34-1228" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greg2doty</span>(month <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> day <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb34-1229"><a href="#cb34-1229" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb34-1230"><a href="#cb34-1230" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> day <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb34-1231"><a href="#cb34-1231" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb34-1232"><a href="#cb34-1232" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty</span>(date) {</span>
<span id="cb34-1233"><a href="#cb34-1233" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb34-1234"><a href="#cb34-1234" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1235"><a href="#cb34-1235" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty1</span>(date) {</span>
<span id="cb34-1236"><a href="#cb34-1236" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb34-1237"><a href="#cb34-1237" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1238"><a href="#cb34-1238" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb34-1239"><a href="#cb34-1239" aria-hidden="true" tabindex="-1"></a><span class="co">// globe = (root, { vizwidth, location, date, hour }) =&gt; {</span></span>
<span id="cb34-1240"><a href="#cb34-1240" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngle = getSolarAngle(date);</span></span>
<span id="cb34-1241"><a href="#cb34-1241" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngleDeg = toDegrees(solarAngle);</span></span>
<span id="cb34-1242"><a href="#cb34-1242" aria-hidden="true" tabindex="-1"></a><span class="co">//   const hourSpin = 360 * ((hour + 12) / 24);</span></span>
<span id="cb34-1243"><a href="#cb34-1243" aria-hidden="true" tabindex="-1"></a><span class="co">//   const spin = (180 + -location[0] + solarAngleDeg + hourSpin);</span></span>
<span id="cb34-1244"><a href="#cb34-1244" aria-hidden="true" tabindex="-1"></a><span class="co">//   const tilt = -15;</span></span>
<span id="cb34-1245"><a href="#cb34-1245" aria-hidden="true" tabindex="-1"></a><span class="co">//   const projection = d3.geoOrthographic()</span></span>
<span id="cb34-1246"><a href="#cb34-1246" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .fitWidth(vizwidth, graticule)</span></span>
<span id="cb34-1247"><a href="#cb34-1247" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb34-1248"><a href="#cb34-1248" aria-hidden="true" tabindex="-1"></a><span class="co">//   const path = d3.geoPath(projection);</span></span>
<span id="cb34-1249"><a href="#cb34-1249" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedProjection = d3.geoOrthographic()</span></span>
<span id="cb34-1250"><a href="#cb34-1250" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .clipAngle(null)</span></span>
<span id="cb34-1251"><a href="#cb34-1251" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .fitWidth(vizwidth, graticule)</span></span>
<span id="cb34-1252"><a href="#cb34-1252" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb34-1253"><a href="#cb34-1253" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedPath = d3.geoPath(unClippedProjection);</span></span>
<span id="cb34-1254"><a href="#cb34-1254" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticProjection = d3.geoOrthographic()</span></span>
<span id="cb34-1255"><a href="#cb34-1255" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .fitWidth(vizwidth, graticule)</span></span>
<span id="cb34-1256"><a href="#cb34-1256" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .rotate([solarAngleDeg - 90, tilt]);</span></span>
<span id="cb34-1257"><a href="#cb34-1257" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticPath = d3.geoPath(staticProjection);</span></span>
<span id="cb34-1258"><a href="#cb34-1258" aria-hidden="true" tabindex="-1"></a><span class="co">//   const background = root.append("g");</span></span>
<span id="cb34-1259"><a href="#cb34-1259" aria-hidden="true" tabindex="-1"></a><span class="co">//   const earth = root.append("g").style("opacity", 0.75);</span></span>
<span id="cb34-1260"><a href="#cb34-1260" aria-hidden="true" tabindex="-1"></a><span class="co">//   const foreground = root.append("g");</span></span>
<span id="cb34-1261"><a href="#cb34-1261" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb34-1262"><a href="#cb34-1262" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Sphere"}))</span></span>
<span id="cb34-1263"><a href="#cb34-1263" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.ocean)</span></span>
<span id="cb34-1264"><a href="#cb34-1264" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#9ecbda");</span></span>
<span id="cb34-1265"><a href="#cb34-1265" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb34-1266"><a href="#cb34-1266" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(land))</span></span>
<span id="cb34-1267"><a href="#cb34-1267" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.land);</span></span>
<span id="cb34-1268"><a href="#cb34-1268" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb34-1269"><a href="#cb34-1269" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(countries))</span></span>
<span id="cb34-1270"><a href="#cb34-1270" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", "1")</span></span>
<span id="cb34-1271"><a href="#cb34-1271" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb34-1272"><a href="#cb34-1272" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#000");</span></span>
<span id="cb34-1273"><a href="#cb34-1273" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb34-1274"><a href="#cb34-1274" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath({type: "Point", coordinates: location}))</span></span>
<span id="cb34-1275"><a href="#cb34-1275" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb34-1276"><a href="#cb34-1276" aria-hidden="true" tabindex="-1"></a><span class="co">//   const latitudeCoords = (latitude, start, end) =&gt; {</span></span>
<span id="cb34-1277"><a href="#cb34-1277" aria-hidden="true" tabindex="-1"></a><span class="co">//     const longitudes = d3.range(start, end, 2).concat(end);</span></span>
<span id="cb34-1278"><a href="#cb34-1278" aria-hidden="true" tabindex="-1"></a><span class="co">//     return longitudes.map(d =&gt; [d, latitude]);</span></span>
<span id="cb34-1279"><a href="#cb34-1279" aria-hidden="true" tabindex="-1"></a><span class="co">//   }</span></span>
<span id="cb34-1280"><a href="#cb34-1280" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctSpin = d3.geoRotation([-hourSpin, 0]);</span></span>
<span id="cb34-1281"><a href="#cb34-1281" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctTilt = d3.geoRotation([6, 0, 0]);</span></span>
<span id="cb34-1282"><a href="#cb34-1282" aria-hidden="true" tabindex="-1"></a><span class="co">//   /* total angular extent of day/night */</span></span>
<span id="cb34-1283"><a href="#cb34-1283" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayExtent = 360 * dayLength(date, location[1]) / 24;</span></span>
<span id="cb34-1284"><a href="#cb34-1284" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightExtent = 360 - dayExtent;</span></span>
<span id="cb34-1285"><a href="#cb34-1285" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayLine = {</span></span>
<span id="cb34-1286"><a href="#cb34-1286" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb34-1287"><a href="#cb34-1287" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb34-1288"><a href="#cb34-1288" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2,</span></span>
<span id="cb34-1289"><a href="#cb34-1289" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] + dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb34-1290"><a href="#cb34-1290" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb34-1291"><a href="#cb34-1291" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightLine = {</span></span>
<span id="cb34-1292"><a href="#cb34-1292" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb34-1293"><a href="#cb34-1293" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb34-1294"><a href="#cb34-1294" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2 - nightExtent,</span></span>
<span id="cb34-1295"><a href="#cb34-1295" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb34-1296"><a href="#cb34-1296" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb34-1297"><a href="#cb34-1297" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb34-1298"><a href="#cb34-1298" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(dayLine))</span></span>
<span id="cb34-1299"><a href="#cb34-1299" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb34-1300"><a href="#cb34-1300" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb34-1301"><a href="#cb34-1301" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb34-1302"><a href="#cb34-1302" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb34-1303"><a href="#cb34-1303" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(nightLine))</span></span>
<span id="cb34-1304"><a href="#cb34-1304" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb34-1305"><a href="#cb34-1305" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb34-1306"><a href="#cb34-1306" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb34-1307"><a href="#cb34-1307" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb34-1308"><a href="#cb34-1308" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(dayLine))</span></span>
<span id="cb34-1309"><a href="#cb34-1309" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb34-1310"><a href="#cb34-1310" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb34-1311"><a href="#cb34-1311" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb34-1312"><a href="#cb34-1312" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb34-1313"><a href="#cb34-1313" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(nightLine))</span></span>
<span id="cb34-1314"><a href="#cb34-1314" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb34-1315"><a href="#cb34-1315" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb34-1316"><a href="#cb34-1316" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb34-1317"><a href="#cb34-1317" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb34-1318"><a href="#cb34-1318" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Point", coordinates: location}))</span></span>
<span id="cb34-1319"><a href="#cb34-1319" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", .5)</span></span>
<span id="cb34-1320"><a href="#cb34-1320" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "black")</span></span>
<span id="cb34-1321"><a href="#cb34-1321" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb34-1322"><a href="#cb34-1322" aria-hidden="true" tabindex="-1"></a><span class="co">//   const shadowPolygon = [[0, -90], [0, 0], [0, 90], [180, 0], [0, -90]].map(d =&gt; correctTilt(d));</span></span>
<span id="cb34-1323"><a href="#cb34-1323" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb34-1324"><a href="#cb34-1324" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", staticPath({type: "Polygon", coordinates: [shadowPolygon]}))</span></span>
<span id="cb34-1325"><a href="#cb34-1325" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "rgba(0, 0, 0, 0.25)");</span></span>
<span id="cb34-1326"><a href="#cb34-1326" aria-hidden="true" tabindex="-1"></a><span class="co">// }</span></span>
<span id="cb34-1327"><a href="#cb34-1327" aria-hidden="true" tabindex="-1"></a>dayOfYear <span class="op">=</span> (date) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1328"><a href="#cb34-1328" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb34-1329"><a href="#cb34-1329" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb34-1330"><a href="#cb34-1330" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1331"><a href="#cb34-1331" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb34-1332"><a href="#cb34-1332" aria-hidden="true" tabindex="-1"></a>daylightPlot <span class="op">=</span> (</span>
<span id="cb34-1333"><a href="#cb34-1333" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span><span class="op">,</span></span>
<span id="cb34-1334"><a href="#cb34-1334" aria-hidden="true" tabindex="-1"></a>  { vizwidth<span class="op">,</span> height<span class="op">,</span> year<span class="op">,</span> latitude<span class="op">,</span> defaultDate<span class="op">,</span> defaultHour }</span>
<span id="cb34-1335"><a href="#cb34-1335" aria-hidden="true" tabindex="-1"></a>) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1336"><a href="#cb34-1336" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">;</span></span>
<span id="cb34-1337"><a href="#cb34-1337" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartWidth <span class="op">=</span> vizwidth <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">;</span></span>
<span id="cb34-1338"><a href="#cb34-1338" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartHeight <span class="op">=</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb34-1339"><a href="#cb34-1339" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yTickValues <span class="op">=</span></span>
<span id="cb34-1340"><a href="#cb34-1340" aria-hidden="true" tabindex="-1"></a>    width <span class="op">&gt;</span> <span class="dv">380</span> <span class="op">?</span> [<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">21</span>] <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">90</span> <span class="op">?</span> [<span class="dv">6</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">18</span>] <span class="op">:</span> [<span class="dv">12</span>]<span class="op">;</span></span>
<span id="cb34-1341"><a href="#cb34-1341" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yScale <span class="op">=</span> d3</span>
<span id="cb34-1342"><a href="#cb34-1342" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb34-1343"><a href="#cb34-1343" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">24</span>])</span>
<span id="cb34-1344"><a href="#cb34-1344" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth])</span>
<span id="cb34-1345"><a href="#cb34-1345" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb34-1346"><a href="#cb34-1346" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis scale</span></span>
<span id="cb34-1347"><a href="#cb34-1347" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xScale <span class="op">=</span> d3</span>
<span id="cb34-1348"><a href="#cb34-1348" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleTime</span>()</span>
<span id="cb34-1349"><a href="#cb34-1349" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">61</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">91</span>)])</span>
<span id="cb34-1350"><a href="#cb34-1350" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">top</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight])</span>
<span id="cb34-1351"><a href="#cb34-1351" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb34-1352"><a href="#cb34-1352" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis labels</span></span>
<span id="cb34-1353"><a href="#cb34-1353" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3</span>
<span id="cb34-1354"><a href="#cb34-1354" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisBottom</span>(xScale)</span>
<span id="cb34-1355"><a href="#cb34-1355" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(d3<span class="op">.</span><span class="at">timeMonth</span><span class="op">.</span><span class="fu">range</span>(<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">60</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">57</span>)))</span>
<span id="cb34-1356"><a href="#cb34-1356" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartWidth)</span>
<span id="cb34-1357"><a href="#cb34-1357" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(date2doty1)<span class="op">;</span></span>
<span id="cb34-1358"><a href="#cb34-1358" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3</span>
<span id="cb34-1359"><a href="#cb34-1359" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisLeft</span>(yScale)</span>
<span id="cb34-1360"><a href="#cb34-1360" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(yTickValues)</span>
<span id="cb34-1361"><a href="#cb34-1361" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartHeight)</span>
<span id="cb34-1362"><a href="#cb34-1362" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>((d) <span class="kw">=&gt;</span> { <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>d <span class="op">/</span> <span class="op">.</span><span class="bn">024</span><span class="sc">}</span><span class="vs">`</span> })<span class="op">;</span></span>
<span id="cb34-1363"><a href="#cb34-1363" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> date <span class="op">=</span> defaultDate <span class="op">||</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb34-1364"><a href="#cb34-1364" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> hour <span class="op">=</span> defaultHour <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> defaultHour <span class="op">:</span> date<span class="op">.</span><span class="fu">getHours</span>()<span class="op">;</span></span>
<span id="cb34-1365"><a href="#cb34-1365" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleMouseMove <span class="op">=</span> (e) <span class="kw">=&gt;</span> {}<span class="op">;</span></span>
<span id="cb34-1366"><a href="#cb34-1366" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb34-1367"><a href="#cb34-1367" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb34-1368"><a href="#cb34-1368" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span>)</span>
<span id="cb34-1369"><a href="#cb34-1369" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb34-1370"><a href="#cb34-1370" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb34-1371"><a href="#cb34-1371" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> chartHeight)</span>
<span id="cb34-1372"><a href="#cb34-1372" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> <span class="fl">0.05</span> <span class="op">*</span> vizwidth)</span>
<span id="cb34-1373"><a href="#cb34-1373" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb34-1374"><a href="#cb34-1374" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb34-1375"><a href="#cb34-1375" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-1376"><a href="#cb34-1376" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb34-1377"><a href="#cb34-1377" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb34-1378"><a href="#cb34-1378" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb34-1379"><a href="#cb34-1379" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb34-1380"><a href="#cb34-1380" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">7</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">.</span><span class="dv">725</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">75</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> <span class="fl">1.4</span>) <span class="op">*</span> fontSize))</span>
<span id="cb34-1381"><a href="#cb34-1381" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb34-1382"><a href="#cb34-1382" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb34-1383"><a href="#cb34-1383" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb34-1384"><a href="#cb34-1384" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-1385"><a href="#cb34-1385" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartHeight<span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb34-1386"><a href="#cb34-1386" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb34-1387"><a href="#cb34-1387" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb34-1388"><a href="#cb34-1388" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb34-1389"><a href="#cb34-1389" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.3</span>) <span class="op">*</span> fontSize))</span>
<span id="cb34-1390"><a href="#cb34-1390" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb34-1391"><a href="#cb34-1391" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb34-1392"><a href="#cb34-1392" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb34-1393"><a href="#cb34-1393" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-1394"><a href="#cb34-1394" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Time of day"</span>)</span>
<span id="cb34-1395"><a href="#cb34-1395" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="op">-</span><span class="dv">102</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">-</span><span class="dv">106</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">-</span><span class="dv">108</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">-</span><span class="dv">115</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">-</span><span class="dv">120</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">128</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">425</span> <span class="op">?</span> <span class="op">-</span><span class="dv">130</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">-</span><span class="dv">132</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="op">-</span><span class="dv">136</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">141</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">525</span> <span class="op">?</span> <span class="op">-</span><span class="dv">142</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">-</span><span class="dv">148</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">575</span> <span class="op">?</span> <span class="op">-</span><span class="dv">149</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">154</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">675</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">-</span><span class="dv">161</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">725</span> <span class="op">?</span> <span class="op">-</span><span class="dv">160</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="op">-</span><span class="dv">165</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">775</span> <span class="op">?</span> <span class="op">-</span><span class="dv">169</span> <span class="op">:</span> <span class="op">-</span><span class="dv">173</span>))</span>
<span id="cb34-1396"><a href="#cb34-1396" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">33</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">35</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">42</span>))</span>
<span id="cb34-1397"><a href="#cb34-1397" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-1398"><a href="#cb34-1398" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1399"><a href="#cb34-1399" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb34-1400"><a href="#cb34-1400" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb34-1401"><a href="#cb34-1401" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb34-1402"><a href="#cb34-1402" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb34-1403"><a href="#cb34-1403" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-1404"><a href="#cb34-1404" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day of year"</span>)</span>
<span id="cb34-1405"><a href="#cb34-1405" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">28</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> <span class="dv">22</span>))</span>
<span id="cb34-1406"><a href="#cb34-1406" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight <span class="op">/</span> <span class="dv">4</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">39</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">51</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">43</span>))</span>
<span id="cb34-1407"><a href="#cb34-1407" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb34-1408"><a href="#cb34-1408" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1409"><a href="#cb34-1409" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb34-1410"><a href="#cb34-1410" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb34-1411"><a href="#cb34-1411" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="fu">yearDates</span>(year)</span>
<span id="cb34-1412"><a href="#cb34-1412" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">,</span> <span class="fu">dayLength</span>(d<span class="op">,</span> latitude)])</span>
<span id="cb34-1413"><a href="#cb34-1413" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(([_<span class="op">,</span> d]) <span class="kw">=&gt;</span> d <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb34-1414"><a href="#cb34-1414" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Render separate polygons for each continuous sequence of</span></span>
<span id="cb34-1415"><a href="#cb34-1415" aria-hidden="true" tabindex="-1"></a><span class="co">   * days with more than 0 hours of day light</span></span>
<span id="cb34-1416"><a href="#cb34-1416" aria-hidden="true" tabindex="-1"></a><span class="co">   */</span></span>
<span id="cb34-1417"><a href="#cb34-1417" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> polys <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb34-1418"><a href="#cb34-1418" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> currentPoly <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb34-1419"><a href="#cb34-1419" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> data<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb34-1420"><a href="#cb34-1420" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> currentDate <span class="op">=</span> data[i][<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb34-1421"><a href="#cb34-1421" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prevDate <span class="op">=</span> (data[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">||</span> [])[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb34-1422"><a href="#cb34-1422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb34-1423"><a href="#cb34-1423" aria-hidden="true" tabindex="-1"></a>      i <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span></span>
<span id="cb34-1424"><a href="#cb34-1424" aria-hidden="true" tabindex="-1"></a>      currentDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> prevDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">&lt;</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb34-1425"><a href="#cb34-1425" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb34-1426"><a href="#cb34-1426" aria-hidden="true" tabindex="-1"></a>      currentPoly<span class="op">.</span><span class="fu">push</span>(data[i])<span class="op">;</span></span>
<span id="cb34-1427"><a href="#cb34-1427" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb34-1428"><a href="#cb34-1428" aria-hidden="true" tabindex="-1"></a>      polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb34-1429"><a href="#cb34-1429" aria-hidden="true" tabindex="-1"></a>      currentPoly <span class="op">=</span> [data[i]]<span class="op">;</span></span>
<span id="cb34-1430"><a href="#cb34-1430" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-1431"><a href="#cb34-1431" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1432"><a href="#cb34-1432" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb34-1433"><a href="#cb34-1433" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">forEach</span>((p) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1434"><a href="#cb34-1434" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> points <span class="op">=</span> [</span>
<span id="cb34-1435"><a href="#cb34-1435" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">-</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">,</span></span>
<span id="cb34-1436"><a href="#cb34-1436" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">reverse</span>()<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">+</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb34-1437"><a href="#cb34-1437" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">.</span><span class="fu">join</span>(<span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb34-1438"><a href="#cb34-1438" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"polygon"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"points"</span><span class="op">,</span> points)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb34-1439"><a href="#cb34-1439" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb34-1440"><a href="#cb34-1440" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Legend */</span></span>
<span id="cb34-1441"><a href="#cb34-1441" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb34-1442"><a href="#cb34-1442" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb34-1443"><a href="#cb34-1443" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">64</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb34-1444"><a href="#cb34-1444" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb34-1445"><a href="#cb34-1445" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb34-1446"><a href="#cb34-1446" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">63</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">61</span> <span class="op">:</span> <span class="dv">60</span>)</span>
<span id="cb34-1447"><a href="#cb34-1447" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb34-1448"><a href="#cb34-1448" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb34-1449"><a href="#cb34-1449" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1450"><a href="#cb34-1450" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1451"><a href="#cb34-1451" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb34-1452"><a href="#cb34-1452" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb34-1453"><a href="#cb34-1453" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-1454"><a href="#cb34-1454" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">82</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">85</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">87</span> <span class="op">:</span> <span class="dv">90</span>)</span>
<span id="cb34-1455"><a href="#cb34-1455" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb34-1456"><a href="#cb34-1456" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1457"><a href="#cb34-1457" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb34-1458"><a href="#cb34-1458" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day"</span>)<span class="op">;</span></span>
<span id="cb34-1459"><a href="#cb34-1459" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb34-1460"><a href="#cb34-1460" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb34-1461"><a href="#cb34-1461" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">40</span> <span class="op">:</span> <span class="op">-</span><span class="dv">39</span>)</span>
<span id="cb34-1462"><a href="#cb34-1462" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb34-1463"><a href="#cb34-1463" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb34-1464"><a href="#cb34-1464" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1465"><a href="#cb34-1465" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1466"><a href="#cb34-1466" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb34-1467"><a href="#cb34-1467" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb34-1468"><a href="#cb34-1468" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb34-1469"><a href="#cb34-1469" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">11</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">12</span> <span class="op">:</span> <span class="op">-</span><span class="dv">9</span>)</span>
<span id="cb34-1470"><a href="#cb34-1470" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb34-1471"><a href="#cb34-1471" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb34-1472"><a href="#cb34-1472" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb34-1473"><a href="#cb34-1473" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Night"</span>)<span class="op">;</span></span>
<span id="cb34-1474"><a href="#cb34-1474" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Time and date controls */</span></span>
<span id="cb34-1475"><a href="#cb34-1475" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dateLine <span class="op">=</span> <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb34-1476"><a href="#cb34-1476" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updateControlPositions <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb34-1477"><a href="#cb34-1477" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb34-1478"><a href="#cb34-1478" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"line"</span>)</span>
<span id="cb34-1479"><a href="#cb34-1479" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb34-1480"><a href="#cb34-1480" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScale</span>(date))</span>
<span id="cb34-1481"><a href="#cb34-1481" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">24</span>))</span>
<span id="cb34-1482"><a href="#cb34-1482" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb34-1483"><a href="#cb34-1483" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb34-1484"><a href="#cb34-1484" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"rect"</span>)</span>
<span id="cb34-1485"><a href="#cb34-1485" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb34-1486"><a href="#cb34-1486" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">xScale</span>(date) <span class="op">-</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb34-1487"><a href="#cb34-1487" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span></span>
<span id="cb34-1488"><a href="#cb34-1488" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#time-control"</span>)</span>
<span id="cb34-1489"><a href="#cb34-1489" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">yScale</span>(hour))</span>
<span id="cb34-1490"><a href="#cb34-1490" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb34-1491"><a href="#cb34-1491" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-1492"><a href="#cb34-1492" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dispatchDateHourChange <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb34-1493"><a href="#cb34-1493" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> detail <span class="op">=</span> { date<span class="op">,</span> hour }<span class="op">;</span></span>
<span id="cb34-1494"><a href="#cb34-1494" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> changeEvent <span class="op">=</span> <span class="kw">new</span> <span class="bu">CustomEvent</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> {</span>
<span id="cb34-1495"><a href="#cb34-1495" aria-hidden="true" tabindex="-1"></a>      detail<span class="op">,</span></span>
<span id="cb34-1496"><a href="#cb34-1496" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb34-1497"><a href="#cb34-1497" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb34-1498"><a href="#cb34-1498" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">dispatchEvent</span>(changeEvent)<span class="op">;</span></span>
<span id="cb34-1499"><a href="#cb34-1499" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-1500"><a href="#cb34-1500" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateLineDrag <span class="op">=</span> ({ x }) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1501"><a href="#cb34-1501" aria-hidden="true" tabindex="-1"></a>    date <span class="op">=</span> xScale<span class="op">.</span><span class="fu">invert</span>(x)<span class="op">;</span></span>
<span id="cb34-1502"><a href="#cb34-1502" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb34-1503"><a href="#cb34-1503" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb34-1504"><a href="#cb34-1504" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-1505"><a href="#cb34-1505" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleTimeCircleDrag <span class="op">=</span> ({ y }) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1506"><a href="#cb34-1506" aria-hidden="true" tabindex="-1"></a>    hour <span class="op">=</span> yScale<span class="op">.</span><span class="fu">invert</span>(y)<span class="op">;</span></span>
<span id="cb34-1507"><a href="#cb34-1507" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb34-1508"><a href="#cb34-1508" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb34-1509"><a href="#cb34-1509" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-1510"><a href="#cb34-1510" aria-hidden="true" tabindex="-1"></a>  dateLine<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb34-1511"><a href="#cb34-1511" aria-hidden="true" tabindex="-1"></a>  dateLine</span>
<span id="cb34-1512"><a href="#cb34-1512" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb34-1513"><a href="#cb34-1513" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb34-1514"><a href="#cb34-1514" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb34-1515"><a href="#cb34-1515" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"rgba(0, 0, 0, 0)"</span>)</span>
<span id="cb34-1516"><a href="#cb34-1516" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"row-resize"</span>)</span>
<span id="cb34-1517"><a href="#cb34-1517" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleDateLineDrag))<span class="op">;</span></span>
<span id="cb34-1518"><a href="#cb34-1518" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb34-1519"><a href="#cb34-1519" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb34-1520"><a href="#cb34-1520" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"time-control"</span>)</span>
<span id="cb34-1521"><a href="#cb34-1521" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">12</span>)</span>
<span id="cb34-1522"><a href="#cb34-1522" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"red"</span>)</span>
<span id="cb34-1523"><a href="#cb34-1523" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)</span>
<span id="cb34-1524"><a href="#cb34-1524" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb34-1525"><a href="#cb34-1525" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"pointer"</span>)</span>
<span id="cb34-1526"><a href="#cb34-1526" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleTimeCircleDrag))<span class="op">;</span></span>
<span id="cb34-1527"><a href="#cb34-1527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb34-1528"><a href="#cb34-1528" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1529"><a href="#cb34-1529" aria-hidden="true" tabindex="-1"></a>fontSize <span class="op">=</span> <span class="dv">14</span><span class="op">;</span></span>
<span id="cb34-1530"><a href="#cb34-1530" aria-hidden="true" tabindex="-1"></a>getSolarAngle <span class="op">=</span> (date) <span class="kw">=&gt;</span> (<span class="fu">dayOfYear</span>(date) <span class="op">+</span> <span class="dv">10</span>) <span class="op">/</span> <span class="dv">365</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb34-1531"><a href="#cb34-1531" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb34-1532"><a href="#cb34-1532" aria-hidden="true" tabindex="-1"></a><span class="co"> * Formulas uses the CBM model as reviewed here:</span></span>
<span id="cb34-1533"><a href="#cb34-1533" aria-hidden="true" tabindex="-1"></a><span class="co"> * https://www.ikhebeenvraag.be/mediastorage/FSDocument/171/Forsythe+-+A+model+comparison+for+daylength+as+a+function+of+latitude+and+day+of+year+-+1995.pdf</span></span>
<span id="cb34-1534"><a href="#cb34-1534" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb34-1535"><a href="#cb34-1535" aria-hidden="true" tabindex="-1"></a>dayLength <span class="op">=</span> (date<span class="op">,</span> latitude) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1536"><a href="#cb34-1536" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb34-1537"><a href="#cb34-1537" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dayOfYear <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb34-1538"><a href="#cb34-1538" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> revAngle <span class="op">=</span> <span class="fl">0.2163108</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>(<span class="fl">0.9671396</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">tan</span>(<span class="fl">0.00860</span> <span class="op">*</span> (dayOfYear <span class="op">-</span> <span class="dv">186</span>)))<span class="op">;</span></span>
<span id="cb34-1539"><a href="#cb34-1539" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decAngle <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">asin</span>(<span class="fl">0.39795</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(revAngle))<span class="op">;</span></span>
<span id="cb34-1540"><a href="#cb34-1540" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* daylight coefficient selected for apparent sunrise/sunset */</span></span>
<span id="cb34-1541"><a href="#cb34-1541" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> p <span class="op">=</span> <span class="fl">0.8333</span></span>
<span id="cb34-1542"><a href="#cb34-1542" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> intResult <span class="op">=</span></span>
<span id="cb34-1543"><a href="#cb34-1543" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((p <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">+</span></span>
<span id="cb34-1544"><a href="#cb34-1544" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(decAngle)) <span class="op">/</span></span>
<span id="cb34-1545"><a href="#cb34-1545" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(decAngle))<span class="op">;</span></span>
<span id="cb34-1546"><a href="#cb34-1546" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&gt;=</span> <span class="dv">1</span>) <span class="cf">return</span> <span class="dv">24</span><span class="op">;</span></span>
<span id="cb34-1547"><a href="#cb34-1547" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&lt;=</span> <span class="op">-</span><span class="dv">1</span>) <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-1548"><a href="#cb34-1548" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">24</span> <span class="op">-</span> <span class="dv">24</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">acos</span>(intResult) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb34-1549"><a href="#cb34-1549" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1550"><a href="#cb34-1550" aria-hidden="true" tabindex="-1"></a>yearDates <span class="op">=</span> (year) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1551"><a href="#cb34-1551" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> startDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb34-1552"><a href="#cb34-1552" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> endDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb34-1553"><a href="#cb34-1553" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d3<span class="op">.</span><span class="at">timeDay</span><span class="op">.</span><span class="fu">range</span>(startDate<span class="op">,</span> endDate)<span class="op">;</span></span>
<span id="cb34-1554"><a href="#cb34-1554" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1555"><a href="#cb34-1555" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="fl">0.65</span> <span class="op">*</span> width<span class="op">;</span></span>
<span id="cb34-1556"><a href="#cb34-1556" aria-hidden="true" tabindex="-1"></a>EventType <span class="op">=</span> ({</span>
<span id="cb34-1557"><a href="#cb34-1557" aria-hidden="true" tabindex="-1"></a>  <span class="dt">LocationChange</span><span class="op">:</span> <span class="st">"LOCATION_CHANGE"</span><span class="op">,</span></span>
<span id="cb34-1558"><a href="#cb34-1558" aria-hidden="true" tabindex="-1"></a>  <span class="dt">DateHourChange</span><span class="op">:</span> <span class="st">"DATE_HOUR_CHANGE"</span></span>
<span id="cb34-1559"><a href="#cb34-1559" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-1560"><a href="#cb34-1560" aria-hidden="true" tabindex="-1"></a>mapcolors <span class="op">=</span> ({</span>
<span id="cb34-1561"><a href="#cb34-1561" aria-hidden="true" tabindex="-1"></a>  <span class="dt">night</span><span class="op">:</span> <span class="st">"#719fb6"</span><span class="op">,</span></span>
<span id="cb34-1562"><a href="#cb34-1562" aria-hidden="true" tabindex="-1"></a>  <span class="dt">day</span><span class="op">:</span> <span class="st">"#ffe438"</span><span class="op">,</span></span>
<span id="cb34-1563"><a href="#cb34-1563" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="st">"#4b6a79"</span><span class="op">,</span></span>
<span id="cb34-1564"><a href="#cb34-1564" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ocean</span><span class="op">:</span> <span class="st">"#adeeff"</span><span class="op">,</span></span>
<span id="cb34-1565"><a href="#cb34-1565" aria-hidden="true" tabindex="-1"></a>  <span class="dt">land</span><span class="op">:</span> <span class="st">"#90ff7888"</span><span class="op">,</span></span>
<span id="cb34-1566"><a href="#cb34-1566" aria-hidden="true" tabindex="-1"></a>  <span class="dt">sun</span><span class="op">:</span> <span class="st">"#ffb438"</span></span>
<span id="cb34-1567"><a href="#cb34-1567" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-1568"><a href="#cb34-1568" aria-hidden="true" tabindex="-1"></a>toRadians <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span></span>
<span id="cb34-1569"><a href="#cb34-1569" aria-hidden="true" tabindex="-1"></a>toDegrees <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="dv">180</span> <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb34-1570"><a href="#cb34-1570" aria-hidden="true" tabindex="-1"></a>land <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">land</span>)<span class="op">;</span></span>
<span id="cb34-1571"><a href="#cb34-1571" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3@7"</span><span class="op">,</span> <span class="st">"d3-geo-projection@3"</span>)</span>
<span id="cb34-1572"><a href="#cb34-1572" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">input</span>(config) {</span>
<span id="cb34-1573"><a href="#cb34-1573" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> {</span>
<span id="cb34-1574"><a href="#cb34-1574" aria-hidden="true" tabindex="-1"></a>    form<span class="op">,</span></span>
<span id="cb34-1575"><a href="#cb34-1575" aria-hidden="true" tabindex="-1"></a>    type <span class="op">=</span> <span class="st">"text"</span><span class="op">,</span></span>
<span id="cb34-1576"><a href="#cb34-1576" aria-hidden="true" tabindex="-1"></a>    attributes <span class="op">=</span> {}<span class="op">,</span></span>
<span id="cb34-1577"><a href="#cb34-1577" aria-hidden="true" tabindex="-1"></a>    action<span class="op">,</span></span>
<span id="cb34-1578"><a href="#cb34-1578" aria-hidden="true" tabindex="-1"></a>    getValue<span class="op">,</span></span>
<span id="cb34-1579"><a href="#cb34-1579" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb34-1580"><a href="#cb34-1580" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb34-1581"><a href="#cb34-1581" aria-hidden="true" tabindex="-1"></a>    format<span class="op">,</span></span>
<span id="cb34-1582"><a href="#cb34-1582" aria-hidden="true" tabindex="-1"></a>    display<span class="op">,</span></span>
<span id="cb34-1583"><a href="#cb34-1583" aria-hidden="true" tabindex="-1"></a>    submit<span class="op">,</span></span>
<span id="cb34-1584"><a href="#cb34-1584" aria-hidden="true" tabindex="-1"></a>    options</span>
<span id="cb34-1585"><a href="#cb34-1585" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> config<span class="op">;</span></span>
<span id="cb34-1586"><a href="#cb34-1586" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> wrapper <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb34-1587"><a href="#cb34-1587" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>form)</span>
<span id="cb34-1588"><a href="#cb34-1588" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form&gt;</span></span>
<span id="cb34-1589"><a href="#cb34-1589" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;input name=input type=</span><span class="sc">${</span>type<span class="sc">}</span><span class="vs"> /&gt;</span></span>
<span id="cb34-1590"><a href="#cb34-1590" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb34-1591"><a href="#cb34-1591" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(attributes)<span class="op">.</span><span class="fu">forEach</span>(key <span class="kw">=&gt;</span> {</span>
<span id="cb34-1592"><a href="#cb34-1592" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> val <span class="op">=</span> attributes[key]<span class="op">;</span></span>
<span id="cb34-1593"><a href="#cb34-1593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="op">!=</span> <span class="kw">null</span>) form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="fu">setAttribute</span>(key<span class="op">,</span> val)<span class="op">;</span></span>
<span id="cb34-1594"><a href="#cb34-1594" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb34-1595"><a href="#cb34-1595" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (submit)</span>
<span id="cb34-1596"><a href="#cb34-1596" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb34-1597"><a href="#cb34-1597" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;input name=submit type=submit style="margin: 0 0.75em" value="</span><span class="sc">${</span></span>
<span id="cb34-1598"><a href="#cb34-1598" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typeof</span> submit <span class="op">==</span> <span class="st">"string"</span> <span class="op">?</span> submit <span class="op">:</span> <span class="st">"Submit"</span></span>
<span id="cb34-1599"><a href="#cb34-1599" aria-hidden="true" tabindex="-1"></a>      <span class="sc">}</span><span class="vs">" /&gt;`</span></span>
<span id="cb34-1600"><a href="#cb34-1600" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb34-1601"><a href="#cb34-1601" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb34-1602"><a href="#cb34-1602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html</span><span class="vs">`&lt;output name=output style="font: 14px Menlo, Consolas, monospace; margin-left: 0.1em; text-align:center;"&gt;&lt;/output&gt;`</span></span>
<span id="cb34-1603"><a href="#cb34-1603" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb34-1604"><a href="#cb34-1604" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (title)</span>
<span id="cb34-1605"><a href="#cb34-1605" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">prepend</span>(</span>
<span id="cb34-1606"><a href="#cb34-1606" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"&gt;</span><span class="sc">${</span>title<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb34-1607"><a href="#cb34-1607" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb34-1608"><a href="#cb34-1608" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (description)</span>
<span id="cb34-1609"><a href="#cb34-1609" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb34-1610"><a href="#cb34-1610" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font-size: 0.85rem; font-style: italic; margin-top: 3px;"&gt;</span><span class="sc">${</span>description<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb34-1611"><a href="#cb34-1611" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb34-1612"><a href="#cb34-1612" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (format)</span>
<span id="cb34-1613"><a href="#cb34-1613" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> <span class="kw">typeof</span> format <span class="op">===</span> <span class="st">"function"</span> <span class="op">?</span> format <span class="op">:</span> d3format<span class="op">.</span><span class="fu">format</span>(format)<span class="op">;</span></span>
<span id="cb34-1614"><a href="#cb34-1614" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (action) {</span>
<span id="cb34-1615"><a href="#cb34-1615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">action</span>(form)<span class="op">;</span></span>
<span id="cb34-1616"><a href="#cb34-1616" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb34-1617"><a href="#cb34-1617" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> verb <span class="op">=</span> submit</span>
<span id="cb34-1618"><a href="#cb34-1618" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onsubmit"</span></span>
<span id="cb34-1619"><a href="#cb34-1619" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"button"</span></span>
<span id="cb34-1620"><a href="#cb34-1620" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onclick"</span></span>
<span id="cb34-1621"><a href="#cb34-1621" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"checkbox"</span> <span class="op">||</span> type <span class="op">==</span> <span class="st">"radio"</span></span>
<span id="cb34-1622"><a href="#cb34-1622" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onchange"</span></span>
<span id="cb34-1623"><a href="#cb34-1623" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="st">"oninput"</span><span class="op">;</span></span>
<span id="cb34-1624"><a href="#cb34-1624" aria-hidden="true" tabindex="-1"></a>    form[verb] <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb34-1625"><a href="#cb34-1625" aria-hidden="true" tabindex="-1"></a>      e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb34-1626"><a href="#cb34-1626" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> value <span class="op">=</span> getValue <span class="op">?</span> <span class="fu">getValue</span>(form<span class="op">.</span><span class="at">input</span>) <span class="op">:</span> form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb34-1627"><a href="#cb34-1627" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (form<span class="op">.</span><span class="at">output</span>) {</span>
<span id="cb34-1628"><a href="#cb34-1628" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> out <span class="op">=</span> display <span class="op">?</span> <span class="fu">display</span>(value) <span class="op">:</span> format <span class="op">?</span> <span class="fu">format</span>(value) <span class="op">:</span> value<span class="op">;</span></span>
<span id="cb34-1629"><a href="#cb34-1629" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (out <span class="kw">instanceof</span> <span class="bu">window</span><span class="op">.</span><span class="at">Element</span>) {</span>
<span id="cb34-1630"><a href="#cb34-1630" aria-hidden="true" tabindex="-1"></a>          <span class="cf">while</span> (form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">hasChildNodes</span>()) {</span>
<span id="cb34-1631"><a href="#cb34-1631" aria-hidden="true" tabindex="-1"></a>            form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">removeChild</span>(form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">lastChild</span>)<span class="op">;</span></span>
<span id="cb34-1632"><a href="#cb34-1632" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb34-1633"><a href="#cb34-1633" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">append</span>(out)<span class="op">;</span></span>
<span id="cb34-1634"><a href="#cb34-1634" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb34-1635"><a href="#cb34-1635" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> out<span class="op">;</span></span>
<span id="cb34-1636"><a href="#cb34-1636" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb34-1637"><a href="#cb34-1637" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb34-1638"><a href="#cb34-1638" aria-hidden="true" tabindex="-1"></a>      form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb34-1639"><a href="#cb34-1639" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb34-1640"><a href="#cb34-1640" aria-hidden="true" tabindex="-1"></a>        form<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb34-1641"><a href="#cb34-1641" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb34-1642"><a href="#cb34-1642" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb34-1643"><a href="#cb34-1643" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">stopPropagation</span>() <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb34-1644"><a href="#cb34-1644" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"onsubmit"</span>) form<span class="op">.</span><span class="at">onsubmit</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb34-1645"><a href="#cb34-1645" aria-hidden="true" tabindex="-1"></a>    form[verb]()<span class="op">;</span></span>
<span id="cb34-1646"><a href="#cb34-1646" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1647"><a href="#cb34-1647" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (form<span class="op">.</span><span class="at">childNodes</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb34-1648"><a href="#cb34-1648" aria-hidden="true" tabindex="-1"></a>    wrapper<span class="op">.</span><span class="fu">appendChild</span>(form<span class="op">.</span><span class="at">childNodes</span>[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb34-1649"><a href="#cb34-1649" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1650"><a href="#cb34-1650" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(wrapper)<span class="op">;</span></span>
<span id="cb34-1651"><a href="#cb34-1651" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb34-1652"><a href="#cb34-1652" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1653"><a href="#cb34-1653" aria-hidden="true" tabindex="-1"></a>d3format <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3-format@1"</span>)</span>
<span id="cb34-1654"><a href="#cb34-1654" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@enjalot/draggable-world-map-coordinates-input</span></span>
<span id="cb34-1655"><a href="#cb34-1655" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">worldMapCoordinates</span>(config <span class="op">=</span> {}<span class="op">,</span> dimensions) {</span>
<span id="cb34-1656"><a href="#cb34-1656" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb34-1657"><a href="#cb34-1657" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> []<span class="op">,</span> title<span class="op">,</span> description<span class="op">,</span> width <span class="op">=</span> dimensions[<span class="dv">0</span>]</span>
<span id="cb34-1658"><a href="#cb34-1658" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(config) <span class="op">?</span> {<span class="dt">value</span><span class="op">:</span> config} <span class="op">:</span> config<span class="op">;</span></span>
<span id="cb34-1659"><a href="#cb34-1659" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> dimensions[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb34-1660"><a href="#cb34-1660" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> [lon<span class="op">,</span> lat] <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb34-1661"><a href="#cb34-1661" aria-hidden="true" tabindex="-1"></a>  lon <span class="op">=</span> lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb34-1662"><a href="#cb34-1662" aria-hidden="true" tabindex="-1"></a>  lat <span class="op">=</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb34-1663"><a href="#cb34-1663" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formEl <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form id="formEl" style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px;"&gt;&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb34-1664"><a href="#cb34-1664" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> context <span class="op">=</span> DOM<span class="op">.</span><span class="fu">context2d</span>(width<span class="op">,</span> height<span class="op">-</span>width<span class="op">/</span><span class="dv">14</span>)<span class="op">;</span></span>
<span id="cb34-1665"><a href="#cb34-1665" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> canvas <span class="op">=</span> context<span class="op">.</span><span class="at">canvas</span><span class="op">;</span></span>
<span id="cb34-1666"><a href="#cb34-1666" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">margin</span> <span class="op">=</span> <span class="vs">`0px 0px -26px 0px`</span><span class="op">;</span></span>
<span id="cb34-1667"><a href="#cb34-1667" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb34-1668"><a href="#cb34-1668" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoEquirectangular</span>()</span>
<span id="cb34-1669"><a href="#cb34-1669" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">precision</span>(<span class="fl">0.1</span>)</span>
<span id="cb34-1670"><a href="#cb34-1670" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitSize</span>([width<span class="op">,</span> height]<span class="op">,</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> })<span class="op">.</span><span class="fu">rotate</span>([<span class="op">-</span><span class="dv">153</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb34-1671"><a href="#cb34-1671" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection<span class="op">,</span> context)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">2.5</span>)<span class="op">;</span></span>
<span id="cb34-1672"><a href="#cb34-1672" aria-hidden="true" tabindex="-1"></a>  formEl<span class="op">.</span><span class="fu">append</span>(canvas)<span class="op">;</span></span>
<span id="cb34-1673"><a href="#cb34-1673" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">draw</span>() {</span>
<span id="cb34-1674"><a href="#cb34-1674" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">;</span></span>
<span id="cb34-1675"><a href="#cb34-1675" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fillRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb34-1676"><a href="#cb34-1676" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span>})<span class="op">;</span></span>
<span id="cb34-1677"><a href="#cb34-1677" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb34-1678"><a href="#cb34-1678" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb34-1679"><a href="#cb34-1679" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb34-1680"><a href="#cb34-1680" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(graticule)<span class="op">;</span></span>
<span id="cb34-1681"><a href="#cb34-1681" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">;</span></span>
<span id="cb34-1682"><a href="#cb34-1682" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="vs">`#aaa`</span><span class="op">;</span></span>
<span id="cb34-1683"><a href="#cb34-1683" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb34-1684"><a href="#cb34-1684" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb34-1685"><a href="#cb34-1685" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(land)<span class="op">;</span></span>
<span id="cb34-1686"><a href="#cb34-1686" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb34-1687"><a href="#cb34-1687" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb34-1688"><a href="#cb34-1688" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb34-1689"><a href="#cb34-1689" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(countries)<span class="op">;</span></span>
<span id="cb34-1690"><a href="#cb34-1690" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="op">.</span><span class="dv">95</span><span class="op">;</span></span>
<span id="cb34-1691"><a href="#cb34-1691" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#aaa"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb34-1692"><a href="#cb34-1692" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb34-1693"><a href="#cb34-1693" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#fff"</span> <span class="op">:</span> <span class="st">"#000"</span><span class="op">;</span></span>
<span id="cb34-1694"><a href="#cb34-1694" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">font</span> <span class="op">=</span> width <span class="op">&lt;</span> <span class="dv">760</span> <span class="op">?</span> <span class="st">"14px serif"</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">990</span> <span class="op">?</span> <span class="st">"17px serif"</span> <span class="op">:</span> <span class="st">"23px serif"</span><span class="op">;</span></span>
<span id="cb34-1695"><a href="#cb34-1695" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="dv">82</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">8.8</span>])))<span class="op">;</span></span>
<span id="cb34-1696"><a href="#cb34-1696" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="op">-</span><span class="dv">66</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">1.1</span>])))<span class="op">;</span></span>
<span id="cb34-1697"><a href="#cb34-1697" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">,</span> <span class="fu">path</span>(night)<span class="op">,</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"rgba(0,0,255,0.1)"</span><span class="op">,</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb34-1698"><a href="#cb34-1698" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> sun})<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"#0008"</span><span class="op">;</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"#ff08"</span><span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb34-1699"><a href="#cb34-1699" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> lat <span class="op">!=</span> <span class="kw">null</span>) {</span>
<span id="cb34-1700"><a href="#cb34-1700" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">;</span></span>
<span id="cb34-1701"><a href="#cb34-1701" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb34-1702"><a href="#cb34-1702" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb34-1703"><a href="#cb34-1703" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">14</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">;</span></span>
<span id="cb34-1704"><a href="#cb34-1704" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb34-1705"><a href="#cb34-1705" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-1706"><a href="#cb34-1706" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1707"><a href="#cb34-1707" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> drag <span class="op">=</span> d3<span class="op">.</span><span class="fu">drag</span>()</span>
<span id="cb34-1708"><a href="#cb34-1708" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> (<span class="bu">event</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb34-1709"><a href="#cb34-1709" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([<span class="bu">event</span><span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb34-1710"><a href="#cb34-1710" aria-hidden="true" tabindex="-1"></a>      lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb34-1711"><a href="#cb34-1711" aria-hidden="true" tabindex="-1"></a>      lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb34-1712"><a href="#cb34-1712" aria-hidden="true" tabindex="-1"></a>      <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb34-1713"><a href="#cb34-1713" aria-hidden="true" tabindex="-1"></a>      canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb34-1714"><a href="#cb34-1714" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb34-1715"><a href="#cb34-1715" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(canvas)<span class="op">.</span><span class="fu">call</span>(drag)</span>
<span id="cb34-1716"><a href="#cb34-1716" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span>(ev) {</span>
<span id="cb34-1717"><a href="#cb34-1717" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> { offsetX<span class="op">,</span> offsetY } <span class="op">=</span> ev<span class="op">;</span></span>
<span id="cb34-1718"><a href="#cb34-1718" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([offsetX<span class="op">,</span> offsetY])<span class="op">;</span></span>
<span id="cb34-1719"><a href="#cb34-1719" aria-hidden="true" tabindex="-1"></a>    lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb34-1720"><a href="#cb34-1720" aria-hidden="true" tabindex="-1"></a>    lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb34-1721"><a href="#cb34-1721" aria-hidden="true" tabindex="-1"></a>    <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb34-1722"><a href="#cb34-1722" aria-hidden="true" tabindex="-1"></a>    canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb34-1723"><a href="#cb34-1723" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb34-1724"><a href="#cb34-1724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb34-1725"><a href="#cb34-1725" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">input</span>({</span>
<span id="cb34-1726"><a href="#cb34-1726" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"worldMapCoordinates"</span><span class="op">,</span></span>
<span id="cb34-1727"><a href="#cb34-1727" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb34-1728"><a href="#cb34-1728" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb34-1729"><a href="#cb34-1729" aria-hidden="true" tabindex="-1"></a>    <span class="dt">display</span><span class="op">:</span> v <span class="kw">=&gt;</span> (width <span class="op">&gt;</span> <span class="dv">300</span>) <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;div style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px; white-space: nowrap; color: window.darkmode ? #fff : #000; text-align: center; font: </span><span class="sc">${</span>width <span class="op">/</span> <span class="dv">40</span><span class="sc">}</span><span class="vs">px monospace; position: relative; top: </span><span class="sc">${</span><span class="op">-</span><span class="dv">16</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span><span class="sc">}</span><span class="vs">px;  margin-bottom: -.4em;"&gt;</span></span>
<span id="cb34-1730"><a href="#cb34-1730" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Zone:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> <span class="fu">long2zone</span>(lon) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb34-1731"><a href="#cb34-1731" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb34-1732"><a href="#cb34-1732" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Longitude:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">long2turn</span>(lon))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb34-1733"><a href="#cb34-1733" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb34-1734"><a href="#cb34-1734" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Latitude:&lt;/span&gt; </span><span class="sc">${</span>lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">lati2turn</span>(lat))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb34-1735"><a href="#cb34-1735" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="op">,</span></span>
<span id="cb34-1736"><a href="#cb34-1736" aria-hidden="true" tabindex="-1"></a>    <span class="dt">getValue</span><span class="op">:</span> () <span class="kw">=&gt;</span> [lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span>]<span class="op">,</span></span>
<span id="cb34-1737"><a href="#cb34-1737" aria-hidden="true" tabindex="-1"></a>    <span class="dt">form</span><span class="op">:</span> formEl</span>
<span id="cb34-1738"><a href="#cb34-1738" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb34-1739"><a href="#cb34-1739" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb34-1740"><a href="#cb34-1740" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1741"><a href="#cb34-1741" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb34-1742"><a href="#cb34-1742" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByClassName</span>(<span class="st">"quarto-color-scheme-toggle"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span> (e) {</span>
<span id="cb34-1743"><a href="#cb34-1743" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">quartoToggleColorScheme</span>()<span class="op">;</span></span>
<span id="cb34-1744"><a href="#cb34-1744" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb34-1745"><a href="#cb34-1745" aria-hidden="true" tabindex="-1"></a>  worldMapCoordinates<span class="op">.</span><span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb34-1746"><a href="#cb34-1746" aria-hidden="true" tabindex="-1"></a>  app<span class="op">.</span><span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb34-1747"><a href="#cb34-1747" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb34-1748"><a href="#cb34-1748" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb34-1749"><a href="#cb34-1749" aria-hidden="true" tabindex="-1"></a>sun <span class="op">=</span> {</span>
<span id="cb34-1750"><a href="#cb34-1750" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> now <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span><span class="op">;</span></span>
<span id="cb34-1751"><a href="#cb34-1751" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> day <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="op">+</span>now)<span class="op">.</span><span class="fu">setUTCHours</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb34-1752"><a href="#cb34-1752" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> t <span class="op">=</span> solar<span class="op">.</span><span class="fu">century</span>(now)<span class="op">;</span></span>
<span id="cb34-1753"><a href="#cb34-1753" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> longitude <span class="op">=</span> (day <span class="op">-</span> now) <span class="op">/</span> <span class="fl">864e5</span> <span class="op">*</span> <span class="dv">360</span> <span class="op">-</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb34-1754"><a href="#cb34-1754" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [longitude <span class="op">-</span> solar<span class="op">.</span><span class="fu">equationOfTime</span>(t) <span class="op">/</span> <span class="dv">4</span><span class="op">,</span> solar<span class="op">.</span><span class="fu">declination</span>(t)]<span class="op">;</span></span>
<span id="cb34-1755"><a href="#cb34-1755" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1756"><a href="#cb34-1756" aria-hidden="true" tabindex="-1"></a>night <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoCircle</span>()</span>
<span id="cb34-1757"><a href="#cb34-1757" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">radius</span>(<span class="dv">90</span>)</span>
<span id="cb34-1758"><a href="#cb34-1758" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">center</span>(<span class="fu">antipode</span>(sun))</span>
<span id="cb34-1759"><a href="#cb34-1759" aria-hidden="true" tabindex="-1"></a>  ()</span>
<span id="cb34-1760"><a href="#cb34-1760" aria-hidden="true" tabindex="-1"></a>antipode <span class="op">=</span> ([longitude<span class="op">,</span> latitude]) <span class="kw">=&gt;</span> [longitude <span class="op">+</span> <span class="dv">180</span><span class="op">,</span> <span class="op">-</span>latitude]</span>
<span id="cb34-1761"><a href="#cb34-1761" aria-hidden="true" tabindex="-1"></a>solar <span class="op">=</span> <span class="pp">require</span>(<span class="st">"solar-calculator@0.3/dist/solar-calculator.min.js"</span>)</span>
<span id="cb34-1762"><a href="#cb34-1762" aria-hidden="true" tabindex="-1"></a>viewof fancySecondsOFF <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({</span>
<span id="cb34-1763"><a href="#cb34-1763" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Ticking clock"</span><span class="op">,</span></span>
<span id="cb34-1764"><a href="#cb34-1764" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb34-1765"><a href="#cb34-1765" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-1766"><a href="#cb34-1766" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setStyle</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb34-1767"><a href="#cb34-1767" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb34-1768"><a href="#cb34-1768" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb34-1769"><a href="#cb34-1769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb34-1770"><a href="#cb34-1770" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1771"><a href="#cb34-1771" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb34-1772"><a href="#cb34-1772" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb34-1773"><a href="#cb34-1773" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;=</span> <span class="fl">0.6</span> <span class="op">?</span> <span class="st">"#111"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb34-1774"><a href="#cb34-1774" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 1px"</span><span class="op">,</span></span>
<span id="cb34-1775"><a href="#cb34-1775" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb34-1776"><a href="#cb34-1776" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb34-1777"><a href="#cb34-1777" aria-hidden="true" tabindex="-1"></a>    fontSize <span class="op">=</span> <span class="st">"1em"</span><span class="op">,</span></span>
<span id="cb34-1778"><a href="#cb34-1778" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb34-1779"><a href="#cb34-1779" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb34-1780"><a href="#cb34-1780" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb34-1781"><a href="#cb34-1781" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb34-1782"><a href="#cb34-1782" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb34-1783"><a href="#cb34-1783" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb34-1784"><a href="#cb34-1784" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb34-1785"><a href="#cb34-1785" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb34-1786"><a href="#cb34-1786" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb34-1787"><a href="#cb34-1787" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb34-1788"><a href="#cb34-1788" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1789"><a href="#cb34-1789" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb34-1790"><a href="#cb34-1790" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb34-1791"><a href="#cb34-1791" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb34-1792"><a href="#cb34-1792" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1793"><a href="#cb34-1793" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">textcolor</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb34-1794"><a href="#cb34-1794" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb34-1795"><a href="#cb34-1795" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb34-1796"><a href="#cb34-1796" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"#000"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb34-1797"><a href="#cb34-1797" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 5px"</span><span class="op">,</span></span>
<span id="cb34-1798"><a href="#cb34-1798" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb34-1799"><a href="#cb34-1799" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb34-1800"><a href="#cb34-1800" aria-hidden="true" tabindex="-1"></a>    fontFamily <span class="op">=</span> <span class="st">"monospace"</span><span class="op">,</span></span>
<span id="cb34-1801"><a href="#cb34-1801" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb34-1802"><a href="#cb34-1802" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb34-1803"><a href="#cb34-1803" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb34-1804"><a href="#cb34-1804" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb34-1805"><a href="#cb34-1805" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb34-1806"><a href="#cb34-1806" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb34-1807"><a href="#cb34-1807" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb34-1808"><a href="#cb34-1808" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb34-1809"><a href="#cb34-1809" aria-hidden="true" tabindex="-1"></a>    fontFamily<span class="op">,</span></span>
<span id="cb34-1810"><a href="#cb34-1810" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb34-1811"><a href="#cb34-1811" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb34-1812"><a href="#cb34-1812" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1813"><a href="#cb34-1813" aria-hidden="true" tabindex="-1"></a>elapsed <span class="op">=</span> {</span>
<span id="cb34-1814"><a href="#cb34-1814" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-1815"><a href="#cb34-1815" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb34-1816"><a href="#cb34-1816" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> Promises<span class="op">.</span><span class="fu">tick</span>(<span class="dv">864</span><span class="op">,</span> <span class="op">++</span>i)<span class="op">;</span></span>
<span id="cb34-1817"><a href="#cb34-1817" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1818"><a href="#cb34-1818" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1819"><a href="#cb34-1819" aria-hidden="true" tabindex="-1"></a>piecewiseColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">piecewise</span>(d3<span class="op">.</span><span class="at">interpolateRgb</span><span class="op">,</span> [</span>
<span id="cb34-1820"><a href="#cb34-1820" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0   0 red</span></span>
<span id="cb34-1821"><a href="#cb34-1821" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f50"</span><span class="op">,</span>    <span class="co">//  0.25  20 yr</span></span>
<span id="cb34-1822"><a href="#cb34-1822" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f60"</span><span class="op">,</span>    <span class="co">//  0.5   24 yr orangered</span></span>
<span id="cb34-1823"><a href="#cb34-1823" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f70"</span><span class="op">,</span>    <span class="co">//  0.75  28 yr</span></span>
<span id="cb34-1824"><a href="#cb34-1824" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f90"</span><span class="op">,</span>    <span class="co">//  1     36 yr orange</span></span>
<span id="cb34-1825"><a href="#cb34-1825" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fb0"</span><span class="op">,</span>    <span class="co">//  1.25  44 yr</span></span>
<span id="cb34-1826"><a href="#cb34-1826" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fc0"</span><span class="op">,</span>    <span class="co">//  1.5   48 yr yelloworange</span></span>
<span id="cb34-1827"><a href="#cb34-1827" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fd0"</span><span class="op">,</span>    <span class="co">//  1.75  52 yr</span></span>
<span id="cb34-1828"><a href="#cb34-1828" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ff0"</span><span class="op">,</span>    <span class="co">//  2     60 yellow</span></span>
<span id="cb34-1829"><a href="#cb34-1829" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ef0"</span><span class="op">,</span>    <span class="co">//  2.25  64 gy</span></span>
<span id="cb34-1830"><a href="#cb34-1830" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#df0"</span><span class="op">,</span>    <span class="co">//  2.5   68 gy limeyellow</span></span>
<span id="cb34-1831"><a href="#cb34-1831" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#cf0"</span><span class="op">,</span>    <span class="co">//  2.75  72 gy</span></span>
<span id="cb34-1832"><a href="#cb34-1832" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#af0"</span><span class="op">,</span>    <span class="co">//  3     80 gy lime</span></span>
<span id="cb34-1833"><a href="#cb34-1833" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#8f0"</span><span class="op">,</span>    <span class="co">//  3.25  88 gy</span></span>
<span id="cb34-1834"><a href="#cb34-1834" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#7f0"</span><span class="op">,</span>    <span class="co">//  3.5   92 gy greenlime</span></span>
<span id="cb34-1835"><a href="#cb34-1835" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#6f0"</span><span class="op">,</span>    <span class="co">//  3.75  96 gy</span></span>
<span id="cb34-1836"><a href="#cb34-1836" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f0"</span><span class="op">,</span>    <span class="co">//  4    120 green</span></span>
<span id="cb34-1837"><a href="#cb34-1837" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f7"</span><span class="op">,</span>    <span class="co">//  4.25 148 cg</span></span>
<span id="cb34-1838"><a href="#cb34-1838" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f9"</span><span class="op">,</span>    <span class="co">//  4.5  156 cg cyangreen</span></span>
<span id="cb34-1839"><a href="#cb34-1839" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0fb"</span><span class="op">,</span>    <span class="co">//  4.75 164 cg</span></span>
<span id="cb34-1840"><a href="#cb34-1840" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0ff"</span><span class="op">,</span>    <span class="co">//  5    180 cyan</span></span>
<span id="cb34-1841"><a href="#cb34-1841" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0cf"</span><span class="op">,</span>    <span class="co">//  5.25 192 bc</span></span>
<span id="cb34-1842"><a href="#cb34-1842" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0bf"</span><span class="op">,</span>    <span class="co">//  5.5  196 bc azurecyan</span></span>
<span id="cb34-1843"><a href="#cb34-1843" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0af"</span><span class="op">,</span>    <span class="co">//  5.75 200 bc</span></span>
<span id="cb34-1844"><a href="#cb34-1844" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#08f"</span><span class="op">,</span>    <span class="co">//  6    208 bc azure</span></span>
<span id="cb34-1845"><a href="#cb34-1845" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#06f"</span><span class="op">,</span>    <span class="co">//  6.25 216 bc</span></span>
<span id="cb34-1846"><a href="#cb34-1846" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#05f"</span><span class="op">,</span>    <span class="co">//  6.5  220 bc blueazure</span></span>
<span id="cb34-1847"><a href="#cb34-1847" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#04f"</span><span class="op">,</span>    <span class="co">//  6.75 224 bc</span></span>
<span id="cb34-1848"><a href="#cb34-1848" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#00f"</span><span class="op">,</span>    <span class="co">//  7    240 blue</span></span>
<span id="cb34-1849"><a href="#cb34-1849" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#50f"</span><span class="op">,</span>    <span class="co">//  7.25 260 mb</span></span>
<span id="cb34-1850"><a href="#cb34-1850" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#60f"</span><span class="op">,</span>    <span class="co">//  7.5  264 mb purpleblue</span></span>
<span id="cb34-1851"><a href="#cb34-1851" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#70f"</span><span class="op">,</span>    <span class="co">//  7.75 268 mb</span></span>
<span id="cb34-1852"><a href="#cb34-1852" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#90f"</span><span class="op">,</span>    <span class="co">//  8    276 mb purple</span></span>
<span id="cb34-1853"><a href="#cb34-1853" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#b0f"</span><span class="op">,</span>    <span class="co">//  8.25 284 mb</span></span>
<span id="cb34-1854"><a href="#cb34-1854" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#c0f"</span><span class="op">,</span>    <span class="co">//  8.5  288 mb violetpurple</span></span>
<span id="cb34-1855"><a href="#cb34-1855" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#d0f"</span><span class="op">,</span>    <span class="co">//  8.75 292 mb</span></span>
<span id="cb34-1856"><a href="#cb34-1856" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0f"</span><span class="op">,</span>    <span class="co">//  9    300 magenta</span></span>
<span id="cb34-1857"><a href="#cb34-1857" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0a"</span><span class="op">,</span>    <span class="co">//  9.25 320 rm</span></span>
<span id="cb34-1858"><a href="#cb34-1858" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f08"</span><span class="op">,</span>    <span class="co">//  9.5  328 rm</span></span>
<span id="cb34-1859"><a href="#cb34-1859" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f06"</span><span class="op">,</span>    <span class="co">//  9.75 336 rm</span></span>
<span id="cb34-1860"><a href="#cb34-1860" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0        0 red</span></span>
<span id="cb34-1861"><a href="#cb34-1861" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb34-1862"><a href="#cb34-1862" aria-hidden="true" tabindex="-1"></a>slStr <span class="op">=</span> <span class="vs">`, 100%, 50%)`</span></span>
<span id="cb34-1863"><a href="#cb34-1863" aria-hidden="true" tabindex="-1"></a>elaTime <span class="op">=</span> elapsed <span class="op">%</span> <span class="fl">1e5</span></span>
<span id="cb34-1864"><a href="#cb34-1864" aria-hidden="true" tabindex="-1"></a>elaTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(elaTime<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(elaTime <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb34-1865"><a href="#cb34-1865" aria-hidden="true" tabindex="-1"></a>decMoty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> decDate <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)</span>
<span id="cb34-1866"><a href="#cb34-1866" aria-hidden="true" tabindex="-1"></a>isoYear <span class="op">=</span> decYear <span class="op">+</span> (decMoty <span class="op">&gt;</span> <span class="dv">9</span>)</span>
<span id="cb34-1867"><a href="#cb34-1867" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> decMoty <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> decMoty <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> decMoty <span class="op">-</span> <span class="dv">9</span></span>
<span id="cb34-1868"><a href="#cb34-1868" aria-hidden="true" tabindex="-1"></a>decHour <span class="op">=</span> decTime <span class="op">*</span> <span class="dv">24</span></span>
<span id="cb34-1869"><a href="#cb34-1869" aria-hidden="true" tabindex="-1"></a>decMinute <span class="op">=</span> (decHour <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb34-1870"><a href="#cb34-1870" aria-hidden="true" tabindex="-1"></a>decSecond <span class="op">=</span> (decMinute <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb34-1871"><a href="#cb34-1871" aria-hidden="true" tabindex="-1"></a>isoHour <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decHour)</span>
<span id="cb34-1872"><a href="#cb34-1872" aria-hidden="true" tabindex="-1"></a>isoMinute <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decMinute)</span>
<span id="cb34-1873"><a href="#cb34-1873" aria-hidden="true" tabindex="-1"></a>isoSecond <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decSecond)</span>
<span id="cb34-1874"><a href="#cb34-1874" aria-hidden="true" tabindex="-1"></a>decDek <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">/</span> <span class="dv">10</span>)</span>
<span id="cb34-1875"><a href="#cb34-1875" aria-hidden="true" tabindex="-1"></a>decDod <span class="op">=</span> decDate <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb34-1876"><a href="#cb34-1876" aria-hidden="true" tabindex="-1"></a>decDotm <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">-</span> (<span class="dv">153</span> <span class="op">*</span> decMoty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb34-1877"><a href="#cb34-1877" aria-hidden="true" tabindex="-1"></a>selDote <span class="op">=</span> <span class="fu">unix2dote</span>(selectedDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> <span class="dv">86400000</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb34-1878"><a href="#cb34-1878" aria-hidden="true" tabindex="-1"></a>selDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">dote2date</span>(<span class="op">...</span>selDote)[<span class="dv">1</span>])</span>
<span id="cb34-1879"><a href="#cb34-1879" aria-hidden="true" tabindex="-1"></a>selTime <span class="op">=</span> selectedHour <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb34-1880"><a href="#cb34-1880" aria-hidden="true" tabindex="-1"></a>selTimeOne <span class="op">=</span> selTime <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb34-1881"><a href="#cb34-1881" aria-hidden="true" tabindex="-1"></a>selTimeTen <span class="op">=</span> selTime <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb34-1882"><a href="#cb34-1882" aria-hidden="true" tabindex="-1"></a>selSnap <span class="op">=</span> selDate <span class="op">+</span> selTime</span>
<span id="cb34-1883"><a href="#cb34-1883" aria-hidden="true" tabindex="-1"></a>selLati <span class="op">=</span> <span class="fu">lati2turn</span>(location[<span class="dv">1</span>])</span>
<span id="cb34-1884"><a href="#cb34-1884" aria-hidden="true" tabindex="-1"></a>decDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(decDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decDate <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> isLeapYear)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1885"><a href="#cb34-1885" aria-hidden="true" tabindex="-1"></a>decTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(decTime<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decTime <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1886"><a href="#cb34-1886" aria-hidden="true" tabindex="-1"></a>selDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(selDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selDate <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1887"><a href="#cb34-1887" aria-hidden="true" tabindex="-1"></a>selLatiHsl <span class="op">=</span> <span class="fu">textcolor</span>(selLati<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>((selLati <span class="op">+</span> <span class="dv">250</span>) <span class="op">%</span> <span class="dv">250</span> <span class="op">/</span> <span class="dv">250</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1888"><a href="#cb34-1888" aria-hidden="true" tabindex="-1"></a>selTimeDay <span class="op">=</span> <span class="fu">textcolor</span>(selTimeOne<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1889"><a href="#cb34-1889" aria-hidden="true" tabindex="-1"></a>selTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1890"><a href="#cb34-1890" aria-hidden="true" tabindex="-1"></a>selTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1891"><a href="#cb34-1891" aria-hidden="true" tabindex="-1"></a>selZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1892"><a href="#cb34-1892" aria-hidden="true" tabindex="-1"></a>selSnapDay <span class="op">=</span> <span class="fu">textcolor</span>(selSnap<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">9</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1893"><a href="#cb34-1893" aria-hidden="true" tabindex="-1"></a>selSnapDec <span class="op">=</span> <span class="fu">textcolor</span>((selSnap <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">9</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1894"><a href="#cb34-1894" aria-hidden="true" tabindex="-1"></a>decZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb34-1895"><a href="#cb34-1895" aria-hidden="true" tabindex="-1"></a>isLeapYear <span class="op">=</span> decYear <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> decYear <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> decYear <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-1896"><a href="#cb34-1896" aria-hidden="true" tabindex="-1"></a>viewof selectedDate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022)</span>
<span id="cb34-1897"><a href="#cb34-1897" aria-hidden="true" tabindex="-1"></a>viewof selectedHour <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb34-1898"><a href="#cb34-1898" aria-hidden="true" tabindex="-1"></a>date2022 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getMonth</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getDate</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb34-1899"><a href="#cb34-1899" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">set</span>(input<span class="op">,</span> value) {</span>
<span id="cb34-1900"><a href="#cb34-1900" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb34-1901"><a href="#cb34-1901" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb34-1902"><a href="#cb34-1902" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-1903"><a href="#cb34-1903" aria-hidden="true" tabindex="-1"></a>hD121 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">121</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb34-1904"><a href="#cb34-1904" aria-hidden="true" tabindex="-1"></a>hD268 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">268</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb34-1905"><a href="#cb34-1905" aria-hidden="true" tabindex="-1"></a>hD305 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">305</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb34-1906"><a href="#cb34-1906" aria-hidden="true" tabindex="-1"></a>hD306 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">306</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb34-1907"><a href="#cb34-1907" aria-hidden="true" tabindex="-1"></a>h1by320 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">1</span> <span class="op">/</span> <span class="dv">320</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb34-1908"><a href="#cb34-1908" aria-hidden="true" tabindex="-1"></a>hues <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">fromEntries</span>([</span>
<span id="cb34-1909"><a href="#cb34-1909" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0083</span><span class="op">,</span></span>
<span id="cb34-1910"><a href="#cb34-1910" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0166</span><span class="op">,</span></span>
<span id="cb34-1911"><a href="#cb34-1911" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0229</span><span class="op">,</span></span>
<span id="cb34-1912"><a href="#cb34-1912" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">025</span><span class="op">,</span></span>
<span id="cb34-1913"><a href="#cb34-1913" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">287</span><span class="op">,</span></span>
<span id="cb34-1914"><a href="#cb34-1914" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0333</span><span class="op">,</span></span>
<span id="cb34-1915"><a href="#cb34-1915" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0416</span><span class="op">,</span></span>
<span id="cb34-1916"><a href="#cb34-1916" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">05</span><span class="op">,</span></span>
<span id="cb34-1917"><a href="#cb34-1917" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">125</span><span class="op">,</span></span>
<span id="cb34-1918"><a href="#cb34-1918" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">333</span><span class="op">,</span></span>
<span id="cb34-1919"><a href="#cb34-1919" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">375</span><span class="op">,</span></span>
<span id="cb34-1920"><a href="#cb34-1920" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">429</span><span class="op">,</span></span>
<span id="cb34-1921"><a href="#cb34-1921" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">533</span><span class="op">,</span></span>
<span id="cb34-1922"><a href="#cb34-1922" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">969</span><span class="op">,</span></span>
<span id="cb34-1923"><a href="#cb34-1923" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">999</span><span class="op">,</span></span>
<span id="cb34-1924"><a href="#cb34-1924" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> [i<span class="op">,</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(i))<span class="op">.</span><span class="at">h</span>])</span>
<span id="cb34-1925"><a href="#cb34-1925" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb34-1926"><a href="#cb34-1926" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb34-1927"><a href="#cb34-1927" aria-hidden="true" tabindex="-1"></a>populationByTimeZone <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"../../asset/populationByTimeZone.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb34-1928"><a href="#cb34-1928" aria-hidden="true" tabindex="-1"></a>sortedPop <span class="op">=</span> populationByTimeZone<span class="op">.</span><span class="fu">sort</span>(</span>
<span id="cb34-1929"><a href="#cb34-1929" aria-hidden="true" tabindex="-1"></a>  (a<span class="op">,</span> b) <span class="kw">=&gt;</span> sortParams[<span class="dv">1</span>] <span class="op">?</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">number</span><span class="op">,</span> b<span class="op">.</span><span class="at">number</span>) <span class="op">:</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">pop</span><span class="op">,</span> b<span class="op">.</span><span class="at">pop</span>)</span>
<span id="cb34-1930"><a href="#cb34-1930" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-1931"><a href="#cb34-1931" aria-hidden="true" tabindex="-1"></a>sortFunc <span class="op">=</span> sortParams[<span class="dv">0</span>] <span class="op">?</span> d3<span class="op">.</span><span class="at">ascending</span> <span class="op">:</span> d3<span class="op">.</span><span class="at">descending</span></span>
<span id="cb34-1932"><a href="#cb34-1932" aria-hidden="true" tabindex="-1"></a>popBySign <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(sortedPop<span class="op">,</span> v <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">sum</span>(v<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Sign</span>)</span>
<span id="cb34-1933"><a href="#cb34-1933" aria-hidden="true" tabindex="-1"></a>totalPop <span class="op">=</span> d3<span class="op">.</span><span class="fu">sum</span>(sortedPop<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)</span>
<span id="cb34-1934"><a href="#cb34-1934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-1935"><a href="#cb34-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1938"><a href="#cb34-1938" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb34-1939"><a href="#cb34-1939" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb34-1940"><a href="#cb34-1940" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: false</span></span>
<span id="cb34-1941"><a href="#cb34-1941" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb34-1942"><a href="#cb34-1942" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb34-1943"><a href="#cb34-1943" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorNight {</span></span>
<span id="cb34-1944"><a href="#cb34-1944" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #416f86;</span></span>
<span id="cb34-1945"><a href="#cb34-1945" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: white;</span></span>
<span id="cb34-1946"><a href="#cb34-1946" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 2px 0px 4px;</span></span>
<span id="cb34-1947"><a href="#cb34-1947" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-1948"><a href="#cb34-1948" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-1949"><a href="#cb34-1949" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-1950"><a href="#cb34-1950" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-1951"><a href="#cb34-1951" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorDay {</span></span>
<span id="cb34-1952"><a href="#cb34-1952" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #ffe438;</span></span>
<span id="cb34-1953"><a href="#cb34-1953" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: black;</span></span>
<span id="cb34-1954"><a href="#cb34-1954" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 3px 0px 4px;</span></span>
<span id="cb34-1955"><a href="#cb34-1955" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-1956"><a href="#cb34-1956" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-1957"><a href="#cb34-1957" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-1958"><a href="#cb34-1958" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-1959"><a href="#cb34-1959" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorBkg {</span></span>
<span id="cb34-1960"><a href="#cb34-1960" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-1961"><a href="#cb34-1961" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"white"</span> <span class="op">:</span> <span class="st">"black"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-1962"><a href="#cb34-1962" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-1963"><a href="#cb34-1963" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-1964"><a href="#cb34-1964" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-1965"><a href="#cb34-1965" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-1966"><a href="#cb34-1966" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-1967"><a href="#cb34-1967" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0 {</span></span>
<span id="cb34-1968"><a href="#cb34-1968" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(0 100% 50%);</span></span>
<span id="cb34-1969"><a href="#cb34-1969" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(0, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-1970"><a href="#cb34-1970" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-1971"><a href="#cb34-1971" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-1972"><a href="#cb34-1972" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-1973"><a href="#cb34-1973" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-1974"><a href="#cb34-1974" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-1975"><a href="#cb34-1975" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1 {</span></span>
<span id="cb34-1976"><a href="#cb34-1976" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(300 100% 50%);</span></span>
<span id="cb34-1977"><a href="#cb34-1977" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(300, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-1978"><a href="#cb34-1978" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-1979"><a href="#cb34-1979" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-1980"><a href="#cb34-1980" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-1981"><a href="#cb34-1981" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-1982"><a href="#cb34-1982" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-1983"><a href="#cb34-1983" aria-hidden="true" tabindex="-1"></a><span class="vs">.color2 {</span></span>
<span id="cb34-1984"><a href="#cb34-1984" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(280 100% 50%);</span></span>
<span id="cb34-1985"><a href="#cb34-1985" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(280, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-1986"><a href="#cb34-1986" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-1987"><a href="#cb34-1987" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-1988"><a href="#cb34-1988" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-1989"><a href="#cb34-1989" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-1990"><a href="#cb34-1990" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-1991"><a href="#cb34-1991" aria-hidden="true" tabindex="-1"></a><span class="vs">.color3 {</span></span>
<span id="cb34-1992"><a href="#cb34-1992" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(240 100% 50%);</span></span>
<span id="cb34-1993"><a href="#cb34-1993" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(240, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-1994"><a href="#cb34-1994" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-1995"><a href="#cb34-1995" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-1996"><a href="#cb34-1996" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-1997"><a href="#cb34-1997" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-1998"><a href="#cb34-1998" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-1999"><a href="#cb34-1999" aria-hidden="true" tabindex="-1"></a><span class="vs">.color4 {</span></span>
<span id="cb34-2000"><a href="#cb34-2000" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(200 100% 50%);</span></span>
<span id="cb34-2001"><a href="#cb34-2001" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(200, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2002"><a href="#cb34-2002" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2003"><a href="#cb34-2003" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2004"><a href="#cb34-2004" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2005"><a href="#cb34-2005" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2006"><a href="#cb34-2006" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2007"><a href="#cb34-2007" aria-hidden="true" tabindex="-1"></a><span class="vs">.color5 {</span></span>
<span id="cb34-2008"><a href="#cb34-2008" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(180 100% 50%);</span></span>
<span id="cb34-2009"><a href="#cb34-2009" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(180, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2010"><a href="#cb34-2010" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2011"><a href="#cb34-2011" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2012"><a href="#cb34-2012" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2013"><a href="#cb34-2013" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2014"><a href="#cb34-2014" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2015"><a href="#cb34-2015" aria-hidden="true" tabindex="-1"></a><span class="vs">.color6 {</span></span>
<span id="cb34-2016"><a href="#cb34-2016" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(120 100% 50%);</span></span>
<span id="cb34-2017"><a href="#cb34-2017" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(120, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2018"><a href="#cb34-2018" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2019"><a href="#cb34-2019" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2020"><a href="#cb34-2020" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2021"><a href="#cb34-2021" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2022"><a href="#cb34-2022" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2023"><a href="#cb34-2023" aria-hidden="true" tabindex="-1"></a><span class="vs">.color7 {</span></span>
<span id="cb34-2024"><a href="#cb34-2024" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(80 100% 50%);</span></span>
<span id="cb34-2025"><a href="#cb34-2025" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(80, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2026"><a href="#cb34-2026" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2027"><a href="#cb34-2027" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2028"><a href="#cb34-2028" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2029"><a href="#cb34-2029" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2030"><a href="#cb34-2030" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2031"><a href="#cb34-2031" aria-hidden="true" tabindex="-1"></a><span class="vs">.color8 {</span></span>
<span id="cb34-2032"><a href="#cb34-2032" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(60 100% 50%);</span></span>
<span id="cb34-2033"><a href="#cb34-2033" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(60, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2034"><a href="#cb34-2034" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2035"><a href="#cb34-2035" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2036"><a href="#cb34-2036" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2037"><a href="#cb34-2037" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2038"><a href="#cb34-2038" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2039"><a href="#cb34-2039" aria-hidden="true" tabindex="-1"></a><span class="vs">.color9 {</span></span>
<span id="cb34-2040"><a href="#cb34-2040" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(40 100% 50%);</span></span>
<span id="cb34-2041"><a href="#cb34-2041" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(40, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2042"><a href="#cb34-2042" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2043"><a href="#cb34-2043" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2044"><a href="#cb34-2044" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2045"><a href="#cb34-2045" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2046"><a href="#cb34-2046" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2047"><a href="#cb34-2047" aria-hidden="true" tabindex="-1"></a><span class="vs">.color375 {</span></span>
<span id="cb34-2048"><a href="#cb34-2048" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2049"><a href="#cb34-2049" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2050"><a href="#cb34-2050" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2051"><a href="#cb34-2051" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2052"><a href="#cb34-2052" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2053"><a href="#cb34-2053" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2054"><a href="#cb34-2054" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2055"><a href="#cb34-2055" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0083 {</span></span>
<span id="cb34-2056"><a href="#cb34-2056" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2057"><a href="#cb34-2057" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2058"><a href="#cb34-2058" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2059"><a href="#cb34-2059" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2060"><a href="#cb34-2060" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2061"><a href="#cb34-2061" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2062"><a href="#cb34-2062" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2063"><a href="#cb34-2063" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0166 {</span></span>
<span id="cb34-2064"><a href="#cb34-2064" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2065"><a href="#cb34-2065" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2066"><a href="#cb34-2066" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2067"><a href="#cb34-2067" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2068"><a href="#cb34-2068" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2069"><a href="#cb34-2069" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2070"><a href="#cb34-2070" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2071"><a href="#cb34-2071" aria-hidden="true" tabindex="-1"></a><span class="vs">.color55by24 {</span></span>
<span id="cb34-2072"><a href="#cb34-2072" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2073"><a href="#cb34-2073" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2074"><a href="#cb34-2074" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2075"><a href="#cb34-2075" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2076"><a href="#cb34-2076" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2077"><a href="#cb34-2077" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2078"><a href="#cb34-2078" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2079"><a href="#cb34-2079" aria-hidden="true" tabindex="-1"></a><span class="vs">.color125 {</span></span>
<span id="cb34-2080"><a href="#cb34-2080" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2081"><a href="#cb34-2081" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2082"><a href="#cb34-2082" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2083"><a href="#cb34-2083" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2084"><a href="#cb34-2084" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2085"><a href="#cb34-2085" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2086"><a href="#cb34-2086" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2087"><a href="#cb34-2087" aria-hidden="true" tabindex="-1"></a><span class="vs">.color025 {</span></span>
<span id="cb34-2088"><a href="#cb34-2088" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2089"><a href="#cb34-2089" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2090"><a href="#cb34-2090" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2091"><a href="#cb34-2091" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2092"><a href="#cb34-2092" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2093"><a href="#cb34-2093" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2094"><a href="#cb34-2094" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2095"><a href="#cb34-2095" aria-hidden="true" tabindex="-1"></a><span class="vs">.color287 {</span></span>
<span id="cb34-2096"><a href="#cb34-2096" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2097"><a href="#cb34-2097" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2098"><a href="#cb34-2098" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2099"><a href="#cb34-2099" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2100"><a href="#cb34-2100" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2101"><a href="#cb34-2101" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2102"><a href="#cb34-2102" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2103"><a href="#cb34-2103" aria-hidden="true" tabindex="-1"></a><span class="vs">.color333 {</span></span>
<span id="cb34-2104"><a href="#cb34-2104" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2105"><a href="#cb34-2105" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2106"><a href="#cb34-2106" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2107"><a href="#cb34-2107" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2108"><a href="#cb34-2108" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2109"><a href="#cb34-2109" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2110"><a href="#cb34-2110" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2111"><a href="#cb34-2111" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0333 {</span></span>
<span id="cb34-2112"><a href="#cb34-2112" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2113"><a href="#cb34-2113" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2114"><a href="#cb34-2114" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2115"><a href="#cb34-2115" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2116"><a href="#cb34-2116" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2117"><a href="#cb34-2117" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2118"><a href="#cb34-2118" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2119"><a href="#cb34-2119" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0416 {</span></span>
<span id="cb34-2120"><a href="#cb34-2120" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2121"><a href="#cb34-2121" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2122"><a href="#cb34-2122" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2123"><a href="#cb34-2123" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2124"><a href="#cb34-2124" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2125"><a href="#cb34-2125" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2126"><a href="#cb34-2126" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2127"><a href="#cb34-2127" aria-hidden="true" tabindex="-1"></a><span class="vs">.color429 {</span></span>
<span id="cb34-2128"><a href="#cb34-2128" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2129"><a href="#cb34-2129" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2130"><a href="#cb34-2130" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2131"><a href="#cb34-2131" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2132"><a href="#cb34-2132" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2133"><a href="#cb34-2133" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2134"><a href="#cb34-2134" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2135"><a href="#cb34-2135" aria-hidden="true" tabindex="-1"></a><span class="vs">.color05 {</span></span>
<span id="cb34-2136"><a href="#cb34-2136" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2137"><a href="#cb34-2137" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2138"><a href="#cb34-2138" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2139"><a href="#cb34-2139" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2140"><a href="#cb34-2140" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2141"><a href="#cb34-2141" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2142"><a href="#cb34-2142" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2143"><a href="#cb34-2143" aria-hidden="true" tabindex="-1"></a><span class="vs">.color533 {</span></span>
<span id="cb34-2144"><a href="#cb34-2144" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2145"><a href="#cb34-2145" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2146"><a href="#cb34-2146" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2147"><a href="#cb34-2147" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2148"><a href="#cb34-2148" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2149"><a href="#cb34-2149" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2150"><a href="#cb34-2150" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2151"><a href="#cb34-2151" aria-hidden="true" tabindex="-1"></a><span class="vs">.color969 {</span></span>
<span id="cb34-2152"><a href="#cb34-2152" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2153"><a href="#cb34-2153" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2154"><a href="#cb34-2154" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2155"><a href="#cb34-2155" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2156"><a href="#cb34-2156" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2157"><a href="#cb34-2157" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2158"><a href="#cb34-2158" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2159"><a href="#cb34-2159" aria-hidden="true" tabindex="-1"></a><span class="vs">.color999 {</span></span>
<span id="cb34-2160"><a href="#cb34-2160" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2161"><a href="#cb34-2161" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2162"><a href="#cb34-2162" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2163"><a href="#cb34-2163" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2164"><a href="#cb34-2164" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2165"><a href="#cb34-2165" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2166"><a href="#cb34-2166" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2167"><a href="#cb34-2167" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1by320 {</span></span>
<span id="cb34-2168"><a href="#cb34-2168" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2169"><a href="#cb34-2169" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2170"><a href="#cb34-2170" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2171"><a href="#cb34-2171" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2172"><a href="#cb34-2172" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2173"><a href="#cb34-2173" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2174"><a href="#cb34-2174" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2175"><a href="#cb34-2175" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD121 {</span></span>
<span id="cb34-2176"><a href="#cb34-2176" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2177"><a href="#cb34-2177" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2178"><a href="#cb34-2178" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2179"><a href="#cb34-2179" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2180"><a href="#cb34-2180" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2181"><a href="#cb34-2181" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2182"><a href="#cb34-2182" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2183"><a href="#cb34-2183" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD268 {</span></span>
<span id="cb34-2184"><a href="#cb34-2184" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2185"><a href="#cb34-2185" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2186"><a href="#cb34-2186" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2187"><a href="#cb34-2187" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2188"><a href="#cb34-2188" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2189"><a href="#cb34-2189" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2190"><a href="#cb34-2190" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2191"><a href="#cb34-2191" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD305 {</span></span>
<span id="cb34-2192"><a href="#cb34-2192" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2193"><a href="#cb34-2193" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2194"><a href="#cb34-2194" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2195"><a href="#cb34-2195" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2196"><a href="#cb34-2196" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2197"><a href="#cb34-2197" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2198"><a href="#cb34-2198" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2199"><a href="#cb34-2199" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD306 {</span></span>
<span id="cb34-2200"><a href="#cb34-2200" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb34-2201"><a href="#cb34-2201" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb34-2202"><a href="#cb34-2202" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb34-2203"><a href="#cb34-2203" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb34-2204"><a href="#cb34-2204" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb34-2205"><a href="#cb34-2205" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb34-2206"><a href="#cb34-2206" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb34-2207"><a href="#cb34-2207" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb34-2208"><a href="#cb34-2208" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb34-2209"><a href="#cb34-2209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb34-2210"><a href="#cb34-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-2211"><a href="#cb34-2211" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb34-2212"><a href="#cb34-2212" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb34-2213"><a href="#cb34-2213" aria-hidden="true" tabindex="-1"></a><span class="in">svg.barclock {</span></span>
<span id="cb34-2214"><a href="#cb34-2214" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb34-2215"><a href="#cb34-2215" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2216"><a href="#cb34-2216" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2217"><a href="#cb34-2217" aria-hidden="true" tabindex="-1"></a><span class="in">.tickLabel, .tickLabel1, .tickLabel2, .timeLabel {</span></span>
<span id="cb34-2218"><a href="#cb34-2218" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: monospace;</span></span>
<span id="cb34-2219"><a href="#cb34-2219" aria-hidden="true" tabindex="-1"></a><span class="in">  text-anchor: middle;</span></span>
<span id="cb34-2220"><a href="#cb34-2220" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2221"><a href="#cb34-2221" aria-hidden="true" tabindex="-1"></a><span class="in">.timeLabel {</span></span>
<span id="cb34-2222"><a href="#cb34-2222" aria-hidden="true" tabindex="-1"></a><span class="in">  text-anchor: start;</span></span>
<span id="cb34-2223"><a href="#cb34-2223" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2224"><a href="#cb34-2224" aria-hidden="true" tabindex="-1"></a><span class="in">.timeBar, .timeBarFull, .timeBarFullN {</span></span>
<span id="cb34-2225"><a href="#cb34-2225" aria-hidden="true" tabindex="-1"></a><span class="in">  x: 1px;</span></span>
<span id="cb34-2226"><a href="#cb34-2226" aria-hidden="true" tabindex="-1"></a><span class="in">  height: 25px;</span></span>
<span id="cb34-2227"><a href="#cb34-2227" aria-hidden="true" tabindex="-1"></a><span class="in">  rx: 5px;</span></span>
<span id="cb34-2228"><a href="#cb34-2228" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #aaa;</span></span>
<span id="cb34-2229"><a href="#cb34-2229" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2230"><a href="#cb34-2230" aria-hidden="true" tabindex="-1"></a><span class="in">.tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB, .tickB1 {</span></span>
<span id="cb34-2231"><a href="#cb34-2231" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: none;</span></span>
<span id="cb34-2232"><a href="#cb34-2232" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: #666;</span></span>
<span id="cb34-2233"><a href="#cb34-2233" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 1px;</span></span>
<span id="cb34-2234"><a href="#cb34-2234" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2235"><a href="#cb34-2235" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock {</span></span>
<span id="cb34-2236"><a href="#cb34-2236" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #000;</span></span>
<span id="cb34-2237"><a href="#cb34-2237" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;</span></span>
<span id="cb34-2238"><a href="#cb34-2238" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2239"><a href="#cb34-2239" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2240"><a href="#cb34-2240" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock #rim {</span></span>
<span id="cb34-2241"><a href="#cb34-2241" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: none;</span></span>
<span id="cb34-2242"><a href="#cb34-2242" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #999;</span></span>
<span id="cb34-2243"><a href="#cb34-2243" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3px;</span></span>
<span id="cb34-2244"><a href="#cb34-2244" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2245"><a href="#cb34-2245" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .second-hand {</span></span>
<span id="cb34-2246"><a href="#cb34-2246" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3;</span></span>
<span id="cb34-2247"><a href="#cb34-2247" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2248"><a href="#cb34-2248" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .minute-hand {</span></span>
<span id="cb34-2249"><a href="#cb34-2249" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 8;</span></span>
<span id="cb34-2250"><a href="#cb34-2250" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-linecap: round;</span></span>
<span id="cb34-2251"><a href="#cb34-2251" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2252"><a href="#cb34-2252" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hour-hand {</span></span>
<span id="cb34-2253"><a href="#cb34-2253" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 12;</span></span>
<span id="cb34-2254"><a href="#cb34-2254" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-linecap: round;</span></span>
<span id="cb34-2255"><a href="#cb34-2255" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2256"><a href="#cb34-2256" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hands-cover {</span></span>
<span id="cb34-2257"><a href="#cb34-2257" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3;</span></span>
<span id="cb34-2258"><a href="#cb34-2258" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: #fff;</span></span>
<span id="cb34-2259"><a href="#cb34-2259" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2260"><a href="#cb34-2260" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .second-tick {</span></span>
<span id="cb34-2261"><a href="#cb34-2261" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3;</span></span>
<span id="cb34-2262"><a href="#cb34-2262" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: #000;</span></span>
<span id="cb34-2263"><a href="#cb34-2263" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2264"><a href="#cb34-2264" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hour-tick {</span></span>
<span id="cb34-2265"><a href="#cb34-2265" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 8; // same as the minute hand</span></span>
<span id="cb34-2266"><a href="#cb34-2266" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2267"><a href="#cb34-2267" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .second-label {</span></span>
<span id="cb34-2268"><a href="#cb34-2268" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 18px;</span></span>
<span id="cb34-2269"><a href="#cb34-2269" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2270"><a href="#cb34-2270" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hour-label {</span></span>
<span id="cb34-2271"><a href="#cb34-2271" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 32px</span></span>
<span id="cb34-2272"><a href="#cb34-2272" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2273"><a href="#cb34-2273" aria-hidden="true" tabindex="-1"></a><span class="in">.clocks * {</span></span>
<span id="cb34-2274"><a href="#cb34-2274" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: -10px 0px 10px 0px;</span></span>
<span id="cb34-2275"><a href="#cb34-2275" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0px;</span></span>
<span id="cb34-2276"><a href="#cb34-2276" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2277"><a href="#cb34-2277" aria-hidden="true" tabindex="-1"></a><span class="in">#title-block-header &gt; div:nth-child(2) {</span></span>
<span id="cb34-2278"><a href="#cb34-2278" aria-hidden="true" tabindex="-1"></a><span class="in">  display: none;</span></span>
<span id="cb34-2279"><a href="#cb34-2279" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2280"><a href="#cb34-2280" aria-hidden="true" tabindex="-1"></a><span class="in">h4.hiddenheading, h5.hiddenheading {</span></span>
<span id="cb34-2281"><a href="#cb34-2281" aria-hidden="true" tabindex="-1"></a><span class="in">  display: none;</span></span>
<span id="cb34-2282"><a href="#cb34-2282" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2283"><a href="#cb34-2283" aria-hidden="true" tabindex="-1"></a><span class="in">div.cell-output:has(#daylightapp) {</span></span>
<span id="cb34-2284"><a href="#cb34-2284" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2285"><a href="#cb34-2285" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2286"><a href="#cb34-2286" aria-hidden="true" tabindex="-1"></a><span class="in">div.cell-output:has(#formEl) {</span></span>
<span id="cb34-2287"><a href="#cb34-2287" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2288"><a href="#cb34-2288" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2289"><a href="#cb34-2289" aria-hidden="true" tabindex="-1"></a><span class="in">#daylightapp {</span></span>
<span id="cb34-2290"><a href="#cb34-2290" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2291"><a href="#cb34-2291" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2292"><a href="#cb34-2292" aria-hidden="true" tabindex="-1"></a><span class="in">#daylightapp * {</span></span>
<span id="cb34-2293"><a href="#cb34-2293" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2294"><a href="#cb34-2294" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2295"><a href="#cb34-2295" aria-hidden="true" tabindex="-1"></a><span class="in">#solar-system * {</span></span>
<span id="cb34-2296"><a href="#cb34-2296" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2297"><a href="#cb34-2297" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2298"><a href="#cb34-2298" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepopstackedbar {</span></span>
<span id="cb34-2299"><a href="#cb34-2299" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb34-2300"><a href="#cb34-2300" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2301"><a href="#cb34-2301" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div {</span></span>
<span id="cb34-2302"><a href="#cb34-2302" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb34-2303"><a href="#cb34-2303" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2304"><a href="#cb34-2304" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form {</span></span>
<span id="cb34-2305"><a href="#cb34-2305" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 180px;</span></span>
<span id="cb34-2306"><a href="#cb34-2306" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2307"><a href="#cb34-2307" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form label {</span></span>
<span id="cb34-2308"><a href="#cb34-2308" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 120px;</span></span>
<span id="cb34-2309"><a href="#cb34-2309" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2310"><a href="#cb34-2310" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form:nth-child(1) {</span></span>
<span id="cb34-2311"><a href="#cb34-2311" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-right: 8px;</span></span>
<span id="cb34-2312"><a href="#cb34-2312" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2313"><a href="#cb34-2313" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form:nth-child(2) label {</span></span>
<span id="cb34-2314"><a href="#cb34-2314" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 110px;</span></span>
<span id="cb34-2315"><a href="#cb34-2315" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2316"><a href="#cb34-2316" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles input[type=checkbox] {</span></span>
<span id="cb34-2317"><a href="#cb34-2317" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-top: 8px;</span></span>
<span id="cb34-2318"><a href="#cb34-2318" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb34-2319"><a href="#cb34-2319" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb34-2320"><a href="#cb34-2320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>¬© Copyright 2025, Martin Laptev</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/maptv/maptv.github.io/blob/main/dec/time/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maptv" target="_blank">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/maptv" target="_blank">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:maptv@ireni.co">
      <i class="bi bi-envelope-at" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>