<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Martin Laptev">
<meta name="description" content="Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.">
<title>Martin Laptev</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../dec/snap/index.html" rel="next">
<link href="../../dec/date/index.html" rel="prev">
<link href="../../asset/deidec.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-d97bb2710b4a4d48625f4c05d48984ce.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-c058ca79acfcd20184cd7103c19a274d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-d97bb2710b4a4d48625f4c05d48984ce.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-80c16c2dd40a6f0072aec11a8b9a1ddf.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-773c43c522918c5dd5666171d6b51d55.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-80c16c2dd40a6f0072aec11a8b9a1ddf.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<meta name="mermaid-theme" content="default">
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<meta name="quarto:status" content="draft">
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../asset/style.css">
<meta name="twitter:title" content="Martin Laptev">
<meta name="twitter:description" content="Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.">
<meta name="twitter:image" content="https://maptv.github.io/asset/daywide.svg">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><div id="quarto-draft-alert" class="alert alert-warning"><i class="bi bi-pencil-square"></i>Draft</div><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../asset/deidec.svg" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Martin Laptev</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <h1 class="quarto-secondary-nav-title no-breadcrumbs">Dec Time</h1>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-tools-main tools-wide">
    <a href="https://www.github.com/maptv" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/maptv" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-linkedin"></i></a>
    <a href="mailto:maptv@ireni.co" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope-at"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-house-door" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-info-circle" role="img">
</i> 
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../cv/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-person" role="img">
</i> 
 <span class="menu-text">CV/Résumé</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../list/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-grid-3x3-gap" role="img">
</i> 
 <span class="menu-text">Article List</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../dec/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-arrow-repeat" role="img">
</i> 
 <span class="menu-text">Dec</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/date/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-date" role="img">
</i> 
 <span class="menu-text">Date</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/time/index.html" class="sidebar-item-text sidebar-link active"><i class="bi bi-clock" role="img">
</i> 
 <span class="menu-text">Time</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/snap/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-postage" role="img">
</i> 
 <span class="menu-text">Snap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../dec/span/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-range" role="img">
</i> 
 <span class="menu-text">Span</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false"><i class="bi bi-hourglass-split" role="img">
</i> 
 <span class="menu-text">History</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../history/ww2/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-2-square" role="img">
</i> 
 <span class="menu-text">World War 2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false"><i class="bi bi-robot" role="img">
</i> 
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ml/prob/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-dice-5" role="img">
</i> 
 <span class="menu-text">Probablity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../ml/llm/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-translate" role="img">
</i> 
 <span class="menu-text">Language Models</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">Software</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../git/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-git" role="img">
</i> 
 <span class="menu-text">Git</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../jupyter/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-journal-richtext" role="img">
</i> 
 <span class="menu-text">Jupyter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../observable/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-0-circle" role="img">
</i> 
 <span class="menu-text">Observable</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../positron/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-p-square" role="img">
</i> 
 <span class="menu-text">Positron</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../quarto/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-markdown" role="img">
</i> 
 <span class="menu-text">Quarto</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/filter/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-funnel" role="img">
</i> 
 <span class="menu-text">Filter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/include/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-plus" role="img">
</i> 
 <span class="menu-text">Include</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../quarto/script/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-code" role="img">
</i> 
 <span class="menu-text">Script</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../reveal/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-slides" role="img">
</i> 
 <span class="menu-text">Reveal</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#fdt" id="toc-fdt" class="nav-link active" data-scroll-target="#fdt">Fractional day time</a>
  <ul>
<li><a href="#tac" id="toc-tac" class="nav-link" data-scroll-target="#tac">Ticking analog clocks</a></li>
  <li><a href="#bcc" id="toc-bcc" class="nav-link" data-scroll-target="#bcc">Bar chart clocks</a></li>
  <li><a href="#llm" id="toc-llm" class="nav-link" data-scroll-target="#llm">Longitude latitude map</a></li>
  <li><a href="#dac" id="toc-dac" class="nav-link" data-scroll-target="#dac">Daylight area chart</a></li>
  <li><a href="#yda" id="toc-yda" class="nav-link" data-scroll-target="#yda">Yearly day aggregate (yda)</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">Epochal day aggregate (eda)</a></li>
  <li><a href="#ute" id="toc-ute" class="nav-link" data-scroll-target="#ute">UNIX time equation</a></li>
  <li><a href="#jte" id="toc-jte" class="nav-link" data-scroll-target="#jte">Julian time equation</a></li>
  <li><a href="#hms" id="toc-hms" class="nav-link" data-scroll-target="#hms">Hour minute second</a></li>
  </ul>
</li>
  <li>
<a href="#tzo" id="toc-tzo" class="nav-link" data-scroll-target="#tzo">Time zone offset</a>
  <ul>
<li><a href="#ref" id="toc-ref" class="nav-link" data-scroll-target="#ref">Rounding error fraction</a></li>
  <li><a href="#utc" id="toc-utc" class="nav-link" data-scroll-target="#utc">Coordinated Universal Time (UTC)</a></li>
  <li><a href="#mst" id="toc-mst" class="nav-link" data-scroll-target="#mst">Mean solar time</a></li>
  <li><a href="#idl" id="toc-idl" class="nav-link" data-scroll-target="#idl">International date line</a></li>
  <li><a href="#ast" id="toc-ast" class="nav-link" data-scroll-target="#ast">Apparent solar time</a></li>
  <li><a href="#eot" id="toc-eot" class="nav-link" data-scroll-target="#eot">Equation of time</a></li>
  <li><a href="#sda" id="toc-sda" class="nav-link" data-scroll-target="#sda">Solar declination angle</a></li>
  <li><a href="#sha" id="toc-sha" class="nav-link" data-scroll-target="#sha">Solar hour angle</a></li>
  <li><a href="#rdn" id="toc-rdn" class="nav-link" data-scroll-target="#rdn">Repeating decimal numbers</a></li>
  </ul>
</li>
  <li><a href="#unit" id="toc-unit" class="nav-link" data-scroll-target="#unit">Unit</a></li>
  <li><a href="#next" id="toc-next" class="nav-link" data-scroll-target="#next">Next</a></li>
  <li><a href="#cite" id="toc-cite" class="nav-link" data-scroll-target="#cite">Cite</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/maptv/maptv.github.io/blob/main/dec/time/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div><div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="eot-preview.html"><i class="bi bi-journal-code"></i>eot.ipynb</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Dec Time</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>

<div>
  <div class="description">
    <p>Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.</p>
  </div>
</div>


<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://maptv.github.io">Martin Laptev</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025+184</p>
    </div>
  </div>
  
    
  </div>
  


</header><div id="timenav">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {'theme': 'default', 'themeVariables': { 'fontSize': '32px'}}}%%
flowchart LR
   A[Dec]--&gt;B[date]--&gt;C[time]--&gt;D[snap]--&gt;E[span]
   click A "/dec"
   click B "/dec/date"
   click C "/dec/time"
   click D "/dec/snap"
   click E "/dec/span"
</pre>
</div>
<p></p>
</div>
</div>
</div>
</div>
<p>My website provides many examples of the <a href="https://quarto.org">Quarto</a> publishing and the <a href="../../dec">Dec</a> measurement systems in action. I leverage Quarto support for the <a href="https://observablehq.com/">Observable</a> data analysis and visualization system to create animated and interactive graphics like the <a href="https://en.wikipedia.org/wiki/Clock#:~:text=indicate%20time%20with%20a%20traditional%20clock%20face%20and%20moving%20hands">analog clocks</a>🕓, <a href="https://en.wikipedia.org/wiki/Bar_chart">bar📊charts</a>, <a href="https://en.wikipedia.org/wiki/Terminator_%28solar%29#:~:text=a%20moving%20line%20that%20divides%20the%20daylit%20side%20and%20the%20dark%20night%20side%20of%20a%20planetary%20body">solar☀️terminator</a> map🗺, <a href="https://en.wikipedia.org/wiki/Earth%27s_orbit">Earth🌍orbit</a> diagram, and <a href="https://en.wikipedia.org/wiki/Daylight#:~:text=the%20combination%20of%20all%20direct%20and%20indirect%20sunlight%20during%20the%20daytime">daylight</a> <a href="https://en.wikipedia.org/wiki/Area_chart#:~:text=The%20area%20between%20axis%20and%20line%20are%20commonly%20emphasized%20with%20colors">area chart</a> below.</p>
<section id="fdt" class="level4 hiddenheading"><h4 class="hiddenheading anchored" data-anchor-id="fdt">Fractional day time</h4>
<p>Dec times are measured in <a href="https://en.wikipedia.org/wiki/Decimal_time#Fractional_days:~:text=a%20decimal%20fraction%20of%20a%20day">fractional days</a>. The shortest, longest, and thinnest clock🕓hands and the top, middle, and bottom bars📊indicate the <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="thousandths of a day">millidays</span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day">centimillidays</span>, respectively, of the time since the start, <span class="point1"><span>+<span id="ojs-element-id-1"></span></span></span>, or until the end, <span class="point0"><span>-<span id="ojs-element-id-2"></span></span></span>, of the day in the Dec <a href="https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time">time zone</a>, <span><span id="ojs-element-id-3"></span>,</span> at the location of the red⭕️circle on the map🗺️beneath the bars📊.</p>
<section id="tac" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="tac">Ticking analog clocks</h5>
<div class="clocks">
<p><span><span id="ojs-element-id-4"></span></span></p>
</div>
</section><section id="bcc" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="bcc">Bar chart clocks</h5>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="57" data-source-offset="-51"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 56;"><span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>barChart <span class="op">=</span> {</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeats)))</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeats))</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDD)<span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDD))</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMils)<span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMils))</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 550 ? 12 : W &lt; 650 ? 14 : W &lt; 750 ? 16 : W &lt; 850 ? 18 : 20}px`)</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`+</span><span class="sc">${</span>barDD<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMils<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeats<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topbar"</span>)<span class="op">;</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>barChart1 <span class="op">=</span> {</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const scaleDek = d3.scaleLinear()</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .domain([0, 37])</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .range(xRange);</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>      <span class="co">// 'dek', 'dotd',</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeatsN)))</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeatsN))</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDDN)<span class="op">+</span><span class="bu">Number</span>(barMilsN)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDDN))</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMilsN)<span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMilsN))</span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 350 ? 12 : W &lt; 450 ? 14 : W &lt; 550 ? 16 : W &lt; 650 ? 18 : 20}px`)</span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-294"><a href="#cb1-294" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb1-295"><a href="#cb1-295" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-296"><a href="#cb1-296" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-297"><a href="#cb1-297" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-298"><a href="#cb1-298" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb1-299"><a href="#cb1-299" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-300"><a href="#cb1-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb1-301"><a href="#cb1-301" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-302"><a href="#cb1-302" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb1-303"><a href="#cb1-303" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb1-304"><a href="#cb1-304" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-305"><a href="#cb1-305" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-306"><a href="#cb1-306" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-307"><a href="#cb1-307" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb1-308"><a href="#cb1-308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-309"><a href="#cb1-309" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-310"><a href="#cb1-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-311"><a href="#cb1-311" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb1-312"><a href="#cb1-312" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb1-313"><a href="#cb1-313" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`-</span><span class="sc">${</span>barDDN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMilsN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeatsN<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb1-314"><a href="#cb1-314" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-315"><a href="#cb1-315" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-316"><a href="#cb1-316" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb1-317"><a href="#cb1-317" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb1-318"><a href="#cb1-318" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-319"><a href="#cb1-319" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb1-320"><a href="#cb1-320" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb1-321"><a href="#cb1-321" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmbar"</span>)<span class="op">;</span></span>
<span id="cb1-322"><a href="#cb1-322" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb1-323"><a href="#cb1-323" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-324"><a href="#cb1-324" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</section><section id="llm" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="llm">Longitude latitude map</h5>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="330" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 329;"><span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>viewof location <span class="op">=</span> <span class="fu">worldMapCoordinates</span>([<span class="dv">162</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [width <span class="op">*</span> <span class="op">.</span><span class="dv">998</span><span class="op">,</span> ((<span class="dv">21</span> <span class="op">/</span> <span class="dv">40</span>) <span class="op">*</span> width)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
</section><section id="dac" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="dac">Daylight area chart</h5>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="339" data-source-offset="-68"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 338;"><span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> {</span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(width<span class="op">,</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">97</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">96</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">94</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">.</span><span class="dv">93</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">.</span><span class="dv">92</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">.</span><span class="dv">86</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">.</span><span class="dv">82</span> <span class="op">:</span> <span class="op">.</span><span class="dv">78</span>)))<span class="op">;</span></span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">style</span>(<span class="st">"user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"-webkit-user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"daylightapp"</span>)<span class="op">;</span></span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> {<span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">inner</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">;</span></span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> contentWidth <span class="op">=</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">inner</span><span class="op">;</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> columnWidth <span class="op">=</span> contentWidth <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> selection <span class="op">=</span> {</span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> date2022<span class="op">,</span></span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hour</span><span class="op">:</span> date2022<span class="op">.</span><span class="fu">getHours</span>()</span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderPlot <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#plot *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">select</span>(<span class="st">"#plot"</span>)<span class="op">.</span><span class="fu">call</span>(daylightPlot<span class="op">,</span> {</span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vizwidth</span><span class="op">:</span> columnWidth <span class="op">/</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.25</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.4</span> <span class="op">:</span> <span class="fl">1.48</span>)<span class="op">,</span></span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>      <span class="dt">height</span><span class="op">:</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.6</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.58</span> <span class="op">:</span> <span class="fl">1.56</span>)<span class="op">,</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>      <span class="dt">year</span><span class="op">:</span> <span class="dv">2022</span><span class="op">,</span></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>      <span class="dt">latitude</span><span class="op">:</span> location[<span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultDate</span><span class="op">:</span> selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultHour</span><span class="op">:</span> selection<span class="op">.</span><span class="at">hour</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderSolarSystem <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system"</span>)<span class="op">.</span><span class="fu">call</span>(solarSystem<span class="op">,</span></span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>                                        columnWidth <span class="op">*</span> <span class="fl">2.02</span><span class="op">,</span></span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>                                        location<span class="op">,</span></span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">hour</span><span class="op">,</span></span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>                                        <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span>)<span class="op">;</span></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const renderGlobe = () =&gt; {</span></span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe *").remove();</span></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe").call(globe, { vizwidth: columnWidth / 1.28, location, ...selection });</span></span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> setSelection <span class="op">=</span> (newSelection<span class="op">,</span> forceRender <span class="op">=</span> <span class="kw">false</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prev <span class="op">=</span> {<span class="op">...</span>selection}<span class="op">;</span></span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> newSelection<span class="op">;</span></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="at">value</span> <span class="op">=</span> selection<span class="op">;</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedDate<span class="op">,</span> selection<span class="op">.</span><span class="at">date</span>)<span class="op">;</span></span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedHour<span class="op">,</span> selection<span class="op">.</span><span class="at">hour</span>)<span class="op">;</span></span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (forceRender) {</span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderPlot</span>()<span class="op">;</span></span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (prev<span class="op">.</span><span class="at">hour</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">hour</span> <span class="op">||</span> prev<span class="op">.</span><span class="at">date</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">date</span>) {</span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plot <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"plot"</span>)</span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">0</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>height <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">12</span> <span class="op">:</span> <span class="dv">5</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"solar-system"</span>)</span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">12</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">22</span> <span class="op">-</span> <span class="dv">6</span> <span class="op">-</span> <span class="dv">5</span> <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>  <span class="co">// svg.append("g")</span></span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("id", "globe")</span></span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("transform", `translate(${margin.left + margin.inner + columnWidth / 2 + 20}, ${margin.top + height / 1.2 + 4})`);</span></span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setSelection</span>(selection<span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateHourChange <span class="op">=</span> ({ target<span class="op">,</span> <span class="dt">detail</span><span class="op">:</span> { date<span class="op">,</span> hour }}) <span class="kw">=&gt;</span> {</span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (date <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> hour <span class="op">!=</span> <span class="kw">null</span>) <span class="fu">setSelection</span>({<span class="op">...</span>selection<span class="op">,</span> date<span class="op">,</span> hour})<span class="op">;</span></span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">addEventListener</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> handleDateHourChange<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@d3/simple-clock</span></span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@drio/lets-build-an-analog-clock</span></span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a>clock <span class="op">=</span> {</span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb3-414"><a href="#cb3-414" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb3-415"><a href="#cb3-415" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-416"><a href="#cb3-416" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb3-417"><a href="#cb3-417" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-418"><a href="#cb3-418" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb3-419"><a href="#cb3-419" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb3-420"><a href="#cb3-420" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb3-421"><a href="#cb3-421" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb3-422"><a href="#cb3-422" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb3-423"><a href="#cb3-423" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb3-424"><a href="#cb3-424" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb3-425"><a href="#cb3-425" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-426"><a href="#cb3-426" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-427"><a href="#cb3-427" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb3-428"><a href="#cb3-428" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb3-429"><a href="#cb3-429" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-430"><a href="#cb3-430" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-431"><a href="#cb3-431" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb3-432"><a href="#cb3-432" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb3-433"><a href="#cb3-433" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-434"><a href="#cb3-434" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb3-435"><a href="#cb3-435" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-436"><a href="#cb3-436" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb3-437"><a href="#cb3-437" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb3-438"><a href="#cb3-438" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-439"><a href="#cb3-439" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-440"><a href="#cb3-440" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb3-441"><a href="#cb3-441" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-442"><a href="#cb3-442" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb3-443"><a href="#cb3-443" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb3-444"><a href="#cb3-444" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-445"><a href="#cb3-445" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-446"><a href="#cb3-446" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb3-447"><a href="#cb3-447" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-448"><a href="#cb3-448" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb3-449"><a href="#cb3-449" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb3-450"><a href="#cb3-450" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb3-451"><a href="#cb3-451" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-452"><a href="#cb3-452" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb3-453"><a href="#cb3-453" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb3-454"><a href="#cb3-454" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb3-455"><a href="#cb3-455" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb3-456"><a href="#cb3-456" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb3-457"><a href="#cb3-457" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-458"><a href="#cb3-458" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb3-459"><a href="#cb3-459" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-460"><a href="#cb3-460" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb3-461"><a href="#cb3-461" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-462"><a href="#cb3-462" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb3-463"><a href="#cb3-463" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb3-464"><a href="#cb3-464" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-465"><a href="#cb3-465" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-466"><a href="#cb3-466" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb3-467"><a href="#cb3-467" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-468"><a href="#cb3-468" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-469"><a href="#cb3-469" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb3-470"><a href="#cb3-470" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb3-471"><a href="#cb3-471" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-472"><a href="#cb3-472" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb3-473"><a href="#cb3-473" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-474"><a href="#cb3-474" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb3-475"><a href="#cb3-475" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb3-476"><a href="#cb3-476" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-477"><a href="#cb3-477" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-478"><a href="#cb3-478" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb3-479"><a href="#cb3-479" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-480"><a href="#cb3-480" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-481"><a href="#cb3-481" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-482"><a href="#cb3-482" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-483"><a href="#cb3-483" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb3-484"><a href="#cb3-484" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb3-485"><a href="#cb3-485" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-486"><a href="#cb3-486" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-487"><a href="#cb3-487" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb3-488"><a href="#cb3-488" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-489"><a href="#cb3-489" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb3-490"><a href="#cb3-490" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-491"><a href="#cb3-491" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-492"><a href="#cb3-492" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-493"><a href="#cb3-493" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb3-494"><a href="#cb3-494" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-495"><a href="#cb3-495" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-496"><a href="#cb3-496" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb3-497"><a href="#cb3-497" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb3-498"><a href="#cb3-498" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-499"><a href="#cb3-499" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-500"><a href="#cb3-500" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb3-501"><a href="#cb3-501" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-502"><a href="#cb3-502" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-503"><a href="#cb3-503" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-504"><a href="#cb3-504" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb3-505"><a href="#cb3-505" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-506"><a href="#cb3-506" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-507"><a href="#cb3-507" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-508"><a href="#cb3-508" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-509"><a href="#cb3-509" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb3-510"><a href="#cb3-510" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-511"><a href="#cb3-511" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-512"><a href="#cb3-512" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb3-513"><a href="#cb3-513" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb3-514"><a href="#cb3-514" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-515"><a href="#cb3-515" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-516"><a href="#cb3-516" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-517"><a href="#cb3-517" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-518"><a href="#cb3-518" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb3-519"><a href="#cb3-519" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-520"><a href="#cb3-520" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb3-521"><a href="#cb3-521" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-522"><a href="#cb3-522" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb3-523"><a href="#cb3-523" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-524"><a href="#cb3-524" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-525"><a href="#cb3-525" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-526"><a href="#cb3-526" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb3-527"><a href="#cb3-527" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-528"><a href="#cb3-528" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb3-529"><a href="#cb3-529" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-530"><a href="#cb3-530" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-531"><a href="#cb3-531" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-532"><a href="#cb3-532" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-533"><a href="#cb3-533" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb3-534"><a href="#cb3-534" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb3-535"><a href="#cb3-535" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb3-536"><a href="#cb3-536" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-537"><a href="#cb3-537" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-538"><a href="#cb3-538" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb3-539"><a href="#cb3-539" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb3-540"><a href="#cb3-540" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-541"><a href="#cb3-541" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-542"><a href="#cb3-542" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb3-543"><a href="#cb3-543" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTime[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-544"><a href="#cb3-544" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb3-545"><a href="#cb3-545" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb3-546"><a href="#cb3-546" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-547"><a href="#cb3-547" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb3-548"><a href="#cb3-548" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb3-549"><a href="#cb3-549" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb3-550"><a href="#cb3-550" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb3-551"><a href="#cb3-551" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb3-552"><a href="#cb3-552" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topclock"</span>)<span class="op">;</span></span>
<span id="cb3-553"><a href="#cb3-553" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb3-554"><a href="#cb3-554" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-555"><a href="#cb3-555" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`+</span><span class="sc">${</span>decTime<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb3-556"><a href="#cb3-556" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb3-557"><a href="#cb3-557" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb3-558"><a href="#cb3-558" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-559"><a href="#cb3-559" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb3-560"><a href="#cb3-560" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb3-561"><a href="#cb3-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb3-562"><a href="#cb3-562" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb3-563"><a href="#cb3-563" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb3-564"><a href="#cb3-564" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb3-565"><a href="#cb3-565" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb3-566"><a href="#cb3-566" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb3-567"><a href="#cb3-567" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-568"><a href="#cb3-568" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb3-569"><a href="#cb3-569" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-570"><a href="#cb3-570" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb3-571"><a href="#cb3-571" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-572"><a href="#cb3-572" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-573"><a href="#cb3-573" aria-hidden="true" tabindex="-1"></a>clock1 <span class="op">=</span> {</span>
<span id="cb3-574"><a href="#cb3-574" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb3-575"><a href="#cb3-575" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb3-576"><a href="#cb3-576" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-577"><a href="#cb3-577" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb3-578"><a href="#cb3-578" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb3-579"><a href="#cb3-579" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-580"><a href="#cb3-580" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb3-581"><a href="#cb3-581" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb3-582"><a href="#cb3-582" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-583"><a href="#cb3-583" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb3-584"><a href="#cb3-584" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb3-585"><a href="#cb3-585" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb3-586"><a href="#cb3-586" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb3-587"><a href="#cb3-587" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb3-588"><a href="#cb3-588" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb3-589"><a href="#cb3-589" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb3-590"><a href="#cb3-590" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb3-591"><a href="#cb3-591" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb3-592"><a href="#cb3-592" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-593"><a href="#cb3-593" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-594"><a href="#cb3-594" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb3-595"><a href="#cb3-595" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb3-596"><a href="#cb3-596" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-597"><a href="#cb3-597" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb3-598"><a href="#cb3-598" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb3-599"><a href="#cb3-599" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb3-600"><a href="#cb3-600" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-601"><a href="#cb3-601" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb3-602"><a href="#cb3-602" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-603"><a href="#cb3-603" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb3-604"><a href="#cb3-604" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb3-605"><a href="#cb3-605" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-606"><a href="#cb3-606" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-607"><a href="#cb3-607" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb3-608"><a href="#cb3-608" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-609"><a href="#cb3-609" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb3-610"><a href="#cb3-610" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb3-611"><a href="#cb3-611" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-612"><a href="#cb3-612" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb3-613"><a href="#cb3-613" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb3-614"><a href="#cb3-614" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb3-615"><a href="#cb3-615" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb3-616"><a href="#cb3-616" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb3-617"><a href="#cb3-617" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb3-618"><a href="#cb3-618" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-619"><a href="#cb3-619" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb3-620"><a href="#cb3-620" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb3-621"><a href="#cb3-621" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb3-622"><a href="#cb3-622" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb3-623"><a href="#cb3-623" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb3-624"><a href="#cb3-624" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-625"><a href="#cb3-625" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb3-626"><a href="#cb3-626" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-627"><a href="#cb3-627" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb3-628"><a href="#cb3-628" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-629"><a href="#cb3-629" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb3-630"><a href="#cb3-630" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb3-631"><a href="#cb3-631" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-632"><a href="#cb3-632" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-633"><a href="#cb3-633" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb3-634"><a href="#cb3-634" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-635"><a href="#cb3-635" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-636"><a href="#cb3-636" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb3-637"><a href="#cb3-637" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb3-638"><a href="#cb3-638" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-639"><a href="#cb3-639" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb3-640"><a href="#cb3-640" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-641"><a href="#cb3-641" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb3-642"><a href="#cb3-642" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb3-643"><a href="#cb3-643" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-644"><a href="#cb3-644" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-645"><a href="#cb3-645" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb3-646"><a href="#cb3-646" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-647"><a href="#cb3-647" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-648"><a href="#cb3-648" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-649"><a href="#cb3-649" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-650"><a href="#cb3-650" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb3-651"><a href="#cb3-651" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb3-652"><a href="#cb3-652" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-653"><a href="#cb3-653" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-654"><a href="#cb3-654" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb3-655"><a href="#cb3-655" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-656"><a href="#cb3-656" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb3-657"><a href="#cb3-657" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-658"><a href="#cb3-658" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-659"><a href="#cb3-659" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-660"><a href="#cb3-660" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb3-661"><a href="#cb3-661" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-662"><a href="#cb3-662" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-663"><a href="#cb3-663" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb3-664"><a href="#cb3-664" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb3-665"><a href="#cb3-665" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-666"><a href="#cb3-666" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-667"><a href="#cb3-667" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb3-668"><a href="#cb3-668" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb3-669"><a href="#cb3-669" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-670"><a href="#cb3-670" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-671"><a href="#cb3-671" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb3-672"><a href="#cb3-672" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-673"><a href="#cb3-673" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb3-674"><a href="#cb3-674" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb3-675"><a href="#cb3-675" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb3-676"><a href="#cb3-676" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb3-677"><a href="#cb3-677" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-678"><a href="#cb3-678" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb3-679"><a href="#cb3-679" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb3-680"><a href="#cb3-680" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb3-681"><a href="#cb3-681" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-682"><a href="#cb3-682" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-683"><a href="#cb3-683" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb3-684"><a href="#cb3-684" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb3-685"><a href="#cb3-685" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb3-686"><a href="#cb3-686" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-687"><a href="#cb3-687" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb3-688"><a href="#cb3-688" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-689"><a href="#cb3-689" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb3-690"><a href="#cb3-690" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-691"><a href="#cb3-691" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb3-692"><a href="#cb3-692" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-693"><a href="#cb3-693" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb3-694"><a href="#cb3-694" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-695"><a href="#cb3-695" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb3-696"><a href="#cb3-696" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-697"><a href="#cb3-697" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb3-698"><a href="#cb3-698" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-699"><a href="#cb3-699" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-700"><a href="#cb3-700" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb3-701"><a href="#cb3-701" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb3-702"><a href="#cb3-702" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb3-703"><a href="#cb3-703" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb3-704"><a href="#cb3-704" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb3-705"><a href="#cb3-705" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb3-706"><a href="#cb3-706" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb3-707"><a href="#cb3-707" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb3-708"><a href="#cb3-708" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-709"><a href="#cb3-709" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb3-710"><a href="#cb3-710" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTimeN[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-711"><a href="#cb3-711" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb3-712"><a href="#cb3-712" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb3-713"><a href="#cb3-713" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-714"><a href="#cb3-714" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb3-715"><a href="#cb3-715" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb3-716"><a href="#cb3-716" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb3-717"><a href="#cb3-717" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb3-718"><a href="#cb3-718" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb3-719"><a href="#cb3-719" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmclock"</span>)<span class="op">;</span></span>
<span id="cb3-720"><a href="#cb3-720" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb3-721"><a href="#cb3-721" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-722"><a href="#cb3-722" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`-</span><span class="sc">${</span>decTimeN<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb3-723"><a href="#cb3-723" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb3-724"><a href="#cb3-724" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb3-725"><a href="#cb3-725" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb3-726"><a href="#cb3-726" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb3-727"><a href="#cb3-727" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb3-728"><a href="#cb3-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb3-729"><a href="#cb3-729" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb3-730"><a href="#cb3-730" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb3-731"><a href="#cb3-731" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb3-732"><a href="#cb3-732" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb3-733"><a href="#cb3-733" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb3-734"><a href="#cb3-734" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb3-735"><a href="#cb3-735" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb3-736"><a href="#cb3-736" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-737"><a href="#cb3-737" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb3-738"><a href="#cb3-738" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-739"><a href="#cb3-739" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<p>To rotate the globe🌐in the Earth🌏orbit diagram, drag the red⭕️circle horizontally↔︎️or slide the red🔴dot on the daylight area chart vertically↕. The red⭕️circle’s vertical↕position determines the yearly daylight pattern visualized by the area chart. Shift the red<font color="red">—</font>line on the area chart horizontally↔︎️to move the globe🌐along the ellipse of the Earth🌎orbit.</p>
</section><section id="yda" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="yda">Yearly day aggregate (yda)</h5>
<p>The red<font color="red">—</font>line indicates a “day of year” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span>), <span><span id="ojs-element-id-5"></span>,</span> and the red🔴dot denotes a “time of day” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>): <span><span id="ojs-element-id-6"></span>.</span> A <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> identifies a day in a year like a <a href="https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world">Gregorian calendar</a> month and “day of month” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day of month">dom</span>). A <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> specifies a point in a day like an “hour minute second” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span>) triplet. Together, a <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> can form a “yearly day aggregate” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="yearly day aggregate">yda</span>): <span><span id="ojs-element-id-7"></span>.</span></p>
<p><span class="math display">\[\text{yda} = \text{doy} + \text{tod}\]</span></p>
<p><span class="math display">\[\lfloor\text{yda}\rfloor = \text{doy}\]</span></p>
<p><span class="math display">\[\text{yda} - \text{doy} = \text{tod}\]</span></p>
<p>As their names suggest, <span class="tool" data-bs-toggle="tooltip" data-bs-title="days of year">doys</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="yearly day aggregates">ydas</span> are measured in days. The <a href="https://en.wikipedia.org/wiki/Unit_of_measurement#:~:text=a%20definite%20magnitude%20of%20a%20quantity">measurement unit</a> of a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> can be a day or a <a href="https://en.wikipedia.org/wiki/Multiple_%28mathematics%29#Submultiple:~:text=of%20%22a%20being-,a%20unit%20fraction,-of%20b%22%20">submultiple</a> of a day. By changing how a decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> is measured, we can shift its <a href="https://en.wikipedia.org/wiki/Decimal_separator#:~:text=a%20symbol%20that%20separates%20the%20integer%20part%20from%20the%20fractional%20part%20of%20a%20number">decimal separator</a> or turn it into an integer. The <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> along the y-axis of the area chart are integers because they have three digits and are measured in <span class="tool" data-bs-toggle="tooltip" data-bs-title="thousandths of a day">millidays</span>.</p>
</section><section id="eda" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="eda">Epochal day aggregate (eda)</h5>
<p>We can turn an <span class="tool" data-bs-toggle="tooltip" data-bs-title="yearly day aggregate">yda</span> into a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> by <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">keeping the remainder after dividing</a> by one to isolate the <a href="https://en.wikipedia.org/wiki/Fractional_part#:~:text=the%20excess%20beyond%20that%20number%27s%20integer%20part">decimal part</a> of the <a href="https://en.wikipedia.org/wiki/Quotient#:~:text=a%20quantity%20produced%20by%20the%20division%20of%20two%20numbers">quotient</a>: <span><span id="ojs-element-id-8"></span></span> <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 = <span><span id="ojs-element-id-9"></span>.</span> We can use this same approach to obtain a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> from an “epochal day aggregate” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="epochal day aggregate">eda</span>): <span><span id="ojs-element-id-10"></span></span> mod 1 = <span><span id="ojs-element-id-11"></span>.</span> The current <span class="tool" data-bs-toggle="tooltip" data-bs-title="epochal day aggregate">eda</span> tells us how many days have passed since the Dec <a href="https://en.wikipedia.org/wiki/Epoch#:~:text=an%20instant%20in%20time%20chosen%20as%20the%20origin%20of%20a%20particular%20calendar%20era">epoch</a>.</p>
<p><span class="math display">\[\text{tod} = \text{yda mod } 1 = \text{eda mod } 1\]</span></p>
</section><section id="ute" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="ute">UNIX time equation</h5>
<p>Similarly, <a href="https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970%2C%20the%20Unix%20epoch">UNIX time</a> tallies the seconds since the <a href="https://en.wikipedia.org/wiki/Unix_time#:~:text=00%3A00%3A00%20UTC%20on%201%C2%A0January%201970">UNIX epoch</a>, which is exactly 719468 days after the Dec epoch. To get the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> in Zone <span class="color0">0</span>, the Dec time zone that is in between the two leftmost vertical lines on the map🗺️, we can divide UNIX time by the <a href="https://en.wikipedia.org/wiki/Day#:~:text=average%2C%20this%20is-,24%20hours%20(86%2C400%20seconds),-.%20As%20a%20day">number of seconds in a day</a> and then keep the remainder after dividing the resulting days by one:</p>
<p><span class="math display">\[\text{tod} = \text{unix} \div 86400 \text{ mod } 1\]</span></p>
</section><section id="jte" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="jte">Julian time equation</h5>
<p><a href="https://en.wikipedia.org/wiki/Julian_day#:~:text=the%20Julian%20day%20number%20plus%20the%20fraction%20of%20a%20day%20since%20the%20preceding%20noon">Julian dates</a> track the days since the beginning of the <a href="https://en.wikipedia.org/wiki/Julian_day#:~:text=a%20chronological%20interval%20of%207980%C2%A0years%2C%20derived%20from%20three%20multi%2Dyear%20cycles:%20the%20Indiction%2C%20Solar%2C%20and%20Lunar%20cycles">Julian period</a> and thus are akin to <span class="tool" data-bs-toggle="tooltip" data-bs-title="epochal day aggregates">edas</span>. We can produce a Zone <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> from a <a href="https://en.wikipedia.org/wiki/Julian_day#:~:text=the%20Julian%20day%20number%20plus%20the%20fraction%20of%20a%20day%20since%20the%20preceding%20noon">Julian date</a> simply by keeping the remainder after dividing by one. If we want a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> instead, we should add <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> to the Julian date before converting it to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> to ensure that the final result is less than one day:</p>
<p><span class="math display">\[\text{tod} = (\text{julian} + 0.5) \text{ mod } 1\]</span></p>
</section><section id="hms" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="hms">Hour minute second</h5>
<p>We can also obtain a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> from a <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet by summing its components after converting them to fractional days, as shown in the equation below. The <a href="https://en.wikipedia.org/wiki/Computer_programming#:~:text=the%20composition%20of%20sequences%20of%20instructions%2C%20called%20programs%2C%20that%20computers%20can%20follow%20to%20perform%20tasks">computer programming</a> code in the <a href="https://quarto.org/docs/interactive/layout.html#tabset-panel">tabset panel</a> beneath the equation compares <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> derived from <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> and UNIX time as Quarto was <a href="https://quarto.org/docs/get-started/hello/rstudio.html#rendering:~:text=When%20rendering%2C%20Quarto%20generates%20a%20new%20file%20that%20contains%20selected%20text%2C%20code%2C%20and%20results">rendering</a> this webpage.</p>
<p><span class="math display">\[\text{tod} = \frac{\text{hour}}{24} + \frac{\text{minute}}{1440} + \frac{\text{second}}{86400}\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Julia</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Observable JavaScript</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">R</a></li>
</ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Dates</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="fu">now</span>(UTC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2025-07-17T18:14:41.900</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hour</span>(hms) <span class="op">/</span> <span class="fl">24</span> <span class="op">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">minute</span>(hms) <span class="op">/</span> <span class="fl">1440</span> <span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">second</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">millisecond</span>(hms) <span class="op">/</span> <span class="fl">864e5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7602071759259259</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datetime2unix</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">%</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7602071759283717</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-startfrom="797" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 796;"><span id="cb10-797"><a href="#cb10-797" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb10-798"><a href="#cb10-798" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCHours</span>() <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span></span>
<span id="cb10-799"><a href="#cb10-799" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCMinutes</span>() <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span></span>
<span id="cb10-800"><a href="#cb10-800" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCSeconds</span>() <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span></span>
<span id="cb10-801"><a href="#cb10-801" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCMilliseconds</span>() <span class="op">/</span> <span class="fl">864e5</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb11" data-startfrom="802" data-source-offset="-136"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 801;"><span id="cb11-802"><a href="#cb11-802" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getTime</span>() <span class="op">/</span> <span class="fl">864e5</span> <span class="op">%</span> <span class="dv">1</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timezone</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> datetime.now(timezone.utc)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>hms.hour <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>hms.minute <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>hms.second <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>hms.microsecond <span class="op">/</span> <span class="fl">864e8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7602234699537037</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hms.timestamp() <span class="op">/</span> <span class="dv">86400</span> <span class="op">%</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7602234699552355</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span><span class="va">hms</span><span class="op">$</span><span class="va">hour</span> <span class="op">/</span> <span class="fl">24</span> <span class="op">+</span></span>
<span><span class="va">hms</span><span class="op">$</span><span class="va">min</span> <span class="op">/</span> <span class="fl">1440</span> <span class="op">+</span></span>
<span><span class="va">hms</span><span class="op">$</span><span class="va">sec</span> <span class="op">/</span> <span class="fl">86400</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7602237</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">hms</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">86400</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7602237</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The equations below turn UNIX time or a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> into the three components of an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet: the “hour of day” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="hour of day">hod</span>), “minute of hour” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="minute of hour">moh</span>), and “second of minute” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="second of minute">som</span>), using a “daily second aggregate” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="daily second aggregate">dsa</span>) and “hourly second aggregate” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="hourly second aggregate">hsa</span>). While both count seconds, <span class="tool" data-bs-toggle="tooltip" data-bs-title="daily second aggregates">dsas</span> start at midnight and <span class="tool" data-bs-toggle="tooltip" data-bs-title="hourly second aggregates">hsas</span> begin at the <a href="https://en.wiktionary.org/wiki/top_of_the_hour">top of the hour</a>.</p>
<p><span class="math display">\[\text{dsa} = \text{tod} \times 86400 = \text{unix mod } 86400\]</span></p>
<p><span class="math display">\[\text{hsa} = \text{dsa mod } 3600\]</span></p>
<p><span class="math display">\[\text{hod} = \lfloor \text{dsa} \div 3600 \rfloor\]</span></p>
<p><span class="math display">\[\text{moh} = \lfloor \text{hsa} \div 60 \rfloor\]</span></p>
<p><span class="math display">\[\text{som} = \lfloor \text{hsa mod } 60 \rfloor\]</span></p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Julia</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Observable JavaScript</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">R</a></li>
</ul>
<div class="tab-content" data-group="language">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Dates</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>dsa <span class="op">=</span> <span class="fu">datetime2unix</span>(<span class="fu">now</span>(UTC)) <span class="op">/</span> <span class="fl">86400</span> <span class="op">%</span> <span class="fl">1</span> <span class="op">*</span> <span class="fl">86400</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1024.2920000106096</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>hsa <span class="op">=</span> dsa <span class="op">%</span> <span class="fl">3600</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1024.2920000106096</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fu">floor</span>(<span class="dt">Int</span>, x), (dsa <span class="op">/</span> <span class="fl">3600</span>, hsa <span class="op">/</span> <span class="fl">60</span>, hsa <span class="op">%</span> <span class="fl">60</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0, 17, 4)</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26" data-startfrom="854" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 853;"><span id="cb26-854"><a href="#cb26-854" aria-hidden="true" tabindex="-1"></a>dsa <span class="op">=</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>() <span class="op">/</span> <span class="fl">864e5</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">86400</span><span class="op">;</span></span>
<span id="cb26-855"><a href="#cb26-855" aria-hidden="true" tabindex="-1"></a>hsa <span class="op">=</span> dsa <span class="op">%</span> <span class="dv">3600</span><span class="op">;</span></span>
<span id="cb26-856"><a href="#cb26-856" aria-hidden="true" tabindex="-1"></a>[dsa <span class="op">/</span> <span class="dv">3600</span><span class="op">,</span> hsa <span class="op">/</span> <span class="dv">60</span><span class="op">,</span> hsa <span class="op">%</span> <span class="dv">60</span>]<span class="op">.</span><span class="fu">map</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timezone</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>dsa <span class="op">=</span> datetime.now(timezone.utc).timestamp() <span class="op">/</span> <span class="dv">86400</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">86400</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>hsa <span class="op">=</span> dsa <span class="op">%</span> <span class="dv">3600</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">tuple</span>(<span class="bu">map</span>(<span class="bu">int</span>, [dsa <span class="op">//</span> <span class="dv">3600</span>, hsa <span class="op">//</span> <span class="dv">60</span>, hsa <span class="op">%</span> <span class="dv">60</span> <span class="op">//</span> <span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0, 17, 5)</code></pre>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dsa</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">86400</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">1</span> <span class="op">*</span> <span class="fl">86400</span></span>
<span><span class="va">hsa</span> <span class="op">&lt;-</span> <span class="va">dsa</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">3600</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dsa</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="fl">3600</span>, <span class="va">hsa</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="fl">60</span>, <span class="va">hsa</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">60</span><span class="op">)</span>, <span class="va">as.integer</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0 17  5</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The <a href="https://en.wikipedia.org/wiki/Global_Positioning_System#:~:text=a%20satellite%2Dbased%20hyperbolic%20navigation%20system">Global Positioning System</a>, <a href="https://en.wikipedia.org/wiki/BeiDou#:~:text=a%20satellite%2Dbased%20radio%20navigation%20system">BeiDou</a>, and <a href="https://en.wikipedia.org/wiki/Galileo_(satellite_navigation)#:~:text=a%20global%20navigation%20satellite%20system%20(GNSS)%20created%20by%20the%20European%20Union">Galileo</a> <a href="https://en.wikipedia.org/wiki/Satellite_navigation#:~:text=a%20satellite%20navigation%20system%20with%20global%20coverage">global navigation satellite systems</a> along with most — if not all — <a href="https://en.wikipedia.org/wiki/Programming_language#:~:text=a%20system%20of%20notation%20for%20writing%20source%20code%20such%20as%20used%20to%20produce%20a%20computer%20program">programming languages</a> do not account for <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>, which appears to be for the best given that leap seconds will be <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=at%20the%2027th%20General%20Conference%20on%20Weights%20and%20Measures%2C%20it%20was%20decided%20to%20abandon%20the%20leap%20second%20by%20or%20before%202035">abolished by 2035</a>. The goal of leap seconds is to keep <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> within <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=to%20ensure%20that%20the%20difference%20between%20the%20UTC%20and%20UT1%20readings%20will%20never%20exceed%200.9%20seconds">25/24</a> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundred thousands of a day">centimillidays</span> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="centimillidays">cmds</span>) of <a href="https://en.wikipedia.org/wiki/Universal_Time#Versions:~:text=a%20time%20standard%20based%20on%20Earth%27s%20rotation">Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span>).</p>
</section></section><section id="tzo" class="level4 hiddenheading"><h4 class="hiddenheading anchored" data-anchor-id="tzo">Time zone offset</h4>
<p>Instead of leap seconds, Dec matches <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> using a “<a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">time zone offset</a>” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>). With the <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=Announced%20leap%20seconds%20to%20date">leap second insertion dates</a> provided by the <a href="https://en.wikipedia.org/wiki/International_Earth_Rotation_and_Reference_Systems_Service#:~:text=the%20body%20responsible%20for%20maintaining%20global%20time%20and%20reference%20frame%20standards">International Earth Rotation and Reference Systems Service</a>, we can approximate the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> that we need to add to the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> to obtain <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> on the <a href="../../dec/date">Dec date</a> selected by the <a href="https://observablehq.com/framework/inputs/range">range</a>🎚️inputs below: <span><span id="ojs-element-id-12"></span></span> ÷ 8640 = <span><span id="ojs-element-id-13"></span>.</span></p>
<div id="dateinput" class="cell">
<div class="sourceCode cell-code hidden" id="cb31" data-startfrom="887" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 886;"><span id="cb31-887"><a href="#cb31-887" aria-hidden="true" tabindex="-1"></a>viewof leapSecondYear <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1970</span><span class="op">,</span> <span class="dv">2020</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1995</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb31-888"><a href="#cb31-888" aria-hidden="true" tabindex="-1"></a>viewof leapSecondDate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">365</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Day"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">182</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="dateinput-1">
<div id="ojs-cell-6-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="dateinput-2">
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<section id="ref" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="ref">Rounding error fraction</h5>
<p>Of the twenty eight <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> that can be displayed above, one is an integer, one is a <a href="https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20finite%20number%20of%20nonzero%20digits">terminating decimal</a>, and the rest are <a href="https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=the%20same%20sequence%20of%20digits%20is%20repeated%20forever">repeating decimals</a>. To express a repeating decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>, Dec uses an <a href="https://en.wikipedia.org/wiki/Irreducible_fraction#:~:text=a%20fraction%20in%20which%20the%20numerator%20and%20denominator%20are%20integers%20that%20have%20no%20other%20common%20divisors%20than%201">irreducible fraction</a> that is either on its own or preceded by a “rounded offset decimal” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span>). When the fraction follows a <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span>, it is called a “<a href="https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic">rounding error</a> fraction” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span>).</p>
<p>In the equation below, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> is the minuend, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span> is the subtrahend, and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span> is the difference. Dec uses the term minuend expansion to describe the replacement of a minuend with a subtrahend and a difference. By replacing a repeating decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> with a <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span>, we can show the initial digits of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> as a decimal and the rest as a fraction.</p>
<p><span class="math display">\[\text{tzo} - \text{rod} = \text{ref}\]</span></p>
<p>Use the first three range🎚️inputs below to select an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet to be converted to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>, plugged into the equation above as the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>, rounded to the number of digits chosen by the fourth range🎚️input, and inserted into the equation as the <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span>. Once the left-hand side of the equation is complete, we can solve it to get the <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span>: <span><span id="ojs-element-id-14"></span></span> – <span><span id="ojs-element-id-15"></span></span> = <span><span id="ojs-element-id-16"></span>.</span></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb32" data-startfrom="903" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 902;"><span id="cb32-903"><a href="#cb32-903" aria-hidden="true" tabindex="-1"></a>viewof hmsinput <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb32-904"><a href="#cb32-904" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">23</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Hour"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">11</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb32-905"><a href="#cb32-905" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">59</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Minute"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb32-906"><a href="#cb32-906" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">59</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Second"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb32-907"><a href="#cb32-907" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="hmsinput" class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb33" data-startfrom="913" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 912;"><span id="cb33-913"><a href="#cb33-913" aria-hidden="true" tabindex="-1"></a>viewof digits <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">9</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Digits"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="diginput" class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
</div>
</section><section id="utc" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="utc">Coordinated Universal Time (UTC)</h5>
<p>If we obtain <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> from all of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets that can be selected with the range🎚️inputs above, we will have 10 integers, 3190 terminating decimals, and 83200 repeating decimals. When we do the same to the <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets">38</a> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>, the number of integers, terminating decimals, and repeating decimals we get depends on how many leap seconds are included.</p>
<p>Unless the number of leaps seconds included is zero or a multiple of 27, all 38 <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> will be repeating decimals. If the number of leap seconds is zero or a multiple of 8640, we will get 3 integer, 9 terminating decimals, and 26 repeating decimals. The 3 integers will be terminating decimals if the number of leap seconds is a multiple of 27 but not 8640.</p>
<p>Of the 38 <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>, 14 are negative and 24 are positive. The <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone with <a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude">the most negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span></a> is completely uninhabited. The bar📊chart below visualizes <a href="https://www.earthdata.nasa.gov/centers/sedac-daac">Socioeconomic Data and Applications Center</a> data from 2020 to show the number of people living in each <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone. The vast majority of people live in <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones with positive <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>.</p>
<div class="cell /togs">
<div class="sourceCode cell-code hidden" id="cb34" data-startfrom="928" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 927;"><span id="cb34-928"><a href="#cb34-928" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb34-929"><a href="#cb34-929" aria-hidden="true" tabindex="-1"></a>viewof sortParams <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb34-930"><a href="#cb34-930" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort ascending"</span> })<span class="op">,</span></span>
<span id="cb34-931"><a href="#cb34-931" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort by offset"</span> })<span class="op">,</span></span>
<span id="cb34-932"><a href="#cb34-932" aria-hidden="true" tabindex="-1"></a>  ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="timezonepoptoggles" class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell stackedBar">
<div class="sourceCode cell-code hidden" id="cb35" data-startfrom="939" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 938;"><span id="cb35-939"><a href="#cb35-939" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb35-940"><a href="#cb35-940" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb35-941"><a href="#cb35-941" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> width<span class="op">,</span></span>
<span id="cb35-942"><a href="#cb35-942" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb35-943"><a href="#cb35-943" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> <span class="vs">`overflow: visible;font-size:16px;`</span><span class="op">,</span></span>
<span id="cb35-944"><a href="#cb35-944" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {<span class="dt">scheme</span><span class="op">:</span> <span class="st">"RdBu"</span><span class="op">,</span> <span class="dt">className</span><span class="op">:</span> <span class="st">"barPlotLegend"</span>}<span class="op">,</span></span>
<span id="cb35-945"><a href="#cb35-945" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">75</span><span class="op">,</span></span>
<span id="cb35-946"><a href="#cb35-946" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span> }<span class="op">,</span></span>
<span id="cb35-947"><a href="#cb35-947" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Population (billions)"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">38</span><span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> d <span class="kw">=&gt;</span> d <span class="op">/</span> <span class="fl">1e9</span> }<span class="op">,</span></span>
<span id="cb35-948"><a href="#cb35-948" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb35-949"><a href="#cb35-949" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barX</span>(sortedPop<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"pop"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Sign"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"Offset"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">tip</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">,</span></span>
<span id="cb35-950"><a href="#cb35-950" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb35-951"><a href="#cb35-951" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="timezonepopstackedbar" class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="expression">

</div>
</div>
</div>
<p>Negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> only exist in <a href="https://en.wikipedia.org/wiki/Americas#:~:text=a%20landmass%20comprising%20the%20totality%20of%20North%20America%20and%20South%20America">the Americas</a> and islands in the <a href="https://en.wikipedia.org/wiki/List_of_islands_in_the_Atlantic_Ocean">Atlantic</a> and <a href="https://en.wikipedia.org/wiki/List_of_islands_in_the_Pacific_Ocean">Pacific</a> Oceans. Therefore, the bars in the chart above are essentially comparing the Americas to the rest of the world. According to 2021 <a href="https://en.wikipedia.org/wiki/United_Nations_Department_of_Economic_and_Social_Affairs#:~:text=part%20of%20the%20United%20Nations%20Secretariat">United Nations Department of Economic and Social Affairs</a> data, about one billion out of a total of almost eight billion people live in the Americas.</p>
<p>Whenever a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> is associated with a Dec date, a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, or both a date and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, Dec will add one day to the date and ten decidays to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> without modifying the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>. This typically occurs after the conversion of an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> or a “year month day” (ymd) triplet to a Dec date. As a result, all Dec dates and <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> have positive <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>.</p>
<p>Dec will not change a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> or its associated <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> if the result of adding one day to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> is uncertain. This uncertainly can only exist if we do not know whether a <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> that is equal to 364 belongs to a common or leap year. The day after Day <span class="tool" data-bs-toggle="tooltip" data-bs-title="February 28">364</span> of a common year is Day <span class="tool" data-bs-toggle="tooltip" data-bs-title="March 1">0</span> of the subsequent year. In a leap year, Day <span class="tool" data-bs-toggle="tooltip" data-bs-title="February 28">364</span> precedes Day <span class="tool" data-bs-toggle="tooltip" data-bs-title="February 29">365</span>.</p>
<p>Even though it has no effect on the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, adding one day to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> also increments the “day of month” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day of month">dom</span>) and “day of week” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day of week">dow</span>) shown by Dec.&nbsp;The table below summarizes how someone accustomed to a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> could intrepret Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of week">dow</span> numbers. From the perspective of a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> user, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of month">dom</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of week">dow</span> in Dec will be one day ahead.</p>
<div class="overflowtable" style="overflow-x:auto;overflow-y:hidden;">
<table class="table">
<thead><tr class="header">
<th>Saturday</th>
<th>Sunday</th>
<th>Monday</th>
<th>Tuesday</th>
<th>Wednesday</th>
<th>Thursday</th>
<th>Friday</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr class="even">
<td>-7</td>
<td>-6</td>
<td>-5</td>
<td>-4</td>
<td>-3</td>
<td>-2</td>
<td>-1</td>
</tr>
</tbody>
</table>
</div>
<p>The one day difference between positive and negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> may actually make Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of week">dow</span> numbers more intuitive than <a href="https://pubs.opengroup.org/onlinepubs/007904875/utilities/date.html#:~:text=weekday%20as%20a%20decimal%20number%20%5B0%2C6%5D%20(0%3Dsunday)">POSIX</a> <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of week">dow</span> numbers for speakers of languages that consider <a href="https://en.wikipedia.org/wiki/Names_of_the_days_of_the_week#:~:text=Sunday%20comes%20first,-in%20order%20in">Sunday to be the first <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of week">dow</span></a>, like Portuguese. Notably, Brazil is the largest Portuguese speaking country in the world and the second most populous country in the Americas.</p>
</section><section id="mst" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="mst">Mean solar time</h5>
<p>In Dec, <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> are closely related to <a href="https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda">longitude</a>. Dec always measures longitude in <a href="https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line">parallels</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="parallel"><span class="math inline">\(\lambda\)</span></span>) or submultiples of <span class="tool" data-bs-toggle="tooltip" data-bs-title="parallels"><span class="math inline">\(\lambda\)</span></span> like <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel">deci<a href="https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line">parallels</a></span> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span>). At any given moment, there is just one <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> for the entire world, a zonal time for every Dec time zone, and two types of <a href="https://en.wikipedia.org/wiki/Solar_time#:~:text=a%20calculation%20of%20the%20passage%20of%20time%20based%20on%20the%20position%20of%20the%20Sun%20in%20the%20sky">solar time</a> for every <a href="https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda">longitude</a>: <a href="https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year">“mean solar time”</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="mean solar time">mst</span>) and <a href="https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year">“apparent solar time”</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="apparent solar time">ast</span>).</p>
<p>In the middle of a time zone, the Dec will add one <span class="tool" data-bs-toggle="tooltip" data-bs-title="parallel"><span class="math inline">\(\lambda\)</span></span> or the equivalent amount in a <span class="tool" data-bs-toggle="tooltip" data-bs-title="parallel"><span class="math inline">\(\lambda\)</span></span> submultiple to any negative longitude.</p>
<p>Dec classifies every possible time as “zonal”, “solar”, or “other” based on its corresponding tzo.</p>
<p>measured in <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span>,to make it positive. When we floor a <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span> longitude, we get the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> of its corresponding Dec time zone. If we subtract half a <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span> to the longitude instead of flooring it, we will have the difference between the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and the <a href="https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year">“mean solar time”</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="mean solar time">mst</span>).</p>
<p>The equations in the article always assume that we are working with like units. the <span class="tool" data-bs-toggle="tooltip" data-bs-title="yearly day aggregates">ydas</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="days of year">doys</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> are measured in days. To convert to a submultiple of a day, we multiply the terms on one side of any equation by a multiple of 10.</p>
<p><span class="math display">\[\text{tzo} = \lfloor\text{d}\lambda\rfloor\]</span></p>
<p>If we subtract half a</p>
<p>starting from Longitude <span class="color0">0</span>, the Dec <a href="https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0">prime meridian</a> and <a href="https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next">“international date line”</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="international date line">idl</span>). To find the Dec time zone and <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> at a location</p>
<p>year+364.tod-tzo 364-tzo 364+tzo</p>
<p>otherwise. to positive <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> by adding one day to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>. Dec will add one day to the adds one the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet as described above, but adds one day to both the date and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>. negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> to positive <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>.</p>
<p>To convert between Dec and Gregorian calendar, Dec stores the negative tzo The <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of month">dom</span> equations below are able to adapt to negative tzos. From the perspective of anyone who uses a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>, the should interpret Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="days of month">doms</span> as zero-based numbers and <span class="tool" data-bs-toggle="tooltip" data-bs-title="days of week">dows</span> according to the table below. The range input below represents the birthday of someone born in <a href="https://en.wikipedia.org/wiki/Americas#:~:text=a%20landmass%20comprising%20the%20totality%20of%20North%20America%20and%20South%20America">the Americas</a> who thinks they were born on Day 183 but was actually born on It could be a and therefore is shifted in relation. “day of week” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="day of week">dow</span>) or The <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> of the most populous <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone in the Western Hemisphere is therefore -25/12 + <span class="color0">10</span> = 95/12. When converting the Gregorian calendar birthday of anyone born in a will have increment their b add one day. in the uses a tzo of -25/12 will think that the exactly one behind everyone Using this approach, Dec can match any possible <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>. but anyone using <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones with negative offsets. The top range input below represents a Dec refers to The <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> in <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>-25/12 is roughly one day behind Zone 8. and but The time zone is one day behind. To match -25/12. To find the Dec time zone that has the smallest time difference is closest If we add ten decidays to this <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>, we get 95/12 or rather than Zone By default, Dec adds ten decidays to all negative tzos to make them positive. Dec refers to . is -25/12 decidays behind UTC. but this approach needs to use a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> to avoid mismatches by one day. That are one day ahead of dates in <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones with negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> will be one day behind this approach results in dates that differ by one day. but</p>
<p>The <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> of the ten Dec time zones are all single-digit positive integers. The chart above does not take into account <a href="https://en.wikipedia.org/wiki/Daylight_saving_time#:~:text=the%20practice%20of%20advancing%20clocks%20to%20make%20better%20use%20of%20the%20longer%20daylight%20available%20during%20summer">“daylight savings time”</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="daylight savings time">dst</span>). Dec considers <span class="tool" data-bs-toggle="tooltip" data-bs-title="daylight savings time">dst</span> and negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> to be special requests for a minority of users. and UTC time zones offerEach of the ten time zones has a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> that is a single-digit positive integer.</p>
<p>The most populous UTC time zone with a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> is -25/12 decidays behind UTC. Some places only use this <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> for part of the year because of daylight savings time. A central design principle of Dec is to meet users where they are. Rather than inform people born in a chart above shows that this problem affects a Any date associated with a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> will exactly one day behind . Dates with negative negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> because it can match any possible <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> using only time measurement. match the time in any <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone and in fact using only positive <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>. to match any possible . Even if Dec even those associated with a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>, but the date produced by the negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> will be one day behind. Date mismatches lead to unexpected results when translating dates between the Dec and Gregorian calendars or when a “day of week” is included as part of a Dec date. We can subtract ten decidays from any positive Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> to make it negative.We can add or subtract ten <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> to switch between a positive and negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> without changing its corresponding <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>. To stay within the correct <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> range for <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>, -10 &lt; x &lt; 10, we keep only the remainder after dividing by ten.</p>
<p>and range from <span class="color5">-5</span> to <span class="color583">35/6</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> without leap seconds. and from <span class="color5">-1276/320</span> to <span class="color5">5603/960</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> with <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC"><span class="color1by320">27</span> leap seconds</a>.</p>
<p>Of the 86390 <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet-derived fractions that can be shown above, there are 8639 <a href="https://en.wikipedia.org/wiki/Fraction#Simple,_common,_or_vulgar_fractions">simple fractions</a> and 77751 <a href="https://en.wikipedia.org/wiki/Fraction#:~:text=When%20the%20numerator%20and%20the%20denominator%20are%20both%20positive%2C%20the%20fraction%20is%20called%20proper%20if%20the%20numerator%20is%20less%20than%20the%20denominator%2C%20and%20improper%20otherwise">improper fractions</a>. Among these fractions, we would find 96 unique denominators. Fractions that have different denominators are difficult to compare. Similarly, a Dec times is essentially a math expression with two terms, a tod and a tzo, that can be combined into a Zone 0 tod. We can also have a Dec time that consists of a tod, <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span></p>
<p>In addition to replacing a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> with a <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span>, . In minuend expansion, the minuend is expanded into a the first equation below, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> is the , and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span> is the difference. The second equation below shows that we can replace a minuend with a subtrahend and a difference.</p>
<p>In general, comparing fractions — especially <a href="">unlike fractions</a> — is more difficult than comparing decimals. Dec always displays <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rods</span> in decimal form for easy comparison.</p>
<p>The <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span> is the difference between the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span>:</p>
<p><span class="math display">\[\text{tzo} = \text{rod} + \text{ref}\]</span></p>
<p>The range🎚️input above chooses the number of digits in the rod. <a href="https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic">rounding error</a>. When rounded to the number of digits chosen by the range🎚️input below, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet selected by the range🎚️inputs above is <span><span id="ojs-element-id-17"></span></span> and the rounding error is <span><span id="ojs-element-id-18"></span>.</span></p>
<p>In addition to splitting a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> into a <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span>, we can split a <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="yearly day aggregate">yda</span>, or <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> into a subtrahend and a difference via a process called minuend expansion. <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> or a the difference. Dec uses the terms minuend, subtrahend, and difference to label different parts of a <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="yearly day aggregate">yda</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, or <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> that have undergone minuend expansion. When a splitting a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span> is an example of minuend expansion.</p>
<p>In the equation below, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> is the minuend, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded offset decimal">rod</span> is the subtrahend, and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="roundoff error fraction">ref</span> is the difference. <span class="math display">\[\text{tzo} - \text{rod} = \text{ref}\]</span></p>
<p>When we round a decimal number, we are essentially removing the round-off error.</p>
<p>In general, the presence of a fraction indicates that goal is to match either UT or a time in a UTC time zone.</p>
<p>After being converted to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets that can be selected by range🎚️inputs below to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>,</p>
<p>from a Each of the ten Dec time zones has a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> that is a positive single-digit <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> integer.</p>
<p>The vast majority of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets that can be selected by the range🎚️inputs above, expressed the remaining 8639 out of 8640 <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets using fractions.</p>
<p>cannot be expressed the remaining 26/27 <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets thatas fractions</p>
<p>Most Using fractions, Dec can precisely match any UTC tzo with any number of leap seconds. Dec uses fractions for decimal tzos that are derived from hms triplets like the one selected by the range🎚️inputs below. Using fractions, Dec can match any UTC tzo. Instead of showing To facilitate the comparison of a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and a tzo that comprise a Dec time, easier the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> shown above can be represented by a math expression that the sum of a and its associated <a href="https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic">round-off error</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="round-off error">roe</span>) fraction: <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> = <span class="tool" data-bs-toggle="tooltip" data-bs-title="rounded decimal offset">rdo</span> + <span class="tool" data-bs-toggle="tooltip" data-bs-title="round-off error">roe</span>.</p>
<p>After being converted to decidays, 26 out of <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets">38</a> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> are <a href="https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=the%20same%20sequence%20of%20digits%20is%20repeated%20forever">repeating decimals</a>, 9 are <a href="https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20finite%20number%20of%20nonzero%20digits">terminating decimal</a>, and 3 are integers. Instead of displaying a decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> as a fraction, Dec can round and display it along with its the <a href="https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic">round-off error</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="round-off error">roe</span>) as a fraction. Dec displays <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> derived from the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets, like the one selected by the range🎚️inputs below, as a fraction:</p>
<p>In its most basic form, a Dec time consists of a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>. Typically, all of the components of a Dec time are measured in <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>. Dec times are essentially math expressions that can be simplified to Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span>.</p>
<p>In The “Hour” range input above cannot be used to select a negative value. In essence, Dec times are math expressions that can be simplified to the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>: <span><span id="ojs-element-id-19"></span></span> – <span><span id="ojs-element-id-20"></span></span> = <span><span id="ojs-element-id-21"></span>.</span></p>
<p>If we include a sum of leap seconds that is not zero or a multiple of 8640, none of the <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets">38</a> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> will be an integer. You can The deciday value of the</p>
<p>The fractions we will have a UTC will match Zone 0 from <span class="color5">-1276/320</span> to <span class="color5">5603/960</span>. With leap seconds, none of <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> have <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> the range of <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> is <span class="color5">-5</span> to <span class="color583">35/6</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>.</p>
<p>Using <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> expressed as fractions, Dec can match the time in UTC time zones, Dec often has to To avoid date mismatches with <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones</a> that have negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>, we can subtract ten <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> from any positive <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> to make it negative: <span><span id="ojs-element-id-22"></span></span> – <span class="color0">10</span> = <span><span id="ojs-element-id-23"></span>.</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36" data-startfrom="1071" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1070;"><span id="cb36-1071"><a href="#cb36-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">frac</span>(<span class="dv">27</span>)<span class="op">.</span><span class="fu">div</span>(<span class="dv">8640</span>)<span class="op">.</span><span class="fu">add</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">320</span>)<span class="op">.</span><span class="fu">toFraction</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb37" data-startfrom="1077" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1076;"><span id="cb37-1077"><a href="#cb37-1077" aria-hidden="true" tabindex="-1"></a>viewof offset <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">9</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Offset"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="offinput" class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
<p>Disregarding leap seconds, the <a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color5">-5</span></a> time zone is exactly one day behind Zone <span class="color5">5</span> and thus has the same time but a different date. If date mismatches are not a concern, Negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> associated with a date, Dec will standardize its bring its that has an integer <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> will belong to one of the ten Dec time zones. If a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> is not an integer, Dec will either express it as All other <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> will not be compatible with any of the twn Dec time zones, but may match either <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> or the time in a <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone</a>.</p>
<p>Any <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> that is an integer will produce a time that matches the time in one of the ten Dec time zones. After being converted to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>, the latest <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> that can be selected above is a <a href="https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20finite%20number%20of%20nonzero%20digits">terminating decimal</a> and all of the others are <a href="https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=the%20same%20sequence%20of%20digits%20is%20repeated%20forever">repeating decimals</a>. In contrast, 26 out of <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets">38</a> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> are repeating decimals, 9 are terminating decimals, and 3 are integers. Dec can round it he current Zone <span class="color0">0</span> time is <span><span id="ojs-element-id-24"></span></span><span class="mono">-</span><span class="color0">0</span>. where the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> is the minuend and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> is a .</p>
<p>A Dec time consists of a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>. We can evaluate any Dec time as Dec can display a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> together as , we get a Dec time. and a tzo that differs from the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> is defined as the sum of the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>. The ten Dec time zones are labeled <span class="color0">0</span> to <span class="color9">9</span> based on their <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>. To find the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> of a location, we floor its deciparallel longitude. of the all single-digit positive integers: . To find the Dec time zone with the closest to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone with a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> can be have a similar time</p>
<p>We can combine the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> of any of the ten Dec time zones with a tod to create a .time all single-digit positive integers. We can combine an UT can be measured using vlbi with a precision greater than a fifth of a microday.</p>
<p>D Dec can either display Each of the ten Dec time zones has a tzo that is a single-digit positive integer. We can make any Dec displays <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> based on hours, minutes, and seconds as fractions to avoid rounding recurring decimal numbers. ec measures tzos in decidays. The tzos of the ten Dec time zones are all single-digit positive integers. Dec displays</p>
<p><span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> does not belong to any of the ten Dec time zones. Similarly, In general, the difference between needed to is able to support any number kk we can a zonal time is the sum of a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>. The tzo of any zonal time is a floored longitude. and solar times</p>
</section><section id="idl" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="idl">International date line</h5>
<p>Dec measures longitude in <a href="https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line">parallels</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="parallels"><span class="math inline">\(\lambda\)</span></span>) or submultiples of <span class="tool" data-bs-toggle="tooltip" data-bs-title="parallels"><span class="math inline">\(\lambda\)</span></span> starting from Longitude <span class="color0">0</span>, the Dec <a href="https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0">prime meridian</a> and <a href="https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next">“international date line”</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="international date line">idl</span>).</p>
<p>To calculate the <span class="tool" data-bs-toggle="tooltip" data-bs-title="mean solar time">mst</span> for a location, we add its longitude in <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\lambda\)</span></span> to the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and then subtract 5 <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundredths of a day">centidays</span>. If the result is negative, we can make it positive by</p>
<p><span class="math display">\[\text{mst} = \text{tod} + \lambda - 0.05\]</span></p>
<p><span class="math display">\[\text{mst} = (\text{tod} + \lambda + 0.95) \text{ mod } 1\]</span></p>
</section><section id="ast" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="ast">Apparent solar time</h5>
<p>Longitude <span class="color0">0</span> separates Zones <span class="color9">9</span> and <span class="color0">0</span>.</p>
<p>In the middle of Zone <span class="color0">0</span> is Longitude <span class="color05">0.5</span>, the Dec solar time prime meridian, which is not shown on the map🗺️above.</p>
<p>Longitude <span class="color0">0</span></p>
<p>Zonal times match <span class="tool" data-bs-toggle="tooltip" data-bs-title="mean solar time">mst</span> only in the centers of time zones.</p>
<p>In between Longitudes <span class="color0">0</span> and <span class="color1">1</span> is Zone <span class="color0">0</span>. From the perspective of Zone 0, During solar noon, when the Sun is at its highest point, the solar time</p>
<p>the leftmost vertical line on the map🗺️above, which cuts across the Atlantic Ocean through Iceland🇮🇸just West of Africa.</p>
<p>Arranging Dec time zones from 0 to 9 yields a <a href="https://en.wikipedia.org/wiki/orld_map#:~:text=south%2Dup%20map-,Pacific%2Dcentric%20map,-(more%20commonly%20used)">Pacific-centric</a> map🗺️.</p>
<p>At any given moment, there is just one UT for the entire world, a zonal time for every time zone, and two types of solar time for every longitude: “mean solar time” (mst) and “apparent solar time” (ast).</p>
<p>To The two types of , <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> in general must be greater that negative one and less than one day: -1 &lt; t &lt; 1. If we ever encounter a tod outside these bounds, we can</p>
<p><span class="math display">\[-1 &lt; \text{tod} &lt; 1\]</span></p>
<p>In Dec, <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="mean solar times">msts</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\lambda\)</span></span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="apparent solar times">asts</span> are bound between -1 and 1. equations above make sure that the The equation above works for any [tod] in days and longitude in <span class="tool" data-bs-toggle="tooltip" data-bs-title="parallels"><span class="math inline">\(\lambda\)</span></span>, even those that are outside the typical bounds. In Dec, less than zero or greater than one (0 ≤ x &lt; 1). If we ever need to deal with an negative values, we can always add one and then keep the remainder after dividing by one. Zone <span class="color0">0</span> starts at a longitude of 0 <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span> and is 1 <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span> wide. In contrast, 0.5 <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span> it is midnight in , the [mst] in Unlike <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="apparent solar time">ast</span> also varies by longitude and is cyclical on a yearly basis. To approximate <span class="tool" data-bs-toggle="tooltip" data-bs-title="apparent solar time">ast</span> for a given <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel">deci<a href="https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line">parallel</a></span> <a href="https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda">longitude</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span>) and <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span>, we sum the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span>, and the result obtained from plugging the <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> into the <a href="https://en.wikipedia.org/wiki/Equation_of_time#:~:text=the%20discrepancy%20between%20two%20kinds%20of%20solar%20time">equation of time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span>): <span><span id="ojs-element-id-25"></span></span> + <span><span id="ojs-element-id-26"></span></span> + <span><span id="ojs-element-id-27"></span></span> = <span><span id="ojs-element-id-28"></span>.</span></p>
<p><span class="math display">\[\text{mst} = (\text{tod} + \lambda + 0.95) \text{ mod } 1\]</span></p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb38" data-startfrom="1153" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1152;"><span id="cb38-1153"><a href="#cb38-1153" aria-hidden="true" tabindex="-1"></a>viewof longInput <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Longitude"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="longinput" class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
<p>The <a href="https://www.noaa.gov">National Oceanic and Atmospheric Administration</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration">NOAA</span>) provides <a href="https://gml.noaa.gov/grad/solcalc/calcdetails.html">yearly and daily <span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span> values</a>. To create a Dec version of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span>, we can sort the yearly <span class="tool" data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration">NOAA</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span> values by their <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> and then <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">fit a curve</a> to the sorted values so that we can use the fitted model coefficients (<span class="math inline">\(\beta_0\)</span> to <span class="math inline">\(\beta_4\)</span>) as the <span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span> constants in the <span class="tool" data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration">NOAA</span> <a href="https://gml.noaa.gov/grad/solcalc/solareqns.PDF">General Solar Position Calculations</a>:</p>
<p><span class="math display">\[\tau = 2 \times \pi\]</span></p>
<p><span class="math display">\[\text{toy} = \text{doy} \div \text{n}\]</span></p>
<p><span class="math display">\[\gamma = \tau \times \text{toy}\]</span></p>
<p><span class="math display">\[\begin{split}
\text{eot}(\gamma) &amp; = \beta_0 \\
&amp; + \beta_1 \times \cos(\gamma) \\
&amp; + \beta_2 \times \sin(\gamma) \\
&amp; + \beta_3 \times \cos(2\gamma) \\
&amp; + \beta_4 \times \sin(2\gamma)
\end{split}\]</span></p>
<p><span class="math display">\[\text{ast} = (\text{mst} + \text{eot}(\gamma) + 10) \mod 10\]</span></p>
</section><section id="eot" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="eot">Equation of time</h5>
<p>In the equations above, <span class="math inline">\(\tau\)</span> is two times <span class="math inline">\(\pi\)</span>, n is the number of days in a year, the “time of year” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="time of year">toy</span>) is the <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> divided by n, <span class="math inline">\(\gamma\)</span> is the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of year">toy</span> multiplied by <span class="math inline">\(\tau\)</span>, “mean solar time” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="mean solar time">mst</span>) is the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> plus <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span>. We can refer to <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span> as the <span class="tool" data-bs-toggle="tooltip" data-bs-title="mean solar time">mst</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> and the sum of <span class="tool" data-bs-toggle="tooltip" data-bs-title="deciparallels"><span class="math inline">\(\text d\lambda\)</span></span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span>(<span class="math inline">\(\gamma\)</span>) as the <span class="tool" data-bs-toggle="tooltip" data-bs-title="apparent solar time">ast</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>. Using the coefficients shown below, we can plot <span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span>(<span class="math inline">\(\gamma\)</span>) against <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span>:</p>
<div class="quarto-embed-nb-cell">
<div id="cell-eot" class="cell" data-execution_count="8">
<div id="eot" class="cell-output cell-output-display" data-execution_count="8">
<pre><code>{0: 1.4950424467725955e-05,
 1: -0.04189873301524992,
 2: -0.02923703633324393,
 3: -0.0456943801628261,
 4: 0.05175601752530743}</code></pre>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="eot-preview.html#cell-eot">Source: eot.ipynb</a></div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb40" data-startfrom="1183" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1182;"><span id="cb40-1183"><a href="#cb40-1183" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mcmcclur/plot-for-mathematicians</span></span>
<span id="cb40-1184"><a href="#cb40-1184" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb40-1185"><a href="#cb40-1185" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> w <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb40-1186"><a href="#cb40-1186" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> h <span class="op">=</span> <span class="fl">0.625</span> <span class="op">*</span> w<span class="op">;</span></span>
<span id="cb40-1187"><a href="#cb40-1187" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> samples <span class="op">=</span> <span class="fu">build_samples</span>(</span>
<span id="cb40-1188"><a href="#cb40-1188" aria-hidden="true" tabindex="-1"></a>    getEot<span class="op">,</span> <span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">365</span><span class="op">,</span> { <span class="dt">N</span><span class="op">:</span> <span class="dv">150</span> }</span>
<span id="cb40-1189"><a href="#cb40-1189" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb40-1190"><a href="#cb40-1190" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb40-1191"><a href="#cb40-1191" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb40-1192"><a href="#cb40-1192" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> w<span class="op">,</span></span>
<span id="cb40-1193"><a href="#cb40-1193" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> h<span class="op">,</span></span>
<span id="cb40-1194"><a href="#cb40-1194" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> <span class="st">"font-size:19;"</span><span class="op">,</span></span>
<span id="cb40-1195"><a href="#cb40-1195" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"time zone offset"</span>}<span class="op">,</span></span>
<span id="cb40-1196"><a href="#cb40-1196" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"day of year"</span>}<span class="op">,</span></span>
<span id="cb40-1197"><a href="#cb40-1197" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb40-1198"><a href="#cb40-1198" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">line</span>(samples<span class="op">,</span> {</span>
<span id="cb40-1199"><a href="#cb40-1199" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb40-1200"><a href="#cb40-1200" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span><span class="op">,</span></span>
<span id="cb40-1201"><a href="#cb40-1201" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tip</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb40-1202"><a href="#cb40-1202" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb40-1203"><a href="#cb40-1203" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="op">-</span><span class="dv">366</span>])<span class="op">,</span></span>
<span id="cb40-1204"><a href="#cb40-1204" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb40-1205"><a href="#cb40-1205" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb40-1206"><a href="#cb40-1206" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="op">-</span><span class="dv">366</span> })</span>
<span id="cb40-1207"><a href="#cb40-1207" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb40-1208"><a href="#cb40-1208" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb40-1209"><a href="#cb40-1209" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> plot<span class="op">;</span></span>
<span id="cb40-1210"><a href="#cb40-1210" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="eotplot" class="cell-output cell-output-display">
<div id="ojs-cell-14" data-nodetype="expression">

</div>
</div>
</div>
</section><section id="sda" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="sda">Solar declination angle</h5>
<p>We can subtract the <span class="tool" data-bs-toggle="tooltip" data-bs-title="apparent solar time">ast</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> from five to get the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> of <a href="https://en.wikipedia.org/wiki/Noon#:~:text=reaching%20its%20highest%20position%20above%20the%20horizon%20on%20that%20day%20and%20casting%20the%20shortest%20shadow">solar noon</a> at the given longitude. Before we can find the sunrise and sunset <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, we first need to calculate the solar declination angle (<span class="tool" data-bs-toggle="tooltip" data-bs-title="solar declination angle">sda</span>). For simplicity, we can use the <span class="tool" data-bs-toggle="tooltip" data-bs-title="equation of time">eot</span> for <span class="tool" data-bs-toggle="tooltip" data-bs-title="solar declination angle">sda</span>, even though the <span class="tool" data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration">NOAA</span> <a href="https://gml.noaa.gov/grad/solcalc/solareqns.PDF">General Solar Position Calculations</a> propose the more complex model shown below.</p>
<p><span class="math display">\[\text{noon} = (5 - \text{d}\lambda - \text{eot}(\gamma) + 10) \mod 10\]</span></p>
<p><span class="math display">\[\begin{split}
\text{sda}(\gamma) &amp; = \beta_0 \\
&amp; + \beta_1 \times \cos(\gamma) \\
&amp; + \beta_2 \times \sin(\gamma) \\
&amp; + \beta_3 \times \cos(2\gamma) \\
&amp; + \beta_4 \times \sin(2\gamma) \\
&amp; + \beta_5 \times \cos(3\gamma) \\
&amp; + \beta_6 \times \sin(3\gamma) \\
\end{split}\]</span></p>
</section><section id="sha" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="sha">Solar hour angle</h5>
<p>If the “solar zenith angle” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="solar zenith angle">sza</span>) in the equation below is 0.2523 turns, the equation will yield a sunrise “solar hour angle” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="solar hour angle">sha</span>) that we can use to get a sunrise or sunset <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>. Dec measures angles in turns. The trigonometric functions of most — if not all – programming languages require radians. To convert turns into radians, we multiply by <span class="math inline">\(\tau\)</span>.</p>
<p><span class="math display">\[\text{radian} = \text{turn} \times \tau = \text{degree} \times \tau \div 360\]</span></p>
<p><span class="math display">\[\text{turn} = \text{radian} \div \tau = \text{degree} \div 360\]</span></p>
<p><span class="math display">\[\text{degree} = \text{radian} \div \tau \div 360 = \text{turn} \times 360\]</span></p>
<p><span class="math display">\[\text{sha} = \arccos\left( \frac{\cos(\text{sza}\times\tau)}{\cos(\phi\times\tau) \cdot \cos(\text{sda}\times\tau)} - \tan(\text{$\phi\times\tau$}) \cdot \tan(\text{sda}\times\tau) \right)\]</span></p>
<p>In the equation above, latitude is measured in turns called meridians (<span class="math inline">\(\phi\)</span>). The difference between a solar noon and sunrise <span class="tool" data-bs-toggle="tooltip" data-bs-title="solar hour angle">sha</span> is a sunrise <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>. Likewise, the sum of a solar noon and sunrise <span class="tool" data-bs-toggle="tooltip" data-bs-title="solar hour angle">sha</span> is a sunset <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>. To get the daylight duration in decidays, we can either subtract the sunset <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tod</span> from the sunrise <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tod</span> or multiply the sunrise <span class="tool" data-bs-toggle="tooltip" data-bs-title="solar hour angle">sha</span> by twenty.</p>
<p><span class="math display">\[\text{sunrise} = \text{noon} - \text{sha}\]</span></p>
<p><span class="math display">\[\text{sunset} = \text{noon} + \text{sha}\]</span></p>
<p><span class="math display">\[\text{duration} = \text{sunset} - \text{sunrise} = \text{sha} \times 20\]</span></p>
<p>The sunrise and sunset times in the equations above depend on the time zone of solar noon. To select a time zone may be strange to consider The range🎚️inputs below set the <a href="https://en.wikipedia.org/wiki/Geographic_coordinate_system#:~:text=positions%20directly%20on%20Earth%20as%20latitude%20and%20longitude">geographic coordinates</a> that are used for the equations above. The <a href="https://en.wikipedia.org/wiki/Line_chart#:~:text=a%20type%20of%20chart%20that%20displays%20information%20as%20a%20series%20of%20data%20points%20called%20%27markers%27%20connected%20by%20straight%20line%20segments">line chart</a> beneath the inputs visualizes sunrise and sunset for every <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span>, similar to the daylight area chart beneath the map🗺above. The main difference between the charts is that the area chart shows local <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> and thus is independent of longitude, whereas the line chart displays <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tzos</span> and therefore changes with longitude.</p>
<p>In general, computer programmers and mathematicians seem to prefer radians over degrees. are better because the Dec base units of time, longitude, and latitude can be multiplied by <span class="math inline">\(\tau\)</span> to can convert days, parallels, and meridians into radians simply by multiplying to . Apart from such as solar noon, In Dec, any <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> can be expanded to show a subtrahend and a difference. specific point in the day called a subtrahend. The difference between the original <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tod</span> and a . A <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tod</span> without the diff is called a minuend and Positive diffs show how much time has passed and negative diffs show how much time is left.</p>
<p><span class="math display">\[\text{minuend} = \text{subtrahend} + \text{diff}\]</span></p>
<p><span class="math display">\[\text{minuend} = \text{subtrahend} + \text{diff}\]</span></p>
<p>The Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> relative to the solar noon that corresponds to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="day of year">doy</span> and longitude selected by the range🎚️inputs above is <span><span id="ojs-element-id-29"></span>.</span></p>
<p>In Zone <span class="color0">0</span>, this was our solar noon, we could could all agree to center our daily schedules on the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> of our local solar noon, there would be no need for time zones. could start work two decidays before solar noon and finish two decidays after solar noon.</p>
<p>depends on <a href="https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda">longitude</a>. At any given moment, there is only one <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> and 10<sup>5</sup> five-digit mean solar times. The <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> we use to get the <a href="https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year">mean solar time</a> of a location is equal to its <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel">deci<a href="https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line">parallel</a></span> longitude. We can use the <a href="https://en.wikipedia.org/wiki/Equation_of_time#:~:text=the%20discrepancy%20between%20two%20kinds%20of%20solar%20time">equation of time</a> to turn the mean solar time of into <a href="https://en.wikipedia.org/wiki/Solar_time#Apparent_solar_time:~:text=the%20true%20sun%20as%20seen%20by%20an%20observer%20on%20Earth">apparent solar time</a>.</p>
<p>sum of a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> and the Zone 0 tod. We can use the equation of time to turn the mean solar time of a location Similarly, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel">deci<a href="https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line">parallel</a></span> longitude of the red⭕️circle on the map above is the tzo that we sum with the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> to get <a href="https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year">mean solar time</a>.</p>
<p>Without leap seconds, the duration of a day is constant, each <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet occurs only once per day, <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets can be derived directly from UNIX time or a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> independently of the date as shown above, and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="second of minute">som</span> component stays within its bounds: 0 ≤ <span class="tool" data-bs-toggle="tooltip" data-bs-title="second of minute">som</span> &lt; 60. <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> is based on <a href="https://en.wikipedia.org/wiki/Atomic_clock#:~:text=a%20clock%20that%20measures%20time%20by%20monitoring%20the%20resonant%20frequency%20of%20atoms">atomic clocks</a> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> is determined by the <a href="https://en.wikipedia.org/wiki/Earth%27s_rotation#:~:text=the%20rotation%20of%20planet%20Earth%20around%20its%20own%20axis">rotation of the Earth</a>. rom the perspective of Dec,</p>
<p>that represents the difference between <span class="tool" data-bs-toggle="tooltip" data-bs-title="Universal Time">UT</span> and the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>.</p>
<p>To display <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets, Dec uses math expressions that evaluate to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and leave no doubt about the measurement unit of each component: <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour of day">hod</span>/2.4+<span class="tool" data-bs-toggle="tooltip" data-bs-title="minute of hour">moh</span>/144+<span class="tool" data-bs-toggle="tooltip" data-bs-title="second of minute">som</span>/8640. Like the <a href="https://en.wikipedia.org/wiki/Julia_(programming_language)#:~:text=a%20dynamic%20general%2Dpurpose%20programming%20language">Julia</a>, <a href="https://en.wikipedia.org/wiki/MATLAB#:~:text=a%20proprietary%20multi%2Dparadigm%20programming%20language">Matlab</a>, and <a href="https://en.wikipedia.org/wiki/R_(programming_language)#:~:text=a%20programming%20language%20for%20statistical%20computing%20and%20data%20visualization">R</a> programming languages, Dec uses colons for numeric sequences such as 12:15, which means 12, 13, 14, and 15 instead of 12.25 hours.</p>
<p>Dec uses centimillidays (<span class="tool" data-bs-toggle="tooltip" data-bs-title="centimillidays">cmds</span>) in lieu of seconds. Centimillidays Instead of inserting a submultiple of a day into tods, would be to follow the switch from base 10 to base 11 on a specific date and then switch back. The last tod on that date would be 9.999Abbbbbbbbbbbbb able to take leap seconds into account without changing the duration of a day, repeating a tod within the same day, handles leap seconds by converting them to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> and adding them to a “<a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">time zone offset</a>” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>). This way, Dec can match any time with any number of leap seconds the duration of a day never changes, <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets never repeat within the same day, Dec can match any possible All of the we can be certain that leap seconds do not exist, meaning that In Dec, days always have the same duration, we can obtain a tod without knowing the date, and tods never go outside their bounds or repeat within the same day. , of decimal inserts leap days to increase the duration of leap year from 365 to 366 days, but leap seconds cannot exist. Leap seconds /</p>
<p>Negative leap seconds are evidence If an hms triplet repeats, we will know that a had just been inserted. If an hms triplet exceeds its bounds, we will know that a positive leap second had just been inserted. In general, we cannot know how many leap seconds have been inserted thus far simply by looking at an hms triplet.</p>
<p>of sixty seconds in a minute. In Dec, every <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> leap seconds are literally impossible, because days always have the same duration and <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> are decimal numbers.</p>
<p><a href="https://en.wikipedia.org/wiki/Python_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%20programming%20language">Python</a></p>
<p>In Dec, days always have the same duration and <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> calculations are independent of the date. Currently, 27 leap seconds To know how many leap seconds have been inserted by a given date, we have to consult a table. The duration of the days into which its are inserted. Instead of changing the duration of certain days, Dec handles leap seconds by converting them to decidays and adding them to a “time zone offset” (tzo).</p>
<p>The languages in the tabset panels in this article, Julia, Python, Observable JavaScript, and R, do not differ in this regard which Dec refers to as the “<a href="https://quarto.org/docs/faq/#:~:text=principal%20languages%20supported%20by%20Quarto%20are%20Python%2C%20R%2C%20Julia%2C%20and%20Observable%20JavaScript">Quarto principal languages</a>” (Qpls).</p>
<p>With the code above we can convert between a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet. According to Dec and all four of the programming languages used above, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> does not have any <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>.</p>
<p>Dec always measures <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> in <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>. The <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> of the ten Dec time zones are all single-digit positive integers. The difference between these ten <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>, <span class="color0">0</span> to <span class="color9">9</span>, we can match the time in any <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone to within 0.5 <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>.</p>
<p>If more precise matches are required, Dec can use <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> that have more than one digit. The level of precision required depends on the situtation. Let us say that we want to schedule a meeting with someone If we want to replicate a shift form make the time in UTC time zones that have a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> of <span class="color5">-5</span>, <span class="color0">0</span>, or <span class="color5">5</span>, a . At some point the increased precision of additional digits will no If we lived in Zone <span class="color0">0</span> and wanted to schedule a meeting with someone on a particular date, we might two digits, the time difference will not exceed 5 millidays and will be able to shift <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> by one centiday, which is less a quarter hour. With four digits, the difference between Dec and UTC <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> would be either zero or 288 milliseconds. We can choose to have more than four digits, but the difference is not likely to be noticeable. Therefore, four digits is a sensible If we wanted to match The <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> used by the highest number of people in the world is <span class="color10by3">10/3</span>.</p>
<p>There are three types of purpose of time zones is to keep To match the time in a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone exactly, Dec will often need to use a decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>.</p>
<p><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>, UNIX time, and Zone <span class="color0">0</span> all have a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> of <span class="color0">0</span>. <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> and because both have a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> of . If we add <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC"><span class="color1by320">27</span> leap seconds</a> to <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>, Dec would describe the result as a Zone <span class="color0">0.003125</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>.</p>
<p>Each leap second shifts a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzo</span> by <span class="color1by8640">1/8640</span>. By default, Dec rounds decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> to the near deciday: ⌊tzo + 0.5⌋. When necessary, Dec is able to exactly match times that include leap seconds or a decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>.</p>
<p>The result of adding leap seconds to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> depends on how many leap seconds we add. If we add a number of leap seconds that is a multiple of 8640, we get a</p>
<p>and deals with negative tzos keeping the remainder after adding ten and then dividing by ten: (tzo + 10) mod 10.</p>
<p>After combining a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>, Dec first combines it with to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>, Dec rounds decimal <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> to the nearest <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span>. and makes negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> that are positive integers. and therefore rounds</p>
<p>Unless To support leap seconds and the vast majority of <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>, Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> that are . If we add leap seconds to these <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span>, they will no longer be integers</p>
<p>[</p>
<p>If a tzo is a <a href="https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20number%20whose%20digits%20are%20eventually%20periodic">repeating decimal</a>, Dec will display it as a fraction.</p>
<p><span class="color1by320">0003125</span>. new <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> will be <span class="color1by320">0.003125</span> and the new <span class="tool" data-bs-toggle="tooltip" data-bs-title="unique zone identifier">uzi</span> will be . the Dec time will be <span class="mono">-</span><span class="color1by320">0003125</span>. The <span class="color1by320">0003125</span> The <span class="tool" data-bs-toggle="tooltip" data-bs-title="unique zone identifier">uzi</span> tells us that the go from <span class="color0">0</span> to [0003125] and the D</p>
<p>an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet into a Dec time, we need to know its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>, and how many leap seconds it includes. a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, from a programming language, it is can assume that leap seconds are not included. <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>The Dec equivalent of UTC with is a Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset index">tzo</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="unique zone identifier">uzi</span>, If we add <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC"><span class="color1by320">27</span> leap seconds</a> We can combine the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> in any Dec time zone by summing the Zone <span class="color0">0</span>, <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC"><span class="color1by320">27</span> leap seconds</a> to a Zone <span><span id="ojs-element-id-30"></span></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, we get add the result deciday and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset index">tzo</span> selected by the range🎚️input below is [0.003125] + <span><span id="ojs-element-id-31"></span></span> = <span><span id="ojs-element-id-32"></span>.</span> If we add the resulting <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset index">tzo</span> to the Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>, we get <span><span id="ojs-element-id-33"></span>.</span> last two digits of this <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset index">tzo</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="unique zone identifier">uzi</span> are not visible in a five-digit <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> If we remove the decimal separator from this <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset index">tzo</span>, we get its <span class="tool" data-bs-toggle="tooltip" data-bs-title="unique zone identifier">uzi</span>: <span><span id="ojs-element-id-34"></span>.</span></p>
<p>Every <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> has a corresponding “time zone index” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone index">tzi</span>). In the case of the ten Dec time zones, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone index">tzi</span> are identical. The <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone index">tzi</span> that corresponds to the Dec measures <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> in decidays. If a tzo is a single-digit integer, it likely or fractions. The tzos of the ten Dec time zones are positive integers. contain leap seconds as fractions. Even if we disregard leap seconds, fractions in <span class="tool" data-bs-toggle="tooltip" data-bs-title="times of day">tods</span> and <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> to are single-digit integers or fractions. Dec only uses ten Dec time zones each have a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> that is a : <span class="color0">0</span> to <span class="color9">9</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>. In contrast, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> range range from <span class="color5">-5</span> to <span class="color583">5.83̅</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>. A <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone with a negative <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> will be between have a similar time To avoid date mismatches with , we can subtract ten <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> from any positive Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> to make it negative: <span><span id="ojs-element-id-35"></span></span> – <span class="color0">10</span> = <span><span id="ojs-element-id-36"></span>.</span></p>
<p>far increase the Each leap second shifts the <span class="tool" data-bs-toggle="tooltip" data-bs-title="ordinal zone offset">ozi</span> by</p>
<p>Finding the Dec time zone with the closest <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> to a given <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> entails converting an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet to decidays, adding ten, keeping the remainder after dividing by ten, and then rounding to the nearest deciday. matching a tzo of -5 yields the same tod as exactly one day behind Zone [5 Dec avoids incompatible with the ten Dec time zones. Dec expresses incompatibles <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> as fractions. Officially, t Dec refers to <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> with <span class="color1by320">27</span> leap seconds as <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="mono">+</span><span class="color1by320">00:00:27</span> or <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="mono">+</span><span class="color1by320">1/320</span>. Dec can relax its requirement that each <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> be a single-digit positive integer <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> to match any <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span>.</p>
<p><span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offsets">tzos</span> is</p>
<p>Dec Positive and negative offsets that differ by exactly ten <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> yield identical times, but result in dates that are precisely one day apart.</p>
<p>https://stackoverflow.com/a/23575642 Use fractions.js to turn non standard offsets into fractions.</p>
<p>To determine which Dec time zone you are in, Dec would need to know your longitude. In general, Dec allows for everyone to use whatever <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> they want, regardless of their geographic location. The UTC <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> provided by your web browser is -300 minutes ÷ 144 = -2.083333 dd. In the absence of any other information, Dec would round this <span class="tool" data-bs-toggle="tooltip" data-bs-title="time zone offset">tzo</span> to the nearest deciday (dd), , and infer that you are in Zone 8. which Dec time zone you are in unless Rounding UTC tzos can result in a time difference of up to 0.5 dd. Adding 27 leap seconds increases the maximum time difference to 161/320 dd. With time zone rounding, the time difference between your Dec and UTC time zones is 11.52 ÷ 144 = 0.08 dd. With 27 leap seconds, this difference is /320.</p>
<p>The <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offset provided by your web browser is <span><span id="ojs-element-id-37"></span></span> ÷ 144 = <span><span id="ojs-element-id-38"></span></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>. The Dec time zone that corresponds to this <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offset is Zone <span><span id="ojs-element-id-39"></span>.</span> The time in corresponding Dec and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones can differ by up to <span class="color050">0.5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>. The difference between your Dec and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time is <span><span id="ojs-element-id-40"></span></span> ÷ 144 = <span><span id="ojs-element-id-41"></span></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>.</p>
<p>To obtain the time in Zone <span class="color0">0</span>, we can subtract the offset of any time zone from its time. Inversely, we can get the time in any time zone by adding its offset to the Zone <span class="color0">0</span> time. The dates and times in Zone <span class="color0">0</span> and <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color0">+00:00</span></a> match exactly. Zone <span class="color5">5</span> and <a href="https://en.wikipedia.org/wiki/UTC%2B12:00"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color5">+12:00</span></a> also have matching dates and times, both are precisely one day ahead of <a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color5">-12:00</span></a>.</p>
<p>This stance is at odds with the International Earth Rotation and Reference Systems Service, which has inserted <span class="color1by320">27</span> leap seconds into <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>.</p>
<p>since [1972]. Dec does not automatically shift time away necessary, Dec handles any shift away from leap seconds in time zone offsets.</p>
<p>Leap seconds</p>
<p>To indicate the</p>
<p>In Dec, the components of an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet are called the “hour of day” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="hour of day">hod</span>), “minute of hour” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="minute of hour">moh</span>), and “second of minute” (<span class="tool" data-bs-toggle="tooltip" data-bs-title="second of minute">som</span>).</p>
<p>Dec handles differences from Zone <span class="color0">0</span> with time zone offsets. There is no time difference between Zone <span class="color0">0</span> and UNIX time. Dec applies a time zone offset <span class="color5">5</span> <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a> to Julian dates because the Dec epoch occurred at midnight (<span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>) and the <a href="https://en.wikipedia.org/wiki/Julian_day#:~:text=a%20chronological%20interval%20of%207980%C2%A0years%2C%20derived%20from%20three%20multi%2Dyear%20cycles:%20the%20Indiction%2C%20Solar%2C%20and%20Lunar%20cycles">Julian period</a> started at noon (<span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>).</p>
<p>To convert days to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>, we multiply the <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> by ten.</p>
<p>In Dec, days start at midnight, instead of noon, but have the same duration as Julian days: 86400 <a href="https://en.wikipedia.org/wiki/International_System_of_Units#:~:text=the%20world%27s%20most%20widely%20used%20system%20of%20measurement">International System of Units</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="International System of Units">SI</span>) seconds or 100000 Dec <span class="tool" data-bs-toggle="tooltip" data-bs-title="centimillidays">beats</span>.</p>
<p>The duration of days in Dec and Julian dates The difference between the Dec epoch and the beginning of the Julian period is the only thing that distinguishes Julian date and a <span class="tool" data-bs-toggle="tooltip" data-bs-title="times-of-day">doe</span> is its epoch.</p>
<p>In <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>), days start at midnight, but the length of a day can vary due to <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>. In Dec, a day always has the same duration as a</p>
<p>When matching <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> is required, Dec avoids day length changes by adding leap seconds to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>. According to Dec, the <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color0">+00:00</span></a> time zone does not have any leap seconds because its offset is <span class="color0">0</span>. To indicate that a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone includes the <a href="https://en.wikipedia.org/wiki/Leap_second#Procedure:~:text=16-,27,-Current%20TAI%20%E2%88%92%20UTC">27 leap seconds</a> that have been inserted into <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> so far, Dec appends <span class="color1by320">:27</span> to its offset.</p>
<p>The Dec equivalent of the <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color1by320">+00:00:27</span></a> time zone is Zone <span class="color1by320">1/320</span>.</p>
<p>In <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>, the length of Day <span class="colorD121" data-bs-toggle="tooltip" data-bs-title="June 30">121</span> or Day <span class="colorD305" data-bs-toggle="tooltip" data-bs-title="December 31">305</span> can vary due to <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>. T this offset as T To represent the 27 leap seconds that have been added to <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> so far, Dec uses an offset of <span class="color1by320">1/320</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="decidays">dd</span>. Dec refers to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone that has this offset as <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color1by320">+00:00:32</span></a>.</p>
<p>either or secon Since 1972+121, 27 positive leap seconds have been added to UTC, and 0 negative leap seconds have been whave been in a Julian date or a <span class="tool" data-bs-toggle="tooltip" data-bs-title="times-of-day">doe</span> i Dec does not allow The time in the ten Dec time zones never include</p>
<p>o depending on whether the leap second is p.&nbsp;Dec uses to represent <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> without changing the length of a day in the same way as leap days changes the length of a year. Instead of allowing the length of a day included, some <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> days will be 86401 or 86399 seconds long. So far, 27 positive leap seconds have been added, some <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> days will differ in length. includes of seconds, Dec uses beats. 100000 The programming languages that the <a href="https://quarto.org/docs/faq">Quarto FAQ</a> refers to as <a href="https://quarto.org/docs/faq/#:~:text=The%20principal%20languages%20supported%20by%20Quarto%20are%20Python%2C%20R%2C%20Julia%2C%20and%20Observable%20JavaScript">principal languages supported by Quarto</a>, <a href="https://en.wikipedia.org/wiki/Python_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%20programming%20language">Python</a> (Quarto principal languages), <a href="https://en.wikipedia.org/wiki/R_(programming_language)#:~:text=a%20programming%20language%20for%20statistical%20computing%20and%20data%20visualization">R</a>, <a href="https://en.wikipedia.org/wiki/Julia_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%5B17%5D%20dynamic%20programming%20language">Julia</a>, and <a href="http://observablehq.com">Observable</a> <a href="https://en.wikipedia.org/wiki/JavaScript#:~:text=a%20programming%20language%20and%20core%20technology%20of%20the%20World%20Wide%20Web">JavaScript</a>, do not include <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> in <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time. Therefore, a day in Even though the Dec, UNIX, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> epochs all occurred at midnight, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time may be shifted in relation to Dec or UNIX time because of <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>. Since 1972+121, 27</p>
<p>We can make the time in any Dec time zone match UNIX by subtracting its time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>. The time in the Zone <span class="color0">0</span> Dec time zone always matches UNIX time. because neither includes <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a>. Dec considers <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <a href="https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time">time zone</a> to also match UNIX time. If there is a <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> are not included. Dec handles leap seconds like an additional time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>. <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00:00</a></span> with 27 leap seconds is referred to as Zone 1/320 in Dec and . which</p>
<p><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time"><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span><span class="color0">+00:00</span></a></p>
<p>To produce a Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> from an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet, we get the difference between the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>, convert its components to either days or <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>, and sum the converted components.</p>
<p>and</p>
<p><span class="math display">\[\text{deciday} = \frac{\text{hour}}{2.4} + \frac{\text{minute}}{144} + \frac{\text{second}}{8640}\]</span></p>
<p><span class="math display">\[\text{day} = \frac{\text{hour}}{24} + \frac{\text{minute}}{1440} + \frac{\text{second}}{86400}\]</span></p>
<p>does not include <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> or a <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) <a href="https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time">time zone</a> <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> and</p>
<p>than <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12</a></span> will not match the time in any of the ten Dec time zones. We can create a <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> by summing the components of an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet after</p>
<p>that were added a <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time">Coordinated Universal Time</a> (<span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>) <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> time zone. An <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet that includes <a href="https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment">leap seconds</a> or a</p>
<p>To be compatible with Dec, a time zone offset must be equivalent to one of the ten positive single-digit integer <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> Dec offsets. The Zone <span class="color5">5</span> Dec time zone and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span> time zone have equivalent offsets: <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> = <span class="color5">12</span> hours. Likewise, the Zone <span class="color0">0</span> Dec time zone, UNIX time, and the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> time zone all have an offset of <span class="color0">0</span>.</p>
<p>Apart from <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span>, all of the other <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones are incompatible with Dec.&nbsp;To find the <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> time difference <span class="math inline">\(\Delta\)</span> between a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone and its closest Dec time zone, convert the offset of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone to <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span> and then calculate how much the converted offset changes after rounding it to the nearest <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span>.</p>
<p><span class="math display">\[\Delta = \text{offset} - \lfloor\text{offset} + 0.5\rfloor\]</span></p>
</section><section id="rdn" class="level5 hiddenheading"><h5 class="hiddenheading anchored" data-anchor-id="rdn">Repeating decimal numbers</h5>
<p>Dec expresses incompatible offsets as positive or negative fractions or multi-digit integers. <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets are either <a href="https://en.wikipedia.org/wiki/Repeating_decimal">repeating</a> or terminating decimal numbers. Dec displays repeating decimal offsets as fractions and terminating decimal offsets as integers. <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color333"><a href="https://en.wikipedia.org/wiki/UTC%2B08:00">+08:00</a></span>, the most populous <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone, has an offset of <span class="color333">.</span><span class="vinculum">3</span> days and is called Zone <span class="color333">1/3</span> in Dec.&nbsp;In contrast, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color125"><a href="https://en.wikipedia.org/wiki/UTC%2B03:00">+03:00</a></span> has an offset of <span class="color125">.125</span> days and is called Zone <span class="color125">125</span> in Dec.</p>
<p>Terminating decimal number offsets can be displayed by Dec provided there is enough space for the additional digits. Dec displays repeating decimal number offsets as fractions. The second most populous <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color333"><a href="https://en.wikipedia.org/wiki/UTC%2B05:30">+05:30</a></span>, translates to Zone <span class="color55by24">55/24</span> or Zone <span class="color55by24">2.291</span><span class="vinculum">6</span> in Dec.&nbsp;The top six most populous <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones all have positive offsets.</p>
<p>When it is midnight (tod=<span class="color0">0</span>) in Zone <span class="color0">0</span>, it is noon (tod=<span class="color5">5</span>) in Zone <span class="color5">5</span> and the time in every other time zone is equal to it it is ~<span class="color533">5.33</span> in Zone <span class="color333">10/3</span>, ~<span class="color429">4.29</span> in Zone <span class="color55by24">55/24</span>, and</p>
<p>To obtain the Zone <span class="color0">0</span> time, we evaluate any Dec time as a math expression, add 10, and then get the remainder after dividing by 10 to make sure the result is less than 10 <span class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</span>.</p>
<p>The use of incompatible offsets makes mental calculations involving time zones much harder. Also, incompatible offsets are more difficult to display and read in the format of Dec times. Despite these clear disadvantages, Dec will attempt to parse, process, and display any time zone offset that is provided. Incompatible offset that are repeating decimal numbers can be displayed as fractions, truncated numbers</p>
<p>noon in <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color333"><a href="https://en.wikipedia.org/wiki/UTC%2B08:00">+08:00</a></span> could be written as <span class="color5">5.00</span><span class="mono">-</span><span class="color333">10/3</span> or <span class="color5">5.00</span><span class="mono">-</span><span class="color333">3.</span><span class="vinculum">3</span>.</p>
<p>Dec does not set a hard limit on the number of time zones, but negative time zones offsets to improve its compability with <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bad Pun Alert
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sorry if reading this takes a long <strong><em>time</em></strong>; I hope you don’t <strong><em>zone</em></strong> out!</p>
</div>
</div>
<p>If a Dec time zone offset is not specified, we can detected a time zone using Whether or not negative time zones offsets are worth the trouble is a matter of that the offer little to no benefit. The <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude">-12:00</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span> time zones and the Zone <span class="color5">5</span> and <span class="color5">-5</span> Dec time zones all have the same time, but their dates do not match, because <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude">-12:00</a></span> and Zone <span class="color5">-5</span> are one day behind <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span> and Zone <span class="color5">5</span>. Dec discourages the use of time zones with negative offsets.</p>
<p>The remaining UTC time zones with negative offsets</p>
<p>If we disregard leap seconds, the <span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone is synchronized with UNIX time and the Zone <span class="color0">0</span> Dec time zone. The <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12</a></span> and <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00">-12</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets have the same time but their dates are one day apart.</p>
<p>We can honor this difference by translating <span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12</a></span> compatible <a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets">37 <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets</a>, only 3 are integers after they are converted to time zones. Conversion between Dec time zones and UTC offsets is inexact, because UTC offsets depend on geographic and political boundaries, whereas Dec time zones are determined solely by longitude.</p>
<p>because UNIX time, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span>, and Zone <span class="color0">0</span> are all synchronized.</p>
<p>Similarly, a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet yields a Zone <span class="color5">5</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>.</p>
<p><span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span></p>
<p>Instead of passing an <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> equation separately, we can subtract the offset from the triplet to produce a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet. In other words, we can avoid converting time zone offsets if we always first shift the input <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet to <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z">+00:00</a></span>.</p>
<p>To obtain the Zone 0 time, we evaluate a Dec time as a math expression, add 10, and get the remainder after dividing by 10 to make sure the result is less than 10 <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a>: (<span class="cyan"><span><span id="ojs-element-id-42"></span></span></span> <span><span id="ojs-element-id-43"></span></span> <span class="lime"><span><span id="ojs-element-id-44"></span></span></span> + 10) <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 10 = <span class="cyan"><span><span id="ojs-element-id-45"></span></span></span>.</p>
<p>Instead of passing both a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplets and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> to the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span> equation.</p>
<p>Instead of performing this calculation on both a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet and its <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a>, we should subtract the offset from the triplet.</p>
<p>equation should be a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet so that we do not have to convert a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zone <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">offset</a> to <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a>.</p>
<p>When we add a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offset to a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet, with the resulting <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> time.</p>
<p>The time in Zone <span class="color0">0</span> matches UTC time with the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> offset. UNIX time and three <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> offsets are called <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">UTC</a></span><span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%2B12:00">+12:00</a></span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00">UTC</a></span><span class="color5"><a href="https://en.wikipedia.org/wiki/UTC%E2%88%9212:00">-12:00</a></span>. Starting with a <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC</a></span><span class="color0"><a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">+00:00</a></span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet results in Zone <span class="color0">0</span> <span class="tool" data-bs-toggle="tooltip" data-bs-title="time of day">tod</span>.</p>
<p>only three out of the <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones are synchronized with a Dec time zone it will most likely be easier to shift the <span class="tool" data-bs-toggle="tooltip" data-bs-title="hour minute second">hms</span> triplet to will result in days instead of decidays if we divide by the most Dec and <span class="tool" data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time">UTC</span> time zones are not aligned. Whereas UNIX time is always synchronized with Zone <span class="color0">0</span> and <a href="https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time">UTC<span class="color0">+00:00</span></a>, This method ensure that the result matches</p>
<p><a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">UTC time zone offsets</a></p>
<p>Drag the red⭕️circle across the <a href="https://en.wikipedia.org/wiki/Meridian_%28geography%29#:~:text=words%2C%20it%20is-,a%20line%20of%20longitude,-.%20The%20position%20of">meridians</a> (vertical↕gray lines) on the map🗺️to see how changing time zones affects the time. Only the first digit of the Dec times shown above, the <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span>, varies across time zones, because the 10 Dec time zones, numbered 0 through 9 on the map🗺️, are each 1 <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a turn">deci<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees">turn</a></span> (<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn">dt</a>) wide. Simply put, a <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a turn">deciturn</span> of longitude translates into a <span class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</span> of time.</p>
<p>The leftmost vertical↕line on the map🗺️is <a href="https://en.wikipedia.org/wiki/18th_meridian_west#:~:text=a%20line%20of%20longitude%20that%20extends%20from%20the%20North%20Pole%20across%20the%20Arctic%20Ocean%2C%20Greenland%2C%20Iceland%2C%20the%20Atlantic%20Ocean%2C%20the%20Canary%20Islands%2C%20the%20Southern%20Ocean%2C%20and%20Antarctica%20to%20the%20South%20Pole">Meridian 0</a>, the Dec <a href="https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next">International Date Line</a> and <a href="https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0">prime meridian</a>, which cuts across the Atlantic Ocean through Iceland🇮🇸just West of Africa🌍and is the boundary between Zone 9 and Zone 0, the rightmost and leftmost Dec time zones on the map🗺️, respectively. Arranging Dec time zones from 0 to 9 yields a <a href="https://en.wikipedia.org/wiki/World_map#:~:text=south%2Dup%20map-,Pacific%2Dcentric%20map,-(more%20commonly%20used)">Pacific-centric</a> map🗺️.</p>
<p>While only positive Dec time zones are shown on the map🗺️, every Dec time zone can also be expressed as a negative number. Each pair of time zone numbers produces the same Dec time, but result in <a href="../../dec/date">Dec dates</a>🗓️that are 1 day apart. Negative time zone numbers can be useful for getting <a href="../../dec/date">Dec dates</a>🗓️to match <a href="https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world">Gregorian calendar</a> dates🗓️with negative <a href="https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place">UTC offsets</a>.</p>
<p>If you know your longitude in degrees (°) or <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundredths of a turn">centi<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees">turns</a></span> (<a href="https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn">ct</a>), you can look up your Dec time zone (TZ) in the table below.</p>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">TZ<br>+</th>
<th style="text-align: center;">TZ<br>-</th>
<th style="text-align: center;">Start<br>°</th>
<th style="text-align: center;">Mid<br>°</th>
<th style="text-align: center;">End<br>°</th>
<th style="text-align: center;">Start<br><span class="math inline">\(ct\)</span>
</th>
<th style="text-align: center;">Mid<br><span class="math inline">\(ct\)</span>
</th>
<th style="text-align: center;">End<br><span class="math inline">\(ct\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">-54</td>
<td style="text-align: center;">-36</td>
<td style="text-align: center;">-18</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">100</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-90</td>
<td style="text-align: center;">-72</td>
<td style="text-align: center;">-54</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">90</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">-126</td>
<td style="text-align: center;">-108</td>
<td style="text-align: center;">-90</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">75</td>
<td style="text-align: center;">80</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">-4</td>
<td style="text-align: center;">-162</td>
<td style="text-align: center;">-144</td>
<td style="text-align: center;">-126</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">-5</td>
<td style="text-align: center;">162</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">-162</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">60</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">-6</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">144</td>
<td style="text-align: center;">162</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">50</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">-7</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">108</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">-8</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">72</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">30</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">-9</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">-10</td>
<td style="text-align: center;">-18</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
</tr>
</tbody>
</table>
<p>Dec times in Zone 0 and 5 can be directly converted to and from UTC times with an offset of 0 and 12 <span class="teal">hours</span>, respectively. The other Dec time zones</p>
</section></section><section id="unit" class="level4"><h4 class="anchored" data-anchor-id="unit">Unit</h4>
<p>Dec uses <a href="https://en.wikipedia.org/wiki/Metric_prefix#:~:text=a%20unit%20prefix%20that%20precedes%20a%20basic%20unit%20of%20measure%20to%20indicate%20a%20multiple%20or%20submultiple%20of%20the%20unit">metric prefixes</a> to create <a href="https://en.wikipedia.org/wiki/Multiple_%28mathematics%29#Submultiple:~:text=of%20%22a%20being-,a%20unit%20fraction,-of%20b%22%20">submultiples</a> of a day that can naturally be combined together into a single <a href="https://en.wikipedia.org/wiki/Decimal#:~:text=system%20for%20denoting%20integer%20and%20non%2Dinteger%20numbers">decimal</a> number. Conversion between decimal units is as simple as moving↔︎️or removing❌the <a href="https://en.wikipedia.org/wiki/Decimal_separator#:~:text=a%20symbol%20that%20separates%20the%20integer%20part%20from%20the%20fractional%20part%20of%20a%20number">decimal separator</a>. In contrast, an <span class="teal">hh</span>:<span class="olive">mm</span>:<span class="purple">ss</span> time is a <a href="https://en.wikipedia.org/wiki/Mixed_radix#:~:text=non%2Dstandard%20positional%20numeral%20systems%20in%20which%20the%20numerical%20base%20varies%20from%20position%20to%20position">mixed-radix</a> number, where <span class="teal">hh</span> is the <a href="https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=12-,Duodecimal,-%2C%20dozenal">base-12</a> or <a href="https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=24-,Quadravigesimal,-%5B48%5D">base-24</a> <span class="teal">hour</span>, <span class="olive">mm</span> is the <a href="https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=60-,Sexagesimal,-Babylonian%20numerals%20and">base-60</a> <span class="olive">minute</span>, and <span class="purple">ss</span> is the base-60 <span class="purple">second</span>.</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 31%">
</colgroup>
<thead><tr class="header">
<th>Prefix</th>
<th>Power</th>
<th>Day</th>
<th>
<span class="teal">hh</span>:<span class="olive">mm</span>:<span class="purple">ss</span>.<span class="purple">sss</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td></td>
<td>0</td>
<td>1</td>
<td>24:00:00.000</td>
</tr>
<tr class="even">
<td>deci</td>
<td>-1</td>
<td>.1</td>
<td>02:24:00.000</td>
</tr>
<tr class="odd">
<td>centi</td>
<td>-2</td>
<td>.01</td>
<td>00:14:24.000</td>
</tr>
<tr class="even">
<td>milli</td>
<td>-3</td>
<td>.001</td>
<td>00:01:26.400</td>
</tr>
<tr class="odd">
<td>decimilli</td>
<td>-4</td>
<td>.0001</td>
<td>00:00:08.640</td>
</tr>
<tr class="even">
<td>centimilli</td>
<td>-5</td>
<td>.00001</td>
<td>00:00:00.864</td>
</tr>
</tbody>
</table>
<p>To convert the <span class="teal">hour</span> <span class="teal">h</span>, <span class="olive">minute</span> <span class="olive">m</span>, and <span class="purple">second</span> <span class="purple">s</span> into the <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</a> <span class="cyan">d</span>, Dec uses the following equation: <span class="cyan">d</span> = <span class="teal">h</span> ÷ 2.4 + <span class="olive">m</span> ÷ 144 + <span class="purple">s</span> ÷ 8640. The current equation values in Zone <span class="lime"><span><span id="ojs-element-id-46"></span></span></span> are: <span class="cyan"><span><span id="ojs-element-id-47"></span></span></span> = <span class="teal"><span><span id="ojs-element-id-48"></span></span></span> ÷ 2.4 + <span class="olive"><span><span id="ojs-element-id-49"></span></span></span> ÷ 144 + <span class="purple"><span><span id="ojs-element-id-50"></span></span></span> ÷ 8640. Inversely, we can convert <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a> into <span class="teal">hours</span>: <span class="teal">h</span> = <span class="cyan">d</span> × 2.4, <span class="olive">minutes</span>: <span class="olive">m</span> = <span class="teal">h</span> <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 × 60, and <span class="purple">seconds</span>: <span class="purple">s</span> = <span class="olive">m</span> <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 × 60.</p>
<p>Instead of dealing with <span class="teal">hours</span>, <span class="olive">minutes</span>, and <span class="purple">seconds</span>, we can convert the <a href="https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970">UNIX timestamp</a> <span class="purple">u</span> into the Dec time <span class="cyan">d</span>+<span class="lime">0</span>. First, we divide <span class="purple">u</span> by 86400 to convert seconds to days, then isolate the <a href="https://en.wikipedia.org/wiki/Fractional_part#:~:text=the%20excess%20beyond%20that%20number%27s%20integer%20part">decimal part</a> of the <a href="https://en.wikipedia.org/wiki/Quotient#:~:text=a%20quantity%20produced%20by%20the%20division%20of%20two%20numbers">quotient</a>, and finally multiply by 10: <span class="cyan">d</span> + <span class="lime">0</span> = <span class="purple">u</span> ÷ 86400 <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 × 10. The current values in this equation are <span class="cyan"><span><span id="ojs-element-id-51"></span></span></span> + <span class="lime">0</span> = <span class="purple"><span><span id="ojs-element-id-52"></span></span></span> ÷ 86400 <a href="https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder">mod</a> 1 × 10.</p>
<p>The concept of measuring time in decimal days is not novel. In the late 1700s, the <a href="https://en.wikipedia.org/wiki/French_Republican_calendar#:~:text=a%20calendar%20created%20and%20implemented%20during%20the%20French%20Revolution">French Republican calendar</a> time system referred to <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="tenths of a day">decidays</a> as decimal <span class="teal">hours</span>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundredths of a day">centidays</span> as <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=into%20tenths%2C%20or-,d%C3%A9cimes,-%2C%20instead%20of%20minutes">décimes</a>, <span class="tool" data-bs-toggle="tooltip" data-bs-title="thousandths of a day">millidays</span> as decimal <span class="olive">minutes</span>, and <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day">centimillidays</span> as decimal <span class="purple">seconds</span>. Similarly, <a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#:~:text=a%20decimal%20time%20system%20introduced%20in%201998%20by%20the%20Swatch%20corporation">Swatch Internet Time</a>, a <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=the%20representation%20of%20the%20time%20of%20day%20using%20units%20which%20are%20decimally%20related">decimal time</a> system introduced in 1998, uses the term “.beats” for <span class="tool" data-bs-toggle="tooltip" data-bs-title="thousandths of a day">millidays</span>.</p>
<p>Swatch Internet Time differs from Dec in that it <a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=There%20are%20no%20time%20zones%20in%20Swatch%20Internet%20Time">has no time zones</a> and is obtained from the <span class="teal"><a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1">hours</a></span><a href="https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1">, <span class="olive">minutes</span>, and <span class="purple">seconds</span></a> of <a href="https://en.wikipedia.org/wiki/UTC%2B01:00#:~:text=a%20time%20offset%20from%20UTC%20of%20%2B01%3A00">UTC+01:00</a>. In contrast, the major innovations described in this article are the Dec time zone system and the simple equation for obtaining the Dec time in Zone 0 from a UNIX timestamp, but Dec has much more to offer than <a href="https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays" class="tool" data-bs-toggle="tooltip" data-bs-title="a tenth of a day">deciday</a> times and zones.</p>
</section><section id="next" class="level4"><h4 class="anchored" data-anchor-id="next">Next</h4>
<p>The next article in the <a href="../../dec">Dec section</a> of my site compares Dec to the <a href="https://en.wikipedia.org/wiki/ISO_8601#:~:text=an%20international%20standard%20covering%20the%20worldwide%20exchange%20and%20communication%20of%20date%20and%20time%2Drelated%20data">ISO 8601</a> international standard for dates and times. Like ISO 8601, Dec allows for <a href="https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations">combined date and time representations</a> that can be paired up to express <a href="https://en.wikipedia.org/wiki/ISO_8601#Time_intervals:~:text=the%20intervening%20time%20between%20two%20time%20points">time intervals</a>. In Dec, the combination of a date and time is called a snap🫰and a time interval expressed as a pair of snaps is called a span🌈.</p>
<p>My <a href="../../dec/iso">ISO 8601 article</a> is unique because it avoids the use of Observable in favor of leveraging <a href="https://jupyter.org">Jupyter</a> support in Quarto to make the code underlying Dec available in multiple programming languages. Observable is a great visualization tool but does not translate well into Jupyter notebooks. After the next article, I return to the use of Observable in my Dec <a href="../../dec/span">snap</a>🫰and <a href="../../dec/span">span</a>🌈articles.</p>
<div id="timenav">
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"></figure><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {'theme': 'default', 'themeVariables': { 'fontSize': '32px'}}}%%
flowchart LR
   A[Dec]--&gt;B[date]--&gt;C[time]--&gt;D[snap]--&gt;E[span]
   click A "/dec"
   click B "/dec/date"
   click C "/dec/time"
   click D "/dec/snap"
   click E "/dec/span"
</pre>
</div>
<p></p>
</div>
</div>
</div>
</div>
</section><section id="cite" class="level4"><h4 class="anchored" data-anchor-id="cite">Cite</h4>
<p>Please spread the good word about Dec using the citation information at the bottom of this article. You may also want to cite the Observable notebooks that I adapted into the clock🕓, bar📊chart, map🗺️, and daylight☀️plot visualizations in this article or the 2014 blog post which proposed a system of 20 decimal time zones, each 5 <span class="tool" data-bs-toggle="tooltip" data-bs-title="hundredths of a day">centidays</span> wide, based on the <a href="https://en.wikipedia.org/wiki/Prime_meridian_(Greenwich)#:~:text=a%20geographical%20reference%20line%20that%20passes%20through%20the%20Royal%20Observatory%2C%20Greenwich%2C%20in%20London%2C%20England">Greenwich Meridian</a>:</p>
<ul>
<li>
<a href="https://www.2x2.graphics">Pearson, Tom</a>. <span class="yellow"><u>2013</u></span><u>+<span class="cyan">124</span></u>. “Simple D3 clock.” <span class="yellow"><span><span id="ojs-element-id-53"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-54"></span></span></span>. <a href="https://observablehq.com/@d3/simple-clock" class="uri">https://observablehq.com/@d3/simple-clock</a>.</li>
<li>
<a href="https://fheyen.github.io">Heyen, Frank</a>. <span class="yellow"><u>2021</u></span><u>+<span class="cyan">246</span></u>. “BarChart Clock.” <span class="yellow"><span><span id="ojs-element-id-55"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-56"></span></span></span>. <a href="https://observablehq.com/@fheyen/barchart-clock" class="uri">https://observablehq.com/@fheyen/barchart-clock</a>.</li>
<li>
<a href="https://enjalot.github.io">Johnson, Ian</a>. <span class="yellow"><u>2021</u></span><u>+<span class="cyan">090</span></u>. “Draggable World Map Coordinates Input.” <span class="yellow"><span><span id="ojs-element-id-57"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-58"></span></span></span>. <a href="https://observablehq.com/@enjalot/draggable-world-map-coordinates-input" class="uri">https://observablehq.com/@enjalot/draggable-world-map-coordinates-input</a>.</li>
<li>
<a href="https://www.danbridges.org">Bridges, Dan</a>. <span class="yellow"><u>2021</u></span><u>+<span class="cyan">311</span></u>. “Visualizing Seasonal Daylight.” <span class="yellow"><span><span id="ojs-element-id-59"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-60"></span></span></span>. <a href="https://observablehq.com/@dbridges/visualizing-seasonal-daylight" class="uri">https://observablehq.com/@dbridges/visualizing-seasonal-daylight</a>.</li>
<li>
<a href="https://www.brinckerhoff.org">Clements, John</a>. <span class="yellow"><u>2014</u></span><u>+<span class="cyan">091</span></u>, “Decimal Time Zones.” <span class="yellow"><span><span id="ojs-element-id-61"></span></span></span>+<span class="cyan"><span><span id="ojs-element-id-62"></span></span></span>. <a href="https://www.brinckerhoff.org/blog/2014/05/31/decimal-time-zones" class="uri">https://www.brinckerhoff.org/blog/2014/05/31/decimal-time-zones</a>.</li>
</ul>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb41" data-startfrom="1541" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1540;"><span id="cb41-1541"><a href="#cb41-1541" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb41-1542"><a href="#cb41-1542" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [(unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> (</span>
<span id="cb41-1543"><a href="#cb41-1543" aria-hidden="true" tabindex="-1"></a>    zone <span class="op">=</span> zone <span class="op">??</span> <span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb41-1544"><a href="#cb41-1544" aria-hidden="true" tabindex="-1"></a>      (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)</span>
<span id="cb41-1545"><a href="#cb41-1545" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb41-1546"><a href="#cb41-1546" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-1547"><a href="#cb41-1547" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote1</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb41-1548"><a href="#cb41-1548" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb41-1549"><a href="#cb41-1549" aria-hidden="true" tabindex="-1"></a>    (unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span></span>
<span id="cb41-1550"><a href="#cb41-1550" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> (zone <span class="op">=</span> zone <span class="op">??</span> (<span class="dv">10</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb41-1551"><a href="#cb41-1551" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb41-1552"><a href="#cb41-1552" aria-hidden="true" tabindex="-1"></a>      ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb41-1553"><a href="#cb41-1553" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-1554"><a href="#cb41-1554" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2date</span>(dote<span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb41-1555"><a href="#cb41-1555" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cote <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((</span>
<span id="cb41-1556"><a href="#cb41-1556" aria-hidden="true" tabindex="-1"></a>      dote <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> dote</span>
<span id="cb41-1557"><a href="#cb41-1557" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> dote <span class="op">-</span> <span class="dv">146096</span></span>
<span id="cb41-1558"><a href="#cb41-1558" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb41-1559"><a href="#cb41-1559" aria-hidden="true" tabindex="-1"></a>  dotc <span class="op">=</span> dote <span class="op">-</span> cote <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb41-1560"><a href="#cb41-1560" aria-hidden="true" tabindex="-1"></a>  yotc <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dotc</span>
<span id="cb41-1561"><a href="#cb41-1561" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>)</span>
<span id="cb41-1562"><a href="#cb41-1562" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>)</span>
<span id="cb41-1563"><a href="#cb41-1563" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)</span>
<span id="cb41-1564"><a href="#cb41-1564" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">/</span> <span class="dv">365</span>)<span class="op">;</span></span>
<span id="cb41-1565"><a href="#cb41-1565" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb41-1566"><a href="#cb41-1566" aria-hidden="true" tabindex="-1"></a>    yotc <span class="op">+</span> cote <span class="op">*</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb41-1567"><a href="#cb41-1567" aria-hidden="true" tabindex="-1"></a>    dotc <span class="op">-</span> (yotc <span class="op">*</span> <span class="dv">365</span></span>
<span id="cb41-1568"><a href="#cb41-1568" aria-hidden="true" tabindex="-1"></a>      <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">4</span>)</span>
<span id="cb41-1569"><a href="#cb41-1569" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb41-1570"><a href="#cb41-1570" aria-hidden="true" tabindex="-1"></a>  )<span class="op">,</span> zone]}</span>
<span id="cb41-1571"><a href="#cb41-1571" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getEot</span>(day) {</span>
<span id="cb41-1572"><a href="#cb41-1572" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> gamma <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> day <span class="op">/</span> <span class="dv">365</span></span>
<span id="cb41-1573"><a href="#cb41-1573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb41-1574"><a href="#cb41-1574" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1.49504245e-5</span> <span class="op">+</span></span>
<span id="cb41-1575"><a href="#cb41-1575" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span><span class="fl">4.1898733e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(gamma) <span class="op">+</span></span>
<span id="cb41-1576"><a href="#cb41-1576" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span><span class="fl">2.9237036e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(gamma) <span class="op">+</span></span>
<span id="cb41-1577"><a href="#cb41-1577" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span><span class="fl">4.5694380e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="dv">2</span> <span class="op">*</span> gamma) <span class="op">+</span></span>
<span id="cb41-1578"><a href="#cb41-1578" aria-hidden="true" tabindex="-1"></a>      <span class="fl">5.17560175e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="dv">2</span> <span class="op">*</span> gamma)</span>
<span id="cb41-1579"><a href="#cb41-1579" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-1580"><a href="#cb41-1580" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-1581"><a href="#cb41-1581" aria-hidden="true" tabindex="-1"></a>dz <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb41-1582"><a href="#cb41-1582" aria-hidden="true" tabindex="-1"></a>decYear <span class="op">=</span> ydz[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span>)</span>
<span id="cb41-1583"><a href="#cb41-1583" aria-hidden="true" tabindex="-1"></a>zeroDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="dv">0</span>)[<span class="dv">0</span>]</span>
<span id="cb41-1584"><a href="#cb41-1584" aria-hidden="true" tabindex="-1"></a>zeroTime <span class="op">=</span> zeroDote <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb41-1585"><a href="#cb41-1585" aria-hidden="true" tabindex="-1"></a>zeroDate <span class="op">=</span> <span class="fu">dote2date</span>(zeroDote)</span>
<span id="cb41-1586"><a href="#cb41-1586" aria-hidden="true" tabindex="-1"></a>zeroYear <span class="op">=</span> zeroDate[<span class="dv">0</span>]</span>
<span id="cb41-1587"><a href="#cb41-1587" aria-hidden="true" tabindex="-1"></a>zeroYda <span class="op">=</span> zeroDate[<span class="dv">1</span>]</span>
<span id="cb41-1588"><a href="#cb41-1588" aria-hidden="true" tabindex="-1"></a>zeroDoy <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(zeroYda)</span>
<span id="cb41-1589"><a href="#cb41-1589" aria-hidden="true" tabindex="-1"></a>zeroIsLeap <span class="op">=</span> <span class="fu">isLeapYear</span>(zeroYear)</span>
<span id="cb41-1590"><a href="#cb41-1590" aria-hidden="true" tabindex="-1"></a>zeroYdaHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroYda<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroYda <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> zeroIsLeap)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1591"><a href="#cb41-1591" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1592"><a href="#cb41-1592" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1593"><a href="#cb41-1593" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl2 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1594"><a href="#cb41-1594" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl3 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1595"><a href="#cb41-1595" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl4 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1596"><a href="#cb41-1596" aria-hidden="true" tabindex="-1"></a>zeroDotyHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroDoy<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroDoy <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> zeroIsLeap)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1597"><a href="#cb41-1597" aria-hidden="true" tabindex="-1"></a>zeroDoteHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroDote<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroDote <span class="op">%</span> <span class="dv">1</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1598"><a href="#cb41-1598" aria-hidden="true" tabindex="-1"></a>zeroYearHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroYear<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroYear <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb41-1599"><a href="#cb41-1599" aria-hidden="true" tabindex="-1"></a>browserDote <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb41-1600"><a href="#cb41-1600" aria-hidden="true" tabindex="-1"></a>browserTime <span class="op">=</span> browserDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb41-1601"><a href="#cb41-1601" aria-hidden="true" tabindex="-1"></a>browserZone <span class="op">=</span> browserDote[<span class="dv">1</span>]</span>
<span id="cb41-1602"><a href="#cb41-1602" aria-hidden="true" tabindex="-1"></a>browserSign <span class="op">=</span> browserZone <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb41-1603"><a href="#cb41-1603" aria-hidden="true" tabindex="-1"></a>zone0time <span class="op">=</span> (browserTime <span class="op">-</span> browserZone <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb41-1604"><a href="#cb41-1604" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> browserTime <span class="op">*</span> <span class="fl">2.4</span></span>
<span id="cb41-1605"><a href="#cb41-1605" aria-hidden="true" tabindex="-1"></a>minutes <span class="op">=</span> hours <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb41-1606"><a href="#cb41-1606" aria-hidden="true" tabindex="-1"></a>seconds <span class="op">=</span> minutes <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb41-1607"><a href="#cb41-1607" aria-hidden="true" tabindex="-1"></a>selectedDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="fu">long2zone</span>(location[<span class="dv">0</span>]))</span>
<span id="cb41-1608"><a href="#cb41-1608" aria-hidden="true" tabindex="-1"></a>selectedExact <span class="op">=</span> selectedDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb41-1609"><a href="#cb41-1609" aria-hidden="true" tabindex="-1"></a>selectedExactN <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> selectedExact) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb41-1610"><a href="#cb41-1610" aria-hidden="true" tabindex="-1"></a>selectedZone <span class="op">=</span> selectedDote[<span class="dv">1</span>]</span>
<span id="cb41-1611"><a href="#cb41-1611" aria-hidden="true" tabindex="-1"></a>ydz <span class="op">=</span> <span class="fu">dote2date</span>(<span class="op">...</span>selectedDote)</span>
<span id="cb41-1612"><a href="#cb41-1612" aria-hidden="true" tabindex="-1"></a>decDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(ydz[<span class="dv">1</span>])</span>
<span id="cb41-1613"><a href="#cb41-1613" aria-hidden="true" tabindex="-1"></a>decTime <span class="op">=</span> (selectedExact <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb41-1614"><a href="#cb41-1614" aria-hidden="true" tabindex="-1"></a>decTimeN <span class="op">=</span> (selectedExactN <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb41-1615"><a href="#cb41-1615" aria-hidden="true" tabindex="-1"></a>barDD <span class="op">=</span> decTime[<span class="dv">0</span>]</span>
<span id="cb41-1616"><a href="#cb41-1616" aria-hidden="true" tabindex="-1"></a>barDDN <span class="op">=</span> decTimeN[<span class="dv">0</span>]</span>
<span id="cb41-1617"><a href="#cb41-1617" aria-hidden="true" tabindex="-1"></a>barMils <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb41-1618"><a href="#cb41-1618" aria-hidden="true" tabindex="-1"></a>barMilsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb41-1619"><a href="#cb41-1619" aria-hidden="true" tabindex="-1"></a>barBeats <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb41-1620"><a href="#cb41-1620" aria-hidden="true" tabindex="-1"></a>barBeatsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb41-1621"><a href="#cb41-1621" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">lati2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb41-1622"><a href="#cb41-1622" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb41-1623"><a href="#cb41-1623" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb41-1624"><a href="#cb41-1624" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-1625"><a href="#cb41-1625" aria-hidden="true" tabindex="-1"></a>graticule <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoGraticule</span>()<span class="op">.</span><span class="fu">stepMinor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])<span class="op">.</span><span class="fu">stepMajor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])()</span>
<span id="cb41-1626"><a href="#cb41-1626" aria-hidden="true" tabindex="-1"></a>graticule<span class="op">.</span><span class="at">coordinates</span> <span class="op">=</span> graticule<span class="op">.</span><span class="at">coordinates</span><span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb41-1627"><a href="#cb41-1627" aria-hidden="true" tabindex="-1"></a>  i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="fu">map</span>(j <span class="kw">=&gt;</span> j<span class="op">.</span><span class="fu">map</span>((k<span class="op">,</span> index<span class="op">,</span> arr) <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> index <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> k <span class="op">-</span> <span class="dv">18</span> <span class="op">:</span> k))</span>
<span id="cb41-1628"><a href="#cb41-1628" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-29" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-30" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-31" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-32" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-33" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-34" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-35" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-36" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-37" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-38" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-39" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-40" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-41" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-42" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-43" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-44" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-45" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-46" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-47" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb42" data-startfrom="1629" data-source-offset="-3403"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1628;"><span id="cb42-1629"><a href="#cb42-1629" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb42-1630"><a href="#cb42-1630" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb42-1631"><a href="#cb42-1631" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (((degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> degrees <span class="op">+</span> <span class="dv">360</span> <span class="op">:</span> degrees) <span class="op">+</span> <span class="dv">18</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb42-1632"><a href="#cb42-1632" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1633"><a href="#cb42-1633" aria-hidden="true" tabindex="-1"></a><span class="co">// https://github.com/topojson/world-atlas</span></span>
<span id="cb42-1634"><a href="#cb42-1634" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> d3<span class="op">.</span><span class="fu">json</span>(<span class="st">"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json"</span>)</span>
<span id="cb42-1635"><a href="#cb42-1635" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">countries</span>)</span>
<span id="cb42-1636"><a href="#cb42-1636" aria-hidden="true" tabindex="-1"></a>topojson <span class="op">=</span> <span class="pp">require</span>(<span class="st">"topojson-client@3"</span>)</span>
<span id="cb42-1637"><a href="#cb42-1637" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2zone</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span>) {</span>
<span id="cb42-1638"><a href="#cb42-1638" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">long2turn</span>(degrees<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb42-1639"><a href="#cb42-1639" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1640"><a href="#cb42-1640" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">year2leap</span>(year <span class="op">=</span> <span class="dv">1970</span>) {</span>
<span id="cb42-1641"><a href="#cb42-1641" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> year <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> year <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> year <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb42-1642"><a href="#cb42-1642" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1643"><a href="#cb42-1643" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb42-1644"><a href="#cb42-1644" aria-hidden="true" tabindex="-1"></a>solarSystem <span class="op">=</span> (<span class="bu">root</span><span class="op">,</span> vizwidth<span class="op">,</span> location<span class="op">,</span> date<span class="op">,</span> hour<span class="op">,</span> darkmode) <span class="kw">=&gt;</span> {</span>
<span id="cb42-1645"><a href="#cb42-1645" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthRadius <span class="op">=</span> <span class="fl">0.065</span> <span class="op">*</span> vizwidth<span class="op">;</span></span>
<span id="cb42-1646"><a href="#cb42-1646" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const sunRadius = 0.015 * vizwidth;</span></span>
<span id="cb42-1647"><a href="#cb42-1647" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystemRadius <span class="op">=</span> vizwidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (vizwidth <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb42-1648"><a href="#cb42-1648" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stretch <span class="op">=</span> <span class="fl">0.06</span><span class="op">;</span></span>
<span id="cb42-1649"><a href="#cb42-1649" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(date)<span class="op">;</span></span>
<span id="cb42-1650"><a href="#cb42-1650" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngleDeg <span class="op">=</span> (solarAngle <span class="op">*</span> <span class="dv">180</span>) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb42-1651"><a href="#cb42-1651" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(solarAngle)<span class="op">;</span></span>
<span id="cb42-1652"><a href="#cb42-1652" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> stretch <span class="op">*</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(solarAngle)<span class="op">;</span></span>
<span id="cb42-1653"><a href="#cb42-1653" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> spin <span class="op">=</span> <span class="dv">180</span> <span class="op">+</span> <span class="op">-</span>location[<span class="dv">0</span>] <span class="op">+</span> solarAngleDeg <span class="op">+</span> <span class="dv">360</span> <span class="op">*</span> ((hour <span class="op">+</span> <span class="dv">12</span>) <span class="op">/</span> <span class="dv">24</span>)<span class="op">;</span></span>
<span id="cb42-1654"><a href="#cb42-1654" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthGeo <span class="op">=</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> }<span class="op">;</span></span>
<span id="cb42-1655"><a href="#cb42-1655" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb42-1656"><a href="#cb42-1656" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb42-1657"><a href="#cb42-1657" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb42-1658"><a href="#cb42-1658" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([spin<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="fl">23.5</span>])</span>
<span id="cb42-1659"><a href="#cb42-1659" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb42-1660"><a href="#cb42-1660" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticProjection <span class="op">=</span> d3</span>
<span id="cb42-1661"><a href="#cb42-1661" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb42-1662"><a href="#cb42-1662" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb42-1663"><a href="#cb42-1663" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([solarAngleDeg <span class="op">-</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">0</span>])</span>
<span id="cb42-1664"><a href="#cb42-1664" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb42-1665"><a href="#cb42-1665" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">1.5</span>)<span class="op">;</span></span>
<span id="cb42-1666"><a href="#cb42-1666" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticPath <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(staticProjection)<span class="op">;</span></span>
<span id="cb42-1667"><a href="#cb42-1667" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> oceanColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb42-1668"><a href="#cb42-1668" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> landColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb42-1669"><a href="#cb42-1669" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> borderColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb42-1670"><a href="#cb42-1670" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystem <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb42-1671"><a href="#cb42-1671" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb42-1672"><a href="#cb42-1672" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>vizwidth <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb42-1673"><a href="#cb42-1673" aria-hidden="true" tabindex="-1"></a>  <span class="co">// solarSystem.append("circle").attr("r", sunRadius).attr("fill", colors.sun);</span></span>
<span id="cb42-1674"><a href="#cb42-1674" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Draw orbit */</span></span>
<span id="cb42-1675"><a href="#cb42-1675" aria-hidden="true" tabindex="-1"></a>    solarSystem</span>
<span id="cb42-1676"><a href="#cb42-1676" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"ellipse"</span>)</span>
<span id="cb42-1677"><a href="#cb42-1677" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> solarSystemRadius)</span>
<span id="cb42-1678"><a href="#cb42-1678" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> stretch <span class="op">*</span> solarSystemRadius)</span>
<span id="cb42-1679"><a href="#cb42-1679" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb42-1680"><a href="#cb42-1680" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.25"</span>)</span>
<span id="cb42-1681"><a href="#cb42-1681" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb42-1682"><a href="#cb42-1682" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* Draw month ticks */</span></span>
<span id="cb42-1683"><a href="#cb42-1683" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">12</span>)<span class="op">.</span><span class="fu">map</span>((m) <span class="kw">=&gt;</span> {</span>
<span id="cb42-1684"><a href="#cb42-1684" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> d <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb42-1685"><a href="#cb42-1685" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> angle <span class="op">=</span> <span class="fu">getSolarAngle</span>(d)<span class="op">;</span></span>
<span id="cb42-1686"><a href="#cb42-1686" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb42-1687"><a href="#cb42-1687" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb42-1688"><a href="#cb42-1688" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb42-1689"><a href="#cb42-1689" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb42-1690"><a href="#cb42-1690" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb42-1691"><a href="#cb42-1691" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb42-1692"><a href="#cb42-1692" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.75"</span>)</span>
<span id="cb42-1693"><a href="#cb42-1693" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb42-1694"><a href="#cb42-1694" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> startMonthAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(<span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb42-1695"><a href="#cb42-1695" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb42-1696"><a href="#cb42-1696" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb42-1697"><a href="#cb42-1697" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="fu">date2doty</span>(d))</span>
<span id="cb42-1698"><a href="#cb42-1698" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">18</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(startMonthAngle) <span class="op">*</span> <span class="fl">1.1</span>)</span>
<span id="cb42-1699"><a href="#cb42-1699" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb42-1700"><a href="#cb42-1700" aria-hidden="true" tabindex="-1"></a>          <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb42-1701"><a href="#cb42-1701" aria-hidden="true" tabindex="-1"></a>          (solarSystemRadius <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">3</span>) <span class="op">*</span> <span class="fl">6.2</span> <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle)) <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb42-1702"><a href="#cb42-1702" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb42-1703"><a href="#cb42-1703" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb42-1704"><a href="#cb42-1704" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb42-1705"><a href="#cb42-1705" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> <span class="fl">1.2</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1706"><a href="#cb42-1706" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb42-1707"><a href="#cb42-1707" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb42-1708"><a href="#cb42-1708" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb42-1709"><a href="#cb42-1709" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> earth <span class="op">=</span> solarSystem</span>
<span id="cb42-1710"><a href="#cb42-1710" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb42-1711"><a href="#cb42-1711" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>y<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb42-1712"><a href="#cb42-1712" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">drawEarth</span>() {</span>
<span id="cb42-1713"><a href="#cb42-1713" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`rotate(-23.5)`</span>)<span class="op">;</span></span>
<span id="cb42-1714"><a href="#cb42-1714" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(earthGeo))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeOcean"</span>)<span class="op">;</span></span>
<span id="cb42-1715"><a href="#cb42-1715" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(land))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeLand"</span>)<span class="op">;</span></span>
<span id="cb42-1716"><a href="#cb42-1716" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(countries))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">".08"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeBorders"</span>)<span class="op">;</span></span>
<span id="cb42-1717"><a href="#cb42-1717" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">5.5</span>)<span class="op">;</span></span>
<span id="cb42-1718"><a href="#cb42-1718" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb42-1719"><a href="#cb42-1719" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">4.5</span>)<span class="op">;</span></span>
<span id="cb42-1720"><a href="#cb42-1720" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">2.25</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb42-1721"><a href="#cb42-1721" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-1722"><a href="#cb42-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb42-1723"><a href="#cb42-1723" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1724"><a href="#cb42-1724" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greg2doty</span>(month <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> day <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb42-1725"><a href="#cb42-1725" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb42-1726"><a href="#cb42-1726" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> day <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb42-1727"><a href="#cb42-1727" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb42-1728"><a href="#cb42-1728" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty</span>(date) {</span>
<span id="cb42-1729"><a href="#cb42-1729" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb42-1730"><a href="#cb42-1730" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1731"><a href="#cb42-1731" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty1</span>(date) {</span>
<span id="cb42-1732"><a href="#cb42-1732" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb42-1733"><a href="#cb42-1733" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1734"><a href="#cb42-1734" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb42-1735"><a href="#cb42-1735" aria-hidden="true" tabindex="-1"></a><span class="co">// globe = (root, { vizwidth, location, date, hour }) =&gt; {</span></span>
<span id="cb42-1736"><a href="#cb42-1736" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngle = getSolarAngle(date);</span></span>
<span id="cb42-1737"><a href="#cb42-1737" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngleDeg = toDegrees(solarAngle);</span></span>
<span id="cb42-1738"><a href="#cb42-1738" aria-hidden="true" tabindex="-1"></a><span class="co">//   const hourSpin = 360 * ((hour + 12) / 24);</span></span>
<span id="cb42-1739"><a href="#cb42-1739" aria-hidden="true" tabindex="-1"></a><span class="co">//   const spin = (180 + -location[0] + solarAngleDeg + hourSpin);</span></span>
<span id="cb42-1740"><a href="#cb42-1740" aria-hidden="true" tabindex="-1"></a><span class="co">//   const tilt = -15;</span></span>
<span id="cb42-1741"><a href="#cb42-1741" aria-hidden="true" tabindex="-1"></a><span class="co">//   const projection = d3.geoOrthographic()</span></span>
<span id="cb42-1742"><a href="#cb42-1742" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .fitWidth(vizwidth, graticule)</span></span>
<span id="cb42-1743"><a href="#cb42-1743" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb42-1744"><a href="#cb42-1744" aria-hidden="true" tabindex="-1"></a><span class="co">//   const path = d3.geoPath(projection);</span></span>
<span id="cb42-1745"><a href="#cb42-1745" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedProjection = d3.geoOrthographic()</span></span>
<span id="cb42-1746"><a href="#cb42-1746" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .clipAngle(null)</span></span>
<span id="cb42-1747"><a href="#cb42-1747" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .fitWidth(vizwidth, graticule)</span></span>
<span id="cb42-1748"><a href="#cb42-1748" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb42-1749"><a href="#cb42-1749" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedPath = d3.geoPath(unClippedProjection);</span></span>
<span id="cb42-1750"><a href="#cb42-1750" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticProjection = d3.geoOrthographic()</span></span>
<span id="cb42-1751"><a href="#cb42-1751" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .fitWidth(vizwidth, graticule)</span></span>
<span id="cb42-1752"><a href="#cb42-1752" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .rotate([solarAngleDeg - 90, tilt]);</span></span>
<span id="cb42-1753"><a href="#cb42-1753" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticPath = d3.geoPath(staticProjection);</span></span>
<span id="cb42-1754"><a href="#cb42-1754" aria-hidden="true" tabindex="-1"></a><span class="co">//   const background = root.append("g");</span></span>
<span id="cb42-1755"><a href="#cb42-1755" aria-hidden="true" tabindex="-1"></a><span class="co">//   const earth = root.append("g").style("opacity", 0.75);</span></span>
<span id="cb42-1756"><a href="#cb42-1756" aria-hidden="true" tabindex="-1"></a><span class="co">//   const foreground = root.append("g");</span></span>
<span id="cb42-1757"><a href="#cb42-1757" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb42-1758"><a href="#cb42-1758" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Sphere"}))</span></span>
<span id="cb42-1759"><a href="#cb42-1759" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.ocean)</span></span>
<span id="cb42-1760"><a href="#cb42-1760" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#9ecbda");</span></span>
<span id="cb42-1761"><a href="#cb42-1761" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb42-1762"><a href="#cb42-1762" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(land))</span></span>
<span id="cb42-1763"><a href="#cb42-1763" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.land);</span></span>
<span id="cb42-1764"><a href="#cb42-1764" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb42-1765"><a href="#cb42-1765" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(countries))</span></span>
<span id="cb42-1766"><a href="#cb42-1766" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", "1")</span></span>
<span id="cb42-1767"><a href="#cb42-1767" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb42-1768"><a href="#cb42-1768" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#000");</span></span>
<span id="cb42-1769"><a href="#cb42-1769" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb42-1770"><a href="#cb42-1770" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath({type: "Point", coordinates: location}))</span></span>
<span id="cb42-1771"><a href="#cb42-1771" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb42-1772"><a href="#cb42-1772" aria-hidden="true" tabindex="-1"></a><span class="co">//   const latitudeCoords = (latitude, start, end) =&gt; {</span></span>
<span id="cb42-1773"><a href="#cb42-1773" aria-hidden="true" tabindex="-1"></a><span class="co">//     const longitudes = d3.range(start, end, 2).concat(end);</span></span>
<span id="cb42-1774"><a href="#cb42-1774" aria-hidden="true" tabindex="-1"></a><span class="co">//     return longitudes.map(d =&gt; [d, latitude]);</span></span>
<span id="cb42-1775"><a href="#cb42-1775" aria-hidden="true" tabindex="-1"></a><span class="co">//   }</span></span>
<span id="cb42-1776"><a href="#cb42-1776" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctSpin = d3.geoRotation([-hourSpin, 0]);</span></span>
<span id="cb42-1777"><a href="#cb42-1777" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctTilt = d3.geoRotation([6, 0, 0]);</span></span>
<span id="cb42-1778"><a href="#cb42-1778" aria-hidden="true" tabindex="-1"></a><span class="co">//   /* total angular extent of day/night */</span></span>
<span id="cb42-1779"><a href="#cb42-1779" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayExtent = 360 * dayLength(date, location[1]) / 24;</span></span>
<span id="cb42-1780"><a href="#cb42-1780" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightExtent = 360 - dayExtent;</span></span>
<span id="cb42-1781"><a href="#cb42-1781" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayLine = {</span></span>
<span id="cb42-1782"><a href="#cb42-1782" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb42-1783"><a href="#cb42-1783" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb42-1784"><a href="#cb42-1784" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2,</span></span>
<span id="cb42-1785"><a href="#cb42-1785" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] + dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb42-1786"><a href="#cb42-1786" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb42-1787"><a href="#cb42-1787" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightLine = {</span></span>
<span id="cb42-1788"><a href="#cb42-1788" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb42-1789"><a href="#cb42-1789" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb42-1790"><a href="#cb42-1790" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2 - nightExtent,</span></span>
<span id="cb42-1791"><a href="#cb42-1791" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb42-1792"><a href="#cb42-1792" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb42-1793"><a href="#cb42-1793" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb42-1794"><a href="#cb42-1794" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(dayLine))</span></span>
<span id="cb42-1795"><a href="#cb42-1795" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb42-1796"><a href="#cb42-1796" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb42-1797"><a href="#cb42-1797" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb42-1798"><a href="#cb42-1798" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb42-1799"><a href="#cb42-1799" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(nightLine))</span></span>
<span id="cb42-1800"><a href="#cb42-1800" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb42-1801"><a href="#cb42-1801" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb42-1802"><a href="#cb42-1802" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb42-1803"><a href="#cb42-1803" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb42-1804"><a href="#cb42-1804" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(dayLine))</span></span>
<span id="cb42-1805"><a href="#cb42-1805" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb42-1806"><a href="#cb42-1806" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb42-1807"><a href="#cb42-1807" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb42-1808"><a href="#cb42-1808" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb42-1809"><a href="#cb42-1809" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(nightLine))</span></span>
<span id="cb42-1810"><a href="#cb42-1810" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb42-1811"><a href="#cb42-1811" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb42-1812"><a href="#cb42-1812" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb42-1813"><a href="#cb42-1813" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb42-1814"><a href="#cb42-1814" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Point", coordinates: location}))</span></span>
<span id="cb42-1815"><a href="#cb42-1815" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", .5)</span></span>
<span id="cb42-1816"><a href="#cb42-1816" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "black")</span></span>
<span id="cb42-1817"><a href="#cb42-1817" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb42-1818"><a href="#cb42-1818" aria-hidden="true" tabindex="-1"></a><span class="co">//   const shadowPolygon = [[0, -90], [0, 0], [0, 90], [180, 0], [0, -90]].map(d =&gt; correctTilt(d));</span></span>
<span id="cb42-1819"><a href="#cb42-1819" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb42-1820"><a href="#cb42-1820" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", staticPath({type: "Polygon", coordinates: [shadowPolygon]}))</span></span>
<span id="cb42-1821"><a href="#cb42-1821" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "rgba(0, 0, 0, 0.25)");</span></span>
<span id="cb42-1822"><a href="#cb42-1822" aria-hidden="true" tabindex="-1"></a><span class="co">// }</span></span>
<span id="cb42-1823"><a href="#cb42-1823" aria-hidden="true" tabindex="-1"></a>dayOfYear <span class="op">=</span> (date) <span class="kw">=&gt;</span> {</span>
<span id="cb42-1824"><a href="#cb42-1824" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb42-1825"><a href="#cb42-1825" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb42-1826"><a href="#cb42-1826" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1827"><a href="#cb42-1827" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb42-1828"><a href="#cb42-1828" aria-hidden="true" tabindex="-1"></a>daylightPlot <span class="op">=</span> (</span>
<span id="cb42-1829"><a href="#cb42-1829" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span><span class="op">,</span></span>
<span id="cb42-1830"><a href="#cb42-1830" aria-hidden="true" tabindex="-1"></a>  { vizwidth<span class="op">,</span> height<span class="op">,</span> year<span class="op">,</span> latitude<span class="op">,</span> defaultDate<span class="op">,</span> defaultHour }</span>
<span id="cb42-1831"><a href="#cb42-1831" aria-hidden="true" tabindex="-1"></a>) <span class="kw">=&gt;</span> {</span>
<span id="cb42-1832"><a href="#cb42-1832" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">;</span></span>
<span id="cb42-1833"><a href="#cb42-1833" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartWidth <span class="op">=</span> vizwidth <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">;</span></span>
<span id="cb42-1834"><a href="#cb42-1834" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartHeight <span class="op">=</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb42-1835"><a href="#cb42-1835" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yTickValues <span class="op">=</span></span>
<span id="cb42-1836"><a href="#cb42-1836" aria-hidden="true" tabindex="-1"></a>    width <span class="op">&gt;</span> <span class="dv">380</span> <span class="op">?</span> [<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">21</span>] <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">90</span> <span class="op">?</span> [<span class="dv">6</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">18</span>] <span class="op">:</span> [<span class="dv">12</span>]<span class="op">;</span></span>
<span id="cb42-1837"><a href="#cb42-1837" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yScale <span class="op">=</span> d3</span>
<span id="cb42-1838"><a href="#cb42-1838" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb42-1839"><a href="#cb42-1839" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">24</span>])</span>
<span id="cb42-1840"><a href="#cb42-1840" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth])</span>
<span id="cb42-1841"><a href="#cb42-1841" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb42-1842"><a href="#cb42-1842" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis scale</span></span>
<span id="cb42-1843"><a href="#cb42-1843" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xScale <span class="op">=</span> d3</span>
<span id="cb42-1844"><a href="#cb42-1844" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleTime</span>()</span>
<span id="cb42-1845"><a href="#cb42-1845" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">61</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">91</span>)])</span>
<span id="cb42-1846"><a href="#cb42-1846" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">top</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight])</span>
<span id="cb42-1847"><a href="#cb42-1847" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb42-1848"><a href="#cb42-1848" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis labels</span></span>
<span id="cb42-1849"><a href="#cb42-1849" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3</span>
<span id="cb42-1850"><a href="#cb42-1850" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisBottom</span>(xScale)</span>
<span id="cb42-1851"><a href="#cb42-1851" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(d3<span class="op">.</span><span class="at">timeMonth</span><span class="op">.</span><span class="fu">range</span>(<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">60</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">57</span>)))</span>
<span id="cb42-1852"><a href="#cb42-1852" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartWidth)</span>
<span id="cb42-1853"><a href="#cb42-1853" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(date2doty1)<span class="op">;</span></span>
<span id="cb42-1854"><a href="#cb42-1854" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3</span>
<span id="cb42-1855"><a href="#cb42-1855" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisLeft</span>(yScale)</span>
<span id="cb42-1856"><a href="#cb42-1856" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(yTickValues)</span>
<span id="cb42-1857"><a href="#cb42-1857" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartHeight)</span>
<span id="cb42-1858"><a href="#cb42-1858" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>((d) <span class="kw">=&gt;</span> { <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>d <span class="op">/</span> <span class="op">.</span><span class="bn">024</span><span class="sc">}</span><span class="vs">`</span> })<span class="op">;</span></span>
<span id="cb42-1859"><a href="#cb42-1859" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> date <span class="op">=</span> defaultDate <span class="op">||</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb42-1860"><a href="#cb42-1860" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> hour <span class="op">=</span> defaultHour <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> defaultHour <span class="op">:</span> date<span class="op">.</span><span class="fu">getHours</span>()<span class="op">;</span></span>
<span id="cb42-1861"><a href="#cb42-1861" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleMouseMove <span class="op">=</span> (e) <span class="kw">=&gt;</span> {}<span class="op">;</span></span>
<span id="cb42-1862"><a href="#cb42-1862" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb42-1863"><a href="#cb42-1863" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb42-1864"><a href="#cb42-1864" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span>)</span>
<span id="cb42-1865"><a href="#cb42-1865" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb42-1866"><a href="#cb42-1866" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb42-1867"><a href="#cb42-1867" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> chartHeight)</span>
<span id="cb42-1868"><a href="#cb42-1868" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> <span class="fl">0.05</span> <span class="op">*</span> vizwidth)</span>
<span id="cb42-1869"><a href="#cb42-1869" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb42-1870"><a href="#cb42-1870" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb42-1871"><a href="#cb42-1871" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb42-1872"><a href="#cb42-1872" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb42-1873"><a href="#cb42-1873" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb42-1874"><a href="#cb42-1874" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb42-1875"><a href="#cb42-1875" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb42-1876"><a href="#cb42-1876" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">7</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">.</span><span class="dv">725</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">75</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> <span class="fl">1.4</span>) <span class="op">*</span> fontSize))</span>
<span id="cb42-1877"><a href="#cb42-1877" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb42-1878"><a href="#cb42-1878" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb42-1879"><a href="#cb42-1879" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb42-1880"><a href="#cb42-1880" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb42-1881"><a href="#cb42-1881" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartHeight<span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb42-1882"><a href="#cb42-1882" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb42-1883"><a href="#cb42-1883" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb42-1884"><a href="#cb42-1884" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb42-1885"><a href="#cb42-1885" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.3</span>) <span class="op">*</span> fontSize))</span>
<span id="cb42-1886"><a href="#cb42-1886" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb42-1887"><a href="#cb42-1887" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb42-1888"><a href="#cb42-1888" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb42-1889"><a href="#cb42-1889" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb42-1890"><a href="#cb42-1890" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Time of day"</span>)</span>
<span id="cb42-1891"><a href="#cb42-1891" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="op">-</span><span class="dv">102</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">-</span><span class="dv">106</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">-</span><span class="dv">108</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">-</span><span class="dv">115</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">-</span><span class="dv">120</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">128</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">425</span> <span class="op">?</span> <span class="op">-</span><span class="dv">130</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">-</span><span class="dv">132</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="op">-</span><span class="dv">136</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">141</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">525</span> <span class="op">?</span> <span class="op">-</span><span class="dv">142</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">-</span><span class="dv">148</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">575</span> <span class="op">?</span> <span class="op">-</span><span class="dv">149</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">154</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">675</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">-</span><span class="dv">161</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">725</span> <span class="op">?</span> <span class="op">-</span><span class="dv">160</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="op">-</span><span class="dv">165</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">775</span> <span class="op">?</span> <span class="op">-</span><span class="dv">169</span> <span class="op">:</span> <span class="op">-</span><span class="dv">173</span>))</span>
<span id="cb42-1892"><a href="#cb42-1892" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">33</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">35</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">42</span>))</span>
<span id="cb42-1893"><a href="#cb42-1893" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb42-1894"><a href="#cb42-1894" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1895"><a href="#cb42-1895" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb42-1896"><a href="#cb42-1896" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb42-1897"><a href="#cb42-1897" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb42-1898"><a href="#cb42-1898" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb42-1899"><a href="#cb42-1899" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb42-1900"><a href="#cb42-1900" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day of year"</span>)</span>
<span id="cb42-1901"><a href="#cb42-1901" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">28</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> <span class="dv">22</span>))</span>
<span id="cb42-1902"><a href="#cb42-1902" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight <span class="op">/</span> <span class="dv">4</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">39</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">51</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">43</span>))</span>
<span id="cb42-1903"><a href="#cb42-1903" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb42-1904"><a href="#cb42-1904" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1905"><a href="#cb42-1905" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb42-1906"><a href="#cb42-1906" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb42-1907"><a href="#cb42-1907" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="fu">yearDates</span>(year)</span>
<span id="cb42-1908"><a href="#cb42-1908" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">,</span> <span class="fu">dayLength</span>(d<span class="op">,</span> latitude)])</span>
<span id="cb42-1909"><a href="#cb42-1909" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(([_<span class="op">,</span> d]) <span class="kw">=&gt;</span> d <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb42-1910"><a href="#cb42-1910" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Render separate polygons for each continuous sequence of</span></span>
<span id="cb42-1911"><a href="#cb42-1911" aria-hidden="true" tabindex="-1"></a><span class="co">   * days with more than 0 hours of day light</span></span>
<span id="cb42-1912"><a href="#cb42-1912" aria-hidden="true" tabindex="-1"></a><span class="co">   */</span></span>
<span id="cb42-1913"><a href="#cb42-1913" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> polys <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb42-1914"><a href="#cb42-1914" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> currentPoly <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb42-1915"><a href="#cb42-1915" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> data<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb42-1916"><a href="#cb42-1916" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> currentDate <span class="op">=</span> data[i][<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb42-1917"><a href="#cb42-1917" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prevDate <span class="op">=</span> (data[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">||</span> [])[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb42-1918"><a href="#cb42-1918" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb42-1919"><a href="#cb42-1919" aria-hidden="true" tabindex="-1"></a>      i <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span></span>
<span id="cb42-1920"><a href="#cb42-1920" aria-hidden="true" tabindex="-1"></a>      currentDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> prevDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">&lt;</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb42-1921"><a href="#cb42-1921" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb42-1922"><a href="#cb42-1922" aria-hidden="true" tabindex="-1"></a>      currentPoly<span class="op">.</span><span class="fu">push</span>(data[i])<span class="op">;</span></span>
<span id="cb42-1923"><a href="#cb42-1923" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb42-1924"><a href="#cb42-1924" aria-hidden="true" tabindex="-1"></a>      polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb42-1925"><a href="#cb42-1925" aria-hidden="true" tabindex="-1"></a>      currentPoly <span class="op">=</span> [data[i]]<span class="op">;</span></span>
<span id="cb42-1926"><a href="#cb42-1926" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-1927"><a href="#cb42-1927" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-1928"><a href="#cb42-1928" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb42-1929"><a href="#cb42-1929" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">forEach</span>((p) <span class="kw">=&gt;</span> {</span>
<span id="cb42-1930"><a href="#cb42-1930" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> points <span class="op">=</span> [</span>
<span id="cb42-1931"><a href="#cb42-1931" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">-</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">,</span></span>
<span id="cb42-1932"><a href="#cb42-1932" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">reverse</span>()<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">+</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb42-1933"><a href="#cb42-1933" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">.</span><span class="fu">join</span>(<span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb42-1934"><a href="#cb42-1934" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"polygon"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"points"</span><span class="op">,</span> points)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb42-1935"><a href="#cb42-1935" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb42-1936"><a href="#cb42-1936" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Legend */</span></span>
<span id="cb42-1937"><a href="#cb42-1937" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb42-1938"><a href="#cb42-1938" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb42-1939"><a href="#cb42-1939" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">64</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb42-1940"><a href="#cb42-1940" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb42-1941"><a href="#cb42-1941" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb42-1942"><a href="#cb42-1942" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">63</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">61</span> <span class="op">:</span> <span class="dv">60</span>)</span>
<span id="cb42-1943"><a href="#cb42-1943" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb42-1944"><a href="#cb42-1944" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb42-1945"><a href="#cb42-1945" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1946"><a href="#cb42-1946" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1947"><a href="#cb42-1947" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb42-1948"><a href="#cb42-1948" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb42-1949"><a href="#cb42-1949" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb42-1950"><a href="#cb42-1950" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">82</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">85</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">87</span> <span class="op">:</span> <span class="dv">90</span>)</span>
<span id="cb42-1951"><a href="#cb42-1951" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb42-1952"><a href="#cb42-1952" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1953"><a href="#cb42-1953" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb42-1954"><a href="#cb42-1954" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day"</span>)<span class="op">;</span></span>
<span id="cb42-1955"><a href="#cb42-1955" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb42-1956"><a href="#cb42-1956" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb42-1957"><a href="#cb42-1957" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">40</span> <span class="op">:</span> <span class="op">-</span><span class="dv">39</span>)</span>
<span id="cb42-1958"><a href="#cb42-1958" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb42-1959"><a href="#cb42-1959" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb42-1960"><a href="#cb42-1960" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1961"><a href="#cb42-1961" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1962"><a href="#cb42-1962" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb42-1963"><a href="#cb42-1963" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb42-1964"><a href="#cb42-1964" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb42-1965"><a href="#cb42-1965" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">11</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">12</span> <span class="op">:</span> <span class="op">-</span><span class="dv">9</span>)</span>
<span id="cb42-1966"><a href="#cb42-1966" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb42-1967"><a href="#cb42-1967" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb42-1968"><a href="#cb42-1968" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb42-1969"><a href="#cb42-1969" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Night"</span>)<span class="op">;</span></span>
<span id="cb42-1970"><a href="#cb42-1970" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Time and date controls */</span></span>
<span id="cb42-1971"><a href="#cb42-1971" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dateLine <span class="op">=</span> <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb42-1972"><a href="#cb42-1972" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updateControlPositions <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb42-1973"><a href="#cb42-1973" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb42-1974"><a href="#cb42-1974" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"line"</span>)</span>
<span id="cb42-1975"><a href="#cb42-1975" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb42-1976"><a href="#cb42-1976" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScale</span>(date))</span>
<span id="cb42-1977"><a href="#cb42-1977" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">24</span>))</span>
<span id="cb42-1978"><a href="#cb42-1978" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb42-1979"><a href="#cb42-1979" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb42-1980"><a href="#cb42-1980" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"rect"</span>)</span>
<span id="cb42-1981"><a href="#cb42-1981" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb42-1982"><a href="#cb42-1982" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">xScale</span>(date) <span class="op">-</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb42-1983"><a href="#cb42-1983" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span></span>
<span id="cb42-1984"><a href="#cb42-1984" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#time-control"</span>)</span>
<span id="cb42-1985"><a href="#cb42-1985" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">yScale</span>(hour))</span>
<span id="cb42-1986"><a href="#cb42-1986" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb42-1987"><a href="#cb42-1987" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb42-1988"><a href="#cb42-1988" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dispatchDateHourChange <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb42-1989"><a href="#cb42-1989" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> detail <span class="op">=</span> { date<span class="op">,</span> hour }<span class="op">;</span></span>
<span id="cb42-1990"><a href="#cb42-1990" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> changeEvent <span class="op">=</span> <span class="kw">new</span> <span class="bu">CustomEvent</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> {</span>
<span id="cb42-1991"><a href="#cb42-1991" aria-hidden="true" tabindex="-1"></a>      detail<span class="op">,</span></span>
<span id="cb42-1992"><a href="#cb42-1992" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb42-1993"><a href="#cb42-1993" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb42-1994"><a href="#cb42-1994" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">dispatchEvent</span>(changeEvent)<span class="op">;</span></span>
<span id="cb42-1995"><a href="#cb42-1995" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb42-1996"><a href="#cb42-1996" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateLineDrag <span class="op">=</span> ({ x }) <span class="kw">=&gt;</span> {</span>
<span id="cb42-1997"><a href="#cb42-1997" aria-hidden="true" tabindex="-1"></a>    date <span class="op">=</span> xScale<span class="op">.</span><span class="fu">invert</span>(x)<span class="op">;</span></span>
<span id="cb42-1998"><a href="#cb42-1998" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb42-1999"><a href="#cb42-1999" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb42-2000"><a href="#cb42-2000" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb42-2001"><a href="#cb42-2001" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleTimeCircleDrag <span class="op">=</span> ({ y }) <span class="kw">=&gt;</span> {</span>
<span id="cb42-2002"><a href="#cb42-2002" aria-hidden="true" tabindex="-1"></a>    hour <span class="op">=</span> yScale<span class="op">.</span><span class="fu">invert</span>(y)<span class="op">;</span></span>
<span id="cb42-2003"><a href="#cb42-2003" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb42-2004"><a href="#cb42-2004" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb42-2005"><a href="#cb42-2005" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb42-2006"><a href="#cb42-2006" aria-hidden="true" tabindex="-1"></a>  dateLine<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb42-2007"><a href="#cb42-2007" aria-hidden="true" tabindex="-1"></a>  dateLine</span>
<span id="cb42-2008"><a href="#cb42-2008" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb42-2009"><a href="#cb42-2009" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb42-2010"><a href="#cb42-2010" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb42-2011"><a href="#cb42-2011" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"rgba(0, 0, 0, 0)"</span>)</span>
<span id="cb42-2012"><a href="#cb42-2012" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"row-resize"</span>)</span>
<span id="cb42-2013"><a href="#cb42-2013" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleDateLineDrag))<span class="op">;</span></span>
<span id="cb42-2014"><a href="#cb42-2014" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb42-2015"><a href="#cb42-2015" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb42-2016"><a href="#cb42-2016" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"time-control"</span>)</span>
<span id="cb42-2017"><a href="#cb42-2017" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">12</span>)</span>
<span id="cb42-2018"><a href="#cb42-2018" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"red"</span>)</span>
<span id="cb42-2019"><a href="#cb42-2019" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)</span>
<span id="cb42-2020"><a href="#cb42-2020" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb42-2021"><a href="#cb42-2021" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"pointer"</span>)</span>
<span id="cb42-2022"><a href="#cb42-2022" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleTimeCircleDrag))<span class="op">;</span></span>
<span id="cb42-2023"><a href="#cb42-2023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb42-2024"><a href="#cb42-2024" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-2025"><a href="#cb42-2025" aria-hidden="true" tabindex="-1"></a>fontSize <span class="op">=</span> <span class="dv">14</span><span class="op">;</span></span>
<span id="cb42-2026"><a href="#cb42-2026" aria-hidden="true" tabindex="-1"></a>getSolarAngle <span class="op">=</span> (date) <span class="kw">=&gt;</span> (<span class="fu">dayOfYear</span>(date) <span class="op">+</span> <span class="dv">10</span>) <span class="op">/</span> <span class="dv">365</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb42-2027"><a href="#cb42-2027" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb42-2028"><a href="#cb42-2028" aria-hidden="true" tabindex="-1"></a><span class="co"> * Formulas uses the CBM model as reviewed here:</span></span>
<span id="cb42-2029"><a href="#cb42-2029" aria-hidden="true" tabindex="-1"></a><span class="co"> * https://www.ikhebeenvraag.be/mediastorage/FSDocument/171/Forsythe+-+A+model+comparison+for+daylength+as+a+function+of+latitude+and+day+of+year+-+1995.pdf</span></span>
<span id="cb42-2030"><a href="#cb42-2030" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb42-2031"><a href="#cb42-2031" aria-hidden="true" tabindex="-1"></a>dayLength <span class="op">=</span> (date<span class="op">,</span> latitude) <span class="kw">=&gt;</span> {</span>
<span id="cb42-2032"><a href="#cb42-2032" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb42-2033"><a href="#cb42-2033" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dayOfYear <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb42-2034"><a href="#cb42-2034" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> revAngle <span class="op">=</span> <span class="fl">0.2163108</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>(<span class="fl">0.9671396</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">tan</span>(<span class="fl">0.00860</span> <span class="op">*</span> (dayOfYear <span class="op">-</span> <span class="dv">186</span>)))<span class="op">;</span></span>
<span id="cb42-2035"><a href="#cb42-2035" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decAngle <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">asin</span>(<span class="fl">0.39795</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(revAngle))<span class="op">;</span></span>
<span id="cb42-2036"><a href="#cb42-2036" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* daylight coefficient selected for apparent sunrise/sunset */</span></span>
<span id="cb42-2037"><a href="#cb42-2037" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> p <span class="op">=</span> <span class="fl">0.8333</span></span>
<span id="cb42-2038"><a href="#cb42-2038" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> intResult <span class="op">=</span></span>
<span id="cb42-2039"><a href="#cb42-2039" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((p <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">+</span></span>
<span id="cb42-2040"><a href="#cb42-2040" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(decAngle)) <span class="op">/</span></span>
<span id="cb42-2041"><a href="#cb42-2041" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(decAngle))<span class="op">;</span></span>
<span id="cb42-2042"><a href="#cb42-2042" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&gt;=</span> <span class="dv">1</span>) <span class="cf">return</span> <span class="dv">24</span><span class="op">;</span></span>
<span id="cb42-2043"><a href="#cb42-2043" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&lt;=</span> <span class="op">-</span><span class="dv">1</span>) <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb42-2044"><a href="#cb42-2044" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">24</span> <span class="op">-</span> <span class="dv">24</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">acos</span>(intResult) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb42-2045"><a href="#cb42-2045" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-2046"><a href="#cb42-2046" aria-hidden="true" tabindex="-1"></a>yearDates <span class="op">=</span> (year) <span class="kw">=&gt;</span> {</span>
<span id="cb42-2047"><a href="#cb42-2047" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> startDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb42-2048"><a href="#cb42-2048" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> endDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb42-2049"><a href="#cb42-2049" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d3<span class="op">.</span><span class="at">timeDay</span><span class="op">.</span><span class="fu">range</span>(startDate<span class="op">,</span> endDate)<span class="op">;</span></span>
<span id="cb42-2050"><a href="#cb42-2050" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-2051"><a href="#cb42-2051" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="fl">0.65</span> <span class="op">*</span> width<span class="op">;</span></span>
<span id="cb42-2052"><a href="#cb42-2052" aria-hidden="true" tabindex="-1"></a>EventType <span class="op">=</span> ({</span>
<span id="cb42-2053"><a href="#cb42-2053" aria-hidden="true" tabindex="-1"></a>  <span class="dt">LocationChange</span><span class="op">:</span> <span class="st">"LOCATION_CHANGE"</span><span class="op">,</span></span>
<span id="cb42-2054"><a href="#cb42-2054" aria-hidden="true" tabindex="-1"></a>  <span class="dt">DateHourChange</span><span class="op">:</span> <span class="st">"DATE_HOUR_CHANGE"</span></span>
<span id="cb42-2055"><a href="#cb42-2055" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb42-2056"><a href="#cb42-2056" aria-hidden="true" tabindex="-1"></a>mapcolors <span class="op">=</span> ({</span>
<span id="cb42-2057"><a href="#cb42-2057" aria-hidden="true" tabindex="-1"></a>  <span class="dt">night</span><span class="op">:</span> <span class="st">"#719fb6"</span><span class="op">,</span></span>
<span id="cb42-2058"><a href="#cb42-2058" aria-hidden="true" tabindex="-1"></a>  <span class="dt">day</span><span class="op">:</span> <span class="st">"#ffe438"</span><span class="op">,</span></span>
<span id="cb42-2059"><a href="#cb42-2059" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="st">"#4b6a79"</span><span class="op">,</span></span>
<span id="cb42-2060"><a href="#cb42-2060" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ocean</span><span class="op">:</span> <span class="st">"#adeeff"</span><span class="op">,</span></span>
<span id="cb42-2061"><a href="#cb42-2061" aria-hidden="true" tabindex="-1"></a>  <span class="dt">land</span><span class="op">:</span> <span class="st">"#90ff7888"</span><span class="op">,</span></span>
<span id="cb42-2062"><a href="#cb42-2062" aria-hidden="true" tabindex="-1"></a>  <span class="dt">sun</span><span class="op">:</span> <span class="st">"#ffb438"</span></span>
<span id="cb42-2063"><a href="#cb42-2063" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb42-2064"><a href="#cb42-2064" aria-hidden="true" tabindex="-1"></a>toRadians <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span></span>
<span id="cb42-2065"><a href="#cb42-2065" aria-hidden="true" tabindex="-1"></a>toDegrees <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="dv">180</span> <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb42-2066"><a href="#cb42-2066" aria-hidden="true" tabindex="-1"></a>land <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">land</span>)<span class="op">;</span></span>
<span id="cb42-2067"><a href="#cb42-2067" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3@7"</span><span class="op">,</span> <span class="st">"d3-geo-projection@3"</span>)</span>
<span id="cb42-2068"><a href="#cb42-2068" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">input</span>(config) {</span>
<span id="cb42-2069"><a href="#cb42-2069" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> {</span>
<span id="cb42-2070"><a href="#cb42-2070" aria-hidden="true" tabindex="-1"></a>    form<span class="op">,</span></span>
<span id="cb42-2071"><a href="#cb42-2071" aria-hidden="true" tabindex="-1"></a>    type <span class="op">=</span> <span class="st">"text"</span><span class="op">,</span></span>
<span id="cb42-2072"><a href="#cb42-2072" aria-hidden="true" tabindex="-1"></a>    attributes <span class="op">=</span> {}<span class="op">,</span></span>
<span id="cb42-2073"><a href="#cb42-2073" aria-hidden="true" tabindex="-1"></a>    action<span class="op">,</span></span>
<span id="cb42-2074"><a href="#cb42-2074" aria-hidden="true" tabindex="-1"></a>    getValue<span class="op">,</span></span>
<span id="cb42-2075"><a href="#cb42-2075" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb42-2076"><a href="#cb42-2076" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb42-2077"><a href="#cb42-2077" aria-hidden="true" tabindex="-1"></a>    format<span class="op">,</span></span>
<span id="cb42-2078"><a href="#cb42-2078" aria-hidden="true" tabindex="-1"></a>    display<span class="op">,</span></span>
<span id="cb42-2079"><a href="#cb42-2079" aria-hidden="true" tabindex="-1"></a>    submit<span class="op">,</span></span>
<span id="cb42-2080"><a href="#cb42-2080" aria-hidden="true" tabindex="-1"></a>    options</span>
<span id="cb42-2081"><a href="#cb42-2081" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> config<span class="op">;</span></span>
<span id="cb42-2082"><a href="#cb42-2082" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> wrapper <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb42-2083"><a href="#cb42-2083" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>form)</span>
<span id="cb42-2084"><a href="#cb42-2084" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form&gt;</span></span>
<span id="cb42-2085"><a href="#cb42-2085" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;input name=input type=</span><span class="sc">${</span>type<span class="sc">}</span><span class="vs"> /&gt;</span></span>
<span id="cb42-2086"><a href="#cb42-2086" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb42-2087"><a href="#cb42-2087" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(attributes)<span class="op">.</span><span class="fu">forEach</span>(key <span class="kw">=&gt;</span> {</span>
<span id="cb42-2088"><a href="#cb42-2088" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> val <span class="op">=</span> attributes[key]<span class="op">;</span></span>
<span id="cb42-2089"><a href="#cb42-2089" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="op">!=</span> <span class="kw">null</span>) form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="fu">setAttribute</span>(key<span class="op">,</span> val)<span class="op">;</span></span>
<span id="cb42-2090"><a href="#cb42-2090" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb42-2091"><a href="#cb42-2091" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (submit)</span>
<span id="cb42-2092"><a href="#cb42-2092" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb42-2093"><a href="#cb42-2093" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;input name=submit type=submit style="margin: 0 0.75em" value="</span><span class="sc">${</span></span>
<span id="cb42-2094"><a href="#cb42-2094" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typeof</span> submit <span class="op">==</span> <span class="st">"string"</span> <span class="op">?</span> submit <span class="op">:</span> <span class="st">"Submit"</span></span>
<span id="cb42-2095"><a href="#cb42-2095" aria-hidden="true" tabindex="-1"></a>      <span class="sc">}</span><span class="vs">" /&gt;`</span></span>
<span id="cb42-2096"><a href="#cb42-2096" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb42-2097"><a href="#cb42-2097" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb42-2098"><a href="#cb42-2098" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html</span><span class="vs">`&lt;output name=output style="font: 14px Menlo, Consolas, monospace; margin-left: 0.1em; text-align:center;"&gt;&lt;/output&gt;`</span></span>
<span id="cb42-2099"><a href="#cb42-2099" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb42-2100"><a href="#cb42-2100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (title)</span>
<span id="cb42-2101"><a href="#cb42-2101" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">prepend</span>(</span>
<span id="cb42-2102"><a href="#cb42-2102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"&gt;</span><span class="sc">${</span>title<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb42-2103"><a href="#cb42-2103" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb42-2104"><a href="#cb42-2104" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (description)</span>
<span id="cb42-2105"><a href="#cb42-2105" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb42-2106"><a href="#cb42-2106" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font-size: 0.85rem; font-style: italic; margin-top: 3px;"&gt;</span><span class="sc">${</span>description<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb42-2107"><a href="#cb42-2107" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb42-2108"><a href="#cb42-2108" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (format)</span>
<span id="cb42-2109"><a href="#cb42-2109" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> <span class="kw">typeof</span> format <span class="op">===</span> <span class="st">"function"</span> <span class="op">?</span> format <span class="op">:</span> d3format<span class="op">.</span><span class="fu">format</span>(format)<span class="op">;</span></span>
<span id="cb42-2110"><a href="#cb42-2110" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (action) {</span>
<span id="cb42-2111"><a href="#cb42-2111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">action</span>(form)<span class="op">;</span></span>
<span id="cb42-2112"><a href="#cb42-2112" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-2113"><a href="#cb42-2113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> verb <span class="op">=</span> submit</span>
<span id="cb42-2114"><a href="#cb42-2114" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onsubmit"</span></span>
<span id="cb42-2115"><a href="#cb42-2115" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"button"</span></span>
<span id="cb42-2116"><a href="#cb42-2116" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onclick"</span></span>
<span id="cb42-2117"><a href="#cb42-2117" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"checkbox"</span> <span class="op">||</span> type <span class="op">==</span> <span class="st">"radio"</span></span>
<span id="cb42-2118"><a href="#cb42-2118" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onchange"</span></span>
<span id="cb42-2119"><a href="#cb42-2119" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="st">"oninput"</span><span class="op">;</span></span>
<span id="cb42-2120"><a href="#cb42-2120" aria-hidden="true" tabindex="-1"></a>    form[verb] <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb42-2121"><a href="#cb42-2121" aria-hidden="true" tabindex="-1"></a>      e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb42-2122"><a href="#cb42-2122" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> value <span class="op">=</span> getValue <span class="op">?</span> <span class="fu">getValue</span>(form<span class="op">.</span><span class="at">input</span>) <span class="op">:</span> form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb42-2123"><a href="#cb42-2123" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (form<span class="op">.</span><span class="at">output</span>) {</span>
<span id="cb42-2124"><a href="#cb42-2124" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> out <span class="op">=</span> display <span class="op">?</span> <span class="fu">display</span>(value) <span class="op">:</span> format <span class="op">?</span> <span class="fu">format</span>(value) <span class="op">:</span> value<span class="op">;</span></span>
<span id="cb42-2125"><a href="#cb42-2125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (out <span class="kw">instanceof</span> <span class="bu">window</span><span class="op">.</span><span class="at">Element</span>) {</span>
<span id="cb42-2126"><a href="#cb42-2126" aria-hidden="true" tabindex="-1"></a>          <span class="cf">while</span> (form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">hasChildNodes</span>()) {</span>
<span id="cb42-2127"><a href="#cb42-2127" aria-hidden="true" tabindex="-1"></a>            form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">removeChild</span>(form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">lastChild</span>)<span class="op">;</span></span>
<span id="cb42-2128"><a href="#cb42-2128" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb42-2129"><a href="#cb42-2129" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">append</span>(out)<span class="op">;</span></span>
<span id="cb42-2130"><a href="#cb42-2130" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb42-2131"><a href="#cb42-2131" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> out<span class="op">;</span></span>
<span id="cb42-2132"><a href="#cb42-2132" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb42-2133"><a href="#cb42-2133" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-2134"><a href="#cb42-2134" aria-hidden="true" tabindex="-1"></a>      form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb42-2135"><a href="#cb42-2135" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb42-2136"><a href="#cb42-2136" aria-hidden="true" tabindex="-1"></a>        form<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb42-2137"><a href="#cb42-2137" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb42-2138"><a href="#cb42-2138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb42-2139"><a href="#cb42-2139" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">stopPropagation</span>() <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb42-2140"><a href="#cb42-2140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"onsubmit"</span>) form<span class="op">.</span><span class="at">onsubmit</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb42-2141"><a href="#cb42-2141" aria-hidden="true" tabindex="-1"></a>    form[verb]()<span class="op">;</span></span>
<span id="cb42-2142"><a href="#cb42-2142" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-2143"><a href="#cb42-2143" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (form<span class="op">.</span><span class="at">childNodes</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb42-2144"><a href="#cb42-2144" aria-hidden="true" tabindex="-1"></a>    wrapper<span class="op">.</span><span class="fu">appendChild</span>(form<span class="op">.</span><span class="at">childNodes</span>[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb42-2145"><a href="#cb42-2145" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-2146"><a href="#cb42-2146" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(wrapper)<span class="op">;</span></span>
<span id="cb42-2147"><a href="#cb42-2147" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb42-2148"><a href="#cb42-2148" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-2149"><a href="#cb42-2149" aria-hidden="true" tabindex="-1"></a>d3format <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3-format@1"</span>)</span>
<span id="cb42-2150"><a href="#cb42-2150" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@enjalot/draggable-world-map-coordinates-input</span></span>
<span id="cb42-2151"><a href="#cb42-2151" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">worldMapCoordinates</span>(config <span class="op">=</span> {}<span class="op">,</span> dimensions) {</span>
<span id="cb42-2152"><a href="#cb42-2152" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb42-2153"><a href="#cb42-2153" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> []<span class="op">,</span> title<span class="op">,</span> description<span class="op">,</span> width <span class="op">=</span> dimensions[<span class="dv">0</span>]</span>
<span id="cb42-2154"><a href="#cb42-2154" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(config) <span class="op">?</span> {<span class="dt">value</span><span class="op">:</span> config} <span class="op">:</span> config<span class="op">;</span></span>
<span id="cb42-2155"><a href="#cb42-2155" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> dimensions[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb42-2156"><a href="#cb42-2156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> [lon<span class="op">,</span> lat] <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb42-2157"><a href="#cb42-2157" aria-hidden="true" tabindex="-1"></a>  lon <span class="op">=</span> lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb42-2158"><a href="#cb42-2158" aria-hidden="true" tabindex="-1"></a>  lat <span class="op">=</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb42-2159"><a href="#cb42-2159" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formEl <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form id="formEl" style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px;"&gt;&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb42-2160"><a href="#cb42-2160" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> context <span class="op">=</span> DOM<span class="op">.</span><span class="fu">context2d</span>(width<span class="op">,</span> height<span class="op">-</span>width<span class="op">/</span><span class="dv">14</span>)<span class="op">;</span></span>
<span id="cb42-2161"><a href="#cb42-2161" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> canvas <span class="op">=</span> context<span class="op">.</span><span class="at">canvas</span><span class="op">;</span></span>
<span id="cb42-2162"><a href="#cb42-2162" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">margin</span> <span class="op">=</span> <span class="vs">`0px 0px -26px 0px`</span><span class="op">;</span></span>
<span id="cb42-2163"><a href="#cb42-2163" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb42-2164"><a href="#cb42-2164" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoEquirectangular</span>()</span>
<span id="cb42-2165"><a href="#cb42-2165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">precision</span>(<span class="fl">0.1</span>)</span>
<span id="cb42-2166"><a href="#cb42-2166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitSize</span>([width<span class="op">,</span> height]<span class="op">,</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> })<span class="op">.</span><span class="fu">rotate</span>([<span class="op">-</span><span class="dv">153</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb42-2167"><a href="#cb42-2167" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection<span class="op">,</span> context)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">2.5</span>)<span class="op">;</span></span>
<span id="cb42-2168"><a href="#cb42-2168" aria-hidden="true" tabindex="-1"></a>  formEl<span class="op">.</span><span class="fu">append</span>(canvas)<span class="op">;</span></span>
<span id="cb42-2169"><a href="#cb42-2169" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">draw</span>() {</span>
<span id="cb42-2170"><a href="#cb42-2170" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">;</span></span>
<span id="cb42-2171"><a href="#cb42-2171" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fillRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb42-2172"><a href="#cb42-2172" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span>})<span class="op">;</span></span>
<span id="cb42-2173"><a href="#cb42-2173" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb42-2174"><a href="#cb42-2174" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb42-2175"><a href="#cb42-2175" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb42-2176"><a href="#cb42-2176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(graticule)<span class="op">;</span></span>
<span id="cb42-2177"><a href="#cb42-2177" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">;</span></span>
<span id="cb42-2178"><a href="#cb42-2178" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="vs">`#aaa`</span><span class="op">;</span></span>
<span id="cb42-2179"><a href="#cb42-2179" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb42-2180"><a href="#cb42-2180" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb42-2181"><a href="#cb42-2181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(land)<span class="op">;</span></span>
<span id="cb42-2182"><a href="#cb42-2182" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb42-2183"><a href="#cb42-2183" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb42-2184"><a href="#cb42-2184" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb42-2185"><a href="#cb42-2185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(countries)<span class="op">;</span></span>
<span id="cb42-2186"><a href="#cb42-2186" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="op">.</span><span class="dv">95</span><span class="op">;</span></span>
<span id="cb42-2187"><a href="#cb42-2187" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#aaa"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb42-2188"><a href="#cb42-2188" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb42-2189"><a href="#cb42-2189" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#fff"</span> <span class="op">:</span> <span class="st">"#000"</span><span class="op">;</span></span>
<span id="cb42-2190"><a href="#cb42-2190" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">font</span> <span class="op">=</span> width <span class="op">&lt;</span> <span class="dv">760</span> <span class="op">?</span> <span class="st">"14px serif"</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">990</span> <span class="op">?</span> <span class="st">"17px serif"</span> <span class="op">:</span> <span class="st">"23px serif"</span><span class="op">;</span></span>
<span id="cb42-2191"><a href="#cb42-2191" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="dv">82</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">8.8</span>])))<span class="op">;</span></span>
<span id="cb42-2192"><a href="#cb42-2192" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="op">-</span><span class="dv">66</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">1.1</span>])))<span class="op">;</span></span>
<span id="cb42-2193"><a href="#cb42-2193" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">,</span> <span class="fu">path</span>(night)<span class="op">,</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"rgba(0,0,255,0.1)"</span><span class="op">,</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb42-2194"><a href="#cb42-2194" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> sun})<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"#0008"</span><span class="op">;</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"#ff08"</span><span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb42-2195"><a href="#cb42-2195" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> lat <span class="op">!=</span> <span class="kw">null</span>) {</span>
<span id="cb42-2196"><a href="#cb42-2196" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">;</span></span>
<span id="cb42-2197"><a href="#cb42-2197" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb42-2198"><a href="#cb42-2198" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb42-2199"><a href="#cb42-2199" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">14</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">;</span></span>
<span id="cb42-2200"><a href="#cb42-2200" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb42-2201"><a href="#cb42-2201" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-2202"><a href="#cb42-2202" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-2203"><a href="#cb42-2203" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> drag <span class="op">=</span> d3<span class="op">.</span><span class="fu">drag</span>()</span>
<span id="cb42-2204"><a href="#cb42-2204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> (<span class="bu">event</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb42-2205"><a href="#cb42-2205" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([<span class="bu">event</span><span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb42-2206"><a href="#cb42-2206" aria-hidden="true" tabindex="-1"></a>      lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb42-2207"><a href="#cb42-2207" aria-hidden="true" tabindex="-1"></a>      lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb42-2208"><a href="#cb42-2208" aria-hidden="true" tabindex="-1"></a>      <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb42-2209"><a href="#cb42-2209" aria-hidden="true" tabindex="-1"></a>      canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb42-2210"><a href="#cb42-2210" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb42-2211"><a href="#cb42-2211" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(canvas)<span class="op">.</span><span class="fu">call</span>(drag)</span>
<span id="cb42-2212"><a href="#cb42-2212" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span>(ev) {</span>
<span id="cb42-2213"><a href="#cb42-2213" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> { offsetX<span class="op">,</span> offsetY } <span class="op">=</span> ev<span class="op">;</span></span>
<span id="cb42-2214"><a href="#cb42-2214" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([offsetX<span class="op">,</span> offsetY])<span class="op">;</span></span>
<span id="cb42-2215"><a href="#cb42-2215" aria-hidden="true" tabindex="-1"></a>    lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb42-2216"><a href="#cb42-2216" aria-hidden="true" tabindex="-1"></a>    lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb42-2217"><a href="#cb42-2217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb42-2218"><a href="#cb42-2218" aria-hidden="true" tabindex="-1"></a>    canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb42-2219"><a href="#cb42-2219" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb42-2220"><a href="#cb42-2220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb42-2221"><a href="#cb42-2221" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">input</span>({</span>
<span id="cb42-2222"><a href="#cb42-2222" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"worldMapCoordinates"</span><span class="op">,</span></span>
<span id="cb42-2223"><a href="#cb42-2223" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb42-2224"><a href="#cb42-2224" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb42-2225"><a href="#cb42-2225" aria-hidden="true" tabindex="-1"></a>    <span class="dt">display</span><span class="op">:</span> v <span class="kw">=&gt;</span> (width <span class="op">&gt;</span> <span class="dv">300</span>) <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;div style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px; white-space: nowrap; color: window.darkmode ? #fff : #000; text-align: center; font: </span><span class="sc">${</span>width <span class="op">/</span> <span class="dv">40</span><span class="sc">}</span><span class="vs">px monospace; position: relative; top: </span><span class="sc">${</span><span class="op">-</span><span class="dv">16</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span><span class="sc">}</span><span class="vs">px;  margin-bottom: -.4em;"&gt;</span></span>
<span id="cb42-2226"><a href="#cb42-2226" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Zone:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> <span class="fu">long2zone</span>(lon) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb42-2227"><a href="#cb42-2227" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb42-2228"><a href="#cb42-2228" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Longitude:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">long2turn</span>(lon))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb42-2229"><a href="#cb42-2229" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb42-2230"><a href="#cb42-2230" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Latitude:&lt;/span&gt; </span><span class="sc">${</span>lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">lati2turn</span>(lat))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb42-2231"><a href="#cb42-2231" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="op">,</span></span>
<span id="cb42-2232"><a href="#cb42-2232" aria-hidden="true" tabindex="-1"></a>    <span class="dt">getValue</span><span class="op">:</span> () <span class="kw">=&gt;</span> [lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span>]<span class="op">,</span></span>
<span id="cb42-2233"><a href="#cb42-2233" aria-hidden="true" tabindex="-1"></a>    <span class="dt">form</span><span class="op">:</span> formEl</span>
<span id="cb42-2234"><a href="#cb42-2234" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb42-2235"><a href="#cb42-2235" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb42-2236"><a href="#cb42-2236" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-2237"><a href="#cb42-2237" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-48" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-49" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-50" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-51" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-52" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-53" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-54" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-55" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-56" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-57" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-58" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-59" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-60" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-61" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-62" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-63" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-64" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-65" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-66" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-67" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-68" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-69" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-70" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-71" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-72" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-73" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-74" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb43" data-startfrom="2238" data-source-offset="-29302"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2237;"><span id="cb43-2238"><a href="#cb43-2238" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByClassName</span>(<span class="st">"quarto-color-scheme-toggle"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span> (e) {</span>
<span id="cb43-2239"><a href="#cb43-2239" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">quartoToggleColorScheme</span>()<span class="op">;</span></span>
<span id="cb43-2240"><a href="#cb43-2240" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb43-2241"><a href="#cb43-2241" aria-hidden="true" tabindex="-1"></a>  worldMapCoordinates<span class="op">.</span><span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb43-2242"><a href="#cb43-2242" aria-hidden="true" tabindex="-1"></a>  app<span class="op">.</span><span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb43-2243"><a href="#cb43-2243" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb43-2244"><a href="#cb43-2244" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-75" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code hidden" id="cb44" data-startfrom="2245" data-source-offset="-29604"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2244;"><span id="cb44-2245"><a href="#cb44-2245" aria-hidden="true" tabindex="-1"></a>sun <span class="op">=</span> {</span>
<span id="cb44-2246"><a href="#cb44-2246" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> now <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span><span class="op">;</span></span>
<span id="cb44-2247"><a href="#cb44-2247" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> day <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="op">+</span>now)<span class="op">.</span><span class="fu">setUTCHours</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb44-2248"><a href="#cb44-2248" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> t <span class="op">=</span> solar<span class="op">.</span><span class="fu">century</span>(now)<span class="op">;</span></span>
<span id="cb44-2249"><a href="#cb44-2249" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> longitude <span class="op">=</span> (day <span class="op">-</span> now) <span class="op">/</span> <span class="fl">864e5</span> <span class="op">*</span> <span class="dv">360</span> <span class="op">-</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb44-2250"><a href="#cb44-2250" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [longitude <span class="op">-</span> solar<span class="op">.</span><span class="fu">equationOfTime</span>(t) <span class="op">/</span> <span class="dv">4</span><span class="op">,</span> solar<span class="op">.</span><span class="fu">declination</span>(t)]<span class="op">;</span></span>
<span id="cb44-2251"><a href="#cb44-2251" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2252"><a href="#cb44-2252" aria-hidden="true" tabindex="-1"></a>night <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoCircle</span>()</span>
<span id="cb44-2253"><a href="#cb44-2253" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">radius</span>(<span class="dv">90</span>)</span>
<span id="cb44-2254"><a href="#cb44-2254" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">center</span>(<span class="fu">antipode</span>(sun))</span>
<span id="cb44-2255"><a href="#cb44-2255" aria-hidden="true" tabindex="-1"></a>  ()</span>
<span id="cb44-2256"><a href="#cb44-2256" aria-hidden="true" tabindex="-1"></a>antipode <span class="op">=</span> ([longitude<span class="op">,</span> latitude]) <span class="kw">=&gt;</span> [longitude <span class="op">+</span> <span class="dv">180</span><span class="op">,</span> <span class="op">-</span>latitude]</span>
<span id="cb44-2257"><a href="#cb44-2257" aria-hidden="true" tabindex="-1"></a>solar <span class="op">=</span> <span class="pp">require</span>(<span class="st">"solar-calculator@0.3/dist/solar-calculator.min.js"</span>)</span>
<span id="cb44-2258"><a href="#cb44-2258" aria-hidden="true" tabindex="-1"></a>viewof fancySecondsOFF <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({</span>
<span id="cb44-2259"><a href="#cb44-2259" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Ticking clock"</span><span class="op">,</span></span>
<span id="cb44-2260"><a href="#cb44-2260" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb44-2261"><a href="#cb44-2261" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-2262"><a href="#cb44-2262" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setStyle</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb44-2263"><a href="#cb44-2263" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb44-2264"><a href="#cb44-2264" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb44-2265"><a href="#cb44-2265" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb44-2266"><a href="#cb44-2266" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-2267"><a href="#cb44-2267" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb44-2268"><a href="#cb44-2268" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb44-2269"><a href="#cb44-2269" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;=</span> <span class="fl">0.6</span> <span class="op">?</span> <span class="st">"#111"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb44-2270"><a href="#cb44-2270" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 1px"</span><span class="op">,</span></span>
<span id="cb44-2271"><a href="#cb44-2271" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb44-2272"><a href="#cb44-2272" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb44-2273"><a href="#cb44-2273" aria-hidden="true" tabindex="-1"></a>    fontSize <span class="op">=</span> <span class="st">"1em"</span><span class="op">,</span></span>
<span id="cb44-2274"><a href="#cb44-2274" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb44-2275"><a href="#cb44-2275" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb44-2276"><a href="#cb44-2276" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb44-2277"><a href="#cb44-2277" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb44-2278"><a href="#cb44-2278" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb44-2279"><a href="#cb44-2279" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb44-2280"><a href="#cb44-2280" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb44-2281"><a href="#cb44-2281" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb44-2282"><a href="#cb44-2282" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb44-2283"><a href="#cb44-2283" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb44-2284"><a href="#cb44-2284" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2285"><a href="#cb44-2285" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb44-2286"><a href="#cb44-2286" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb44-2287"><a href="#cb44-2287" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb44-2288"><a href="#cb44-2288" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2289"><a href="#cb44-2289" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">textcolor</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb44-2290"><a href="#cb44-2290" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb44-2291"><a href="#cb44-2291" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb44-2292"><a href="#cb44-2292" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"#000"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb44-2293"><a href="#cb44-2293" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 5px"</span><span class="op">,</span></span>
<span id="cb44-2294"><a href="#cb44-2294" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb44-2295"><a href="#cb44-2295" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb44-2296"><a href="#cb44-2296" aria-hidden="true" tabindex="-1"></a>    fontFamily <span class="op">=</span> <span class="st">"monospace"</span><span class="op">,</span></span>
<span id="cb44-2297"><a href="#cb44-2297" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb44-2298"><a href="#cb44-2298" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb44-2299"><a href="#cb44-2299" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb44-2300"><a href="#cb44-2300" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb44-2301"><a href="#cb44-2301" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb44-2302"><a href="#cb44-2302" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb44-2303"><a href="#cb44-2303" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb44-2304"><a href="#cb44-2304" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb44-2305"><a href="#cb44-2305" aria-hidden="true" tabindex="-1"></a>    fontFamily<span class="op">,</span></span>
<span id="cb44-2306"><a href="#cb44-2306" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb44-2307"><a href="#cb44-2307" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb44-2308"><a href="#cb44-2308" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2309"><a href="#cb44-2309" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">isLeapYear</span>(y) {</span>
<span id="cb44-2310"><a href="#cb44-2310" aria-hidden="true" tabindex="-1"></a>  y <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb44-2311"><a href="#cb44-2311" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> y <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> y <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> y <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb44-2312"><a href="#cb44-2312" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2313"><a href="#cb44-2313" aria-hidden="true" tabindex="-1"></a>elapsed <span class="op">=</span> {</span>
<span id="cb44-2314"><a href="#cb44-2314" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb44-2315"><a href="#cb44-2315" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb44-2316"><a href="#cb44-2316" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> Promises<span class="op">.</span><span class="fu">tick</span>(<span class="dv">864</span><span class="op">,</span> <span class="op">++</span>i)<span class="op">;</span></span>
<span id="cb44-2317"><a href="#cb44-2317" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-2318"><a href="#cb44-2318" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2319"><a href="#cb44-2319" aria-hidden="true" tabindex="-1"></a>piecewiseColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">piecewise</span>(d3<span class="op">.</span><span class="at">interpolateRgb</span><span class="op">,</span> [</span>
<span id="cb44-2320"><a href="#cb44-2320" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0   0 red</span></span>
<span id="cb44-2321"><a href="#cb44-2321" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f50"</span><span class="op">,</span>    <span class="co">//  0.25  20 yr</span></span>
<span id="cb44-2322"><a href="#cb44-2322" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f60"</span><span class="op">,</span>    <span class="co">//  0.5   24 yr orangered</span></span>
<span id="cb44-2323"><a href="#cb44-2323" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f70"</span><span class="op">,</span>    <span class="co">//  0.75  28 yr</span></span>
<span id="cb44-2324"><a href="#cb44-2324" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f90"</span><span class="op">,</span>    <span class="co">//  1     36 yr orange</span></span>
<span id="cb44-2325"><a href="#cb44-2325" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fb0"</span><span class="op">,</span>    <span class="co">//  1.25  44 yr</span></span>
<span id="cb44-2326"><a href="#cb44-2326" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fc0"</span><span class="op">,</span>    <span class="co">//  1.5   48 yr yelloworange</span></span>
<span id="cb44-2327"><a href="#cb44-2327" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fd0"</span><span class="op">,</span>    <span class="co">//  1.75  52 yr</span></span>
<span id="cb44-2328"><a href="#cb44-2328" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ff0"</span><span class="op">,</span>    <span class="co">//  2     60 yellow</span></span>
<span id="cb44-2329"><a href="#cb44-2329" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ef0"</span><span class="op">,</span>    <span class="co">//  2.25  64 gy</span></span>
<span id="cb44-2330"><a href="#cb44-2330" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#df0"</span><span class="op">,</span>    <span class="co">//  2.5   68 gy limeyellow</span></span>
<span id="cb44-2331"><a href="#cb44-2331" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#cf0"</span><span class="op">,</span>    <span class="co">//  2.75  72 gy</span></span>
<span id="cb44-2332"><a href="#cb44-2332" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#af0"</span><span class="op">,</span>    <span class="co">//  3     80 gy lime</span></span>
<span id="cb44-2333"><a href="#cb44-2333" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#8f0"</span><span class="op">,</span>    <span class="co">//  3.25  88 gy</span></span>
<span id="cb44-2334"><a href="#cb44-2334" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#7f0"</span><span class="op">,</span>    <span class="co">//  3.5   92 gy greenlime</span></span>
<span id="cb44-2335"><a href="#cb44-2335" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#6f0"</span><span class="op">,</span>    <span class="co">//  3.75  96 gy</span></span>
<span id="cb44-2336"><a href="#cb44-2336" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f0"</span><span class="op">,</span>    <span class="co">//  4    120 green</span></span>
<span id="cb44-2337"><a href="#cb44-2337" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f7"</span><span class="op">,</span>    <span class="co">//  4.25 148 cg</span></span>
<span id="cb44-2338"><a href="#cb44-2338" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f9"</span><span class="op">,</span>    <span class="co">//  4.5  156 cg cyangreen</span></span>
<span id="cb44-2339"><a href="#cb44-2339" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0fb"</span><span class="op">,</span>    <span class="co">//  4.75 164 cg</span></span>
<span id="cb44-2340"><a href="#cb44-2340" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0ff"</span><span class="op">,</span>    <span class="co">//  5    180 cyan</span></span>
<span id="cb44-2341"><a href="#cb44-2341" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0cf"</span><span class="op">,</span>    <span class="co">//  5.25 192 bc</span></span>
<span id="cb44-2342"><a href="#cb44-2342" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0bf"</span><span class="op">,</span>    <span class="co">//  5.5  196 bc azurecyan</span></span>
<span id="cb44-2343"><a href="#cb44-2343" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0af"</span><span class="op">,</span>    <span class="co">//  5.75 200 bc</span></span>
<span id="cb44-2344"><a href="#cb44-2344" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#08f"</span><span class="op">,</span>    <span class="co">//  6    208 bc azure</span></span>
<span id="cb44-2345"><a href="#cb44-2345" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#06f"</span><span class="op">,</span>    <span class="co">//  6.25 216 bc</span></span>
<span id="cb44-2346"><a href="#cb44-2346" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#05f"</span><span class="op">,</span>    <span class="co">//  6.5  220 bc blueazure</span></span>
<span id="cb44-2347"><a href="#cb44-2347" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#04f"</span><span class="op">,</span>    <span class="co">//  6.75 224 bc</span></span>
<span id="cb44-2348"><a href="#cb44-2348" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#00f"</span><span class="op">,</span>    <span class="co">//  7    240 blue</span></span>
<span id="cb44-2349"><a href="#cb44-2349" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#50f"</span><span class="op">,</span>    <span class="co">//  7.25 260 mb</span></span>
<span id="cb44-2350"><a href="#cb44-2350" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#60f"</span><span class="op">,</span>    <span class="co">//  7.5  264 mb purpleblue</span></span>
<span id="cb44-2351"><a href="#cb44-2351" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#70f"</span><span class="op">,</span>    <span class="co">//  7.75 268 mb</span></span>
<span id="cb44-2352"><a href="#cb44-2352" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#90f"</span><span class="op">,</span>    <span class="co">//  8    276 mb purple</span></span>
<span id="cb44-2353"><a href="#cb44-2353" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#b0f"</span><span class="op">,</span>    <span class="co">//  8.25 284 mb</span></span>
<span id="cb44-2354"><a href="#cb44-2354" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#c0f"</span><span class="op">,</span>    <span class="co">//  8.5  288 mb violetpurple</span></span>
<span id="cb44-2355"><a href="#cb44-2355" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#d0f"</span><span class="op">,</span>    <span class="co">//  8.75 292 mb</span></span>
<span id="cb44-2356"><a href="#cb44-2356" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0f"</span><span class="op">,</span>    <span class="co">//  9    300 magenta</span></span>
<span id="cb44-2357"><a href="#cb44-2357" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0a"</span><span class="op">,</span>    <span class="co">//  9.25 320 rm</span></span>
<span id="cb44-2358"><a href="#cb44-2358" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f08"</span><span class="op">,</span>    <span class="co">//  9.5  328 rm</span></span>
<span id="cb44-2359"><a href="#cb44-2359" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f06"</span><span class="op">,</span>    <span class="co">//  9.75 336 rm</span></span>
<span id="cb44-2360"><a href="#cb44-2360" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0        0 red</span></span>
<span id="cb44-2361"><a href="#cb44-2361" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb44-2362"><a href="#cb44-2362" aria-hidden="true" tabindex="-1"></a>slStr <span class="op">=</span> <span class="vs">`, 100%, 50%)`</span></span>
<span id="cb44-2363"><a href="#cb44-2363" aria-hidden="true" tabindex="-1"></a>elaTime <span class="op">=</span> elapsed <span class="op">%</span> <span class="fl">1e5</span></span>
<span id="cb44-2364"><a href="#cb44-2364" aria-hidden="true" tabindex="-1"></a>elaTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(elaTime<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(elaTime <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2365"><a href="#cb44-2365" aria-hidden="true" tabindex="-1"></a>decMoty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> decDate <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)</span>
<span id="cb44-2366"><a href="#cb44-2366" aria-hidden="true" tabindex="-1"></a>isoYear <span class="op">=</span> decYear <span class="op">+</span> (decMoty <span class="op">&gt;</span> <span class="dv">9</span>)</span>
<span id="cb44-2367"><a href="#cb44-2367" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> decMoty <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> decMoty <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> decMoty <span class="op">-</span> <span class="dv">9</span></span>
<span id="cb44-2368"><a href="#cb44-2368" aria-hidden="true" tabindex="-1"></a>decHour <span class="op">=</span> decTime <span class="op">*</span> <span class="dv">24</span></span>
<span id="cb44-2369"><a href="#cb44-2369" aria-hidden="true" tabindex="-1"></a>decMinute <span class="op">=</span> (decHour <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb44-2370"><a href="#cb44-2370" aria-hidden="true" tabindex="-1"></a>decSecond <span class="op">=</span> (decMinute <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb44-2371"><a href="#cb44-2371" aria-hidden="true" tabindex="-1"></a>isoHour <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decHour)</span>
<span id="cb44-2372"><a href="#cb44-2372" aria-hidden="true" tabindex="-1"></a>isoMinute <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decMinute)</span>
<span id="cb44-2373"><a href="#cb44-2373" aria-hidden="true" tabindex="-1"></a>isoSecond <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decSecond)</span>
<span id="cb44-2374"><a href="#cb44-2374" aria-hidden="true" tabindex="-1"></a>decDek <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">/</span> <span class="dv">10</span>)</span>
<span id="cb44-2375"><a href="#cb44-2375" aria-hidden="true" tabindex="-1"></a>decDod <span class="op">=</span> decDate <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb44-2376"><a href="#cb44-2376" aria-hidden="true" tabindex="-1"></a>decDotm <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">-</span> (<span class="dv">153</span> <span class="op">*</span> decMoty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb44-2377"><a href="#cb44-2377" aria-hidden="true" tabindex="-1"></a>selDote <span class="op">=</span> <span class="fu">unix2dote</span>(selectedDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> <span class="dv">86400000</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb44-2378"><a href="#cb44-2378" aria-hidden="true" tabindex="-1"></a>selDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">dote2date</span>(<span class="op">...</span>selDote)[<span class="dv">1</span>])</span>
<span id="cb44-2379"><a href="#cb44-2379" aria-hidden="true" tabindex="-1"></a>selTime <span class="op">=</span> selectedHour <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb44-2380"><a href="#cb44-2380" aria-hidden="true" tabindex="-1"></a>selTimeOne <span class="op">=</span> selTime <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb44-2381"><a href="#cb44-2381" aria-hidden="true" tabindex="-1"></a>selTimeTen <span class="op">=</span> selTime <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb44-2382"><a href="#cb44-2382" aria-hidden="true" tabindex="-1"></a>selSnap <span class="op">=</span> selDate <span class="op">+</span> selTime</span>
<span id="cb44-2383"><a href="#cb44-2383" aria-hidden="true" tabindex="-1"></a>selLati <span class="op">=</span> <span class="fu">lati2turn</span>(location[<span class="dv">1</span>])</span>
<span id="cb44-2384"><a href="#cb44-2384" aria-hidden="true" tabindex="-1"></a>decDodHsl <span class="op">=</span> <span class="fu">textcolor</span>(decDod<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decDod <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2385"><a href="#cb44-2385" aria-hidden="true" tabindex="-1"></a>decDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(decDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decDate <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> <span class="fu">isLeapYear</span>(decYear))))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2386"><a href="#cb44-2386" aria-hidden="true" tabindex="-1"></a>decTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(decTime<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decTime <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2387"><a href="#cb44-2387" aria-hidden="true" tabindex="-1"></a>selDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(selDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selDate <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2388"><a href="#cb44-2388" aria-hidden="true" tabindex="-1"></a>selLatiHsl <span class="op">=</span> <span class="fu">textcolor</span>(selLati<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>((selLati <span class="op">+</span> <span class="dv">250</span>) <span class="op">%</span> <span class="dv">250</span> <span class="op">/</span> <span class="dv">250</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2389"><a href="#cb44-2389" aria-hidden="true" tabindex="-1"></a>selTimeDay <span class="op">=</span> <span class="fu">textcolor</span>(selTimeOne<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2390"><a href="#cb44-2390" aria-hidden="true" tabindex="-1"></a>selTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2391"><a href="#cb44-2391" aria-hidden="true" tabindex="-1"></a>selTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2392"><a href="#cb44-2392" aria-hidden="true" tabindex="-1"></a>selZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2393"><a href="#cb44-2393" aria-hidden="true" tabindex="-1"></a>selSnapDay <span class="op">=</span> <span class="fu">textcolor</span>(selSnap<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">6</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2394"><a href="#cb44-2394" aria-hidden="true" tabindex="-1"></a>selSnapDec <span class="op">=</span> <span class="fu">textcolor</span>((selSnap <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">9</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2395"><a href="#cb44-2395" aria-hidden="true" tabindex="-1"></a>decZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2396"><a href="#cb44-2396" aria-hidden="true" tabindex="-1"></a>viewof selectedDate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022)</span>
<span id="cb44-2397"><a href="#cb44-2397" aria-hidden="true" tabindex="-1"></a>viewof selectedHour <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb44-2398"><a href="#cb44-2398" aria-hidden="true" tabindex="-1"></a>date2022 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getMonth</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getDate</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb44-2399"><a href="#cb44-2399" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">set</span>(input<span class="op">,</span> value) {</span>
<span id="cb44-2400"><a href="#cb44-2400" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb44-2401"><a href="#cb44-2401" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb44-2402"><a href="#cb44-2402" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2403"><a href="#cb44-2403" aria-hidden="true" tabindex="-1"></a>hD121 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">121</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb44-2404"><a href="#cb44-2404" aria-hidden="true" tabindex="-1"></a>hD268 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">268</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb44-2405"><a href="#cb44-2405" aria-hidden="true" tabindex="-1"></a>hD305 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">305</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb44-2406"><a href="#cb44-2406" aria-hidden="true" tabindex="-1"></a>hD306 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">306</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb44-2407"><a href="#cb44-2407" aria-hidden="true" tabindex="-1"></a>h1by320 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">1</span> <span class="op">/</span> <span class="dv">320</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb44-2408"><a href="#cb44-2408" aria-hidden="true" tabindex="-1"></a>h1by8640 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">1</span> <span class="op">/</span> <span class="dv">8640</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb44-2409"><a href="#cb44-2409" aria-hidden="true" tabindex="-1"></a>hues <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">fromEntries</span>([</span>
<span id="cb44-2410"><a href="#cb44-2410" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0083</span><span class="op">,</span></span>
<span id="cb44-2411"><a href="#cb44-2411" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0166</span><span class="op">,</span></span>
<span id="cb44-2412"><a href="#cb44-2412" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0229</span><span class="op">,</span></span>
<span id="cb44-2413"><a href="#cb44-2413" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">025</span><span class="op">,</span></span>
<span id="cb44-2414"><a href="#cb44-2414" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">287</span><span class="op">,</span></span>
<span id="cb44-2415"><a href="#cb44-2415" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0333</span><span class="op">,</span></span>
<span id="cb44-2416"><a href="#cb44-2416" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0416</span><span class="op">,</span></span>
<span id="cb44-2417"><a href="#cb44-2417" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">05</span><span class="op">,</span></span>
<span id="cb44-2418"><a href="#cb44-2418" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">125</span><span class="op">,</span></span>
<span id="cb44-2419"><a href="#cb44-2419" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">333</span><span class="op">,</span></span>
<span id="cb44-2420"><a href="#cb44-2420" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">375</span><span class="op">,</span></span>
<span id="cb44-2421"><a href="#cb44-2421" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">429</span><span class="op">,</span></span>
<span id="cb44-2422"><a href="#cb44-2422" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">533</span><span class="op">,</span></span>
<span id="cb44-2423"><a href="#cb44-2423" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">969</span><span class="op">,</span></span>
<span id="cb44-2424"><a href="#cb44-2424" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">999</span><span class="op">,</span></span>
<span id="cb44-2425"><a href="#cb44-2425" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> [i<span class="op">,</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(i))<span class="op">.</span><span class="at">h</span>])</span>
<span id="cb44-2426"><a href="#cb44-2426" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb44-2427"><a href="#cb44-2427" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb44-2428"><a href="#cb44-2428" aria-hidden="true" tabindex="-1"></a>populationByTimeZone <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"../../asset/populationByTimeZone.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb44-2429"><a href="#cb44-2429" aria-hidden="true" tabindex="-1"></a>sortedPop <span class="op">=</span> populationByTimeZone<span class="op">.</span><span class="fu">sort</span>(</span>
<span id="cb44-2430"><a href="#cb44-2430" aria-hidden="true" tabindex="-1"></a>  (a<span class="op">,</span> b) <span class="kw">=&gt;</span> sortParams[<span class="dv">1</span>] <span class="op">?</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">number</span><span class="op">,</span> b<span class="op">.</span><span class="at">number</span>) <span class="op">:</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">pop</span><span class="op">,</span> b<span class="op">.</span><span class="at">pop</span>)</span>
<span id="cb44-2431"><a href="#cb44-2431" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-2432"><a href="#cb44-2432" aria-hidden="true" tabindex="-1"></a>sortFunc <span class="op">=</span> sortParams[<span class="dv">0</span>] <span class="op">?</span> d3<span class="op">.</span><span class="at">ascending</span> <span class="op">:</span> d3<span class="op">.</span><span class="at">descending</span></span>
<span id="cb44-2433"><a href="#cb44-2433" aria-hidden="true" tabindex="-1"></a>popBySign <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(sortedPop<span class="op">,</span> v <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">sum</span>(v<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Sign</span>)</span>
<span id="cb44-2434"><a href="#cb44-2434" aria-hidden="true" tabindex="-1"></a>totalPop <span class="op">=</span> d3<span class="op">.</span><span class="fu">sum</span>(sortedPop<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)</span>
<span id="cb44-2435"><a href="#cb44-2435" aria-hidden="true" tabindex="-1"></a>dzOff <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> offset)</span>
<span id="cb44-2436"><a href="#cb44-2436" aria-hidden="true" tabindex="-1"></a>ydzOff <span class="op">=</span> <span class="fu">dote2date</span>(<span class="op">...</span>dzOff)</span>
<span id="cb44-2437"><a href="#cb44-2437" aria-hidden="true" tabindex="-1"></a>decTimeOff <span class="op">=</span> ydzOff[<span class="dv">1</span>] <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb44-2438"><a href="#cb44-2438" aria-hidden="true" tabindex="-1"></a>decSignOff <span class="op">=</span> offset <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"+"</span> <span class="op">:</span> <span class="st">"–"</span></span>
<span id="cb44-2439"><a href="#cb44-2439" aria-hidden="true" tabindex="-1"></a>decOffsetPosi <span class="op">=</span> (offset <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb44-2440"><a href="#cb44-2440" aria-hidden="true" tabindex="-1"></a>decOffsetNega <span class="op">=</span> decOffsetPosi <span class="op">-</span> <span class="dv">10</span></span>
<span id="cb44-2441"><a href="#cb44-2441" aria-hidden="true" tabindex="-1"></a>decOffsetHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(offset)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2442"><a href="#cb44-2442" aria-hidden="true" tabindex="-1"></a>decOffsetHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(offset)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2443"><a href="#cb44-2443" aria-hidden="true" tabindex="-1"></a>decOffsetHsl2 <span class="op">=</span> <span class="fu">textcolor</span>(offset<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2444"><a href="#cb44-2444" aria-hidden="true" tabindex="-1"></a>decOffsetHslP <span class="op">=</span> <span class="fu">textcolor</span>(decOffsetPosi<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2445"><a href="#cb44-2445" aria-hidden="true" tabindex="-1"></a>decOffsetHslN <span class="op">=</span> <span class="fu">textcolor</span>(decOffsetNega<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2446"><a href="#cb44-2446" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl0 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2447"><a href="#cb44-2447" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl1 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2448"><a href="#cb44-2448" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl2 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2449"><a href="#cb44-2449" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl3 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2450"><a href="#cb44-2450" aria-hidden="true" tabindex="-1"></a>decTimeOffLeapNum <span class="op">=</span> offset <span class="op">*</span> <span class="dv">320</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb44-2451"><a href="#cb44-2451" aria-hidden="true" tabindex="-1"></a>decTimeOffLeapTodHsl <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">320</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2452"><a href="#cb44-2452" aria-hidden="true" tabindex="-1"></a>decTimeOffLeapTzoHsl <span class="op">=</span> <span class="fu">textcolor</span>(<span class="vs">`</span><span class="sc">${</span>decTimeOffLeapNum<span class="sc">}</span><span class="vs">/320`</span><span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>((decTimeOffLeapNum <span class="op">/</span> <span class="dv">320</span> <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span> <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2453"><a href="#cb44-2453" aria-hidden="true" tabindex="-1"></a>utcOffsetM <span class="op">=</span> <span class="op">-</span>(<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>()</span>
<span id="cb44-2454"><a href="#cb44-2454" aria-hidden="true" tabindex="-1"></a>utcOffsetD <span class="op">=</span> utcOffsetM <span class="op">/</span> <span class="dv">144</span></span>
<span id="cb44-2455"><a href="#cb44-2455" aria-hidden="true" tabindex="-1"></a>utcOffsetP <span class="op">=</span> (utcOffsetD <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb44-2456"><a href="#cb44-2456" aria-hidden="true" tabindex="-1"></a>decZone <span class="op">=</span> ydz[<span class="dv">2</span>]</span>
<span id="cb44-2457"><a href="#cb44-2457" aria-hidden="true" tabindex="-1"></a>decZonePos <span class="op">=</span> (decZone <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb44-2458"><a href="#cb44-2458" aria-hidden="true" tabindex="-1"></a>utcOffDiff <span class="op">=</span> <span class="pp">parseFloat</span>((<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(utcOffsetD) <span class="op">-</span> utcOffsetD)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>))</span>
<span id="cb44-2459"><a href="#cb44-2459" aria-hidden="true" tabindex="-1"></a>utcOffHslM <span class="op">=</span> <span class="fu">textcolor</span>(utcOffsetM<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffsetP <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2460"><a href="#cb44-2460" aria-hidden="true" tabindex="-1"></a>utcOffHslD <span class="op">=</span> <span class="fu">textcolor</span>(<span class="pp">parseFloat</span>(utcOffsetD<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>))<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffsetP <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2461"><a href="#cb44-2461" aria-hidden="true" tabindex="-1"></a>decZonHslP <span class="op">=</span> <span class="fu">textcolor</span>(decZonePos<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decZonePos <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2462"><a href="#cb44-2462" aria-hidden="true" tabindex="-1"></a>utcOffsetMdiffHsl <span class="op">=</span> <span class="fu">textcolor</span>(<span class="pp">parseFloat</span>((utcOffDiff <span class="op">*</span> <span class="dv">144</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>))<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffDiff <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2463"><a href="#cb44-2463" aria-hidden="true" tabindex="-1"></a>utcOffDiffHsl <span class="op">=</span> <span class="fu">textcolor</span>(utcOffDiff<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffDiff <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb44-2464"><a href="#cb44-2464" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2dote</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb44-2465"><a href="#cb44-2465" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cote <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((year <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> year <span class="op">:</span> year <span class="op">-</span> <span class="dv">399</span>) <span class="op">/</span> <span class="dv">400</span>)<span class="op">,</span> yote <span class="op">=</span> year <span class="op">-</span> cote <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb44-2466"><a href="#cb44-2466" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [cote <span class="op">*</span> <span class="dv">146097</span> <span class="op">+</span> yote <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">4</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">100</span>) <span class="op">+</span> doty<span class="op">,</span> zone]</span>
<span id="cb44-2467"><a href="#cb44-2467" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2468"><a href="#cb44-2468" aria-hidden="true" tabindex="-1"></a>leapSecondDotes <span class="op">=</span> [</span>
<span id="cb44-2469"><a href="#cb44-2469" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1972</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2470"><a href="#cb44-2470" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1972</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2471"><a href="#cb44-2471" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1973</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2472"><a href="#cb44-2472" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1974</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2473"><a href="#cb44-2473" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1975</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2474"><a href="#cb44-2474" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1976</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2475"><a href="#cb44-2475" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1977</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2476"><a href="#cb44-2476" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1978</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2477"><a href="#cb44-2477" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1979</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2478"><a href="#cb44-2478" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1981</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2479"><a href="#cb44-2479" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1982</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2480"><a href="#cb44-2480" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1983</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2481"><a href="#cb44-2481" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1985</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2482"><a href="#cb44-2482" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1987</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2483"><a href="#cb44-2483" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1989</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2484"><a href="#cb44-2484" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1990</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2485"><a href="#cb44-2485" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1992</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2486"><a href="#cb44-2486" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1993</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2487"><a href="#cb44-2487" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1994</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2488"><a href="#cb44-2488" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1995</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2489"><a href="#cb44-2489" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1997</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2490"><a href="#cb44-2490" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1998</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2491"><a href="#cb44-2491" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2005</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2492"><a href="#cb44-2492" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2008</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2493"><a href="#cb44-2493" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2012</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2494"><a href="#cb44-2494" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2015</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb44-2495"><a href="#cb44-2495" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2016</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb44-2496"><a href="#cb44-2496" aria-hidden="true" tabindex="-1"></a>]<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> <span class="fu">date2dote</span>(<span class="op">...</span>x)[<span class="dv">0</span>])</span>
<span id="cb44-2497"><a href="#cb44-2497" aria-hidden="true" tabindex="-1"></a>leapSecondDote <span class="op">=</span> <span class="fu">date2dote</span>(leapSecondYear<span class="op">,</span> leapSecondDate)[<span class="dv">0</span>]</span>
<span id="cb44-2498"><a href="#cb44-2498" aria-hidden="true" tabindex="-1"></a>leapCount <span class="op">=</span> leapSecondDotes<span class="op">.</span><span class="fu">filter</span>(dote <span class="kw">=&gt;</span> leapSecondDote <span class="op">&gt;</span> dote)<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb44-2499"><a href="#cb44-2499" aria-hidden="true" tabindex="-1"></a>leapColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(leapCount <span class="op">/</span> <span class="dv">86400</span>))<span class="op">.</span><span class="fu">formatHex</span>()</span>
<span id="cb44-2500"><a href="#cb44-2500" aria-hidden="true" tabindex="-1"></a>leapCountHsl <span class="op">=</span> <span class="fu">textcolor</span>(leapCount<span class="op">,</span> leapColor)</span>
<span id="cb44-2501"><a href="#cb44-2501" aria-hidden="true" tabindex="-1"></a>frac <span class="op">=</span> <span class="pp">require</span>(<span class="st">"fraction.js"</span>)</span>
<span id="cb44-2502"><a href="#cb44-2502" aria-hidden="true" tabindex="-1"></a>leapFrac <span class="op">=</span> <span class="fu">frac</span>(leapCount)<span class="op">.</span><span class="fu">div</span>(<span class="dv">8640</span>)<span class="op">.</span><span class="fu">toFraction</span>()</span>
<span id="cb44-2503"><a href="#cb44-2503" aria-hidden="true" tabindex="-1"></a>leapTzoHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(leapFrac<span class="op">,</span> leapColor)</span>
<span id="cb44-2504"><a href="#cb44-2504" aria-hidden="true" tabindex="-1"></a>leapTzoHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(leapFrac<span class="op">,</span> leapColor)</span>
<span id="cb44-2505"><a href="#cb44-2505" aria-hidden="true" tabindex="-1"></a>leapTzoHsl2 <span class="op">=</span> <span class="fu">textcolor</span>(leapFrac<span class="op">,</span> leapColor)</span>
<span id="cb44-2506"><a href="#cb44-2506" aria-hidden="true" tabindex="-1"></a>hmsTzo <span class="op">=</span> <span class="fu">frac</span>(hmsinput[<span class="dv">0</span>])<span class="op">.</span><span class="fu">div</span>(<span class="dv">24</span>)<span class="op">.</span><span class="fu">add</span>(hmsinput[<span class="dv">1</span>]<span class="op">,</span> <span class="dv">1440</span>)<span class="op">.</span><span class="fu">add</span>(hmsinput[<span class="dv">2</span>]<span class="op">,</span> <span class="dv">86400</span>)<span class="op">.</span><span class="fu">mod</span>(<span class="dv">1</span>)</span>
<span id="cb44-2507"><a href="#cb44-2507" aria-hidden="true" tabindex="-1"></a>hmsTzox10 <span class="op">=</span> hmsTzo<span class="op">.</span><span class="fu">mul</span>(<span class="dv">10</span>)</span>
<span id="cb44-2508"><a href="#cb44-2508" aria-hidden="true" tabindex="-1"></a>pluralx10 <span class="op">=</span> hmsTzox10<span class="op">.</span><span class="fu">equals</span>(<span class="dv">1</span>) <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="st">"s"</span></span>
<span id="cb44-2509"><a href="#cb44-2509" aria-hidden="true" tabindex="-1"></a>hmsRounded <span class="op">=</span> hmsTzox10<span class="op">.</span><span class="fu">round</span>(digits <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb44-2510"><a href="#cb44-2510" aria-hidden="true" tabindex="-1"></a>hmsRef <span class="op">=</span> hmsRounded<span class="op">.</span><span class="fu">sub</span>(hmsTzox10)</span>
<span id="cb44-2511"><a href="#cb44-2511" aria-hidden="true" tabindex="-1"></a>hmsRefHsl <span class="op">=</span> <span class="fu">textcolor</span>(hmsRef<span class="op">.</span><span class="fu">abs</span>()<span class="op">.</span><span class="fu">toFraction</span>()<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(<span class="bu">Number</span>(hmsRef<span class="op">.</span><span class="fu">div</span>(<span class="dv">10</span>))))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2512"><a href="#cb44-2512" aria-hidden="true" tabindex="-1"></a>hmsRefSign <span class="op">=</span> hmsRef<span class="op">.</span><span class="fu">lt</span>(<span class="dv">0</span>) <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb44-2513"><a href="#cb44-2513" aria-hidden="true" tabindex="-1"></a>hmsTzoHsl <span class="op">=</span> <span class="fu">textcolor</span>(hmsTzox10<span class="op">.</span><span class="fu">toFraction</span>()<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(<span class="bu">Number</span>(hmsTzo)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2514"><a href="#cb44-2514" aria-hidden="true" tabindex="-1"></a>hmsRodHsl <span class="op">=</span> <span class="fu">textcolor</span>(hmsRounded<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(<span class="bu">Number</span>(hmsRounded<span class="op">.</span><span class="fu">div</span>(<span class="dv">10</span>))))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2515"><a href="#cb44-2515" aria-hidden="true" tabindex="-1"></a>hmsTod <span class="op">=</span> (zeroTime <span class="op">+</span> hmsTzo) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb44-2516"><a href="#cb44-2516" aria-hidden="true" tabindex="-1"></a>hmsTodHsl <span class="op">=</span> <span class="fu">textcolor</span>((hmsTod <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(hmsTod))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2517"><a href="#cb44-2517" aria-hidden="true" tabindex="-1"></a>leapTod <span class="op">=</span> (zeroTime <span class="op">+</span> leapCount <span class="op">/</span> <span class="dv">86400</span>) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb44-2518"><a href="#cb44-2518" aria-hidden="true" tabindex="-1"></a>leapDecidayTod <span class="op">=</span> (leapTod <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb44-2519"><a href="#cb44-2519" aria-hidden="true" tabindex="-1"></a>leapTodHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(leapDecidayTod<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(leapTod))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2520"><a href="#cb44-2520" aria-hidden="true" tabindex="-1"></a>leapTodHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(leapDecidayTod<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(leapTod))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2521"><a href="#cb44-2521" aria-hidden="true" tabindex="-1"></a>longInputHsl <span class="op">=</span> <span class="fu">textcolor</span>(longInput<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(longInput <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2522"><a href="#cb44-2522" aria-hidden="true" tabindex="-1"></a>eot <span class="op">=</span> <span class="fu">getEot</span>(leapSecondDate)</span>
<span id="cb44-2523"><a href="#cb44-2523" aria-hidden="true" tabindex="-1"></a>astTzo <span class="op">=</span> eot <span class="op">+</span> longInput</span>
<span id="cb44-2524"><a href="#cb44-2524" aria-hidden="true" tabindex="-1"></a>astTzoHsl <span class="op">=</span> <span class="fu">textcolor</span>(astTzo<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(astTzo <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2525"><a href="#cb44-2525" aria-hidden="true" tabindex="-1"></a>solarNoon <span class="op">=</span> (<span class="dv">5</span> <span class="op">-</span> astTzo <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb44-2526"><a href="#cb44-2526" aria-hidden="true" tabindex="-1"></a>solarNoonHsl <span class="op">=</span> <span class="fu">textcolor</span>(solarNoon<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(solarNoon <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2527"><a href="#cb44-2527" aria-hidden="true" tabindex="-1"></a>solarDiff <span class="op">=</span> zeroTime <span class="op">-</span> solarNoon</span>
<span id="cb44-2528"><a href="#cb44-2528" aria-hidden="true" tabindex="-1"></a>solarSign <span class="op">=</span> solarDiff <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb44-2529"><a href="#cb44-2529" aria-hidden="true" tabindex="-1"></a>solarDiffHsl <span class="op">=</span> <span class="fu">textcolor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(solarDiff)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>((solarDiff <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span> <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2530"><a href="#cb44-2530" aria-hidden="true" tabindex="-1"></a>eotHsl <span class="op">=</span> <span class="fu">textcolor</span>(eot<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(eot <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2531"><a href="#cb44-2531" aria-hidden="true" tabindex="-1"></a>eotSum <span class="op">=</span> (zeroTime <span class="op">+</span> astTzo <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb44-2532"><a href="#cb44-2532" aria-hidden="true" tabindex="-1"></a>eotSumHsl <span class="op">=</span> <span class="fu">textcolor</span>(eotSum<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(eotSum <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb44-2533"><a href="#cb44-2533" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mcmcclur/adaptive-plotter</span></span>
<span id="cb44-2534"><a href="#cb44-2534" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">build_samples</span>(f<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> opts <span class="op">=</span> {}) {</span>
<span id="cb44-2535"><a href="#cb44-2535" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> { N <span class="op">=</span> <span class="dv">9</span><span class="op">,</span> max_depth <span class="op">=</span> <span class="dv">6</span> } <span class="op">=</span> opts<span class="op">;</span></span>
<span id="cb44-2536"><a href="#cb44-2536" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dx <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> N<span class="op">;</span></span>
<span id="cb44-2537"><a href="#cb44-2537" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> root_intervals <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({ <span class="dt">length</span><span class="op">:</span> N })<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb44-2538"><a href="#cb44-2538" aria-hidden="true" tabindex="-1"></a>    (_<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="fu">Interval</span>(a <span class="op">+</span> i <span class="op">*</span> dx<span class="op">,</span> a <span class="op">+</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> dx<span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb44-2539"><a href="#cb44-2539" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb44-2540"><a href="#cb44-2540" aria-hidden="true" tabindex="-1"></a>  root_intervals<span class="op">.</span><span class="fu">forEach</span>((I) <span class="kw">=&gt;</span> {</span>
<span id="cb44-2541"><a href="#cb44-2541" aria-hidden="true" tabindex="-1"></a>    I<span class="op">.</span><span class="at">fa</span> <span class="op">=</span> <span class="fu">f</span>(I<span class="op">.</span><span class="at">a</span>)<span class="op">;</span></span>
<span id="cb44-2542"><a href="#cb44-2542" aria-hidden="true" tabindex="-1"></a>    I<span class="op">.</span><span class="at">fb</span> <span class="op">=</span> <span class="fu">f</span>(I<span class="op">.</span><span class="at">b</span>)<span class="op">;</span></span>
<span id="cb44-2543"><a href="#cb44-2543" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb44-2544"><a href="#cb44-2544" aria-hidden="true" tabindex="-1"></a>  root_intervals<span class="op">.</span><span class="fu">reverse</span>()<span class="op">;</span></span>
<span id="cb44-2545"><a href="#cb44-2545" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> stack <span class="op">=</span> root_intervals<span class="op">;</span></span>
<span id="cb44-2546"><a href="#cb44-2546" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb44-2547"><a href="#cb44-2547" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> pts <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb44-2548"><a href="#cb44-2548" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> nodeRight<span class="op">,</span> nodeLeft<span class="op">;</span></span>
<span id="cb44-2549"><a href="#cb44-2549" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (stack<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> cnt<span class="op">++</span> <span class="op">&lt;</span> <span class="dv">100000</span>) {</span>
<span id="cb44-2550"><a href="#cb44-2550" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> node <span class="op">=</span> stack<span class="op">.</span><span class="fu">pop</span>()<span class="op">;</span></span>
<span id="cb44-2551"><a href="#cb44-2551" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">test</span>(f<span class="op">,</span> node<span class="op">,</span> opts)) {</span>
<span id="cb44-2552"><a href="#cb44-2552" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> midpoint <span class="op">=</span> node<span class="op">.</span><span class="at">midpoint</span><span class="op">;</span></span>
<span id="cb44-2553"><a href="#cb44-2553" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> new_depth <span class="op">=</span> node<span class="op">.</span><span class="at">depth</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb44-2554"><a href="#cb44-2554" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (new_depth <span class="op">&lt;=</span> max_depth) {</span>
<span id="cb44-2555"><a href="#cb44-2555" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> a_left <span class="op">=</span> node<span class="op">.</span><span class="at">a</span><span class="op">;</span></span>
<span id="cb44-2556"><a href="#cb44-2556" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> b_left <span class="op">=</span> midpoint<span class="op">;</span></span>
<span id="cb44-2557"><a href="#cb44-2557" aria-hidden="true" tabindex="-1"></a>        nodeLeft <span class="op">=</span> <span class="kw">new</span> <span class="fu">Interval</span>(a_left<span class="op">,</span> b_left<span class="op">,</span> new_depth)<span class="op">;</span></span>
<span id="cb44-2558"><a href="#cb44-2558" aria-hidden="true" tabindex="-1"></a>        nodeLeft<span class="op">.</span><span class="at">fa</span> <span class="op">=</span> <span class="fu">f</span>(a_left)<span class="op">;</span></span>
<span id="cb44-2559"><a href="#cb44-2559" aria-hidden="true" tabindex="-1"></a>        nodeLeft<span class="op">.</span><span class="at">fb</span> <span class="op">=</span> <span class="fu">f</span>(b_left)<span class="op">;</span></span>
<span id="cb44-2560"><a href="#cb44-2560" aria-hidden="true" tabindex="-1"></a>        node<span class="op">.</span><span class="at">left</span> <span class="op">=</span> nodeLeft<span class="op">;</span></span>
<span id="cb44-2561"><a href="#cb44-2561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2562"><a href="#cb44-2562" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> a_right <span class="op">=</span> midpoint<span class="op">;</span></span>
<span id="cb44-2563"><a href="#cb44-2563" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> b_right <span class="op">=</span> node<span class="op">.</span><span class="at">b</span><span class="op">;</span></span>
<span id="cb44-2564"><a href="#cb44-2564" aria-hidden="true" tabindex="-1"></a>        nodeRight <span class="op">=</span> <span class="kw">new</span> <span class="fu">Interval</span>(a_right<span class="op">,</span> b_right<span class="op">,</span> new_depth)<span class="op">;</span></span>
<span id="cb44-2565"><a href="#cb44-2565" aria-hidden="true" tabindex="-1"></a>        nodeRight<span class="op">.</span><span class="at">fa</span> <span class="op">=</span> <span class="fu">f</span>(a_left)<span class="op">;</span></span>
<span id="cb44-2566"><a href="#cb44-2566" aria-hidden="true" tabindex="-1"></a>        nodeRight<span class="op">.</span><span class="at">fb</span> <span class="op">=</span> <span class="fu">f</span>(b_left)<span class="op">;</span></span>
<span id="cb44-2567"><a href="#cb44-2567" aria-hidden="true" tabindex="-1"></a>        node<span class="op">.</span><span class="at">right</span> <span class="op">=</span> nodeRight<span class="op">;</span></span>
<span id="cb44-2568"><a href="#cb44-2568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-2569"><a href="#cb44-2569" aria-hidden="true" tabindex="-1"></a>        stack<span class="op">.</span><span class="fu">push</span>(nodeRight)<span class="op">;</span></span>
<span id="cb44-2570"><a href="#cb44-2570" aria-hidden="true" tabindex="-1"></a>        stack<span class="op">.</span><span class="fu">push</span>(nodeLeft)<span class="op">;</span></span>
<span id="cb44-2571"><a href="#cb44-2571" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb44-2572"><a href="#cb44-2572" aria-hidden="true" tabindex="-1"></a>        pts<span class="op">.</span><span class="fu">push</span>(node<span class="op">.</span><span class="at">a</span>)<span class="op">;</span></span>
<span id="cb44-2573"><a href="#cb44-2573" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb44-2574"><a href="#cb44-2574" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb44-2575"><a href="#cb44-2575" aria-hidden="true" tabindex="-1"></a>      pts<span class="op">.</span><span class="fu">push</span>(node<span class="op">.</span><span class="at">a</span>)<span class="op">;</span></span>
<span id="cb44-2576"><a href="#cb44-2576" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-2577"><a href="#cb44-2577" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-2578"><a href="#cb44-2578" aria-hidden="true" tabindex="-1"></a>  pts<span class="op">.</span><span class="fu">push</span>(b)<span class="op">;</span></span>
<span id="cb44-2579"><a href="#cb44-2579" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  pts = pts.map(x =&gt; ({ x: x, y: f(x) }));</span></span>
<span id="cb44-2580"><a href="#cb44-2580" aria-hidden="true" tabindex="-1"></a>  pts <span class="op">=</span> pts<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> [x<span class="op">,</span> <span class="fu">f</span>(x)])<span class="op">;</span></span>
<span id="cb44-2581"><a href="#cb44-2581" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (opts<span class="op">.</span><span class="at">show_roots</span>) {</span>
<span id="cb44-2582"><a href="#cb44-2582" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> function_roots <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb44-2583"><a href="#cb44-2583" aria-hidden="true" tabindex="-1"></a>    pts<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span> (o<span class="op">,</span> i) {</span>
<span id="cb44-2584"><a href="#cb44-2584" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="op">&lt;</span> pts<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(o<span class="op">.</span><span class="at">y</span>) <span class="op">!=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(pts[i <span class="op">+</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">y</span>)) {</span>
<span id="cb44-2585"><a href="#cb44-2585" aria-hidden="true" tabindex="-1"></a>        function_roots<span class="op">.</span><span class="fu">push</span>((o<span class="op">.</span><span class="at">x</span> <span class="op">+</span> pts[i <span class="op">+</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">x</span>) <span class="op">/</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb44-2586"><a href="#cb44-2586" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb44-2587"><a href="#cb44-2587" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb44-2588"><a href="#cb44-2588" aria-hidden="true" tabindex="-1"></a>    pts<span class="op">.</span><span class="at">function_roots</span> <span class="op">=</span> function_roots<span class="op">;</span></span>
<span id="cb44-2589"><a href="#cb44-2589" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-2590"><a href="#cb44-2590" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> pts<span class="op">;</span></span>
<span id="cb44-2591"><a href="#cb44-2591" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2592"><a href="#cb44-2592" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">test</span>(f<span class="op">,</span> I<span class="op">,</span> opts <span class="op">=</span> {}) {</span>
<span id="cb44-2593"><a href="#cb44-2593" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> { angle_tolerance <span class="op">=</span> <span class="fl">0.01</span><span class="op">,</span> check_roots <span class="op">=</span> <span class="kw">false</span> } <span class="op">=</span> opts<span class="op">;</span></span>
<span id="cb44-2594"><a href="#cb44-2594" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a <span class="op">=</span> I<span class="op">.</span><span class="at">a</span><span class="op">;</span></span>
<span id="cb44-2595"><a href="#cb44-2595" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> b <span class="op">=</span> I<span class="op">.</span><span class="at">b</span><span class="op">;</span></span>
<span id="cb44-2596"><a href="#cb44-2596" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dx2 <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb44-2597"><a href="#cb44-2597" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> m <span class="op">=</span> (a <span class="op">+</span> b) <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb44-2598"><a href="#cb44-2598" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> fm <span class="op">=</span> <span class="fu">f</span>(m)<span class="op">;</span></span>
<span id="cb44-2599"><a href="#cb44-2599" aria-hidden="true" tabindex="-1"></a>  I<span class="op">.</span><span class="at">midpoint</span> <span class="op">=</span> m<span class="op">;</span></span>
<span id="cb44-2600"><a href="#cb44-2600" aria-hidden="true" tabindex="-1"></a>  I<span class="op">.</span><span class="at">f_mid</span> <span class="op">=</span> fm<span class="op">;</span></span>
<span id="cb44-2601"><a href="#cb44-2601" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (check_roots <span class="op">&amp;&amp;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(I<span class="op">.</span><span class="at">fa</span>) <span class="op">!=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(I<span class="op">.</span><span class="at">fb</span>)) {</span>
<span id="cb44-2602"><a href="#cb44-2602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb44-2603"><a href="#cb44-2603" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-2604"><a href="#cb44-2604" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> alpha <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>((I<span class="op">.</span><span class="at">f_mid</span> <span class="op">-</span> I<span class="op">.</span><span class="at">fa</span>) <span class="op">/</span> dx2)<span class="op">;</span></span>
<span id="cb44-2605"><a href="#cb44-2605" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> beta <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>((I<span class="op">.</span><span class="at">fb</span> <span class="op">-</span> I<span class="op">.</span><span class="at">f_mid</span>) <span class="op">/</span> dx2)<span class="op">;</span></span>
<span id="cb44-2606"><a href="#cb44-2606" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(alpha <span class="op">-</span> beta) <span class="op">&gt;</span> angle_tolerance<span class="op">;</span></span>
<span id="cb44-2607"><a href="#cb44-2607" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-2608"><a href="#cb44-2608" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Interval {</span>
<span id="cb44-2609"><a href="#cb44-2609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(a<span class="op">,</span> b<span class="op">,</span> depth) {</span>
<span id="cb44-2610"><a href="#cb44-2610" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">a</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb44-2611"><a href="#cb44-2611" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">b</span> <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb44-2612"><a href="#cb44-2612" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">depth</span> <span class="op">=</span> depth<span class="op">;</span></span>
<span id="cb44-2613"><a href="#cb44-2613" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-2614"><a href="#cb44-2614" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-76" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-77" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-78" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-79" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-80" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-81" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-82" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-83" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-84" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-85" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-86" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-87" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-88" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-89" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-90" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-91" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-92" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-93" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-94" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-95" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-96" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-97" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-98" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-99" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-100" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-101" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-102" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-103" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-104" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-105" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-106" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-107" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-108" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-109" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-110" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-111" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-112" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-113" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-114" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-115" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-116" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-117" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-118" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-119" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-120" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-121" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-122" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-123" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-124" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-125" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-126" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-127" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-128" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-129" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-130" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-131" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-132" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-133" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-134" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-135" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-136" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-137" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-138" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-139" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-140" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-141" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-142" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-143" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-144" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-145" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-146" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-147" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-148" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-149" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-150" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-151" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-152" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-153" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-154" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-155" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-156" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-157" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-158" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-159" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-160" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-161" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-162" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-163" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-164" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-165" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-166" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-167" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-168" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-169" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-170" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-171" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-172" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-173" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-174" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-175" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-176" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-177" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-178" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-179" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-180" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-181" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-182" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-183" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-184" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-185" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-186" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-187" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-188" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-189" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-190" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-191" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-192" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-193" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-194" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-195" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-196" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-197" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-198" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-199" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-200" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-201" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-202" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-203" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-204" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-205" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-15-206" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell hidden">
<div class="sourceCode cell-code hidden" id="cb45" data-startfrom="2619" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2618;"><span id="cb45-2619"><a href="#cb45-2619" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb45-2620"><a href="#cb45-2620" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb45-2621"><a href="#cb45-2621" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorNight {</span></span>
<span id="cb45-2622"><a href="#cb45-2622" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #416f86;</span></span>
<span id="cb45-2623"><a href="#cb45-2623" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: white;</span></span>
<span id="cb45-2624"><a href="#cb45-2624" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 2px 0px 4px;</span></span>
<span id="cb45-2625"><a href="#cb45-2625" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2626"><a href="#cb45-2626" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2627"><a href="#cb45-2627" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2628"><a href="#cb45-2628" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2629"><a href="#cb45-2629" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorDay {</span></span>
<span id="cb45-2630"><a href="#cb45-2630" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #ffe438;</span></span>
<span id="cb45-2631"><a href="#cb45-2631" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: black;</span></span>
<span id="cb45-2632"><a href="#cb45-2632" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 3px 0px 4px;</span></span>
<span id="cb45-2633"><a href="#cb45-2633" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2634"><a href="#cb45-2634" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2635"><a href="#cb45-2635" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2636"><a href="#cb45-2636" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2637"><a href="#cb45-2637" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorBkg {</span></span>
<span id="cb45-2638"><a href="#cb45-2638" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2639"><a href="#cb45-2639" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"white"</span> <span class="op">:</span> <span class="st">"black"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2640"><a href="#cb45-2640" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2641"><a href="#cb45-2641" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2642"><a href="#cb45-2642" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2643"><a href="#cb45-2643" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2644"><a href="#cb45-2644" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2645"><a href="#cb45-2645" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0 {</span></span>
<span id="cb45-2646"><a href="#cb45-2646" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(0 100% 50%);</span></span>
<span id="cb45-2647"><a href="#cb45-2647" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(0, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2648"><a href="#cb45-2648" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2649"><a href="#cb45-2649" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2650"><a href="#cb45-2650" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2651"><a href="#cb45-2651" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2652"><a href="#cb45-2652" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2653"><a href="#cb45-2653" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1by8640 {</span></span>
<span id="cb45-2654"><a href="#cb45-2654" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>h1by8640<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2655"><a href="#cb45-2655" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>h1by8640<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2656"><a href="#cb45-2656" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2657"><a href="#cb45-2657" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2658"><a href="#cb45-2658" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2659"><a href="#cb45-2659" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2660"><a href="#cb45-2660" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2661"><a href="#cb45-2661" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1 {</span></span>
<span id="cb45-2662"><a href="#cb45-2662" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(300 100% 50%);</span></span>
<span id="cb45-2663"><a href="#cb45-2663" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(300, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2664"><a href="#cb45-2664" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2665"><a href="#cb45-2665" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2666"><a href="#cb45-2666" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2667"><a href="#cb45-2667" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2668"><a href="#cb45-2668" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2669"><a href="#cb45-2669" aria-hidden="true" tabindex="-1"></a><span class="vs">.color2 {</span></span>
<span id="cb45-2670"><a href="#cb45-2670" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(280 100% 50%);</span></span>
<span id="cb45-2671"><a href="#cb45-2671" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(280, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2672"><a href="#cb45-2672" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2673"><a href="#cb45-2673" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2674"><a href="#cb45-2674" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2675"><a href="#cb45-2675" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2676"><a href="#cb45-2676" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2677"><a href="#cb45-2677" aria-hidden="true" tabindex="-1"></a><span class="vs">.color3 {</span></span>
<span id="cb45-2678"><a href="#cb45-2678" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(240 100% 50%);</span></span>
<span id="cb45-2679"><a href="#cb45-2679" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(240, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2680"><a href="#cb45-2680" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2681"><a href="#cb45-2681" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2682"><a href="#cb45-2682" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2683"><a href="#cb45-2683" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2684"><a href="#cb45-2684" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2685"><a href="#cb45-2685" aria-hidden="true" tabindex="-1"></a><span class="vs">.color4 {</span></span>
<span id="cb45-2686"><a href="#cb45-2686" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(200 100% 50%);</span></span>
<span id="cb45-2687"><a href="#cb45-2687" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(200, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2688"><a href="#cb45-2688" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2689"><a href="#cb45-2689" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2690"><a href="#cb45-2690" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2691"><a href="#cb45-2691" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2692"><a href="#cb45-2692" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2693"><a href="#cb45-2693" aria-hidden="true" tabindex="-1"></a><span class="vs">.color5 {</span></span>
<span id="cb45-2694"><a href="#cb45-2694" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(180 100% 50%);</span></span>
<span id="cb45-2695"><a href="#cb45-2695" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(180, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2696"><a href="#cb45-2696" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2697"><a href="#cb45-2697" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2698"><a href="#cb45-2698" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2699"><a href="#cb45-2699" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2700"><a href="#cb45-2700" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2701"><a href="#cb45-2701" aria-hidden="true" tabindex="-1"></a><span class="vs">.color583 {</span></span>
<span id="cb45-2702"><a href="#cb45-2702" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(129.88235294117646 100% 50%);</span></span>
<span id="cb45-2703"><a href="#cb45-2703" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(129.88235294117646, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2704"><a href="#cb45-2704" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2705"><a href="#cb45-2705" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2706"><a href="#cb45-2706" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2707"><a href="#cb45-2707" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2708"><a href="#cb45-2708" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2709"><a href="#cb45-2709" aria-hidden="true" tabindex="-1"></a><span class="vs">.color6 {</span></span>
<span id="cb45-2710"><a href="#cb45-2710" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(120 100% 50%);</span></span>
<span id="cb45-2711"><a href="#cb45-2711" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(120, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2712"><a href="#cb45-2712" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2713"><a href="#cb45-2713" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2714"><a href="#cb45-2714" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2715"><a href="#cb45-2715" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2716"><a href="#cb45-2716" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2717"><a href="#cb45-2717" aria-hidden="true" tabindex="-1"></a><span class="vs">.color7 {</span></span>
<span id="cb45-2718"><a href="#cb45-2718" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(80 100% 50%);</span></span>
<span id="cb45-2719"><a href="#cb45-2719" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(80, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2720"><a href="#cb45-2720" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2721"><a href="#cb45-2721" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2722"><a href="#cb45-2722" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2723"><a href="#cb45-2723" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2724"><a href="#cb45-2724" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2725"><a href="#cb45-2725" aria-hidden="true" tabindex="-1"></a><span class="vs">.color8 {</span></span>
<span id="cb45-2726"><a href="#cb45-2726" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(60 100% 50%);</span></span>
<span id="cb45-2727"><a href="#cb45-2727" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(60, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2728"><a href="#cb45-2728" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2729"><a href="#cb45-2729" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2730"><a href="#cb45-2730" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2731"><a href="#cb45-2731" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2732"><a href="#cb45-2732" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2733"><a href="#cb45-2733" aria-hidden="true" tabindex="-1"></a><span class="vs">.color9 {</span></span>
<span id="cb45-2734"><a href="#cb45-2734" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(40 100% 50%);</span></span>
<span id="cb45-2735"><a href="#cb45-2735" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(40, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2736"><a href="#cb45-2736" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2737"><a href="#cb45-2737" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2738"><a href="#cb45-2738" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2739"><a href="#cb45-2739" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2740"><a href="#cb45-2740" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2741"><a href="#cb45-2741" aria-hidden="true" tabindex="-1"></a><span class="vs">.color375 {</span></span>
<span id="cb45-2742"><a href="#cb45-2742" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2743"><a href="#cb45-2743" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2744"><a href="#cb45-2744" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2745"><a href="#cb45-2745" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2746"><a href="#cb45-2746" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2747"><a href="#cb45-2747" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2748"><a href="#cb45-2748" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2749"><a href="#cb45-2749" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0083 {</span></span>
<span id="cb45-2750"><a href="#cb45-2750" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2751"><a href="#cb45-2751" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2752"><a href="#cb45-2752" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2753"><a href="#cb45-2753" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2754"><a href="#cb45-2754" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2755"><a href="#cb45-2755" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2756"><a href="#cb45-2756" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2757"><a href="#cb45-2757" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0166 {</span></span>
<span id="cb45-2758"><a href="#cb45-2758" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2759"><a href="#cb45-2759" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2760"><a href="#cb45-2760" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2761"><a href="#cb45-2761" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2762"><a href="#cb45-2762" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2763"><a href="#cb45-2763" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2764"><a href="#cb45-2764" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2765"><a href="#cb45-2765" aria-hidden="true" tabindex="-1"></a><span class="vs">.color55by24 {</span></span>
<span id="cb45-2766"><a href="#cb45-2766" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2767"><a href="#cb45-2767" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2768"><a href="#cb45-2768" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2769"><a href="#cb45-2769" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2770"><a href="#cb45-2770" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2771"><a href="#cb45-2771" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2772"><a href="#cb45-2772" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2773"><a href="#cb45-2773" aria-hidden="true" tabindex="-1"></a><span class="vs">.color125 {</span></span>
<span id="cb45-2774"><a href="#cb45-2774" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2775"><a href="#cb45-2775" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2776"><a href="#cb45-2776" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2777"><a href="#cb45-2777" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2778"><a href="#cb45-2778" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2779"><a href="#cb45-2779" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2780"><a href="#cb45-2780" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2781"><a href="#cb45-2781" aria-hidden="true" tabindex="-1"></a><span class="vs">.color025 {</span></span>
<span id="cb45-2782"><a href="#cb45-2782" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2783"><a href="#cb45-2783" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2784"><a href="#cb45-2784" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2785"><a href="#cb45-2785" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2786"><a href="#cb45-2786" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2787"><a href="#cb45-2787" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2788"><a href="#cb45-2788" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2789"><a href="#cb45-2789" aria-hidden="true" tabindex="-1"></a><span class="vs">.color287 {</span></span>
<span id="cb45-2790"><a href="#cb45-2790" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2791"><a href="#cb45-2791" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2792"><a href="#cb45-2792" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2793"><a href="#cb45-2793" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2794"><a href="#cb45-2794" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2795"><a href="#cb45-2795" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2796"><a href="#cb45-2796" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2797"><a href="#cb45-2797" aria-hidden="true" tabindex="-1"></a><span class="vs">.color333 {</span></span>
<span id="cb45-2798"><a href="#cb45-2798" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2799"><a href="#cb45-2799" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2800"><a href="#cb45-2800" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2801"><a href="#cb45-2801" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2802"><a href="#cb45-2802" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2803"><a href="#cb45-2803" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2804"><a href="#cb45-2804" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2805"><a href="#cb45-2805" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0333 {</span></span>
<span id="cb45-2806"><a href="#cb45-2806" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2807"><a href="#cb45-2807" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2808"><a href="#cb45-2808" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2809"><a href="#cb45-2809" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2810"><a href="#cb45-2810" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2811"><a href="#cb45-2811" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2812"><a href="#cb45-2812" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2813"><a href="#cb45-2813" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0416 {</span></span>
<span id="cb45-2814"><a href="#cb45-2814" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2815"><a href="#cb45-2815" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2816"><a href="#cb45-2816" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2817"><a href="#cb45-2817" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2818"><a href="#cb45-2818" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2819"><a href="#cb45-2819" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2820"><a href="#cb45-2820" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2821"><a href="#cb45-2821" aria-hidden="true" tabindex="-1"></a><span class="vs">.color429 {</span></span>
<span id="cb45-2822"><a href="#cb45-2822" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2823"><a href="#cb45-2823" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2824"><a href="#cb45-2824" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2825"><a href="#cb45-2825" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2826"><a href="#cb45-2826" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2827"><a href="#cb45-2827" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2828"><a href="#cb45-2828" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2829"><a href="#cb45-2829" aria-hidden="true" tabindex="-1"></a><span class="vs">.color05 {</span></span>
<span id="cb45-2830"><a href="#cb45-2830" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2831"><a href="#cb45-2831" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2832"><a href="#cb45-2832" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2833"><a href="#cb45-2833" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2834"><a href="#cb45-2834" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2835"><a href="#cb45-2835" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2836"><a href="#cb45-2836" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2837"><a href="#cb45-2837" aria-hidden="true" tabindex="-1"></a><span class="vs">.color533 {</span></span>
<span id="cb45-2838"><a href="#cb45-2838" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2839"><a href="#cb45-2839" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2840"><a href="#cb45-2840" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2841"><a href="#cb45-2841" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2842"><a href="#cb45-2842" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2843"><a href="#cb45-2843" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2844"><a href="#cb45-2844" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2845"><a href="#cb45-2845" aria-hidden="true" tabindex="-1"></a><span class="vs">.color969 {</span></span>
<span id="cb45-2846"><a href="#cb45-2846" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2847"><a href="#cb45-2847" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2848"><a href="#cb45-2848" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2849"><a href="#cb45-2849" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2850"><a href="#cb45-2850" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2851"><a href="#cb45-2851" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2852"><a href="#cb45-2852" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2853"><a href="#cb45-2853" aria-hidden="true" tabindex="-1"></a><span class="vs">.color999 {</span></span>
<span id="cb45-2854"><a href="#cb45-2854" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2855"><a href="#cb45-2855" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2856"><a href="#cb45-2856" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2857"><a href="#cb45-2857" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2858"><a href="#cb45-2858" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2859"><a href="#cb45-2859" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2860"><a href="#cb45-2860" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2861"><a href="#cb45-2861" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1by320 {</span></span>
<span id="cb45-2862"><a href="#cb45-2862" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2863"><a href="#cb45-2863" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2864"><a href="#cb45-2864" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2865"><a href="#cb45-2865" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2866"><a href="#cb45-2866" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2867"><a href="#cb45-2867" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2868"><a href="#cb45-2868" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2869"><a href="#cb45-2869" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD121 {</span></span>
<span id="cb45-2870"><a href="#cb45-2870" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2871"><a href="#cb45-2871" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2872"><a href="#cb45-2872" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2873"><a href="#cb45-2873" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2874"><a href="#cb45-2874" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2875"><a href="#cb45-2875" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2876"><a href="#cb45-2876" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2877"><a href="#cb45-2877" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD268 {</span></span>
<span id="cb45-2878"><a href="#cb45-2878" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2879"><a href="#cb45-2879" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2880"><a href="#cb45-2880" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2881"><a href="#cb45-2881" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2882"><a href="#cb45-2882" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2883"><a href="#cb45-2883" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2884"><a href="#cb45-2884" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2885"><a href="#cb45-2885" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD305 {</span></span>
<span id="cb45-2886"><a href="#cb45-2886" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2887"><a href="#cb45-2887" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2888"><a href="#cb45-2888" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2889"><a href="#cb45-2889" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2890"><a href="#cb45-2890" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2891"><a href="#cb45-2891" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2892"><a href="#cb45-2892" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2893"><a href="#cb45-2893" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD306 {</span></span>
<span id="cb45-2894"><a href="#cb45-2894" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb45-2895"><a href="#cb45-2895" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb45-2896"><a href="#cb45-2896" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb45-2897"><a href="#cb45-2897" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb45-2898"><a href="#cb45-2898" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb45-2899"><a href="#cb45-2899" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb45-2900"><a href="#cb45-2900" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb45-2901"><a href="#cb45-2901" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb45-2902"><a href="#cb45-2902" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-16" data-nodetype="expression">

</div>
</div>
</div>
<style>
svg.barclock {
  width: 100%;
  overflow: visible;
}
.tickLabel, .tickLabel1, .tickLabel2, .timeLabel {
  font-family: monospace;
  text-anchor: middle;
}
.timeLabel {
  text-anchor: start;
}
.timeBar, .timeBarFull, .timeBarFullN {
  x: 1px;
  height: 25px;
  rx: 5px;
  stroke: #aaa;
}
.tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB, .tickB1 {
  stroke: none;
  fill: #666;
  width: 1px;
}
.analogclock {
  stroke: #000;
  font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
  overflow: visible;
}
.analogclock #rim {
  fill: none;
  stroke: #999;
  stroke-width: 3px;
}
.analogclock .second-hand {
  stroke-width: 3;
}
.analogclock .minute-hand {
  stroke-width: 8;
  stroke-linecap: round;
}
.analogclock .hour-hand {
  stroke-width: 12;
  stroke-linecap: round;
}
.analogclock .hands-cover {
  stroke-width: 3;
  fill: #fff;
}
.analogclock .second-tick {
  stroke-width: 3;
  fill: #000;
}
.analogclock .hour-tick {
  stroke-width: 8; // same as the minute hand
}
.analogclock .second-label {
  font-size: 18px;
}
.analogclock .hour-label {
  font-size: 32px
}
.clocks * {
  margin: -10px 0px 10px 0px;
  padding: 0px;
}
#title-block-header > div:nth-child(2) {
  display: none;
}
h4.hiddenheading, h5.hiddenheading {
  display: none;
}
div.cell-output:has(#daylightapp) {
  overflow: visible;
}
div.cell-output:has(#formEl) {
  overflow: visible;
}
#daylightapp {
  overflow: visible;
}
#daylightapp * {
  overflow: visible;
}
#solar-system * {
  overflow: visible;
}
#timezonepopstackedbar {
  overflow: visible;
}
#timezonepoptoggles div {
  display: flex;
}
#timezonepoptoggles div form {
  max-width: 180px;
}
#timezonepoptoggles div form label {
  max-width: 120px;
}
#timezonepoptoggles div form:nth-child(1) {
  margin-right: 8px;
}
#timezonepoptoggles div form:nth-child(2) label {
  max-width: 110px;
}
#timezonepoptoggles input[type=checkbox] {
  margin-top: 8px;
}
</style>


<!-- -->

<div class="ojs-auto-generated hidden">
<script type="ojs-module-contents">
eyJjb250ZW50cyI6WyAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjVGltZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTEifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY1RpbWVOfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjWm9uZUhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTMifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2Nsb2NrfSR7Y2xvY2sxfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c2VsRGF0ZUhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTUifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NlbFRpbWVEYXl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC02In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzZWxTbmFwRGF5fTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7emVyb1lkYUhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTgifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3plcm9UaW1lSHNsMH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTkifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3plcm9Eb3RlSHNsfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTAifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3plcm9UaW1lSHNsMX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTExIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtsZWFwQ291bnRIc2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xMiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7bGVhcFR6b0hzbDB9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xMyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7aG1zVHpvSHNsfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTQifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2htc1JvZEhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTE1In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtobXNSZWZIc2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xNiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7aG1zVHpvSHNsMX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTE3In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtobXNSb2VIc2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xOCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7bGVhcFRvZEhzbDF9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xOSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7bGVhcFR6b0hzbDJ9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yMCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7emVyb1RpbWVIc2w0fTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjEifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY09mZnNldEhzbFB9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yMiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjT2Zmc2V0SHNsTn08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTIzIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHt6ZXJvVGltZUhzbDN9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yNCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7emVyb1RpbWVIc2wyfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjUifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2xvbmdJbnB1dEhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTI2In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtlb3RIc2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yNyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZW90U3VtSHNsfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjgifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NvbGFyTm9vbkhzbH0ke3NvbGFyU2lnbn0ke3NvbGFyRGlmZkhzbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTI5In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNPZmZzZXRIc2wwfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMzAifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY09mZnNldEhzbDB9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zMSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjVGltZU9mZkxlYXBUem9Ic2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zMiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjVGltZU9mZkxlYXBUem9Ic2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zMyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjVGltZU9mZkxlYXBVemlIc2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zNCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjT2Zmc2V0SHNsUH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTM1In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNPZmZzZXRIc2xOfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMzYifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3V0Y09mZkhzbE19PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0zNyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7dXRjT2ZmSHNsRH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTM4In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNab25Ic2xQfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMzkifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3V0Y09mZnNldE1kaWZmSHNsfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNDAifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3V0Y09mZkRpZmZIc2x9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC00MSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclRpbWUudG9GaXhlZCg0KX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTQyIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHticm93c2VyU2lnbn08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTQzIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmFicyhicm93c2VyWm9uZSl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC00NCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7em9uZTB0aW1lLnRvRml4ZWQoNCl9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC00NSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclpvbmV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC00NiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclRpbWUudG9GaXhlZCg0KX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTQ3In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmZsb29yKGhvdXJzKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTQ4In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmZsb29yKG1pbnV0ZXMpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNDkifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke01hdGguZmxvb3Ioc2Vjb25kcykudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIil9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC01MCJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7YnJvd3NlclRpbWUudG9GaXhlZCg0KX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTUxIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtNYXRoLmZsb29yKG5vdyAvIDEwMDApfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNTIifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY1llYXJ9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC01MyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjRGF0ZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTU0In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNZZWFyfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNTUifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY0RhdGV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC01NiJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjWWVhcn08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTU3In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNEYXRlfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNTgifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY1llYXJ9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC01OSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZGVjRGF0ZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTYwIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtkZWNZZWFyfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtNjEifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2RlY0RhdGV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC02MiJ9XX0=
</script>
</div>
</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{laptev2024,
  author = {Laptev, Martin},
  title = {Dec {Time}},
  date = {2024},
  urldate = {2024},
  url = {https://maptv.github.io/dec/time},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-laptev2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Laptev, Martin. 2024. <span>“Dec Time.”</span> 2024. <a href="https://maptv.github.io/dec/time">https://maptv.github.io/dec/time</a>.
</div></div></section></div></main><!-- /main --><script src="../../asset/cite.js"></script><style>
#title-block-header > div.quarto-title-banner.page-columns.page-full { margin: 0px; padding: 0px; }
#title-block-header { margin: 0px; }
main#quarto-document-content { margin: 0px; padding: 0px; }
ul.navbar-nav.navbar-nav-scroll { -webkit-flex-direction: row; }
#quarto-sidebar { padding: 0px; overflow-x: hidden !important; }
#quarto-sidebar > * { padding: 0px; }
div.quarto-title-meta { padding-bottom: 8px; }
h2, h3 { margin: 0px; }
h3 { margin-top: 17px !important; }
div.cell.page-columns.page-full { height: 0px !important; }
@media only screen and (max-width: 991px) { #quarto-search { display: none !important; } #quarto-sidebar { padding: 0px 9px 0px 9px !important; } }
@media only screen and (max-width: 767px) { div.cell.page-columns.page-full { display: none !important; } }
nav.quarto-secondary-nav { padding: 0px !important; }
nav.quarto-secondary-nav > div.container-fluid.d-flex { margin-top: -12px !important; margin-bottom: -14px !important; }
.quarto-secondary-nav-title { margin-top: 10px !important; }
.navbar-logo { max-height: 40px !important; }
section#cite a.uri { word-break: break-all !important; }
a.navbar-brand { overflow: visible !important; }
.vinculum { position: relative; }
.vinculum::before { content: ""; position: absolute; top: .5px; left: 0; width: 100%; border-top: 1.5px solid; }
</style>
<script src="../../asset/stamp.js"></script><script>
const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
</script><script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZmhleWVuL2JhcmNoYXJ0LWNsb2NrXG5iYXJDaGFydCA9IHtcbiAgY29uc3QgVyA9IDgwMDtcbiAgY29uc3QgSCA9IDg4O1xuICBjb25zdCBiYXJYID0gMTtcbiAgY29uc3QgZmlyc3RCYXJZID0gMTtcbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCBXKVxuICAgIC5hdHRyKFwidmlld0JveFwiLCBbMCwgMCwgVyAvIDEuMTQsIEhdKTtcbiAgY29uc3QgeFJhbmdlID0gWzAsIFcgLSAxMDBdO1xuICBjb25zdCBzY2FsZUREID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzAsIDEwXSlcbiAgICAucmFuZ2UoeFJhbmdlKTtcbiAgY29uc3Qgc2NhbGVNYW5kQiA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFswLCAxMDBdKVxuICAgIC5yYW5nZSh4UmFuZ2UpO1xuICAvLyBCYWNrZ3JvdW5kIGJhcnMgdG8gc2hvdyB3aGVyZSAxMDAlIGxpZXNcbiAgc3ZnLnNlbGVjdEFsbCgnLmJhY2tncm91bmQnKVxuICAgIC5kYXRhKFtcbiAgICAgICdkZCcsIFwibWlsc1wiLCAnYmVhdHMnXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICdiYWNrZ3JvdW5kIHRpbWVCYXInKVxuICAgIC5hdHRyKCd3aWR0aCcsIFctMTAwKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKVxuICAvLyBCZWF0c1xuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKE51bWJlcihiYXJCZWF0cykpKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhckZ1bGwnKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzYwKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVNYW5kQihiYXJCZWF0cykpXG4gIC8vIENlbnRzL01pbHNcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVERChOdW1iZXIoYmFyREQpK051bWJlcihiYXJNaWxzKS8xMDArTnVtYmVyKGJhckJlYXRzKS8xMDAwMCkpXG4gIHN2Z1xuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lQmFyRnVsbCcpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkpXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZUREKGJhckREKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzMwKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVNYW5kQihOdW1iZXIoYmFyTWlscykrTnVtYmVyKGJhckJlYXRzKS8xMDApKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhckZ1bGwnKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzMwKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVNYW5kQihiYXJNaWxzKSlcbiAgLy8gQ2VudCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0MnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQycpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDg6NSlcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tCMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tCMScpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBkPT5kJTI9PT0wPyBmaXJzdEJhclkrNzc6Zmlyc3RCYXJZKzgwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCBkPT5kJTI9PT0wPyA4OjUpXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrQzEnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQzEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkLzEwKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZD0+ZCUyPT09MD8gZmlyc3RCYXJZKzQ3OmZpcnN0QmFyWSs1MClcbiAgICAuYXR0cignaGVpZ2h0JywgZD0+ZCUyPT09MD8gODo1KVxuICAvLyBNaWwgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tNJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDEgOiAxLCAxMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja00nKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzIwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCA2KVxuICBzdmcuc2VsZWN0QWxsKCcudGlja0xhYmVsMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxIDogMSwgMTApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgndGV4dCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tMYWJlbDEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKy41KVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzE4KVxuICAgIC8vLnN0eWxlKFwiZm9udC1zaXplXCIsIGB7VyA8IDU1MCA/IDEyIDogVyA8IDY1MCA/IDE0IDogVyA8IDc1MCA/IDE2IDogVyA8IDg1MCA/IDE4IDogMjB9cHhgKVxuICAgIC50ZXh0KGQ9PmQpXG4gIC8vIENlbnQgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tDMicpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tDMicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMTApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gQmVhdCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0InKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gTGFiZWxzXG4gIHN2Zy5zZWxlY3RBbGwoJy50aW1lTGFiZWwnKVxuICAgIC5kYXRhKFtgKyR7YmFyRER9YCwgYCR7YmFyTWlsc31gLCBgJHtiYXJCZWF0c31gXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lTGFiZWwnKVxuICAgIC5hdHRyKCd4JywgYmFyWCsyKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKzIwKVxuICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBgJHtXIDwgMzAwID8gMTQgOiBXIDwgNDAwID8gMTYgOiBXIDwgNTAwID8gMTggOiBXIDwgNjAwID8gMjAgOiAyMn1weGApXG4gICAgLnRleHQoZD0+ZCk7XG4gIHN2Zy5hdHRyKFwiaWRcIiwgXCJ0b3BiYXJcIik7XG4gIHN2Zy5hdHRyKCdjbGFzcycsICdiYXJjbG9jaycpXG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuYmFyQ2hhcnQxID0ge1xuICBjb25zdCBXID0gODAwO1xuICBjb25zdCBIID0gODg7XG4gIGNvbnN0IGJhclggPSAxO1xuICBjb25zdCBmaXJzdEJhclkgPSAxO1xuICBjb25zdCBzdmcgPSBkM1xuICAgIC5jcmVhdGUoXCJzdmdcIilcbiAgICAuYXR0cihcIndpZHRoXCIsIFcpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCBXIC8gMS4xNCwgSF0pO1xuICBjb25zdCB4UmFuZ2UgPSBbMCwgVyAtIDEwMF07XG4gIGNvbnN0IHNjYWxlREQgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgLmRvbWFpbihbMCwgMTBdKVxuICAgIC5yYW5nZSh4UmFuZ2UpO1xuICBjb25zdCBzY2FsZU1hbmRCID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzAsIDEwMF0pXG4gICAgLnJhbmdlKHhSYW5nZSk7XG4gIC8vIGNvbnN0IHNjYWxlRGVrID0gZDMuc2NhbGVMaW5lYXIoKVxuICAvLyAgLmRvbWFpbihbMCwgMzddKVxuICAvLyAgLnJhbmdlKHhSYW5nZSk7XG4gIC8vIEJhY2tncm91bmQgYmFycyB0byBzaG93IHdoZXJlIDEwMCUgbGllc1xuICBzdmcuc2VsZWN0QWxsKCcuYmFja2dyb3VuZCcpXG4gICAgLmRhdGEoW1xuICAgICAgLy8gJ2RlaycsICdkb3RkJyxcbiAgICAgICdkZCcsIFwibWlsc1wiLCAnYmVhdHMnXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICdiYWNrZ3JvdW5kIHRpbWVCYXInKVxuICAgIC5hdHRyKCd3aWR0aCcsIFctMTAwKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKVxuICAvLyBCZWF0c1xuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKE51bWJlcihiYXJCZWF0c04pKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXJGdWxsTicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKGJhckJlYXRzTikpXG4gIC8vIENlbnRzL01pbHNcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVERChOdW1iZXIoYmFyREROKStOdW1iZXIoYmFyTWlsc04pLzEwMCtOdW1iZXIoYmFyQmVhdHNOKS8xMDAwMCkpXG4gIHN2Z1xuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lQmFyRnVsbE4nKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVERChiYXJERE4pKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKE51bWJlcihiYXJNaWxzTikrTnVtYmVyKGJhckJlYXRzTikvMTAwKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXJGdWxsTicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU1hbmRCKGJhck1pbHNOKSlcbiAgLy8gQ2VudCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0MnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQycpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMzApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDg6NSlcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tCMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tCMScpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBkPT5kJTI9PT0wPyBmaXJzdEJhclkrNzc6Zmlyc3RCYXJZKzgwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCBkPT5kJTI9PT0wPyA4OjUpXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrQzEnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQzEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkLzEwKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZD0+ZCUyPT09MD8gZmlyc3RCYXJZKzQ3OmZpcnN0QmFyWSs1MClcbiAgICAuYXR0cignaGVpZ2h0JywgZD0+ZCUyPT09MD8gODo1KVxuICAvLyBNaWwgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tNJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDEgOiAxLCAxMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja00nKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzIwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCA2KVxuICBzdmcuc2VsZWN0QWxsKCcudGlja0xhYmVsMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxIDogMSwgMTApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgndGV4dCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tMYWJlbDEnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVERChkKStiYXJYKy41KVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzE4KVxuICAgIC8vLnN0eWxlKFwiZm9udC1zaXplXCIsIGB7VyA8IDM1MCA/IDEyIDogVyA8IDQ1MCA/IDE0IDogVyA8IDU1MCA/IDE2IDogVyA8IDY1MCA/IDE4IDogMjB9cHhgKVxuICAgIC50ZXh0KGQ9PmQpXG4gIC8vIENlbnQgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tDMicpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDEwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tDMicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMTApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gQmVhdCB0aWNrc1xuICBzdmcuc2VsZWN0QWxsKCcudGlja0InKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMTAgOiAxMCwgMTAwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrQicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZUREKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDk6NilcbiAgLy8gTGFiZWxzXG4gIHN2Zy5zZWxlY3RBbGwoJy50aW1lTGFiZWwnKVxuICAgIC5kYXRhKFtgLSR7YmFyREROfWAsIGAke2Jhck1pbHNOfWAsIGAke2JhckJlYXRzTn1gXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lTGFiZWwnKVxuICAgIC5hdHRyKCd4JywgYmFyWCsyKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKzIwKVxuICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBgJHtXIDwgMzAwID8gMTQgOiBXIDwgNDAwID8gMTYgOiBXIDwgNTAwID8gMTggOiBXIDwgNjAwID8gMjAgOiAyMn1weGApXG4gICAgLnRleHQoZD0+ZCk7XG4gIHN2Zy5hdHRyKFwiaWRcIiwgXCJidG1iYXJcIik7XG4gIHN2Zy5hdHRyKCdjbGFzcycsICdiYXJjbG9jaycpXG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGxvY2F0aW9uID0gd29ybGRNYXBDb29yZGluYXRlcyhbMTYyLCAwXSwgW3dpZHRoICogLjk5OCwgKCgyMSAvIDQwKSAqIHdpZHRoKV0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBodHRwczovL29ic2VydmFibGVocS5jb20vQGRicmlkZ2VzL3Zpc3VhbGl6aW5nLXNlYXNvbmFsLWRheWxpZ2h0XG5hcHAgPSB7XG4gIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdChET00uc3ZnKHdpZHRoLCBoZWlnaHQgKiAod2lkdGggPCAzMDAgPyAuOTcgOiB3aWR0aCA8IDM1MCA/IC45NiA6IHdpZHRoIDwgNDAwID8gLjk1IDogd2lkdGggPCA0NTAgPyAuOTQgOiB3aWR0aCA8IDUwMCA/IC45MyA6IHdpZHRoIDwgNTUwID8gLjkyIDogd2lkdGggPCA2MDAgPyAuOSA6IHdpZHRoIDwgNjUwID8gLjg2IDogd2lkdGggPCA3MDAgPyAuODIgOiAuNzgpKSk7XG4gIHN2Zy5zdHlsZShcInVzZXItc2VsZWN0XCIsIFwibm9uZVwiKS5zdHlsZShcIi13ZWJraXQtdXNlci1zZWxlY3RcIiwgXCJub25lXCIpLmF0dHIoXCJpZFwiLCBcImRheWxpZ2h0YXBwXCIpO1xuICBjb25zdCBtYXJnaW4gPSB7dG9wOiAyMCwgbGVmdDogMTYsIHJpZ2h0OiAxNiwgYm90dG9tOiAwLCBpbm5lcjogMzJ9O1xuICBjb25zdCBjb250ZW50V2lkdGggPSB3aWR0aCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0IC0gbWFyZ2luLmlubmVyO1xuICBjb25zdCBjb2x1bW5XaWR0aCA9IGNvbnRlbnRXaWR0aCAvIDI7XG4gIGxldCBzZWxlY3Rpb24gPSB7XG4gICAgZGF0ZTogZGF0ZTIwMjIsXG4gICAgaG91cjogZGF0ZTIwMjIuZ2V0SG91cnMoKVxuICB9XG4gIGNvbnN0IHJlbmRlclBsb3QgPSAoKSA9PiB7XG4gICAgc3ZnLnNlbGVjdEFsbChcIiNwbG90ICpcIikucmVtb3ZlKCk7XG4gICAgc3ZnLnNlbGVjdChcIiNwbG90XCIpLmNhbGwoZGF5bGlnaHRQbG90LCB7XG4gICAgdml6d2lkdGg6IGNvbHVtbldpZHRoIC8gKHdpZHRoIDwgMzAwID8gMSA6IHdpZHRoIDwgNDAwID8gMS4wNSA6IHdpZHRoIDwgNDUwID8gMS4xIDogd2lkdGggPCA1MDAgPyAxLjE1IDogd2lkdGggPCA1NTAgPyAxLjIgOiB3aWR0aCA8IDYwMCA/IDEuMjUgOiB3aWR0aCA8IDY1MCA/IDEuMyA6IHdpZHRoIDwgNzAwID8gMS40IDogMS40OCksXG4gICAgICBoZWlnaHQ6IGhlaWdodCAqICh3aWR0aCA8IDQwMCA/IDEuNjIgOiB3aWR0aCA8IDUwMCA/IDEuNiA6IHdpZHRoIDwgNzAwID8gMS41OCA6IDEuNTYpLFxuICAgICAgeWVhcjogMjAyMixcbiAgICAgIGxhdGl0dWRlOiBsb2NhdGlvblsxXSxcbiAgICAgIGRlZmF1bHREYXRlOiBzZWxlY3Rpb24uZGF0ZSxcbiAgICAgIGRlZmF1bHRIb3VyOiBzZWxlY3Rpb24uaG91clxuICAgIH0pXG4gIH1cbiAgY29uc3QgcmVuZGVyU29sYXJTeXN0ZW0gPSAoKSA9PiB7XG4gICAgc3ZnLnNlbGVjdEFsbChcIiNzb2xhci1zeXN0ZW0gKlwiKS5yZW1vdmUoKTtcbiAgICBzdmcuc2VsZWN0QWxsKFwiI3NvbGFyLXN5c3RlbVwiKS5jYWxsKHNvbGFyU3lzdGVtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbldpZHRoICogMi4wMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uaG91cixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGFya21vZGUpO1xuICB9XG4gIC8vIGNvbnN0IHJlbmRlckdsb2JlID0gKCkgPT4ge1xuICAvLyAgIHN2Zy5zZWxlY3RBbGwoXCIjZ2xvYmUgKlwiKS5yZW1vdmUoKTtcbiAgLy8gICBzdmcuc2VsZWN0QWxsKFwiI2dsb2JlXCIpLmNhbGwoZ2xvYmUsIHsgdml6d2lkdGg6IGNvbHVtbldpZHRoIC8gMS4yOCwgbG9jYXRpb24sIC4uLnNlbGVjdGlvbiB9KTtcbiAgLy8gfVxuICBjb25zdCBzZXRTZWxlY3Rpb24gPSAobmV3U2VsZWN0aW9uLCBmb3JjZVJlbmRlciA9IGZhbHNlKSA9PiB7XG4gICAgY29uc3QgcHJldiA9IHsuLi5zZWxlY3Rpb259O1xuICAgIHNlbGVjdGlvbiA9IG5ld1NlbGVjdGlvbjtcbiAgICBzdmcubm9kZSgpLnZhbHVlID0gc2VsZWN0aW9uO1xuICAgIHNldCh2aWV3b2Ygc2VsZWN0ZWREYXRlLCBzZWxlY3Rpb24uZGF0ZSk7XG4gICAgc2V0KHZpZXdvZiBzZWxlY3RlZEhvdXIsIHNlbGVjdGlvbi5ob3VyKTtcbiAgICBpZiAoZm9yY2VSZW5kZXIpIHtcbiAgICAgIHJlbmRlclBsb3QoKTtcbiAgICAgIHJlbmRlclNvbGFyU3lzdGVtKCk7XG4gIC8vICAgIHJlbmRlckdsb2JlKCk7XG4gICAgfSBlbHNlIGlmIChwcmV2LmhvdXIgIT09IHNlbGVjdGlvbi5ob3VyIHx8IHByZXYuZGF0ZSAhPT0gc2VsZWN0aW9uLmRhdGUpIHtcbiAgICAgIHJlbmRlclNvbGFyU3lzdGVtKCk7XG4gIC8vICAgIHJlbmRlckdsb2JlKCk7XG59XG4gIH1cbiAgY29uc3QgcGxvdCA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJpZFwiLCBcInBsb3RcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnQgKyAwfSwgJHtoZWlnaHQgLyA1ICsgKHdpZHRoIDwgNjAwID8gMTIgOiA1KX0pYCk7XG4gIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJpZFwiLCBcInNvbGFyLXN5c3RlbVwiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdCArIDEyfSwgJHttYXJnaW4udG9wICsgd2lkdGggLyAyMiAtIDYgLSA1ICogKHdpZHRoIDwgNDAwKX0pYCk7XG4gIC8vIHN2Zy5hcHBlbmQoXCJnXCIpXG4gIC8vICAgLmF0dHIoXCJpZFwiLCBcImdsb2JlXCIpXG4gIC8vICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0ICsgbWFyZ2luLmlubmVyICsgY29sdW1uV2lkdGggLyAyICsgMjB9LCAke21hcmdpbi50b3AgKyBoZWlnaHQgLyAxLjIgKyA0fSlgKTtcbiAgc2V0U2VsZWN0aW9uKHNlbGVjdGlvbiwgdHJ1ZSk7XG4gIGNvbnN0IGhhbmRsZURhdGVIb3VyQ2hhbmdlID0gKHsgdGFyZ2V0LCBkZXRhaWw6IHsgZGF0ZSwgaG91ciB9fSkgPT4ge1xuICAgIGlmIChkYXRlICE9IG51bGwgJiYgaG91ciAhPSBudWxsKSBzZXRTZWxlY3Rpb24oey4uLnNlbGVjdGlvbiwgZGF0ZSwgaG91cn0pO1xuICB9XG4gIHN2Zy5ub2RlKCkuYWRkRXZlbnRMaXN0ZW5lcihFdmVudFR5cGUuRGF0ZUhvdXJDaGFuZ2UsIGhhbmRsZURhdGVIb3VyQ2hhbmdlLCBmYWxzZSk7XG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BkMy9zaW1wbGUtY2xvY2tcbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZHJpby9sZXRzLWJ1aWxkLWFuLWFuYWxvZy1jbG9ja1xuY2xvY2sgPSB7XG4gIGNvbnN0IGNsb2NrUmFkaXVzID0gMjAwLFxuICAgIG1hcmdpbiA9IDUwLFxuICAgIHcgPSAoY2xvY2tSYWRpdXMgKyBtYXJnaW4pICogMixcbiAgICBoID0gKGNsb2NrUmFkaXVzICsgbWFyZ2luKSAqIDIsXG4gICAgaG91ckhhbmRMZW5ndGggPSAoMiAqIGNsb2NrUmFkaXVzKSAvIDMsXG4gICAgbWludXRlSGFuZExlbmd0aCA9IGNsb2NrUmFkaXVzLFxuICAgIHNlY29uZEhhbmRMZW5ndGggPSBjbG9ja1JhZGl1cyAtIDEyLFxuICAgIHNlY29uZEhhbmRCYWxhbmNlID0gMzAsXG4gICAgc2Vjb25kVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgc2Vjb25kVGlja0xlbmd0aCA9IC0xMCxcbiAgICBob3VyVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgaG91clRpY2tMZW5ndGggPSAtMTgsXG4gICAgc2Vjb25kTGFiZWxSYWRpdXMgPSBjbG9ja1JhZGl1cyArIDE2LFxuICAgIHNlY29uZExhYmVsWU9mZnNldCA9IDUsXG4gICAgaG91ckxhYmVsUmFkaXVzID0gY2xvY2tSYWRpdXMgLSA0MCxcbiAgICBob3VyTGFiZWxZT2Zmc2V0ID0gNyxcbiAgICByYWRpYW5zID0gTWF0aC5QSSAvIDE4MDtcbiAgY29uc3QgdGVuID0gZDNcbiAgICAuc2NhbGVMaW5lYXIoKVxuICAgIC5yYW5nZShbMCwgMzYwXSlcbiAgICAuZG9tYWluKFswLCAxMF0pO1xuICBjb25zdCBzdG8gPSBkM1xuICAgIC5zY2FsZUxpbmVhcigpXG4gICAgLnJhbmdlKFswLCAzNjBdKVxuICAgIC5kb21haW4oWzAsIDEwMF0pO1xuICBjb25zdCBoYW5kRGF0YSA9IFtcbiAgICB7XG4gICAgICB0eXBlOiBcImhvdXJcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtaG91ckhhbmRMZW5ndGgsXG4gICAgICBzY2FsZTogdGVuXG4gICAgfSxcbiAgICB7XG4gICAgICB0eXBlOiBcIm1pbnV0ZVwiLFxuICAgICAgdmFsdWU6IDAsXG4gICAgICBsZW5ndGg6IC1taW51dGVIYW5kTGVuZ3RoLFxuICAgICAgc2NhbGU6IHN0b1xuICAgIH0sXG4gICAge1xuICAgICAgdHlwZTogXCJzZWNvbmRcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtc2Vjb25kSGFuZExlbmd0aCxcbiAgICAgIHNjYWxlOiBzdG8sXG4gICAgICBiYWxhbmNlOiBzZWNvbmRIYW5kQmFsYW5jZVxuICAgIH1cbiAgXTtcbiAgZnVuY3Rpb24gZHJhd0Nsb2NrKCkge1xuICAgIC8vIGNyZWF0ZSBhbGwgdGhlIGNsb2NrIGVsZW1lbnRzXG4gICAgdXBkYXRlRGF0YSgpOyAvL2RyYXcgdGhlbSBpbiB0aGUgY29ycmVjdCBzdGFydGluZyBwb3NpdGlvblxuICAgIGNvbnN0IGZhY2UgPSBzdmdcbiAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcImlkXCIsIFwiY2xvY2stZmFjZVwiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke1t3IC8gMiwgaCAvIDJdfSlgKTtcbiAgICAvLyBhZGQgbWFya3MgZm9yIHNlY29uZHNcbiAgICBmYWNlXG4gICAgICAuc2VsZWN0QWxsKFwiLnNlY29uZC10aWNrXCIpXG4gICAgICAuZGF0YShkMy5yYW5nZSgwLCAxMDApKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwic2Vjb25kLXRpY2tcIilcbiAgICAgIC5hdHRyKFwieDFcIiwgMClcbiAgICAgIC5hdHRyKFwieDJcIiwgMClcbiAgICAgIC5hdHRyKFwieTFcIiwgc2Vjb25kVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBzZWNvbmRUaWNrU3RhcnQgKyBzZWNvbmRUaWNrTGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7c3RvKGQpfSlgKTtcbiAgICAvLyBhbmQgbGFiZWxzLi4uXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5zZWNvbmQtbGFiZWxcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwMCwgNSkpXG4gICAgICAuZW50ZXIoKVxuICAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJzZWNvbmQtbGFiZWxcIilcbiAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgIC5hdHRyKFwieFwiLCBkID0+IHNlY29uZExhYmVsUmFkaXVzICogTWF0aC5zaW4oc3RvKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT5cbiAgICAgICAgICAtc2Vjb25kTGFiZWxSYWRpdXMgKiBNYXRoLmNvcyhzdG8oZCkgKiByYWRpYW5zKSArIHNlY29uZExhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICAvLyAuLi4gYW5kIGhvdXJzXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5ob3VyLXRpY2tcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwLCAxKSlcbiAgICAgIC5lbnRlcigpXG4gICAgICAuYXBwZW5kKFwibGluZVwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImhvdXItdGlja1wiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBob3VyVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBob3VyVGlja1N0YXJ0ICsgaG91clRpY2tMZW5ndGgpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGByb3RhdGUoJHt0ZW4oZCl9KWApO1xuICAgIGZhY2VcbiAgICAgIC5zZWxlY3RBbGwoXCIuaG91ci1sYWJlbFwiKVxuICAgICAgLmRhdGEoZDMucmFuZ2UoMCwgMTAsIDEpKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwiaG91ci1sYWJlbFwiKVxuICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIGQgPT4gaG91ckxhYmVsUmFkaXVzICogTWF0aC5zaW4odGVuKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT4gLWhvdXJMYWJlbFJhZGl1cyAqIE1hdGguY29zKHRlbihkKSAqIHJhZGlhbnMpICsgaG91ckxhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICBjb25zdCBoYW5kcyA9IGZhY2UuYXBwZW5kKFwiZ1wiKS5hdHRyKFwiaWRcIiwgXCJjbG9jay1oYW5kc1wiKTtcbiAgICBoYW5kc1xuICAgICAgLnNlbGVjdEFsbChcImxpbmVcIilcbiAgICAgIC5kYXRhKGhhbmREYXRhKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIGQgPT4gZC50eXBlICsgXCItaGFuZFwiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBkID0+IGQuYmFsYW5jZSB8fCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MlwiLCBkID0+IGQubGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7ZC5zY2FsZShkLnZhbHVlKX0pYCk7XG4gICAgZmFjZVxuICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgIC5hdHRyKFwiaWRcIiwgXCJmYWNlLW92ZXJsYXlcIilcbiAgICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJoYW5kcy1jb3ZlclwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIDApXG4gICAgICAuYXR0cihcInlcIiwgMClcbiAgICAgIC5hdHRyKFwiclwiLCBjbG9ja1JhZGl1cyAvIDIwKTtcbiAgfVxuICBmdW5jdGlvbiBtb3ZlSGFuZHMoKSB7XG4gICAgY29uc3Qgc2VsID0gZDNcbiAgICAgIC5zZWxlY3QoXCIjY2xvY2staGFuZHMtZmluYWxcIilcbiAgICAgIC5zZWxlY3RBbGwoXCJsaW5lXCIpXG4gICAgICAuZGF0YShoYW5kRGF0YSlcbiAgICAgIC50cmFuc2l0aW9uKCk7XG4gICAgaWYgKGZhbmN5U2Vjb25kc09GRikgc2VsLmVhc2UoZDMuZWFzZUVsYXN0aWMucGVyaW9kKDAuNSkpO1xuICAgIHNlbC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHJvdGF0ZSgke2Quc2NhbGUoZC52YWx1ZSl9KWApO1xuICB9XG4gIGZ1bmN0aW9uIHVwZGF0ZURhdGEoKSB7XG4gICAgaGFuZERhdGFbMF0udmFsdWUgPSAhZmFuY3lTZWNvbmRzT0ZGID8gTWF0aC5mbG9vcihzZWxlY3RlZEV4YWN0ICogMTApIDogZGVjVGltZVswXTtcbiAgICBoYW5kRGF0YVsxXS52YWx1ZSA9ICFmYW5jeVNlY29uZHNPRkYgPyBNYXRoLmZsb29yKHNlbGVjdGVkRXhhY3QgKiAxMCAlIDEgKiAxMDApIDogZGVjVGltZS5zbGljZSgyLCA0KTtcbiAgICBoYW5kRGF0YVsyXS52YWx1ZSA9ICFmYW5jeVNlY29uZHNPRkYgPyBzZWxlY3RlZEV4YWN0ICogMTAgJSAxICogMTAwICUgMSAqIDEwMCA6IGRlY1RpbWUuc2xpY2UoNCwgNik7XG4gIH1cbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3LCBoXSlcbiAgICAuc3R5bGUoXCJtYXgtd2lkdGhcIiwgYCR7d2lkdGggLyAyLjF9cHhgKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJhbmFsb2djbG9ja1wiKVxuICAgIC5hdHRyKFwiaWRcIiwgXCJ0b3BjbG9ja1wiKTtcbiAgc3ZnXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAudGV4dChgKyR7ZGVjVGltZX0tJHtzZWxlY3RlZFpvbmV9YClcbiAgICAuYXR0cihcInhcIiwgY2xvY2tSYWRpdXMgKyBtYXJnaW4pXG4gICAgLmF0dHIoXCJ5XCIsIGNsb2NrUmFkaXVzICogMiArIG1hcmdpbiAqIDIuMSlcbiAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgLmF0dHIoXCJmb250LXNpemVcIiwgMzIpXG4gICAgLmF0dHIoXCJmb250LWZhbWlseVwiLCBcIm1vbm9zcGFjZVwiKTtcbiAgZHJhd0Nsb2NrKCk7XG4gIC8vIEFuaW1hdGlvblxuICBjb25zdCBpbnRlcnZhbCA9IHNldEludGVydmFsKFxuICAgICgpID0+IHtcbiAgICAgIHVwZGF0ZURhdGEoKTtcbiAgICAgIG1vdmVIYW5kcygpO1xuICAgIH0sXG4gICAgIWZhbmN5U2Vjb25kc09GRiA/IDEwIDogODY0XG4gICk7XG4gIGludmFsaWRhdGlvbi50aGVuKCgpID0+IGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpKTtcbiAgcmV0dXJuIHN2Zy5ub2RlKCk7XG59XG5jbG9jazEgPSB7XG4gIGNvbnN0IGNsb2NrUmFkaXVzID0gMjAwLFxuICAgIG1hcmdpbiA9IDUwLFxuICAgIHcgPSAoY2xvY2tSYWRpdXMgKyBtYXJnaW4pICogMixcbiAgICBoID0gKGNsb2NrUmFkaXVzICsgbWFyZ2luKSAqIDIsXG4gICAgaG91ckhhbmRMZW5ndGggPSAoMiAqIGNsb2NrUmFkaXVzKSAvIDMsXG4gICAgbWludXRlSGFuZExlbmd0aCA9IGNsb2NrUmFkaXVzLFxuICAgIHNlY29uZEhhbmRMZW5ndGggPSBjbG9ja1JhZGl1cyAtIDEyLFxuICAgIHNlY29uZEhhbmRCYWxhbmNlID0gMzAsXG4gICAgc2Vjb25kVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgc2Vjb25kVGlja0xlbmd0aCA9IC0xMCxcbiAgICBob3VyVGlja1N0YXJ0ID0gY2xvY2tSYWRpdXMsXG4gICAgaG91clRpY2tMZW5ndGggPSAtMTgsXG4gICAgc2Vjb25kTGFiZWxSYWRpdXMgPSBjbG9ja1JhZGl1cyArIDE2LFxuICAgIHNlY29uZExhYmVsWU9mZnNldCA9IDUsXG4gICAgaG91ckxhYmVsUmFkaXVzID0gY2xvY2tSYWRpdXMgLSA0MCxcbiAgICBob3VyTGFiZWxZT2Zmc2V0ID0gNyxcbiAgICByYWRpYW5zID0gTWF0aC5QSSAvIDE4MDtcbiAgY29uc3QgdGVuID0gZDNcbiAgICAuc2NhbGVMaW5lYXIoKVxuICAgIC5yYW5nZShbMCwgMzYwXSlcbiAgICAuZG9tYWluKFswLCAxMF0pO1xuICBjb25zdCBzdG8gPSBkM1xuICAgIC5zY2FsZUxpbmVhcigpXG4gICAgLnJhbmdlKFswLCAzNjBdKVxuICAgIC5kb21haW4oWzAsIDEwMF0pO1xuICBjb25zdCBoYW5kRGF0YSA9IFtcbiAgICB7XG4gICAgICB0eXBlOiBcImhvdXJcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtaG91ckhhbmRMZW5ndGgsXG4gICAgICBzY2FsZTogdGVuXG4gICAgfSxcbiAgICB7XG4gICAgICB0eXBlOiBcIm1pbnV0ZVwiLFxuICAgICAgdmFsdWU6IDAsXG4gICAgICBsZW5ndGg6IC1taW51dGVIYW5kTGVuZ3RoLFxuICAgICAgc2NhbGU6IHN0b1xuICAgIH0sXG4gICAge1xuICAgICAgdHlwZTogXCJzZWNvbmRcIixcbiAgICAgIHZhbHVlOiAwLFxuICAgICAgbGVuZ3RoOiAtc2Vjb25kSGFuZExlbmd0aCxcbiAgICAgIHNjYWxlOiBzdG8sXG4gICAgICBiYWxhbmNlOiBzZWNvbmRIYW5kQmFsYW5jZVxuICAgIH1cbiAgXTtcbiAgZnVuY3Rpb24gZHJhd0Nsb2NrKCkge1xuICAgIC8vIGNyZWF0ZSBhbGwgdGhlIGNsb2NrIGVsZW1lbnRzXG4gICAgdXBkYXRlRGF0YSgpOyAvL2RyYXcgdGhlbSBpbiB0aGUgY29ycmVjdCBzdGFydGluZyBwb3NpdGlvblxuICAgIGNvbnN0IGZhY2UgPSBzdmdcbiAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcImlkXCIsIFwiY2xvY2stZmFjZVwiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke1t3IC8gMiwgaCAvIDJdfSlgKTtcbiAgICAvLyBhZGQgbWFya3MgZm9yIHNlY29uZHNcbiAgICBmYWNlXG4gICAgICAuc2VsZWN0QWxsKFwiLnNlY29uZC10aWNrXCIpXG4gICAgICAuZGF0YShkMy5yYW5nZSgwLCAxMDApKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwic2Vjb25kLXRpY2tcIilcbiAgICAgIC5hdHRyKFwieDFcIiwgMClcbiAgICAgIC5hdHRyKFwieDJcIiwgMClcbiAgICAgIC5hdHRyKFwieTFcIiwgc2Vjb25kVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBzZWNvbmRUaWNrU3RhcnQgKyBzZWNvbmRUaWNrTGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7c3RvKGQpfSlgKTtcbiAgICAvLyBhbmQgbGFiZWxzLi4uXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5zZWNvbmQtbGFiZWxcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwMCwgNSkpXG4gICAgICAuZW50ZXIoKVxuICAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJzZWNvbmQtbGFiZWxcIilcbiAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgIC5hdHRyKFwieFwiLCBkID0+IHNlY29uZExhYmVsUmFkaXVzICogTWF0aC5zaW4oc3RvKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT5cbiAgICAgICAgICAtc2Vjb25kTGFiZWxSYWRpdXMgKiBNYXRoLmNvcyhzdG8oZCkgKiByYWRpYW5zKSArIHNlY29uZExhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICAvLyAuLi4gYW5kIGhvdXJzXG4gICAgZmFjZVxuICAgICAgLnNlbGVjdEFsbChcIi5ob3VyLXRpY2tcIilcbiAgICAgIC5kYXRhKGQzLnJhbmdlKDAsIDEwLCAxKSlcbiAgICAgIC5lbnRlcigpXG4gICAgICAuYXBwZW5kKFwibGluZVwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImhvdXItdGlja1wiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBob3VyVGlja1N0YXJ0KVxuICAgICAgLmF0dHIoXCJ5MlwiLCBob3VyVGlja1N0YXJ0ICsgaG91clRpY2tMZW5ndGgpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGByb3RhdGUoJHt0ZW4oZCl9KWApO1xuICAgIGZhY2VcbiAgICAgIC5zZWxlY3RBbGwoXCIuaG91ci1sYWJlbFwiKVxuICAgICAgLmRhdGEoZDMucmFuZ2UoMCwgMTAsIDEpKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwiaG91ci1sYWJlbFwiKVxuICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIGQgPT4gaG91ckxhYmVsUmFkaXVzICogTWF0aC5zaW4odGVuKGQpICogcmFkaWFucykpXG4gICAgICAuYXR0cihcbiAgICAgICAgXCJ5XCIsXG4gICAgICAgIGQgPT4gLWhvdXJMYWJlbFJhZGl1cyAqIE1hdGguY29zKHRlbihkKSAqIHJhZGlhbnMpICsgaG91ckxhYmVsWU9mZnNldFxuICAgICAgKVxuICAgICAgLnRleHQoZCA9PiBkKTtcbiAgICBjb25zdCBoYW5kcyA9IGZhY2UuYXBwZW5kKFwiZ1wiKS5hdHRyKFwiaWRcIiwgXCJjbG9jay1oYW5kc1wiKTtcbiAgICBoYW5kc1xuICAgICAgLnNlbGVjdEFsbChcImxpbmVcIilcbiAgICAgIC5kYXRhKGhhbmREYXRhKVxuICAgICAgLmVudGVyKClcbiAgICAgIC5hcHBlbmQoXCJsaW5lXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIGQgPT4gZC50eXBlICsgXCItaGFuZFwiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MVwiLCBkID0+IGQuYmFsYW5jZSB8fCAwKVxuICAgICAgLmF0dHIoXCJ4MlwiLCAwKVxuICAgICAgLmF0dHIoXCJ5MlwiLCBkID0+IGQubGVuZ3RoKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgcm90YXRlKCR7ZC5zY2FsZShkLnZhbHVlKX0pYCk7XG4gICAgZmFjZVxuICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgIC5hdHRyKFwiaWRcIiwgXCJmYWNlLW92ZXJsYXlcIilcbiAgICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJoYW5kcy1jb3ZlclwiKVxuICAgICAgLmF0dHIoXCJ4XCIsIDApXG4gICAgICAuYXR0cihcInlcIiwgMClcbiAgICAgIC5hdHRyKFwiclwiLCBjbG9ja1JhZGl1cyAvIDIwKTtcbiAgfVxuICBmdW5jdGlvbiBtb3ZlSGFuZHMoKSB7XG4gICAgY29uc3Qgc2VsID0gZDNcbiAgICAgIC5zZWxlY3QoXCIjY2xvY2staGFuZHMtZmluYWxcIilcbiAgICAgIC5zZWxlY3RBbGwoXCJsaW5lXCIpXG4gICAgICAuZGF0YShoYW5kRGF0YSlcbiAgICAgIC50cmFuc2l0aW9uKCk7XG4gICAgaWYgKGZhbmN5U2Vjb25kc09GRikgc2VsLmVhc2UoZDMuZWFzZUVsYXN0aWMucGVyaW9kKDAuNSkpO1xuICAgIHNlbC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHJvdGF0ZSgke2Quc2NhbGUoZC52YWx1ZSl9KWApO1xuICB9XG4gIGZ1bmN0aW9uIHVwZGF0ZURhdGEoKSB7XG4gICAgaGFuZERhdGFbMF0udmFsdWUgPSAhZmFuY3lTZWNvbmRzT0ZGID8gTWF0aC5mbG9vcihzZWxlY3RlZEV4YWN0TiAqIDEwKSA6IGRlY1RpbWVOWzBdO1xuICAgIGhhbmREYXRhWzFdLnZhbHVlID0gIWZhbmN5U2Vjb25kc09GRiA/IE1hdGguZmxvb3Ioc2VsZWN0ZWRFeGFjdE4gKiAxMCAlIDEgKiAxMDApIDogZGVjVGltZU4uc2xpY2UoMiwgNCk7XG4gICAgaGFuZERhdGFbMl0udmFsdWUgPSAhZmFuY3lTZWNvbmRzT0ZGID8gc2VsZWN0ZWRFeGFjdE4gKiAxMCAlIDEgKiAxMDAgJSAxICogMTAwIDogZGVjVGltZU4uc2xpY2UoNCwgNik7XG4gIH1cbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3LCBoXSlcbiAgICAuc3R5bGUoXCJtYXgtd2lkdGhcIiwgYCR7d2lkdGggLyAyLjF9cHhgKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJhbmFsb2djbG9ja1wiKVxuICAgIC5hdHRyKFwiaWRcIiwgXCJidG1jbG9ja1wiKTtcbiAgc3ZnXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAudGV4dChgLSR7ZGVjVGltZU59LSR7c2VsZWN0ZWRab25lfWApXG4gICAgLmF0dHIoXCJ4XCIsIGNsb2NrUmFkaXVzICsgbWFyZ2luKVxuICAgIC5hdHRyKFwieVwiLCBjbG9ja1JhZGl1cyAqIDIgKyBtYXJnaW4gKiAyLjEpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIDMyKVxuICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJtb25vc3BhY2VcIik7XG4gIGRyYXdDbG9jaygpO1xuICAvLyBBbmltYXRpb25cbiAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChcbiAgICAoKSA9PiB7XG4gICAgICB1cGRhdGVEYXRhKCk7XG4gICAgICBtb3ZlSGFuZHMoKTtcbiAgICB9LFxuICAgICFmYW5jeVNlY29uZHNPRkYgPyAxMCA6IDg2NFxuICApO1xuICBpbnZhbGlkYXRpb24udGhlbigoKSA9PiBjbGVhckludGVydmFsKGludGVydmFsKSk7XG4gIHJldHVybiBzdmcubm9kZSgpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaG1zID0gbmV3IERhdGUoKTtcbmhtcy5nZXRVVENIb3VycygpIC8gMjQgK1xuaG1zLmdldFVUQ01pbnV0ZXMoKSAvIDE0NDAgK1xuaG1zLmdldFVUQ1NlY29uZHMoKSAvIDg2NDAwICtcbmhtcy5nZXRVVENNaWxsaXNlY29uZHMoKSAvIDg2NGU1O1xuaG1zLmdldFRpbWUoKSAvIDg2NGU1ICUgMTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRzYSA9IERhdGUubm93KCkgLyA4NjRlNSAlIDEgKiA4NjQwMDtcbmhzYSA9IGRzYSAlIDM2MDA7XG5bZHNhIC8gMzYwMCwgaHNhIC8gNjAsIGhzYSAlIDYwXS5tYXAoTWF0aC5mbG9vcilcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBsZWFwU2Vjb25kWWVhciA9IElucHV0cy5yYW5nZShbMTk3MCwgMjAyMF0sIHtsYWJlbDogXCJZZWFyXCIsIHZhbHVlOiAxOTk1LCBzdGVwOiAxfSlcbnZpZXdvZiBsZWFwU2Vjb25kRGF0ZSA9IElucHV0cy5yYW5nZShbMCwgMzY1XSwge2xhYmVsOiBcIkRheVwiLCB2YWx1ZTogMTgyLCBzdGVwOiAxfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBobXNpbnB1dCA9IElucHV0cy5mb3JtKFtcbiAgSW5wdXRzLnJhbmdlKFswLCAyM10sIHtsYWJlbDogXCJIb3VyXCIsIHZhbHVlOiAxMSwgc3RlcDogMX0pLFxuICBJbnB1dHMucmFuZ2UoWzAsIDU5XSwge2xhYmVsOiBcIk1pbnV0ZVwiLCB2YWx1ZTogMCwgc3RlcDogMX0pLFxuICBJbnB1dHMucmFuZ2UoWzAsIDU5XSwge2xhYmVsOiBcIlNlY29uZFwiLCB2YWx1ZTogMCwgc3RlcDogMX0pLFxuXSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBkaWdpdHMgPSBJbnB1dHMucmFuZ2UoWzEsIDldLCB7bGFiZWw6IFwiRGlnaXRzXCIsIHZhbHVlOiAzLCBzdGVwOiAxfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AbWF0dGR6dWdhbi9wb3B1bGF0aW9uLWJ5LXRpbWUtem9uZS1jcmVhdGluZy1hLWRhdGFzZXRcbnZpZXdvZiBzb3J0UGFyYW1zID0gSW5wdXRzLmZvcm0oW1xuICBJbnB1dHMudG9nZ2xlKHsgbGFiZWw6IFwiU29ydCBhc2NlbmRpbmdcIiB9KSxcbiAgSW5wdXRzLnRvZ2dsZSh7IGxhYmVsOiBcIlNvcnQgYnkgb2Zmc2V0XCIgfSksXG4gIF0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BtYXR0ZHp1Z2FuL3BvcHVsYXRpb24tYnktdGltZS16b25lLWNyZWF0aW5nLWEtZGF0YXNldFxuUGxvdC5wbG90KHtcbiAgd2lkdGg6IHdpZHRoLFxuICBtYXJnaW5Cb3R0b206IDUwLFxuICBzdHlsZTogYG92ZXJmbG93OiB2aXNpYmxlO2ZvbnQtc2l6ZToxNnB4O2AsXG4gIGNvbG9yOiB7c2NoZW1lOiBcIlJkQnVcIiwgY2xhc3NOYW1lOiBcImJhclBsb3RMZWdlbmRcIn0sXG4gIG1hcmdpbkxlZnQ6IDc1LFxuICB5OiB7IGxhYmVsOiBudWxsIH0sXG4gIHg6IHsgZ3JpZDogdHJ1ZSwgbGFiZWw6IFwiUG9wdWxhdGlvbiAoYmlsbGlvbnMpXCIsIGxhYmVsT2Zmc2V0OiAzOCwgdHJhbnNmb3JtOiBkID0+IGQgLyAxZTkgfSxcbiAgbWFya3M6IFtcbiAgICBQbG90LmJhclgoc29ydGVkUG9wLCB7eDogXCJwb3BcIiwgeTogXCJTaWduXCIsIGZpbGw6IFwiT2Zmc2V0XCIsIHN0cm9rZTogXCJibGFja1wiLCB0aXA6IHRydWUgfSksXG4gIF1cbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnJhYygyNykuZGl2KDg2NDApLmFkZCgxLCAzMjApLnRvRnJhY3Rpb24oKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBvZmZzZXQgPSBJbnB1dHMucmFuZ2UoWy0xMCwgOV0sIHtsYWJlbDogXCJPZmZzZXRcIiwgdmFsdWU6IDAsIHN0ZXA6IDF9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBsb25nSW5wdXQgPSBJbnB1dHMucmFuZ2UoWzAsIDEwXSwge2xhYmVsOiBcIkxvbmdpdHVkZVwiLCB2YWx1ZTogNSwgc3RlcDogMC4wMX0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BtY21jY2x1ci9wbG90LWZvci1tYXRoZW1hdGljaWFuc1xue1xuICBsZXQgdyA9IDgwMDtcbiAgbGV0IGggPSAwLjYyNSAqIHc7XG4gIGxldCBzYW1wbGVzID0gYnVpbGRfc2FtcGxlcyhcbiAgICBnZXRFb3QsIC0zNjYsIDM2NSwgeyBOOiAxNTAgfVxuICApO1xuICBsZXQgcGxvdCA9IFBsb3QucGxvdCh7XG4gICAgbWFyZ2luTGVmdDogNjAsXG4gICAgd2lkdGg6IHcsXG4gICAgaGVpZ2h0OiBoLFxuICAgIHN0eWxlOiBcImZvbnQtc2l6ZToxOTtcIixcbiAgICB5OiB7bGFiZWw6IFwidGltZSB6b25lIG9mZnNldFwifSxcbiAgICB4OiB7bGFiZWw6IFwiZGF5IG9mIHllYXJcIn0sXG4gICAgbWFya3M6IFtcbiAgICAgIFBsb3QubGluZShzYW1wbGVzLCB7XG4gICAgICAgIHN0cm9rZVdpZHRoOiA0LFxuICAgICAgICBzdHJva2U6IFwic3RlZWxibHVlXCIsXG4gICAgICAgIHRpcDogdHJ1ZVxuICAgICAgfSksXG4gICAgICBQbG90LnJ1bGVYKFstMzY2XSksXG4gICAgICBQbG90LnJ1bGVZKFswXSksXG4gICAgICBQbG90LmF4aXNYKHsgeTogMCB9KSxcbiAgICAgIFBsb3QuYXhpc1koeyB4OiAtMzY2IH0pXG4gICAgXVxuICB9KTtcbiAgcmV0dXJuIHBsb3Q7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gdW5peDJkb3RlKHVuaXgsIHpvbmUsIG9mZnNldCA9IDcxOTQ2OCkge1xuICByZXR1cm4gWyh1bml4ID8/IERhdGUubm93KCkpIC8gODY0MDAwMDAgKyAoXG4gICAgem9uZSA9IHpvbmUgPz8gLU1hdGgucm91bmQoXG4gICAgICAobmV3IERhdGUpLmdldFRpbWV6b25lT2Zmc2V0KCkgLyAxNDQpXG4gICAgKSAvIDEwICsgb2Zmc2V0LCB6b25lXVxufVxuZnVuY3Rpb24gdW5peDJkb3RlMSh1bml4LCB6b25lLCBvZmZzZXQgPSA3MTk0NjgpIHtcbiAgcmV0dXJuIFtcbiAgICAodW5peCA/PyBEYXRlLm5vdygpKSAvIDg2NDAwMDAwXG4gICAgKyAoem9uZSA9IHpvbmUgPz8gKDEwIC0gTWF0aC5yb3VuZChcbiAgICAgICAgKG5ldyBEYXRlKS5nZXRUaW1lem9uZU9mZnNldCgpIC8gMTQ0KSkgJSAxMFxuICAgICAgKSAvIDEwICsgb2Zmc2V0LCB6b25lXVxufVxuZnVuY3Rpb24gZG90ZTJkYXRlKGRvdGUsIHpvbmUgPSAwKSB7XG4gIGNvbnN0IGNvdGUgPSBNYXRoLmZsb29yKChcbiAgICAgIGRvdGUgPj0gMCA/IGRvdGVcbiAgICAgIDogZG90ZSAtIDE0NjA5NlxuICAgICkgLyAxNDYwOTcpLFxuICBkb3RjID0gZG90ZSAtIGNvdGUgKiAxNDYwOTcsXG4gIHlvdGMgPSBNYXRoLmZsb29yKChkb3RjXG4gICAgLSBNYXRoLmZsb29yKGRvdGMgLyAxNDYwKVxuICAgICsgTWF0aC5mbG9vcihkb3RjIC8gMzY1MjQpXG4gICAgLSBNYXRoLmZsb29yKGRvdGMgLyAxNDYwOTYpXG4gICkgLyAzNjUpO1xuICByZXR1cm4gW1xuICAgIHlvdGMgKyBjb3RlICogNDAwLFxuICAgIGRvdGMgLSAoeW90YyAqIDM2NVxuICAgICAgKyBNYXRoLmZsb29yKHlvdGMgLyA0KVxuICAgICAgLSBNYXRoLmZsb29yKHlvdGMgLyAxMDApXG4gICksIHpvbmVdfVxuZnVuY3Rpb24gZ2V0RW90KGRheSkge1xuICBjb25zdCBnYW1tYSA9IDIgKiBNYXRoLlBJICogZGF5IC8gMzY1XG4gICAgcmV0dXJuIChcbiAgICAgIDEuNDk1MDQyNDVlLTUgK1xuICAgICAgLTQuMTg5ODczM2UtMiAqIE1hdGguY29zKGdhbW1hKSArXG4gICAgICAtMi45MjM3MDM2ZS0yICogTWF0aC5zaW4oZ2FtbWEpICtcbiAgICAgIC00LjU2OTQzODBlLTIgKiBNYXRoLmNvcygyICogZ2FtbWEpICtcbiAgICAgIDUuMTc1NjAxNzVlLTIgKiBNYXRoLnNpbigyICogZ2FtbWEpXG4gICAgKVxufVxuZHogPSB1bml4MmRvdGUobm93KVxuZGVjWWVhciA9IHlkelswXS50b1N0cmluZygpLnBhZFN0YXJ0KDQsIFwiMFwiKVxuemVyb0RvdGUgPSB1bml4MmRvdGUobm93LCAwKVswXVxuemVyb1RpbWUgPSB6ZXJvRG90ZSAlIDFcbnplcm9EYXRlID0gZG90ZTJkYXRlKHplcm9Eb3RlKVxuemVyb1llYXIgPSB6ZXJvRGF0ZVswXVxuemVyb1lkYSA9IHplcm9EYXRlWzFdXG56ZXJvRG95ID0gTWF0aC5mbG9vcih6ZXJvWWRhKVxuemVyb0lzTGVhcCA9IGlzTGVhcFllYXIoemVyb1llYXIpXG56ZXJvWWRhSHNsID0gdGV4dGNvbG9yKHplcm9ZZGEudG9GaXhlZCg1KSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoemVyb1lkYSAvICgzNjUgKyB6ZXJvSXNMZWFwKSkpLmZvcm1hdEhleCgpKVxuemVyb1RpbWVIc2wwID0gdGV4dGNvbG9yKHplcm9UaW1lLnRvRml4ZWQoNSkuc2xpY2UoMSksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHplcm9UaW1lKSkuZm9ybWF0SGV4KCkpXG56ZXJvVGltZUhzbDEgPSB0ZXh0Y29sb3IoemVyb1RpbWUudG9GaXhlZCg1KS5zbGljZSgxKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoemVyb1RpbWUpKS5mb3JtYXRIZXgoKSlcbnplcm9UaW1lSHNsMiA9IHRleHRjb2xvcigoemVyb1RpbWUgKiAxMCkudG9GaXhlZCg0KSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoemVyb1RpbWUpKS5mb3JtYXRIZXgoKSlcbnplcm9UaW1lSHNsMyA9IHRleHRjb2xvcigoemVyb1RpbWUgKiAxMCkudG9GaXhlZCg0KSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoemVyb1RpbWUpKS5mb3JtYXRIZXgoKSlcbnplcm9UaW1lSHNsNCA9IHRleHRjb2xvcigoemVyb1RpbWUgKiAxMCkudG9GaXhlZCg0KSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoemVyb1RpbWUpKS5mb3JtYXRIZXgoKSlcbnplcm9Eb3R5SHNsID0gdGV4dGNvbG9yKHplcm9Eb3kudG9TdHJpbmcoKS5wYWRTdGFydCgzLCBcIjBcIiksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHplcm9Eb3kgLyAoMzY1ICsgemVyb0lzTGVhcCkpKS5mb3JtYXRIZXgoKSlcbnplcm9Eb3RlSHNsID0gdGV4dGNvbG9yKHplcm9Eb3RlLnRvRml4ZWQoNSksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHplcm9Eb3RlICUgMSkpLmZvcm1hdEhleCgpKVxuemVyb1llYXJIc2wgPSB0ZXh0Y29sb3IoemVyb1llYXIsIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHplcm9ZZWFyICUgMTAwMCAvIDEwMDApKS5mb3JtYXRIZXgoKSlcbmJyb3dzZXJEb3RlID0gdW5peDJkb3RlKG5vdylcbmJyb3dzZXJUaW1lID0gYnJvd3NlckRvdGVbMF0gJSAxICogMTBcbmJyb3dzZXJab25lID0gYnJvd3NlckRvdGVbMV1cbmJyb3dzZXJTaWduID0gYnJvd3NlclpvbmUgPiAwID8gXCItXCIgOiBcIitcIlxuem9uZTB0aW1lID0gKGJyb3dzZXJUaW1lIC0gYnJvd3NlclpvbmUgKyAxMCkgJSAxMFxuaG91cnMgPSBicm93c2VyVGltZSAqIDIuNFxubWludXRlcyA9IGhvdXJzICUgMSAqIDYwXG5zZWNvbmRzID0gbWludXRlcyAlIDEgKiA2MFxuc2VsZWN0ZWREb3RlID0gdW5peDJkb3RlKG5vdywgbG9uZzJ6b25lKGxvY2F0aW9uWzBdKSlcbnNlbGVjdGVkRXhhY3QgPSBzZWxlY3RlZERvdGVbMF0gJSAxXG5zZWxlY3RlZEV4YWN0TiA9ICgxIC0gc2VsZWN0ZWRFeGFjdCkgJSAxXG5zZWxlY3RlZFpvbmUgPSBzZWxlY3RlZERvdGVbMV1cbnlkeiA9IGRvdGUyZGF0ZSguLi5zZWxlY3RlZERvdGUpXG5kZWNEYXRlID0gTWF0aC5mbG9vcih5ZHpbMV0pXG5kZWNUaW1lID0gKHNlbGVjdGVkRXhhY3QgKiAxMCkudG9GaXhlZCg0KVxuZGVjVGltZU4gPSAoc2VsZWN0ZWRFeGFjdE4gKiAxMCkudG9GaXhlZCg0KVxuYmFyREQgPSBkZWNUaW1lWzBdXG5iYXJERE4gPSBkZWNUaW1lTlswXVxuYmFyTWlscyA9IGRlY1RpbWUuc2xpY2UoMiwgNClcbmJhck1pbHNOID0gZGVjVGltZU4uc2xpY2UoMiwgNClcbmJhckJlYXRzID0gZGVjVGltZS5zbGljZSg0LCA2KVxuYmFyQmVhdHNOID0gZGVjVGltZU4uc2xpY2UoNCwgNilcbmZ1bmN0aW9uIGxhdGkydHVybihkZWdyZWVzID0gLTE4MCwgZSA9IDMpIHtcbiAgLy8gdHVybnM6IGU9MCwgZGVjaXR1cm5zOiBlPTEsIGV0Yy5cbiAgcmV0dXJuIChkZWdyZWVzICU9IDM2MCkgLyAoMzYwIC8gMTAqKmUpICUgMTAqKmU7XG59XG5ncmF0aWN1bGUgPSBkMy5nZW9HcmF0aWN1bGUoKS5zdGVwTWlub3IoWzM2LDM2XSkuc3RlcE1ham9yKFszNiwzNl0pKClcbmdyYXRpY3VsZS5jb29yZGluYXRlcyA9IGdyYXRpY3VsZS5jb29yZGluYXRlcy5tYXAoXG4gIGkgPT4gaS5tYXAoaiA9PiBqLm1hcCgoaywgaW5kZXgsIGFycikgPT4gaS5sZW5ndGggPT09IDMgJiYgaW5kZXggPT09IDAgPyBrIC0gMTggOiBrKSlcbilcbmZ1bmN0aW9uIGxvbmcydHVybihkZWdyZWVzID0gLTE4MCwgZSA9IDMpIHtcbiAgLy8gdHVybnM6IGU9MCwgZGVjaXR1cm5zOiBlPTEsIGV0Yy5cbiAgcmV0dXJuICgoKGRlZ3JlZXMgJT0gMzYwKSA8IDAgPyBkZWdyZWVzICsgMzYwIDogZGVncmVlcykgKyAxOCkgLyAoMzYwIC8gMTAqKmUpICUgMTAqKmU7XG59XG4vLyBodHRwczovL2dpdGh1Yi5jb20vdG9wb2pzb24vd29ybGQtYXRsYXNcbndvcmxkID0gZDMuanNvbihcImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vd29ybGQtYXRsYXNAMi9jb3VudHJpZXMtMTEwbS5qc29uXCIpXG5jb3VudHJpZXMgPSB0b3BvanNvbi5mZWF0dXJlKHdvcmxkLCB3b3JsZC5vYmplY3RzLmNvdW50cmllcylcbnRvcG9qc29uID0gcmVxdWlyZShcInRvcG9qc29uLWNsaWVudEAzXCIpXG5mdW5jdGlvbiBsb25nMnpvbmUoZGVncmVlcyA9IC0xODApIHtcbiAgcmV0dXJuIE1hdGguZmxvb3IobG9uZzJ0dXJuKGRlZ3JlZXMsIDEpKTtcbn1cbmZ1bmN0aW9uIHllYXIybGVhcCh5ZWFyID0gMTk3MCkge1xuICAgIHJldHVybiB5ZWFyICUgNCA9PSAwICYmIHllYXIgJSAxMDAgIT0gMCB8fCB5ZWFyICUgNDAwID09IDA7XG59XG4vLyBodHRwczovL29ic2VydmFibGVocS5jb20vQGRicmlkZ2VzL3Zpc3VhbGl6aW5nLXNlYXNvbmFsLWRheWxpZ2h0XG5zb2xhclN5c3RlbSA9IChyb290LCB2aXp3aWR0aCwgbG9jYXRpb24sIGRhdGUsIGhvdXIsIGRhcmttb2RlKSA9PiB7XG4gIGNvbnN0IGVhcnRoUmFkaXVzID0gMC4wNjUgKiB2aXp3aWR0aDtcbiAgLy8gY29uc3Qgc3VuUmFkaXVzID0gMC4wMTUgKiB2aXp3aWR0aDtcbiAgY29uc3Qgc29sYXJTeXN0ZW1SYWRpdXMgPSB2aXp3aWR0aCAvIDIgLSAodml6d2lkdGggPCA1MDAgPyA0IDogMjApO1xuICBjb25zdCBzdHJldGNoID0gMC4wNjtcbiAgY29uc3Qgc29sYXJBbmdsZSA9IGdldFNvbGFyQW5nbGUoZGF0ZSk7XG4gIGNvbnN0IHNvbGFyQW5nbGVEZWcgPSAoc29sYXJBbmdsZSAqIDE4MCkgLyBNYXRoLlBJO1xuICBjb25zdCB4ID0gc29sYXJTeXN0ZW1SYWRpdXMgKiBNYXRoLnNpbihzb2xhckFuZ2xlKTtcbiAgY29uc3QgeSA9IHN0cmV0Y2ggKiBzb2xhclN5c3RlbVJhZGl1cyAqIE1hdGguY29zKHNvbGFyQW5nbGUpO1xuICBjb25zdCBzcGluID0gMTgwICsgLWxvY2F0aW9uWzBdICsgc29sYXJBbmdsZURlZyArIDM2MCAqICgoaG91ciArIDEyKSAvIDI0KTtcbiAgY29uc3QgZWFydGhHZW8gPSB7IHR5cGU6IFwiU3BoZXJlXCIgfTtcbiAgY29uc3QgcHJvamVjdGlvbiA9IGQzXG4gICAgLmdlb09ydGhvZ3JhcGhpYygpXG4gICAgLmZpdFdpZHRoKGVhcnRoUmFkaXVzICogMiwgZWFydGhHZW8pXG4gICAgLnJvdGF0ZShbc3BpbiwgMCwgMjMuNV0pXG4gICAgLnRyYW5zbGF0ZShbMCwgMF0pO1xuICBjb25zdCBzdGF0aWNQcm9qZWN0aW9uID0gZDNcbiAgICAuZ2VvT3J0aG9ncmFwaGljKClcbiAgICAuZml0V2lkdGgoZWFydGhSYWRpdXMgKiAyLCBlYXJ0aEdlbylcbiAgICAucm90YXRlKFtzb2xhckFuZ2xlRGVnIC0gOTAsIDBdKVxuICAgIC50cmFuc2xhdGUoWzAsIDBdKTtcbiAgY29uc3QgcGF0aCA9IGQzLmdlb1BhdGgocHJvamVjdGlvbikucG9pbnRSYWRpdXMoMS41KTtcbiAgY29uc3Qgc3RhdGljUGF0aCA9IGQzLmdlb1BhdGgoc3RhdGljUHJvamVjdGlvbik7XG4gIGNvbnN0IG9jZWFuQ29sb3IgPSBkYXJrbW9kZSA/IFwiIzAwN0ZGRlwiIDogbWFwY29sb3JzLm9jZWFuO1xuICBjb25zdCBsYW5kQ29sb3IgPSBkYXJrbW9kZSA/IFwiIzA4MDhcIiA6IG1hcGNvbG9ycy5sYW5kO1xuICBjb25zdCBib3JkZXJDb2xvciA9IGRhcmttb2RlID8gXCIjZWVlXCIgOiBcIiMzMzNcIjtcbiAgY29uc3Qgc29sYXJTeXN0ZW0gPSByb290XG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7dml6d2lkdGggLyAyfSlgKTtcbiAgLy8gc29sYXJTeXN0ZW0uYXBwZW5kKFwiY2lyY2xlXCIpLmF0dHIoXCJyXCIsIHN1blJhZGl1cykuYXR0cihcImZpbGxcIiwgY29sb3JzLnN1bik7XG4gIC8qIERyYXcgb3JiaXQgKi9cbiAgICBzb2xhclN5c3RlbVxuICAgICAgLmFwcGVuZChcImVsbGlwc2VcIilcbiAgICAgIC5hdHRyKFwicnhcIiwgc29sYXJTeXN0ZW1SYWRpdXMpXG4gICAgICAuYXR0cihcInJ5XCIsIHN0cmV0Y2ggKiBzb2xhclN5c3RlbVJhZGl1cylcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcbiAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIFwiMS4yNVwiKVxuICAgICAgLmF0dHIoXCJzdHJva2VcIiwgXCJibGFja1wiKTtcbiAgICAvKiBEcmF3IG1vbnRoIHRpY2tzICovXG4gICAgZDMucmFuZ2UoMTIpLm1hcCgobSkgPT4ge1xuICAgICAgY29uc3QgZCA9IG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgbSwgMSk7XG4gICAgICBjb25zdCBhbmdsZSA9IGdldFNvbGFyQW5nbGUoZCk7XG4gICAgICBzb2xhclN5c3RlbVxuICAgICAgICAuYXBwZW5kKFwibGluZVwiKVxuICAgICAgICAuYXR0cihcIngxXCIsIChzb2xhclN5c3RlbVJhZGl1cyArIDkpICogTWF0aC5zaW4oYW5nbGUpKVxuICAgICAgICAuYXR0cihcInkxXCIsIChzb2xhclN5c3RlbVJhZGl1cyArIDkpICogc3RyZXRjaCAqIE1hdGguY29zKGFuZ2xlKSlcbiAgICAgICAgLmF0dHIoXCJ4MlwiLCAoc29sYXJTeXN0ZW1SYWRpdXMgLSA5KSAqIE1hdGguc2luKGFuZ2xlKSlcbiAgICAgICAgLmF0dHIoXCJ5MlwiLCAoc29sYXJTeXN0ZW1SYWRpdXMgLSA5KSAqIHN0cmV0Y2ggKiBNYXRoLmNvcyhhbmdsZSkpXG4gICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIFwiMS43NVwiKVxuICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBcImJsYWNrXCIpO1xuICAgICAgY29uc3Qgc3RhcnRNb250aEFuZ2xlID0gZ2V0U29sYXJBbmdsZShuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIG0sIDEpKTtcbiAgICAgIHNvbGFyU3lzdGVtXG4gICAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgIC50ZXh0KGRhdGUyZG90eShkKSlcbiAgICAgICAgLmF0dHIoXCJ4XCIsIChzb2xhclN5c3RlbVJhZGl1cyArIDE4IC0gd2lkdGggLyA1MCkgKiBNYXRoLnNpbihzdGFydE1vbnRoQW5nbGUpICogMS4xKVxuICAgICAgICAuYXR0cihcbiAgICAgICAgICBcInlcIixcbiAgICAgICAgICAoc29sYXJTeXN0ZW1SYWRpdXMgKyAyIC0gd2lkdGggLyAzKSAqIDYuMiAqIHN0cmV0Y2ggKiBNYXRoLmNvcyhzdGFydE1vbnRoQW5nbGUpICsgTWF0aC5zaWduKE1hdGguY29zKHN0YXJ0TW9udGhBbmdsZSkpICogMTJcbiAgICAgICAgKVxuICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgICAgIC5hdHRyKFwiZG9taW5hbnQtYmFzZWxpbmVcIiwgXCJtaWRkbGVcIilcbiAgICAgICAgLmF0dHIoXCJmb250LXNpemVcIiwgZm9udFNpemUgKiAod2lkdGggPCAzMDAgPyAuOSA6IHdpZHRoIDwgNDAwID8gLjk1IDogd2lkdGggPCA1MDAgPyAxIDogd2lkdGggPCA2MDAgPyAxLjA1IDogd2lkdGggPCA3MDAgPyAxLjEgOiAxLjIpICsgd2lkdGggLyAxMDApXG4gICAgICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJzYW5zLXNlcmlmXCIpXG4gICAgICAgIC5hdHRyKFwiZmlsbFwiLCBcImJsYWNrXCIpO1xuICAgIH0pO1xuICAgIGNvbnN0IGVhcnRoID0gc29sYXJTeXN0ZW1cbiAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7eH0sICR7eX0pYCk7XG4gICAgZnVuY3Rpb24gZHJhd0VhcnRoKCkge1xuICAgICAgZWFydGguYXBwZW5kKFwibGluZVwiKS5hdHRyKFwieTFcIiwgLTEuNSAqIGVhcnRoUmFkaXVzKS5hdHRyKFwieTJcIiwgMS41ICogZWFydGhSYWRpdXMpLmF0dHIoXCJzdHJva2VcIiwgXCJibHVlXCIpLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHJvdGF0ZSgtMjMuNSlgKTtcbiAgICAgIGVhcnRoLmFwcGVuZChcInBhdGhcIikuYXR0cihcImRcIiwgcGF0aChlYXJ0aEdlbykpLmF0dHIoXCJmaWxsXCIsIGRhcmttb2RlID8gXCIjMDA3RkZGXCIgOiBtYXBjb2xvcnMub2NlYW4pLmF0dHIoXCJpZFwiLCBcImdsb2JlT2NlYW5cIik7XG4gICAgICBlYXJ0aC5hcHBlbmQoXCJwYXRoXCIpLmF0dHIoXCJkXCIsIHBhdGgobGFuZCkpLmF0dHIoXCJmaWxsXCIsIGRhcmttb2RlID8gXCIjMDgwOFwiIDogbWFwY29sb3JzLmxhbmQpLmF0dHIoXCJpZFwiLCBcImdsb2JlTGFuZFwiKTtcbiAgICAgIGVhcnRoLmFwcGVuZChcInBhdGhcIikuYXR0cihcImRcIiwgcGF0aChjb3VudHJpZXMpKS5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIFwiLjA4XCIpLmF0dHIoXCJmaWxsXCIsIFwibm9uZVwiKS5hdHRyKFwic3Ryb2tlXCIsIGRhcmttb2RlID8gXCIjZWVlXCIgOiBcIiMzMzNcIikuYXR0cihcImlkXCIsIFwiZ2xvYmVCb3JkZXJzXCIpO1xuICAgICAgcGF0aC5wb2ludFJhZGl1cyg1LjUpO1xuICAgICAgZWFydGguYXBwZW5kKFwicGF0aFwiKS5hdHRyKFwiZFwiLCBwYXRoKHsgdHlwZTogXCJQb2ludFwiLCBjb29yZGluYXRlczogbG9jYXRpb24gfSkpLmF0dHIoXCJmaWxsXCIsIFwibm9uZVwiKS5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIC42KS5hdHRyKFwic3Ryb2tlXCIsIFwiYmxhY2tcIik7XG4gICAgICBwYXRoLnBvaW50UmFkaXVzKDQuNSk7XG4gICAgICBlYXJ0aC5hcHBlbmQoXCJwYXRoXCIpLmF0dHIoXCJkXCIsIHBhdGgoeyB0eXBlOiBcIlBvaW50XCIsIGNvb3JkaW5hdGVzOiBsb2NhdGlvbiB9KSkuYXR0cihcImZpbGxcIiwgXCJub25lXCIpLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMi4yNSkuYXR0cihcInN0cm9rZVwiLCBcInJlZFwiKTtcbiAgfVxuICBkcmF3RWFydGgoKTtcbn1cbmZ1bmN0aW9uIGdyZWcyZG90eShtb250aCA9IDEsIGRheSA9IDEpIHtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihcbiAgICAgICAgKDE1MyAqIChtb250aCA+IDIgPyBtb250aCAtIDMgOiBtb250aCArIDkpICsgMikgLyA1ICsgZGF5IC0gMVxuKX1cbmZ1bmN0aW9uIGRhdGUyZG90eShkYXRlKSB7XG4gIHJldHVybiBncmVnMmRvdHkoZGF0ZS5nZXRNb250aCgpICsgMSwgZGF0ZS5nZXREYXRlKCkpXG59XG5mdW5jdGlvbiBkYXRlMmRvdHkxKGRhdGUpIHtcbiAgcmV0dXJuIGdyZWcyZG90eShkYXRlLmdldE1vbnRoKCkgKyAxLCBkYXRlLmdldERhdGUoKSlcbn1cbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZGJyaWRnZXMvdmlzdWFsaXppbmctc2Vhc29uYWwtZGF5bGlnaHRcbi8vIGdsb2JlID0gKHJvb3QsIHsgdml6d2lkdGgsIGxvY2F0aW9uLCBkYXRlLCBob3VyIH0pID0+IHtcbi8vICAgY29uc3Qgc29sYXJBbmdsZSA9IGdldFNvbGFyQW5nbGUoZGF0ZSk7XG4vLyAgIGNvbnN0IHNvbGFyQW5nbGVEZWcgPSB0b0RlZ3JlZXMoc29sYXJBbmdsZSk7XG4vLyAgIGNvbnN0IGhvdXJTcGluID0gMzYwICogKChob3VyICsgMTIpIC8gMjQpO1xuLy8gICBjb25zdCBzcGluID0gKDE4MCArIC1sb2NhdGlvblswXSArIHNvbGFyQW5nbGVEZWcgKyBob3VyU3Bpbik7XG4vLyAgIGNvbnN0IHRpbHQgPSAtMTU7XG4vLyAgIGNvbnN0IHByb2plY3Rpb24gPSBkMy5nZW9PcnRob2dyYXBoaWMoKVxuLy8gICAgICAgICAgICAgICAgICAgICAgICAuZml0V2lkdGgodml6d2lkdGgsIGdyYXRpY3VsZSlcbi8vICAgICAgICAgICAgICAgICAgICAgICAgLnJvdGF0ZShbc3BpbiwgdGlsdCwgMjMuNV0pO1xuLy8gICBjb25zdCBwYXRoID0gZDMuZ2VvUGF0aChwcm9qZWN0aW9uKTtcbi8vICAgY29uc3QgdW5DbGlwcGVkUHJvamVjdGlvbiA9IGQzLmdlb09ydGhvZ3JhcGhpYygpXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGlwQW5nbGUobnVsbClcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpdFdpZHRoKHZpendpZHRoLCBncmF0aWN1bGUpXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yb3RhdGUoW3NwaW4sIHRpbHQsIDIzLjVdKTtcbi8vICAgY29uc3QgdW5DbGlwcGVkUGF0aCA9IGQzLmdlb1BhdGgodW5DbGlwcGVkUHJvamVjdGlvbik7XG4vLyAgIGNvbnN0IHN0YXRpY1Byb2plY3Rpb24gPSBkMy5nZW9PcnRob2dyYXBoaWMoKVxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZml0V2lkdGgodml6d2lkdGgsIGdyYXRpY3VsZSlcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJvdGF0ZShbc29sYXJBbmdsZURlZyAtIDkwLCB0aWx0XSk7XG4vLyAgIGNvbnN0IHN0YXRpY1BhdGggPSBkMy5nZW9QYXRoKHN0YXRpY1Byb2plY3Rpb24pO1xuLy8gICBjb25zdCBiYWNrZ3JvdW5kID0gcm9vdC5hcHBlbmQoXCJnXCIpO1xuLy8gICBjb25zdCBlYXJ0aCA9IHJvb3QuYXBwZW5kKFwiZ1wiKS5zdHlsZShcIm9wYWNpdHlcIiwgMC43NSk7XG4vLyAgIGNvbnN0IGZvcmVncm91bmQgPSByb290LmFwcGVuZChcImdcIik7XG4vLyAgIGVhcnRoLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgcGF0aCh7dHlwZTogXCJTcGhlcmVcIn0pKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBtYXBjb2xvcnMub2NlYW4pXG4vLyAgICAgLmF0dHIoXCJzdHJva2VcIiwgXCIjOWVjYmRhXCIpO1xuLy8gICBlYXJ0aC5hcHBlbmQoXCJwYXRoXCIpXG4vLyAgICAgLmF0dHIoXCJkXCIsIHBhdGgobGFuZCkpXG4vLyAgICAgLmF0dHIoXCJmaWxsXCIsIG1hcGNvbG9ycy5sYW5kKTtcbi8vICAgZWFydGguYXBwZW5kKFwicGF0aFwiKVxuLy8gICAgIC5hdHRyKFwiZFwiLCBwYXRoKGNvdW50cmllcykpXG4vLyAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgXCIxXCIpXG4vLyAgICAgLmF0dHIoXCJmaWxsXCIsIFwibm9uZVwiKVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiIzAwMFwiKTtcbi8vICAgYmFja2dyb3VuZC5hcHBlbmQoXCJwYXRoXCIpXG4vLyAgICAgLmF0dHIoXCJkXCIsIHVuQ2xpcHBlZFBhdGgoe3R5cGU6IFwiUG9pbnRcIiwgY29vcmRpbmF0ZXM6IGxvY2F0aW9ufSkpXG4vLyAgICAgLmF0dHIoXCJmaWxsXCIsIFwicmVkXCIpO1xuLy8gICBjb25zdCBsYXRpdHVkZUNvb3JkcyA9IChsYXRpdHVkZSwgc3RhcnQsIGVuZCkgPT4ge1xuLy8gICAgIGNvbnN0IGxvbmdpdHVkZXMgPSBkMy5yYW5nZShzdGFydCwgZW5kLCAyKS5jb25jYXQoZW5kKTtcbi8vICAgICByZXR1cm4gbG9uZ2l0dWRlcy5tYXAoZCA9PiBbZCwgbGF0aXR1ZGVdKTtcbi8vICAgfVxuLy8gICBjb25zdCBjb3JyZWN0U3BpbiA9IGQzLmdlb1JvdGF0aW9uKFstaG91clNwaW4sIDBdKTtcbi8vICAgY29uc3QgY29ycmVjdFRpbHQgPSBkMy5nZW9Sb3RhdGlvbihbNiwgMCwgMF0pO1xuLy8gICAvKiB0b3RhbCBhbmd1bGFyIGV4dGVudCBvZiBkYXkvbmlnaHQgKi9cbi8vICAgY29uc3QgZGF5RXh0ZW50ID0gMzYwICogZGF5TGVuZ3RoKGRhdGUsIGxvY2F0aW9uWzFdKSAvIDI0O1xuLy8gICBjb25zdCBuaWdodEV4dGVudCA9IDM2MCAtIGRheUV4dGVudDtcbi8vICAgY29uc3QgZGF5TGluZSA9IHtcbi8vICAgICB0eXBlOiBcIkxpbmVTdHJpbmdcIixcbi8vICAgICBjb29yZGluYXRlczogbGF0aXR1ZGVDb29yZHMobG9jYXRpb25bMV0sXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uWzBdIC0gZGF5RXh0ZW50IC8gMixcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25bMF0gKyBkYXlFeHRlbnQgLyAyKS5tYXAoZCA9PiBjb3JyZWN0U3BpbihkKSlcbi8vICAgfTtcbi8vICAgY29uc3QgbmlnaHRMaW5lID0ge1xuLy8gICAgIHR5cGU6IFwiTGluZVN0cmluZ1wiLFxuLy8gICAgIGNvb3JkaW5hdGVzOiBsYXRpdHVkZUNvb3Jkcyhsb2NhdGlvblsxXSxcbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25bMF0gLSBkYXlFeHRlbnQgLyAyIC0gbmlnaHRFeHRlbnQsXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uWzBdIC0gZGF5RXh0ZW50IC8gMikubWFwKGQgPT4gY29ycmVjdFNwaW4oZCkpXG4vLyAgIH07XG4vLyAgIGJhY2tncm91bmQuYXBwZW5kKFwicGF0aFwiKVxuLy8gICAgIC5hdHRyKFwiZFwiLCB1bkNsaXBwZWRQYXRoKGRheUxpbmUpKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcbi8vICAgICAuYXR0cihcInN0cm9rZVwiLCBtYXBjb2xvcnMuZGF5KVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDMpO1xuLy8gICBiYWNrZ3JvdW5kLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgdW5DbGlwcGVkUGF0aChuaWdodExpbmUpKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcbi8vICAgICAuYXR0cihcInN0cm9rZVwiLCBtYXBjb2xvcnMubmlnaHQpXG4vLyAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMyk7XG4vLyAgIGZvcmVncm91bmQuYXBwZW5kKFwicGF0aFwiKVxuLy8gICAgIC5hdHRyKFwiZFwiLCBwYXRoKGRheUxpbmUpKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcbi8vICAgICAuYXR0cihcInN0cm9rZVwiLCBtYXBjb2xvcnMuZGF5KVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDMpO1xuLy8gICBmb3JlZ3JvdW5kLmFwcGVuZChcInBhdGhcIilcbi8vICAgICAuYXR0cihcImRcIiwgcGF0aChuaWdodExpbmUpKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcbi8vICAgICAuYXR0cihcInN0cm9rZVwiLCBtYXBjb2xvcnMubmlnaHQpXG4vLyAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMyk7XG4vLyAgIGZvcmVncm91bmQuYXBwZW5kKFwicGF0aFwiKVxuLy8gICAgIC5hdHRyKFwiZFwiLCBwYXRoKHt0eXBlOiBcIlBvaW50XCIsIGNvb3JkaW5hdGVzOiBsb2NhdGlvbn0pKVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIC41KVxuLy8gICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiYmxhY2tcIilcbi8vICAgICAuYXR0cihcImZpbGxcIiwgXCJyZWRcIik7XG4vLyAgIGNvbnN0IHNoYWRvd1BvbHlnb24gPSBbWzAsIC05MF0sIFswLCAwXSwgWzAsIDkwXSwgWzE4MCwgMF0sIFswLCAtOTBdXS5tYXAoZCA9PiBjb3JyZWN0VGlsdChkKSk7XG4vLyAgIGZvcmVncm91bmQuYXBwZW5kKFwicGF0aFwiKVxuLy8gICAgIC5hdHRyKFwiZFwiLCBzdGF0aWNQYXRoKHt0eXBlOiBcIlBvbHlnb25cIiwgY29vcmRpbmF0ZXM6IFtzaGFkb3dQb2x5Z29uXX0pKVxuLy8gICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwgMCwgMCwgMC4yNSlcIik7XG4vLyB9XG5kYXlPZlllYXIgPSAoZGF0ZSkgPT4ge1xuICBjb25zdCB5ZWFyU3RhcnQgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIDAsIDErNjApO1xuICByZXR1cm4gTWF0aC5mbG9vcigoZGF0ZS5nZXRUaW1lKCkgLSB5ZWFyU3RhcnQuZ2V0VGltZSgpKS84NjQwMDAwMCkgKyAxXG59XG4vLyBodHRwczovL29ic2VydmFibGVocS5jb20vQGRicmlkZ2VzL3Zpc3VhbGl6aW5nLXNlYXNvbmFsLWRheWxpZ2h0XG5kYXlsaWdodFBsb3QgPSAoXG4gIHJvb3QsXG4gIHsgdml6d2lkdGgsIGhlaWdodCwgeWVhciwgbGF0aXR1ZGUsIGRlZmF1bHREYXRlLCBkZWZhdWx0SG91ciB9XG4pID0+IHtcbiAgY29uc3QgbWFyZ2luID0geyB0b3A6IDMyLCBib3R0b206IDMyLCBsZWZ0OiAzMiwgcmlnaHQ6IDAgfTtcbiAgY29uc3QgY2hhcnRXaWR0aCA9IHZpendpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQ7XG4gIGNvbnN0IGNoYXJ0SGVpZ2h0ID0gaGVpZ2h0IC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b207XG4gIGNvbnN0IHlUaWNrVmFsdWVzID1cbiAgICB3aWR0aCA+IDM4MCA/IFszLCA2LCA5LCAxMiwgMTUsIDE4LCAyMV0gOiB3aWR0aCA+IDkwID8gWzYsIDEyLCAxOF0gOiBbMTJdO1xuICBjb25zdCB5U2NhbGUgPSBkM1xuICAgIC5zY2FsZUxpbmVhcigpXG4gICAgLmRvbWFpbihbMCwgMjRdKVxuICAgIC5yYW5nZShbbWFyZ2luLmxlZnQsIG1hcmdpbi5sZWZ0ICsgY2hhcnRXaWR0aF0pXG4gICAgLmNsYW1wKHRydWUpO1xuICAvLyB5LWF4aXMgc2NhbGVcbiAgY29uc3QgeFNjYWxlID0gZDNcbiAgICAuc2NhbGVUaW1lKClcbiAgICAuZG9tYWluKFtuZXcgRGF0ZSh5ZWFyLCAwLCA2MSksIG5ldyBEYXRlKHllYXIsIDExLCA5MSldKVxuICAgIC5yYW5nZShbbWFyZ2luLnRvcCwgbWFyZ2luLnRvcCArIGNoYXJ0SGVpZ2h0XSlcbiAgICAuY2xhbXAodHJ1ZSk7XG4gIC8vIHktYXhpcyBsYWJlbHNcbiAgY29uc3QgeEF4aXMgPSBkM1xuICAgIC5heGlzQm90dG9tKHhTY2FsZSlcbiAgICAudGlja1ZhbHVlcyhkMy50aW1lTW9udGgucmFuZ2UobmV3IERhdGUoeWVhciwgMCwgNjApLCBuZXcgRGF0ZSh5ZWFyLCAxMiwgNTcpKSlcbiAgICAudGlja1NpemUoY2hhcnRXaWR0aClcbiAgICAudGlja0Zvcm1hdChkYXRlMmRvdHkxKTtcbiAgY29uc3QgeUF4aXMgPSBkM1xuICAgIC5heGlzTGVmdCh5U2NhbGUpXG4gICAgLnRpY2tWYWx1ZXMoeVRpY2tWYWx1ZXMpXG4gICAgLnRpY2tTaXplKGNoYXJ0SGVpZ2h0KVxuICAgIC50aWNrRm9ybWF0KChkKSA9PiB7IHJldHVybiBgJHtkIC8gLjAyNH1gIH0pO1xuICBsZXQgZGF0ZSA9IGRlZmF1bHREYXRlIHx8IG5ldyBEYXRlKCk7XG4gIGxldCBob3VyID0gZGVmYXVsdEhvdXIgIT0gbnVsbCA/IGRlZmF1bHRIb3VyIDogZGF0ZS5nZXRIb3VycygpO1xuICBjb25zdCBoYW5kbGVNb3VzZU1vdmUgPSAoZSkgPT4ge307XG4gIHJvb3RcbiAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgIC5hdHRyKFwieVwiLCBtYXJnaW4ubGVmdClcbiAgICAuYXR0cihcInhcIiwgbWFyZ2luLnRvcClcbiAgICAuYXR0cihcImhlaWdodFwiLCBjaGFydFdpZHRoKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgY2hhcnRIZWlnaHQpXG4gICAgLmF0dHIoXCJyeVwiLCAwLjA1ICogdml6d2lkdGgpXG4gICAgLmF0dHIoXCJmaWxsXCIsIG1hcGNvbG9ycy5uaWdodCk7XG4gIHJvb3RcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoMCwgJHttYXJnaW4udG9wfSlgKVxuICAgIC5jYWxsKHhBeGlzKVxuICAgIC5jYWxsKChnKSA9PiBnLnNlbGVjdChcIi5kb21haW5cIikucmVtb3ZlKCkpXG4gICAgLmNhbGwoKGcpID0+IGcuc2VsZWN0QWxsKFwiLnRpY2tcIikuYXR0cihcImNvbG9yXCIsIG1hcGNvbG9ycy5ncmlkKSlcbiAgICAuY2FsbCgoZykgPT4gZy5zZWxlY3RBbGwoXCIudGljayB0ZXh0XCIpLmF0dHIoXCJmb250LXNpemVcIiwgKHdpZHRoIDwgMzAwID8gLjcgOiB3aWR0aCA8IDMyNSA/IC43MjUgOiB3aWR0aCA8IDM1MCA/IC43NSA6IHdpZHRoIDwgMzc1ID8gLjggOiB3aWR0aCA8IDQwMCA/IC45IDogd2lkdGggPCA0NTAgPyAuOTUgOiB3aWR0aCA8IDUwMCA/IDEgOiB3aWR0aCA8IDYwMCA/IDEuMiA6IHdpZHRoIDwgNzAwID8gMS4zIDogMS40KSAqIGZvbnRTaXplKSlcbiAgICAuY2FsbCgoZykgPT4gZy5zZWxlY3RBbGwoXCIudGljayB0ZXh0XCIpLmF0dHIoXCJjb2xvclwiLCBcImJsYWNrXCIpKVxuICAgIC5jYWxsKChnKSA9PiBnLnNlbGVjdEFsbChcIi50aWNrIGxpbmVcIikuYXR0cihcInN0cm9rZS1kYXNoYXJyYXlcIiwgXCI1IDNcIikpO1xuICByb290XG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bWFyZ2luLmxlZnQgKyBjaGFydEhlaWdodH0sIDApYClcbiAgICAuY2FsbCh5QXhpcylcbiAgICAuY2FsbCgoZykgPT4gZy5zZWxlY3QoXCIuZG9tYWluXCIpLnJlbW92ZSgpKVxuICAgIC5jYWxsKChnKSA9PiBnLnNlbGVjdEFsbChcIi50aWNrXCIpLmF0dHIoXCJjb2xvclwiLCBtYXBjb2xvcnMuZ3JpZCkpXG4gICAgLmNhbGwoKGcpID0+IGcuc2VsZWN0QWxsKFwiLnRpY2sgdGV4dFwiKS5hdHRyKFwiZm9udC1zaXplXCIsICh3aWR0aCA8IDQwMCA/IC45IDogd2lkdGggPCA1MDAgPyAxIDogd2lkdGggPCA2MDAgPyAxLjEgOiB3aWR0aCA8IDcwMCA/IDEuMiA6IDEuMykgKiBmb250U2l6ZSkpXG4gICAgLmNhbGwoKGcpID0+IGcuc2VsZWN0QWxsKFwiLnRpY2sgdGV4dFwiKS5hdHRyKFwiY29sb3JcIiwgXCJibGFja1wiKSlcbiAgICAuY2FsbCgoZykgPT4gZy5zZWxlY3RBbGwoXCIudGljayBsaW5lXCIpLmF0dHIoXCJzdHJva2UtZGFzaGFycmF5XCIsIFwiNSAzXCIpKTtcbiAgcm9vdFxuICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLnRleHQoXCJUaW1lIG9mIGRheVwiKVxuICAgIC5hdHRyKFwieFwiLCBtYXJnaW4uYm90dG9tICsgKHdpZHRoIDwgMjc1ID8gLTEwMiA6IHdpZHRoIDwgMzAwID8gLTEwNiA6IHdpZHRoIDwgMzI1ID8gLTEwOCA6IHdpZHRoIDwgMzUwID8gLTExNSA6IHdpZHRoIDwgMzc1ID8gLTEyMCA6IHdpZHRoIDwgNDAwID8gLTEyOCA6IHdpZHRoIDwgNDI1ID8gLTEzMCA6IHdpZHRoIDwgNDUwID8gLTEzMiA6IHdpZHRoIDwgNDc1ID8gLTEzNiA6IHdpZHRoIDwgNTAwID8gLTE0MSA6IHdpZHRoIDwgNTI1ID8gLTE0MiA6IHdpZHRoIDwgNTUwID8gLTE0OCA6IHdpZHRoIDwgNTc1ID8gLTE0OSA6IHdpZHRoIDwgNjAwID8gLTE1NCA6IHdpZHRoIDwgNjUwID8gLTE1NyA6IHdpZHRoIDwgNjc1ID8gLTE1NyA6IHdpZHRoIDwgNzAwID8gLTE2MSA6IHdpZHRoIDwgNzI1ID8gLTE2MCA6IHdpZHRoIDwgNzUwID8gLTE2NSA6IHdpZHRoIDwgNzc1ID8gLTE2OSA6IC0xNzMpKVxuICAgIC5hdHRyKFwieVwiLCBtYXJnaW4udG9wIC0gKHdpZHRoIDwgNDAwID8gMzMgOiB3aWR0aCA8IDUwMCA/IDM1IDogd2lkdGggPCA2MDAgPyAzNyA6IHdpZHRoIDwgNzAwID8gNDAgOiA0MikpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIGZvbnRTaXplICogKHdpZHRoIDwgMzAwID8gLjggOiB3aWR0aCA8IDQwMCA/IC45IDogd2lkdGggPCA1MDAgPyAxIDogd2lkdGggPCA2MDAgPyAxLjEgOiB3aWR0aCA8IDcwMCA/IDEuMiA6IDEuMjUpICsgd2lkdGggLyAxMDApXG4gICAgLmF0dHIoXCJmb250LWZhbWlseVwiLCBcInNhbnMtc2VyaWZcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInJvdGF0ZSgtOTApXCIpXG4gICAgLmF0dHIoXCJmaWxsXCIsIFwiYmxhY2tcIik7XG4gIHJvb3RcbiAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgIC50ZXh0KFwiRGF5IG9mIHllYXJcIilcbiAgICAuYXR0cihcInhcIiwgbWFyZ2luLmxlZnQgKyB3aWR0aCAvIDIgLSAod2lkdGggPCA1MDAgPyAzMCA6IHdpZHRoIDwgNjAwID8gMjggOiB3aWR0aCA8IDcwMCA/IDI0IDogMjIpKVxuICAgIC5hdHRyKFwieVwiLCBtYXJnaW4udG9wICsgY2hhcnRIZWlnaHQgLyA0ICsgbWFyZ2luLmJvdHRvbSArICh3aWR0aCA8IDI3NSA/IDEwIDogd2lkdGggPCAzMDAgPyAxOCA6IHdpZHRoIDwgMzI1ID8gMTkgOiB3aWR0aCA8IDM1MCA/IDIyIDogd2lkdGggPCAzNzUgPyAzMCA6IHdpZHRoIDwgNDAwID8gMzcgOiB3aWR0aCA8IDQ1MCA/IDM5IDogd2lkdGggPCA0NzUgPyA0MCA6IHdpZHRoIDwgNTAwID8gNDQgOiB3aWR0aCA8IDU1MCA/IDUwIDogd2lkdGggPCA2MDAgPyA1MSA6IHdpZHRoIDwgNjUwID8gNTAgOiB3aWR0aCA8IDcwMCA/IDQ0IDogd2lkdGggPCA3NTAgPyA0MCA6IDQzKSlcbiAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgLmF0dHIoXCJmb250LXNpemVcIiwgZm9udFNpemUgKiAod2lkdGggPCAzMDAgPyAuOTUgOiB3aWR0aCA8IDQwMCA/IDEgOiB3aWR0aCA8IDUwMCA/IDEuMDUgOiB3aWR0aCA8IDYwMCA/IDEuMTUgOiB3aWR0aCA8IDcwMCA/IDEuMiA6IDEuMjUpICsgd2lkdGggLyAxMDApXG4gICAgLmF0dHIoXCJmb250LWZhbWlseVwiLCBcInNhbnMtc2VyaWZcIilcbiAgICAuYXR0cihcImZpbGxcIiwgXCJibGFja1wiKTtcbiAgY29uc3QgZGF0YSA9IHllYXJEYXRlcyh5ZWFyKVxuICAgIC5tYXAoKGQpID0+IFtkLCBkYXlMZW5ndGgoZCwgbGF0aXR1ZGUpXSlcbiAgICAuZmlsdGVyKChbXywgZF0pID0+IGQgPiAwKTtcbiAgLyogUmVuZGVyIHNlcGFyYXRlIHBvbHlnb25zIGZvciBlYWNoIGNvbnRpbnVvdXMgc2VxdWVuY2Ugb2ZcbiAgICogZGF5cyB3aXRoIG1vcmUgdGhhbiAwIGhvdXJzIG9mIGRheSBsaWdodFxuICAgKi9cbiAgY29uc3QgcG9seXMgPSBbXTtcbiAgbGV0IGN1cnJlbnRQb2x5ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gZGF0YVtpXVswXTtcbiAgICBjb25zdCBwcmV2RGF0ZSA9IChkYXRhW2kgLSAxXSB8fCBbXSlbMF07XG4gICAgaWYgKFxuICAgICAgaSA9PT0gMCB8fFxuICAgICAgY3VycmVudERhdGUuZ2V0VGltZSgpIC0gcHJldkRhdGUuZ2V0VGltZSgpIDwgMzYwMCAqIDI0ICogMTAwMCAqIDEuNVxuICAgICkge1xuICAgICAgY3VycmVudFBvbHkucHVzaChkYXRhW2ldKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcG9seXMucHVzaChjdXJyZW50UG9seSk7XG4gICAgICBjdXJyZW50UG9seSA9IFtkYXRhW2ldXTtcbiAgICB9XG4gIH1cbiAgcG9seXMucHVzaChjdXJyZW50UG9seSk7XG4gIHBvbHlzLmZvckVhY2goKHApID0+IHtcbiAgICBjb25zdCBwb2ludHMgPSBbXG4gICAgICAuLi5wLm1hcCgoW2QsIGxdKSA9PiBgJHt4U2NhbGUoZCl9LCR7eVNjYWxlKDEyIC0gbCAvIDIpfWApLFxuICAgICAgLi4ucC5yZXZlcnNlKCkubWFwKChbZCwgbF0pID0+IGAke3hTY2FsZShkKX0sJHt5U2NhbGUoMTIgKyBsIC8gMil9YClcbiAgICBdLmpvaW4oXCIgXCIpO1xuICAgIHJvb3QuYXBwZW5kKFwicG9seWdvblwiKS5hdHRyKFwicG9pbnRzXCIsIHBvaW50cykuYXR0cihcImZpbGxcIiwgbWFwY29sb3JzLmRheSk7XG4gIH0pO1xuICAvKiBMZWdlbmQgKi9cbiAgY29uc3QgbGVnZW5kID0gcm9vdFxuICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0ICsgY2hhcnRXaWR0aCAvIDIgLSA2NH0pYCk7XG4gIGxlZ2VuZFxuICAgIC5hcHBlbmQoXCJyZWN0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIHdpZHRoIDwgMzAwID8gNjMgOiB3aWR0aCA8IDUwMCA/IDYyIDogd2lkdGggPCA2MDAgPyA2MSA6IDYwKVxuICAgIC5hdHRyKFwieVwiLCB3aWR0aCA8IDQ1MCA/IDggOiAxKVxuICAgIC5hdHRyKFwicnhcIiwgNSlcbiAgICAuYXR0cihcIndpZHRoXCIsIGZvbnRTaXplICogKHdpZHRoIDwgMzAwID8gLjk1IDogd2lkdGggPCA0MDAgPyAxIDogd2lkdGggPCA1MDAgPyAxLjA1IDogd2lkdGggPCA2MDAgPyAxLjE1IDogd2lkdGggPCA3MDAgPyAxLjIgOiAxLjI1KSArIHdpZHRoIC8gMTAwKVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGZvbnRTaXplICogKHdpZHRoIDwgMzAwID8gLjk1IDogd2lkdGggPCA0MDAgPyAxIDogd2lkdGggPCA1MDAgPyAxLjA1IDogd2lkdGggPCA2MDAgPyAxLjE1IDogd2lkdGggPCA3MDAgPyAxLjIgOiAxLjI1KSArIHdpZHRoIC8gMTAwKVxuICAgIC5hdHRyKFwiZmlsbFwiLCBtYXBjb2xvcnMuZGF5KTtcbiAgbGVnZW5kXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAuYXR0cihcInhcIiwgd2lkdGggPCA0MDAgPyA4MiA6IHdpZHRoIDwgNTAwID8gODUgOiB3aWR0aCA8IDYwMCA/IDg3IDogOTApXG4gICAgLmF0dHIoXCJ5XCIsIHdpZHRoIDwgMzAwID8gMjIgOiB3aWR0aCA8IDQwMCA/IDIzIDogd2lkdGggPCA0NTAgPyAyNCA6IHdpZHRoIDwgNTAwID8gMTggOiB3aWR0aCA8IDYwMCA/IDIwIDogd2lkdGggPCA3MDAgPyAyMSA6IDIzKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIGZvbnRTaXplICogKHdpZHRoIDwgMzAwID8gLjk1IDogd2lkdGggPCA0MDAgPyAxIDogd2lkdGggPCA1MDAgPyAxLjA1IDogd2lkdGggPCA2MDAgPyAxLjE1IDogd2lkdGggPCA3MDAgPyAxLjIgOiAxLjI1KSArIHdpZHRoIC8gMTAwKVxuICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJzYW5zLXNlcmlmXCIpXG4gICAgLnRleHQoXCJEYXlcIik7XG4gIGxlZ2VuZFxuICAgIC5hcHBlbmQoXCJyZWN0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIHdpZHRoIDwgNDAwID8gLTEwIDogd2lkdGggPCA1MDAgPyAtMjAgOiB3aWR0aCA8IDYwMCA/IC00MCA6IC0zOSlcbiAgICAuYXR0cihcInlcIiwgd2lkdGggPCA0NTAgPyA4IDogMSlcbiAgICAuYXR0cihcInJ4XCIsIDUpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCBmb250U2l6ZSAqICh3aWR0aCA8IDMwMCA/IC45NSA6IHdpZHRoIDwgNDAwID8gMSA6IHdpZHRoIDwgNTAwID8gMS4wNSA6IHdpZHRoIDwgNjAwID8gMS4xNSA6IHdpZHRoIDwgNzAwID8gMS4yIDogMS4yNSkgKyB3aWR0aCAvIDEwMClcbiAgICAuYXR0cihcImhlaWdodFwiLCBmb250U2l6ZSAqICh3aWR0aCA8IDMwMCA/IC45NSA6IHdpZHRoIDwgNDAwID8gMSA6IHdpZHRoIDwgNTAwID8gMS4wNSA6IHdpZHRoIDwgNjAwID8gMS4xNSA6IHdpZHRoIDwgNzAwID8gMS4yIDogMS4yNSkgKyB3aWR0aCAvIDEwMClcbiAgICAuYXR0cihcImZpbGxcIiwgbWFwY29sb3JzLm5pZ2h0KTtcbiAgbGVnZW5kXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAuYXR0cihcInhcIiwgd2lkdGggPCA0MDAgPyAxMSA6IHdpZHRoIDwgNTAwID8gNCA6IHdpZHRoIDwgNjAwID8gLTEyIDogLTkpXG4gICAgLmF0dHIoXCJ5XCIsIHdpZHRoIDwgMzAwID8gMjIgOiB3aWR0aCA8IDQwMCA/IDIzIDogd2lkdGggPCA0NTAgPyAyNCA6IHdpZHRoIDwgNTAwID8gMTggOiB3aWR0aCA8IDYwMCA/IDE5IDogd2lkdGggPCA3MDAgPyAyMSA6IDIzKVxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIGZvbnRTaXplICogKHdpZHRoIDwgMzAwID8gLjk1IDogd2lkdGggPCA0MDAgPyAxIDogd2lkdGggPCA1MDAgPyAxLjA1IDogd2lkdGggPCA2MDAgPyAxLjE1IDogd2lkdGggPCA3MDAgPyAxLjIgOiAxLjI1KSArIHdpZHRoIC8gMTAwKVxuICAgIC5hdHRyKFwiZm9udC1mYW1pbHlcIiwgXCJzYW5zLXNlcmlmXCIpXG4gICAgLnRleHQoXCJOaWdodFwiKTtcbiAgLyogVGltZSBhbmQgZGF0ZSBjb250cm9scyAqL1xuICBjb25zdCBkYXRlTGluZSA9IHJvb3QuYXBwZW5kKFwiZ1wiKTtcbiAgY29uc3QgdXBkYXRlQ29udHJvbFBvc2l0aW9ucyA9ICgpID0+IHtcbiAgICBkYXRlTGluZVxuICAgICAgLnNlbGVjdChcImxpbmVcIilcbiAgICAgIC5hdHRyKFwieTFcIiwgeVNjYWxlKDApKVxuICAgICAgLmF0dHIoXCJ4MVwiLCB4U2NhbGUoZGF0ZSkpXG4gICAgICAuYXR0cihcInkyXCIsIHlTY2FsZSgyNCkpXG4gICAgICAuYXR0cihcIngyXCIsIHhTY2FsZShkYXRlKSk7XG4gICAgZGF0ZUxpbmVcbiAgICAgIC5zZWxlY3QoXCJyZWN0XCIpXG4gICAgICAuYXR0cihcInlcIiwgeVNjYWxlKDApKVxuICAgICAgLmF0dHIoXCJ4XCIsIHhTY2FsZShkYXRlKSAtIDQpO1xuICAgIHJvb3RcbiAgICAgIC5zZWxlY3QoXCIjdGltZS1jb250cm9sXCIpXG4gICAgICAuYXR0cihcImN5XCIsIHlTY2FsZShob3VyKSlcbiAgICAgIC5hdHRyKFwiY3hcIiwgeFNjYWxlKGRhdGUpKTtcbiAgfTtcbiAgY29uc3QgZGlzcGF0Y2hEYXRlSG91ckNoYW5nZSA9ICgpID0+IHtcbiAgICBjb25zdCBkZXRhaWwgPSB7IGRhdGUsIGhvdXIgfTtcbiAgICBjb25zdCBjaGFuZ2VFdmVudCA9IG5ldyBDdXN0b21FdmVudChFdmVudFR5cGUuRGF0ZUhvdXJDaGFuZ2UsIHtcbiAgICAgIGRldGFpbCxcbiAgICAgIGJ1YmJsZXM6IHRydWVcbiAgICB9KTtcbiAgICByb290Lm5vZGUoKS5kaXNwYXRjaEV2ZW50KGNoYW5nZUV2ZW50KTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlRGF0ZUxpbmVEcmFnID0gKHsgeCB9KSA9PiB7XG4gICAgZGF0ZSA9IHhTY2FsZS5pbnZlcnQoeCk7XG4gICAgdXBkYXRlQ29udHJvbFBvc2l0aW9ucygpO1xuICAgIGRpc3BhdGNoRGF0ZUhvdXJDaGFuZ2UoKTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlVGltZUNpcmNsZURyYWcgPSAoeyB5IH0pID0+IHtcbiAgICBob3VyID0geVNjYWxlLmludmVydCh5KTtcbiAgICB1cGRhdGVDb250cm9sUG9zaXRpb25zKCk7XG4gICAgZGlzcGF0Y2hEYXRlSG91ckNoYW5nZSgpO1xuICB9O1xuICBkYXRlTGluZS5hcHBlbmQoXCJsaW5lXCIpLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgNCkuYXR0cihcInN0cm9rZVwiLCBcInJlZFwiKTtcbiAgZGF0ZUxpbmVcbiAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGNoYXJ0V2lkdGgpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCA4KVxuICAgIC5hdHRyKFwiZmlsbFwiLCBcInJnYmEoMCwgMCwgMCwgMClcIilcbiAgICAuc3R5bGUoXCJjdXJzb3JcIiwgXCJyb3ctcmVzaXplXCIpXG4gICAgLmNhbGwoZDMuZHJhZygpLm9uKFwiZHJhZ1wiLCBoYW5kbGVEYXRlTGluZURyYWcpKTtcbiAgcm9vdFxuICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAuYXR0cihcImlkXCIsIFwidGltZS1jb250cm9sXCIpXG4gICAgLmF0dHIoXCJyXCIsIDEyKVxuICAgIC5hdHRyKFwiZmlsbFwiLCBcInJlZFwiKVxuICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIC42KVxuICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiYmxhY2tcIilcbiAgICAuc3R5bGUoXCJjdXJzb3JcIiwgXCJwb2ludGVyXCIpXG4gICAgLmNhbGwoZDMuZHJhZygpLm9uKFwiZHJhZ1wiLCBoYW5kbGVUaW1lQ2lyY2xlRHJhZykpO1xuICB1cGRhdGVDb250cm9sUG9zaXRpb25zKCk7XG59XG5mb250U2l6ZSA9IDE0O1xuZ2V0U29sYXJBbmdsZSA9IChkYXRlKSA9PiAoZGF5T2ZZZWFyKGRhdGUpICsgMTApIC8gMzY1ICogTWF0aC5QSSAqIDIgLSBNYXRoLlBJIC8gMjtcbi8qXG4gKiBGb3JtdWxhcyB1c2VzIHRoZSBDQk0gbW9kZWwgYXMgcmV2aWV3ZWQgaGVyZTpcbiAqIGh0dHBzOi8vd3d3LmlraGViZWVudnJhYWcuYmUvbWVkaWFzdG9yYWdlL0ZTRG9jdW1lbnQvMTcxL0ZvcnN5dGhlKy0rQSttb2RlbCtjb21wYXJpc29uK2ZvcitkYXlsZW5ndGgrYXMrYStmdW5jdGlvbitvZitsYXRpdHVkZSthbmQrZGF5K29mK3llYXIrLSsxOTk1LnBkZlxuICovXG5kYXlMZW5ndGggPSAoZGF0ZSwgbGF0aXR1ZGUpID0+IHtcbiAgY29uc3QgeWVhclN0YXJ0ID0gbmV3IERhdGUoZGF0ZS5nZXRGdWxsWWVhcigpLCAwLCAxKTtcbiAgY29uc3QgZGF5T2ZZZWFyID0gTWF0aC5mbG9vcigoZGF0ZS5nZXRUaW1lKCkgLSB5ZWFyU3RhcnQuZ2V0VGltZSgpKS84NjQwMDAwMCkgKyAxO1xuICBjb25zdCByZXZBbmdsZSA9IDAuMjE2MzEwOCArIDIgKiBNYXRoLmF0YW4oMC45NjcxMzk2ICogTWF0aC50YW4oMC4wMDg2MCAqIChkYXlPZlllYXIgLSAxODYpKSk7XG4gIGNvbnN0IGRlY0FuZ2xlID0gTWF0aC5hc2luKDAuMzk3OTUgKiBNYXRoLmNvcyhyZXZBbmdsZSkpO1xuICAvKiBkYXlsaWdodCBjb2VmZmljaWVudCBzZWxlY3RlZCBmb3IgYXBwYXJlbnQgc3VucmlzZS9zdW5zZXQgKi9cbiAgY29uc3QgcCA9IDAuODMzM1xuICBjb25zdCBpbnRSZXN1bHQgPVxuICAgIChNYXRoLnNpbigocCAqIE1hdGguUEkpIC8gMTgwKSArXG4gICAgICBNYXRoLnNpbigobGF0aXR1ZGUgKiBNYXRoLlBJKSAvIDE4MCkgKiBNYXRoLnNpbihkZWNBbmdsZSkpIC9cbiAgICAoTWF0aC5jb3MoKGxhdGl0dWRlICogTWF0aC5QSSkgLyAxODApICogTWF0aC5jb3MoZGVjQW5nbGUpKTtcbiAgaWYgKGludFJlc3VsdCA+PSAxKSByZXR1cm4gMjQ7XG4gIGlmIChpbnRSZXN1bHQgPD0gLTEpIHJldHVybiAwO1xuICByZXR1cm4gMjQgLSAyNCAqIE1hdGguYWNvcyhpbnRSZXN1bHQpIC8gTWF0aC5QSTtcbn1cbnllYXJEYXRlcyA9ICh5ZWFyKSA9PiB7XG4gIGNvbnN0IHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKHllYXIsIDAsIDErNjApO1xuICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUoeWVhciArIDEsIDAsIDErNjApO1xuICByZXR1cm4gZDMudGltZURheS5yYW5nZShzdGFydERhdGUsIGVuZERhdGUpO1xufVxuaGVpZ2h0ID0gMC42NSAqIHdpZHRoO1xuRXZlbnRUeXBlID0gKHtcbiAgTG9jYXRpb25DaGFuZ2U6IFwiTE9DQVRJT05fQ0hBTkdFXCIsXG4gIERhdGVIb3VyQ2hhbmdlOiBcIkRBVEVfSE9VUl9DSEFOR0VcIlxufSlcbm1hcGNvbG9ycyA9ICh7XG4gIG5pZ2h0OiBcIiM3MTlmYjZcIixcbiAgZGF5OiBcIiNmZmU0MzhcIixcbiAgZ3JpZDogXCIjNGI2YTc5XCIsXG4gIG9jZWFuOiBcIiNhZGVlZmZcIixcbiAgbGFuZDogXCIjOTBmZjc4ODhcIixcbiAgc3VuOiBcIiNmZmI0MzhcIlxufSlcbnRvUmFkaWFucyA9ICh2YWwpID0+IHZhbCAqIE1hdGguUEkgLyAxODBcbnRvRGVncmVlcyA9ICh2YWwpID0+IHZhbCAqIDE4MCAvIE1hdGguUEk7XG5sYW5kID0gdG9wb2pzb24uZmVhdHVyZSh3b3JsZCwgd29ybGQub2JqZWN0cy5sYW5kKTtcbmQzID0gcmVxdWlyZShcImQzQDdcIiwgXCJkMy1nZW8tcHJvamVjdGlvbkAzXCIpXG5mdW5jdGlvbiBpbnB1dChjb25maWcpIHtcbiAgbGV0IHtcbiAgICBmb3JtLFxuICAgIHR5cGUgPSBcInRleHRcIixcbiAgICBhdHRyaWJ1dGVzID0ge30sXG4gICAgYWN0aW9uLFxuICAgIGdldFZhbHVlLFxuICAgIHRpdGxlLFxuICAgIGRlc2NyaXB0aW9uLFxuICAgIGZvcm1hdCxcbiAgICBkaXNwbGF5LFxuICAgIHN1Ym1pdCxcbiAgICBvcHRpb25zXG4gIH0gPSBjb25maWc7XG4gIGNvbnN0IHdyYXBwZXIgPSBodG1sYDxkaXY+PC9kaXY+YDtcbiAgaWYgKCFmb3JtKVxuICAgIGZvcm0gPSBodG1sYDxmb3JtPlxuICA8aW5wdXQgbmFtZT1pbnB1dCB0eXBlPSR7dHlwZX0gLz5cbiAgPC9mb3JtPmA7XG4gIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICBjb25zdCB2YWwgPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgaWYgKHZhbCAhPSBudWxsKSBmb3JtLmlucHV0LnNldEF0dHJpYnV0ZShrZXksIHZhbCk7XG4gIH0pO1xuICBpZiAoc3VibWl0KVxuICAgIGZvcm0uYXBwZW5kKFxuICAgICAgaHRtbGA8aW5wdXQgbmFtZT1zdWJtaXQgdHlwZT1zdWJtaXQgc3R5bGU9XCJtYXJnaW46IDAgMC43NWVtXCIgdmFsdWU9XCIke1xuICAgICAgICB0eXBlb2Ygc3VibWl0ID09IFwic3RyaW5nXCIgPyBzdWJtaXQgOiBcIlN1Ym1pdFwiXG4gICAgICB9XCIgLz5gXG4gICAgKTtcbiAgZm9ybS5hcHBlbmQoXG4gICAgaHRtbGA8b3V0cHV0IG5hbWU9b3V0cHV0IHN0eWxlPVwiZm9udDogMTRweCBNZW5sbywgQ29uc29sYXMsIG1vbm9zcGFjZTsgbWFyZ2luLWxlZnQ6IDAuMWVtOyB0ZXh0LWFsaWduOmNlbnRlcjtcIj48L291dHB1dD5gXG4gICk7XG4gIGlmICh0aXRsZSlcbiAgICBmb3JtLnByZXBlbmQoXG4gICAgICBodG1sYDxkaXYgc3R5bGU9XCJmb250OiA3MDAgMC45cmVtIHNhbnMtc2VyaWY7IG1hcmdpbi1ib3R0b206IDNweDtcIj4ke3RpdGxlfTwvZGl2PmBcbiAgICApO1xuICBpZiAoZGVzY3JpcHRpb24pXG4gICAgZm9ybS5hcHBlbmQoXG4gICAgICBodG1sYDxkaXYgc3R5bGU9XCJmb250LXNpemU6IDAuODVyZW07IGZvbnQtc3R5bGU6IGl0YWxpYzsgbWFyZ2luLXRvcDogM3B4O1wiPiR7ZGVzY3JpcHRpb259PC9kaXY+YFxuICAgICk7XG4gIGlmIChmb3JtYXQpXG4gICAgZm9ybWF0ID0gdHlwZW9mIGZvcm1hdCA9PT0gXCJmdW5jdGlvblwiID8gZm9ybWF0IDogZDNmb3JtYXQuZm9ybWF0KGZvcm1hdCk7XG4gIGlmIChhY3Rpb24pIHtcbiAgICBhY3Rpb24oZm9ybSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgdmVyYiA9IHN1Ym1pdFxuICAgICAgPyBcIm9uc3VibWl0XCJcbiAgICAgIDogdHlwZSA9PSBcImJ1dHRvblwiXG4gICAgICA/IFwib25jbGlja1wiXG4gICAgICA6IHR5cGUgPT0gXCJjaGVja2JveFwiIHx8IHR5cGUgPT0gXCJyYWRpb1wiXG4gICAgICA/IFwib25jaGFuZ2VcIlxuICAgICAgOiBcIm9uaW5wdXRcIjtcbiAgICBmb3JtW3ZlcmJdID0gZSA9PiB7XG4gICAgICBlICYmIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGNvbnN0IHZhbHVlID0gZ2V0VmFsdWUgPyBnZXRWYWx1ZShmb3JtLmlucHV0KSA6IGZvcm0uaW5wdXQudmFsdWU7XG4gICAgICBpZiAoZm9ybS5vdXRwdXQpIHtcbiAgICAgICAgY29uc3Qgb3V0ID0gZGlzcGxheSA/IGRpc3BsYXkodmFsdWUpIDogZm9ybWF0ID8gZm9ybWF0KHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICBpZiAob3V0IGluc3RhbmNlb2Ygd2luZG93LkVsZW1lbnQpIHtcbiAgICAgICAgICB3aGlsZSAoZm9ybS5vdXRwdXQuaGFzQ2hpbGROb2RlcygpKSB7XG4gICAgICAgICAgICBmb3JtLm91dHB1dC5yZW1vdmVDaGlsZChmb3JtLm91dHB1dC5sYXN0Q2hpbGQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmb3JtLm91dHB1dC5hcHBlbmQob3V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3JtLm91dHB1dC52YWx1ZSA9IG91dDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9ybS52YWx1ZSA9IHZhbHVlO1xuICAgICAgaWYgKHZlcmIgIT09IFwib25pbnB1dFwiKVxuICAgICAgICBmb3JtLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIiwgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgICB9O1xuICAgIGlmICh2ZXJiICE9PSBcIm9uaW5wdXRcIilcbiAgICAgIHdyYXBwZXIub25pbnB1dCA9IGUgPT4gZSAmJiBlLnN0b3BQcm9wYWdhdGlvbigpICYmIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBpZiAodmVyYiAhPT0gXCJvbnN1Ym1pdFwiKSBmb3JtLm9uc3VibWl0ID0gZSA9PiBlICYmIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBmb3JtW3ZlcmJdKCk7XG4gIH1cbiAgd2hpbGUgKGZvcm0uY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGZvcm0uY2hpbGROb2Rlc1swXSk7XG4gIH1cbiAgZm9ybS5hcHBlbmQod3JhcHBlcik7XG4gIHJldHVybiBmb3JtO1xufVxuZDNmb3JtYXQgPSByZXF1aXJlKFwiZDMtZm9ybWF0QDFcIilcbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZW5qYWxvdC9kcmFnZ2FibGUtd29ybGQtbWFwLWNvb3JkaW5hdGVzLWlucHV0XG5mdW5jdGlvbiB3b3JsZE1hcENvb3JkaW5hdGVzKGNvbmZpZyA9IHt9LCBkaW1lbnNpb25zKSB7XG4gIGNvbnN0IHtcbiAgICB2YWx1ZSA9IFtdLCB0aXRsZSwgZGVzY3JpcHRpb24sIHdpZHRoID0gZGltZW5zaW9uc1swXVxuICB9ID0gQXJyYXkuaXNBcnJheShjb25maWcpID8ge3ZhbHVlOiBjb25maWd9IDogY29uZmlnO1xuICBjb25zdCBoZWlnaHQgPSBkaW1lbnNpb25zWzFdO1xuICBsZXQgW2xvbiwgbGF0XSA9IHZhbHVlO1xuICBsb24gPSBsb24gIT0gbnVsbCA/IGxvbiA6IG51bGw7XG4gIGxhdCA9IGxhdCAhPSBudWxsID8gbGF0IDogbnVsbDtcbiAgY29uc3QgZm9ybUVsID0gaHRtbGA8Zm9ybSBpZD1cImZvcm1FbFwiIHN0eWxlPVwid2lkdGg6ICR7d2lkdGh9cHg7XCI+PC9mb3JtPmA7XG4gIGNvbnN0IGNvbnRleHQgPSBET00uY29udGV4dDJkKHdpZHRoLCBoZWlnaHQtd2lkdGgvMTQpO1xuICBjb25zdCBjYW52YXMgPSBjb250ZXh0LmNhbnZhcztcbiAgY2FudmFzLnN0eWxlLm1hcmdpbiA9IGAwcHggMHB4IC0yNnB4IDBweGA7XG4gIGNvbnN0IHByb2plY3Rpb24gPSBkM1xuICAgIC5nZW9FcXVpcmVjdGFuZ3VsYXIoKVxuICAgIC5wcmVjaXNpb24oMC4xKVxuICAgIC5maXRTaXplKFt3aWR0aCwgaGVpZ2h0XSwgeyB0eXBlOiBcIlNwaGVyZVwiIH0pLnJvdGF0ZShbLTE1MywgMF0pO1xuICBjb25zdCBwYXRoID0gZDMuZ2VvUGF0aChwcm9qZWN0aW9uLCBjb250ZXh0KS5wb2ludFJhZGl1cygyLjUpO1xuICBmb3JtRWwuYXBwZW5kKGNhbnZhcyk7XG4gIGZ1bmN0aW9uIGRyYXcoKSB7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSB3aW5kb3cuZGFya21vZGUgPyBcImJsYWNrXCIgOiBcIndoaXRlXCI7XG4gICAgY29udGV4dC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpOyBwYXRoKHt0eXBlOiBcIlNwaGVyZVwifSk7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSB3aW5kb3cuZGFya21vZGUgPyBcIiMwMDdGRkZcIiA6IG1hcGNvbG9ycy5vY2VhbjtcbiAgICBjb250ZXh0LmZpbGwoKTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIHBhdGgoZ3JhdGljdWxlKTtcbiAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDAuOTU7XG4gICAgY29udGV4dC5zdHJva2VTdHlsZSA9IGAjYWFhYDtcbiAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgcGF0aChsYW5kKTtcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IHdpbmRvdy5kYXJrbW9kZSA/IFwiIzA4MDhcIiA6IG1hcGNvbG9ycy5sYW5kO1xuICAgIGNvbnRleHQuZmlsbCgpO1xuICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgcGF0aChjb3VudHJpZXMpO1xuICAgIGNvbnRleHQubGluZVdpZHRoID0gLjk1O1xuICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSB3aW5kb3cuZGFya21vZGUgPyBcIiNhYWFcIiA6IFwiIzMzM1wiO1xuICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSB3aW5kb3cuZGFya21vZGUgPyBcIiNmZmZcIiA6IFwiIzAwMFwiO1xuICAgIGNvbnRleHQuZm9udCA9IHdpZHRoIDwgNzYwID8gXCIxNHB4IHNlcmlmXCIgOiB3aWR0aCA8IDk5MCA/IFwiMTdweCBzZXJpZlwiIDogXCIyM3B4IHNlcmlmXCI7XG4gICAgZDMucmFuZ2UoLTEuNSwgMzQyICsgMSwgMzYpLm1hcCh4ID0+ICBjb250ZXh0LmZpbGxUZXh0KGxvbmcyem9uZSh4KSwgLi4ucHJvamVjdGlvbihbeCwgODIgLSAod2lkdGggPCA1MDApICogOC44XSkpKTtcbiAgICBkMy5yYW5nZSgtMS41LCAzNDIgKyAxLCAzNikubWFwKHggPT4gIGNvbnRleHQuZmlsbFRleHQobG9uZzJ6b25lKHgpLCAuLi5wcm9qZWN0aW9uKFt4LCAtNjYgKyAod2lkdGggPCA1MDApICogMS4xXSkpKTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpLCBwYXRoKG5pZ2h0KSwgY29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoMCwwLDI1NSwwLjEpXCIsIGNvbnRleHQuZmlsbCgpO1xuICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7IHBhdGgucG9pbnRSYWRpdXMoMTcpOyBwYXRoKHt0eXBlOiBcIlBvaW50XCIsIGNvb3JkaW5hdGVzOiBzdW59KTsgY29udGV4dC5zdHJva2VTdHlsZSA9IFwiIzAwMDhcIjsgY29udGV4dC5maWxsU3R5bGUgPSBcIiNmZjA4XCI7IGNvbnRleHQubGluZVdpZHRoID0gMTsgY29udGV4dC5zdHJva2UoKTsgY29udGV4dC5maWxsKCk7XG4gICAgaWYgKGxvbiAhPSBudWxsICYmIGxhdCAhPSBudWxsKSB7XG4gICAgICBwYXRoLnBvaW50UmFkaXVzKDE3KTsgY29udGV4dC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcbiAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7IHBhdGgoe3R5cGU6IFwiUG9pbnRcIiwgY29vcmRpbmF0ZXM6IFtsb24sIGxhdF19KTsgY29udGV4dC5saW5lV2lkdGggPSAxOyBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgY29udGV4dC5saW5lV2lkdGggPSA2O1xuICAgICAgcGF0aC5wb2ludFJhZGl1cygxNCk7IGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcInJlZFwiO1xuICAgICAgY29udGV4dC5iZWdpblBhdGgoKTsgcGF0aCh7dHlwZTogXCJQb2ludFwiLCBjb29yZGluYXRlczogW2xvbiwgbGF0XX0pOyBjb250ZXh0LnN0cm9rZSgpO1xuICAgIH1cbiAgfVxuICBsZXQgZHJhZyA9IGQzLmRyYWcoKVxuICAgIC5vbihcImRyYWdcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBsZXQgY29vcmRzID0gcHJvamVjdGlvbi5pbnZlcnQoW2V2ZW50LngsIGV2ZW50LnldKTtcbiAgICAgIGxvbiA9ICtjb29yZHNbMF0udG9GaXhlZCgyKTtcbiAgICAgIGxhdCA9ICtjb29yZHNbMV0udG9GaXhlZCgyKTtcbiAgICAgIGRyYXcoKTtcbiAgICAgIGNhbnZhcy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImlucHV0XCIsIHsgYnViYmxlczogdHJ1ZSB9KSk7XG4gICAgfSlcbiAgZDMuc2VsZWN0KGNhbnZhcykuY2FsbChkcmFnKVxuICBjYW52YXMub25jbGljayA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgY29uc3QgeyBvZmZzZXRYLCBvZmZzZXRZIH0gPSBldjtcbiAgICBsZXQgY29vcmRzID0gcHJvamVjdGlvbi5pbnZlcnQoW29mZnNldFgsIG9mZnNldFldKTtcbiAgICBsb24gPSArY29vcmRzWzBdLnRvRml4ZWQoMik7XG4gICAgbGF0ID0gK2Nvb3Jkc1sxXS50b0ZpeGVkKDIpO1xuICAgIGRyYXcoKTtcbiAgICBjYW52YXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJpbnB1dFwiLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICB9O1xuICBkcmF3KCk7XG4gIGNvbnN0IGZvcm0gPSBpbnB1dCh7XG4gICAgdHlwZTogXCJ3b3JsZE1hcENvb3JkaW5hdGVzXCIsXG4gICAgdGl0bGUsXG4gICAgZGVzY3JpcHRpb24sXG4gICAgZGlzcGxheTogdiA9PiAod2lkdGggPiAzMDApID8gaHRtbGA8ZGl2IHN0eWxlPVwid2lkdGg6ICR7d2lkdGh9cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IGNvbG9yOiB3aW5kb3cuZGFya21vZGUgPyAjZmZmIDogIzAwMDsgdGV4dC1hbGlnbjogY2VudGVyOyBmb250OiAke3dpZHRoIC8gNDB9cHggbW9ub3NwYWNlOyBwb3NpdGlvbjogcmVsYXRpdmU7IHRvcDogJHstMTYgLSB3aWR0aCAvIDUwfXB4OyAgbWFyZ2luLWJvdHRvbTogLS40ZW07XCI+XG4gICAgICAgICAgICA8c3BhbiBzdHlsZT1cImNvbG9yOiB3aW5kb3cuZGFya21vZGUgPyAjZmZmIDogIzAwMDtcIj5ab25lOjwvc3Bhbj4gJHtsb24gIT0gbnVsbCA/IGxvbmcyem9uZShsb24pIDogXCJcIn1cbiAgICAgICAgICAgICZuYnNwOyAmbmJzcDtcbiAgICAgICAgICAgIDxzcGFuIHN0eWxlPVwiY29sb3I6IHdpbmRvdy5kYXJrbW9kZSA/ICNmZmYgOiAjMDAwO1wiPkxvbmdpdHVkZTo8L3NwYW4+ICR7bG9uICE9IG51bGwgPyAobG9uZzJ0dXJuKGxvbikpLnRvRml4ZWQoMCkgOiBcIlwifVxuICAgICAgICAgICAgJm5ic3A7ICZuYnNwO1xuICAgICAgICAgICAgPHNwYW4gc3R5bGU9XCJjb2xvcjogd2luZG93LmRhcmttb2RlID8gI2ZmZiA6ICMwMDA7XCI+TGF0aXR1ZGU6PC9zcGFuPiAke2xhdCAhPSBudWxsID8gKGxhdGkydHVybihsYXQpKS50b0ZpeGVkKDApIDogXCJcIn1cbiAgICAgICAgICA8L2Rpdj5gIDogJycsXG4gICAgZ2V0VmFsdWU6ICgpID0+IFtsb24gIT0gbnVsbCA/IGxvbiA6IG51bGwsIGxhdCAhPSBudWxsID8gbGF0IDogbnVsbF0sXG4gICAgZm9ybTogZm9ybUVsXG4gIH0pO1xuICByZXR1cm4gZm9ybTtcbn1cbndpbmRvdy5kYXJrbW9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYm9keVwiKVswXS5jbGFzc05hbWUubWF0Y2goL3F1YXJ0by1kYXJrLykgPyB0cnVlIDogZmFsc2U7XG5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwicXVhcnRvLWNvbG9yLXNjaGVtZS10b2dnbGVcIilbMF0ub25jbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gIHdpbmRvdy5xdWFydG9Ub2dnbGVDb2xvclNjaGVtZSgpO1xuICB3aW5kb3cuZGFya21vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImJvZHlcIilbMF0uY2xhc3NOYW1lLm1hdGNoKC9xdWFydG8tZGFyay8pID8gdHJ1ZSA6IGZhbHNlO1xuICB3b3JsZE1hcENvb3JkaW5hdGVzLmRyYXcoKTtcbiAgYXBwLmRyYXdFYXJ0aCgpO1xuICByZXR1cm4gZmFsc2U7XG59O1xuc3VuID0ge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZTtcbiAgY29uc3QgZGF5ID0gbmV3IERhdGUoK25vdykuc2V0VVRDSG91cnMoMCwgMCwgMCwgMCk7XG4gIGNvbnN0IHQgPSBzb2xhci5jZW50dXJ5KG5vdyk7XG4gIGNvbnN0IGxvbmdpdHVkZSA9IChkYXkgLSBub3cpIC8gODY0ZTUgKiAzNjAgLSAxODA7XG4gIHJldHVybiBbbG9uZ2l0dWRlIC0gc29sYXIuZXF1YXRpb25PZlRpbWUodCkgLyA0LCBzb2xhci5kZWNsaW5hdGlvbih0KV07XG59XG5uaWdodCA9IGQzLmdlb0NpcmNsZSgpXG4gICAgLnJhZGl1cyg5MClcbiAgICAuY2VudGVyKGFudGlwb2RlKHN1bikpXG4gICgpXG5hbnRpcG9kZSA9IChbbG9uZ2l0dWRlLCBsYXRpdHVkZV0pID0+IFtsb25naXR1ZGUgKyAxODAsIC1sYXRpdHVkZV1cbnNvbGFyID0gcmVxdWlyZShcInNvbGFyLWNhbGN1bGF0b3JAMC4zL2Rpc3Qvc29sYXItY2FsY3VsYXRvci5taW4uanNcIilcbnZpZXdvZiBmYW5jeVNlY29uZHNPRkYgPSBJbnB1dHMudG9nZ2xlKHtcbiAgbGFiZWw6IFwiVGlja2luZyBjbG9ja1wiLFxuICB2YWx1ZTogdHJ1ZSxcbn0pXG5mdW5jdGlvbiBzZXRTdHlsZShjb250ZW50LCBzdHlsZSA9IHt9KSB7XG4gIGZ1bmN0aW9uIHlpcShjb2xvcikge1xuICAgIGNvbnN0IHtyLCBnLCBifSA9IGQzLnJnYihjb2xvcik7XG4gICAgcmV0dXJuIChyICogMjk5ICsgZyAqIDU4NyArIGIgKiAxMTQpIC8gMTAwMCAvIDI1NTsgLy8gcmV0dXJucyB2YWx1ZXMgYmV0d2VlbiAwIGFuZCAxXG4gIH1cbiAgY29uc3Qge1xuICAgIGJhY2tncm91bmQsXG4gICAgY29sb3IgPSB5aXEoYmFja2dyb3VuZCkgPj0gMC42ID8gXCIjMTExXCIgOiBcIndoaXRlXCIsXG4gICAgcGFkZGluZyA9IFwiMCAxcHhcIixcbiAgICBib3JkZXJSYWRpdXMgPSBcIjRweFwiLFxuICAgIGZvbnRXZWlnaHQgPSA5MDAsXG4gICAgZm9udFNpemUgPSBcIjFlbVwiLFxuICAgIC4uLnJlc3RcbiAgfSA9IHR5cGVvZiBzdHlsZSA9PT0gXCJzdHJpbmdcIiA/IHtiYWNrZ3JvdW5kOiBzdHlsZX0gOiBzdHlsZTtcbiAgcmV0dXJuIGh0bC5odG1sYDxzcGFuIHN0eWxlPSR7e1xuICAgIGJhY2tncm91bmQsXG4gICAgY29sb3IsXG4gICAgcGFkZGluZyxcbiAgICBib3JkZXJSYWRpdXMsXG4gICAgZm9udFdlaWdodCxcbiAgICAuLi5yZXN0XG4gIH19PiR7Y29udGVudH08L3NwYW4+YDtcbn1cbmZ1bmN0aW9uIHlpcShjb2xvcikge1xuICBjb25zdCB7ciwgZywgYn0gPSBkMy5yZ2IoY29sb3IpO1xuICByZXR1cm4gKHIgKiAyOTkgKyBnICogNTg3ICsgYiAqIDExNCkgLyAxMDAwIC8gMjU1OyAvLyByZXR1cm5zIHZhbHVlcyBiZXR3ZWVuIDAgYW5kIDFcbn1cbmZ1bmN0aW9uIHRleHRjb2xvcihjb250ZW50LCBzdHlsZSA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICBiYWNrZ3JvdW5kLFxuICAgIGNvbG9yID0geWlxKGJhY2tncm91bmQpID4gMC41MSA/IFwiIzAwMFwiIDogXCJ3aGl0ZVwiLFxuICAgIHBhZGRpbmcgPSBcIjAgNXB4XCIsXG4gICAgYm9yZGVyUmFkaXVzID0gXCI0cHhcIixcbiAgICBmb250V2VpZ2h0ID0gNDAwLFxuICAgIGZvbnRGYW1pbHkgPSBcIm1vbm9zcGFjZVwiLFxuICAgIC4uLnJlc3RcbiAgfSA9IHR5cGVvZiBzdHlsZSA9PT0gXCJzdHJpbmdcIiA/IHtiYWNrZ3JvdW5kOiBzdHlsZX0gOiBzdHlsZTtcbiAgcmV0dXJuIGh0bC5odG1sYDxzcGFuIHN0eWxlPSR7e1xuICAgIGJhY2tncm91bmQsXG4gICAgY29sb3IsXG4gICAgcGFkZGluZyxcbiAgICBib3JkZXJSYWRpdXMsXG4gICAgZm9udFdlaWdodCxcbiAgICBmb250RmFtaWx5LFxuICAgIC4uLnJlc3RcbiAgfX0+JHtjb250ZW50fTwvc3Bhbj5gO1xufVxuZnVuY3Rpb24gaXNMZWFwWWVhcih5KSB7XG4gIHkgKz0gMTtcbiAgcmV0dXJuIHkgJSA0ID09IDAgJiYgeSAlIDEwMCAhPSAwIHx8IHkgJSA0MDAgPT0gMDtcbn1cbmVsYXBzZWQgPSB7XG4gIGxldCBpID0gMDtcbiAgd2hpbGUgKHRydWUpIHtcbiAgICB5aWVsZCBQcm9taXNlcy50aWNrKDg2NCwgKytpKTtcbiAgfVxufVxucGllY2V3aXNlQ29sb3IgPSBkMy5waWVjZXdpc2UoZDMuaW50ZXJwb2xhdGVSZ2IsIFtcbiAgXCIjZjAwXCIsICAgIC8vICAwICAgMCByZWRcbiAgXCIjZjUwXCIsICAgIC8vICAwLjI1ICAyMCB5clxuICBcIiNmNjBcIiwgICAgLy8gIDAuNSAgIDI0IHlyIG9yYW5nZXJlZFxuICBcIiNmNzBcIiwgICAgLy8gIDAuNzUgIDI4IHlyXG4gIFwiI2Y5MFwiLCAgICAvLyAgMSAgICAgMzYgeXIgb3JhbmdlXG4gIFwiI2ZiMFwiLCAgICAvLyAgMS4yNSAgNDQgeXJcbiAgXCIjZmMwXCIsICAgIC8vICAxLjUgICA0OCB5ciB5ZWxsb3dvcmFuZ2VcbiAgXCIjZmQwXCIsICAgIC8vICAxLjc1ICA1MiB5clxuICBcIiNmZjBcIiwgICAgLy8gIDIgICAgIDYwIHllbGxvd1xuICBcIiNlZjBcIiwgICAgLy8gIDIuMjUgIDY0IGd5XG4gIFwiI2RmMFwiLCAgICAvLyAgMi41ICAgNjggZ3kgbGltZXllbGxvd1xuICBcIiNjZjBcIiwgICAgLy8gIDIuNzUgIDcyIGd5XG4gIFwiI2FmMFwiLCAgICAvLyAgMyAgICAgODAgZ3kgbGltZVxuICBcIiM4ZjBcIiwgICAgLy8gIDMuMjUgIDg4IGd5XG4gIFwiIzdmMFwiLCAgICAvLyAgMy41ICAgOTIgZ3kgZ3JlZW5saW1lXG4gIFwiIzZmMFwiLCAgICAvLyAgMy43NSAgOTYgZ3lcbiAgXCIjMGYwXCIsICAgIC8vICA0ICAgIDEyMCBncmVlblxuICBcIiMwZjdcIiwgICAgLy8gIDQuMjUgMTQ4IGNnXG4gIFwiIzBmOVwiLCAgICAvLyAgNC41ICAxNTYgY2cgY3lhbmdyZWVuXG4gIFwiIzBmYlwiLCAgICAvLyAgNC43NSAxNjQgY2dcbiAgXCIjMGZmXCIsICAgIC8vICA1ICAgIDE4MCBjeWFuXG4gIFwiIzBjZlwiLCAgICAvLyAgNS4yNSAxOTIgYmNcbiAgXCIjMGJmXCIsICAgIC8vICA1LjUgIDE5NiBiYyBhenVyZWN5YW5cbiAgXCIjMGFmXCIsICAgIC8vICA1Ljc1IDIwMCBiY1xuICBcIiMwOGZcIiwgICAgLy8gIDYgICAgMjA4IGJjIGF6dXJlXG4gIFwiIzA2ZlwiLCAgICAvLyAgNi4yNSAyMTYgYmNcbiAgXCIjMDVmXCIsICAgIC8vICA2LjUgIDIyMCBiYyBibHVlYXp1cmVcbiAgXCIjMDRmXCIsICAgIC8vICA2Ljc1IDIyNCBiY1xuICBcIiMwMGZcIiwgICAgLy8gIDcgICAgMjQwIGJsdWVcbiAgXCIjNTBmXCIsICAgIC8vICA3LjI1IDI2MCBtYlxuICBcIiM2MGZcIiwgICAgLy8gIDcuNSAgMjY0IG1iIHB1cnBsZWJsdWVcbiAgXCIjNzBmXCIsICAgIC8vICA3Ljc1IDI2OCBtYlxuICBcIiM5MGZcIiwgICAgLy8gIDggICAgMjc2IG1iIHB1cnBsZVxuICBcIiNiMGZcIiwgICAgLy8gIDguMjUgMjg0IG1iXG4gIFwiI2MwZlwiLCAgICAvLyAgOC41ICAyODggbWIgdmlvbGV0cHVycGxlXG4gIFwiI2QwZlwiLCAgICAvLyAgOC43NSAyOTIgbWJcbiAgXCIjZjBmXCIsICAgIC8vICA5ICAgIDMwMCBtYWdlbnRhXG4gIFwiI2YwYVwiLCAgICAvLyAgOS4yNSAzMjAgcm1cbiAgXCIjZjA4XCIsICAgIC8vICA5LjUgIDMyOCBybVxuICBcIiNmMDZcIiwgICAgLy8gIDkuNzUgMzM2IHJtXG4gIFwiI2YwMFwiLCAgICAvLyAgMCAgICAgICAgMCByZWRcbl0pXG5zbFN0ciA9IGAsIDEwMCUsIDUwJSlgXG5lbGFUaW1lID0gZWxhcHNlZCAlIDFlNVxuZWxhVGltZUhzbCA9IHRleHRjb2xvcihlbGFUaW1lLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKGVsYVRpbWUgJSAxMDAwIC8gMTAwMCkpLmh9YCArIHNsU3RyKVxuZGVjTW90eSA9IE1hdGguZmxvb3IoKDUgKiBkZWNEYXRlICsgMikgLyAxNTMpXG5pc29ZZWFyID0gZGVjWWVhciArIChkZWNNb3R5ID4gOSlcbm1vbnRoID0gZGVjTW90eSA8IDEwID8gZGVjTW90eSArIDMgOiBkZWNNb3R5IC0gOVxuZGVjSG91ciA9IGRlY1RpbWUgKiAyNFxuZGVjTWludXRlID0gKGRlY0hvdXIgJSAxKSAqIDYwXG5kZWNTZWNvbmQgPSAoZGVjTWludXRlICUgMSkgKiA2MFxuaXNvSG91ciA9IE1hdGguZmxvb3IoZGVjSG91cilcbmlzb01pbnV0ZSA9IE1hdGguZmxvb3IoZGVjTWludXRlKVxuaXNvU2Vjb25kID0gTWF0aC5mbG9vcihkZWNTZWNvbmQpXG5kZWNEZWsgPSBNYXRoLmZsb29yKGRlY0RhdGUgLyAxMClcbmRlY0RvZCA9IGRlY0RhdGUgJSAxMFxuZGVjRG90bSA9IE1hdGguZmxvb3IoZGVjRGF0ZSAtICgxNTMgKiBkZWNNb3R5ICsgMikgLyA1ICsgMSlcbnNlbERvdGUgPSB1bml4MmRvdGUoc2VsZWN0ZWREYXRlLmdldFRpbWUoKSAtIDg2NDAwMDAwLCAwKVxuc2VsRGF0ZSA9IE1hdGguZmxvb3IoZG90ZTJkYXRlKC4uLnNlbERvdGUpWzFdKVxuc2VsVGltZSA9IHNlbGVjdGVkSG91ciAvIDI0XG5zZWxUaW1lT25lID0gc2VsVGltZSAlIDFcbnNlbFRpbWVUZW4gPSBzZWxUaW1lICogMTAgJSAxMFxuc2VsU25hcCA9IHNlbERhdGUgKyBzZWxUaW1lXG5zZWxMYXRpID0gbGF0aTJ0dXJuKGxvY2F0aW9uWzFdKVxuZGVjRG9kSHNsID0gdGV4dGNvbG9yKGRlY0RvZCwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoZGVjRG9kIC8gMTApKS5mb3JtYXRIZXgoKSlcbmRlY0RhdGVIc2wgPSB0ZXh0Y29sb3IoZGVjRGF0ZS50b1N0cmluZygpLnBhZFN0YXJ0KDMsIFwiMFwiKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoZGVjRGF0ZSAvICgzNjUgKyBpc0xlYXBZZWFyKGRlY1llYXIpKSkpLmZvcm1hdEhleCgpKVxuZGVjVGltZUhzbCA9IHRleHRjb2xvcihkZWNUaW1lLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihkZWNUaW1lIC8gMTApKS5mb3JtYXRIZXgoKSlcbnNlbERhdGVIc2wgPSB0ZXh0Y29sb3Ioc2VsRGF0ZS50b1N0cmluZygpLnBhZFN0YXJ0KDMsIFwiMFwiKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3Ioc2VsRGF0ZSAvIDM2NSkpLmZvcm1hdEhleCgpKVxuc2VsTGF0aUhzbCA9IHRleHRjb2xvcihzZWxMYXRpLnRvRml4ZWQoMCksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKChzZWxMYXRpICsgMjUwKSAlIDI1MCAvIDI1MCkpLmZvcm1hdEhleCgpKVxuc2VsVGltZURheSA9IHRleHRjb2xvcihzZWxUaW1lT25lLnRvRml4ZWQoMykuc2xpY2UoMiksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHNlbFRpbWUpKS5mb3JtYXRIZXgoKSlcbnNlbFRpbWVIc2wwID0gdGV4dGNvbG9yKHNlbFRpbWVUZW4udG9GaXhlZCg0KSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3Ioc2VsVGltZSkpLmZvcm1hdEhleCgpKVxuc2VsVGltZUhzbDEgPSB0ZXh0Y29sb3Ioc2VsVGltZVRlbi50b0ZpeGVkKDQpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihzZWxUaW1lKSkuZm9ybWF0SGV4KCkpXG5zZWxab25lSHNsID0gdGV4dGNvbG9yKHNlbGVjdGVkWm9uZSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3Ioc2VsZWN0ZWRab25lIC8gMTApKS5mb3JtYXRIZXgoKSlcbnNlbFNuYXBEYXkgPSB0ZXh0Y29sb3Ioc2VsU25hcC50b0ZpeGVkKDMpLnBhZFN0YXJ0KDYsIFwiMFwiKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3Ioc2VsU25hcCAvIDM2NSkpLmZvcm1hdEhleCgpKVxuc2VsU25hcERlYyA9IHRleHRjb2xvcigoc2VsU25hcCAqIDEwKS50b0ZpeGVkKDQpLnBhZFN0YXJ0KDksIFwiMFwiKSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3Ioc2VsU25hcCAvIDM2NSkpLmZvcm1hdEhleCgpKVxuZGVjWm9uZUhzbCA9IHRleHRjb2xvcihzZWxlY3RlZFpvbmUsIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKHNlbGVjdGVkWm9uZSAvIDEwKSkuZm9ybWF0SGV4KCkpXG52aWV3b2Ygc2VsZWN0ZWREYXRlID0gSW5wdXRzLmlucHV0KGRhdGUyMDIyKVxudmlld29mIHNlbGVjdGVkSG91ciA9IElucHV0cy5pbnB1dChkYXRlMjAyMi5nZXRIb3VycygpKVxuZGF0ZTIwMjIgPSBuZXcgRGF0ZSgyMDIyLCBuZXcgRGF0ZSgpLmdldE1vbnRoKCksIG5ldyBEYXRlKCkuZ2V0RGF0ZSgpLCBuZXcgRGF0ZSgpLmdldEhvdXJzKCkpXG5mdW5jdGlvbiBzZXQoaW5wdXQsIHZhbHVlKSB7XG4gIGlucHV0LnZhbHVlID0gdmFsdWU7XG4gIGlucHV0LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiaW5wdXRcIiwge2J1YmJsZXM6IHRydWV9KSk7XG59XG5oRDEyMSA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigxMjEgLyAzNjUpKS5oXG5oRDI2OCA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigyNjggLyAzNjUpKS5oXG5oRDMwNSA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigzMDUgLyAzNjUpKS5oXG5oRDMwNiA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigzMDYgLyAzNjUpKS5oXG5oMWJ5MzIwID0gZDMuaHNsKHBpZWNld2lzZUNvbG9yKDEgLyAzMjApKS5oXG5oMWJ5ODY0MCA9IGQzLmhzbChwaWVjZXdpc2VDb2xvcigxIC8gODY0MCkpLmhcbmh1ZXMgPSBPYmplY3QuZnJvbUVudHJpZXMoW1xuICAuMDA4MyxcbiAgLjAxNjYsXG4gIC4wMjI5LFxuICAuMDI1LFxuICAuMjg3LFxuICAuMDMzMyxcbiAgLjA0MTYsXG4gIC4wNSxcbiAgLjEyNSxcbiAgLjMzMyxcbiAgLjM3NSxcbiAgLjQyOSxcbiAgLjUzMyxcbiAgLjk2OSxcbiAgLjk5OSxcbiAgXS5tYXAoaSA9PiBbaSwgZDMuaHNsKHBpZWNld2lzZUNvbG9yKGkpKS5oXSlcbik7XG4vLyBodHRwczovL29ic2VydmFibGVocS5jb20vQG1hdHRkenVnYW4vcG9wdWxhdGlvbi1ieS10aW1lLXpvbmUtY3JlYXRpbmctYS1kYXRhc2V0XG5wb3B1bGF0aW9uQnlUaW1lWm9uZSA9IEZpbGVBdHRhY2htZW50KFwiLi4vLi4vYXNzZXQvcG9wdWxhdGlvbkJ5VGltZVpvbmUuanNvblwiKS5qc29uKCk7XG5zb3J0ZWRQb3AgPSBwb3B1bGF0aW9uQnlUaW1lWm9uZS5zb3J0KFxuICAoYSwgYikgPT4gc29ydFBhcmFtc1sxXSA/IHNvcnRGdW5jKGEubnVtYmVyLCBiLm51bWJlcikgOiBzb3J0RnVuYyhhLnBvcCwgYi5wb3ApXG4pXG5zb3J0RnVuYyA9IHNvcnRQYXJhbXNbMF0gPyBkMy5hc2NlbmRpbmcgOiBkMy5kZXNjZW5kaW5nXG5wb3BCeVNpZ24gPSBkMy5yb2xsdXAoc29ydGVkUG9wLCB2ID0+IGQzLnN1bSh2LCBkID0+IGQucG9wIC8gMWU5KSwgZCA9PiBkLlNpZ24pXG50b3RhbFBvcCA9IGQzLnN1bShzb3J0ZWRQb3AsIGQgPT4gZC5wb3AgLyAxZTkpXG5kek9mZiA9IHVuaXgyZG90ZShub3csIG9mZnNldClcbnlkek9mZiA9IGRvdGUyZGF0ZSguLi5kek9mZilcbmRlY1RpbWVPZmYgPSB5ZHpPZmZbMV0gJSAxXG5kZWNTaWduT2ZmID0gb2Zmc2V0IDwgMCA/IFwiK1wiIDogXCLigJNcIlxuZGVjT2Zmc2V0UG9zaSA9IChvZmZzZXQgKyAxMCkgJSAxMFxuZGVjT2Zmc2V0TmVnYSA9IGRlY09mZnNldFBvc2kgLSAxMFxuZGVjT2Zmc2V0SHNsMCA9IHRleHRjb2xvcihNYXRoLmFicyhvZmZzZXQpLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKGRlY09mZnNldFBvc2kgLyAxMCkpLmh9YCArIHNsU3RyKVxuZGVjT2Zmc2V0SHNsMSA9IHRleHRjb2xvcihNYXRoLmFicyhvZmZzZXQpLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKGRlY09mZnNldFBvc2kgLyAxMCkpLmh9YCArIHNsU3RyKVxuZGVjT2Zmc2V0SHNsMiA9IHRleHRjb2xvcihvZmZzZXQsIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IoZGVjT2Zmc2V0UG9zaSAvIDEwKSkuaH1gICsgc2xTdHIpXG5kZWNPZmZzZXRIc2xQID0gdGV4dGNvbG9yKGRlY09mZnNldFBvc2ksIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IoZGVjT2Zmc2V0UG9zaSAvIDEwKSkuaH1gICsgc2xTdHIpXG5kZWNPZmZzZXRIc2xOID0gdGV4dGNvbG9yKGRlY09mZnNldE5lZ2EsIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IoZGVjT2Zmc2V0UG9zaSAvIDEwKSkuaH1gICsgc2xTdHIpXG5kZWNUaW1lT2ZmSHNsMCA9IHRleHRjb2xvcigoZGVjVGltZU9mZiAqIDEwKS50b0ZpeGVkKDQpLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKGRlY1RpbWVPZmYpKS5ofWAgKyBzbFN0cilcbmRlY1RpbWVPZmZIc2wxID0gdGV4dGNvbG9yKChkZWNUaW1lT2ZmICogMTApLnRvRml4ZWQoNCksIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IoZGVjVGltZU9mZikpLmh9YCArIHNsU3RyKVxuZGVjVGltZU9mZkhzbDIgPSB0ZXh0Y29sb3IoKGRlY1RpbWVPZmYgKiAxMCkudG9GaXhlZCg0KSwgYGhzbCgke2QzLmhzbChwaWVjZXdpc2VDb2xvcihkZWNUaW1lT2ZmKSkuaH1gICsgc2xTdHIpXG5kZWNUaW1lT2ZmSHNsMyA9IHRleHRjb2xvcigoZGVjVGltZU9mZiAqIDEwKS50b0ZpeGVkKDQpLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKGRlY1RpbWVPZmYpKS5ofWAgKyBzbFN0cilcbmRlY1RpbWVPZmZMZWFwTnVtID0gb2Zmc2V0ICogMzIwICsgMVxuZGVjVGltZU9mZkxlYXBUb2RIc2wgPSB0ZXh0Y29sb3IoKGRlY1RpbWVPZmYgKiAxMCArIDEgLyAzMjApLnRvRml4ZWQoNCksIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IoZGVjVGltZU9mZikpLmh9YCArIHNsU3RyKVxuZGVjVGltZU9mZkxlYXBUem9Ic2wgPSB0ZXh0Y29sb3IoYCR7ZGVjVGltZU9mZkxlYXBOdW19LzMyMGAsIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IoKGRlY1RpbWVPZmZMZWFwTnVtIC8gMzIwICsgMTApICUgMTAgLyAxMCkpLmh9YCArIHNsU3RyKVxudXRjT2Zmc2V0TSA9IC0obmV3IERhdGUpLmdldFRpbWV6b25lT2Zmc2V0KClcbnV0Y09mZnNldEQgPSB1dGNPZmZzZXRNIC8gMTQ0XG51dGNPZmZzZXRQID0gKHV0Y09mZnNldEQgKyAxMCkgJSAxMFxuZGVjWm9uZSA9IHlkelsyXVxuZGVjWm9uZVBvcyA9IChkZWNab25lICsgMTApICUgMTBcbnV0Y09mZkRpZmYgPSBwYXJzZUZsb2F0KChNYXRoLnJvdW5kKHV0Y09mZnNldEQpIC0gdXRjT2Zmc2V0RCkudG9GaXhlZCgyKSlcbnV0Y09mZkhzbE0gPSB0ZXh0Y29sb3IodXRjT2Zmc2V0TSwgYGhzbCgke2QzLmhzbChwaWVjZXdpc2VDb2xvcih1dGNPZmZzZXRQIC8gMTApKS5ofWAgKyBzbFN0cilcbnV0Y09mZkhzbEQgPSB0ZXh0Y29sb3IocGFyc2VGbG9hdCh1dGNPZmZzZXRELnRvRml4ZWQoMikpLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKHV0Y09mZnNldFAgLyAxMCkpLmh9YCArIHNsU3RyKVxuZGVjWm9uSHNsUCA9IHRleHRjb2xvcihkZWNab25lUG9zLCBgaHNsKCR7ZDMuaHNsKHBpZWNld2lzZUNvbG9yKGRlY1pvbmVQb3MgLyAxMCkpLmh9YCArIHNsU3RyKVxudXRjT2Zmc2V0TWRpZmZIc2wgPSB0ZXh0Y29sb3IocGFyc2VGbG9hdCgodXRjT2ZmRGlmZiAqIDE0NCkudG9GaXhlZCgyKSksIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IodXRjT2ZmRGlmZiAvIDEwKSkuaH1gICsgc2xTdHIpXG51dGNPZmZEaWZmSHNsID0gdGV4dGNvbG9yKHV0Y09mZkRpZmYsIGBoc2woJHtkMy5oc2wocGllY2V3aXNlQ29sb3IodXRjT2ZmRGlmZiAvIDEwKSkuaH1gICsgc2xTdHIpXG5mdW5jdGlvbiBkYXRlMmRvdGUoeWVhciA9IDE5NjksIGRvdHkgPSAzMDYsIHpvbmUgPSAwKSB7XG4gICAgY29uc3QgY290ZSA9IE1hdGguZmxvb3IoKHllYXIgPj0gMCA/IHllYXIgOiB5ZWFyIC0gMzk5KSAvIDQwMCksIHlvdGUgPSB5ZWFyIC0gY290ZSAqIDQwMDtcbiAgICByZXR1cm4gW2NvdGUgKiAxNDYwOTcgKyB5b3RlICogMzY1ICsgTWF0aC5mbG9vcih5b3RlIC8gNCkgLSBNYXRoLmZsb29yKHlvdGUgLyAxMDApICsgZG90eSwgem9uZV1cbn1cbmxlYXBTZWNvbmREb3RlcyA9IFtcbiAgWzE5NzIsIDEyMV0sXG4gIFsxOTcyLCAzMDVdLFxuICBbMTk3MywgMzA1XSxcbiAgWzE5NzQsIDMwNV0sXG4gIFsxOTc1LCAzMDVdLFxuICBbMTk3NiwgMzA1XSxcbiAgWzE5NzcsIDMwNV0sXG4gIFsxOTc4LCAzMDVdLFxuICBbMTk3OSwgMzA1XSxcbiAgWzE5ODEsIDEyMV0sXG4gIFsxOTgyLCAxMjFdLFxuICBbMTk4MywgMTIxXSxcbiAgWzE5ODUsIDEyMV0sXG4gIFsxOTg3LCAzMDVdLFxuICBbMTk4OSwgMzA1XSxcbiAgWzE5OTAsIDMwNV0sXG4gIFsxOTkyLCAxMjFdLFxuICBbMTk5MywgMTIxXSxcbiAgWzE5OTQsIDEyMV0sXG4gIFsxOTk1LCAzMDVdLFxuICBbMTk5NywgMTIxXSxcbiAgWzE5OTgsIDMwNV0sXG4gIFsyMDA1LCAzMDVdLFxuICBbMjAwOCwgMzA1XSxcbiAgWzIwMTIsIDEyMV0sXG4gIFsyMDE1LCAxMjFdLFxuICBbMjAxNiwgMzA1XSxcbl0ubWFwKHggPT4gZGF0ZTJkb3RlKC4uLngpWzBdKVxubGVhcFNlY29uZERvdGUgPSBkYXRlMmRvdGUobGVhcFNlY29uZFllYXIsIGxlYXBTZWNvbmREYXRlKVswXVxubGVhcENvdW50ID0gbGVhcFNlY29uZERvdGVzLmZpbHRlcihkb3RlID0+IGxlYXBTZWNvbmREb3RlID4gZG90ZSkubGVuZ3RoO1xubGVhcENvbG9yID0gZDMuY29sb3IocGllY2V3aXNlQ29sb3IobGVhcENvdW50IC8gODY0MDApKS5mb3JtYXRIZXgoKVxubGVhcENvdW50SHNsID0gdGV4dGNvbG9yKGxlYXBDb3VudCwgbGVhcENvbG9yKVxuZnJhYyA9IHJlcXVpcmUoXCJmcmFjdGlvbi5qc1wiKVxubGVhcEZyYWMgPSBmcmFjKGxlYXBDb3VudCkuZGl2KDg2NDApLnRvRnJhY3Rpb24oKVxubGVhcFR6b0hzbDAgPSB0ZXh0Y29sb3IobGVhcEZyYWMsIGxlYXBDb2xvcilcbmxlYXBUem9Ic2wxID0gdGV4dGNvbG9yKGxlYXBGcmFjLCBsZWFwQ29sb3IpXG5sZWFwVHpvSHNsMiA9IHRleHRjb2xvcihsZWFwRnJhYywgbGVhcENvbG9yKVxuaG1zVHpvID0gZnJhYyhobXNpbnB1dFswXSkuZGl2KDI0KS5hZGQoaG1zaW5wdXRbMV0sIDE0NDApLmFkZChobXNpbnB1dFsyXSwgODY0MDApLm1vZCgxKVxuaG1zVHpveDEwID0gaG1zVHpvLm11bCgxMClcbnBsdXJhbHgxMCA9IGhtc1R6b3gxMC5lcXVhbHMoMSkgPyBcIlwiIDogXCJzXCJcbmhtc1JvdW5kZWQgPSBobXNUem94MTAucm91bmQoZGlnaXRzIC0gMSlcbmhtc1JlZiA9IGhtc1JvdW5kZWQuc3ViKGhtc1R6b3gxMClcbmhtc1JlZkhzbCA9IHRleHRjb2xvcihobXNSZWYuYWJzKCkudG9GcmFjdGlvbigpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihOdW1iZXIoaG1zUmVmLmRpdigxMCkpKSkuZm9ybWF0SGV4KCkpXG5obXNSZWZTaWduID0gaG1zUmVmLmx0KDApID8gXCItXCIgOiBcIitcIlxuaG1zVHpvSHNsID0gdGV4dGNvbG9yKGhtc1R6b3gxMC50b0ZyYWN0aW9uKCksIGQzLmNvbG9yKHBpZWNld2lzZUNvbG9yKE51bWJlcihobXNUem8pKSkuZm9ybWF0SGV4KCkpXG5obXNSb2RIc2wgPSB0ZXh0Y29sb3IoaG1zUm91bmRlZCwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoTnVtYmVyKGhtc1JvdW5kZWQuZGl2KDEwKSkpKS5mb3JtYXRIZXgoKSlcbmhtc1RvZCA9ICh6ZXJvVGltZSArIGhtc1R6bykgJSAxXG5obXNUb2RIc2wgPSB0ZXh0Y29sb3IoKGhtc1RvZCAqIDEwKS50b0ZpeGVkKDQpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihobXNUb2QpKS5mb3JtYXRIZXgoKSlcbmxlYXBUb2QgPSAoemVyb1RpbWUgKyBsZWFwQ291bnQgLyA4NjQwMCkgJSAxXG5sZWFwRGVjaWRheVRvZCA9IChsZWFwVG9kICogMTApLnRvRml4ZWQoNClcbmxlYXBUb2RIc2wwID0gdGV4dGNvbG9yKGxlYXBEZWNpZGF5VG9kLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihsZWFwVG9kKSkuZm9ybWF0SGV4KCkpXG5sZWFwVG9kSHNsMSA9IHRleHRjb2xvcihsZWFwRGVjaWRheVRvZCwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IobGVhcFRvZCkpLmZvcm1hdEhleCgpKVxubG9uZ0lucHV0SHNsID0gdGV4dGNvbG9yKGxvbmdJbnB1dCwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IobG9uZ0lucHV0IC8gMTApKS5mb3JtYXRIZXgoKSlcbmVvdCA9IGdldEVvdChsZWFwU2Vjb25kRGF0ZSlcbmFzdFR6byA9IGVvdCArIGxvbmdJbnB1dFxuYXN0VHpvSHNsID0gdGV4dGNvbG9yKGFzdFR6by50b0ZpeGVkKDQpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihhc3RUem8gLyAxMCkpLmZvcm1hdEhleCgpKVxuc29sYXJOb29uID0gKDUgLSBhc3RUem8gKyAxMCkgJSAxMFxuc29sYXJOb29uSHNsID0gdGV4dGNvbG9yKHNvbGFyTm9vbi50b0ZpeGVkKDQpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihzb2xhck5vb24gLyAxMCkpLmZvcm1hdEhleCgpKVxuc29sYXJEaWZmID0gemVyb1RpbWUgLSBzb2xhck5vb25cbnNvbGFyU2lnbiA9IHNvbGFyRGlmZiA8IDAgPyBcIi1cIiA6IFwiK1wiXG5zb2xhckRpZmZIc2wgPSB0ZXh0Y29sb3IoTWF0aC5hYnMoc29sYXJEaWZmKS50b0ZpeGVkKDQpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcigoc29sYXJEaWZmICsgMTApICUgMTAgLyAxMCkpLmZvcm1hdEhleCgpKVxuZW90SHNsID0gdGV4dGNvbG9yKGVvdC50b0ZpeGVkKDQpLCBkMy5jb2xvcihwaWVjZXdpc2VDb2xvcihlb3QgLyAxMCkpLmZvcm1hdEhleCgpKVxuZW90U3VtID0gKHplcm9UaW1lICsgYXN0VHpvICsgMTApICUgMTBcbmVvdFN1bUhzbCA9IHRleHRjb2xvcihlb3RTdW0udG9GaXhlZCg0KSwgZDMuY29sb3IocGllY2V3aXNlQ29sb3IoZW90U3VtIC8gMTApKS5mb3JtYXRIZXgoKSlcbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AbWNtY2NsdXIvYWRhcHRpdmUtcGxvdHRlclxuZnVuY3Rpb24gYnVpbGRfc2FtcGxlcyhmLCBhLCBiLCBvcHRzID0ge30pIHtcbiAgbGV0IHsgTiA9IDksIG1heF9kZXB0aCA9IDYgfSA9IG9wdHM7XG4gIGxldCBkeCA9IChiIC0gYSkgLyBOO1xuICBsZXQgcm9vdF9pbnRlcnZhbHMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBOIH0pLm1hcChcbiAgICAoXywgaSkgPT4gbmV3IEludGVydmFsKGEgKyBpICogZHgsIGEgKyAoaSArIDEpICogZHgsIDApXG4gICk7XG4gIHJvb3RfaW50ZXJ2YWxzLmZvckVhY2goKEkpID0+IHtcbiAgICBJLmZhID0gZihJLmEpO1xuICAgIEkuZmIgPSBmKEkuYik7XG4gIH0pO1xuICByb290X2ludGVydmFscy5yZXZlcnNlKCk7XG4gIGxldCBzdGFjayA9IHJvb3RfaW50ZXJ2YWxzO1xuICBsZXQgY250ID0gMDtcbiAgbGV0IHB0cyA9IFtdO1xuICBsZXQgbm9kZVJpZ2h0LCBub2RlTGVmdDtcbiAgd2hpbGUgKHN0YWNrLmxlbmd0aCA+IDAgJiYgY250KysgPCAxMDAwMDApIHtcbiAgICBsZXQgbm9kZSA9IHN0YWNrLnBvcCgpO1xuICAgIGlmICh0ZXN0KGYsIG5vZGUsIG9wdHMpKSB7XG4gICAgICBsZXQgbWlkcG9pbnQgPSBub2RlLm1pZHBvaW50O1xuICAgICAgbGV0IG5ld19kZXB0aCA9IG5vZGUuZGVwdGggKyAxO1xuICAgICAgaWYgKG5ld19kZXB0aCA8PSBtYXhfZGVwdGgpIHtcbiAgICAgICAgbGV0IGFfbGVmdCA9IG5vZGUuYTtcbiAgICAgICAgbGV0IGJfbGVmdCA9IG1pZHBvaW50O1xuICAgICAgICBub2RlTGVmdCA9IG5ldyBJbnRlcnZhbChhX2xlZnQsIGJfbGVmdCwgbmV3X2RlcHRoKTtcbiAgICAgICAgbm9kZUxlZnQuZmEgPSBmKGFfbGVmdCk7XG4gICAgICAgIG5vZGVMZWZ0LmZiID0gZihiX2xlZnQpO1xuICAgICAgICBub2RlLmxlZnQgPSBub2RlTGVmdDtcblxuICAgICAgICBsZXQgYV9yaWdodCA9IG1pZHBvaW50O1xuICAgICAgICBsZXQgYl9yaWdodCA9IG5vZGUuYjtcbiAgICAgICAgbm9kZVJpZ2h0ID0gbmV3IEludGVydmFsKGFfcmlnaHQsIGJfcmlnaHQsIG5ld19kZXB0aCk7XG4gICAgICAgIG5vZGVSaWdodC5mYSA9IGYoYV9sZWZ0KTtcbiAgICAgICAgbm9kZVJpZ2h0LmZiID0gZihiX2xlZnQpO1xuICAgICAgICBub2RlLnJpZ2h0ID0gbm9kZVJpZ2h0O1xuXG4gICAgICAgIHN0YWNrLnB1c2gobm9kZVJpZ2h0KTtcbiAgICAgICAgc3RhY2sucHVzaChub2RlTGVmdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwdHMucHVzaChub2RlLmEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBwdHMucHVzaChub2RlLmEpO1xuICAgIH1cbiAgfVxuICBwdHMucHVzaChiKTtcbiAgLy8gIHB0cyA9IHB0cy5tYXAoeCA9PiAoeyB4OiB4LCB5OiBmKHgpIH0pKTtcbiAgcHRzID0gcHRzLm1hcCgoeCkgPT4gW3gsIGYoeCldKTtcbiAgaWYgKG9wdHMuc2hvd19yb290cykge1xuICAgIGxldCBmdW5jdGlvbl9yb290cyA9IFtdO1xuICAgIHB0cy5mb3JFYWNoKGZ1bmN0aW9uIChvLCBpKSB7XG4gICAgICBpZiAoaSA8IHB0cy5sZW5ndGggLSAxICYmIE1hdGguc2lnbihvLnkpICE9IE1hdGguc2lnbihwdHNbaSArIDFdLnkpKSB7XG4gICAgICAgIGZ1bmN0aW9uX3Jvb3RzLnB1c2goKG8ueCArIHB0c1tpICsgMV0ueCkgLyAyKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBwdHMuZnVuY3Rpb25fcm9vdHMgPSBmdW5jdGlvbl9yb290cztcbiAgfVxuICByZXR1cm4gcHRzO1xufVxuZnVuY3Rpb24gdGVzdChmLCBJLCBvcHRzID0ge30pIHtcbiAgbGV0IHsgYW5nbGVfdG9sZXJhbmNlID0gMC4wMSwgY2hlY2tfcm9vdHMgPSBmYWxzZSB9ID0gb3B0cztcbiAgbGV0IGEgPSBJLmE7XG4gIGxldCBiID0gSS5iO1xuICBsZXQgZHgyID0gKGIgLSBhKSAvIDI7XG4gIGxldCBtID0gKGEgKyBiKSAvIDI7XG4gIGxldCBmbSA9IGYobSk7XG4gIEkubWlkcG9pbnQgPSBtO1xuICBJLmZfbWlkID0gZm07XG4gIGlmIChjaGVja19yb290cyAmJiBNYXRoLnNpZ24oSS5mYSkgIT0gTWF0aC5zaWduKEkuZmIpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgbGV0IGFscGhhID0gTWF0aC5hdGFuKChJLmZfbWlkIC0gSS5mYSkgLyBkeDIpO1xuICBsZXQgYmV0YSA9IE1hdGguYXRhbigoSS5mYiAtIEkuZl9taWQpIC8gZHgyKTtcbiAgcmV0dXJuIE1hdGguYWJzKGFscGhhIC0gYmV0YSkgPiBhbmdsZV90b2xlcmFuY2U7XG59XG5jbGFzcyBJbnRlcnZhbCB7XG4gIGNvbnN0cnVjdG9yKGEsIGIsIGRlcHRoKSB7XG4gICAgdGhpcy5hID0gYTtcbiAgICB0aGlzLmIgPSBiO1xuICAgIHRoaXMuZGVwdGggPSBkZXB0aDtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh0bWxgXG48c3R5bGU+XG4uY29sb3JOaWdodCB7XG4gIGJhY2tncm91bmQ6ICM0MTZmODY7XG4gIGNvbG9yOiB3aGl0ZTtcbiAgcGFkZGluZzogMHB4IDJweCAwcHggNHB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3JEYXkge1xuICBiYWNrZ3JvdW5kOiAjZmZlNDM4O1xuICBjb2xvcjogYmxhY2s7XG4gIHBhZGRpbmc6IDBweCAzcHggMHB4IDRweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yQmtnIHtcbiAgYmFja2dyb3VuZDogJHt3aW5kb3cuZGFya21vZGUgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBjb2xvcjogJHt3aW5kb3cuZGFya21vZGUgPyBcIndoaXRlXCIgOiBcImJsYWNrXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IwIHtcbiAgYmFja2dyb3VuZDogaHNsKDAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgwLCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMWJ5ODY0MCB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2gxYnk4NjQwfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aDFieTg2NDB9LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMSB7XG4gIGJhY2tncm91bmQ6IGhzbCgzMDAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgzMDAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IyIHtcbiAgYmFja2dyb3VuZDogaHNsKDI4MCAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKDI4MCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjMge1xuICBiYWNrZ3JvdW5kOiBoc2woMjQwIDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woMjQwLCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yNCB7XG4gIGJhY2tncm91bmQ6IGhzbCgyMDAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgyMDAsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I1IHtcbiAgYmFja2dyb3VuZDogaHNsKDE4MCAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKDE4MCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjU4MyB7XG4gIGJhY2tncm91bmQ6IGhzbCgxMjkuODgyMzUyOTQxMTc2NDYgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgxMjkuODgyMzUyOTQxMTc2NDYsIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I2IHtcbiAgYmFja2dyb3VuZDogaHNsKDEyMCAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKDEyMCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjcge1xuICBiYWNrZ3JvdW5kOiBoc2woODAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCg4MCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjgge1xuICBiYWNrZ3JvdW5kOiBoc2woNjAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCg2MCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjkge1xuICBiYWNrZ3JvdW5kOiBoc2woNDAgMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCg0MCwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjM3NSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC4zNzVdfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjM3NV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMDA4MyB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC4wMDgzXX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4wMDgzXX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IwMTY2IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1swLjAxNjZdfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjAxNjZdfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjU1YnkyNCB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbLjAyMjldfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1suMDIyOV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMTI1IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1suMTI1XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbLjEyNV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMDI1IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1swLjAyNV19IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtodWVzWzAuMDI1XX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IyODcge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuMjg3XX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4yODddfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjMzMyB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC4zMzNdfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjMzM119LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMDMzMyB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC4wMzMzXX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC4wMzMzXX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IwNDE2IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1swLjA0MTZdfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjA0MTZdfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjQyOSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC40MjldfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjQyOV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yMDUge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuMDVdfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjA1XX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3I1MzMge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtodWVzWzAuNTMzXX0gMTAwJSA1MCUpO1xuICBjb2xvcjogJHt5aXEoYGhzbCgke2h1ZXNbMC41MzNdfSwgMTAwJSwgNTAlKWApID4gMC41MSA/IFwiYmxhY2tcIiA6IFwid2hpdGVcIn07XG4gIHBhZGRpbmc6IDBweCA1cHg7XG4gIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgZm9udC13ZWlnaHQ6IDQwMDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cbi5jb2xvcjk2OSB7XG4gIGJhY2tncm91bmQ6IGhzbCgke2h1ZXNbMC45NjldfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aHVlc1swLjk2OV19LCAxMDAlLCA1MCUpYCkgPiAwLjUxID8gXCJibGFja1wiIDogXCJ3aGl0ZVwifTtcbiAgcGFkZGluZzogMHB4IDVweDtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBmb250LXdlaWdodDogNDAwO1xuICBmb250LWZhbWlseTogbW9ub3NwYWNlO1xufVxuLmNvbG9yOTk5IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aHVlc1swLjk5OV19IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtodWVzWzAuOTk5XX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3IxYnkzMjAge1xuICBiYWNrZ3JvdW5kOiBoc2woJHtoMWJ5MzIwfSAxMDAlIDUwJSk7XG4gIGNvbG9yOiAke3lpcShgaHNsKCR7aDFieTMyMH0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3JEMTIxIHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aEQxMjF9IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtoRDEyMX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3JEMjY4IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aEQyNjh9IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtoRDI2OH0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3JEMzA1IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aEQzMDV9IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtoRDMwNX0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG4uY29sb3JEMzA2IHtcbiAgYmFja2dyb3VuZDogaHNsKCR7aEQzMDZ9IDEwMCUgNTAlKTtcbiAgY29sb3I6ICR7eWlxKGBoc2woJHtoRDMwNn0sIDEwMCUsIDUwJSlgKSA+IDAuNTEgPyBcImJsYWNrXCIgOiBcIndoaXRlXCJ9O1xuICBwYWRkaW5nOiAwcHggNXB4O1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGZvbnQtd2VpZ2h0OiA0MDA7XG4gIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7XG59XG48L3N0eWxlPlxuYFxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsb2NhdGlvbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsZWFwU2Vjb25kWWVhcicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsZWFwU2Vjb25kRGF0ZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdobXNpbnB1dCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdkaWdpdHMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc29ydFBhcmFtcycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdvZmZzZXQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbG9uZ0lucHV0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2ZhbmN5U2Vjb25kc09GRicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzZWxlY3RlZERhdGUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2VsZWN0ZWRIb3VyJykifV19
</script><script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../dec/time";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/maptv\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../../dec/date/index.html" class="pagination-link" aria-label="Date">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Date</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../dec/snap/index.html" class="pagination-link" aria-label="Snap">
        <span class="nav-page-text">Snap</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Dec Time</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Martin Laptev</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://maptv.github.io</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> /asset/daywide.svg</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> &gt;</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Introducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> true</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">  url: https://maptv.github.io/dec/time</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="an">aliases:</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - /time</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - /dt</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="an">license:</span><span class="co"> CC BY-SA</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> false</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 5</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="an">bread-crumbs:</span><span class="co"> false</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co">    grid:</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">      body-width: 850px</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co">    shift-heading-level-by: 3</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co">    include-after-body:</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/cite.html</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/style.html</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/stamp.html</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../../asset/tooltip.html</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co">  commonmark: default</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co">  - ../../asset/date.lua</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="an">engine:</span><span class="co"> knitr</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>::: {#timenav}</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>{{&lt; include /asset/_decnav.qmd &gt;}}</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>My website provides many examples of the <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://quarto.org)</span> publishing and the <span class="co">[</span><span class="ot">Dec</span><span class="co">](/dec)</span> measurement systems in action. I leverage Quarto support for the <span class="co">[</span><span class="ot">Observable</span><span class="co">](https://observablehq.com/)</span> data analysis and visualization system to create animated and interactive graphics like the <span class="co">[</span><span class="ot">analog clocks</span><span class="co">](https://en.wikipedia.org/wiki/Clock#:~:text=indicate%20time%20with%20a%20traditional%20clock%20face%20and%20moving%20hands)</span>🕓, <span class="co">[</span><span class="ot">bar📊charts</span><span class="co">](https://en.wikipedia.org/wiki/Bar_chart)</span>, <span class="co">[</span><span class="ot">solar☀️terminator</span><span class="co">](https://en.wikipedia.org/wiki/Terminator_%28solar%29#:~:text=a%20moving%20line%20that%20divides%20the%20daylit%20side%20and%20the%20dark%20night%20side%20of%20a%20planetary%20body)</span> map🗺, <span class="co">[</span><span class="ot">Earth🌍orbit</span><span class="co">](https://en.wikipedia.org/wiki/Earth%27s_orbit)</span> diagram, and <span class="co">[</span><span class="ot">daylight</span><span class="co">](https://en.wikipedia.org/wiki/Daylight#:~:text=the%20combination%20of%20all%20direct%20and%20indirect%20sunlight%20during%20the%20daytime)</span> <span class="co">[</span><span class="ot">area chart</span><span class="co">](https://en.wikipedia.org/wiki/Area_chart#:~:text=The%20area%20between%20axis%20and%20line%20are%20commonly%20emphasized%20with%20colors)</span> below.</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fractional day time {#fdt .hiddenheading}</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>Dec times are measured in <span class="co">[</span><span class="ot">fractional days</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#Fractional_days:~:text=a%20decimal%20fraction%20of%20a%20day)</span>. The shortest, longest, and thinnest clock🕓hands and the top, middle, and bottom bars📊indicate the <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, <span class="co">[</span><span class="ot">millidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="thousandths of a day"}, and <span class="co">[</span><span class="ot">centimillidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day"}, respectively, of the time since the start, <span class="co">[</span><span class="ot">+\${decTime}</span><span class="co">]</span>{.point1}, or until the end, <span class="co">[</span><span class="ot">-\${decTimeN}</span><span class="co">]</span>{.point0}, of the day in the Dec <span class="co">[</span><span class="ot">time zone</span><span class="co">](https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time)</span>, \${decZoneHsl}, at the location of the red⭕️circle on the map🗺️beneath the bars📊.</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ticking analog clocks {#tac .hiddenheading}</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>::: clocks</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>\${clock}\${clock1}</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bar chart clocks {#bcc .hiddenheading}</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@fheyen/barchart-clock</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>barChart <span class="op">=</span> {</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeats)))</span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeats))</span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDD)<span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDD))</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMils)<span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMils))</span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb46-148"><a href="#cb46-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb46-149"><a href="#cb46-149" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb46-150"><a href="#cb46-150" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb46-155"><a href="#cb46-155" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb46-156"><a href="#cb46-156" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb46-157"><a href="#cb46-157" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 550 ? 12 : W &lt; 650 ? 14 : W &lt; 750 ? 16 : W &lt; 850 ? 18 : 20}px`)</span></span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb46-160"><a href="#cb46-160" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb46-161"><a href="#cb46-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-163"><a href="#cb46-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-164"><a href="#cb46-164" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb46-165"><a href="#cb46-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-171"><a href="#cb46-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-172"><a href="#cb46-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-173"><a href="#cb46-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb46-177"><a href="#cb46-177" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb46-178"><a href="#cb46-178" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`+</span><span class="sc">${</span>barDD<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMils<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeats<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb46-184"><a href="#cb46-184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb46-185"><a href="#cb46-185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topbar"</span>)<span class="op">;</span></span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-191"><a href="#cb46-191" aria-hidden="true" tabindex="-1"></a>barChart1 <span class="op">=</span> {</span>
<span id="cb46-192"><a href="#cb46-192" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> W <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb46-193"><a href="#cb46-193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">88</span><span class="op">;</span></span>
<span id="cb46-194"><a href="#cb46-194" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-195"><a href="#cb46-195" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb46-198"><a href="#cb46-198" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb46-199"><a href="#cb46-199" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W <span class="op">/</span> <span class="fl">1.14</span><span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDD <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb46-203"><a href="#cb46-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb46-204"><a href="#cb46-204" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleMandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const scaleDek = d3.scaleLinear()</span></span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .domain([0, 37])</span></span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  .range(xRange);</span></span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([</span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a>      <span class="co">// 'dek', 'dotd',</span></span>
<span id="cb46-214"><a href="#cb46-214" aria-hidden="true" tabindex="-1"></a>      <span class="st">'dd'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb46-215"><a href="#cb46-215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-216"><a href="#cb46-216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-217"><a href="#cb46-217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-223"><a href="#cb46-223" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb46-224"><a href="#cb46-224" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barBeatsN)))</span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb46-229"><a href="#cb46-229" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb46-230"><a href="#cb46-230" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barBeatsN))</span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb46-232"><a href="#cb46-232" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-233"><a href="#cb46-233" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(<span class="bu">Number</span>(barDDN)<span class="op">+</span><span class="bu">Number</span>(barMilsN)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">10000</span>))</span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb46-240"><a href="#cb46-240" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb46-241"><a href="#cb46-241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDD</span>(barDDN))</span>
<span id="cb46-242"><a href="#cb46-242" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb46-246"><a href="#cb46-246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(<span class="bu">Number</span>(barMilsN)<span class="op">+</span><span class="bu">Number</span>(barBeatsN)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb46-247"><a href="#cb46-247" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-248"><a href="#cb46-248" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFullN'</span>)</span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleMandB</span>(barMilsN))</span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb46-253"><a href="#cb46-253" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb46-254"><a href="#cb46-254" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb46-261"><a href="#cb46-261" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB1'</span>)</span>
<span id="cb46-262"><a href="#cb46-262" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB1'</span>)</span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-267"><a href="#cb46-267" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb46-268"><a href="#cb46-268" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-273"><a href="#cb46-273" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb46-274"><a href="#cb46-274" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">47</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">50</span>)</span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb46-279"><a href="#cb46-279" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb46-280"><a href="#cb46-280" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX)</span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb46-286"><a href="#cb46-286" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb46-287"><a href="#cb46-287" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb46-290"><a href="#cb46-290" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb46-291"><a href="#cb46-291" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">18</span>)</span>
<span id="cb46-293"><a href="#cb46-293" aria-hidden="true" tabindex="-1"></a>    <span class="co">//.style("font-size", `{W &lt; 350 ? 12 : W &lt; 450 ? 14 : W &lt; 550 ? 16 : W &lt; 650 ? 18 : 20}px`)</span></span>
<span id="cb46-294"><a href="#cb46-294" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC2'</span>)</span>
<span id="cb46-297"><a href="#cb46-297" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-298"><a href="#cb46-298" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-299"><a href="#cb46-299" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC2'</span>)</span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">10</span>)</span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-307"><a href="#cb46-307" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-308"><a href="#cb46-308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDD</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`-</span><span class="sc">${</span>barDDN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMilsN<span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeatsN<span class="sc">}</span><span class="vs">`</span>])</span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb46-320"><a href="#cb46-320" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb46-321"><a href="#cb46-321" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>W <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">14</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">16</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> W <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> <span class="dv">22</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)<span class="op">;</span></span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmbar"</span>)<span class="op">;</span></span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'barclock'</span>)</span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a><span class="fu">## Longitude latitude map {#llm .hiddenheading}</span></span>
<span id="cb46-330"><a href="#cb46-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a>viewof location <span class="op">=</span> <span class="fu">worldMapCoordinates</span>([<span class="dv">162</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [width <span class="op">*</span> <span class="op">.</span><span class="dv">998</span><span class="op">,</span> ((<span class="dv">21</span> <span class="op">/</span> <span class="dv">40</span>) <span class="op">*</span> width)])</span>
<span id="cb46-336"><a href="#cb46-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-337"><a href="#cb46-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daylight area chart {#dac .hiddenheading}</span></span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-343"><a href="#cb46-343" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-344"><a href="#cb46-344" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb46-345"><a href="#cb46-345" aria-hidden="true" tabindex="-1"></a>app <span class="op">=</span> {</span>
<span id="cb46-346"><a href="#cb46-346" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(DOM<span class="op">.</span><span class="fu">svg</span>(width<span class="op">,</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">97</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">96</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">94</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">.</span><span class="dv">93</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">.</span><span class="dv">92</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">.</span><span class="dv">86</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">.</span><span class="dv">82</span> <span class="op">:</span> <span class="op">.</span><span class="dv">78</span>)))<span class="op">;</span></span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">style</span>(<span class="st">"user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"-webkit-user-select"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"daylightapp"</span>)<span class="op">;</span></span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> {<span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">16</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">inner</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">;</span></span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> contentWidth <span class="op">=</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">inner</span><span class="op">;</span></span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> columnWidth <span class="op">=</span> contentWidth <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> selection <span class="op">=</span> {</span>
<span id="cb46-352"><a href="#cb46-352" aria-hidden="true" tabindex="-1"></a>    <span class="dt">date</span><span class="op">:</span> date2022<span class="op">,</span></span>
<span id="cb46-353"><a href="#cb46-353" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hour</span><span class="op">:</span> date2022<span class="op">.</span><span class="fu">getHours</span>()</span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderPlot <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#plot *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">select</span>(<span class="st">"#plot"</span>)<span class="op">.</span><span class="fu">call</span>(daylightPlot<span class="op">,</span> {</span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vizwidth</span><span class="op">:</span> columnWidth <span class="op">/</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.25</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.4</span> <span class="op">:</span> <span class="fl">1.48</span>)<span class="op">,</span></span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a>      <span class="dt">height</span><span class="op">:</span> height <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="fl">1.62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.6</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.58</span> <span class="op">:</span> <span class="fl">1.56</span>)<span class="op">,</span></span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a>      <span class="dt">year</span><span class="op">:</span> <span class="dv">2022</span><span class="op">,</span></span>
<span id="cb46-361"><a href="#cb46-361" aria-hidden="true" tabindex="-1"></a>      <span class="dt">latitude</span><span class="op">:</span> location[<span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb46-362"><a href="#cb46-362" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultDate</span><span class="op">:</span> selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb46-363"><a href="#cb46-363" aria-hidden="true" tabindex="-1"></a>      <span class="dt">defaultHour</span><span class="op">:</span> selection<span class="op">.</span><span class="at">hour</span></span>
<span id="cb46-364"><a href="#cb46-364" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb46-365"><a href="#cb46-365" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-366"><a href="#cb46-366" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> renderSolarSystem <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system *"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"#solar-system"</span>)<span class="op">.</span><span class="fu">call</span>(solarSystem<span class="op">,</span></span>
<span id="cb46-369"><a href="#cb46-369" aria-hidden="true" tabindex="-1"></a>                                        columnWidth <span class="op">*</span> <span class="fl">2.02</span><span class="op">,</span></span>
<span id="cb46-370"><a href="#cb46-370" aria-hidden="true" tabindex="-1"></a>                                        location<span class="op">,</span></span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">date</span><span class="op">,</span></span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a>                                        selection<span class="op">.</span><span class="at">hour</span><span class="op">,</span></span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a>                                        <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span>)<span class="op">;</span></span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const renderGlobe = () =&gt; {</span></span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe *").remove();</span></span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   svg.selectAll("#globe").call(globe, { vizwidth: columnWidth / 1.28, location, ...selection });</span></span>
<span id="cb46-378"><a href="#cb46-378" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb46-379"><a href="#cb46-379" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> setSelection <span class="op">=</span> (newSelection<span class="op">,</span> forceRender <span class="op">=</span> <span class="kw">false</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prev <span class="op">=</span> {<span class="op">...</span>selection}<span class="op">;</span></span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> newSelection<span class="op">;</span></span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="at">value</span> <span class="op">=</span> selection<span class="op">;</span></span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedDate<span class="op">,</span> selection<span class="op">.</span><span class="at">date</span>)<span class="op">;</span></span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof selectedHour<span class="op">,</span> selection<span class="op">.</span><span class="at">hour</span>)<span class="op">;</span></span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (forceRender) {</span>
<span id="cb46-386"><a href="#cb46-386" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderPlot</span>()<span class="op">;</span></span>
<span id="cb46-387"><a href="#cb46-387" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (prev<span class="op">.</span><span class="at">hour</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">hour</span> <span class="op">||</span> prev<span class="op">.</span><span class="at">date</span> <span class="op">!==</span> selection<span class="op">.</span><span class="at">date</span>) {</span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a>      <span class="fu">renderSolarSystem</span>()<span class="op">;</span></span>
<span id="cb46-391"><a href="#cb46-391" aria-hidden="true" tabindex="-1"></a>  <span class="co">//    renderGlobe();</span></span>
<span id="cb46-392"><a href="#cb46-392" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-393"><a href="#cb46-393" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-394"><a href="#cb46-394" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plot <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"plot"</span>)</span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">0</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>height <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">12</span> <span class="op">:</span> <span class="dv">5</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-397"><a href="#cb46-397" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-398"><a href="#cb46-398" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"solar-system"</span>)</span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">12</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">22</span> <span class="op">-</span> <span class="dv">6</span> <span class="op">-</span> <span class="dv">5</span> <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">400</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a>  <span class="co">// svg.append("g")</span></span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("id", "globe")</span></span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .attr("transform", `translate(${margin.left + margin.inner + columnWidth / 2 + 20}, ${margin.top + height / 1.2 + 4})`);</span></span>
<span id="cb46-403"><a href="#cb46-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setSelection</span>(selection<span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb46-404"><a href="#cb46-404" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateHourChange <span class="op">=</span> ({ target<span class="op">,</span> <span class="dt">detail</span><span class="op">:</span> { date<span class="op">,</span> hour }}) <span class="kw">=&gt;</span> {</span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (date <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> hour <span class="op">!=</span> <span class="kw">null</span>) <span class="fu">setSelection</span>({<span class="op">...</span>selection<span class="op">,</span> date<span class="op">,</span> hour})<span class="op">;</span></span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">addEventListener</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> handleDateHourChange<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@d3/simple-clock</span></span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@drio/lets-build-an-analog-clock</span></span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a>clock <span class="op">=</span> {</span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb46-415"><a href="#cb46-415" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb46-416"><a href="#cb46-416" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb46-417"><a href="#cb46-417" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb46-418"><a href="#cb46-418" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb46-419"><a href="#cb46-419" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb46-420"><a href="#cb46-420" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb46-421"><a href="#cb46-421" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb46-422"><a href="#cb46-422" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb46-423"><a href="#cb46-423" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb46-424"><a href="#cb46-424" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb46-425"><a href="#cb46-425" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb46-426"><a href="#cb46-426" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb46-427"><a href="#cb46-427" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb46-428"><a href="#cb46-428" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb46-429"><a href="#cb46-429" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb46-430"><a href="#cb46-430" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb46-431"><a href="#cb46-431" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-432"><a href="#cb46-432" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb46-433"><a href="#cb46-433" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb46-434"><a href="#cb46-434" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb46-435"><a href="#cb46-435" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-436"><a href="#cb46-436" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb46-437"><a href="#cb46-437" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb46-438"><a href="#cb46-438" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb46-439"><a href="#cb46-439" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-440"><a href="#cb46-440" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb46-441"><a href="#cb46-441" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb46-442"><a href="#cb46-442" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb46-443"><a href="#cb46-443" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb46-444"><a href="#cb46-444" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb46-445"><a href="#cb46-445" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-446"><a href="#cb46-446" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb46-447"><a href="#cb46-447" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb46-448"><a href="#cb46-448" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb46-449"><a href="#cb46-449" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb46-450"><a href="#cb46-450" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb46-451"><a href="#cb46-451" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-452"><a href="#cb46-452" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb46-453"><a href="#cb46-453" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb46-454"><a href="#cb46-454" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb46-455"><a href="#cb46-455" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb46-456"><a href="#cb46-456" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb46-457"><a href="#cb46-457" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-458"><a href="#cb46-458" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb46-459"><a href="#cb46-459" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb46-460"><a href="#cb46-460" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb46-461"><a href="#cb46-461" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb46-462"><a href="#cb46-462" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb46-463"><a href="#cb46-463" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-464"><a href="#cb46-464" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb46-465"><a href="#cb46-465" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-466"><a href="#cb46-466" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb46-467"><a href="#cb46-467" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-468"><a href="#cb46-468" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb46-469"><a href="#cb46-469" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-470"><a href="#cb46-470" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-471"><a href="#cb46-471" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb46-472"><a href="#cb46-472" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb46-473"><a href="#cb46-473" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-474"><a href="#cb46-474" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-475"><a href="#cb46-475" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb46-476"><a href="#cb46-476" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb46-477"><a href="#cb46-477" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-478"><a href="#cb46-478" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb46-479"><a href="#cb46-479" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-480"><a href="#cb46-480" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb46-481"><a href="#cb46-481" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb46-482"><a href="#cb46-482" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-483"><a href="#cb46-483" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-484"><a href="#cb46-484" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb46-485"><a href="#cb46-485" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-486"><a href="#cb46-486" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb46-487"><a href="#cb46-487" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb46-488"><a href="#cb46-488" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb46-489"><a href="#cb46-489" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb46-490"><a href="#cb46-490" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb46-491"><a href="#cb46-491" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-492"><a href="#cb46-492" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb46-493"><a href="#cb46-493" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb46-494"><a href="#cb46-494" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-495"><a href="#cb46-495" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb46-496"><a href="#cb46-496" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb46-497"><a href="#cb46-497" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-498"><a href="#cb46-498" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb46-499"><a href="#cb46-499" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb46-500"><a href="#cb46-500" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-501"><a href="#cb46-501" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-502"><a href="#cb46-502" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb46-503"><a href="#cb46-503" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb46-504"><a href="#cb46-504" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-505"><a href="#cb46-505" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-506"><a href="#cb46-506" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb46-507"><a href="#cb46-507" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb46-508"><a href="#cb46-508" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-509"><a href="#cb46-509" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-510"><a href="#cb46-510" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb46-511"><a href="#cb46-511" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-512"><a href="#cb46-512" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb46-513"><a href="#cb46-513" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb46-514"><a href="#cb46-514" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb46-515"><a href="#cb46-515" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb46-516"><a href="#cb46-516" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-517"><a href="#cb46-517" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb46-518"><a href="#cb46-518" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb46-519"><a href="#cb46-519" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb46-520"><a href="#cb46-520" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb46-521"><a href="#cb46-521" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb46-522"><a href="#cb46-522" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-523"><a href="#cb46-523" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb46-524"><a href="#cb46-524" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb46-525"><a href="#cb46-525" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-526"><a href="#cb46-526" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb46-527"><a href="#cb46-527" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-528"><a href="#cb46-528" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb46-529"><a href="#cb46-529" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-530"><a href="#cb46-530" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-531"><a href="#cb46-531" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-532"><a href="#cb46-532" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb46-533"><a href="#cb46-533" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb46-534"><a href="#cb46-534" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb46-535"><a href="#cb46-535" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-536"><a href="#cb46-536" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-537"><a href="#cb46-537" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb46-538"><a href="#cb46-538" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-539"><a href="#cb46-539" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb46-540"><a href="#cb46-540" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb46-541"><a href="#cb46-541" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb46-542"><a href="#cb46-542" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb46-543"><a href="#cb46-543" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb46-544"><a href="#cb46-544" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb46-545"><a href="#cb46-545" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb46-546"><a href="#cb46-546" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-547"><a href="#cb46-547" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-548"><a href="#cb46-548" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb46-549"><a href="#cb46-549" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTime[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb46-550"><a href="#cb46-550" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb46-551"><a href="#cb46-551" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExact <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb46-552"><a href="#cb46-552" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-553"><a href="#cb46-553" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb46-554"><a href="#cb46-554" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb46-555"><a href="#cb46-555" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb46-556"><a href="#cb46-556" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb46-557"><a href="#cb46-557" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb46-558"><a href="#cb46-558" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"topclock"</span>)<span class="op">;</span></span>
<span id="cb46-559"><a href="#cb46-559" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-560"><a href="#cb46-560" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-561"><a href="#cb46-561" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`+</span><span class="sc">${</span>decTime<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb46-562"><a href="#cb46-562" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb46-563"><a href="#cb46-563" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb46-564"><a href="#cb46-564" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-565"><a href="#cb46-565" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb46-566"><a href="#cb46-566" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb46-567"><a href="#cb46-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb46-568"><a href="#cb46-568" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb46-569"><a href="#cb46-569" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb46-570"><a href="#cb46-570" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb46-571"><a href="#cb46-571" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb46-572"><a href="#cb46-572" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb46-573"><a href="#cb46-573" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb46-574"><a href="#cb46-574" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb46-575"><a href="#cb46-575" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb46-576"><a href="#cb46-576" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb46-577"><a href="#cb46-577" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb46-578"><a href="#cb46-578" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-579"><a href="#cb46-579" aria-hidden="true" tabindex="-1"></a>clock1 <span class="op">=</span> {</span>
<span id="cb46-580"><a href="#cb46-580" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clockRadius <span class="op">=</span> <span class="dv">200</span><span class="op">,</span></span>
<span id="cb46-581"><a href="#cb46-581" aria-hidden="true" tabindex="-1"></a>    margin <span class="op">=</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb46-582"><a href="#cb46-582" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb46-583"><a href="#cb46-583" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> (clockRadius <span class="op">+</span> margin) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb46-584"><a href="#cb46-584" aria-hidden="true" tabindex="-1"></a>    hourHandLength <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> clockRadius) <span class="op">/</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb46-585"><a href="#cb46-585" aria-hidden="true" tabindex="-1"></a>    minuteHandLength <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb46-586"><a href="#cb46-586" aria-hidden="true" tabindex="-1"></a>    secondHandLength <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">12</span><span class="op">,</span></span>
<span id="cb46-587"><a href="#cb46-587" aria-hidden="true" tabindex="-1"></a>    secondHandBalance <span class="op">=</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb46-588"><a href="#cb46-588" aria-hidden="true" tabindex="-1"></a>    secondTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb46-589"><a href="#cb46-589" aria-hidden="true" tabindex="-1"></a>    secondTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb46-590"><a href="#cb46-590" aria-hidden="true" tabindex="-1"></a>    hourTickStart <span class="op">=</span> clockRadius<span class="op">,</span></span>
<span id="cb46-591"><a href="#cb46-591" aria-hidden="true" tabindex="-1"></a>    hourTickLength <span class="op">=</span> <span class="op">-</span><span class="dv">18</span><span class="op">,</span></span>
<span id="cb46-592"><a href="#cb46-592" aria-hidden="true" tabindex="-1"></a>    secondLabelRadius <span class="op">=</span> clockRadius <span class="op">+</span> <span class="dv">16</span><span class="op">,</span></span>
<span id="cb46-593"><a href="#cb46-593" aria-hidden="true" tabindex="-1"></a>    secondLabelYOffset <span class="op">=</span> <span class="dv">5</span><span class="op">,</span></span>
<span id="cb46-594"><a href="#cb46-594" aria-hidden="true" tabindex="-1"></a>    hourLabelRadius <span class="op">=</span> clockRadius <span class="op">-</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb46-595"><a href="#cb46-595" aria-hidden="true" tabindex="-1"></a>    hourLabelYOffset <span class="op">=</span> <span class="dv">7</span><span class="op">,</span></span>
<span id="cb46-596"><a href="#cb46-596" aria-hidden="true" tabindex="-1"></a>    radians <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb46-597"><a href="#cb46-597" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> ten <span class="op">=</span> d3</span>
<span id="cb46-598"><a href="#cb46-598" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-599"><a href="#cb46-599" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb46-600"><a href="#cb46-600" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb46-601"><a href="#cb46-601" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sto <span class="op">=</span> d3</span>
<span id="cb46-602"><a href="#cb46-602" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-603"><a href="#cb46-603" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">360</span>])</span>
<span id="cb46-604"><a href="#cb46-604" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])<span class="op">;</span></span>
<span id="cb46-605"><a href="#cb46-605" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handData <span class="op">=</span> [</span>
<span id="cb46-606"><a href="#cb46-606" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-607"><a href="#cb46-607" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"hour"</span><span class="op">,</span></span>
<span id="cb46-608"><a href="#cb46-608" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb46-609"><a href="#cb46-609" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>hourHandLength<span class="op">,</span></span>
<span id="cb46-610"><a href="#cb46-610" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> ten</span>
<span id="cb46-611"><a href="#cb46-611" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb46-612"><a href="#cb46-612" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-613"><a href="#cb46-613" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"minute"</span><span class="op">,</span></span>
<span id="cb46-614"><a href="#cb46-614" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb46-615"><a href="#cb46-615" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>minuteHandLength<span class="op">,</span></span>
<span id="cb46-616"><a href="#cb46-616" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto</span>
<span id="cb46-617"><a href="#cb46-617" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb46-618"><a href="#cb46-618" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb46-619"><a href="#cb46-619" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"second"</span><span class="op">,</span></span>
<span id="cb46-620"><a href="#cb46-620" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb46-621"><a href="#cb46-621" aria-hidden="true" tabindex="-1"></a>      <span class="dt">length</span><span class="op">:</span> <span class="op">-</span>secondHandLength<span class="op">,</span></span>
<span id="cb46-622"><a href="#cb46-622" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> sto<span class="op">,</span></span>
<span id="cb46-623"><a href="#cb46-623" aria-hidden="true" tabindex="-1"></a>      <span class="dt">balance</span><span class="op">:</span> secondHandBalance</span>
<span id="cb46-624"><a href="#cb46-624" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-625"><a href="#cb46-625" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb46-626"><a href="#cb46-626" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">drawClock</span>() {</span>
<span id="cb46-627"><a href="#cb46-627" aria-hidden="true" tabindex="-1"></a>    <span class="co">// create all the clock elements</span></span>
<span id="cb46-628"><a href="#cb46-628" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateData</span>()<span class="op">;</span> <span class="co">//draw them in the correct starting position</span></span>
<span id="cb46-629"><a href="#cb46-629" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> face <span class="op">=</span> svg</span>
<span id="cb46-630"><a href="#cb46-630" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-631"><a href="#cb46-631" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-face"</span>)</span>
<span id="cb46-632"><a href="#cb46-632" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>[w <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> h <span class="op">/</span> <span class="dv">2</span>]<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-633"><a href="#cb46-633" aria-hidden="true" tabindex="-1"></a>    <span class="co">// add marks for seconds</span></span>
<span id="cb46-634"><a href="#cb46-634" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-635"><a href="#cb46-635" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-tick"</span>)</span>
<span id="cb46-636"><a href="#cb46-636" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb46-637"><a href="#cb46-637" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-638"><a href="#cb46-638" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb46-639"><a href="#cb46-639" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-tick"</span>)</span>
<span id="cb46-640"><a href="#cb46-640" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-641"><a href="#cb46-641" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-642"><a href="#cb46-642" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> secondTickStart)</span>
<span id="cb46-643"><a href="#cb46-643" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> secondTickStart <span class="op">+</span> secondTickLength)</span>
<span id="cb46-644"><a href="#cb46-644" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">sto</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-645"><a href="#cb46-645" aria-hidden="true" tabindex="-1"></a>    <span class="co">// and labels...</span></span>
<span id="cb46-646"><a href="#cb46-646" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-647"><a href="#cb46-647" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".second-label"</span>)</span>
<span id="cb46-648"><a href="#cb46-648" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">5</span>))</span>
<span id="cb46-649"><a href="#cb46-649" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-650"><a href="#cb46-650" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-651"><a href="#cb46-651" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"second-label"</span>)</span>
<span id="cb46-652"><a href="#cb46-652" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-653"><a href="#cb46-653" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians))</span>
<span id="cb46-654"><a href="#cb46-654" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb46-655"><a href="#cb46-655" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb46-656"><a href="#cb46-656" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span></span>
<span id="cb46-657"><a href="#cb46-657" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span>secondLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">sto</span>(d) <span class="op">*</span> radians) <span class="op">+</span> secondLabelYOffset</span>
<span id="cb46-658"><a href="#cb46-658" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-659"><a href="#cb46-659" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb46-660"><a href="#cb46-660" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... and hours</span></span>
<span id="cb46-661"><a href="#cb46-661" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-662"><a href="#cb46-662" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-tick"</span>)</span>
<span id="cb46-663"><a href="#cb46-663" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb46-664"><a href="#cb46-664" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-665"><a href="#cb46-665" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb46-666"><a href="#cb46-666" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-tick"</span>)</span>
<span id="cb46-667"><a href="#cb46-667" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-668"><a href="#cb46-668" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-669"><a href="#cb46-669" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> hourTickStart)</span>
<span id="cb46-670"><a href="#cb46-670" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> hourTickStart <span class="op">+</span> hourTickLength)</span>
<span id="cb46-671"><a href="#cb46-671" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span><span class="fu">ten</span>(d)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-672"><a href="#cb46-672" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-673"><a href="#cb46-673" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".hour-label"</span>)</span>
<span id="cb46-674"><a href="#cb46-674" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb46-675"><a href="#cb46-675" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-676"><a href="#cb46-676" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-677"><a href="#cb46-677" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hour-label"</span>)</span>
<span id="cb46-678"><a href="#cb46-678" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-679"><a href="#cb46-679" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> d <span class="kw">=&gt;</span> hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians))</span>
<span id="cb46-680"><a href="#cb46-680" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb46-681"><a href="#cb46-681" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb46-682"><a href="#cb46-682" aria-hidden="true" tabindex="-1"></a>        d <span class="kw">=&gt;</span> <span class="op">-</span>hourLabelRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="fu">ten</span>(d) <span class="op">*</span> radians) <span class="op">+</span> hourLabelYOffset</span>
<span id="cb46-683"><a href="#cb46-683" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb46-684"><a href="#cb46-684" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb46-685"><a href="#cb46-685" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hands <span class="op">=</span> face<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"clock-hands"</span>)<span class="op">;</span></span>
<span id="cb46-686"><a href="#cb46-686" aria-hidden="true" tabindex="-1"></a>    hands</span>
<span id="cb46-687"><a href="#cb46-687" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb46-688"><a href="#cb46-688" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb46-689"><a href="#cb46-689" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb46-690"><a href="#cb46-690" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb46-691"><a href="#cb46-691" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">+</span> <span class="st">"-hand"</span>)</span>
<span id="cb46-692"><a href="#cb46-692" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-693"><a href="#cb46-693" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">balance</span> <span class="op">||</span> <span class="dv">0</span>)</span>
<span id="cb46-694"><a href="#cb46-694" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-695"><a href="#cb46-695" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb46-696"><a href="#cb46-696" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-697"><a href="#cb46-697" aria-hidden="true" tabindex="-1"></a>    face</span>
<span id="cb46-698"><a href="#cb46-698" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-699"><a href="#cb46-699" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"face-overlay"</span>)</span>
<span id="cb46-700"><a href="#cb46-700" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb46-701"><a href="#cb46-701" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"hands-cover"</span>)</span>
<span id="cb46-702"><a href="#cb46-702" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-703"><a href="#cb46-703" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-704"><a href="#cb46-704" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> clockRadius <span class="op">/</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb46-705"><a href="#cb46-705" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-706"><a href="#cb46-706" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">moveHands</span>() {</span>
<span id="cb46-707"><a href="#cb46-707" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sel <span class="op">=</span> d3</span>
<span id="cb46-708"><a href="#cb46-708" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#clock-hands-final"</span>)</span>
<span id="cb46-709"><a href="#cb46-709" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"line"</span>)</span>
<span id="cb46-710"><a href="#cb46-710" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(handData)</span>
<span id="cb46-711"><a href="#cb46-711" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()<span class="op">;</span></span>
<span id="cb46-712"><a href="#cb46-712" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (fancySecondsOFF) sel<span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeElastic</span><span class="op">.</span><span class="fu">period</span>(<span class="fl">0.5</span>))<span class="op">;</span></span>
<span id="cb46-713"><a href="#cb46-713" aria-hidden="true" tabindex="-1"></a>    sel<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`rotate(</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">scale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-714"><a href="#cb46-714" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-715"><a href="#cb46-715" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">updateData</span>() {</span>
<span id="cb46-716"><a href="#cb46-716" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">0</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span>) <span class="op">:</span> decTimeN[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb46-717"><a href="#cb46-717" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">1</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span>) <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb46-718"><a href="#cb46-718" aria-hidden="true" tabindex="-1"></a>    handData[<span class="dv">2</span>]<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>fancySecondsOFF <span class="op">?</span> selectedExactN <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">100</span> <span class="op">:</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb46-719"><a href="#cb46-719" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-720"><a href="#cb46-720" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb46-721"><a href="#cb46-721" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb46-722"><a href="#cb46-722" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> w<span class="op">,</span> h])</span>
<span id="cb46-723"><a href="#cb46-723" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"max-width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width <span class="op">/</span> <span class="fl">2.1</span><span class="sc">}</span><span class="vs">px`</span>)</span>
<span id="cb46-724"><a href="#cb46-724" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"analogclock"</span>)</span>
<span id="cb46-725"><a href="#cb46-725" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"btmclock"</span>)<span class="op">;</span></span>
<span id="cb46-726"><a href="#cb46-726" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb46-727"><a href="#cb46-727" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-728"><a href="#cb46-728" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="vs">`-</span><span class="sc">${</span>decTimeN<span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>selectedZone<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb46-729"><a href="#cb46-729" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> clockRadius <span class="op">+</span> margin)</span>
<span id="cb46-730"><a href="#cb46-730" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> clockRadius <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> margin <span class="op">*</span> <span class="fl">2.1</span>)</span>
<span id="cb46-731"><a href="#cb46-731" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-732"><a href="#cb46-732" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">32</span>)</span>
<span id="cb46-733"><a href="#cb46-733" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb46-734"><a href="#cb46-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawClock</span>()<span class="op">;</span></span>
<span id="cb46-735"><a href="#cb46-735" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Animation</span></span>
<span id="cb46-736"><a href="#cb46-736" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(</span>
<span id="cb46-737"><a href="#cb46-737" aria-hidden="true" tabindex="-1"></a>    () <span class="kw">=&gt;</span> {</span>
<span id="cb46-738"><a href="#cb46-738" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateData</span>()<span class="op">;</span></span>
<span id="cb46-739"><a href="#cb46-739" aria-hidden="true" tabindex="-1"></a>      <span class="fu">moveHands</span>()<span class="op">;</span></span>
<span id="cb46-740"><a href="#cb46-740" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb46-741"><a href="#cb46-741" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>fancySecondsOFF <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">864</span></span>
<span id="cb46-742"><a href="#cb46-742" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb46-743"><a href="#cb46-743" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="pp">clearInterval</span>(interval))<span class="op">;</span></span>
<span id="cb46-744"><a href="#cb46-744" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb46-745"><a href="#cb46-745" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-746"><a href="#cb46-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-747"><a href="#cb46-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-748"><a href="#cb46-748" aria-hidden="true" tabindex="-1"></a>To rotate the globe🌐in the Earth🌏orbit diagram, drag the red⭕️circle horizontally↔️or slide the red🔴dot on the daylight area chart vertically↕. The red⭕️circle's vertical↕position determines the yearly daylight pattern visualized by the area chart. Shift the red<span class="dt">&lt;</span><span class="kw">font</span><span class="ot"> color</span><span class="op">=</span><span class="st">red</span><span class="dt">&gt;</span>—<span class="dt">&lt;/</span><span class="kw">font</span><span class="dt">&gt;</span>line on the area chart horizontally↔️to move the globe🌐along the ellipse of the Earth🌎orbit.</span>
<span id="cb46-749"><a href="#cb46-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-750"><a href="#cb46-750" aria-hidden="true" tabindex="-1"></a><span class="fu">## Yearly day aggregate (yda) {#yda .hiddenheading}</span></span>
<span id="cb46-751"><a href="#cb46-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-752"><a href="#cb46-752" aria-hidden="true" tabindex="-1"></a>The red<span class="dt">&lt;</span><span class="kw">font</span><span class="ot"> color</span><span class="op">=</span><span class="st">red</span><span class="dt">&gt;</span>—<span class="dt">&lt;/</span><span class="kw">font</span><span class="dt">&gt;</span>line indicates a "day of year" (<span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"}), \${selDateHsl}, and the red🔴dot denotes a "time of day" (<span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}): \${selTimeDay}. A <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} identifies a day in a year like a <span class="co">[</span><span class="ot">Gregorian calendar</span><span class="co">](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)</span> month and "day of month" (<span class="co">[</span><span class="ot">dom</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of month"}). A <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} specifies a point in a day like an "hour minute second" (<span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"}) triplet.</span>
<span id="cb46-753"><a href="#cb46-753" aria-hidden="true" tabindex="-1"></a>Together, a <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} and <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} can form a "yearly day aggregate" (<span class="co">[</span><span class="ot">yda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="yearly day aggregate"}): \${selSnapDay}.</span>
<span id="cb46-754"><a href="#cb46-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-755"><a href="#cb46-755" aria-hidden="true" tabindex="-1"></a>$$\text{yda} = \text{doy} + \text{tod}$$</span>
<span id="cb46-756"><a href="#cb46-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-757"><a href="#cb46-757" aria-hidden="true" tabindex="-1"></a>$$\lfloor\text{yda}\rfloor = \text{doy}$$</span>
<span id="cb46-758"><a href="#cb46-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-759"><a href="#cb46-759" aria-hidden="true" tabindex="-1"></a>$$\text{yda} - \text{doy} = \text{tod}$$</span>
<span id="cb46-760"><a href="#cb46-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-761"><a href="#cb46-761" aria-hidden="true" tabindex="-1"></a>As their names suggest, <span class="co">[</span><span class="ot">doys</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="days of year"} and <span class="co">[</span><span class="ot">ydas</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="yearly day aggregates"} are measured in days. The <span class="co">[</span><span class="ot">measurement unit</span><span class="co">](https://en.wikipedia.org/wiki/Unit_of_measurement#:~:text=a%20definite%20magnitude%20of%20a%20quantity)</span> of a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} can be a day or a <span class="co">[</span><span class="ot">submultiple</span><span class="co">](https://en.wikipedia.org/wiki/Multiple_%28mathematics%29#Submultiple:~:text=of%20%22a%20being-,a%20unit%20fraction,-of%20b%22%20)</span> of a day. By changing how a decimal <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} is measured, we can shift its <span class="co">[</span><span class="ot">decimal separator</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_separator#:~:text=a%20symbol%20that%20separates%20the%20integer%20part%20from%20the%20fractional%20part%20of%20a%20number)</span> or turn it into an integer. The <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} along the y-axis of the area chart are integers because they have three digits and are measured in <span class="co">[</span><span class="ot">millidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="thousandths of a day"}.</span>
<span id="cb46-762"><a href="#cb46-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-763"><a href="#cb46-763" aria-hidden="true" tabindex="-1"></a><span class="fu">## Epochal day aggregate (eda) {#eda .hiddenheading}</span></span>
<span id="cb46-764"><a href="#cb46-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-765"><a href="#cb46-765" aria-hidden="true" tabindex="-1"></a>We can turn an <span class="co">[</span><span class="ot">yda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="yearly day aggregate"} into a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} by <span class="co">[</span><span class="ot">keeping the remainder after dividing</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> by one to isolate the <span class="co">[</span><span class="ot">decimal part</span><span class="co">](https://en.wikipedia.org/wiki/Fractional_part#:~:text=the%20excess%20beyond%20that%20number%27s%20integer%20part)</span> of the <span class="co">[</span><span class="ot">quotient</span><span class="co">](https://en.wikipedia.org/wiki/Quotient#:~:text=a%20quantity%20produced%20by%20the%20division%20of%20two%20numbers)</span>: \${zeroYdaHsl} <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 = \${zeroTimeHsl0}. We can use this same approach to obtain a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} from an "epochal day aggregate" (<span class="co">[</span><span class="ot">eda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="epochal day aggregate"}): \${zeroDoteHsl} mod 1 = \${zeroTimeHsl1}. The current <span class="co">[</span><span class="ot">eda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="epochal day aggregate"} tells us how many days have passed since the Dec <span class="co">[</span><span class="ot">epoch</span><span class="co">](https://en.wikipedia.org/wiki/Epoch#:~:text=an%20instant%20in%20time%20chosen%20as%20the%20origin%20of%20a%20particular%20calendar%20era)</span>.</span>
<span id="cb46-766"><a href="#cb46-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-767"><a href="#cb46-767" aria-hidden="true" tabindex="-1"></a>$$\text{tod} = \text{yda mod } 1 = \text{eda mod } 1$$</span>
<span id="cb46-768"><a href="#cb46-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-769"><a href="#cb46-769" aria-hidden="true" tabindex="-1"></a><span class="fu">## UNIX time equation {#ute .hiddenheading}</span></span>
<span id="cb46-770"><a href="#cb46-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-771"><a href="#cb46-771" aria-hidden="true" tabindex="-1"></a>Similarly, <span class="co">[</span><span class="ot">UNIX time</span><span class="co">](https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970%2C%20the%20Unix%20epoch)</span> tallies the seconds since the <span class="co">[</span><span class="ot">UNIX epoch</span><span class="co">](https://en.wikipedia.org/wiki/Unix_time#:~:text=00%3A00%3A00%20UTC%20on%201%C2%A0January%201970)</span>, which is exactly 719468 days after the Dec epoch. To get the <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, the Dec time zone that is in between the two leftmost vertical lines on the map🗺️, we can divide UNIX time by the <span class="co">[</span><span class="ot">number of seconds in a day</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Day#:~:text=average%2C%20this%20is-,24%20hours%20(86%2C400%20seconds),-.%20As%20a%20day) and then keep the remainder after dividing the resulting days by one:</span>
<span id="cb46-772"><a href="#cb46-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-773"><a href="#cb46-773" aria-hidden="true" tabindex="-1"></a>$$\text{tod} = \text{unix} \div 86400 \text{ mod } 1$$</span>
<span id="cb46-774"><a href="#cb46-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-775"><a href="#cb46-775" aria-hidden="true" tabindex="-1"></a><span class="fu">## Julian time equation {#jte .hiddenheading}</span></span>
<span id="cb46-776"><a href="#cb46-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-777"><a href="#cb46-777" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Julian dates</span><span class="co">](https://en.wikipedia.org/wiki/Julian_day#:~:text=the%20Julian%20day%20number%20plus%20the%20fraction%20of%20a%20day%20since%20the%20preceding%20noon)</span> track the days since the beginning of the <span class="co">[</span><span class="ot">Julian period</span><span class="co">](https://en.wikipedia.org/wiki/Julian_day#:~:text=a%20chronological%20interval%20of%207980%C2%A0years%2C%20derived%20from%20three%20multi%2Dyear%20cycles:%20the%20Indiction%2C%20Solar%2C%20and%20Lunar%20cycles)</span> and thus are akin to <span class="co">[</span><span class="ot">edas</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="epochal day aggregates"}. We can produce a Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} from a <span class="co">[</span><span class="ot">Julian date</span><span class="co">](https://en.wikipedia.org/wiki/Julian_day#:~:text=the%20Julian%20day%20number%20plus%20the%20fraction%20of%20a%20day%20since%20the%20preceding%20noon)</span> simply by keeping the remainder after dividing by one. If we want a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} instead, we should add <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} to the Julian date before converting it to a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} to ensure that the final result is less than one day:</span>
<span id="cb46-778"><a href="#cb46-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-779"><a href="#cb46-779" aria-hidden="true" tabindex="-1"></a>$$\text{tod} = (\text{julian} + 0.5) \text{ mod } 1$$</span>
<span id="cb46-780"><a href="#cb46-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-781"><a href="#cb46-781" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hour minute second {#hms .hiddenheading}</span></span>
<span id="cb46-782"><a href="#cb46-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-783"><a href="#cb46-783" aria-hidden="true" tabindex="-1"></a>We can also obtain a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} from a <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet by summing its components after converting them to fractional days, as shown in the equation below. The <span class="co">[</span><span class="ot">computer programming</span><span class="co">](https://en.wikipedia.org/wiki/Computer_programming#:~:text=the%20composition%20of%20sequences%20of%20instructions%2C%20called%20programs%2C%20that%20computers%20can%20follow%20to%20perform%20tasks)</span> code in the <span class="co">[</span><span class="ot">tabset panel</span><span class="co">](https://quarto.org/docs/interactive/layout.html#tabset-panel)</span> beneath the equation compares <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} derived from <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} and UNIX time as Quarto was <span class="co">[</span><span class="ot">rendering</span><span class="co">](https://quarto.org/docs/get-started/hello/rstudio.html#rendering:~:text=When%20rendering%2C%20Quarto%20generates%20a%20new%20file%20that%20contains%20selected%20text%2C%20code%2C%20and%20results)</span> this webpage.</span>
<span id="cb46-784"><a href="#cb46-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-785"><a href="#cb46-785" aria-hidden="true" tabindex="-1"></a>$$\text{tod} = \frac{\text{hour}}{24} + \frac{\text{minute}}{1440} + \frac{\text{second}}{86400}$$</span>
<span id="cb46-786"><a href="#cb46-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-787"><a href="#cb46-787" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset group="language"}</span>
<span id="cb46-788"><a href="#cb46-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### Julia</span></span>
<span id="cb46-789"><a href="#cb46-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-792"><a href="#cb46-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb46-793"><a href="#cb46-793" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Dates</span></span>
<span id="cb46-794"><a href="#cb46-794" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="fu">now</span>(UTC)</span>
<span id="cb46-795"><a href="#cb46-795" aria-hidden="true" tabindex="-1"></a><span class="fu">hour</span>(hms) <span class="op">/</span> <span class="fl">24</span> <span class="op">+</span></span>
<span id="cb46-796"><a href="#cb46-796" aria-hidden="true" tabindex="-1"></a><span class="fu">minute</span>(hms) <span class="op">/</span> <span class="fl">1440</span> <span class="op">+</span></span>
<span id="cb46-797"><a href="#cb46-797" aria-hidden="true" tabindex="-1"></a><span class="fu">second</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">+</span></span>
<span id="cb46-798"><a href="#cb46-798" aria-hidden="true" tabindex="-1"></a><span class="fu">millisecond</span>(hms) <span class="op">/</span> <span class="fl">864e5</span></span>
<span id="cb46-799"><a href="#cb46-799" aria-hidden="true" tabindex="-1"></a><span class="fu">datetime2unix</span>(hms) <span class="op">/</span> <span class="fl">86400</span> <span class="op">%</span> <span class="fl">1</span></span>
<span id="cb46-800"><a href="#cb46-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-801"><a href="#cb46-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-802"><a href="#cb46-802" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observable JavaScript</span></span>
<span id="cb46-803"><a href="#cb46-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-806"><a href="#cb46-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-807"><a href="#cb46-807" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb46-808"><a href="#cb46-808" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCHours</span>() <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span></span>
<span id="cb46-809"><a href="#cb46-809" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCMinutes</span>() <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span></span>
<span id="cb46-810"><a href="#cb46-810" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCSeconds</span>() <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span></span>
<span id="cb46-811"><a href="#cb46-811" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getUTCMilliseconds</span>() <span class="op">/</span> <span class="fl">864e5</span><span class="op">;</span></span>
<span id="cb46-812"><a href="#cb46-812" aria-hidden="true" tabindex="-1"></a>hms<span class="op">.</span><span class="fu">getTime</span>() <span class="op">/</span> <span class="fl">864e5</span> <span class="op">%</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-813"><a href="#cb46-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-814"><a href="#cb46-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-815"><a href="#cb46-815" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb46-816"><a href="#cb46-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-819"><a href="#cb46-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-820"><a href="#cb46-820" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timezone</span>
<span id="cb46-821"><a href="#cb46-821" aria-hidden="true" tabindex="-1"></a>hms <span class="op">=</span> datetime.now(timezone.utc)</span>
<span id="cb46-822"><a href="#cb46-822" aria-hidden="true" tabindex="-1"></a>hms.hour <span class="op">/</span> <span class="dv">24</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb46-823"><a href="#cb46-823" aria-hidden="true" tabindex="-1"></a>hms.minute <span class="op">/</span> <span class="dv">1440</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb46-824"><a href="#cb46-824" aria-hidden="true" tabindex="-1"></a>hms.second <span class="op">/</span> <span class="dv">86400</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb46-825"><a href="#cb46-825" aria-hidden="true" tabindex="-1"></a>hms.microsecond <span class="op">/</span> <span class="fl">864e8</span></span>
<span id="cb46-826"><a href="#cb46-826" aria-hidden="true" tabindex="-1"></a>hms.timestamp() <span class="op">/</span> <span class="dv">86400</span> <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-827"><a href="#cb46-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-828"><a href="#cb46-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-829"><a href="#cb46-829" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb46-830"><a href="#cb46-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-833"><a href="#cb46-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-834"><a href="#cb46-834" aria-hidden="true" tabindex="-1"></a>hms <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(<span class="fu">Sys.time</span>(), <span class="at">tz =</span> <span class="st">"UTC"</span>)</span>
<span id="cb46-835"><a href="#cb46-835" aria-hidden="true" tabindex="-1"></a>hms<span class="sc">$</span>hour <span class="sc">/</span> <span class="dv">24</span> <span class="sc">+</span></span>
<span id="cb46-836"><a href="#cb46-836" aria-hidden="true" tabindex="-1"></a>hms<span class="sc">$</span>min <span class="sc">/</span> <span class="dv">1440</span> <span class="sc">+</span></span>
<span id="cb46-837"><a href="#cb46-837" aria-hidden="true" tabindex="-1"></a>hms<span class="sc">$</span>sec <span class="sc">/</span> <span class="dv">86400</span></span>
<span id="cb46-838"><a href="#cb46-838" aria-hidden="true" tabindex="-1"></a>(<span class="fu">as.numeric</span>(<span class="fu">as.POSIXct</span>(hms)) <span class="sc">/</span> <span class="dv">86400</span>) <span class="sc">%%</span> <span class="dv">1</span></span>
<span id="cb46-839"><a href="#cb46-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-840"><a href="#cb46-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-841"><a href="#cb46-841" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-842"><a href="#cb46-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-843"><a href="#cb46-843" aria-hidden="true" tabindex="-1"></a>The equations below turn UNIX time or a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} into the three components of an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet: the "hour of day" (<span class="co">[</span><span class="ot">hod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour of day"}), "minute of hour" (<span class="co">[</span><span class="ot">moh</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="minute of hour"}), and "second of minute" (<span class="co">[</span><span class="ot">som</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="second of minute"}), using a "daily second aggregate" (<span class="co">[</span><span class="ot">dsa</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="daily second aggregate"}) and "hourly second aggregate" (<span class="co">[</span><span class="ot">hsa</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hourly second aggregate"}). While both count seconds, <span class="co">[</span><span class="ot">dsas</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="daily second aggregates"} start at midnight and <span class="co">[</span><span class="ot">hsas</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hourly second aggregates"} begin at the <span class="co">[</span><span class="ot">top of the hour</span><span class="co">](https://en.wiktionary.org/wiki/top_of_the_hour)</span>.</span>
<span id="cb46-844"><a href="#cb46-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-845"><a href="#cb46-845" aria-hidden="true" tabindex="-1"></a>$$\text{dsa} = \text{tod} \times 86400 = \text{unix mod } 86400$$</span>
<span id="cb46-846"><a href="#cb46-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-847"><a href="#cb46-847" aria-hidden="true" tabindex="-1"></a>$$\text{hsa} = \text{dsa mod } 3600$$</span>
<span id="cb46-848"><a href="#cb46-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-849"><a href="#cb46-849" aria-hidden="true" tabindex="-1"></a>$$\text{hod} = \lfloor \text{dsa} \div 3600 \rfloor$$</span>
<span id="cb46-850"><a href="#cb46-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-851"><a href="#cb46-851" aria-hidden="true" tabindex="-1"></a>$$\text{moh} = \lfloor \text{hsa} \div 60 \rfloor$$</span>
<span id="cb46-852"><a href="#cb46-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-853"><a href="#cb46-853" aria-hidden="true" tabindex="-1"></a>$$\text{som} = \lfloor \text{hsa mod } 60 \rfloor$$</span>
<span id="cb46-854"><a href="#cb46-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-855"><a href="#cb46-855" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset group="language"}</span>
<span id="cb46-856"><a href="#cb46-856" aria-hidden="true" tabindex="-1"></a><span class="fu">### Julia</span></span>
<span id="cb46-857"><a href="#cb46-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-860"><a href="#cb46-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{julia}</span></span>
<span id="cb46-861"><a href="#cb46-861" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Dates</span></span>
<span id="cb46-862"><a href="#cb46-862" aria-hidden="true" tabindex="-1"></a>dsa <span class="op">=</span> <span class="fu">datetime2unix</span>(<span class="fu">now</span>(UTC)) <span class="op">/</span> <span class="fl">86400</span> <span class="op">%</span> <span class="fl">1</span> <span class="op">*</span> <span class="fl">86400</span></span>
<span id="cb46-863"><a href="#cb46-863" aria-hidden="true" tabindex="-1"></a>hsa <span class="op">=</span> dsa <span class="op">%</span> <span class="fl">3600</span></span>
<span id="cb46-864"><a href="#cb46-864" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fu">floor</span>(<span class="dt">Int</span>, x), (dsa <span class="op">/</span> <span class="fl">3600</span>, hsa <span class="op">/</span> <span class="fl">60</span>, hsa <span class="op">%</span> <span class="fl">60</span>))</span>
<span id="cb46-865"><a href="#cb46-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-866"><a href="#cb46-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-867"><a href="#cb46-867" aria-hidden="true" tabindex="-1"></a><span class="fu">### Observable JavaScript</span></span>
<span id="cb46-868"><a href="#cb46-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-871"><a href="#cb46-871" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-872"><a href="#cb46-872" aria-hidden="true" tabindex="-1"></a>dsa <span class="op">=</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>() <span class="op">/</span> <span class="fl">864e5</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">86400</span><span class="op">;</span></span>
<span id="cb46-873"><a href="#cb46-873" aria-hidden="true" tabindex="-1"></a>hsa <span class="op">=</span> dsa <span class="op">%</span> <span class="dv">3600</span><span class="op">;</span></span>
<span id="cb46-874"><a href="#cb46-874" aria-hidden="true" tabindex="-1"></a>[dsa <span class="op">/</span> <span class="dv">3600</span><span class="op">,</span> hsa <span class="op">/</span> <span class="dv">60</span><span class="op">,</span> hsa <span class="op">%</span> <span class="dv">60</span>]<span class="op">.</span><span class="fu">map</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>)</span>
<span id="cb46-875"><a href="#cb46-875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-876"><a href="#cb46-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-877"><a href="#cb46-877" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb46-878"><a href="#cb46-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-881"><a href="#cb46-881" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb46-882"><a href="#cb46-882" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime, timezone</span>
<span id="cb46-883"><a href="#cb46-883" aria-hidden="true" tabindex="-1"></a>dsa <span class="op">=</span> datetime.now(timezone.utc).timestamp() <span class="op">/</span> <span class="dv">86400</span> <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">86400</span></span>
<span id="cb46-884"><a href="#cb46-884" aria-hidden="true" tabindex="-1"></a>hsa <span class="op">=</span> dsa <span class="op">%</span> <span class="dv">3600</span></span>
<span id="cb46-885"><a href="#cb46-885" aria-hidden="true" tabindex="-1"></a><span class="bu">tuple</span>(<span class="bu">map</span>(<span class="bu">int</span>, [dsa <span class="op">//</span> <span class="dv">3600</span>, hsa <span class="op">//</span> <span class="dv">60</span>, hsa <span class="op">%</span> <span class="dv">60</span> <span class="op">//</span> <span class="dv">1</span>]))</span>
<span id="cb46-886"><a href="#cb46-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-887"><a href="#cb46-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-888"><a href="#cb46-888" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb46-889"><a href="#cb46-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-892"><a href="#cb46-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-893"><a href="#cb46-893" aria-hidden="true" tabindex="-1"></a>dsa <span class="ot">&lt;-</span> (<span class="fu">as.numeric</span>(<span class="fu">as.POSIXct</span>(<span class="fu">Sys.time</span>())) <span class="sc">/</span> <span class="dv">86400</span>) <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">86400</span></span>
<span id="cb46-894"><a href="#cb46-894" aria-hidden="true" tabindex="-1"></a>hsa <span class="ot">&lt;-</span> dsa <span class="sc">%%</span> <span class="dv">3600</span></span>
<span id="cb46-895"><a href="#cb46-895" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">c</span>(dsa <span class="sc">%/%</span> <span class="dv">3600</span>, hsa <span class="sc">%/%</span> <span class="dv">60</span>, hsa <span class="sc">%%</span> <span class="dv">60</span>), as.integer)</span>
<span id="cb46-896"><a href="#cb46-896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-897"><a href="#cb46-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-898"><a href="#cb46-898" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-899"><a href="#cb46-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-900"><a href="#cb46-900" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Global Positioning System</span><span class="co">](https://en.wikipedia.org/wiki/Global_Positioning_System#:~:text=a%20satellite%2Dbased%20hyperbolic%20navigation%20system)</span>, <span class="co">[</span><span class="ot">BeiDou</span><span class="co">](https://en.wikipedia.org/wiki/BeiDou#:~:text=a%20satellite%2Dbased%20radio%20navigation%20system)</span>, and <span class="co">[</span><span class="ot">Galileo</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Galileo_(satellite_navigation)#:~:text=a%20global%20navigation%20satellite%20system%20(GNSS)%20created%20by%20the%20European%20Union) <span class="co">[</span><span class="ot">global navigation satellite systems</span><span class="co">](https://en.wikipedia.org/wiki/Satellite_navigation#:~:text=a%20satellite%20navigation%20system%20with%20global%20coverage)</span> along with most --- if not all --- <span class="co">[</span><span class="ot">programming languages</span><span class="co">](https://en.wikipedia.org/wiki/Programming_language#:~:text=a%20system%20of%20notation%20for%20writing%20source%20code%20such%20as%20used%20to%20produce%20a%20computer%20program)</span> do not account for <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>, which appears to be for the best given that leap seconds will be <span class="co">[</span><span class="ot">abolished by 2035</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=at%20the%2027th%20General%20Conference%20on%20Weights%20and%20Measures%2C%20it%20was%20decided%20to%20abandon%20the%20leap%20second%20by%20or%20before%202035)</span>. The goal of leap seconds is to keep <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} within <span class="co">[</span><span class="ot">25/24</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=to%20ensure%20that%20the%20difference%20between%20the%20UTC%20and%20UT1%20readings%20will%20never%20exceed%200.9%20seconds)</span> <span class="co">[</span><span class="ot">centimillidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundred thousands of a day"} (<span class="co">[</span><span class="ot">cmds</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="centimillidays"}) of <span class="co">[</span><span class="ot">Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Universal_Time#Versions:~:text=a%20time%20standard%20based%20on%20Earth%27s%20rotation)</span> (<span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"}).</span>
<span id="cb46-901"><a href="#cb46-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-902"><a href="#cb46-902" aria-hidden="true" tabindex="-1"></a><span class="fu"># Time zone offset {.hiddenheading #tzo}</span></span>
<span id="cb46-903"><a href="#cb46-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-904"><a href="#cb46-904" aria-hidden="true" tabindex="-1"></a>Instead of leap seconds, Dec matches <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} using a "<span class="co">[</span><span class="ot">time zone offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place)" (<span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}). With the <span class="co">[</span><span class="ot">leap second insertion dates</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=Announced%20leap%20seconds%20to%20date)</span> provided by the <span class="co">[</span><span class="ot">International Earth Rotation and Reference Systems Service</span><span class="co">](https://en.wikipedia.org/wiki/International_Earth_Rotation_and_Reference_Systems_Service#:~:text=the%20body%20responsible%20for%20maintaining%20global%20time%20and%20reference%20frame%20standards)</span>, we can approximate the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} that we need to add to the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} to obtain <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} on the <span class="co">[</span><span class="ot">Dec date</span><span class="co">](/dec/date)</span> selected by the <span class="co">[</span><span class="ot">range</span><span class="co">](https://observablehq.com/framework/inputs/range)</span>🎚️inputs below: \${leapCountHsl} <span class="dv">&amp;div;</span> 8640 = \${leapTzoHsl0}.</span>
<span id="cb46-905"><a href="#cb46-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-908"><a href="#cb46-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-909"><a href="#cb46-909" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-910"><a href="#cb46-910" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: dateinput</span></span>
<span id="cb46-911"><a href="#cb46-911" aria-hidden="true" tabindex="-1"></a>viewof leapSecondYear <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1970</span><span class="op">,</span> <span class="dv">2020</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1995</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb46-912"><a href="#cb46-912" aria-hidden="true" tabindex="-1"></a>viewof leapSecondDate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">365</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Day"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">182</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb46-913"><a href="#cb46-913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-914"><a href="#cb46-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-915"><a href="#cb46-915" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rounding error fraction {#ref .hiddenheading}</span></span>
<span id="cb46-916"><a href="#cb46-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-917"><a href="#cb46-917" aria-hidden="true" tabindex="-1"></a>Of the twenty eight <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} that can be displayed above, one is an integer, one is a <span class="co">[</span><span class="ot">terminating decimal</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20finite%20number%20of%20nonzero%20digits)</span>, and the rest are <span class="co">[</span><span class="ot">repeating decimals</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=the%20same%20sequence%20of%20digits%20is%20repeated%20forever)</span>. To express a repeating decimal <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}, Dec uses an <span class="co">[</span><span class="ot">irreducible fraction</span><span class="co">](https://en.wikipedia.org/wiki/Irreducible_fraction#:~:text=a%20fraction%20in%20which%20the%20numerator%20and%20denominator%20are%20integers%20that%20have%20no%20other%20common%20divisors%20than%201)</span> that is either on its own or preceded by a "rounded offset decimal" (<span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"}). When the fraction follows a <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"}, it is called a "<span class="co">[</span><span class="ot">rounding error</span><span class="co">](https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic)</span> fraction" (<span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"}).</span>
<span id="cb46-918"><a href="#cb46-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-919"><a href="#cb46-919" aria-hidden="true" tabindex="-1"></a>In the equation below, the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} is the minuend, the <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"} is the subtrahend, and the <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"} is the difference. Dec uses the term minuend expansion to describe the replacement of a minuend with a subtrahend and a difference. By replacing a repeating decimal <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} with a <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"} and a <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"}, we can show the initial digits of the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} as a decimal and the rest as a fraction.</span>
<span id="cb46-920"><a href="#cb46-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-921"><a href="#cb46-921" aria-hidden="true" tabindex="-1"></a>$$\text{tzo} - \text{rod} = \text{ref}$$</span>
<span id="cb46-922"><a href="#cb46-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-923"><a href="#cb46-923" aria-hidden="true" tabindex="-1"></a>Use the first three range🎚️inputs below to select an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet to be converted to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, plugged into the equation above as the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}, rounded to the number of digits chosen by the fourth range🎚️input, and inserted into the equation as the <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"}. Once the left-hand side of the equation is complete, we can solve it to get the <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"}: \${hmsTzoHsl} -- \${hmsRodHsl} = \${hmsRefHsl}.</span>
<span id="cb46-924"><a href="#cb46-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-927"><a href="#cb46-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-928"><a href="#cb46-928" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-929"><a href="#cb46-929" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: hmsinput</span></span>
<span id="cb46-930"><a href="#cb46-930" aria-hidden="true" tabindex="-1"></a>viewof hmsinput <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb46-931"><a href="#cb46-931" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">23</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Hour"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">11</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb46-932"><a href="#cb46-932" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">59</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Minute"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb46-933"><a href="#cb46-933" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">59</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Second"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb46-934"><a href="#cb46-934" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb46-935"><a href="#cb46-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-936"><a href="#cb46-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-939"><a href="#cb46-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-940"><a href="#cb46-940" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-941"><a href="#cb46-941" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: diginput</span></span>
<span id="cb46-942"><a href="#cb46-942" aria-hidden="true" tabindex="-1"></a>viewof digits <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">9</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Digits"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb46-943"><a href="#cb46-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-944"><a href="#cb46-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-945"><a href="#cb46-945" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coordinated Universal Time (UTC) {#utc .hiddenheading}</span></span>
<span id="cb46-946"><a href="#cb46-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-947"><a href="#cb46-947" aria-hidden="true" tabindex="-1"></a>If we obtain <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} from all of the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets that can be selected with the range🎚️inputs above, we will have 10 integers, 3190 terminating decimals, and 83200 repeating decimals. When we do the same to the <span class="co">[</span><span class="ot">38</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets)</span> <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}, the number of integers, terminating decimals, and repeating decimals we get depends on how many leap seconds are included.</span>
<span id="cb46-948"><a href="#cb46-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-949"><a href="#cb46-949" aria-hidden="true" tabindex="-1"></a>Unless the number of leaps seconds included is zero or a multiple of 27, all 38 <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} will be repeating decimals. If the number of leap seconds is zero or a multiple of 8640, we will get 3 integer, 9 terminating decimals, and 26 repeating decimals. The 3 integers will be terminating decimals if the number of leap seconds is a multiple of 27 but not 8640.</span>
<span id="cb46-950"><a href="#cb46-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-951"><a href="#cb46-951" aria-hidden="true" tabindex="-1"></a>Of the 38 <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}, 14 are negative and 24 are positive. The <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone with <span class="co">[</span><span class="ot">the most negative [tzo]{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude)</span> is completely uninhabited. The bar📊chart below visualizes <span class="co">[</span><span class="ot">Socioeconomic Data and Applications Center</span><span class="co">](https://www.earthdata.nasa.gov/centers/sedac-daac)</span> data from 2020 to show the number of people living in each <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone. The vast majority of people live in <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones with positive <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}.</span>
<span id="cb46-952"><a href="#cb46-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-955"><a href="#cb46-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-956"><a href="#cb46-956" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-957"><a href="#cb46-957" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: timezonepoptoggles</span></span>
<span id="cb46-958"><a href="#cb46-958" aria-hidden="true" tabindex="-1"></a><span class="co">//| class: /togs</span></span>
<span id="cb46-959"><a href="#cb46-959" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb46-960"><a href="#cb46-960" aria-hidden="true" tabindex="-1"></a>viewof sortParams <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb46-961"><a href="#cb46-961" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort ascending"</span> })<span class="op">,</span></span>
<span id="cb46-962"><a href="#cb46-962" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort by offset"</span> })<span class="op">,</span></span>
<span id="cb46-963"><a href="#cb46-963" aria-hidden="true" tabindex="-1"></a>  ])</span>
<span id="cb46-964"><a href="#cb46-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-965"><a href="#cb46-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-968"><a href="#cb46-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-969"><a href="#cb46-969" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-970"><a href="#cb46-970" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: timezonepopstackedbar</span></span>
<span id="cb46-971"><a href="#cb46-971" aria-hidden="true" tabindex="-1"></a><span class="co">//| class: stackedBar</span></span>
<span id="cb46-972"><a href="#cb46-972" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb46-973"><a href="#cb46-973" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb46-974"><a href="#cb46-974" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> width<span class="op">,</span></span>
<span id="cb46-975"><a href="#cb46-975" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginBottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb46-976"><a href="#cb46-976" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> <span class="vs">`overflow: visible;font-size:16px;`</span><span class="op">,</span></span>
<span id="cb46-977"><a href="#cb46-977" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {<span class="dt">scheme</span><span class="op">:</span> <span class="st">"RdBu"</span><span class="op">,</span> <span class="dt">className</span><span class="op">:</span> <span class="st">"barPlotLegend"</span>}<span class="op">,</span></span>
<span id="cb46-978"><a href="#cb46-978" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">75</span><span class="op">,</span></span>
<span id="cb46-979"><a href="#cb46-979" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span> }<span class="op">,</span></span>
<span id="cb46-980"><a href="#cb46-980" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> { <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Population (billions)"</span><span class="op">,</span> <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">38</span><span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> d <span class="kw">=&gt;</span> d <span class="op">/</span> <span class="fl">1e9</span> }<span class="op">,</span></span>
<span id="cb46-981"><a href="#cb46-981" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb46-982"><a href="#cb46-982" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">barX</span>(sortedPop<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"pop"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"Sign"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"Offset"</span><span class="op">,</span> <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span> <span class="dt">tip</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">,</span></span>
<span id="cb46-983"><a href="#cb46-983" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb46-984"><a href="#cb46-984" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-985"><a href="#cb46-985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-986"><a href="#cb46-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-987"><a href="#cb46-987" aria-hidden="true" tabindex="-1"></a>Negative <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} only exist in <span class="co">[</span><span class="ot">the Americas</span><span class="co">](https://en.wikipedia.org/wiki/Americas#:~:text=a%20landmass%20comprising%20the%20totality%20of%20North%20America%20and%20South%20America)</span> and islands in the <span class="co">[</span><span class="ot">Atlantic</span><span class="co">](https://en.wikipedia.org/wiki/List_of_islands_in_the_Atlantic_Ocean)</span> and <span class="co">[</span><span class="ot">Pacific</span><span class="co">](https://en.wikipedia.org/wiki/List_of_islands_in_the_Pacific_Ocean)</span> Oceans. Therefore, the bars in the chart above are essentially comparing the Americas to the rest of the world. According to 2021 <span class="co">[</span><span class="ot">United Nations Department of Economic and Social Affairs</span><span class="co">](https://en.wikipedia.org/wiki/United_Nations_Department_of_Economic_and_Social_Affairs#:~:text=part%20of%20the%20United%20Nations%20Secretariat)</span> data, about one billion out of a total of almost eight billion people live in the Americas.</span>
<span id="cb46-988"><a href="#cb46-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-989"><a href="#cb46-989" aria-hidden="true" tabindex="-1"></a>Whenever a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} is associated with a Dec date, a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, or both a date and a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, Dec will add one day to the date and ten decidays to the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} without modifying the <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}. This typically occurs after the conversion of an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet to a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} or a "year month day" (ymd) triplet to a Dec date. As a result, all Dec dates and <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} have positive <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}.</span>
<span id="cb46-990"><a href="#cb46-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-991"><a href="#cb46-991" aria-hidden="true" tabindex="-1"></a>Dec will not change a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} or its associated <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} if the result of adding one day to the <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} is uncertain. This uncertainly can only exist if we do not know whether a <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} that is equal to 364 belongs to a common or leap year. The day after Day <span class="co">[</span><span class="ot">364</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="February 28"} of a common year is Day <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="March 1"} of the subsequent year. In a leap year, Day <span class="co">[</span><span class="ot">364</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="February 28"} precedes Day <span class="co">[</span><span class="ot">365</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="February 29"}.</span>
<span id="cb46-992"><a href="#cb46-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-993"><a href="#cb46-993" aria-hidden="true" tabindex="-1"></a>Even though it has no effect on the <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, adding one day to the <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} also increments the "day of month" (<span class="co">[</span><span class="ot">dom</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of month"}) and "day of week" (<span class="co">[</span><span class="ot">dow</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of week"}) shown by Dec. The table below summarizes how someone accustomed to a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} could intrepret Dec <span class="co">[</span><span class="ot">dow</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of week"} numbers. From the perspective of a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} user, the <span class="co">[</span><span class="ot">dom</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of month"} and <span class="co">[</span><span class="ot">dow</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of week"} in Dec will be one day ahead.</span>
<span id="cb46-994"><a href="#cb46-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-995"><a href="#cb46-995" aria-hidden="true" tabindex="-1"></a>:::{.overflowtable style="overflow-x:auto;overflow-y:hidden;"}</span>
<span id="cb46-996"><a href="#cb46-996" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Saturday <span class="pp">|</span> Sunday <span class="pp">|</span> Monday <span class="pp">|</span> Tuesday <span class="pp">|</span> Wednesday <span class="pp">|</span> Thursday <span class="pp">|</span> Friday <span class="pp">|</span></span>
<span id="cb46-997"><a href="#cb46-997" aria-hidden="true" tabindex="-1"></a><span class="pp">| --------</span> <span class="pp">| ------</span> <span class="pp">| ------</span> <span class="pp">| -------</span> <span class="pp">| ---------</span> <span class="pp">| --------</span> <span class="pp">| ------</span> <span class="pp">|</span></span>
<span id="cb46-998"><a href="#cb46-998" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>    0     <span class="pp">|</span>   1    <span class="pp">|</span>   2    <span class="pp">|</span>    3    <span class="pp">|</span>     4     <span class="pp">|</span>    5     <span class="pp">|</span>   6    <span class="pp">|</span></span>
<span id="cb46-999"><a href="#cb46-999" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>   -7     <span class="pp">|</span>  -6    <span class="pp">|</span>  -5    <span class="pp">|</span>   -4    <span class="pp">|</span>    -3     <span class="pp">|</span>   -2     <span class="pp">|</span>  -1    <span class="pp">|</span></span>
<span id="cb46-1000"><a href="#cb46-1000" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-1001"><a href="#cb46-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1002"><a href="#cb46-1002" aria-hidden="true" tabindex="-1"></a>The one day difference between positive and negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} may actually make Dec <span class="co">[</span><span class="ot">dow</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of week"} numbers more intuitive than <span class="co">[</span><span class="ot">POSIX</span><span class="co">]</span>(https://pubs.opengroup.org/onlinepubs/007904875/utilities/date.html#:~:text=weekday%20as%20a%20decimal%20number%20%5B0%2C6%5D%20(0%3Dsunday)) <span class="co">[</span><span class="ot">dow</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of week"} numbers for speakers of languages that consider <span class="co">[</span><span class="ot">Sunday to be the first [dow]{.tool data-bs-toggle="tooltip" data-bs-title="day of week"}</span><span class="co">](https://en.wikipedia.org/wiki/Names_of_the_days_of_the_week#:~:text=Sunday%20comes%20first,-in%20order%20in)</span>, like Portuguese. Notably, Brazil is the largest Portuguese speaking country in the world and the second most populous country in the Americas.</span>
<span id="cb46-1003"><a href="#cb46-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1004"><a href="#cb46-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mean solar time {.hiddenheading #mst}</span></span>
<span id="cb46-1005"><a href="#cb46-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1006"><a href="#cb46-1006" aria-hidden="true" tabindex="-1"></a>In Dec, <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} are closely related to <span class="co">[</span><span class="ot">longitude</span><span class="co">](https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda)</span>. Dec always measures longitude in <span class="co">[</span><span class="ot">parallels</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line) (<span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="parallel"}) or submultiples of <span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="parallels"} like <span class="co">[</span><span class="ot">deci[parallels](https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel"} (<span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"}). At any given moment, there is just one <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} for the entire world, a zonal time for every Dec time zone, and two types of <span class="co">[</span><span class="ot">solar time</span><span class="co">](https://en.wikipedia.org/wiki/Solar_time#:~:text=a%20calculation%20of%20the%20passage%20of%20time%20based%20on%20the%20position%20of%20the%20Sun%20in%20the%20sky)</span> for every <span class="co">[</span><span class="ot">longitude</span><span class="co">](https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda)</span>: <span class="co">[</span><span class="ot">"mean solar time"</span><span class="co">](https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year)</span> (<span class="co">[</span><span class="ot">mst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="mean solar time"}) and <span class="co">[</span><span class="ot">"apparent solar time"</span><span class="co">](https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year)</span> (<span class="co">[</span><span class="ot">ast</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="apparent solar time"}).</span>
<span id="cb46-1007"><a href="#cb46-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1008"><a href="#cb46-1008" aria-hidden="true" tabindex="-1"></a>In the middle of a time zone, the</span>
<span id="cb46-1009"><a href="#cb46-1009" aria-hidden="true" tabindex="-1"></a>Dec will add one <span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="parallel"} or the equivalent amount in a <span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="parallel"} submultiple to any negative longitude.</span>
<span id="cb46-1010"><a href="#cb46-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1011"><a href="#cb46-1011" aria-hidden="true" tabindex="-1"></a>Dec classifies every possible time as “zonal”, “solar”, or “other” based on its corresponding tzo.</span>
<span id="cb46-1012"><a href="#cb46-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1013"><a href="#cb46-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1014"><a href="#cb46-1014" aria-hidden="true" tabindex="-1"></a>measured in <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"},to make it positive. When we floor a <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} longitude, we get the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} of its corresponding Dec time zone. If we subtract half a <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} to the longitude instead of flooring it, we will have the difference between the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and the <span class="co">[</span><span class="ot">"mean solar time"</span><span class="co">](https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year)</span> (<span class="co">[</span><span class="ot">mst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="mean solar time"}).</span>
<span id="cb46-1015"><a href="#cb46-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1016"><a href="#cb46-1016" aria-hidden="true" tabindex="-1"></a>The equations in the article always assume that we are working with like units. the <span class="co">[</span><span class="ot">ydas</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="yearly day aggregates"}, <span class="co">[</span><span class="ot">doys</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="days of year"} and <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} are measured in days. To convert to a submultiple of a day, we multiply the terms on one side of any equation by a multiple of 10.</span>
<span id="cb46-1017"><a href="#cb46-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1018"><a href="#cb46-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1019"><a href="#cb46-1019" aria-hidden="true" tabindex="-1"></a>$$\text{tzo} = \lfloor\text{d}\lambda\rfloor$$</span>
<span id="cb46-1020"><a href="#cb46-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1021"><a href="#cb46-1021" aria-hidden="true" tabindex="-1"></a>If we subtract half a</span>
<span id="cb46-1022"><a href="#cb46-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1023"><a href="#cb46-1023" aria-hidden="true" tabindex="-1"></a> starting from Longitude <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, the Dec <span class="co">[</span><span class="ot">prime meridian</span><span class="co">](https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0)</span> and <span class="co">[</span><span class="ot">"international date line"</span><span class="co">](https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next)</span> (<span class="co">[</span><span class="ot">idl</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="international date line"}). To find the Dec time zone and <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} at a location</span>
<span id="cb46-1024"><a href="#cb46-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1025"><a href="#cb46-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1026"><a href="#cb46-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1027"><a href="#cb46-1027" aria-hidden="true" tabindex="-1"></a>year+364.tod-tzo</span>
<span id="cb46-1028"><a href="#cb46-1028" aria-hidden="true" tabindex="-1"></a>364-tzo</span>
<span id="cb46-1029"><a href="#cb46-1029" aria-hidden="true" tabindex="-1"></a>364+tzo</span>
<span id="cb46-1030"><a href="#cb46-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1031"><a href="#cb46-1031" aria-hidden="true" tabindex="-1"></a>otherwise. to positive <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} by adding one day to the <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} and the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}. Dec will add one day to the adds one the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet as described above, but adds one day to both the date and the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}. negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} to positive <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}.</span>
<span id="cb46-1032"><a href="#cb46-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1033"><a href="#cb46-1033" aria-hidden="true" tabindex="-1"></a>To convert between Dec and Gregorian calendar, Dec stores the negative tzo</span>
<span id="cb46-1034"><a href="#cb46-1034" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} and <span class="co">[</span><span class="ot">dom</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of month"} equations below are able to adapt to negative tzos.</span>
<span id="cb46-1035"><a href="#cb46-1035" aria-hidden="true" tabindex="-1"></a>From the perspective of anyone who uses a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}, the  should interpret Dec <span class="co">[</span><span class="ot">doms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="days of month"} as zero-based numbers and <span class="co">[</span><span class="ot">dows</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="days of week"} according to the table below.</span>
<span id="cb46-1036"><a href="#cb46-1036" aria-hidden="true" tabindex="-1"></a>The range input below represents the birthday of someone born in <span class="co">[</span><span class="ot">the Americas</span><span class="co">](https://en.wikipedia.org/wiki/Americas#:~:text=a%20landmass%20comprising%20the%20totality%20of%20North%20America%20and%20South%20America)</span> who thinks they were born on Day 183 but was actually born on It could be a  and therefore is shifted in relation. "day of week" (<span class="co">[</span><span class="ot">dow</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of week"}) or The <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} of the most populous <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone in the Western Hemisphere is therefore -25/12 + <span class="co">[</span><span class="ot">10</span><span class="co">]</span>{.color0} = 95/12. When converting the Gregorian calendar birthday of anyone born in a  will have increment their b add one day. in the uses a tzo of -25/12 will think that the  exactly one behind everyone  Using this approach, Dec can match any possible <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}. but anyone using <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones with negative offsets.</span>
<span id="cb46-1037"><a href="#cb46-1037" aria-hidden="true" tabindex="-1"></a>The top range input below represents a Dec refers to The <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} in  <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}-25/12 is roughly one day behind Zone 8. and but   The time zone is one day behind. To match  -25/12. To find the Dec time zone that has the smallest time difference is closest If we add ten decidays to this <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}, we get 95/12 or rather than Zone By default, Dec adds ten decidays to all negative tzos to make them positive. Dec refers to .  is -25/12 decidays behind UTC. but this approach needs to use a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} to avoid mismatches by one day. That are one day ahead of dates in <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones with negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} will be one day behind this approach results in dates that differ by one day. but</span>
<span id="cb46-1038"><a href="#cb46-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1039"><a href="#cb46-1039" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} of the ten Dec time zones are all single-digit positive integers.</span>
<span id="cb46-1040"><a href="#cb46-1040" aria-hidden="true" tabindex="-1"></a>The chart above does not take into account <span class="co">[</span><span class="ot">"daylight savings time"</span><span class="co">](https://en.wikipedia.org/wiki/Daylight_saving_time#:~:text=the%20practice%20of%20advancing%20clocks%20to%20make%20better%20use%20of%20the%20longer%20daylight%20available%20during%20summer)</span> (<span class="co">[</span><span class="ot">dst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="daylight savings time"}). Dec considers <span class="co">[</span><span class="ot">dst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="daylight savings time"} and negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} to be special requests for a minority of users. and UTC time zones offerEach of the ten time zones has a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} that is a single-digit positive integer.</span>
<span id="cb46-1041"><a href="#cb46-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1042"><a href="#cb46-1042" aria-hidden="true" tabindex="-1"></a>The most populous UTC time zone with a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} is -25/12 decidays behind UTC. Some places only use this <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} for part of the year because of daylight savings time.</span>
<span id="cb46-1043"><a href="#cb46-1043" aria-hidden="true" tabindex="-1"></a>A central design principle of Dec is to meet users where they are. Rather than inform people born in a  chart above shows that this problem affects a Any date associated with a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} will exactly one day behind . Dates with negative  negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} because it can match any possible <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} using only  time measurement. match the time in any <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone and in fact using only positive <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}. to match any possible . Even if Dec even those associated with a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}, but the date produced by the negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} will be one day behind. Date mismatches lead to unexpected results when translating dates between the Dec and Gregorian calendars or when a “day of week” is included as part of a Dec date. We can subtract ten decidays from any positive Dec <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} to make it negative.We can add or subtract ten <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} to switch between a positive and negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} without changing its corresponding <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}. To stay within the correct <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} range for <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} and <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}, -10 &lt; x &lt; 10, we keep only the remainder after dividing by ten.</span>
<span id="cb46-1044"><a href="#cb46-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1045"><a href="#cb46-1045" aria-hidden="true" tabindex="-1"></a> and range from <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5} to <span class="co">[</span><span class="ot">35/6</span><span class="co">]</span>{.color583} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} without leap seconds.</span>
<span id="cb46-1046"><a href="#cb46-1046" aria-hidden="true" tabindex="-1"></a>and from <span class="co">[</span><span class="ot">-1276/320</span><span class="co">]</span>{.color5} to <span class="co">[</span><span class="ot">5603/960</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} with [<span class="co">[</span><span class="ot">27</span><span class="co">]</span>{.color1by320} leap seconds](https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC).</span>
<span id="cb46-1047"><a href="#cb46-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1048"><a href="#cb46-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1049"><a href="#cb46-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1050"><a href="#cb46-1050" aria-hidden="true" tabindex="-1"></a>Of the 86390 <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet-derived fractions that can be shown above, there are 8639 <span class="co">[</span><span class="ot">simple fractions</span><span class="co">](https://en.wikipedia.org/wiki/Fraction#Simple,_common,_or_vulgar_fractions)</span> and 77751 <span class="co">[</span><span class="ot">improper fractions</span><span class="co">](https://en.wikipedia.org/wiki/Fraction#:~:text=When%20the%20numerator%20and%20the%20denominator%20are%20both%20positive%2C%20the%20fraction%20is%20called%20proper%20if%20the%20numerator%20is%20less%20than%20the%20denominator%2C%20and%20improper%20otherwise)</span>. Among these fractions, we would find 96 unique denominators. Fractions that have different denominators are difficult to compare.</span>
<span id="cb46-1051"><a href="#cb46-1051" aria-hidden="true" tabindex="-1"></a>Similarly, a Dec times is essentially a math expression with two terms, a tod and a tzo, that can be combined into a Zone 0 tod. We can also have a Dec time that consists of a tod, <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"}, and <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"}</span>
<span id="cb46-1052"><a href="#cb46-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1053"><a href="#cb46-1053" aria-hidden="true" tabindex="-1"></a>In addition to replacing a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} with a <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"} and a <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"},  . In minuend expansion, the minuend is expanded into a the first equation below, the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} is the , and the <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"} is the difference. The second equation below shows that we can replace a minuend with a subtrahend and a difference.</span>
<span id="cb46-1054"><a href="#cb46-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1055"><a href="#cb46-1055" aria-hidden="true" tabindex="-1"></a>In general, comparing fractions --- especially <span class="co">[</span><span class="ot">unlike fractions</span><span class="co">]()</span> --- is more difficult than comparing decimals. Dec always displays <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} and <span class="co">[</span><span class="ot">rods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"} in decimal form for easy comparison.</span>
<span id="cb46-1056"><a href="#cb46-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1057"><a href="#cb46-1057" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"} is the difference between the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} and the <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"}:</span>
<span id="cb46-1058"><a href="#cb46-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1059"><a href="#cb46-1059" aria-hidden="true" tabindex="-1"></a>$$\text{tzo} = \text{rod} + \text{ref}$$</span>
<span id="cb46-1060"><a href="#cb46-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1061"><a href="#cb46-1061" aria-hidden="true" tabindex="-1"></a>The range🎚️input above chooses the number of digits in the rod.</span>
<span id="cb46-1062"><a href="#cb46-1062" aria-hidden="true" tabindex="-1"></a> <span class="co">[</span><span class="ot">rounding error</span><span class="co">](https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic)</span>. When rounded to the number of digits chosen by the range🎚️input below, the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet selected by the range🎚️inputs above is \${hmsTzoHsl1} and the rounding error is \${hmsRoeHsl}.</span>
<span id="cb46-1063"><a href="#cb46-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1064"><a href="#cb46-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1065"><a href="#cb46-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1066"><a href="#cb46-1066" aria-hidden="true" tabindex="-1"></a>In addition to splitting a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} into a <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"} and a <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"}, we can split a <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"}, <span class="co">[</span><span class="ot">yda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="yearly day aggregate"}, or <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} into a subtrahend and a difference via a process called minuend expansion.  <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} or a  the difference. Dec uses the terms minuend, subtrahend, and difference to label different parts of a <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"}, <span class="co">[</span><span class="ot">yda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="yearly day aggregate"}, <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, or <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} that have undergone minuend expansion. When a  splitting a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"} and a <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"} is an example of minuend expansion.</span>
<span id="cb46-1067"><a href="#cb46-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1068"><a href="#cb46-1068" aria-hidden="true" tabindex="-1"></a>In the equation below, the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} is the minuend, the <span class="co">[</span><span class="ot">rod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded offset decimal"} is the subtrahend, and the <span class="co">[</span><span class="ot">ref</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="roundoff error fraction"} is the difference.</span>
<span id="cb46-1069"><a href="#cb46-1069" aria-hidden="true" tabindex="-1"></a>$$\text{tzo} - \text{rod} = \text{ref}$$</span>
<span id="cb46-1070"><a href="#cb46-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1071"><a href="#cb46-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1072"><a href="#cb46-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1073"><a href="#cb46-1073" aria-hidden="true" tabindex="-1"></a>When we round a decimal number, we are essentially removing the round-off error.</span>
<span id="cb46-1074"><a href="#cb46-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1075"><a href="#cb46-1075" aria-hidden="true" tabindex="-1"></a>In general, the presence of a fraction indicates that goal is to match either UT or a time in a UTC time zone.</span>
<span id="cb46-1076"><a href="#cb46-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1077"><a href="#cb46-1077" aria-hidden="true" tabindex="-1"></a>After being converted to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets that can be selected by range🎚️inputs below to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"},</span>
<span id="cb46-1078"><a href="#cb46-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1079"><a href="#cb46-1079" aria-hidden="true" tabindex="-1"></a>from a Each of the ten Dec time zones has a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} that is a positive single-digit <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} integer.</span>
<span id="cb46-1080"><a href="#cb46-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1081"><a href="#cb46-1081" aria-hidden="true" tabindex="-1"></a>The vast majority of the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets that can be selected by the range🎚️inputs above,   expressed the remaining 8639 out of 8640 <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets using fractions.</span>
<span id="cb46-1082"><a href="#cb46-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1083"><a href="#cb46-1083" aria-hidden="true" tabindex="-1"></a>cannot be expressed the remaining 26/27 <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets thatas fractions</span>
<span id="cb46-1084"><a href="#cb46-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1085"><a href="#cb46-1085" aria-hidden="true" tabindex="-1"></a>Most Using fractions, Dec can precisely match any UTC tzo with any number of leap seconds.</span>
<span id="cb46-1086"><a href="#cb46-1086" aria-hidden="true" tabindex="-1"></a>Dec uses fractions for decimal tzos that are derived from hms triplets like the one selected by the range🎚️inputs below. Using fractions, Dec can match any UTC tzo. Instead of showing</span>
<span id="cb46-1087"><a href="#cb46-1087" aria-hidden="true" tabindex="-1"></a>To facilitate the comparison of a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and a tzo that comprise a Dec time,   easier the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} shown above can be represented by a math expression that the sum of a and its associated <span class="co">[</span><span class="ot">round-off error</span><span class="co">](https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic)</span> (<span class="co">[</span><span class="ot">roe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="round-off error"}) fraction: <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} = <span class="co">[</span><span class="ot">rdo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="rounded decimal offset"} + <span class="co">[</span><span class="ot">roe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="round-off error"}.</span>
<span id="cb46-1088"><a href="#cb46-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1089"><a href="#cb46-1089" aria-hidden="true" tabindex="-1"></a>After being converted to decidays, 26 out of <span class="co">[</span><span class="ot">38</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets)</span> <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} are <span class="co">[</span><span class="ot">repeating decimals</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=the%20same%20sequence%20of%20digits%20is%20repeated%20forever)</span>, 9 are <span class="co">[</span><span class="ot">terminating decimal</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20finite%20number%20of%20nonzero%20digits)</span>, and 3 are integers. Instead of displaying a decimal <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} as a fraction, Dec can round and display it along with its the <span class="co">[</span><span class="ot">round-off error</span><span class="co">](https://en.wikipedia.org/wiki/Round-off_error#:~:text=the%20difference%20between%20the%20result%20produced%20by%20a%20given%20algorithm%20using%20exact%20arithmetic%20and%20the%20result%20produced%20by%20the%20same%20algorithm%20using%20finite%2Dprecision%2C%20rounded%20arithmetic)</span> (<span class="co">[</span><span class="ot">roe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="round-off error"}) as a fraction.</span>
<span id="cb46-1090"><a href="#cb46-1090" aria-hidden="true" tabindex="-1"></a>Dec displays <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} derived from the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets, like the one selected by the range🎚️inputs below, as a fraction:</span>
<span id="cb46-1091"><a href="#cb46-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1092"><a href="#cb46-1092" aria-hidden="true" tabindex="-1"></a>In its most basic form, a Dec time consists of a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}. Typically, all of the components of a Dec time are measured in <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}. Dec times are essentially math expressions that can be simplified to Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"}.</span>
<span id="cb46-1093"><a href="#cb46-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1094"><a href="#cb46-1094" aria-hidden="true" tabindex="-1"></a>In  The "Hour" range input above cannot be used to select a negative value.  In essence, Dec times are math expressions that can be simplified to the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}: \${leapTodHsl1} -- \${leapTzoHsl2} = \${zeroTimeHsl4}.</span>
<span id="cb46-1095"><a href="#cb46-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1096"><a href="#cb46-1096" aria-hidden="true" tabindex="-1"></a>If we include a sum of leap seconds that is not zero or a multiple of 8640, none of the <span class="co">[</span><span class="ot">38</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets)</span> <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} will be an integer. You can The deciday value of the</span>
<span id="cb46-1097"><a href="#cb46-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1098"><a href="#cb46-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1099"><a href="#cb46-1099" aria-hidden="true" tabindex="-1"></a>The fractions we will have a UTC will match Zone 0 from <span class="co">[</span><span class="ot">-1276/320</span><span class="co">]</span>{.color5} to <span class="co">[</span><span class="ot">5603/960</span><span class="co">]</span>{.color5}. With leap seconds, none of  <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} have <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} the range of <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} is <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5} to <span class="co">[</span><span class="ot">35/6</span><span class="co">]</span>{.color583} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}.</span>
<span id="cb46-1100"><a href="#cb46-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1101"><a href="#cb46-1101" aria-hidden="true" tabindex="-1"></a>Using <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} expressed as fractions, Dec can match the time in UTC time zones, Dec often has to To avoid date mismatches with [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones](https://en.wikipedia.org/wiki/List_of_UTC_offsets) that have negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}, we can subtract ten <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} from any positive <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} to make it negative: \${decOffsetHslP} -- <span class="co">[</span><span class="ot">10</span><span class="co">]</span>{.color0} = \${decOffsetHslN}.</span>
<span id="cb46-1102"><a href="#cb46-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1105"><a href="#cb46-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-1106"><a href="#cb46-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">frac</span>(<span class="dv">27</span>)<span class="op">.</span><span class="fu">div</span>(<span class="dv">8640</span>)<span class="op">.</span><span class="fu">add</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">320</span>)<span class="op">.</span><span class="fu">toFraction</span>()</span>
<span id="cb46-1107"><a href="#cb46-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1108"><a href="#cb46-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1111"><a href="#cb46-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-1112"><a href="#cb46-1112" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-1113"><a href="#cb46-1113" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: offinput</span></span>
<span id="cb46-1114"><a href="#cb46-1114" aria-hidden="true" tabindex="-1"></a>viewof offset <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">9</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Offset"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb46-1115"><a href="#cb46-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1116"><a href="#cb46-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1117"><a href="#cb46-1117" aria-hidden="true" tabindex="-1"></a>Disregarding leap seconds, the [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5}](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180°%20and%20172°30′W%20longitude) time zone is exactly one day behind Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} and thus has the same time but a different date.</span>
<span id="cb46-1118"><a href="#cb46-1118" aria-hidden="true" tabindex="-1"></a>If date mismatches are not a concern,</span>
<span id="cb46-1119"><a href="#cb46-1119" aria-hidden="true" tabindex="-1"></a>Negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} associated with a date, Dec will standardize its bring its that has an integer <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} will belong to one of the ten Dec time zones. If a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} is not an integer, Dec will either express it as All other <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} will not be compatible with any of the twn Dec time zones, but may match either <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} or the time in a [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone](https://en.wikipedia.org/wiki/List_of_UTC_offsets).</span>
<span id="cb46-1120"><a href="#cb46-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1121"><a href="#cb46-1121" aria-hidden="true" tabindex="-1"></a>Any <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} that is an integer will produce a time that matches the time in one of the ten Dec time zones.</span>
<span id="cb46-1122"><a href="#cb46-1122" aria-hidden="true" tabindex="-1"></a>After being converted to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, the latest <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} that can be selected above is a <span class="co">[</span><span class="ot">terminating decimal</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20finite%20number%20of%20nonzero%20digits)</span> and all of the others are <span class="co">[</span><span class="ot">repeating decimals</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=the%20same%20sequence%20of%20digits%20is%20repeated%20forever)</span>. In contrast, 26 out of <span class="co">[</span><span class="ot">38</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets)</span> <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} are repeating decimals, 9 are terminating decimals, and 3 are integers.</span>
<span id="cb46-1123"><a href="#cb46-1123" aria-hidden="true" tabindex="-1"></a>Dec can round it</span>
<span id="cb46-1124"><a href="#cb46-1124" aria-hidden="true" tabindex="-1"></a>he current Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} time is \${zeroTimeHsl3}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{.mono}<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}.</span>
<span id="cb46-1125"><a href="#cb46-1125" aria-hidden="true" tabindex="-1"></a>where the <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} is the minuend and the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} is a .</span>
<span id="cb46-1126"><a href="#cb46-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1127"><a href="#cb46-1127" aria-hidden="true" tabindex="-1"></a>A Dec time consists of a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}. We can evaluate any Dec time as Dec can display a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} together as , we get a Dec time. and a tzo that differs from the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} is defined as the sum of the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}. The ten Dec time zones are labeled <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} to <span class="co">[</span><span class="ot">9</span><span class="co">]</span>{.color9} based on their <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}. To find the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} of a location, we floor its deciparallel longitude. of the all single-digit positive integers: . To find the Dec time zone with the closest to a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone with a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} can be  have a similar time</span>
<span id="cb46-1128"><a href="#cb46-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1129"><a href="#cb46-1129" aria-hidden="true" tabindex="-1"></a>We can combine the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} of any of the ten Dec time zones with a tod to create a .time all single-digit positive integers. We can combine an UT can be measured using vlbi with a precision greater than a fifth of a microday.</span>
<span id="cb46-1130"><a href="#cb46-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1131"><a href="#cb46-1131" aria-hidden="true" tabindex="-1"></a>D</span>
<span id="cb46-1132"><a href="#cb46-1132" aria-hidden="true" tabindex="-1"></a>Dec can either display</span>
<span id="cb46-1133"><a href="#cb46-1133" aria-hidden="true" tabindex="-1"></a>Each of the ten Dec time zones has a tzo that is a single-digit positive integer. We can make any  Dec displays <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} based on hours, minutes, and seconds as fractions to avoid rounding recurring decimal numbers. ec measures tzos in decidays. The tzos of the ten Dec time zones are all single-digit positive integers. Dec displays</span>
<span id="cb46-1134"><a href="#cb46-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1135"><a href="#cb46-1135" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} does not belong to any of the ten Dec time zones. Similarly, In general, the difference between needed to is able to support any number kk we can a zonal time is the sum of a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}. The tzo of any zonal time is a floored longitude. and solar times</span>
<span id="cb46-1136"><a href="#cb46-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1137"><a href="#cb46-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1138"><a href="#cb46-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">## International date line {.hiddenheading #idl}</span></span>
<span id="cb46-1139"><a href="#cb46-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1140"><a href="#cb46-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1141"><a href="#cb46-1141" aria-hidden="true" tabindex="-1"></a>Dec measures longitude in <span class="co">[</span><span class="ot">parallels</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line) (<span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="parallels"}) or submultiples of <span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="parallels"} starting from Longitude <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, the Dec <span class="co">[</span><span class="ot">prime meridian</span><span class="co">](https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0)</span> and <span class="co">[</span><span class="ot">"international date line"</span><span class="co">](https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next)</span> (<span class="co">[</span><span class="ot">idl</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="international date line"}).</span>
<span id="cb46-1142"><a href="#cb46-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1143"><a href="#cb46-1143" aria-hidden="true" tabindex="-1"></a>To calculate the <span class="co">[</span><span class="ot">mst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="mean solar time"} for a location, we add its longitude in <span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} to the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and then subtract 5 <span class="co">[</span><span class="ot">centidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundredths of a day"}. If the result is negative, we can make it positive by</span>
<span id="cb46-1144"><a href="#cb46-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1145"><a href="#cb46-1145" aria-hidden="true" tabindex="-1"></a>$$\text{mst} = \text{tod} + \lambda - 0.05$$</span>
<span id="cb46-1146"><a href="#cb46-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1147"><a href="#cb46-1147" aria-hidden="true" tabindex="-1"></a>$$\text{mst} = (\text{tod} + \lambda + 0.95) \text{ mod } 1$$</span>
<span id="cb46-1148"><a href="#cb46-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1149"><a href="#cb46-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1150"><a href="#cb46-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1151"><a href="#cb46-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Apparent solar time {.hiddenheading #ast}</span></span>
<span id="cb46-1152"><a href="#cb46-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1153"><a href="#cb46-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1154"><a href="#cb46-1154" aria-hidden="true" tabindex="-1"></a>Longitude <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} separates Zones <span class="co">[</span><span class="ot">9</span><span class="co">]</span>{.color9} and <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}.</span>
<span id="cb46-1155"><a href="#cb46-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1156"><a href="#cb46-1156" aria-hidden="true" tabindex="-1"></a>In the middle of Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} is Longitude <span class="co">[</span><span class="ot">0.5</span><span class="co">]</span>{.color05}, the Dec solar time prime meridian, which is not shown on the map🗺️above.</span>
<span id="cb46-1157"><a href="#cb46-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1158"><a href="#cb46-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1159"><a href="#cb46-1159" aria-hidden="true" tabindex="-1"></a>Longitude <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}</span>
<span id="cb46-1160"><a href="#cb46-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1161"><a href="#cb46-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1162"><a href="#cb46-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1163"><a href="#cb46-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1164"><a href="#cb46-1164" aria-hidden="true" tabindex="-1"></a> Zonal times match <span class="co">[</span><span class="ot">mst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="mean solar time"} only in the centers of time zones.</span>
<span id="cb46-1165"><a href="#cb46-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1166"><a href="#cb46-1166" aria-hidden="true" tabindex="-1"></a>In between Longitudes <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} and <span class="co">[</span><span class="ot">1</span><span class="co">]</span>{.color1} is Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}.</span>
<span id="cb46-1167"><a href="#cb46-1167" aria-hidden="true" tabindex="-1"></a>From the perspective of Zone 0, During solar noon, when the Sun is at its highest point, the solar time</span>
<span id="cb46-1168"><a href="#cb46-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1169"><a href="#cb46-1169" aria-hidden="true" tabindex="-1"></a>the leftmost vertical line on the map🗺️above, which cuts across the Atlantic Ocean through Iceland🇮🇸just West of Africa.</span>
<span id="cb46-1170"><a href="#cb46-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1171"><a href="#cb46-1171" aria-hidden="true" tabindex="-1"></a> Arranging Dec time zones from 0 to 9 yields a <span class="co">[</span><span class="ot">Pacific-centric</span><span class="co">]</span>(https://en.wikipedia.org/wiki/orld_map#:~:text=south%2Dup%20map-,Pacific%2Dcentric%20map,-(more%20commonly%20used)) map🗺️.</span>
<span id="cb46-1172"><a href="#cb46-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1173"><a href="#cb46-1173" aria-hidden="true" tabindex="-1"></a>At any given moment, there is just one UT for the entire world, a zonal time for every time zone, and two types of solar time for every longitude: “mean</span>
<span id="cb46-1174"><a href="#cb46-1174" aria-hidden="true" tabindex="-1"></a>solar time” (mst) and “apparent solar time” (ast).</span>
<span id="cb46-1175"><a href="#cb46-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1176"><a href="#cb46-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1177"><a href="#cb46-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1178"><a href="#cb46-1178" aria-hidden="true" tabindex="-1"></a>To The two types of , <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"}, and <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} in general must be greater that negative one and less than one day: -1 &lt; t &lt; 1. If we ever encounter a tod outside these bounds, we can</span>
<span id="cb46-1179"><a href="#cb46-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1180"><a href="#cb46-1180" aria-hidden="true" tabindex="-1"></a>$$-1 &lt; \text{tod} &lt; 1$$</span>
<span id="cb46-1181"><a href="#cb46-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1182"><a href="#cb46-1182" aria-hidden="true" tabindex="-1"></a>In Dec, <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"}, <span class="co">[</span><span class="ot">msts</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="mean solar times"}, <span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"}, and <span class="co">[</span><span class="ot">asts</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="apparent solar times"} are bound between -1 and 1. equations above make sure that the The equation above works for any <span class="co">[</span><span class="ot">tod</span><span class="co">]</span> in days and longitude in <span class="co">[</span><span class="ot">$\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="parallels"}, even those that are outside the typical bounds. In Dec, less than zero or greater than one (0 <span class="dv">&amp;le;</span> x <span class="dv">&amp;lt;</span> 1). If we ever need to deal with an negative values, we can always add one and then keep the remainder after dividing by one. Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} starts at a longitude of 0 <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} and is 1 <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} wide. In contrast,  0.5 <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} it is midnight in , the <span class="co">[</span><span class="ot">mst</span><span class="co">]</span> in  Unlike <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"}, <span class="co">[</span><span class="ot">ast</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="apparent solar time"} also varies by longitude and is cyclical on a yearly basis. To approximate <span class="co">[</span><span class="ot">ast</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="apparent solar time"} for a given <span class="co">[</span><span class="ot">deci[parallel](https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel"} <span class="co">[</span><span class="ot">longitude</span><span class="co">](https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda)</span> (<span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"}) and <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"}, we sum the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"}, and the result obtained from plugging the <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} into the <span class="co">[</span><span class="ot">equation of time</span><span class="co">](https://en.wikipedia.org/wiki/Equation_of_time#:~:text=the%20discrepancy%20between%20two%20kinds%20of%20solar%20time)</span> (<span class="co">[</span><span class="ot">eot</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"}): \${zeroTimeHsl2} + \${longInputHsl} + \${eotHsl} = \${eotSumHsl}.</span>
<span id="cb46-1183"><a href="#cb46-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1184"><a href="#cb46-1184" aria-hidden="true" tabindex="-1"></a>$$\text{mst} = (\text{tod} + \lambda + 0.95) \text{ mod } 1$$</span>
<span id="cb46-1185"><a href="#cb46-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1186"><a href="#cb46-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1189"><a href="#cb46-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-1190"><a href="#cb46-1190" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-1191"><a href="#cb46-1191" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: longinput</span></span>
<span id="cb46-1192"><a href="#cb46-1192" aria-hidden="true" tabindex="-1"></a>viewof longInput <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Longitude"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="fl">0.01</span>})</span>
<span id="cb46-1193"><a href="#cb46-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1194"><a href="#cb46-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1195"><a href="#cb46-1195" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">National Oceanic and Atmospheric Administration</span><span class="co">](https://www.noaa.gov)</span> (<span class="co">[</span><span class="ot">NOAA</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration"}) provides <span class="co">[</span><span class="ot">yearly and daily [eot]{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"} values</span><span class="co">](https://gml.noaa.gov/grad/solcalc/calcdetails.html)</span>. To create a Dec version of the <span class="co">[</span><span class="ot">eot</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"}, we can sort the yearly <span class="co">[</span><span class="ot">NOAA</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration"} <span class="co">[</span><span class="ot">eot</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"} values by their <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} and then <span class="co">[</span><span class="ot">fit a curve</span><span class="co">](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html)</span> to the sorted values so that we can use the fitted model coefficients ($\beta_0$ to $\beta_4$) as the <span class="co">[</span><span class="ot">eot</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"} constants in the <span class="co">[</span><span class="ot">NOAA</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration"} <span class="co">[</span><span class="ot">General Solar Position Calculations</span><span class="co">](https://gml.noaa.gov/grad/solcalc/solareqns.PDF)</span>:</span>
<span id="cb46-1196"><a href="#cb46-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1197"><a href="#cb46-1197" aria-hidden="true" tabindex="-1"></a>$$\tau = 2 \times \pi$$</span>
<span id="cb46-1198"><a href="#cb46-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1199"><a href="#cb46-1199" aria-hidden="true" tabindex="-1"></a>$$\text{toy} = \text{doy} \div \text{n}$$</span>
<span id="cb46-1200"><a href="#cb46-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1201"><a href="#cb46-1201" aria-hidden="true" tabindex="-1"></a>$$\gamma = \tau \times \text{toy}$$</span>
<span id="cb46-1202"><a href="#cb46-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1203"><a href="#cb46-1203" aria-hidden="true" tabindex="-1"></a>$$\begin{split}</span>
<span id="cb46-1204"><a href="#cb46-1204" aria-hidden="true" tabindex="-1"></a>\text{eot}(\gamma) &amp; = \beta_0 <span class="sc">\\</span></span>
<span id="cb46-1205"><a href="#cb46-1205" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_1 \times \cos(\gamma) <span class="sc">\\</span></span>
<span id="cb46-1206"><a href="#cb46-1206" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_2 \times \sin(\gamma) <span class="sc">\\</span></span>
<span id="cb46-1207"><a href="#cb46-1207" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_3 \times \cos(2\gamma) <span class="sc">\\</span></span>
<span id="cb46-1208"><a href="#cb46-1208" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_4 \times \sin(2\gamma)</span>
<span id="cb46-1209"><a href="#cb46-1209" aria-hidden="true" tabindex="-1"></a>\end{split}$$</span>
<span id="cb46-1210"><a href="#cb46-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1211"><a href="#cb46-1211" aria-hidden="true" tabindex="-1"></a>$$\text{ast} = (\text{mst} + \text{eot}(\gamma) + 10) \mod 10$$</span>
<span id="cb46-1212"><a href="#cb46-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1213"><a href="#cb46-1213" aria-hidden="true" tabindex="-1"></a><span class="fu">## Equation of time {.hiddenheading #eot}</span></span>
<span id="cb46-1214"><a href="#cb46-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1215"><a href="#cb46-1215" aria-hidden="true" tabindex="-1"></a>In the equations above, $\tau$ is two times $\pi$, n is the number of days in a year, the "time of year" (<span class="co">[</span><span class="ot">toy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of year"}) is the <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} divided by n, $\gamma$ is the <span class="co">[</span><span class="ot">toy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of year"} multiplied by $\tau$, "mean solar time" (<span class="co">[</span><span class="ot">mst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="mean solar time"}) is the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} plus <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"}. We can refer to <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} as the <span class="co">[</span><span class="ot">mst</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="mean solar time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} and the sum of <span class="co">[</span><span class="ot">$\text d\lambda$</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="deciparallels"} and <span class="co">[</span><span class="ot">eot</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"}($\gamma$) as the <span class="co">[</span><span class="ot">ast</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="apparent solar time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}. Using the coefficients shown below, we can plot <span class="co">[</span><span class="ot">eot</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"}($\gamma$) against <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"}:</span>
<span id="cb46-1216"><a href="#cb46-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1217"><a href="#cb46-1217" aria-hidden="true" tabindex="-1"></a>{{&lt; embed eot.ipynb#eot &gt;}}</span>
<span id="cb46-1218"><a href="#cb46-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1221"><a href="#cb46-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-1222"><a href="#cb46-1222" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-1223"><a href="#cb46-1223" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: eotplot</span></span>
<span id="cb46-1224"><a href="#cb46-1224" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mcmcclur/plot-for-mathematicians</span></span>
<span id="cb46-1225"><a href="#cb46-1225" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb46-1226"><a href="#cb46-1226" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> w <span class="op">=</span> <span class="dv">800</span><span class="op">;</span></span>
<span id="cb46-1227"><a href="#cb46-1227" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> h <span class="op">=</span> <span class="fl">0.625</span> <span class="op">*</span> w<span class="op">;</span></span>
<span id="cb46-1228"><a href="#cb46-1228" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> samples <span class="op">=</span> <span class="fu">build_samples</span>(</span>
<span id="cb46-1229"><a href="#cb46-1229" aria-hidden="true" tabindex="-1"></a>    getEot<span class="op">,</span> <span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">365</span><span class="op">,</span> { <span class="dt">N</span><span class="op">:</span> <span class="dv">150</span> }</span>
<span id="cb46-1230"><a href="#cb46-1230" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb46-1231"><a href="#cb46-1231" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> plot <span class="op">=</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb46-1232"><a href="#cb46-1232" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span></span>
<span id="cb46-1233"><a href="#cb46-1233" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> w<span class="op">,</span></span>
<span id="cb46-1234"><a href="#cb46-1234" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> h<span class="op">,</span></span>
<span id="cb46-1235"><a href="#cb46-1235" aria-hidden="true" tabindex="-1"></a>    <span class="dt">style</span><span class="op">:</span> <span class="st">"font-size:19;"</span><span class="op">,</span></span>
<span id="cb46-1236"><a href="#cb46-1236" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"time zone offset"</span>}<span class="op">,</span></span>
<span id="cb46-1237"><a href="#cb46-1237" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"day of year"</span>}<span class="op">,</span></span>
<span id="cb46-1238"><a href="#cb46-1238" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb46-1239"><a href="#cb46-1239" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">line</span>(samples<span class="op">,</span> {</span>
<span id="cb46-1240"><a href="#cb46-1240" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb46-1241"><a href="#cb46-1241" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"steelblue"</span><span class="op">,</span></span>
<span id="cb46-1242"><a href="#cb46-1242" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tip</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb46-1243"><a href="#cb46-1243" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb46-1244"><a href="#cb46-1244" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="op">-</span><span class="dv">366</span>])<span class="op">,</span></span>
<span id="cb46-1245"><a href="#cb46-1245" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleY</span>([<span class="dv">0</span>])<span class="op">,</span></span>
<span id="cb46-1246"><a href="#cb46-1246" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisX</span>({ <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span> })<span class="op">,</span></span>
<span id="cb46-1247"><a href="#cb46-1247" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({ <span class="dt">x</span><span class="op">:</span> <span class="op">-</span><span class="dv">366</span> })</span>
<span id="cb46-1248"><a href="#cb46-1248" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb46-1249"><a href="#cb46-1249" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb46-1250"><a href="#cb46-1250" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> plot<span class="op">;</span></span>
<span id="cb46-1251"><a href="#cb46-1251" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1252"><a href="#cb46-1252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-1253"><a href="#cb46-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1254"><a href="#cb46-1254" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solar declination angle {.hiddenheading #sda}</span></span>
<span id="cb46-1255"><a href="#cb46-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1256"><a href="#cb46-1256" aria-hidden="true" tabindex="-1"></a>We can subtract the <span class="co">[</span><span class="ot">ast</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="apparent solar time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} from five to get the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} of <span class="co">[</span><span class="ot">solar noon</span><span class="co">](https://en.wikipedia.org/wiki/Noon#:~:text=reaching%20its%20highest%20position%20above%20the%20horizon%20on%20that%20day%20and%20casting%20the%20shortest%20shadow)</span> at the given longitude. Before we can find the sunrise and sunset <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, we first need to calculate the solar declination angle (<span class="co">[</span><span class="ot">sda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="solar declination angle"}). For simplicity, we can use the <span class="co">[</span><span class="ot">eot</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="equation of time"} for <span class="co">[</span><span class="ot">sda</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="solar declination angle"}, even though the <span class="co">[</span><span class="ot">NOAA</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="National Oceanic and Atmospheric Administration"} <span class="co">[</span><span class="ot">General Solar Position Calculations</span><span class="co">](https://gml.noaa.gov/grad/solcalc/solareqns.PDF)</span> propose the more complex model shown below.</span>
<span id="cb46-1257"><a href="#cb46-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1258"><a href="#cb46-1258" aria-hidden="true" tabindex="-1"></a>$$\text{noon} = (5 - \text{d}\lambda - \text{eot}(\gamma) + 10) \mod 10$$</span>
<span id="cb46-1259"><a href="#cb46-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1260"><a href="#cb46-1260" aria-hidden="true" tabindex="-1"></a>$$\begin{split}</span>
<span id="cb46-1261"><a href="#cb46-1261" aria-hidden="true" tabindex="-1"></a>\text{sda}(\gamma) &amp; = \beta_0 <span class="sc">\\</span></span>
<span id="cb46-1262"><a href="#cb46-1262" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_1 \times \cos(\gamma) <span class="sc">\\</span></span>
<span id="cb46-1263"><a href="#cb46-1263" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_2 \times \sin(\gamma) <span class="sc">\\</span></span>
<span id="cb46-1264"><a href="#cb46-1264" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_3 \times \cos(2\gamma) <span class="sc">\\</span></span>
<span id="cb46-1265"><a href="#cb46-1265" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_4 \times \sin(2\gamma) <span class="sc">\\</span></span>
<span id="cb46-1266"><a href="#cb46-1266" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_5 \times \cos(3\gamma) <span class="sc">\\</span></span>
<span id="cb46-1267"><a href="#cb46-1267" aria-hidden="true" tabindex="-1"></a>&amp; + \beta_6 \times \sin(3\gamma) <span class="sc">\\</span></span>
<span id="cb46-1268"><a href="#cb46-1268" aria-hidden="true" tabindex="-1"></a>\end{split}$$</span>
<span id="cb46-1269"><a href="#cb46-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1270"><a href="#cb46-1270" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solar hour angle {.hiddenheading #sha}</span></span>
<span id="cb46-1271"><a href="#cb46-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1272"><a href="#cb46-1272" aria-hidden="true" tabindex="-1"></a>If the "solar zenith angle" (<span class="co">[</span><span class="ot">sza</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="solar zenith angle"}) in the equation below is 0.2523 turns, the equation will yield a sunrise "solar hour angle" (<span class="co">[</span><span class="ot">sha</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="solar hour angle"}) that we can use to get a sunrise or sunset <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}. Dec measures angles in turns. The trigonometric functions of most --- if not all -- programming languages require radians. To convert turns into radians, we multiply by $\tau$.</span>
<span id="cb46-1273"><a href="#cb46-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1274"><a href="#cb46-1274" aria-hidden="true" tabindex="-1"></a>$$\text{radian} = \text{turn} \times \tau = \text{degree} \times \tau \div 360$$</span>
<span id="cb46-1275"><a href="#cb46-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1276"><a href="#cb46-1276" aria-hidden="true" tabindex="-1"></a>$$\text{turn} = \text{radian} \div \tau = \text{degree} \div 360$$</span>
<span id="cb46-1277"><a href="#cb46-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1278"><a href="#cb46-1278" aria-hidden="true" tabindex="-1"></a>$$\text{degree} = \text{radian} \div \tau \div 360 = \text{turn} \times 360$$</span>
<span id="cb46-1279"><a href="#cb46-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1280"><a href="#cb46-1280" aria-hidden="true" tabindex="-1"></a>$$\text{sha} = \arccos\left( \frac{\cos(\text{sza}\times\tau)}{\cos(\phi\times\tau) \cdot \cos(\text{sda}\times\tau)} - \tan(\text{$\phi\times\tau$}) \cdot \tan(\text{sda}\times\tau) \right)$$</span>
<span id="cb46-1281"><a href="#cb46-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1282"><a href="#cb46-1282" aria-hidden="true" tabindex="-1"></a>In the equation above, latitude is measured in turns called meridians ($\phi$). The difference between a solar noon and sunrise <span class="co">[</span><span class="ot">sha</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="solar hour angle"} is a sunrise <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}. Likewise, the sum of a solar noon and sunrise <span class="co">[</span><span class="ot">sha</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="solar hour angle"} is a sunset <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}. To get the daylight duration in decidays, we can either subtract the sunset <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} from the sunrise <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} or multiply the sunrise <span class="co">[</span><span class="ot">sha</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="solar hour angle"} by twenty.</span>
<span id="cb46-1283"><a href="#cb46-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1284"><a href="#cb46-1284" aria-hidden="true" tabindex="-1"></a>$$\text{sunrise} = \text{noon} - \text{sha}$$</span>
<span id="cb46-1285"><a href="#cb46-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1286"><a href="#cb46-1286" aria-hidden="true" tabindex="-1"></a>$$\text{sunset} = \text{noon} + \text{sha}$$</span>
<span id="cb46-1287"><a href="#cb46-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1288"><a href="#cb46-1288" aria-hidden="true" tabindex="-1"></a>$$\text{duration} = \text{sunset} - \text{sunrise} = \text{sha} \times 20$$</span>
<span id="cb46-1289"><a href="#cb46-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1290"><a href="#cb46-1290" aria-hidden="true" tabindex="-1"></a>The sunrise and sunset times in the equations above depend on the time zone of solar noon. To select a time zone  may be strange to consider The range🎚️inputs below set the <span class="co">[</span><span class="ot">geographic coordinates</span><span class="co">](https://en.wikipedia.org/wiki/Geographic_coordinate_system#:~:text=positions%20directly%20on%20Earth%20as%20latitude%20and%20longitude)</span> that are used for the equations above. The <span class="co">[</span><span class="ot">line chart</span><span class="co">](https://en.wikipedia.org/wiki/Line_chart#:~:text=a%20type%20of%20chart%20that%20displays%20information%20as%20a%20series%20of%20data%20points%20called%20%27markers%27%20connected%20by%20straight%20line%20segments)</span> beneath the inputs visualizes sunrise and sunset for every <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"}, similar to the daylight area chart beneath the map🗺above. The main difference between the charts is that the area chart shows local <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} and thus is independent of longitude, whereas the line chart displays <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} and therefore changes with longitude.</span>
<span id="cb46-1291"><a href="#cb46-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1292"><a href="#cb46-1292" aria-hidden="true" tabindex="-1"></a>In general, computer programmers and mathematicians seem to prefer radians over degrees.  are better because the Dec base units of time, longitude, and latitude can be multiplied by $\tau$ to can convert days, parallels, and meridians into radians simply by multiplying to . Apart from such as solar noon,</span>
<span id="cb46-1293"><a href="#cb46-1293" aria-hidden="true" tabindex="-1"></a>In Dec, any <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} can be expanded to show a subtrahend and a difference. specific point in the day called a subtrahend. The difference between the original <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} and a . A <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} without the diff is called a minuend and Positive diffs show how much time has passed and negative diffs show how much time is left.</span>
<span id="cb46-1294"><a href="#cb46-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1295"><a href="#cb46-1295" aria-hidden="true" tabindex="-1"></a>$$\text{minuend} = \text{subtrahend} + \text{diff}$$</span>
<span id="cb46-1296"><a href="#cb46-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1297"><a href="#cb46-1297" aria-hidden="true" tabindex="-1"></a>$$\text{minuend} = \text{subtrahend} + \text{diff}$$</span>
<span id="cb46-1298"><a href="#cb46-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1299"><a href="#cb46-1299" aria-hidden="true" tabindex="-1"></a>The Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} relative to the solar noon that corresponds to the <span class="co">[</span><span class="ot">doy</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="day of year"} and longitude selected by the range🎚️inputs above is \${solarNoonHsl}\${solarSign}\${solarDiffHsl}.</span>
<span id="cb46-1300"><a href="#cb46-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1301"><a href="#cb46-1301" aria-hidden="true" tabindex="-1"></a>In Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, this was our solar noon, we could  could all agree to center our daily schedules on the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} of our local solar noon, there would be no need for time zones.  could start work two decidays before solar noon and finish two decidays after solar noon.</span>
<span id="cb46-1302"><a href="#cb46-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1303"><a href="#cb46-1303" aria-hidden="true" tabindex="-1"></a> depends on <span class="co">[</span><span class="ot">longitude</span><span class="co">](https://en.wikipedia.org/wiki/Longitude#:~:text=denoted%20by%20the%20Greek%20letter%20lambda)</span>.</span>
<span id="cb46-1304"><a href="#cb46-1304" aria-hidden="true" tabindex="-1"></a>At any given moment, there is only one <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} and 10^5^ five-digit mean solar times.</span>
<span id="cb46-1305"><a href="#cb46-1305" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} we use to get the <span class="co">[</span><span class="ot">mean solar time</span><span class="co">](https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year)</span> of a location is equal to its <span class="co">[</span><span class="ot">deci[parallel](https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel"} longitude. We can use the <span class="co">[</span><span class="ot">equation of time</span><span class="co">](https://en.wikipedia.org/wiki/Equation_of_time#:~:text=the%20discrepancy%20between%20two%20kinds%20of%20solar%20time)</span> to turn the mean solar time of into <span class="co">[</span><span class="ot">apparent solar time</span><span class="co">](https://en.wikipedia.org/wiki/Solar_time#Apparent_solar_time:~:text=the%20true%20sun%20as%20seen%20by%20an%20observer%20on%20Earth)</span>.</span>
<span id="cb46-1306"><a href="#cb46-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1307"><a href="#cb46-1307" aria-hidden="true" tabindex="-1"></a>sum of a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} and the Zone 0 tod. We can use the equation of time to turn the mean solar time of a location</span>
<span id="cb46-1308"><a href="#cb46-1308" aria-hidden="true" tabindex="-1"></a>Similarly, the <span class="co">[</span><span class="ot">deci[parallel](https://en.wikipedia.org/wiki/Circle_of_latitude#:~:text=an%20abstract%20east%E2%80%93west%20small%20circle%20connecting%20all%20locations%20around%20Earth%20(ignoring%20elevation)%20at%20a%20given%20latitude%20coordinate%20line)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a parallel"} longitude of the red⭕️circle on the map above is the tzo that we sum with the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} to get <span class="co">[</span><span class="ot">mean solar time</span><span class="co">](https://en.wikipedia.org/wiki/Solar_time#Mean_solar_time:~:text=it%20follows%20an%20imaginary%20%22mean%20Sun%22%20that%20moves%20along%20the%20celestial%20equator%20at%20a%20constant%20rate%20that%20matches%20the%20real%20Sun%27s%20average%20rate%20over%20the%20year)</span>.</span>
<span id="cb46-1309"><a href="#cb46-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1310"><a href="#cb46-1310" aria-hidden="true" tabindex="-1"></a>Without leap seconds, the duration of a day is constant, each <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet occurs only once per day, <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets can be derived directly from UNIX time or a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} independently of the date as shown above, and the <span class="co">[</span><span class="ot">som</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="second of minute"} component stays within its bounds: 0 <span class="dv">&amp;le;</span> <span class="co">[</span><span class="ot">som</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="second of minute"} &lt; 60.</span>
<span id="cb46-1311"><a href="#cb46-1311" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} is based on <span class="co">[</span><span class="ot">atomic clocks</span><span class="co">](https://en.wikipedia.org/wiki/Atomic_clock#:~:text=a%20clock%20that%20measures%20time%20by%20monitoring%20the%20resonant%20frequency%20of%20atoms)</span> and <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} is determined by the <span class="co">[</span><span class="ot">rotation of the Earth</span><span class="co">](https://en.wikipedia.org/wiki/Earth%27s_rotation#:~:text=the%20rotation%20of%20planet%20Earth%20around%20its%20own%20axis)</span>. rom the perspective of Dec,</span>
<span id="cb46-1312"><a href="#cb46-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1313"><a href="#cb46-1313" aria-hidden="true" tabindex="-1"></a> that represents the difference between <span class="co">[</span><span class="ot">UT</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Universal Time"} and the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}.</span>
<span id="cb46-1314"><a href="#cb46-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1315"><a href="#cb46-1315" aria-hidden="true" tabindex="-1"></a>To display <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets, Dec uses math expressions that evaluate to a <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and leave no doubt about the measurement unit of each component: <span class="co">[</span><span class="ot">hod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour of day"}/2.4+<span class="co">[</span><span class="ot">moh</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="minute of hour"}/144+<span class="co">[</span><span class="ot">som</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="second of minute"}/8640. Like the <span class="co">[</span><span class="ot">Julia</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Julia_(programming_language)#:~:text=a%20dynamic%20general%2Dpurpose%20programming%20language), <span class="co">[</span><span class="ot">Matlab</span><span class="co">](https://en.wikipedia.org/wiki/MATLAB#:~:text=a%20proprietary%20multi%2Dparadigm%20programming%20language)</span>, and <span class="co">[</span><span class="ot">R</span><span class="co">]</span>(https://en.wikipedia.org/wiki/R_(programming_language)#:~:text=a%20programming%20language%20for%20statistical%20computing%20and%20data%20visualization) programming languages, Dec uses colons for numeric sequences such as 12:15, which means 12, 13, 14, and 15 instead of 12.25 hours.</span>
<span id="cb46-1316"><a href="#cb46-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1317"><a href="#cb46-1317" aria-hidden="true" tabindex="-1"></a>Dec uses centimillidays (<span class="co">[</span><span class="ot">cmds</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="centimillidays"}) in lieu of seconds. Centimillidays Instead of inserting a submultiple of a day into tods, would be to follow the switch from base 10 to base 11 on a specific date and then switch back. The last tod on that date would be 9.999Abbbbbbbbbbbbb  able to take leap seconds into account without changing the duration of a day, repeating a tod within the same day, handles leap seconds by converting them to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} and adding them to a "<span class="co">[</span><span class="ot">time zone offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place)" (<span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}). This way, Dec can match any time with any number of leap seconds the duration of a day never changes, <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets never repeat within the same day,</span>
<span id="cb46-1318"><a href="#cb46-1318" aria-hidden="true" tabindex="-1"></a>Dec can match any possible  All of the  we can be certain that leap seconds do not exist, meaning that In Dec, days always have the same duration, we can obtain a tod without knowing the date, and tods never go outside their bounds or repeat within the same day. ,  of decimal  inserts leap days to increase the duration of leap year from 365 to 366 days, but leap seconds cannot exist.</span>
<span id="cb46-1319"><a href="#cb46-1319" aria-hidden="true" tabindex="-1"></a>Leap seconds /</span>
<span id="cb46-1320"><a href="#cb46-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1321"><a href="#cb46-1321" aria-hidden="true" tabindex="-1"></a>Negative leap seconds are evidence  If an hms triplet repeats, we will know that a had just been inserted. If an hms triplet exceeds its bounds, we will know that a positive leap second had just been inserted. In general, we cannot know how many leap seconds have been inserted thus far simply by looking at an hms triplet.</span>
<span id="cb46-1322"><a href="#cb46-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1323"><a href="#cb46-1323" aria-hidden="true" tabindex="-1"></a>of sixty seconds in a minute. In Dec, every <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} leap seconds are literally impossible, because days always have the same duration and <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} are decimal numbers.</span>
<span id="cb46-1324"><a href="#cb46-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1325"><a href="#cb46-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1326"><a href="#cb46-1326" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Python</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Python_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%20programming%20language)</span>
<span id="cb46-1327"><a href="#cb46-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1328"><a href="#cb46-1328" aria-hidden="true" tabindex="-1"></a>In Dec, days always have the same duration and <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} calculations are independent of the date.</span>
<span id="cb46-1329"><a href="#cb46-1329" aria-hidden="true" tabindex="-1"></a>Currently, 27 leap seconds</span>
<span id="cb46-1330"><a href="#cb46-1330" aria-hidden="true" tabindex="-1"></a>To know how many leap seconds have been inserted by a given date, we have to consult a table. The duration of the days into which its are inserted. Instead of changing the duration of certain days, Dec handles leap seconds by converting them to decidays and adding them to a “time zone offset” (tzo).</span>
<span id="cb46-1331"><a href="#cb46-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1332"><a href="#cb46-1332" aria-hidden="true" tabindex="-1"></a>The languages in the tabset panels in this article, Julia, Python, Observable JavaScript, and R, do not differ in this regard which Dec refers to as the "<span class="co">[</span><span class="ot">Quarto principal languages</span><span class="co">](https://quarto.org/docs/faq/#:~:text=principal%20languages%20supported%20by%20Quarto%20are%20Python%2C%20R%2C%20Julia%2C%20and%20Observable%20JavaScript)</span>" (Qpls).</span>
<span id="cb46-1333"><a href="#cb46-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1334"><a href="#cb46-1334" aria-hidden="true" tabindex="-1"></a>With the code above we can convert between a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet. According to Dec and all four of the programming languages used above, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} does not have any <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>.</span>
<span id="cb46-1335"><a href="#cb46-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1336"><a href="#cb46-1336" aria-hidden="true" tabindex="-1"></a>Dec always measures <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} in <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}. The <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} of the ten Dec time zones are all single-digit positive integers. The difference between these ten <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}, <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} to <span class="co">[</span><span class="ot">9</span><span class="co">]</span>{.color9}, we can match the time in any <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone to within 0.5 <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}.</span>
<span id="cb46-1337"><a href="#cb46-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1338"><a href="#cb46-1338" aria-hidden="true" tabindex="-1"></a>If more precise matches are required, Dec can use <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} that have more than one digit. The level of precision required depends on the situtation. Let us say that we want to schedule a meeting with someone If we want to replicate a shift form make the time in UTC time zones that have a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} of <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5}, <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, or <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5}, a . At some point the increased precision of additional digits will no If we lived in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} and wanted to schedule a meeting with someone on a particular date, we might  two digits, the time difference will not exceed 5 millidays and will be able to shift <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} by one centiday, which is less a quarter hour. With four digits, the difference between Dec and UTC <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} would be either zero or 288 milliseconds. We can choose to have more than four digits, but the difference is not likely to be noticeable. Therefore, four digits is a sensible If we wanted to match The <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} used by the highest number of people in the world is <span class="co">[</span><span class="ot">10/3</span><span class="co">]</span>{.color10by3}.</span>
<span id="cb46-1339"><a href="#cb46-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1340"><a href="#cb46-1340" aria-hidden="true" tabindex="-1"></a>There are three types of  purpose of time zones is to keep To match the time in a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone exactly, Dec will often need to use a decimal <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}.</span>
<span id="cb46-1341"><a href="#cb46-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1342"><a href="#cb46-1342" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}, UNIX time, and Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} all have a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} of <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}. <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} and because both have a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} of . If we add [<span class="co">[</span><span class="ot">27</span><span class="co">]</span>{.color1by320} leap seconds](https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC) to <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}, Dec would describe the result as a Zone <span class="co">[</span><span class="ot">0.003125</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}.</span>
<span id="cb46-1343"><a href="#cb46-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1344"><a href="#cb46-1344" aria-hidden="true" tabindex="-1"></a>Each leap second shifts a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} by <span class="co">[</span><span class="ot">1/8640</span><span class="co">]</span>{.color1by8640}.</span>
<span id="cb46-1345"><a href="#cb46-1345" aria-hidden="true" tabindex="-1"></a>By default, Dec rounds decimal <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} to the near deciday: <span class="dv">&amp;LeftFloor;</span>tzo + 0.5<span class="dv">&amp;RightFloor;</span>. When necessary, Dec is able to exactly match times that include leap seconds or a decimal <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}.</span>
<span id="cb46-1346"><a href="#cb46-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1347"><a href="#cb46-1347" aria-hidden="true" tabindex="-1"></a>The result of adding leap seconds to a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} depends on how many leap seconds we add. If we add a number of leap seconds that is a multiple of 8640, we get a</span>
<span id="cb46-1348"><a href="#cb46-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1349"><a href="#cb46-1349" aria-hidden="true" tabindex="-1"></a>and deals with negative tzos keeping the remainder after adding ten and then dividing by ten: (tzo + 10) mod 10.</span>
<span id="cb46-1350"><a href="#cb46-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1351"><a href="#cb46-1351" aria-hidden="true" tabindex="-1"></a>After combining a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}, Dec first combines it with to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, Dec rounds decimal <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} to the nearest <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"}.  and makes negative <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} that are positive integers.  and therefore rounds</span>
<span id="cb46-1352"><a href="#cb46-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1353"><a href="#cb46-1353" aria-hidden="true" tabindex="-1"></a>Unless To support leap seconds and the vast majority of <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}, Dec <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} that are . If we add leap seconds to these <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"}, they will no longer be integers</span>
<span id="cb46-1354"><a href="#cb46-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1355"><a href="#cb46-1355" aria-hidden="true" tabindex="-1"></a>[</span>
<span id="cb46-1356"><a href="#cb46-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1357"><a href="#cb46-1357" aria-hidden="true" tabindex="-1"></a>If a tzo is a <span class="co">[</span><span class="ot">repeating decimal</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal#:~:text=a%20number%20whose%20digits%20are%20eventually%20periodic)</span>, Dec will display it as a fraction.</span>
<span id="cb46-1358"><a href="#cb46-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1359"><a href="#cb46-1359" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">0003125</span><span class="co">]</span>{.color1by320}. new <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} will be <span class="co">[</span><span class="ot">0.003125</span><span class="co">]</span>{.color1by320} and the new <span class="co">[</span><span class="ot">uzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="unique zone identifier"} will be . the Dec time will be <span class="co">[</span><span class="ot">-</span><span class="co">]</span>{.mono}<span class="co">[</span><span class="ot">0003125</span><span class="co">]</span>{.color1by320}. The <span class="co">[</span><span class="ot">0003125</span><span class="co">]</span>{.color1by320} The <span class="co">[</span><span class="ot">uzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="unique zone identifier"} tells us that the go from <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} to <span class="co">[</span><span class="ot">0003125</span><span class="co">]</span> and the D</span>
<span id="cb46-1360"><a href="#cb46-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1361"><a href="#cb46-1361" aria-hidden="true" tabindex="-1"></a>an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet into a Dec time, we need to know its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}, and how many leap seconds it includes.</span>
<span id="cb46-1362"><a href="#cb46-1362" aria-hidden="true" tabindex="-1"></a>a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, from a programming language, it is  can assume that leap seconds are not included.  <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}The Dec equivalent of UTC with</span>
<span id="cb46-1363"><a href="#cb46-1363" aria-hidden="true" tabindex="-1"></a>is a Dec <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset index"}, <span class="co">[</span><span class="ot">uzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="unique zone identifier"}, If we add [<span class="co">[</span><span class="ot">27</span><span class="co">]</span>{.color1by320} leap seconds](https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC) We can combine the <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} in any Dec time zone by summing the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, [<span class="co">[</span><span class="ot">27</span><span class="co">]</span>{.color1by320} leap seconds](https://en.wikipedia.org/wiki/Leap_second#:~:text=27%20leap%20seconds%20have%20been%20added%20to%20UTC) to a Zone \${decOffsetHsl0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, we get add the result deciday and the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset index"} selected by the range🎚️input below is <span class="co">[</span><span class="ot">0.003125</span><span class="co">]</span> + \${decOffsetHsl0} = \${decTimeOffLeapTzoHsl}. If we add the resulting <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset index"} to the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}, we get \${decTimeOffLeapTzoHsl}. last two digits of this <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset index"} and <span class="co">[</span><span class="ot">uzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="unique zone identifier"} are not visible in a five-digit <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}</span>
<span id="cb46-1364"><a href="#cb46-1364" aria-hidden="true" tabindex="-1"></a>If we remove the decimal separator from this <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset index"}, we get its <span class="co">[</span><span class="ot">uzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="unique zone identifier"}: ${decTimeOffLeapUziHsl}.</span>
<span id="cb46-1365"><a href="#cb46-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1366"><a href="#cb46-1366" aria-hidden="true" tabindex="-1"></a>Every <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} has a corresponding "time zone index" (<span class="co">[</span><span class="ot">tzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone index"}). In the case of the ten Dec time zones, the <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} and <span class="co">[</span><span class="ot">tzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone index"} are identical. The <span class="co">[</span><span class="ot">tzi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone index"} that corresponds to the  Dec measures <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} in decidays. If a tzo is a single-digit integer, it likely  or fractions. The tzos of the ten Dec time zones are positive integers.</span>
<span id="cb46-1367"><a href="#cb46-1367" aria-hidden="true" tabindex="-1"></a> contain leap seconds as fractions. Even if we disregard leap seconds, fractions  in <span class="co">[</span><span class="ot">tods</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times of day"} and <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} to are single-digit integers or fractions. Dec only uses  ten Dec time zones each have a <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} that is a : <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} to <span class="co">[</span><span class="ot">9</span><span class="co">]</span>{.color9} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}. In contrast, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} range range from <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5} to <span class="co">[</span><span class="ot">5.83̅</span><span class="co">]</span>{.color583} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}. A <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone with a negative <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} will be between  have a similar time To avoid date mismatches with , we can subtract ten <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} from any positive Dec <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} to make it negative: \${decOffsetHslP} -- <span class="co">[</span><span class="ot">10</span><span class="co">]</span>{.color0} = \${decOffsetHslN}.</span>
<span id="cb46-1368"><a href="#cb46-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1369"><a href="#cb46-1369" aria-hidden="true" tabindex="-1"></a> far increase the Each leap second shifts the <span class="co">[</span><span class="ot">ozi</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="ordinal zone offset"} by</span>
<span id="cb46-1370"><a href="#cb46-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1371"><a href="#cb46-1371" aria-hidden="true" tabindex="-1"></a>Finding the Dec time zone with the closest <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} to a given <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} entails converting an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet to decidays, adding ten, keeping the remainder after dividing by ten, and then rounding to the nearest deciday. matching a  tzo of -5 yields the same tod as  exactly one day behind Zone [5</span>
<span id="cb46-1372"><a href="#cb46-1372" aria-hidden="true" tabindex="-1"></a>Dec avoids incompatible with the ten Dec time zones. Dec expresses incompatibles <span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} as fractions. Officially, t</span>
<span id="cb46-1373"><a href="#cb46-1373" aria-hidden="true" tabindex="-1"></a>Dec refers to <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} with <span class="co">[</span><span class="ot">27</span><span class="co">]</span>{.color1by320} leap seconds as <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+</span><span class="co">]</span>{.mono}<span class="co">[</span><span class="ot">00:00:27</span><span class="co">]</span>{.color1by320} or <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+</span><span class="co">]</span>{.mono}<span class="co">[</span><span class="ot">1/320</span><span class="co">]</span>{.color1by320}.</span>
<span id="cb46-1374"><a href="#cb46-1374" aria-hidden="true" tabindex="-1"></a>Dec can relax its requirement that each <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} be a single-digit positive integer <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} to match any <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"}.</span>
<span id="cb46-1375"><a href="#cb46-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1376"><a href="#cb46-1376" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">tzos</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offsets"} is</span>
<span id="cb46-1377"><a href="#cb46-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1378"><a href="#cb46-1378" aria-hidden="true" tabindex="-1"></a>Dec Positive and negative offsets that differ by exactly ten <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} yield identical times, but result in dates that are precisely one day apart.</span>
<span id="cb46-1379"><a href="#cb46-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1380"><a href="#cb46-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1381"><a href="#cb46-1381" aria-hidden="true" tabindex="-1"></a>https://stackoverflow.com/a/23575642</span>
<span id="cb46-1382"><a href="#cb46-1382" aria-hidden="true" tabindex="-1"></a>Use fractions.js to turn non standard offsets into fractions.</span>
<span id="cb46-1383"><a href="#cb46-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1384"><a href="#cb46-1384" aria-hidden="true" tabindex="-1"></a>To determine which Dec time zone you are in, Dec would need to know your longitude. In general, Dec allows for everyone to use whatever <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} they want, regardless of their geographic location. The UTC <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} provided by your web browser is -300 minutes ÷ 144 = -2.083333 dd. In the absence of any other information, Dec would round this <span class="co">[</span><span class="ot">tzo</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time zone offset"} to the nearest deciday (dd), , and infer that you are in Zone 8. which Dec time zone you are in unless  Rounding UTC tzos can result in a time difference of up to 0.5 dd. Adding 27 leap seconds increases the maximum time difference to 161/320 dd. With time zone rounding, the time difference between your Dec and UTC time zones is 11.52 ÷ 144 = 0.08 dd. With 27 leap seconds, this difference is /320.</span>
<span id="cb46-1385"><a href="#cb46-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1386"><a href="#cb46-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1387"><a href="#cb46-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1388"><a href="#cb46-1388" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offset provided by your web browser is \${utcOffHslM} <span class="dv">&amp;div;</span> 144 = \${utcOffHslD} <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}. The Dec time zone that corresponds to this <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offset is Zone \${decZonHslP}. The time in corresponding Dec and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones can differ by up to <span class="co">[</span><span class="ot">0.5</span><span class="co">]</span>{.color050} <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}. The difference between your Dec and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time is \${utcOffsetMdiffHsl} <span class="dv">&amp;div;</span> 144 = \${utcOffDiffHsl} <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}.</span>
<span id="cb46-1389"><a href="#cb46-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1390"><a href="#cb46-1390" aria-hidden="true" tabindex="-1"></a>To obtain the time in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, we can subtract the offset of any time zone from its time. Inversely, we can get the time in any time zone by adding its offset to the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} time. The dates and times in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} and [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00</span><span class="co">]</span>{.color0}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time) match exactly. Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} and [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+12:00</span><span class="co">]</span>{.color5}](https://en.wikipedia.org/wiki/UTC%2B12:00) also have matching dates and times, both are precisely one day ahead of [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">-12:00</span><span class="co">]</span>{.color5}](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00).</span>
<span id="cb46-1391"><a href="#cb46-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1392"><a href="#cb46-1392" aria-hidden="true" tabindex="-1"></a>This stance is at odds with the International Earth Rotation and Reference Systems Service, which has inserted <span class="co">[</span><span class="ot">27</span><span class="co">]</span>{.color1by320} leap seconds into <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}.</span>
<span id="cb46-1393"><a href="#cb46-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1394"><a href="#cb46-1394" aria-hidden="true" tabindex="-1"></a>since <span class="co">[</span><span class="ot">1972</span><span class="co">]</span>. Dec does not automatically shift time away necessary, Dec handles any shift away from leap seconds in time zone offsets.</span>
<span id="cb46-1395"><a href="#cb46-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1396"><a href="#cb46-1396" aria-hidden="true" tabindex="-1"></a>Leap seconds</span>
<span id="cb46-1397"><a href="#cb46-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1398"><a href="#cb46-1398" aria-hidden="true" tabindex="-1"></a>To indicate the</span>
<span id="cb46-1399"><a href="#cb46-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1400"><a href="#cb46-1400" aria-hidden="true" tabindex="-1"></a>In Dec, the components of an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet are called the "hour of day" (<span class="co">[</span><span class="ot">hod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour of day"}), "minute of hour" (<span class="co">[</span><span class="ot">moh</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="minute of hour"}), and "second of minute" (<span class="co">[</span><span class="ot">som</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="second of minute"}).</span>
<span id="cb46-1401"><a href="#cb46-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1402"><a href="#cb46-1402" aria-hidden="true" tabindex="-1"></a>Dec handles differences from Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} with time zone offsets. There is no time difference between Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} and UNIX time. Dec applies a time zone offset <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} to Julian dates because the Dec epoch occurred at midnight (<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}) and the <span class="co">[</span><span class="ot">Julian period</span><span class="co">](https://en.wikipedia.org/wiki/Julian_day#:~:text=a%20chronological%20interval%20of%207980%C2%A0years%2C%20derived%20from%20three%20multi%2Dyear%20cycles:%20the%20Indiction%2C%20Solar%2C%20and%20Lunar%20cycles)</span> started at noon (<span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}).</span>
<span id="cb46-1403"><a href="#cb46-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1404"><a href="#cb46-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1405"><a href="#cb46-1405" aria-hidden="true" tabindex="-1"></a>To convert days to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, we multiply the <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} by ten.</span>
<span id="cb46-1406"><a href="#cb46-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1407"><a href="#cb46-1407" aria-hidden="true" tabindex="-1"></a>In Dec, days start at midnight, instead of noon, but have the same duration as Julian days: 86400 <span class="co">[</span><span class="ot">International System of Units</span><span class="co">](https://en.wikipedia.org/wiki/International_System_of_Units#:~:text=the%20world%27s%20most%20widely%20used%20system%20of%20measurement)</span> (<span class="co">[</span><span class="ot">SI</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="International System of Units"}) seconds or 100000 Dec <span class="co">[</span><span class="ot">beats</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="centimillidays"}.</span>
<span id="cb46-1408"><a href="#cb46-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1409"><a href="#cb46-1409" aria-hidden="true" tabindex="-1"></a> The duration of days in Dec and Julian dates The difference between the Dec epoch and the beginning of the Julian period is the only thing that distinguishes Julian date and a <span class="co">[</span><span class="ot">doe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times-of-day"} is its epoch.</span>
<span id="cb46-1410"><a href="#cb46-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1411"><a href="#cb46-1411" aria-hidden="true" tabindex="-1"></a>In <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}), days start at midnight, but the length of a day can vary due to <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>. In Dec, a day always has the same duration as a</span>
<span id="cb46-1412"><a href="#cb46-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1413"><a href="#cb46-1413" aria-hidden="true" tabindex="-1"></a>When matching <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} is required, Dec avoids day length changes by adding leap seconds to a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place). According to Dec, the [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00</span><span class="co">]</span>{.color0}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time) time zone does not have any leap seconds because its offset is <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}. To indicate that a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone includes the <span class="co">[</span><span class="ot">27 leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#Procedure:~:text=16-,27,-Current%20TAI%20%E2%88%92%20UTC)</span> that have been inserted into <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} so far, Dec appends <span class="co">[</span><span class="ot">:27</span><span class="co">]</span>{.color1by320} to its offset.</span>
<span id="cb46-1414"><a href="#cb46-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1415"><a href="#cb46-1415" aria-hidden="true" tabindex="-1"></a>The Dec equivalent of the [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00:27</span><span class="co">]</span>{.color1by320}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time) time zone is Zone <span class="co">[</span><span class="ot">1/320</span><span class="co">]</span>{.color1by320}.</span>
<span id="cb46-1416"><a href="#cb46-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1417"><a href="#cb46-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1418"><a href="#cb46-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1419"><a href="#cb46-1419" aria-hidden="true" tabindex="-1"></a>In <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}, the length of Day <span class="co">[</span><span class="ot">121</span><span class="co">]</span>{.colorD121 data-bs-toggle="tooltip" data-bs-title="June 30"} or Day <span class="co">[</span><span class="ot">305</span><span class="co">]</span>{.colorD305 data-bs-toggle="tooltip" data-bs-title="December 31"} can vary due to <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>.</span>
<span id="cb46-1420"><a href="#cb46-1420" aria-hidden="true" tabindex="-1"></a>T</span>
<span id="cb46-1421"><a href="#cb46-1421" aria-hidden="true" tabindex="-1"></a>this offset as</span>
<span id="cb46-1422"><a href="#cb46-1422" aria-hidden="true" tabindex="-1"></a>T</span>
<span id="cb46-1423"><a href="#cb46-1423" aria-hidden="true" tabindex="-1"></a>To represent the 27 leap seconds that have been added to <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} so far, Dec uses an offset of <span class="co">[</span><span class="ot">1/320</span><span class="co">]</span>{.color1by320} <span class="co">[</span><span class="ot">dd</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="decidays"}. Dec refers to the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone that has this offset as [<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00:32</span><span class="co">]</span>{.color1by320}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time).</span>
<span id="cb46-1424"><a href="#cb46-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1425"><a href="#cb46-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1426"><a href="#cb46-1426" aria-hidden="true" tabindex="-1"></a>either or secon</span>
<span id="cb46-1427"><a href="#cb46-1427" aria-hidden="true" tabindex="-1"></a>Since 1972+121, 27 positive leap seconds have been added to UTC, and 0 negative leap seconds have been whave been</span>
<span id="cb46-1428"><a href="#cb46-1428" aria-hidden="true" tabindex="-1"></a>in a Julian date or a <span class="co">[</span><span class="ot">doe</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="times-of-day"} i</span>
<span id="cb46-1429"><a href="#cb46-1429" aria-hidden="true" tabindex="-1"></a>Dec does not allow The time in the ten Dec time zones never include</span>
<span id="cb46-1430"><a href="#cb46-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1431"><a href="#cb46-1431" aria-hidden="true" tabindex="-1"></a>o depending on whether the leap second is p.  Dec uses to represent <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> without changing the length of a day in the same way as leap days changes the length of a year. Instead of allowing the length of a day included, some <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} days will be 86401 or 86399 seconds long. So far, 27 positive leap seconds have been added, some <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} days will differ in length.  includes  of seconds, Dec uses beats. 100000 The programming languages that the <span class="co">[</span><span class="ot">Quarto FAQ</span><span class="co">](https://quarto.org/docs/faq)</span> refers to as <span class="co">[</span><span class="ot">principal languages supported by Quarto</span><span class="co">](https://quarto.org/docs/faq/#:~:text=The%20principal%20languages%20supported%20by%20Quarto%20are%20Python%2C%20R%2C%20Julia%2C%20and%20Observable%20JavaScript)</span>, <span class="co">[</span><span class="ot">Python</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Python_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%20programming%20language) (Quarto principal languages), <span class="co">[</span><span class="ot">R</span><span class="co">]</span>(https://en.wikipedia.org/wiki/R_(programming_language)#:~:text=a%20programming%20language%20for%20statistical%20computing%20and%20data%20visualization), <span class="co">[</span><span class="ot">Julia</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Julia_(programming_language)#:~:text=a%20high%2Dlevel%2C%20general%2Dpurpose%5B17%5D%20dynamic%20programming%20language), and <span class="co">[</span><span class="ot">Observable</span><span class="co">](http://observablehq.com)</span> <span class="co">[</span><span class="ot">JavaScript</span><span class="co">](https://en.wikipedia.org/wiki/JavaScript#:~:text=a%20programming%20language%20and%20core%20technology%20of%20the%20World%20Wide%20Web)</span>, do not include <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> in <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time. Therefore, a day in</span>
<span id="cb46-1432"><a href="#cb46-1432" aria-hidden="true" tabindex="-1"></a>Even though the Dec, UNIX, and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} epochs all occurred at midnight, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time may be shifted in relation to Dec or UNIX time because of <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>.</span>
<span id="cb46-1433"><a href="#cb46-1433" aria-hidden="true" tabindex="-1"></a>Since 1972+121, 27</span>
<span id="cb46-1434"><a href="#cb46-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1435"><a href="#cb46-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1436"><a href="#cb46-1436" aria-hidden="true" tabindex="-1"></a>We can make the time in any Dec time zone match UNIX by subtracting its time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place). The time in the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} Dec time zone always matches UNIX time. because neither includes <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span>. Dec considers <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">time zone</span><span class="co">](https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time)</span> to also match UNIX time. If there is a <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> are not included. Dec handles leap seconds like an additional time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place). <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+00:00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} with 27 leap seconds is referred to as Zone 1/320 in Dec and . which</span>
<span id="cb46-1437"><a href="#cb46-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1438"><a href="#cb46-1438" aria-hidden="true" tabindex="-1"></a>[<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}<span class="co">[</span><span class="ot">+00:00</span><span class="co">]</span>{.color0}](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>
<span id="cb46-1439"><a href="#cb46-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1440"><a href="#cb46-1440" aria-hidden="true" tabindex="-1"></a>To produce a Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} from an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet, we get the difference between the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place), convert its components to either days or <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}, and sum the converted components.</span>
<span id="cb46-1441"><a href="#cb46-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1442"><a href="#cb46-1442" aria-hidden="true" tabindex="-1"></a>and</span>
<span id="cb46-1443"><a href="#cb46-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1444"><a href="#cb46-1444" aria-hidden="true" tabindex="-1"></a>$$\text{deciday} = \frac{\text{hour}}{2.4} + \frac{\text{minute}}{144} + \frac{\text{second}}{8640}$$</span>
<span id="cb46-1445"><a href="#cb46-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1446"><a href="#cb46-1446" aria-hidden="true" tabindex="-1"></a>$$\text{day} = \frac{\text{hour}}{24} + \frac{\text{minute}}{1440} + \frac{\text{second}}{86400}$$</span>
<span id="cb46-1447"><a href="#cb46-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1448"><a href="#cb46-1448" aria-hidden="true" tabindex="-1"></a>does not include <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> or a <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) <span class="co">[</span><span class="ot">time zone</span><span class="co">](https://en.wikipedia.org/wiki/Time_zone#:~:text=an%20area%20which%20observes%20a%20uniform%20standard%20time)</span> <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) and</span>
<span id="cb46-1449"><a href="#cb46-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1450"><a href="#cb46-1450" aria-hidden="true" tabindex="-1"></a>than [<span class="co">[</span><span class="ot">+00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} and [<span class="co">[</span><span class="ot">+12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} will not match the time in any of the ten Dec time zones. We can create a <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} by summing the components of an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet after</span>
<span id="cb46-1451"><a href="#cb46-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1452"><a href="#cb46-1452" aria-hidden="true" tabindex="-1"></a>that were added a <span class="co">[</span><span class="ot">Coordinated Universal Time</span><span class="co">](https://en.wikipedia.org/wiki/Coordinated_Universal_Time#:~:text=the%20primary%20time%20standard%20globally%20used%20to%20regulate%20clocks%20and%20time)</span> (<span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}) [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} time zone. An <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet that includes <span class="co">[</span><span class="ot">leap seconds</span><span class="co">](https://en.wikipedia.org/wiki/Leap_second#:~:text=one%2Dsecond%20adjustment)</span> or a</span>
<span id="cb46-1453"><a href="#cb46-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1454"><a href="#cb46-1454" aria-hidden="true" tabindex="-1"></a>To be compatible with Dec, a time zone offset must be equivalent to one of the ten positive single-digit integer <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} Dec offsets. The Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} Dec time zone and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} time zone have equivalent offsets: <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} = <span class="co">[</span><span class="ot">12</span><span class="co">]</span>{.color5} hours. Likewise, the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} Dec time zone, UNIX time, and the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} time zone all have an offset of <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}.</span>
<span id="cb46-1455"><a href="#cb46-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1456"><a href="#cb46-1456" aria-hidden="true" tabindex="-1"></a>Apart from <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} and [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5}, all of the other <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones are incompatible with Dec. To find the <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} time difference $\Delta$ between a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone and its closest Dec time zone, convert the offset of the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone to <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} and then calculate how much the converted offset changes after rounding it to the nearest <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"}.</span>
<span id="cb46-1457"><a href="#cb46-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1458"><a href="#cb46-1458" aria-hidden="true" tabindex="-1"></a>$$\Delta = \text{offset} - \lfloor\text{offset} + 0.5\rfloor$$</span>
<span id="cb46-1459"><a href="#cb46-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1460"><a href="#cb46-1460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Repeating decimal numbers {#rdn .hiddenheading}</span></span>
<span id="cb46-1461"><a href="#cb46-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1462"><a href="#cb46-1462" aria-hidden="true" tabindex="-1"></a>Dec expresses incompatible offsets as positive or negative fractions or multi-digit integers. <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets are either <span class="co">[</span><span class="ot">repeating</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal)</span> or terminating decimal numbers. Dec displays repeating decimal offsets as fractions and terminating decimal offsets as integers. <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+08:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B08:00)</span>]{.color333}, the most populous <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone, has an offset of <span class="co">[</span><span class="ot">.</span><span class="co">]</span>{.color333}<span class="co">[</span><span class="ot">3</span><span class="co">]</span>{.vinculum} days and is called Zone <span class="co">[</span><span class="ot">1/3</span><span class="co">]</span>{.color333} in Dec. In contrast, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+03:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B03:00)</span>]{.color125} has an offset of <span class="co">[</span><span class="ot">.125</span><span class="co">]</span>{.color125} days and is called Zone <span class="co">[</span><span class="ot">125</span><span class="co">]</span>{.color125} in Dec.</span>
<span id="cb46-1463"><a href="#cb46-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1464"><a href="#cb46-1464" aria-hidden="true" tabindex="-1"></a>Terminating decimal number offsets can be displayed by Dec provided there is enough space for the additional digits. Dec displays repeating decimal number offsets as fractions. The second most populous <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone, <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+05:30</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B05:30)</span>]{.color333}, translates to Zone <span class="co">[</span><span class="ot">55/24</span><span class="co">]</span>{.color55by24} or Zone <span class="co">[</span><span class="ot">2.291</span><span class="co">]</span>{.color55by24}<span class="co">[</span><span class="ot">6</span><span class="co">]</span>{.vinculum} in Dec. The top six most populous <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones all have positive offsets.</span>
<span id="cb46-1465"><a href="#cb46-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1466"><a href="#cb46-1466" aria-hidden="true" tabindex="-1"></a>When it is midnight (tod=<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}) in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0}, it is noon (tod=<span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5}) in Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} and the time in every other time zone is equal to it it is \~<span class="co">[</span><span class="ot">5.33</span><span class="co">]</span>{.color533} in Zone <span class="co">[</span><span class="ot">10/3</span><span class="co">]</span>{.color333}, \~<span class="co">[</span><span class="ot">4.29</span><span class="co">]</span>{.color429} in Zone <span class="co">[</span><span class="ot">55/24</span><span class="co">]</span>{.color55by24}, and</span>
<span id="cb46-1467"><a href="#cb46-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1468"><a href="#cb46-1468" aria-hidden="true" tabindex="-1"></a>To obtain the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} time, we evaluate any Dec time as a math expression, add 10, and then get the remainder after dividing by 10 to make sure the result is less than 10 <span class="co">[</span><span class="ot">decidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}.</span>
<span id="cb46-1469"><a href="#cb46-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1470"><a href="#cb46-1470" aria-hidden="true" tabindex="-1"></a>The use of incompatible offsets makes mental calculations involving time zones much harder. Also, incompatible offsets are more difficult to display and read in the format of Dec times. Despite these clear disadvantages, Dec will attempt to parse, process, and display any time zone offset that is provided. Incompatible offset that are repeating decimal numbers can be displayed as fractions, truncated numbers</span>
<span id="cb46-1471"><a href="#cb46-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1472"><a href="#cb46-1472" aria-hidden="true" tabindex="-1"></a>noon in <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+08:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B08:00)</span>]{.color333} could be written as <span class="co">[</span><span class="ot">5.00</span><span class="co">]</span>{.color5}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{.mono}<span class="co">[</span><span class="ot">10/3</span><span class="co">]</span>{.color333} or <span class="co">[</span><span class="ot">5.00</span><span class="co">]</span>{.color5}<span class="co">[</span><span class="ot">-</span><span class="co">]</span>{.mono}<span class="co">[</span><span class="ot">3.</span><span class="co">]</span>{.color333}<span class="co">[</span><span class="ot">3</span><span class="co">]</span>{.vinculum}.</span>
<span id="cb46-1473"><a href="#cb46-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1474"><a href="#cb46-1474" aria-hidden="true" tabindex="-1"></a>Dec does not set a hard limit on the number of time zones, but negative time zones offsets to improve its compability with <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}.</span>
<span id="cb46-1475"><a href="#cb46-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1476"><a href="#cb46-1476" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb46-1477"><a href="#cb46-1477" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bad Pun Alert</span></span>
<span id="cb46-1478"><a href="#cb46-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1479"><a href="#cb46-1479" aria-hidden="true" tabindex="-1"></a>Sorry if reading this takes a long ***time***; I hope you don’t ***zone*** out!</span>
<span id="cb46-1480"><a href="#cb46-1480" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-1481"><a href="#cb46-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1482"><a href="#cb46-1482" aria-hidden="true" tabindex="-1"></a>If a Dec time zone offset is not specified, we can detected a time zone using Whether or not negative time zones offsets are worth the trouble is a matter of that the offer little to no benefit. The <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">-12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude)</span>]{.color5} and [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} time zones and the Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} and <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5} Dec time zones all have the same time, but their dates do not match, because <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">-12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00#:~:text=a%20nautical%20time%20zone%20comprising%20the%20high%20seas%20between%20180%C2%B0%20and%20172%C2%B030%E2%80%B2W%20longitude)</span>]{.color5} and Zone <span class="co">[</span><span class="ot">-5</span><span class="co">]</span>{.color5} are one day behind <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} [<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} and Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5}. Dec discourages the use of time zones with negative offsets.</span>
<span id="cb46-1483"><a href="#cb46-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1484"><a href="#cb46-1484" aria-hidden="true" tabindex="-1"></a>The remaining UTC time zones with negative offsets</span>
<span id="cb46-1485"><a href="#cb46-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1486"><a href="#cb46-1486" aria-hidden="true" tabindex="-1"></a>If we disregard leap seconds, the [<span class="co">[</span><span class="ot">+00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone is synchronized with UNIX time and the Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} Dec time zone. The [<span class="co">[</span><span class="ot">+12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} and [<span class="co">[</span><span class="ot">-12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00)</span>]{.color5} <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets have the same time but their dates are one day apart.</span>
<span id="cb46-1487"><a href="#cb46-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1488"><a href="#cb46-1488" aria-hidden="true" tabindex="-1"></a>We can honor this difference by translating [<span class="co">[</span><span class="ot">+12</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5} compatible <span class="co">[</span><span class="ot">37 [UTC]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets)</span>, only 3 are integers after they are converted to time zones. Conversion between Dec time zones and UTC offsets is inexact, because UTC offsets depend on geographic and political boundaries, whereas Dec time zones are determined solely by longitude.</span>
<span id="cb46-1489"><a href="#cb46-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1490"><a href="#cb46-1490" aria-hidden="true" tabindex="-1"></a>because UNIX time, [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0}, and Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} are all synchronized.</span>
<span id="cb46-1491"><a href="#cb46-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1492"><a href="#cb46-1492" aria-hidden="true" tabindex="-1"></a>Similarly, a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet yields a Zone <span class="co">[</span><span class="ot">5</span><span class="co">]</span>{.color5} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}.</span>
<span id="cb46-1493"><a href="#cb46-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1494"><a href="#cb46-1494" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}</span>
<span id="cb46-1495"><a href="#cb46-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1496"><a href="#cb46-1496" aria-hidden="true" tabindex="-1"></a>Instead of passing an <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) to the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} equation separately, we can subtract the offset from the triplet to produce a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet. In other words, we can avoid converting time zone offsets if we always first shift the input <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet to [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/List_of_UTC_offsets#UTC+00:00,_Z)</span>]{.color0}.</span>
<span id="cb46-1497"><a href="#cb46-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1498"><a href="#cb46-1498" aria-hidden="true" tabindex="-1"></a>To obtain the Zone 0 time, we evaluate a Dec time as a math expression, add 10, and get the remainder after dividing by 10 to make sure the result is less than 10 <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}: (<span class="co">[</span><span class="ot">\${browserTime.toFixed(4)}</span><span class="co">]</span>{.cyan} \${browserSign} <span class="co">[</span><span class="ot">\${Math.abs(browserZone)}</span><span class="co">]</span>{.lime} + 10) <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 10 = <span class="co">[</span><span class="ot">\${zone0time.toFixed(4)}</span><span class="co">]</span>{.cyan}.</span>
<span id="cb46-1499"><a href="#cb46-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1500"><a href="#cb46-1500" aria-hidden="true" tabindex="-1"></a>Instead of passing both a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplets and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) to the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"} equation.</span>
<span id="cb46-1501"><a href="#cb46-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1502"><a href="#cb46-1502" aria-hidden="true" tabindex="-1"></a>Instead of performing this calculation on both a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet and its <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place), we should subtract the offset from the triplet.</span>
<span id="cb46-1503"><a href="#cb46-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1504"><a href="#cb46-1504" aria-hidden="true" tabindex="-1"></a>equation should be a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet so that we do not have to convert a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zone <span class="co">[</span><span class="ot">offset</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place) to <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"}.</span>
<span id="cb46-1505"><a href="#cb46-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1506"><a href="#cb46-1506" aria-hidden="true" tabindex="-1"></a>When we add a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offset to a <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet, with the resulting [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} time.</span>
<span id="cb46-1507"><a href="#cb46-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1508"><a href="#cb46-1508" aria-hidden="true" tabindex="-1"></a>The time in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} matches UTC time with the [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} offset. UNIX time and three <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} offsets are called [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0}, [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B12:00)</span>]{.color5}, and [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">-12:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%E2%88%9212:00)</span>]{.color5}. Starting with a [<span class="co">[</span><span class="ot">UTC</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"}[<span class="co">[</span><span class="ot">+00:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>]{.color0} <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet results in Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} <span class="co">[</span><span class="ot">tod</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="time of day"}.</span>
<span id="cb46-1509"><a href="#cb46-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1510"><a href="#cb46-1510" aria-hidden="true" tabindex="-1"></a>only three out of the <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones are synchronized with a Dec time zone it will most likely be easier to shift the <span class="co">[</span><span class="ot">hms</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hour minute second"} triplet to will result in days instead of decidays if we divide by the most Dec and <span class="co">[</span><span class="ot">UTC</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="Coordinated Universal Time"} time zones are not aligned. Whereas UNIX time is always synchronized with Zone <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.color0} and <span class="co">[</span><span class="ot">UTC[+00:00]{.color0}</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B00:00#:~:text=the%20basis%20of%20Coordinated%20Universal%20Time)</span>, This method ensure that the result matches</span>
<span id="cb46-1511"><a href="#cb46-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1512"><a href="#cb46-1512" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">UTC time zone offsets</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place)</span>
<span id="cb46-1513"><a href="#cb46-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1514"><a href="#cb46-1514" aria-hidden="true" tabindex="-1"></a>Drag the red⭕️circle across the <span class="co">[</span><span class="ot">meridians</span><span class="co">](https://en.wikipedia.org/wiki/Meridian_%28geography%29#:~:text=words%2C%20it%20is-,a%20line%20of%20longitude,-.%20The%20position%20of)</span> (vertical↕gray lines) on the map🗺️to see how changing time zones affects the time. Only the first digit of the Dec times shown above, the <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"}, varies across time zones, because the 10 Dec time zones, numbered 0 through 9 on the map🗺️, are each 1 <span class="co">[</span><span class="ot">deci[turn](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a turn"} (<span class="co">[</span><span class="ot">dt</span><span class="co">](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn)</span>) wide. Simply put, a <span class="co">[</span><span class="ot">deciturn</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a turn"} of longitude translates into a <span class="co">[</span><span class="ot">deciday</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} of time.</span>
<span id="cb46-1515"><a href="#cb46-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1516"><a href="#cb46-1516" aria-hidden="true" tabindex="-1"></a>The leftmost vertical↕line on the map🗺️is <span class="co">[</span><span class="ot">Meridian 0</span><span class="co">](https://en.wikipedia.org/wiki/18th_meridian_west#:~:text=a%20line%20of%20longitude%20that%20extends%20from%20the%20North%20Pole%20across%20the%20Arctic%20Ocean%2C%20Greenland%2C%20Iceland%2C%20the%20Atlantic%20Ocean%2C%20the%20Canary%20Islands%2C%20the%20Southern%20Ocean%2C%20and%20Antarctica%20to%20the%20South%20Pole)</span>, the Dec <span class="co">[</span><span class="ot">International Date Line</span><span class="co">](https://en.wikipedia.org/wiki/International_Date_Line#:~:text=the%20line%20between%20the%20South%20and%20North%20Poles%20that%20is%20the%20boundary%20between%20one%20calendar%20day%20and%20the%20next)</span> and <span class="co">[</span><span class="ot">prime meridian</span><span class="co">](https://en.wikipedia.org/wiki/Prime_meridian#:~:text=an%20arbitrarily%2Dchosen%20meridian%20%28a%20line%20of%20longitude%29%20in%20a%20geographic%20coordinate%20system%20at%20which%20longitude%20is%20defined%20to%20be%200%C2%B0)</span>, which cuts across the Atlantic Ocean through Iceland🇮🇸just West of Africa🌍and is the boundary between Zone 9 and Zone 0, the rightmost and leftmost Dec time zones on the map🗺️, respectively. Arranging Dec time zones from 0 to 9 yields a <span class="co">[</span><span class="ot">Pacific-centric</span><span class="co">]</span>(https://en.wikipedia.org/wiki/World_map#:~:text=south%2Dup%20map-,Pacific%2Dcentric%20map,-(more%20commonly%20used)) map🗺️.</span>
<span id="cb46-1517"><a href="#cb46-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1518"><a href="#cb46-1518" aria-hidden="true" tabindex="-1"></a>While only positive Dec time zones are shown on the map🗺️, every Dec time zone can also be expressed as a negative number. Each pair of time zone numbers produces the same Dec time, but result in <span class="co">[</span><span class="ot">Dec dates</span><span class="co">](/dec/date)</span>🗓️that are 1 day apart. Negative time zone numbers can be useful for getting <span class="co">[</span><span class="ot">Dec dates</span><span class="co">](/dec/date)</span>🗓️to match <span class="co">[</span><span class="ot">Gregorian calendar</span><span class="co">](https://en.wikipedia.org/wiki/Gregorian_calendar#:~:text=the%20calendar%20used%20in%20most%20parts%20of%20the%20world)</span> dates🗓️with negative <span class="co">[</span><span class="ot">UTC offsets</span><span class="co">]</span>(https://en.wikipedia.org/wiki/UTC_offset#:~:text=the%20difference%20in%20hours%20and%20minutes%20between%20Coordinated%20Universal%20Time%20(UTC)%20and%20the%20standard%20time%20at%20a%20particular%20place).</span>
<span id="cb46-1519"><a href="#cb46-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1520"><a href="#cb46-1520" aria-hidden="true" tabindex="-1"></a>If you know your longitude in degrees (°) or <span class="co">[</span><span class="ot">centi[turns](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=a%20unit%20of%20plane%20angle%20measurement%20equal%20to%202%CF%80%C2%A0radians%2C%20360%C2%A0degrees)</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundredths of a turn"} (<span class="co">[</span><span class="ot">ct</span><span class="co">](https://en.wikipedia.org/wiki/Turn_%28angle%29#:~:text=the%20Greek%20letter,to%20one%20turn)</span>), you can look up your Dec time zone (TZ) in the table below.</span>
<span id="cb46-1521"><a href="#cb46-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1522"><a href="#cb46-1522" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> TZ<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>+ <span class="pp">|</span> TZ<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>- <span class="pp">|</span> Start<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>° <span class="pp">|</span> Mid<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>° <span class="pp">|</span> End<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>° <span class="pp">|</span> Start<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>$ct$ <span class="pp">|</span> Mid<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>$ct$ <span class="pp">|</span> End<span class="dt">&lt;</span><span class="kw">br</span><span class="dt">&gt;</span>$ct$ <span class="pp">|</span></span>
<span id="cb46-1523"><a href="#cb46-1523" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|</span></span>
<span id="cb46-1524"><a href="#cb46-1524" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 9 <span class="pp">|</span> -1 <span class="pp">|</span> -54 <span class="pp">|</span> -36 <span class="pp">|</span> -18 <span class="pp">|</span> 90 <span class="pp">|</span> 95 <span class="pp">|</span> 100 <span class="pp">|</span></span>
<span id="cb46-1525"><a href="#cb46-1525" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 8 <span class="pp">|</span> -2 <span class="pp">|</span> -90 <span class="pp">|</span> -72 <span class="pp">|</span> -54 <span class="pp">|</span> 80 <span class="pp">|</span> 85 <span class="pp">|</span> 90 <span class="pp">|</span></span>
<span id="cb46-1526"><a href="#cb46-1526" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 7 <span class="pp">|</span> -3 <span class="pp">|</span> -126 <span class="pp">|</span> -108 <span class="pp">|</span> -90 <span class="pp">|</span> 70 <span class="pp">|</span> 75 <span class="pp">|</span> 80 <span class="pp">|</span></span>
<span id="cb46-1527"><a href="#cb46-1527" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 6 <span class="pp">|</span> -4 <span class="pp">|</span> -162 <span class="pp">|</span> -144 <span class="pp">|</span> -126 <span class="pp">|</span> 60 <span class="pp">|</span> 65 <span class="pp">|</span> 70 <span class="pp">|</span></span>
<span id="cb46-1528"><a href="#cb46-1528" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5 <span class="pp">|</span> -5 <span class="pp">|</span> 162 <span class="pp">|</span> 180 <span class="pp">|</span> -162 <span class="pp">|</span> 50 <span class="pp">|</span> 55 <span class="pp">|</span> 60 <span class="pp">|</span></span>
<span id="cb46-1529"><a href="#cb46-1529" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4 <span class="pp">|</span> -6 <span class="pp">|</span> 126 <span class="pp">|</span> 144 <span class="pp">|</span> 162 <span class="pp">|</span> 40 <span class="pp">|</span> 45 <span class="pp">|</span> 50 <span class="pp">|</span></span>
<span id="cb46-1530"><a href="#cb46-1530" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3 <span class="pp">|</span> -7 <span class="pp">|</span> 90 <span class="pp">|</span> 108 <span class="pp">|</span> 126 <span class="pp">|</span> 30 <span class="pp">|</span> 35 <span class="pp">|</span> 40 <span class="pp">|</span></span>
<span id="cb46-1531"><a href="#cb46-1531" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2 <span class="pp">|</span> -8 <span class="pp">|</span> 54 <span class="pp">|</span> 72 <span class="pp">|</span> 90 <span class="pp">|</span> 20 <span class="pp">|</span> 25 <span class="pp">|</span> 30 <span class="pp">|</span></span>
<span id="cb46-1532"><a href="#cb46-1532" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1 <span class="pp">|</span> -9 <span class="pp">|</span> 18 <span class="pp">|</span> 36 <span class="pp">|</span> 54 <span class="pp">|</span> 10 <span class="pp">|</span> 15 <span class="pp">|</span> 20 <span class="pp">|</span></span>
<span id="cb46-1533"><a href="#cb46-1533" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 0 <span class="pp">|</span> -10 <span class="pp">|</span> -18 <span class="pp">|</span> 0 <span class="pp">|</span> 18 <span class="pp">|</span> 0 <span class="pp">|</span> 5 <span class="pp">|</span> 10 <span class="pp">|</span></span>
<span id="cb46-1534"><a href="#cb46-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1535"><a href="#cb46-1535" aria-hidden="true" tabindex="-1"></a>Dec times in Zone 0 and 5 can be directly converted to and from UTC times with an offset of 0 and 12 <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}, respectively. The other Dec time zones</span>
<span id="cb46-1536"><a href="#cb46-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1537"><a href="#cb46-1537" aria-hidden="true" tabindex="-1"></a><span class="fu"># Unit</span></span>
<span id="cb46-1538"><a href="#cb46-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1539"><a href="#cb46-1539" aria-hidden="true" tabindex="-1"></a>Dec uses <span class="co">[</span><span class="ot">metric prefixes</span><span class="co">](https://en.wikipedia.org/wiki/Metric_prefix#:~:text=a%20unit%20prefix%20that%20precedes%20a%20basic%20unit%20of%20measure%20to%20indicate%20a%20multiple%20or%20submultiple%20of%20the%20unit)</span> to create <span class="co">[</span><span class="ot">submultiples</span><span class="co">](https://en.wikipedia.org/wiki/Multiple_%28mathematics%29#Submultiple:~:text=of%20%22a%20being-,a%20unit%20fraction,-of%20b%22%20)</span> of a day that can naturally be combined together into a single <span class="co">[</span><span class="ot">decimal</span><span class="co">](https://en.wikipedia.org/wiki/Decimal#:~:text=system%20for%20denoting%20integer%20and%20non%2Dinteger%20numbers)</span> number. Conversion between decimal units is as simple as moving↔︎️or removing❌the <span class="co">[</span><span class="ot">decimal separator</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_separator#:~:text=a%20symbol%20that%20separates%20the%20integer%20part%20from%20the%20fractional%20part%20of%20a%20number)</span>. In contrast, an <span class="co">[</span><span class="ot">hh</span><span class="co">]</span>{.teal}:<span class="co">[</span><span class="ot">mm</span><span class="co">]</span>{.olive}:<span class="co">[</span><span class="ot">ss</span><span class="co">]</span>{.purple} time is a <span class="co">[</span><span class="ot">mixed-radix</span><span class="co">](https://en.wikipedia.org/wiki/Mixed_radix#:~:text=non%2Dstandard%20positional%20numeral%20systems%20in%20which%20the%20numerical%20base%20varies%20from%20position%20to%20position)</span> number, where <span class="co">[</span><span class="ot">hh</span><span class="co">]</span>{.teal} is the <span class="co">[</span><span class="ot">base-12</span><span class="co">](https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=12-,Duodecimal,-%2C%20dozenal)</span> or <span class="co">[</span><span class="ot">base-24</span><span class="co">](https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=24-,Quadravigesimal,-%5B48%5D)</span> <span class="co">[</span><span class="ot">hour</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">mm</span><span class="co">]</span>{.olive} is the <span class="co">[</span><span class="ot">base-60</span><span class="co">](https://en.wikipedia.org/wiki/List_of_numeral_systems#:~:text=60-,Sexagesimal,-Babylonian%20numerals%20and)</span> <span class="co">[</span><span class="ot">minute</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">ss</span><span class="co">]</span>{.purple} is the base-60 <span class="co">[</span><span class="ot">second</span><span class="co">]</span>{.purple}.</span>
<span id="cb46-1540"><a href="#cb46-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1541"><a href="#cb46-1541" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Prefix <span class="pp">|</span> Power <span class="pp">|</span> Day <span class="pp">|</span> <span class="co">[</span><span class="ot">hh</span><span class="co">]</span>{.teal}:<span class="co">[</span><span class="ot">mm</span><span class="co">]</span>{.olive}:<span class="co">[</span><span class="ot">ss</span><span class="co">]</span>{.purple}.<span class="co">[</span><span class="ot">sss</span><span class="co">]</span>{.purple} <span class="pp">|</span></span>
<span id="cb46-1542"><a href="#cb46-1542" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------------------|---------------|---------------|-----------------------|</span></span>
<span id="cb46-1543"><a href="#cb46-1543" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>  <span class="pp">|</span> 0 <span class="pp">|</span> 1 <span class="pp">|</span> 24<span class="sc">:00:</span>00.000 <span class="pp">|</span></span>
<span id="cb46-1544"><a href="#cb46-1544" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> deci <span class="pp">|</span> -1 <span class="pp">|</span> .1 <span class="pp">|</span> 02<span class="sc">:24:</span>00.000 <span class="pp">|</span></span>
<span id="cb46-1545"><a href="#cb46-1545" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> centi <span class="pp">|</span> -2 <span class="pp">|</span> .01 <span class="pp">|</span> 00<span class="sc">:14:</span>24.000 <span class="pp">|</span></span>
<span id="cb46-1546"><a href="#cb46-1546" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> milli <span class="pp">|</span> -3 <span class="pp">|</span> .001 <span class="pp">|</span> 00<span class="sc">:01:</span>26.400 <span class="pp">|</span></span>
<span id="cb46-1547"><a href="#cb46-1547" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> decimilli <span class="pp">|</span> -4 <span class="pp">|</span> .0001 <span class="pp">|</span> 00<span class="sc">:00:</span>08.640 <span class="pp">|</span></span>
<span id="cb46-1548"><a href="#cb46-1548" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> centimilli <span class="pp">|</span> -5 <span class="pp">|</span> .00001 <span class="pp">|</span> 00<span class="sc">:00:</span>00.864 <span class="pp">|</span></span>
<span id="cb46-1549"><a href="#cb46-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1550"><a href="#cb46-1550" aria-hidden="true" tabindex="-1"></a>To convert the <span class="co">[</span><span class="ot">hour</span><span class="co">]</span>{.teal} <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">minute</span><span class="co">]</span>{.olive} <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">second</span><span class="co">]</span>{.purple} <span class="co">[</span><span class="ot">s</span><span class="co">]</span>{.purple} into the <span class="co">[</span><span class="ot">deciday</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan}, Dec uses the following equation: <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan} = <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal} ÷ 2.4 + <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive} ÷ 144 + <span class="co">[</span><span class="ot">s</span><span class="co">]</span>{.purple} ÷ 8640. The current equation values in Zone <span class="co">[</span><span class="ot">\${browserZone}</span><span class="co">]</span>{.lime} are: <span class="co">[</span><span class="ot">\${browserTime.toFixed(4)}</span><span class="co">]</span>{.cyan} = <span class="co">[</span><span class="ot">\${Math.floor(hours).toString().padStart(2, "0")}</span><span class="co">]</span>{.teal} ÷ 2.4 + <span class="co">[</span><span class="ot">\${Math.floor(minutes).toString().padStart(2, "0")}</span><span class="co">]</span>{.olive} ÷ 144 + <span class="co">[</span><span class="ot">\${Math.floor(seconds).toString().padStart(2, "0")}</span><span class="co">]</span>{.purple} ÷ 8640. Inversely, we can convert <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} into <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}: <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal} = <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan} × 2.4, <span class="co">[</span><span class="ot">minutes</span><span class="co">]</span>{.olive}: <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive} = <span class="co">[</span><span class="ot">h</span><span class="co">]</span>{.teal} <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 × 60, and <span class="co">[</span><span class="ot">seconds</span><span class="co">]</span>{.purple}: <span class="co">[</span><span class="ot">s</span><span class="co">]</span>{.purple} = <span class="co">[</span><span class="ot">m</span><span class="co">]</span>{.olive} <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 × 60.</span>
<span id="cb46-1551"><a href="#cb46-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1552"><a href="#cb46-1552" aria-hidden="true" tabindex="-1"></a>Instead of dealing with <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">minutes</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">seconds</span><span class="co">]</span>{.purple}, we can convert the <span class="co">[</span><span class="ot">UNIX timestamp</span><span class="co">](https://en.wikipedia.org/wiki/Unix_time#:~:text=the%20number%20of%20non%2Dleap%20seconds%20that%20have%20elapsed%20since%2000%3A00%3A00%20UTC%20on%201%C2%A0January%201970)</span> <span class="co">[</span><span class="ot">u</span><span class="co">]</span>{.purple} into the Dec time <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan}+<span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.lime}. First, we divide <span class="co">[</span><span class="ot">u</span><span class="co">]</span>{.purple} by 86400 to convert seconds to days, then isolate the <span class="co">[</span><span class="ot">decimal part</span><span class="co">](https://en.wikipedia.org/wiki/Fractional_part#:~:text=the%20excess%20beyond%20that%20number%27s%20integer%20part)</span> of the <span class="co">[</span><span class="ot">quotient</span><span class="co">](https://en.wikipedia.org/wiki/Quotient#:~:text=a%20quantity%20produced%20by%20the%20division%20of%20two%20numbers)</span>, and finally multiply by 10: <span class="co">[</span><span class="ot">d</span><span class="co">]</span>{.cyan} + <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.lime} = <span class="co">[</span><span class="ot">u</span><span class="co">]</span>{.purple} ÷ 86400 <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 × 10. The current values in this equation are <span class="co">[</span><span class="ot">\${browserTime.toFixed(4)}</span><span class="co">]</span>{.cyan} + <span class="co">[</span><span class="ot">0</span><span class="co">]</span>{.lime} = <span class="co">[</span><span class="ot">\${Math.floor(now / 1000)}</span><span class="co">]</span>{.purple} ÷ 86400 <span class="co">[</span><span class="ot">mod</span><span class="co">](https://en.wikipedia.org/wiki/Modulo#:~:text=returns%20the%20remainder)</span> 1 × 10.</span>
<span id="cb46-1553"><a href="#cb46-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1554"><a href="#cb46-1554" aria-hidden="true" tabindex="-1"></a>The concept of measuring time in decimal days is not novel. In the late 1700s, the <span class="co">[</span><span class="ot">French Republican calendar</span><span class="co">](https://en.wikipedia.org/wiki/French_Republican_calendar#:~:text=a%20calendar%20created%20and%20implemented%20during%20the%20French%20Revolution)</span> time system referred to <span class="co">[</span><span class="ot">decidays</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="tenths of a day"} as decimal <span class="co">[</span><span class="ot">hours</span><span class="co">]</span>{.teal}, <span class="co">[</span><span class="ot">centidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundredths of a day"} as <span class="co">[</span><span class="ot">décimes</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=into%20tenths%2C%20or-,d%C3%A9cimes,-%2C%20instead%20of%20minutes)</span>, <span class="co">[</span><span class="ot">millidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="thousandths of a day"} as decimal <span class="co">[</span><span class="ot">minutes</span><span class="co">]</span>{.olive}, and <span class="co">[</span><span class="ot">centimillidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundred thousandths of a day"} as decimal <span class="co">[</span><span class="ot">seconds</span><span class="co">]</span>{.purple}. Similarly, <span class="co">[</span><span class="ot">Swatch Internet Time</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#:~:text=a%20decimal%20time%20system%20introduced%20in%201998%20by%20the%20Swatch%20corporation)</span>, a <span class="co">[</span><span class="ot">decimal time</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=the%20representation%20of%20the%20time%20of%20day%20using%20units%20which%20are%20decimally%20related)</span> system introduced in 1998, uses the term ".beats" for <span class="co">[</span><span class="ot">millidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="thousandths of a day"}.</span>
<span id="cb46-1555"><a href="#cb46-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1556"><a href="#cb46-1556" aria-hidden="true" tabindex="-1"></a>Swatch Internet Time differs from Dec in that it <span class="co">[</span><span class="ot">has no time zones</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=There%20are%20no%20time%20zones%20in%20Swatch%20Internet%20Time)</span> and is obtained from the [<span class="co">[</span><span class="ot">hours</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1)</span>]{.teal}<span class="co">[</span><span class="ot">, [minutes]{.olive}, and [seconds]{.purple}</span><span class="co">](https://en.wikipedia.org/wiki/Swatch_Internet_Time#Calculation_from_UTC+1:~:text=The%20formula%20for%20calculating%20the%20time%20in%20.beats%20from%20UTC%2B1)</span> of <span class="co">[</span><span class="ot">UTC+01:00</span><span class="co">](https://en.wikipedia.org/wiki/UTC%2B01:00#:~:text=a%20time%20offset%20from%20UTC%20of%20%2B01%3A00)</span>. In contrast, the major innovations described in this article are the Dec time zone system and the simple equation for obtaining the Dec time in Zone 0 from a UNIX timestamp, but Dec has much more to offer than <span class="co">[</span><span class="ot">deciday</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#:~:text=dividing%20the%20day%20into%2010%20decidays)</span>{.tool data-bs-toggle="tooltip" data-bs-title="a tenth of a day"} times and zones.</span>
<span id="cb46-1557"><a href="#cb46-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1558"><a href="#cb46-1558" aria-hidden="true" tabindex="-1"></a><span class="fu"># Next</span></span>
<span id="cb46-1559"><a href="#cb46-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1560"><a href="#cb46-1560" aria-hidden="true" tabindex="-1"></a>The next article in the <span class="co">[</span><span class="ot">Dec section</span><span class="co">](/dec)</span> of my site compares Dec to the <span class="co">[</span><span class="ot">ISO 8601</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#:~:text=an%20international%20standard%20covering%20the%20worldwide%20exchange%20and%20communication%20of%20date%20and%20time%2Drelated%20data)</span> international standard for dates and times. Like ISO 8601, Dec allows for <span class="co">[</span><span class="ot">combined date and time representations</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations)</span> that can be paired up to express <span class="co">[</span><span class="ot">time intervals</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Time_intervals:~:text=the%20intervening%20time%20between%20two%20time%20points)</span>. In Dec, the combination of a date and time is called a snap🫰and a time interval expressed as a pair of snaps is called a span🌈.</span>
<span id="cb46-1561"><a href="#cb46-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1562"><a href="#cb46-1562" aria-hidden="true" tabindex="-1"></a>My <span class="co">[</span><span class="ot">ISO 8601 article</span><span class="co">](/dec/iso)</span> is unique because it avoids the use of Observable in favor of leveraging <span class="co">[</span><span class="ot">Jupyter</span><span class="co">](https://jupyter.org)</span> support in Quarto to make the code underlying Dec available in multiple programming languages. Observable is a great visualization tool but does not translate well into Jupyter notebooks. After the next article, I return to the use of Observable in my Dec <span class="co">[</span><span class="ot">snap</span><span class="co">](/dec/span)</span>🫰and <span class="co">[</span><span class="ot">span</span><span class="co">](/dec/span)</span>🌈articles.</span>
<span id="cb46-1563"><a href="#cb46-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1564"><a href="#cb46-1564" aria-hidden="true" tabindex="-1"></a>::: {#timenav}</span>
<span id="cb46-1565"><a href="#cb46-1565" aria-hidden="true" tabindex="-1"></a>{{&lt; include /asset/_decnav.qmd &gt;}}</span>
<span id="cb46-1566"><a href="#cb46-1566" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-1567"><a href="#cb46-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1568"><a href="#cb46-1568" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cite</span></span>
<span id="cb46-1569"><a href="#cb46-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1570"><a href="#cb46-1570" aria-hidden="true" tabindex="-1"></a>Please spread the good word about Dec using the citation information at the bottom of this article. You may also want to cite the Observable notebooks that I adapted into the clock🕓, bar📊chart, map🗺️, and daylight☀️plot visualizations in this article or the 2014 blog post which proposed a system of 20 decimal time zones, each 5 <span class="co">[</span><span class="ot">centidays</span><span class="co">]</span>{.tool data-bs-toggle="tooltip" data-bs-title="hundredths of a day"} wide, based on the <span class="co">[</span><span class="ot">Greenwich Meridian</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Prime_meridian_(Greenwich)#:~:text=a%20geographical%20reference%20line%20that%20passes%20through%20the%20Royal%20Observatory%2C%20Greenwich%2C%20in%20London%2C%20England):</span>
<span id="cb46-1571"><a href="#cb46-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1572"><a href="#cb46-1572" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Pearson, Tom</span><span class="co">](https://www.2x2.graphics)</span>. [<span class="co">[</span><span class="ot">2013</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[124]{.cyan}</span><span class="co">]</span>{.underline}. “Simple D3 clock.” <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@d3/simple-clock</span><span class="co">](https://observablehq.com/@d3/simple-clock)</span>{.uri}.</span>
<span id="cb46-1573"><a href="#cb46-1573" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Heyen, Frank</span><span class="co">](https://fheyen.github.io)</span>. [<span class="co">[</span><span class="ot">2021</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[246]{.cyan}</span><span class="co">]</span>{.underline}. “BarChart Clock.” <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@fheyen/barchart-clock</span><span class="co">](https://observablehq.com/@fheyen/barchart-clock)</span>{.uri}.</span>
<span id="cb46-1574"><a href="#cb46-1574" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Johnson, Ian</span><span class="co">](https://enjalot.github.io)</span>. [<span class="co">[</span><span class="ot">2021</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[090]{.cyan}</span><span class="co">]</span>{.underline}. “Draggable World Map Coordinates Input.” <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@enjalot/draggable-world-map-coordinates-input</span><span class="co">](https://observablehq.com/@enjalot/draggable-world-map-coordinates-input)</span>{.uri}.</span>
<span id="cb46-1575"><a href="#cb46-1575" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Bridges, Dan</span><span class="co">](https://www.danbridges.org)</span>. [<span class="co">[</span><span class="ot">2021</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[311]{.cyan}</span><span class="co">]</span>{.underline}. “Visualizing Seasonal Daylight.” <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="co">[</span><span class="ot">https://observablehq.com/\@dbridges/visualizing-seasonal-daylight</span><span class="co">](https://observablehq.com/@dbridges/visualizing-seasonal-daylight)</span>{.uri}.</span>
<span id="cb46-1576"><a href="#cb46-1576" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Clements, John</span><span class="co">](https://www.brinckerhoff.org)</span>. [<span class="co">[</span><span class="ot">2014</span><span class="co">]</span>{.underline}]{.yellow}<span class="co">[</span><span class="ot">+[091]{.cyan}</span><span class="co">]</span>{.underline}, “Decimal Time Zones.” <span class="co">[</span><span class="ot">\${decYear}</span><span class="co">]</span>{.yellow}+<span class="co">[</span><span class="ot">\${decDate}</span><span class="co">]</span>{.cyan}. <span class="ot">&lt;https://www.brinckerhoff.org/blog/2014/05/31/decimal-time-zones&gt;</span>.</span>
<span id="cb46-1577"><a href="#cb46-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1580"><a href="#cb46-1580" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-1581"><a href="#cb46-1581" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-1582"><a href="#cb46-1582" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: false</span></span>
<span id="cb46-1583"><a href="#cb46-1583" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb46-1584"><a href="#cb46-1584" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [(unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> (</span>
<span id="cb46-1585"><a href="#cb46-1585" aria-hidden="true" tabindex="-1"></a>    zone <span class="op">=</span> zone <span class="op">??</span> <span class="op">-</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb46-1586"><a href="#cb46-1586" aria-hidden="true" tabindex="-1"></a>      (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)</span>
<span id="cb46-1587"><a href="#cb46-1587" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb46-1588"><a href="#cb46-1588" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1589"><a href="#cb46-1589" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote1</span>(unix<span class="op">,</span> zone<span class="op">,</span> offset <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb46-1590"><a href="#cb46-1590" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb46-1591"><a href="#cb46-1591" aria-hidden="true" tabindex="-1"></a>    (unix <span class="op">??</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()) <span class="op">/</span> <span class="dv">86400000</span></span>
<span id="cb46-1592"><a href="#cb46-1592" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> (zone <span class="op">=</span> zone <span class="op">??</span> (<span class="dv">10</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(</span>
<span id="cb46-1593"><a href="#cb46-1593" aria-hidden="true" tabindex="-1"></a>        (<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">/</span> <span class="dv">144</span>)) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-1594"><a href="#cb46-1594" aria-hidden="true" tabindex="-1"></a>      ) <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> offset<span class="op">,</span> zone]</span>
<span id="cb46-1595"><a href="#cb46-1595" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1596"><a href="#cb46-1596" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2date</span>(dote<span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb46-1597"><a href="#cb46-1597" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cote <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((</span>
<span id="cb46-1598"><a href="#cb46-1598" aria-hidden="true" tabindex="-1"></a>      dote <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> dote</span>
<span id="cb46-1599"><a href="#cb46-1599" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> dote <span class="op">-</span> <span class="dv">146096</span></span>
<span id="cb46-1600"><a href="#cb46-1600" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb46-1601"><a href="#cb46-1601" aria-hidden="true" tabindex="-1"></a>  dotc <span class="op">=</span> dote <span class="op">-</span> cote <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb46-1602"><a href="#cb46-1602" aria-hidden="true" tabindex="-1"></a>  yotc <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dotc</span>
<span id="cb46-1603"><a href="#cb46-1603" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>)</span>
<span id="cb46-1604"><a href="#cb46-1604" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>)</span>
<span id="cb46-1605"><a href="#cb46-1605" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)</span>
<span id="cb46-1606"><a href="#cb46-1606" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">/</span> <span class="dv">365</span>)<span class="op">;</span></span>
<span id="cb46-1607"><a href="#cb46-1607" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb46-1608"><a href="#cb46-1608" aria-hidden="true" tabindex="-1"></a>    yotc <span class="op">+</span> cote <span class="op">*</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb46-1609"><a href="#cb46-1609" aria-hidden="true" tabindex="-1"></a>    dotc <span class="op">-</span> (yotc <span class="op">*</span> <span class="dv">365</span></span>
<span id="cb46-1610"><a href="#cb46-1610" aria-hidden="true" tabindex="-1"></a>      <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">4</span>)</span>
<span id="cb46-1611"><a href="#cb46-1611" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-1612"><a href="#cb46-1612" aria-hidden="true" tabindex="-1"></a>  )<span class="op">,</span> zone]}</span>
<span id="cb46-1613"><a href="#cb46-1613" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getEot</span>(day) {</span>
<span id="cb46-1614"><a href="#cb46-1614" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> gamma <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> day <span class="op">/</span> <span class="dv">365</span></span>
<span id="cb46-1615"><a href="#cb46-1615" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb46-1616"><a href="#cb46-1616" aria-hidden="true" tabindex="-1"></a>      <span class="fl">1.49504245e-5</span> <span class="op">+</span></span>
<span id="cb46-1617"><a href="#cb46-1617" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span><span class="fl">4.1898733e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(gamma) <span class="op">+</span></span>
<span id="cb46-1618"><a href="#cb46-1618" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span><span class="fl">2.9237036e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(gamma) <span class="op">+</span></span>
<span id="cb46-1619"><a href="#cb46-1619" aria-hidden="true" tabindex="-1"></a>      <span class="op">-</span><span class="fl">4.5694380e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(<span class="dv">2</span> <span class="op">*</span> gamma) <span class="op">+</span></span>
<span id="cb46-1620"><a href="#cb46-1620" aria-hidden="true" tabindex="-1"></a>      <span class="fl">5.17560175e-2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(<span class="dv">2</span> <span class="op">*</span> gamma)</span>
<span id="cb46-1621"><a href="#cb46-1621" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-1622"><a href="#cb46-1622" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1623"><a href="#cb46-1623" aria-hidden="true" tabindex="-1"></a>dz <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb46-1624"><a href="#cb46-1624" aria-hidden="true" tabindex="-1"></a>decYear <span class="op">=</span> ydz[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span>)</span>
<span id="cb46-1625"><a href="#cb46-1625" aria-hidden="true" tabindex="-1"></a>zeroDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="dv">0</span>)[<span class="dv">0</span>]</span>
<span id="cb46-1626"><a href="#cb46-1626" aria-hidden="true" tabindex="-1"></a>zeroTime <span class="op">=</span> zeroDote <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-1627"><a href="#cb46-1627" aria-hidden="true" tabindex="-1"></a>zeroDate <span class="op">=</span> <span class="fu">dote2date</span>(zeroDote)</span>
<span id="cb46-1628"><a href="#cb46-1628" aria-hidden="true" tabindex="-1"></a>zeroYear <span class="op">=</span> zeroDate[<span class="dv">0</span>]</span>
<span id="cb46-1629"><a href="#cb46-1629" aria-hidden="true" tabindex="-1"></a>zeroYda <span class="op">=</span> zeroDate[<span class="dv">1</span>]</span>
<span id="cb46-1630"><a href="#cb46-1630" aria-hidden="true" tabindex="-1"></a>zeroDoy <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(zeroYda)</span>
<span id="cb46-1631"><a href="#cb46-1631" aria-hidden="true" tabindex="-1"></a>zeroIsLeap <span class="op">=</span> <span class="fu">isLeapYear</span>(zeroYear)</span>
<span id="cb46-1632"><a href="#cb46-1632" aria-hidden="true" tabindex="-1"></a>zeroYdaHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroYda<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroYda <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> zeroIsLeap)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1633"><a href="#cb46-1633" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1634"><a href="#cb46-1634" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(zeroTime<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1635"><a href="#cb46-1635" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl2 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1636"><a href="#cb46-1636" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl3 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1637"><a href="#cb46-1637" aria-hidden="true" tabindex="-1"></a>zeroTimeHsl4 <span class="op">=</span> <span class="fu">textcolor</span>((zeroTime <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1638"><a href="#cb46-1638" aria-hidden="true" tabindex="-1"></a>zeroDotyHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroDoy<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroDoy <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> zeroIsLeap)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1639"><a href="#cb46-1639" aria-hidden="true" tabindex="-1"></a>zeroDoteHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroDote<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">5</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroDote <span class="op">%</span> <span class="dv">1</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1640"><a href="#cb46-1640" aria-hidden="true" tabindex="-1"></a>zeroYearHsl <span class="op">=</span> <span class="fu">textcolor</span>(zeroYear<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(zeroYear <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-1641"><a href="#cb46-1641" aria-hidden="true" tabindex="-1"></a>browserDote <span class="op">=</span> <span class="fu">unix2dote</span>(now)</span>
<span id="cb46-1642"><a href="#cb46-1642" aria-hidden="true" tabindex="-1"></a>browserTime <span class="op">=</span> browserDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb46-1643"><a href="#cb46-1643" aria-hidden="true" tabindex="-1"></a>browserZone <span class="op">=</span> browserDote[<span class="dv">1</span>]</span>
<span id="cb46-1644"><a href="#cb46-1644" aria-hidden="true" tabindex="-1"></a>browserSign <span class="op">=</span> browserZone <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb46-1645"><a href="#cb46-1645" aria-hidden="true" tabindex="-1"></a>zone0time <span class="op">=</span> (browserTime <span class="op">-</span> browserZone <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-1646"><a href="#cb46-1646" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> browserTime <span class="op">*</span> <span class="fl">2.4</span></span>
<span id="cb46-1647"><a href="#cb46-1647" aria-hidden="true" tabindex="-1"></a>minutes <span class="op">=</span> hours <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb46-1648"><a href="#cb46-1648" aria-hidden="true" tabindex="-1"></a>seconds <span class="op">=</span> minutes <span class="op">%</span> <span class="dv">1</span> <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb46-1649"><a href="#cb46-1649" aria-hidden="true" tabindex="-1"></a>selectedDote <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> <span class="fu">long2zone</span>(location[<span class="dv">0</span>]))</span>
<span id="cb46-1650"><a href="#cb46-1650" aria-hidden="true" tabindex="-1"></a>selectedExact <span class="op">=</span> selectedDote[<span class="dv">0</span>] <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-1651"><a href="#cb46-1651" aria-hidden="true" tabindex="-1"></a>selectedExactN <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> selectedExact) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-1652"><a href="#cb46-1652" aria-hidden="true" tabindex="-1"></a>selectedZone <span class="op">=</span> selectedDote[<span class="dv">1</span>]</span>
<span id="cb46-1653"><a href="#cb46-1653" aria-hidden="true" tabindex="-1"></a>ydz <span class="op">=</span> <span class="fu">dote2date</span>(<span class="op">...</span>selectedDote)</span>
<span id="cb46-1654"><a href="#cb46-1654" aria-hidden="true" tabindex="-1"></a>decDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(ydz[<span class="dv">1</span>])</span>
<span id="cb46-1655"><a href="#cb46-1655" aria-hidden="true" tabindex="-1"></a>decTime <span class="op">=</span> (selectedExact <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb46-1656"><a href="#cb46-1656" aria-hidden="true" tabindex="-1"></a>decTimeN <span class="op">=</span> (selectedExactN <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb46-1657"><a href="#cb46-1657" aria-hidden="true" tabindex="-1"></a>barDD <span class="op">=</span> decTime[<span class="dv">0</span>]</span>
<span id="cb46-1658"><a href="#cb46-1658" aria-hidden="true" tabindex="-1"></a>barDDN <span class="op">=</span> decTimeN[<span class="dv">0</span>]</span>
<span id="cb46-1659"><a href="#cb46-1659" aria-hidden="true" tabindex="-1"></a>barMils <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb46-1660"><a href="#cb46-1660" aria-hidden="true" tabindex="-1"></a>barMilsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb46-1661"><a href="#cb46-1661" aria-hidden="true" tabindex="-1"></a>barBeats <span class="op">=</span> decTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb46-1662"><a href="#cb46-1662" aria-hidden="true" tabindex="-1"></a>barBeatsN <span class="op">=</span> decTimeN<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb46-1663"><a href="#cb46-1663" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">lati2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb46-1664"><a href="#cb46-1664" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb46-1665"><a href="#cb46-1665" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb46-1666"><a href="#cb46-1666" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1667"><a href="#cb46-1667" aria-hidden="true" tabindex="-1"></a>graticule <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoGraticule</span>()<span class="op">.</span><span class="fu">stepMinor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])<span class="op">.</span><span class="fu">stepMajor</span>([<span class="dv">36</span><span class="op">,</span><span class="dv">36</span>])()</span>
<span id="cb46-1668"><a href="#cb46-1668" aria-hidden="true" tabindex="-1"></a>graticule<span class="op">.</span><span class="at">coordinates</span> <span class="op">=</span> graticule<span class="op">.</span><span class="at">coordinates</span><span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb46-1669"><a href="#cb46-1669" aria-hidden="true" tabindex="-1"></a>  i <span class="kw">=&gt;</span> i<span class="op">.</span><span class="fu">map</span>(j <span class="kw">=&gt;</span> j<span class="op">.</span><span class="fu">map</span>((k<span class="op">,</span> index<span class="op">,</span> arr) <span class="kw">=&gt;</span> i<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> index <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> k <span class="op">-</span> <span class="dv">18</span> <span class="op">:</span> k))</span>
<span id="cb46-1670"><a href="#cb46-1670" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-1671"><a href="#cb46-1671" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2turn</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span><span class="op">,</span> e <span class="op">=</span> <span class="dv">3</span>) {</span>
<span id="cb46-1672"><a href="#cb46-1672" aria-hidden="true" tabindex="-1"></a>  <span class="co">// turns: e=0, deciturns: e=1, etc.</span></span>
<span id="cb46-1673"><a href="#cb46-1673" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (((degrees <span class="op">%=</span> <span class="dv">360</span>) <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> degrees <span class="op">+</span> <span class="dv">360</span> <span class="op">:</span> degrees) <span class="op">+</span> <span class="dv">18</span>) <span class="op">/</span> (<span class="dv">360</span> <span class="op">/</span> <span class="dv">10</span><span class="op">**</span>e) <span class="op">%</span> <span class="dv">10</span><span class="op">**</span>e<span class="op">;</span></span>
<span id="cb46-1674"><a href="#cb46-1674" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1675"><a href="#cb46-1675" aria-hidden="true" tabindex="-1"></a><span class="co">// https://github.com/topojson/world-atlas</span></span>
<span id="cb46-1676"><a href="#cb46-1676" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> d3<span class="op">.</span><span class="fu">json</span>(<span class="st">"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json"</span>)</span>
<span id="cb46-1677"><a href="#cb46-1677" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">countries</span>)</span>
<span id="cb46-1678"><a href="#cb46-1678" aria-hidden="true" tabindex="-1"></a>topojson <span class="op">=</span> <span class="pp">require</span>(<span class="st">"topojson-client@3"</span>)</span>
<span id="cb46-1679"><a href="#cb46-1679" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">long2zone</span>(degrees <span class="op">=</span> <span class="op">-</span><span class="dv">180</span>) {</span>
<span id="cb46-1680"><a href="#cb46-1680" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">long2turn</span>(degrees<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb46-1681"><a href="#cb46-1681" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1682"><a href="#cb46-1682" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">year2leap</span>(year <span class="op">=</span> <span class="dv">1970</span>) {</span>
<span id="cb46-1683"><a href="#cb46-1683" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> year <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> year <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> year <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb46-1684"><a href="#cb46-1684" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1685"><a href="#cb46-1685" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb46-1686"><a href="#cb46-1686" aria-hidden="true" tabindex="-1"></a>solarSystem <span class="op">=</span> (<span class="bu">root</span><span class="op">,</span> vizwidth<span class="op">,</span> location<span class="op">,</span> date<span class="op">,</span> hour<span class="op">,</span> darkmode) <span class="kw">=&gt;</span> {</span>
<span id="cb46-1687"><a href="#cb46-1687" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthRadius <span class="op">=</span> <span class="fl">0.065</span> <span class="op">*</span> vizwidth<span class="op">;</span></span>
<span id="cb46-1688"><a href="#cb46-1688" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const sunRadius = 0.015 * vizwidth;</span></span>
<span id="cb46-1689"><a href="#cb46-1689" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystemRadius <span class="op">=</span> vizwidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (vizwidth <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb46-1690"><a href="#cb46-1690" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stretch <span class="op">=</span> <span class="fl">0.06</span><span class="op">;</span></span>
<span id="cb46-1691"><a href="#cb46-1691" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(date)<span class="op">;</span></span>
<span id="cb46-1692"><a href="#cb46-1692" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarAngleDeg <span class="op">=</span> (solarAngle <span class="op">*</span> <span class="dv">180</span>) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb46-1693"><a href="#cb46-1693" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(solarAngle)<span class="op">;</span></span>
<span id="cb46-1694"><a href="#cb46-1694" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> stretch <span class="op">*</span> solarSystemRadius <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(solarAngle)<span class="op">;</span></span>
<span id="cb46-1695"><a href="#cb46-1695" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> spin <span class="op">=</span> <span class="dv">180</span> <span class="op">+</span> <span class="op">-</span>location[<span class="dv">0</span>] <span class="op">+</span> solarAngleDeg <span class="op">+</span> <span class="dv">360</span> <span class="op">*</span> ((hour <span class="op">+</span> <span class="dv">12</span>) <span class="op">/</span> <span class="dv">24</span>)<span class="op">;</span></span>
<span id="cb46-1696"><a href="#cb46-1696" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> earthGeo <span class="op">=</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> }<span class="op">;</span></span>
<span id="cb46-1697"><a href="#cb46-1697" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb46-1698"><a href="#cb46-1698" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb46-1699"><a href="#cb46-1699" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb46-1700"><a href="#cb46-1700" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([spin<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="fl">23.5</span>])</span>
<span id="cb46-1701"><a href="#cb46-1701" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb46-1702"><a href="#cb46-1702" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticProjection <span class="op">=</span> d3</span>
<span id="cb46-1703"><a href="#cb46-1703" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoOrthographic</span>()</span>
<span id="cb46-1704"><a href="#cb46-1704" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitWidth</span>(earthRadius <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> earthGeo)</span>
<span id="cb46-1705"><a href="#cb46-1705" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rotate</span>([solarAngleDeg <span class="op">-</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">0</span>])</span>
<span id="cb46-1706"><a href="#cb46-1706" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">translate</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb46-1707"><a href="#cb46-1707" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">1.5</span>)<span class="op">;</span></span>
<span id="cb46-1708"><a href="#cb46-1708" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> staticPath <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(staticProjection)<span class="op">;</span></span>
<span id="cb46-1709"><a href="#cb46-1709" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> oceanColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb46-1710"><a href="#cb46-1710" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> landColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb46-1711"><a href="#cb46-1711" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> borderColor <span class="op">=</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb46-1712"><a href="#cb46-1712" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> solarSystem <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb46-1713"><a href="#cb46-1713" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-1714"><a href="#cb46-1714" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>vizwidth <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-1715"><a href="#cb46-1715" aria-hidden="true" tabindex="-1"></a>  <span class="co">// solarSystem.append("circle").attr("r", sunRadius).attr("fill", colors.sun);</span></span>
<span id="cb46-1716"><a href="#cb46-1716" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Draw orbit */</span></span>
<span id="cb46-1717"><a href="#cb46-1717" aria-hidden="true" tabindex="-1"></a>    solarSystem</span>
<span id="cb46-1718"><a href="#cb46-1718" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"ellipse"</span>)</span>
<span id="cb46-1719"><a href="#cb46-1719" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> solarSystemRadius)</span>
<span id="cb46-1720"><a href="#cb46-1720" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> stretch <span class="op">*</span> solarSystemRadius)</span>
<span id="cb46-1721"><a href="#cb46-1721" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb46-1722"><a href="#cb46-1722" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.25"</span>)</span>
<span id="cb46-1723"><a href="#cb46-1723" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb46-1724"><a href="#cb46-1724" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* Draw month ticks */</span></span>
<span id="cb46-1725"><a href="#cb46-1725" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="dv">12</span>)<span class="op">.</span><span class="fu">map</span>((m) <span class="kw">=&gt;</span> {</span>
<span id="cb46-1726"><a href="#cb46-1726" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> d <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb46-1727"><a href="#cb46-1727" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> angle <span class="op">=</span> <span class="fu">getSolarAngle</span>(d)<span class="op">;</span></span>
<span id="cb46-1728"><a href="#cb46-1728" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb46-1729"><a href="#cb46-1729" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb46-1730"><a href="#cb46-1730" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb46-1731"><a href="#cb46-1731" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb46-1732"><a href="#cb46-1732" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(angle))</span>
<span id="cb46-1733"><a href="#cb46-1733" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> (solarSystemRadius <span class="op">-</span> <span class="dv">9</span>) <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(angle))</span>
<span id="cb46-1734"><a href="#cb46-1734" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1.75"</span>)</span>
<span id="cb46-1735"><a href="#cb46-1735" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb46-1736"><a href="#cb46-1736" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> startMonthAngle <span class="op">=</span> <span class="fu">getSolarAngle</span>(<span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> m<span class="op">,</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb46-1737"><a href="#cb46-1737" aria-hidden="true" tabindex="-1"></a>      solarSystem</span>
<span id="cb46-1738"><a href="#cb46-1738" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-1739"><a href="#cb46-1739" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="fu">date2doty</span>(d))</span>
<span id="cb46-1740"><a href="#cb46-1740" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> (solarSystemRadius <span class="op">+</span> <span class="dv">18</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(startMonthAngle) <span class="op">*</span> <span class="fl">1.1</span>)</span>
<span id="cb46-1741"><a href="#cb46-1741" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb46-1742"><a href="#cb46-1742" aria-hidden="true" tabindex="-1"></a>          <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb46-1743"><a href="#cb46-1743" aria-hidden="true" tabindex="-1"></a>          (solarSystemRadius <span class="op">+</span> <span class="dv">2</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">3</span>) <span class="op">*</span> <span class="fl">6.2</span> <span class="op">*</span> stretch <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(startMonthAngle)) <span class="op">*</span> <span class="dv">12</span></span>
<span id="cb46-1744"><a href="#cb46-1744" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb46-1745"><a href="#cb46-1745" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-1746"><a href="#cb46-1746" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-1747"><a href="#cb46-1747" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> <span class="fl">1.2</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-1748"><a href="#cb46-1748" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb46-1749"><a href="#cb46-1749" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb46-1750"><a href="#cb46-1750" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb46-1751"><a href="#cb46-1751" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> earth <span class="op">=</span> solarSystem</span>
<span id="cb46-1752"><a href="#cb46-1752" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-1753"><a href="#cb46-1753" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>y<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-1754"><a href="#cb46-1754" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">drawEarth</span>() {</span>
<span id="cb46-1755"><a href="#cb46-1755" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fl">1.5</span> <span class="op">*</span> earthRadius)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"blue"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`rotate(-23.5)`</span>)<span class="op">;</span></span>
<span id="cb46-1756"><a href="#cb46-1756" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(earthGeo))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeOcean"</span>)<span class="op">;</span></span>
<span id="cb46-1757"><a href="#cb46-1757" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(land))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeLand"</span>)<span class="op">;</span></span>
<span id="cb46-1758"><a href="#cb46-1758" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>(countries))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">".08"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> darkmode <span class="op">?</span> <span class="st">"#eee"</span> <span class="op">:</span> <span class="st">"#333"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"globeBorders"</span>)<span class="op">;</span></span>
<span id="cb46-1759"><a href="#cb46-1759" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">5.5</span>)<span class="op">;</span></span>
<span id="cb46-1760"><a href="#cb46-1760" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb46-1761"><a href="#cb46-1761" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">4.5</span>)<span class="op">;</span></span>
<span id="cb46-1762"><a href="#cb46-1762" aria-hidden="true" tabindex="-1"></a>      earth<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">path</span>({ <span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> location }))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">2.25</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb46-1763"><a href="#cb46-1763" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-1764"><a href="#cb46-1764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb46-1765"><a href="#cb46-1765" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1766"><a href="#cb46-1766" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greg2doty</span>(month <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> day <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb46-1767"><a href="#cb46-1767" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb46-1768"><a href="#cb46-1768" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> day <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb46-1769"><a href="#cb46-1769" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb46-1770"><a href="#cb46-1770" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty</span>(date) {</span>
<span id="cb46-1771"><a href="#cb46-1771" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb46-1772"><a href="#cb46-1772" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1773"><a href="#cb46-1773" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2doty1</span>(date) {</span>
<span id="cb46-1774"><a href="#cb46-1774" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">greg2doty</span>(date<span class="op">.</span><span class="fu">getMonth</span>() <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> date<span class="op">.</span><span class="fu">getDate</span>())</span>
<span id="cb46-1775"><a href="#cb46-1775" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1776"><a href="#cb46-1776" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb46-1777"><a href="#cb46-1777" aria-hidden="true" tabindex="-1"></a><span class="co">// globe = (root, { vizwidth, location, date, hour }) =&gt; {</span></span>
<span id="cb46-1778"><a href="#cb46-1778" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngle = getSolarAngle(date);</span></span>
<span id="cb46-1779"><a href="#cb46-1779" aria-hidden="true" tabindex="-1"></a><span class="co">//   const solarAngleDeg = toDegrees(solarAngle);</span></span>
<span id="cb46-1780"><a href="#cb46-1780" aria-hidden="true" tabindex="-1"></a><span class="co">//   const hourSpin = 360 * ((hour + 12) / 24);</span></span>
<span id="cb46-1781"><a href="#cb46-1781" aria-hidden="true" tabindex="-1"></a><span class="co">//   const spin = (180 + -location[0] + solarAngleDeg + hourSpin);</span></span>
<span id="cb46-1782"><a href="#cb46-1782" aria-hidden="true" tabindex="-1"></a><span class="co">//   const tilt = -15;</span></span>
<span id="cb46-1783"><a href="#cb46-1783" aria-hidden="true" tabindex="-1"></a><span class="co">//   const projection = d3.geoOrthographic()</span></span>
<span id="cb46-1784"><a href="#cb46-1784" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .fitWidth(vizwidth, graticule)</span></span>
<span id="cb46-1785"><a href="#cb46-1785" aria-hidden="true" tabindex="-1"></a><span class="co">//                        .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb46-1786"><a href="#cb46-1786" aria-hidden="true" tabindex="-1"></a><span class="co">//   const path = d3.geoPath(projection);</span></span>
<span id="cb46-1787"><a href="#cb46-1787" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedProjection = d3.geoOrthographic()</span></span>
<span id="cb46-1788"><a href="#cb46-1788" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .clipAngle(null)</span></span>
<span id="cb46-1789"><a href="#cb46-1789" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .fitWidth(vizwidth, graticule)</span></span>
<span id="cb46-1790"><a href="#cb46-1790" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 .rotate([spin, tilt, 23.5]);</span></span>
<span id="cb46-1791"><a href="#cb46-1791" aria-hidden="true" tabindex="-1"></a><span class="co">//   const unClippedPath = d3.geoPath(unClippedProjection);</span></span>
<span id="cb46-1792"><a href="#cb46-1792" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticProjection = d3.geoOrthographic()</span></span>
<span id="cb46-1793"><a href="#cb46-1793" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .fitWidth(vizwidth, graticule)</span></span>
<span id="cb46-1794"><a href="#cb46-1794" aria-hidden="true" tabindex="-1"></a><span class="co">//                              .rotate([solarAngleDeg - 90, tilt]);</span></span>
<span id="cb46-1795"><a href="#cb46-1795" aria-hidden="true" tabindex="-1"></a><span class="co">//   const staticPath = d3.geoPath(staticProjection);</span></span>
<span id="cb46-1796"><a href="#cb46-1796" aria-hidden="true" tabindex="-1"></a><span class="co">//   const background = root.append("g");</span></span>
<span id="cb46-1797"><a href="#cb46-1797" aria-hidden="true" tabindex="-1"></a><span class="co">//   const earth = root.append("g").style("opacity", 0.75);</span></span>
<span id="cb46-1798"><a href="#cb46-1798" aria-hidden="true" tabindex="-1"></a><span class="co">//   const foreground = root.append("g");</span></span>
<span id="cb46-1799"><a href="#cb46-1799" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb46-1800"><a href="#cb46-1800" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Sphere"}))</span></span>
<span id="cb46-1801"><a href="#cb46-1801" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.ocean)</span></span>
<span id="cb46-1802"><a href="#cb46-1802" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#9ecbda");</span></span>
<span id="cb46-1803"><a href="#cb46-1803" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb46-1804"><a href="#cb46-1804" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(land))</span></span>
<span id="cb46-1805"><a href="#cb46-1805" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", mapcolors.land);</span></span>
<span id="cb46-1806"><a href="#cb46-1806" aria-hidden="true" tabindex="-1"></a><span class="co">//   earth.append("path")</span></span>
<span id="cb46-1807"><a href="#cb46-1807" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(countries))</span></span>
<span id="cb46-1808"><a href="#cb46-1808" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", "1")</span></span>
<span id="cb46-1809"><a href="#cb46-1809" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb46-1810"><a href="#cb46-1810" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "#000");</span></span>
<span id="cb46-1811"><a href="#cb46-1811" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb46-1812"><a href="#cb46-1812" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath({type: "Point", coordinates: location}))</span></span>
<span id="cb46-1813"><a href="#cb46-1813" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb46-1814"><a href="#cb46-1814" aria-hidden="true" tabindex="-1"></a><span class="co">//   const latitudeCoords = (latitude, start, end) =&gt; {</span></span>
<span id="cb46-1815"><a href="#cb46-1815" aria-hidden="true" tabindex="-1"></a><span class="co">//     const longitudes = d3.range(start, end, 2).concat(end);</span></span>
<span id="cb46-1816"><a href="#cb46-1816" aria-hidden="true" tabindex="-1"></a><span class="co">//     return longitudes.map(d =&gt; [d, latitude]);</span></span>
<span id="cb46-1817"><a href="#cb46-1817" aria-hidden="true" tabindex="-1"></a><span class="co">//   }</span></span>
<span id="cb46-1818"><a href="#cb46-1818" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctSpin = d3.geoRotation([-hourSpin, 0]);</span></span>
<span id="cb46-1819"><a href="#cb46-1819" aria-hidden="true" tabindex="-1"></a><span class="co">//   const correctTilt = d3.geoRotation([6, 0, 0]);</span></span>
<span id="cb46-1820"><a href="#cb46-1820" aria-hidden="true" tabindex="-1"></a><span class="co">//   /* total angular extent of day/night */</span></span>
<span id="cb46-1821"><a href="#cb46-1821" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayExtent = 360 * dayLength(date, location[1]) / 24;</span></span>
<span id="cb46-1822"><a href="#cb46-1822" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightExtent = 360 - dayExtent;</span></span>
<span id="cb46-1823"><a href="#cb46-1823" aria-hidden="true" tabindex="-1"></a><span class="co">//   const dayLine = {</span></span>
<span id="cb46-1824"><a href="#cb46-1824" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb46-1825"><a href="#cb46-1825" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb46-1826"><a href="#cb46-1826" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2,</span></span>
<span id="cb46-1827"><a href="#cb46-1827" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] + dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb46-1828"><a href="#cb46-1828" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb46-1829"><a href="#cb46-1829" aria-hidden="true" tabindex="-1"></a><span class="co">//   const nightLine = {</span></span>
<span id="cb46-1830"><a href="#cb46-1830" aria-hidden="true" tabindex="-1"></a><span class="co">//     type: "LineString",</span></span>
<span id="cb46-1831"><a href="#cb46-1831" aria-hidden="true" tabindex="-1"></a><span class="co">//     coordinates: latitudeCoords(location[1],</span></span>
<span id="cb46-1832"><a href="#cb46-1832" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2 - nightExtent,</span></span>
<span id="cb46-1833"><a href="#cb46-1833" aria-hidden="true" tabindex="-1"></a><span class="co">//                                 location[0] - dayExtent / 2).map(d =&gt; correctSpin(d))</span></span>
<span id="cb46-1834"><a href="#cb46-1834" aria-hidden="true" tabindex="-1"></a><span class="co">//   };</span></span>
<span id="cb46-1835"><a href="#cb46-1835" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb46-1836"><a href="#cb46-1836" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(dayLine))</span></span>
<span id="cb46-1837"><a href="#cb46-1837" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb46-1838"><a href="#cb46-1838" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb46-1839"><a href="#cb46-1839" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb46-1840"><a href="#cb46-1840" aria-hidden="true" tabindex="-1"></a><span class="co">//   background.append("path")</span></span>
<span id="cb46-1841"><a href="#cb46-1841" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", unClippedPath(nightLine))</span></span>
<span id="cb46-1842"><a href="#cb46-1842" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb46-1843"><a href="#cb46-1843" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb46-1844"><a href="#cb46-1844" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb46-1845"><a href="#cb46-1845" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb46-1846"><a href="#cb46-1846" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(dayLine))</span></span>
<span id="cb46-1847"><a href="#cb46-1847" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb46-1848"><a href="#cb46-1848" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.day)</span></span>
<span id="cb46-1849"><a href="#cb46-1849" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb46-1850"><a href="#cb46-1850" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb46-1851"><a href="#cb46-1851" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path(nightLine))</span></span>
<span id="cb46-1852"><a href="#cb46-1852" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "none")</span></span>
<span id="cb46-1853"><a href="#cb46-1853" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", mapcolors.night)</span></span>
<span id="cb46-1854"><a href="#cb46-1854" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", 3);</span></span>
<span id="cb46-1855"><a href="#cb46-1855" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb46-1856"><a href="#cb46-1856" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", path({type: "Point", coordinates: location}))</span></span>
<span id="cb46-1857"><a href="#cb46-1857" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke-width", .5)</span></span>
<span id="cb46-1858"><a href="#cb46-1858" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("stroke", "black")</span></span>
<span id="cb46-1859"><a href="#cb46-1859" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "red");</span></span>
<span id="cb46-1860"><a href="#cb46-1860" aria-hidden="true" tabindex="-1"></a><span class="co">//   const shadowPolygon = [[0, -90], [0, 0], [0, 90], [180, 0], [0, -90]].map(d =&gt; correctTilt(d));</span></span>
<span id="cb46-1861"><a href="#cb46-1861" aria-hidden="true" tabindex="-1"></a><span class="co">//   foreground.append("path")</span></span>
<span id="cb46-1862"><a href="#cb46-1862" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("d", staticPath({type: "Polygon", coordinates: [shadowPolygon]}))</span></span>
<span id="cb46-1863"><a href="#cb46-1863" aria-hidden="true" tabindex="-1"></a><span class="co">//     .attr("fill", "rgba(0, 0, 0, 0.25)");</span></span>
<span id="cb46-1864"><a href="#cb46-1864" aria-hidden="true" tabindex="-1"></a><span class="co">// }</span></span>
<span id="cb46-1865"><a href="#cb46-1865" aria-hidden="true" tabindex="-1"></a>dayOfYear <span class="op">=</span> (date) <span class="kw">=&gt;</span> {</span>
<span id="cb46-1866"><a href="#cb46-1866" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb46-1867"><a href="#cb46-1867" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb46-1868"><a href="#cb46-1868" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-1869"><a href="#cb46-1869" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dbridges/visualizing-seasonal-daylight</span></span>
<span id="cb46-1870"><a href="#cb46-1870" aria-hidden="true" tabindex="-1"></a>daylightPlot <span class="op">=</span> (</span>
<span id="cb46-1871"><a href="#cb46-1871" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span><span class="op">,</span></span>
<span id="cb46-1872"><a href="#cb46-1872" aria-hidden="true" tabindex="-1"></a>  { vizwidth<span class="op">,</span> height<span class="op">,</span> year<span class="op">,</span> latitude<span class="op">,</span> defaultDate<span class="op">,</span> defaultHour }</span>
<span id="cb46-1873"><a href="#cb46-1873" aria-hidden="true" tabindex="-1"></a>) <span class="kw">=&gt;</span> {</span>
<span id="cb46-1874"><a href="#cb46-1874" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">32</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">;</span></span>
<span id="cb46-1875"><a href="#cb46-1875" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartWidth <span class="op">=</span> vizwidth <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">;</span></span>
<span id="cb46-1876"><a href="#cb46-1876" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartHeight <span class="op">=</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb46-1877"><a href="#cb46-1877" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yTickValues <span class="op">=</span></span>
<span id="cb46-1878"><a href="#cb46-1878" aria-hidden="true" tabindex="-1"></a>    width <span class="op">&gt;</span> <span class="dv">380</span> <span class="op">?</span> [<span class="dv">3</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">21</span>] <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">90</span> <span class="op">?</span> [<span class="dv">6</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">18</span>] <span class="op">:</span> [<span class="dv">12</span>]<span class="op">;</span></span>
<span id="cb46-1879"><a href="#cb46-1879" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yScale <span class="op">=</span> d3</span>
<span id="cb46-1880"><a href="#cb46-1880" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb46-1881"><a href="#cb46-1881" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">24</span>])</span>
<span id="cb46-1882"><a href="#cb46-1882" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth])</span>
<span id="cb46-1883"><a href="#cb46-1883" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb46-1884"><a href="#cb46-1884" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis scale</span></span>
<span id="cb46-1885"><a href="#cb46-1885" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xScale <span class="op">=</span> d3</span>
<span id="cb46-1886"><a href="#cb46-1886" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleTime</span>()</span>
<span id="cb46-1887"><a href="#cb46-1887" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">61</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">11</span><span class="op">,</span> <span class="dv">91</span>)])</span>
<span id="cb46-1888"><a href="#cb46-1888" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">top</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight])</span>
<span id="cb46-1889"><a href="#cb46-1889" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">clamp</span>(<span class="kw">true</span>)<span class="op">;</span></span>
<span id="cb46-1890"><a href="#cb46-1890" aria-hidden="true" tabindex="-1"></a>  <span class="co">// y-axis labels</span></span>
<span id="cb46-1891"><a href="#cb46-1891" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xAxis <span class="op">=</span> d3</span>
<span id="cb46-1892"><a href="#cb46-1892" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisBottom</span>(xScale)</span>
<span id="cb46-1893"><a href="#cb46-1893" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(d3<span class="op">.</span><span class="at">timeMonth</span><span class="op">.</span><span class="fu">range</span>(<span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">60</span>)<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">57</span>)))</span>
<span id="cb46-1894"><a href="#cb46-1894" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartWidth)</span>
<span id="cb46-1895"><a href="#cb46-1895" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>(date2doty1)<span class="op">;</span></span>
<span id="cb46-1896"><a href="#cb46-1896" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> d3</span>
<span id="cb46-1897"><a href="#cb46-1897" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">axisLeft</span>(yScale)</span>
<span id="cb46-1898"><a href="#cb46-1898" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickValues</span>(yTickValues)</span>
<span id="cb46-1899"><a href="#cb46-1899" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickSize</span>(chartHeight)</span>
<span id="cb46-1900"><a href="#cb46-1900" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">tickFormat</span>((d) <span class="kw">=&gt;</span> { <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>d <span class="op">/</span> <span class="op">.</span><span class="bn">024</span><span class="sc">}</span><span class="vs">`</span> })<span class="op">;</span></span>
<span id="cb46-1901"><a href="#cb46-1901" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> date <span class="op">=</span> defaultDate <span class="op">||</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb46-1902"><a href="#cb46-1902" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> hour <span class="op">=</span> defaultHour <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> defaultHour <span class="op">:</span> date<span class="op">.</span><span class="fu">getHours</span>()<span class="op">;</span></span>
<span id="cb46-1903"><a href="#cb46-1903" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleMouseMove <span class="op">=</span> (e) <span class="kw">=&gt;</span> {}<span class="op">;</span></span>
<span id="cb46-1904"><a href="#cb46-1904" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb46-1905"><a href="#cb46-1905" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb46-1906"><a href="#cb46-1906" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span>)</span>
<span id="cb46-1907"><a href="#cb46-1907" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>)</span>
<span id="cb46-1908"><a href="#cb46-1908" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb46-1909"><a href="#cb46-1909" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> chartHeight)</span>
<span id="cb46-1910"><a href="#cb46-1910" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> <span class="fl">0.05</span> <span class="op">*</span> vizwidth)</span>
<span id="cb46-1911"><a href="#cb46-1911" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb46-1912"><a href="#cb46-1912" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb46-1913"><a href="#cb46-1913" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-1914"><a href="#cb46-1914" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb46-1915"><a href="#cb46-1915" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(xAxis)</span>
<span id="cb46-1916"><a href="#cb46-1916" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb46-1917"><a href="#cb46-1917" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb46-1918"><a href="#cb46-1918" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">7</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">.</span><span class="dv">725</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">.</span><span class="dv">75</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.3</span> <span class="op">:</span> <span class="fl">1.4</span>) <span class="op">*</span> fontSize))</span>
<span id="cb46-1919"><a href="#cb46-1919" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb46-1920"><a href="#cb46-1920" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb46-1921"><a href="#cb46-1921" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb46-1922"><a href="#cb46-1922" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-1923"><a href="#cb46-1923" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartHeight<span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb46-1924"><a href="#cb46-1924" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb46-1925"><a href="#cb46-1925" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb46-1926"><a href="#cb46-1926" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">grid</span>))</span>
<span id="cb46-1927"><a href="#cb46-1927" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.3</span>) <span class="op">*</span> fontSize))</span>
<span id="cb46-1928"><a href="#cb46-1928" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"color"</span><span class="op">,</span> <span class="st">"black"</span>))</span>
<span id="cb46-1929"><a href="#cb46-1929" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"5 3"</span>))<span class="op">;</span></span>
<span id="cb46-1930"><a href="#cb46-1930" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb46-1931"><a href="#cb46-1931" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-1932"><a href="#cb46-1932" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Time of day"</span>)</span>
<span id="cb46-1933"><a href="#cb46-1933" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="op">-</span><span class="dv">102</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">-</span><span class="dv">106</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="op">-</span><span class="dv">108</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="op">-</span><span class="dv">115</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="op">-</span><span class="dv">120</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">128</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">425</span> <span class="op">?</span> <span class="op">-</span><span class="dv">130</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="op">-</span><span class="dv">132</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="op">-</span><span class="dv">136</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">141</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">525</span> <span class="op">?</span> <span class="op">-</span><span class="dv">142</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="op">-</span><span class="dv">148</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">575</span> <span class="op">?</span> <span class="op">-</span><span class="dv">149</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">154</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">675</span> <span class="op">?</span> <span class="op">-</span><span class="dv">157</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="op">-</span><span class="dv">161</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">725</span> <span class="op">?</span> <span class="op">-</span><span class="dv">160</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="op">-</span><span class="dv">165</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">775</span> <span class="op">?</span> <span class="op">-</span><span class="dv">169</span> <span class="op">:</span> <span class="op">-</span><span class="dv">173</span>))</span>
<span id="cb46-1934"><a href="#cb46-1934" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">33</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">35</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">42</span>))</span>
<span id="cb46-1935"><a href="#cb46-1935" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-1936"><a href="#cb46-1936" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">8</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">.</span><span class="dv">9</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-1937"><a href="#cb46-1937" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb46-1938"><a href="#cb46-1938" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb46-1939"><a href="#cb46-1939" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb46-1940"><a href="#cb46-1940" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb46-1941"><a href="#cb46-1941" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-1942"><a href="#cb46-1942" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day of year"</span>)</span>
<span id="cb46-1943"><a href="#cb46-1943" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">28</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> <span class="dv">22</span>))</span>
<span id="cb46-1944"><a href="#cb46-1944" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> chartHeight <span class="op">/</span> <span class="dv">4</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">275</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">325</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">350</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">375</span> <span class="op">?</span> <span class="dv">30</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">37</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">39</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">475</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">550</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">51</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">650</span> <span class="op">?</span> <span class="dv">50</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">44</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">750</span> <span class="op">?</span> <span class="dv">40</span> <span class="op">:</span> <span class="dv">43</span>))</span>
<span id="cb46-1945"><a href="#cb46-1945" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb46-1946"><a href="#cb46-1946" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-1947"><a href="#cb46-1947" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb46-1948"><a href="#cb46-1948" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span></span>
<span id="cb46-1949"><a href="#cb46-1949" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="fu">yearDates</span>(year)</span>
<span id="cb46-1950"><a href="#cb46-1950" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">,</span> <span class="fu">dayLength</span>(d<span class="op">,</span> latitude)])</span>
<span id="cb46-1951"><a href="#cb46-1951" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(([_<span class="op">,</span> d]) <span class="kw">=&gt;</span> d <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb46-1952"><a href="#cb46-1952" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Render separate polygons for each continuous sequence of</span></span>
<span id="cb46-1953"><a href="#cb46-1953" aria-hidden="true" tabindex="-1"></a><span class="co">   * days with more than 0 hours of day light</span></span>
<span id="cb46-1954"><a href="#cb46-1954" aria-hidden="true" tabindex="-1"></a><span class="co">   */</span></span>
<span id="cb46-1955"><a href="#cb46-1955" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> polys <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb46-1956"><a href="#cb46-1956" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> currentPoly <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb46-1957"><a href="#cb46-1957" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> data<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb46-1958"><a href="#cb46-1958" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> currentDate <span class="op">=</span> data[i][<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb46-1959"><a href="#cb46-1959" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> prevDate <span class="op">=</span> (data[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">||</span> [])[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb46-1960"><a href="#cb46-1960" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (</span>
<span id="cb46-1961"><a href="#cb46-1961" aria-hidden="true" tabindex="-1"></a>      i <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span></span>
<span id="cb46-1962"><a href="#cb46-1962" aria-hidden="true" tabindex="-1"></a>      currentDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> prevDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">&lt;</span> <span class="dv">3600</span> <span class="op">*</span> <span class="dv">24</span> <span class="op">*</span> <span class="dv">1000</span> <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb46-1963"><a href="#cb46-1963" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb46-1964"><a href="#cb46-1964" aria-hidden="true" tabindex="-1"></a>      currentPoly<span class="op">.</span><span class="fu">push</span>(data[i])<span class="op">;</span></span>
<span id="cb46-1965"><a href="#cb46-1965" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb46-1966"><a href="#cb46-1966" aria-hidden="true" tabindex="-1"></a>      polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb46-1967"><a href="#cb46-1967" aria-hidden="true" tabindex="-1"></a>      currentPoly <span class="op">=</span> [data[i]]<span class="op">;</span></span>
<span id="cb46-1968"><a href="#cb46-1968" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-1969"><a href="#cb46-1969" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-1970"><a href="#cb46-1970" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">push</span>(currentPoly)<span class="op">;</span></span>
<span id="cb46-1971"><a href="#cb46-1971" aria-hidden="true" tabindex="-1"></a>  polys<span class="op">.</span><span class="fu">forEach</span>((p) <span class="kw">=&gt;</span> {</span>
<span id="cb46-1972"><a href="#cb46-1972" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> points <span class="op">=</span> [</span>
<span id="cb46-1973"><a href="#cb46-1973" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">-</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">,</span></span>
<span id="cb46-1974"><a href="#cb46-1974" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>p<span class="op">.</span><span class="fu">reverse</span>()<span class="op">.</span><span class="fu">map</span>(([d<span class="op">,</span> l]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">xScale</span>(d)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">yScale</span>(<span class="dv">12</span> <span class="op">+</span> l <span class="op">/</span> <span class="dv">2</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb46-1975"><a href="#cb46-1975" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">.</span><span class="fu">join</span>(<span class="st">" "</span>)<span class="op">;</span></span>
<span id="cb46-1976"><a href="#cb46-1976" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"polygon"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"points"</span><span class="op">,</span> points)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb46-1977"><a href="#cb46-1977" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb46-1978"><a href="#cb46-1978" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Legend */</span></span>
<span id="cb46-1979"><a href="#cb46-1979" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> <span class="bu">root</span></span>
<span id="cb46-1980"><a href="#cb46-1980" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb46-1981"><a href="#cb46-1981" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> chartWidth <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">64</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb46-1982"><a href="#cb46-1982" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb46-1983"><a href="#cb46-1983" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb46-1984"><a href="#cb46-1984" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">63</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">62</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">61</span> <span class="op">:</span> <span class="dv">60</span>)</span>
<span id="cb46-1985"><a href="#cb46-1985" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb46-1986"><a href="#cb46-1986" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb46-1987"><a href="#cb46-1987" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-1988"><a href="#cb46-1988" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-1989"><a href="#cb46-1989" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">day</span>)<span class="op">;</span></span>
<span id="cb46-1990"><a href="#cb46-1990" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb46-1991"><a href="#cb46-1991" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-1992"><a href="#cb46-1992" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">82</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">85</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">87</span> <span class="op">:</span> <span class="dv">90</span>)</span>
<span id="cb46-1993"><a href="#cb46-1993" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb46-1994"><a href="#cb46-1994" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-1995"><a href="#cb46-1995" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb46-1996"><a href="#cb46-1996" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Day"</span>)<span class="op">;</span></span>
<span id="cb46-1997"><a href="#cb46-1997" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb46-1998"><a href="#cb46-1998" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb46-1999"><a href="#cb46-1999" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="op">-</span><span class="dv">10</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="op">-</span><span class="dv">20</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">40</span> <span class="op">:</span> <span class="op">-</span><span class="dv">39</span>)</span>
<span id="cb46-2000"><a href="#cb46-2000" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">8</span> <span class="op">:</span> <span class="dv">1</span>)</span>
<span id="cb46-2001"><a href="#cb46-2001" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb46-2002"><a href="#cb46-2002" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-2003"><a href="#cb46-2003" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-2004"><a href="#cb46-2004" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> mapcolors<span class="op">.</span><span class="at">night</span>)<span class="op">;</span></span>
<span id="cb46-2005"><a href="#cb46-2005" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb46-2006"><a href="#cb46-2006" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb46-2007"><a href="#cb46-2007" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">11</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="op">-</span><span class="dv">12</span> <span class="op">:</span> <span class="op">-</span><span class="dv">9</span>)</span>
<span id="cb46-2008"><a href="#cb46-2008" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="dv">22</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">23</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">450</span> <span class="op">?</span> <span class="dv">24</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">18</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="dv">19</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="dv">21</span> <span class="op">:</span> <span class="dv">23</span>)</span>
<span id="cb46-2009"><a href="#cb46-2009" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> fontSize <span class="op">*</span> (width <span class="op">&lt;</span> <span class="dv">300</span> <span class="op">?</span> <span class="op">.</span><span class="dv">95</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">400</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="fl">1.05</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">600</span> <span class="op">?</span> <span class="fl">1.15</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">700</span> <span class="op">?</span> <span class="fl">1.2</span> <span class="op">:</span> <span class="fl">1.25</span>) <span class="op">+</span> width <span class="op">/</span> <span class="dv">100</span>)</span>
<span id="cb46-2010"><a href="#cb46-2010" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"sans-serif"</span>)</span>
<span id="cb46-2011"><a href="#cb46-2011" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Night"</span>)<span class="op">;</span></span>
<span id="cb46-2012"><a href="#cb46-2012" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* Time and date controls */</span></span>
<span id="cb46-2013"><a href="#cb46-2013" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dateLine <span class="op">=</span> <span class="bu">root</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb46-2014"><a href="#cb46-2014" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updateControlPositions <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb46-2015"><a href="#cb46-2015" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb46-2016"><a href="#cb46-2016" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"line"</span>)</span>
<span id="cb46-2017"><a href="#cb46-2017" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb46-2018"><a href="#cb46-2018" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="fu">xScale</span>(date))</span>
<span id="cb46-2019"><a href="#cb46-2019" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">24</span>))</span>
<span id="cb46-2020"><a href="#cb46-2020" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb46-2021"><a href="#cb46-2021" aria-hidden="true" tabindex="-1"></a>    dateLine</span>
<span id="cb46-2022"><a href="#cb46-2022" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"rect"</span>)</span>
<span id="cb46-2023"><a href="#cb46-2023" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb46-2024"><a href="#cb46-2024" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">xScale</span>(date) <span class="op">-</span> <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb46-2025"><a href="#cb46-2025" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span></span>
<span id="cb46-2026"><a href="#cb46-2026" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">"#time-control"</span>)</span>
<span id="cb46-2027"><a href="#cb46-2027" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="fu">yScale</span>(hour))</span>
<span id="cb46-2028"><a href="#cb46-2028" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="fu">xScale</span>(date))<span class="op">;</span></span>
<span id="cb46-2029"><a href="#cb46-2029" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb46-2030"><a href="#cb46-2030" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dispatchDateHourChange <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb46-2031"><a href="#cb46-2031" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> detail <span class="op">=</span> { date<span class="op">,</span> hour }<span class="op">;</span></span>
<span id="cb46-2032"><a href="#cb46-2032" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> changeEvent <span class="op">=</span> <span class="kw">new</span> <span class="bu">CustomEvent</span>(EventType<span class="op">.</span><span class="at">DateHourChange</span><span class="op">,</span> {</span>
<span id="cb46-2033"><a href="#cb46-2033" aria-hidden="true" tabindex="-1"></a>      detail<span class="op">,</span></span>
<span id="cb46-2034"><a href="#cb46-2034" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb46-2035"><a href="#cb46-2035" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb46-2036"><a href="#cb46-2036" aria-hidden="true" tabindex="-1"></a>    <span class="bu">root</span><span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">dispatchEvent</span>(changeEvent)<span class="op">;</span></span>
<span id="cb46-2037"><a href="#cb46-2037" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb46-2038"><a href="#cb46-2038" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleDateLineDrag <span class="op">=</span> ({ x }) <span class="kw">=&gt;</span> {</span>
<span id="cb46-2039"><a href="#cb46-2039" aria-hidden="true" tabindex="-1"></a>    date <span class="op">=</span> xScale<span class="op">.</span><span class="fu">invert</span>(x)<span class="op">;</span></span>
<span id="cb46-2040"><a href="#cb46-2040" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb46-2041"><a href="#cb46-2041" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb46-2042"><a href="#cb46-2042" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb46-2043"><a href="#cb46-2043" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handleTimeCircleDrag <span class="op">=</span> ({ y }) <span class="kw">=&gt;</span> {</span>
<span id="cb46-2044"><a href="#cb46-2044" aria-hidden="true" tabindex="-1"></a>    hour <span class="op">=</span> yScale<span class="op">.</span><span class="fu">invert</span>(y)<span class="op">;</span></span>
<span id="cb46-2045"><a href="#cb46-2045" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb46-2046"><a href="#cb46-2046" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatchDateHourChange</span>()<span class="op">;</span></span>
<span id="cb46-2047"><a href="#cb46-2047" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb46-2048"><a href="#cb46-2048" aria-hidden="true" tabindex="-1"></a>  dateLine<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb46-2049"><a href="#cb46-2049" aria-hidden="true" tabindex="-1"></a>  dateLine</span>
<span id="cb46-2050"><a href="#cb46-2050" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb46-2051"><a href="#cb46-2051" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> chartWidth)</span>
<span id="cb46-2052"><a href="#cb46-2052" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb46-2053"><a href="#cb46-2053" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"rgba(0, 0, 0, 0)"</span>)</span>
<span id="cb46-2054"><a href="#cb46-2054" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"row-resize"</span>)</span>
<span id="cb46-2055"><a href="#cb46-2055" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleDateLineDrag))<span class="op">;</span></span>
<span id="cb46-2056"><a href="#cb46-2056" aria-hidden="true" tabindex="-1"></a>  <span class="bu">root</span></span>
<span id="cb46-2057"><a href="#cb46-2057" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb46-2058"><a href="#cb46-2058" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"time-control"</span>)</span>
<span id="cb46-2059"><a href="#cb46-2059" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">12</span>)</span>
<span id="cb46-2060"><a href="#cb46-2060" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"red"</span>)</span>
<span id="cb46-2061"><a href="#cb46-2061" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="op">.</span><span class="dv">6</span>)</span>
<span id="cb46-2062"><a href="#cb46-2062" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb46-2063"><a href="#cb46-2063" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"pointer"</span>)</span>
<span id="cb46-2064"><a href="#cb46-2064" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">drag</span>()<span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> handleTimeCircleDrag))<span class="op">;</span></span>
<span id="cb46-2065"><a href="#cb46-2065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateControlPositions</span>()<span class="op">;</span></span>
<span id="cb46-2066"><a href="#cb46-2066" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2067"><a href="#cb46-2067" aria-hidden="true" tabindex="-1"></a>fontSize <span class="op">=</span> <span class="dv">14</span><span class="op">;</span></span>
<span id="cb46-2068"><a href="#cb46-2068" aria-hidden="true" tabindex="-1"></a>getSolarAngle <span class="op">=</span> (date) <span class="kw">=&gt;</span> (<span class="fu">dayOfYear</span>(date) <span class="op">+</span> <span class="dv">10</span>) <span class="op">/</span> <span class="dv">365</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb46-2069"><a href="#cb46-2069" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb46-2070"><a href="#cb46-2070" aria-hidden="true" tabindex="-1"></a><span class="co"> * Formulas uses the CBM model as reviewed here:</span></span>
<span id="cb46-2071"><a href="#cb46-2071" aria-hidden="true" tabindex="-1"></a><span class="co"> * https://www.ikhebeenvraag.be/mediastorage/FSDocument/171/Forsythe+-+A+model+comparison+for+daylength+as+a+function+of+latitude+and+day+of+year+-+1995.pdf</span></span>
<span id="cb46-2072"><a href="#cb46-2072" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb46-2073"><a href="#cb46-2073" aria-hidden="true" tabindex="-1"></a>dayLength <span class="op">=</span> (date<span class="op">,</span> latitude) <span class="kw">=&gt;</span> {</span>
<span id="cb46-2074"><a href="#cb46-2074" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yearStart <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(date<span class="op">.</span><span class="fu">getFullYear</span>()<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb46-2075"><a href="#cb46-2075" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dayOfYear <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((date<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> yearStart<span class="op">.</span><span class="fu">getTime</span>())<span class="op">/</span><span class="dv">86400000</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-2076"><a href="#cb46-2076" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> revAngle <span class="op">=</span> <span class="fl">0.2163108</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>(<span class="fl">0.9671396</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">tan</span>(<span class="fl">0.00860</span> <span class="op">*</span> (dayOfYear <span class="op">-</span> <span class="dv">186</span>)))<span class="op">;</span></span>
<span id="cb46-2077"><a href="#cb46-2077" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> decAngle <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">asin</span>(<span class="fl">0.39795</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(revAngle))<span class="op">;</span></span>
<span id="cb46-2078"><a href="#cb46-2078" aria-hidden="true" tabindex="-1"></a>  <span class="co">/* daylight coefficient selected for apparent sunrise/sunset */</span></span>
<span id="cb46-2079"><a href="#cb46-2079" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> p <span class="op">=</span> <span class="fl">0.8333</span></span>
<span id="cb46-2080"><a href="#cb46-2080" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> intResult <span class="op">=</span></span>
<span id="cb46-2081"><a href="#cb46-2081" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((p <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">+</span></span>
<span id="cb46-2082"><a href="#cb46-2082" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sin</span>(decAngle)) <span class="op">/</span></span>
<span id="cb46-2083"><a href="#cb46-2083" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>((latitude <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>) <span class="op">/</span> <span class="dv">180</span>) <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">cos</span>(decAngle))<span class="op">;</span></span>
<span id="cb46-2084"><a href="#cb46-2084" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&gt;=</span> <span class="dv">1</span>) <span class="cf">return</span> <span class="dv">24</span><span class="op">;</span></span>
<span id="cb46-2085"><a href="#cb46-2085" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intResult <span class="op">&lt;=</span> <span class="op">-</span><span class="dv">1</span>) <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb46-2086"><a href="#cb46-2086" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">24</span> <span class="op">-</span> <span class="dv">24</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">acos</span>(intResult) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb46-2087"><a href="#cb46-2087" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2088"><a href="#cb46-2088" aria-hidden="true" tabindex="-1"></a>yearDates <span class="op">=</span> (year) <span class="kw">=&gt;</span> {</span>
<span id="cb46-2089"><a href="#cb46-2089" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> startDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb46-2090"><a href="#cb46-2090" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> endDate <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(year <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">+</span><span class="dv">60</span>)<span class="op">;</span></span>
<span id="cb46-2091"><a href="#cb46-2091" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d3<span class="op">.</span><span class="at">timeDay</span><span class="op">.</span><span class="fu">range</span>(startDate<span class="op">,</span> endDate)<span class="op">;</span></span>
<span id="cb46-2092"><a href="#cb46-2092" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2093"><a href="#cb46-2093" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="fl">0.65</span> <span class="op">*</span> width<span class="op">;</span></span>
<span id="cb46-2094"><a href="#cb46-2094" aria-hidden="true" tabindex="-1"></a>EventType <span class="op">=</span> ({</span>
<span id="cb46-2095"><a href="#cb46-2095" aria-hidden="true" tabindex="-1"></a>  <span class="dt">LocationChange</span><span class="op">:</span> <span class="st">"LOCATION_CHANGE"</span><span class="op">,</span></span>
<span id="cb46-2096"><a href="#cb46-2096" aria-hidden="true" tabindex="-1"></a>  <span class="dt">DateHourChange</span><span class="op">:</span> <span class="st">"DATE_HOUR_CHANGE"</span></span>
<span id="cb46-2097"><a href="#cb46-2097" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-2098"><a href="#cb46-2098" aria-hidden="true" tabindex="-1"></a>mapcolors <span class="op">=</span> ({</span>
<span id="cb46-2099"><a href="#cb46-2099" aria-hidden="true" tabindex="-1"></a>  <span class="dt">night</span><span class="op">:</span> <span class="st">"#719fb6"</span><span class="op">,</span></span>
<span id="cb46-2100"><a href="#cb46-2100" aria-hidden="true" tabindex="-1"></a>  <span class="dt">day</span><span class="op">:</span> <span class="st">"#ffe438"</span><span class="op">,</span></span>
<span id="cb46-2101"><a href="#cb46-2101" aria-hidden="true" tabindex="-1"></a>  <span class="dt">grid</span><span class="op">:</span> <span class="st">"#4b6a79"</span><span class="op">,</span></span>
<span id="cb46-2102"><a href="#cb46-2102" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ocean</span><span class="op">:</span> <span class="st">"#adeeff"</span><span class="op">,</span></span>
<span id="cb46-2103"><a href="#cb46-2103" aria-hidden="true" tabindex="-1"></a>  <span class="dt">land</span><span class="op">:</span> <span class="st">"#90ff7888"</span><span class="op">,</span></span>
<span id="cb46-2104"><a href="#cb46-2104" aria-hidden="true" tabindex="-1"></a>  <span class="dt">sun</span><span class="op">:</span> <span class="st">"#ffb438"</span></span>
<span id="cb46-2105"><a href="#cb46-2105" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-2106"><a href="#cb46-2106" aria-hidden="true" tabindex="-1"></a>toRadians <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">/</span> <span class="dv">180</span></span>
<span id="cb46-2107"><a href="#cb46-2107" aria-hidden="true" tabindex="-1"></a>toDegrees <span class="op">=</span> (val) <span class="kw">=&gt;</span> val <span class="op">*</span> <span class="dv">180</span> <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span><span class="op">;</span></span>
<span id="cb46-2108"><a href="#cb46-2108" aria-hidden="true" tabindex="-1"></a>land <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(world<span class="op">,</span> world<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">land</span>)<span class="op">;</span></span>
<span id="cb46-2109"><a href="#cb46-2109" aria-hidden="true" tabindex="-1"></a>d3 <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3@7"</span><span class="op">,</span> <span class="st">"d3-geo-projection@3"</span>)</span>
<span id="cb46-2110"><a href="#cb46-2110" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">input</span>(config) {</span>
<span id="cb46-2111"><a href="#cb46-2111" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> {</span>
<span id="cb46-2112"><a href="#cb46-2112" aria-hidden="true" tabindex="-1"></a>    form<span class="op">,</span></span>
<span id="cb46-2113"><a href="#cb46-2113" aria-hidden="true" tabindex="-1"></a>    type <span class="op">=</span> <span class="st">"text"</span><span class="op">,</span></span>
<span id="cb46-2114"><a href="#cb46-2114" aria-hidden="true" tabindex="-1"></a>    attributes <span class="op">=</span> {}<span class="op">,</span></span>
<span id="cb46-2115"><a href="#cb46-2115" aria-hidden="true" tabindex="-1"></a>    action<span class="op">,</span></span>
<span id="cb46-2116"><a href="#cb46-2116" aria-hidden="true" tabindex="-1"></a>    getValue<span class="op">,</span></span>
<span id="cb46-2117"><a href="#cb46-2117" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb46-2118"><a href="#cb46-2118" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb46-2119"><a href="#cb46-2119" aria-hidden="true" tabindex="-1"></a>    format<span class="op">,</span></span>
<span id="cb46-2120"><a href="#cb46-2120" aria-hidden="true" tabindex="-1"></a>    display<span class="op">,</span></span>
<span id="cb46-2121"><a href="#cb46-2121" aria-hidden="true" tabindex="-1"></a>    submit<span class="op">,</span></span>
<span id="cb46-2122"><a href="#cb46-2122" aria-hidden="true" tabindex="-1"></a>    options</span>
<span id="cb46-2123"><a href="#cb46-2123" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> config<span class="op">;</span></span>
<span id="cb46-2124"><a href="#cb46-2124" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> wrapper <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb46-2125"><a href="#cb46-2125" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>form)</span>
<span id="cb46-2126"><a href="#cb46-2126" aria-hidden="true" tabindex="-1"></a>    form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form&gt;</span></span>
<span id="cb46-2127"><a href="#cb46-2127" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;input name=input type=</span><span class="sc">${</span>type<span class="sc">}</span><span class="vs"> /&gt;</span></span>
<span id="cb46-2128"><a href="#cb46-2128" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb46-2129"><a href="#cb46-2129" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(attributes)<span class="op">.</span><span class="fu">forEach</span>(key <span class="kw">=&gt;</span> {</span>
<span id="cb46-2130"><a href="#cb46-2130" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> val <span class="op">=</span> attributes[key]<span class="op">;</span></span>
<span id="cb46-2131"><a href="#cb46-2131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="op">!=</span> <span class="kw">null</span>) form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="fu">setAttribute</span>(key<span class="op">,</span> val)<span class="op">;</span></span>
<span id="cb46-2132"><a href="#cb46-2132" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb46-2133"><a href="#cb46-2133" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (submit)</span>
<span id="cb46-2134"><a href="#cb46-2134" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb46-2135"><a href="#cb46-2135" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;input name=submit type=submit style="margin: 0 0.75em" value="</span><span class="sc">${</span></span>
<span id="cb46-2136"><a href="#cb46-2136" aria-hidden="true" tabindex="-1"></a>        <span class="kw">typeof</span> submit <span class="op">==</span> <span class="st">"string"</span> <span class="op">?</span> submit <span class="op">:</span> <span class="st">"Submit"</span></span>
<span id="cb46-2137"><a href="#cb46-2137" aria-hidden="true" tabindex="-1"></a>      <span class="sc">}</span><span class="vs">" /&gt;`</span></span>
<span id="cb46-2138"><a href="#cb46-2138" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb46-2139"><a href="#cb46-2139" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb46-2140"><a href="#cb46-2140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html</span><span class="vs">`&lt;output name=output style="font: 14px Menlo, Consolas, monospace; margin-left: 0.1em; text-align:center;"&gt;&lt;/output&gt;`</span></span>
<span id="cb46-2141"><a href="#cb46-2141" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb46-2142"><a href="#cb46-2142" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (title)</span>
<span id="cb46-2143"><a href="#cb46-2143" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">prepend</span>(</span>
<span id="cb46-2144"><a href="#cb46-2144" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font: 700 0.9rem sans-serif; margin-bottom: 3px;"&gt;</span><span class="sc">${</span>title<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb46-2145"><a href="#cb46-2145" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb46-2146"><a href="#cb46-2146" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (description)</span>
<span id="cb46-2147"><a href="#cb46-2147" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="fu">append</span>(</span>
<span id="cb46-2148"><a href="#cb46-2148" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html</span><span class="vs">`&lt;div style="font-size: 0.85rem; font-style: italic; margin-top: 3px;"&gt;</span><span class="sc">${</span>description<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb46-2149"><a href="#cb46-2149" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb46-2150"><a href="#cb46-2150" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (format)</span>
<span id="cb46-2151"><a href="#cb46-2151" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> <span class="kw">typeof</span> format <span class="op">===</span> <span class="st">"function"</span> <span class="op">?</span> format <span class="op">:</span> d3format<span class="op">.</span><span class="fu">format</span>(format)<span class="op">;</span></span>
<span id="cb46-2152"><a href="#cb46-2152" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (action) {</span>
<span id="cb46-2153"><a href="#cb46-2153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">action</span>(form)<span class="op">;</span></span>
<span id="cb46-2154"><a href="#cb46-2154" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb46-2155"><a href="#cb46-2155" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> verb <span class="op">=</span> submit</span>
<span id="cb46-2156"><a href="#cb46-2156" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onsubmit"</span></span>
<span id="cb46-2157"><a href="#cb46-2157" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"button"</span></span>
<span id="cb46-2158"><a href="#cb46-2158" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onclick"</span></span>
<span id="cb46-2159"><a href="#cb46-2159" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> type <span class="op">==</span> <span class="st">"checkbox"</span> <span class="op">||</span> type <span class="op">==</span> <span class="st">"radio"</span></span>
<span id="cb46-2160"><a href="#cb46-2160" aria-hidden="true" tabindex="-1"></a>      <span class="op">?</span> <span class="st">"onchange"</span></span>
<span id="cb46-2161"><a href="#cb46-2161" aria-hidden="true" tabindex="-1"></a>      <span class="op">:</span> <span class="st">"oninput"</span><span class="op">;</span></span>
<span id="cb46-2162"><a href="#cb46-2162" aria-hidden="true" tabindex="-1"></a>    form[verb] <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb46-2163"><a href="#cb46-2163" aria-hidden="true" tabindex="-1"></a>      e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb46-2164"><a href="#cb46-2164" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> value <span class="op">=</span> getValue <span class="op">?</span> <span class="fu">getValue</span>(form<span class="op">.</span><span class="at">input</span>) <span class="op">:</span> form<span class="op">.</span><span class="at">input</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb46-2165"><a href="#cb46-2165" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (form<span class="op">.</span><span class="at">output</span>) {</span>
<span id="cb46-2166"><a href="#cb46-2166" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> out <span class="op">=</span> display <span class="op">?</span> <span class="fu">display</span>(value) <span class="op">:</span> format <span class="op">?</span> <span class="fu">format</span>(value) <span class="op">:</span> value<span class="op">;</span></span>
<span id="cb46-2167"><a href="#cb46-2167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (out <span class="kw">instanceof</span> <span class="bu">window</span><span class="op">.</span><span class="at">Element</span>) {</span>
<span id="cb46-2168"><a href="#cb46-2168" aria-hidden="true" tabindex="-1"></a>          <span class="cf">while</span> (form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">hasChildNodes</span>()) {</span>
<span id="cb46-2169"><a href="#cb46-2169" aria-hidden="true" tabindex="-1"></a>            form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">removeChild</span>(form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">lastChild</span>)<span class="op">;</span></span>
<span id="cb46-2170"><a href="#cb46-2170" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb46-2171"><a href="#cb46-2171" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="fu">append</span>(out)<span class="op">;</span></span>
<span id="cb46-2172"><a href="#cb46-2172" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb46-2173"><a href="#cb46-2173" aria-hidden="true" tabindex="-1"></a>          form<span class="op">.</span><span class="at">output</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> out<span class="op">;</span></span>
<span id="cb46-2174"><a href="#cb46-2174" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb46-2175"><a href="#cb46-2175" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb46-2176"><a href="#cb46-2176" aria-hidden="true" tabindex="-1"></a>      form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb46-2177"><a href="#cb46-2177" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb46-2178"><a href="#cb46-2178" aria-hidden="true" tabindex="-1"></a>        form<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb46-2179"><a href="#cb46-2179" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb46-2180"><a href="#cb46-2180" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"oninput"</span>)</span>
<span id="cb46-2181"><a href="#cb46-2181" aria-hidden="true" tabindex="-1"></a>      wrapper<span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">stopPropagation</span>() <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb46-2182"><a href="#cb46-2182" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (verb <span class="op">!==</span> <span class="st">"onsubmit"</span>) form<span class="op">.</span><span class="at">onsubmit</span> <span class="op">=</span> e <span class="kw">=&gt;</span> e <span class="op">&amp;&amp;</span> e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb46-2183"><a href="#cb46-2183" aria-hidden="true" tabindex="-1"></a>    form[verb]()<span class="op">;</span></span>
<span id="cb46-2184"><a href="#cb46-2184" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2185"><a href="#cb46-2185" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (form<span class="op">.</span><span class="at">childNodes</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb46-2186"><a href="#cb46-2186" aria-hidden="true" tabindex="-1"></a>    wrapper<span class="op">.</span><span class="fu">appendChild</span>(form<span class="op">.</span><span class="at">childNodes</span>[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb46-2187"><a href="#cb46-2187" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2188"><a href="#cb46-2188" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="fu">append</span>(wrapper)<span class="op">;</span></span>
<span id="cb46-2189"><a href="#cb46-2189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb46-2190"><a href="#cb46-2190" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2191"><a href="#cb46-2191" aria-hidden="true" tabindex="-1"></a>d3format <span class="op">=</span> <span class="pp">require</span>(<span class="st">"d3-format@1"</span>)</span>
<span id="cb46-2192"><a href="#cb46-2192" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@enjalot/draggable-world-map-coordinates-input</span></span>
<span id="cb46-2193"><a href="#cb46-2193" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">worldMapCoordinates</span>(config <span class="op">=</span> {}<span class="op">,</span> dimensions) {</span>
<span id="cb46-2194"><a href="#cb46-2194" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb46-2195"><a href="#cb46-2195" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> []<span class="op">,</span> title<span class="op">,</span> description<span class="op">,</span> width <span class="op">=</span> dimensions[<span class="dv">0</span>]</span>
<span id="cb46-2196"><a href="#cb46-2196" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(config) <span class="op">?</span> {<span class="dt">value</span><span class="op">:</span> config} <span class="op">:</span> config<span class="op">;</span></span>
<span id="cb46-2197"><a href="#cb46-2197" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> dimensions[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb46-2198"><a href="#cb46-2198" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> [lon<span class="op">,</span> lat] <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb46-2199"><a href="#cb46-2199" aria-hidden="true" tabindex="-1"></a>  lon <span class="op">=</span> lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb46-2200"><a href="#cb46-2200" aria-hidden="true" tabindex="-1"></a>  lat <span class="op">=</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb46-2201"><a href="#cb46-2201" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formEl <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form id="formEl" style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px;"&gt;&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb46-2202"><a href="#cb46-2202" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> context <span class="op">=</span> DOM<span class="op">.</span><span class="fu">context2d</span>(width<span class="op">,</span> height<span class="op">-</span>width<span class="op">/</span><span class="dv">14</span>)<span class="op">;</span></span>
<span id="cb46-2203"><a href="#cb46-2203" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> canvas <span class="op">=</span> context<span class="op">.</span><span class="at">canvas</span><span class="op">;</span></span>
<span id="cb46-2204"><a href="#cb46-2204" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">margin</span> <span class="op">=</span> <span class="vs">`0px 0px -26px 0px`</span><span class="op">;</span></span>
<span id="cb46-2205"><a href="#cb46-2205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb46-2206"><a href="#cb46-2206" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoEquirectangular</span>()</span>
<span id="cb46-2207"><a href="#cb46-2207" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">precision</span>(<span class="fl">0.1</span>)</span>
<span id="cb46-2208"><a href="#cb46-2208" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitSize</span>([width<span class="op">,</span> height]<span class="op">,</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span> })<span class="op">.</span><span class="fu">rotate</span>([<span class="op">-</span><span class="dv">153</span><span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb46-2209"><a href="#cb46-2209" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection<span class="op">,</span> context)<span class="op">.</span><span class="fu">pointRadius</span>(<span class="fl">2.5</span>)<span class="op">;</span></span>
<span id="cb46-2210"><a href="#cb46-2210" aria-hidden="true" tabindex="-1"></a>  formEl<span class="op">.</span><span class="fu">append</span>(canvas)<span class="op">;</span></span>
<span id="cb46-2211"><a href="#cb46-2211" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">draw</span>() {</span>
<span id="cb46-2212"><a href="#cb46-2212" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">;</span></span>
<span id="cb46-2213"><a href="#cb46-2213" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fillRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb46-2214"><a href="#cb46-2214" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Sphere"</span>})<span class="op">;</span></span>
<span id="cb46-2215"><a href="#cb46-2215" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#007FFF"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">ocean</span><span class="op">;</span></span>
<span id="cb46-2216"><a href="#cb46-2216" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb46-2217"><a href="#cb46-2217" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb46-2218"><a href="#cb46-2218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(graticule)<span class="op">;</span></span>
<span id="cb46-2219"><a href="#cb46-2219" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">;</span></span>
<span id="cb46-2220"><a href="#cb46-2220" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="vs">`#aaa`</span><span class="op">;</span></span>
<span id="cb46-2221"><a href="#cb46-2221" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb46-2222"><a href="#cb46-2222" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb46-2223"><a href="#cb46-2223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(land)<span class="op">;</span></span>
<span id="cb46-2224"><a href="#cb46-2224" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#0808"</span> <span class="op">:</span> mapcolors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb46-2225"><a href="#cb46-2225" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb46-2226"><a href="#cb46-2226" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span></span>
<span id="cb46-2227"><a href="#cb46-2227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">path</span>(countries)<span class="op">;</span></span>
<span id="cb46-2228"><a href="#cb46-2228" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="op">.</span><span class="dv">95</span><span class="op">;</span></span>
<span id="cb46-2229"><a href="#cb46-2229" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#aaa"</span> <span class="op">:</span> <span class="st">"#333"</span><span class="op">;</span></span>
<span id="cb46-2230"><a href="#cb46-2230" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb46-2231"><a href="#cb46-2231" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"#fff"</span> <span class="op">:</span> <span class="st">"#000"</span><span class="op">;</span></span>
<span id="cb46-2232"><a href="#cb46-2232" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="at">font</span> <span class="op">=</span> width <span class="op">&lt;</span> <span class="dv">760</span> <span class="op">?</span> <span class="st">"14px serif"</span> <span class="op">:</span> width <span class="op">&lt;</span> <span class="dv">990</span> <span class="op">?</span> <span class="st">"17px serif"</span> <span class="op">:</span> <span class="st">"23px serif"</span><span class="op">;</span></span>
<span id="cb46-2233"><a href="#cb46-2233" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="dv">82</span> <span class="op">-</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">8.8</span>])))<span class="op">;</span></span>
<span id="cb46-2234"><a href="#cb46-2234" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="fl">1.5</span><span class="op">,</span> <span class="dv">342</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">36</span>)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span>  context<span class="op">.</span><span class="fu">fillText</span>(<span class="fu">long2zone</span>(x)<span class="op">,</span> <span class="op">...</span><span class="fu">projection</span>([x<span class="op">,</span> <span class="op">-</span><span class="dv">66</span> <span class="op">+</span> (width <span class="op">&lt;</span> <span class="dv">500</span>) <span class="op">*</span> <span class="fl">1.1</span>])))<span class="op">;</span></span>
<span id="cb46-2235"><a href="#cb46-2235" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">,</span> <span class="fu">path</span>(night)<span class="op">,</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"rgba(0,0,255,0.1)"</span><span class="op">,</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb46-2236"><a href="#cb46-2236" aria-hidden="true" tabindex="-1"></a>    context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> sun})<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"#0008"</span><span class="op">;</span> context<span class="op">.</span><span class="at">fillStyle</span> <span class="op">=</span> <span class="st">"#ff08"</span><span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span> context<span class="op">.</span><span class="fu">fill</span>()<span class="op">;</span></span>
<span id="cb46-2237"><a href="#cb46-2237" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> lat <span class="op">!=</span> <span class="kw">null</span>) {</span>
<span id="cb46-2238"><a href="#cb46-2238" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">17</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">;</span></span>
<span id="cb46-2239"><a href="#cb46-2239" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb46-2240"><a href="#cb46-2240" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="at">lineWidth</span> <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb46-2241"><a href="#cb46-2241" aria-hidden="true" tabindex="-1"></a>      path<span class="op">.</span><span class="fu">pointRadius</span>(<span class="dv">14</span>)<span class="op">;</span> context<span class="op">.</span><span class="at">strokeStyle</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">;</span></span>
<span id="cb46-2242"><a href="#cb46-2242" aria-hidden="true" tabindex="-1"></a>      context<span class="op">.</span><span class="fu">beginPath</span>()<span class="op">;</span> <span class="fu">path</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"Point"</span><span class="op">,</span> <span class="dt">coordinates</span><span class="op">:</span> [lon<span class="op">,</span> lat]})<span class="op">;</span> context<span class="op">.</span><span class="fu">stroke</span>()<span class="op">;</span></span>
<span id="cb46-2243"><a href="#cb46-2243" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-2244"><a href="#cb46-2244" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2245"><a href="#cb46-2245" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> drag <span class="op">=</span> d3<span class="op">.</span><span class="fu">drag</span>()</span>
<span id="cb46-2246"><a href="#cb46-2246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"drag"</span><span class="op">,</span> (<span class="bu">event</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb46-2247"><a href="#cb46-2247" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([<span class="bu">event</span><span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb46-2248"><a href="#cb46-2248" aria-hidden="true" tabindex="-1"></a>      lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb46-2249"><a href="#cb46-2249" aria-hidden="true" tabindex="-1"></a>      lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb46-2250"><a href="#cb46-2250" aria-hidden="true" tabindex="-1"></a>      <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb46-2251"><a href="#cb46-2251" aria-hidden="true" tabindex="-1"></a>      canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb46-2252"><a href="#cb46-2252" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb46-2253"><a href="#cb46-2253" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(canvas)<span class="op">.</span><span class="fu">call</span>(drag)</span>
<span id="cb46-2254"><a href="#cb46-2254" aria-hidden="true" tabindex="-1"></a>  canvas<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span>(ev) {</span>
<span id="cb46-2255"><a href="#cb46-2255" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> { offsetX<span class="op">,</span> offsetY } <span class="op">=</span> ev<span class="op">;</span></span>
<span id="cb46-2256"><a href="#cb46-2256" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> coords <span class="op">=</span> projection<span class="op">.</span><span class="fu">invert</span>([offsetX<span class="op">,</span> offsetY])<span class="op">;</span></span>
<span id="cb46-2257"><a href="#cb46-2257" aria-hidden="true" tabindex="-1"></a>    lon <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb46-2258"><a href="#cb46-2258" aria-hidden="true" tabindex="-1"></a>    lat <span class="op">=</span> <span class="op">+</span>coords[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb46-2259"><a href="#cb46-2259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb46-2260"><a href="#cb46-2260" aria-hidden="true" tabindex="-1"></a>    canvas<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">;</span></span>
<span id="cb46-2261"><a href="#cb46-2261" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb46-2262"><a href="#cb46-2262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb46-2263"><a href="#cb46-2263" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">input</span>({</span>
<span id="cb46-2264"><a href="#cb46-2264" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"worldMapCoordinates"</span><span class="op">,</span></span>
<span id="cb46-2265"><a href="#cb46-2265" aria-hidden="true" tabindex="-1"></a>    title<span class="op">,</span></span>
<span id="cb46-2266"><a href="#cb46-2266" aria-hidden="true" tabindex="-1"></a>    description<span class="op">,</span></span>
<span id="cb46-2267"><a href="#cb46-2267" aria-hidden="true" tabindex="-1"></a>    <span class="dt">display</span><span class="op">:</span> v <span class="kw">=&gt;</span> (width <span class="op">&gt;</span> <span class="dv">300</span>) <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;div style="width: </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px; white-space: nowrap; color: window.darkmode ? #fff : #000; text-align: center; font: </span><span class="sc">${</span>width <span class="op">/</span> <span class="dv">40</span><span class="sc">}</span><span class="vs">px monospace; position: relative; top: </span><span class="sc">${</span><span class="op">-</span><span class="dv">16</span> <span class="op">-</span> width <span class="op">/</span> <span class="dv">50</span><span class="sc">}</span><span class="vs">px;  margin-bottom: -.4em;"&gt;</span></span>
<span id="cb46-2268"><a href="#cb46-2268" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Zone:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> <span class="fu">long2zone</span>(lon) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb46-2269"><a href="#cb46-2269" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb46-2270"><a href="#cb46-2270" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Longitude:&lt;/span&gt; </span><span class="sc">${</span>lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">long2turn</span>(lon))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb46-2271"><a href="#cb46-2271" aria-hidden="true" tabindex="-1"></a><span class="vs">            &amp;nbsp; &amp;nbsp;</span></span>
<span id="cb46-2272"><a href="#cb46-2272" aria-hidden="true" tabindex="-1"></a><span class="vs">            &lt;span style="color: window.darkmode ? #fff : #000;"&gt;Latitude:&lt;/span&gt; </span><span class="sc">${</span>lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> (<span class="fu">lati2turn</span>(lat))<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>) <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb46-2273"><a href="#cb46-2273" aria-hidden="true" tabindex="-1"></a><span class="vs">          &lt;/div&gt;`</span> <span class="op">:</span> <span class="st">''</span><span class="op">,</span></span>
<span id="cb46-2274"><a href="#cb46-2274" aria-hidden="true" tabindex="-1"></a>    <span class="dt">getValue</span><span class="op">:</span> () <span class="kw">=&gt;</span> [lon <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lon <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> lat <span class="op">!=</span> <span class="kw">null</span> <span class="op">?</span> lat <span class="op">:</span> <span class="kw">null</span>]<span class="op">,</span></span>
<span id="cb46-2275"><a href="#cb46-2275" aria-hidden="true" tabindex="-1"></a>    <span class="dt">form</span><span class="op">:</span> formEl</span>
<span id="cb46-2276"><a href="#cb46-2276" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb46-2277"><a href="#cb46-2277" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb46-2278"><a href="#cb46-2278" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2279"><a href="#cb46-2279" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb46-2280"><a href="#cb46-2280" aria-hidden="true" tabindex="-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByClassName</span>(<span class="st">"quarto-color-scheme-toggle"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">function</span> (e) {</span>
<span id="cb46-2281"><a href="#cb46-2281" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">quartoToggleColorScheme</span>()<span class="op">;</span></span>
<span id="cb46-2282"><a href="#cb46-2282" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">"body"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">className</span><span class="op">.</span><span class="fu">match</span>(<span class="ss">/quarto-dark/</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb46-2283"><a href="#cb46-2283" aria-hidden="true" tabindex="-1"></a>  worldMapCoordinates<span class="op">.</span><span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb46-2284"><a href="#cb46-2284" aria-hidden="true" tabindex="-1"></a>  app<span class="op">.</span><span class="fu">drawEarth</span>()<span class="op">;</span></span>
<span id="cb46-2285"><a href="#cb46-2285" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb46-2286"><a href="#cb46-2286" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb46-2287"><a href="#cb46-2287" aria-hidden="true" tabindex="-1"></a>sun <span class="op">=</span> {</span>
<span id="cb46-2288"><a href="#cb46-2288" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> now <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span><span class="op">;</span></span>
<span id="cb46-2289"><a href="#cb46-2289" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> day <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="op">+</span>now)<span class="op">.</span><span class="fu">setUTCHours</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb46-2290"><a href="#cb46-2290" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> t <span class="op">=</span> solar<span class="op">.</span><span class="fu">century</span>(now)<span class="op">;</span></span>
<span id="cb46-2291"><a href="#cb46-2291" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> longitude <span class="op">=</span> (day <span class="op">-</span> now) <span class="op">/</span> <span class="fl">864e5</span> <span class="op">*</span> <span class="dv">360</span> <span class="op">-</span> <span class="dv">180</span><span class="op">;</span></span>
<span id="cb46-2292"><a href="#cb46-2292" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [longitude <span class="op">-</span> solar<span class="op">.</span><span class="fu">equationOfTime</span>(t) <span class="op">/</span> <span class="dv">4</span><span class="op">,</span> solar<span class="op">.</span><span class="fu">declination</span>(t)]<span class="op">;</span></span>
<span id="cb46-2293"><a href="#cb46-2293" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2294"><a href="#cb46-2294" aria-hidden="true" tabindex="-1"></a>night <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoCircle</span>()</span>
<span id="cb46-2295"><a href="#cb46-2295" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">radius</span>(<span class="dv">90</span>)</span>
<span id="cb46-2296"><a href="#cb46-2296" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">center</span>(<span class="fu">antipode</span>(sun))</span>
<span id="cb46-2297"><a href="#cb46-2297" aria-hidden="true" tabindex="-1"></a>  ()</span>
<span id="cb46-2298"><a href="#cb46-2298" aria-hidden="true" tabindex="-1"></a>antipode <span class="op">=</span> ([longitude<span class="op">,</span> latitude]) <span class="kw">=&gt;</span> [longitude <span class="op">+</span> <span class="dv">180</span><span class="op">,</span> <span class="op">-</span>latitude]</span>
<span id="cb46-2299"><a href="#cb46-2299" aria-hidden="true" tabindex="-1"></a>solar <span class="op">=</span> <span class="pp">require</span>(<span class="st">"solar-calculator@0.3/dist/solar-calculator.min.js"</span>)</span>
<span id="cb46-2300"><a href="#cb46-2300" aria-hidden="true" tabindex="-1"></a>viewof fancySecondsOFF <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({</span>
<span id="cb46-2301"><a href="#cb46-2301" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Ticking clock"</span><span class="op">,</span></span>
<span id="cb46-2302"><a href="#cb46-2302" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb46-2303"><a href="#cb46-2303" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb46-2304"><a href="#cb46-2304" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setStyle</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb46-2305"><a href="#cb46-2305" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb46-2306"><a href="#cb46-2306" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb46-2307"><a href="#cb46-2307" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb46-2308"><a href="#cb46-2308" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2309"><a href="#cb46-2309" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb46-2310"><a href="#cb46-2310" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb46-2311"><a href="#cb46-2311" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;=</span> <span class="fl">0.6</span> <span class="op">?</span> <span class="st">"#111"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb46-2312"><a href="#cb46-2312" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 1px"</span><span class="op">,</span></span>
<span id="cb46-2313"><a href="#cb46-2313" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb46-2314"><a href="#cb46-2314" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb46-2315"><a href="#cb46-2315" aria-hidden="true" tabindex="-1"></a>    fontSize <span class="op">=</span> <span class="st">"1em"</span><span class="op">,</span></span>
<span id="cb46-2316"><a href="#cb46-2316" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb46-2317"><a href="#cb46-2317" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb46-2318"><a href="#cb46-2318" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb46-2319"><a href="#cb46-2319" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb46-2320"><a href="#cb46-2320" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb46-2321"><a href="#cb46-2321" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb46-2322"><a href="#cb46-2322" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb46-2323"><a href="#cb46-2323" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb46-2324"><a href="#cb46-2324" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb46-2325"><a href="#cb46-2325" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb46-2326"><a href="#cb46-2326" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2327"><a href="#cb46-2327" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb46-2328"><a href="#cb46-2328" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb46-2329"><a href="#cb46-2329" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb46-2330"><a href="#cb46-2330" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2331"><a href="#cb46-2331" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">textcolor</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb46-2332"><a href="#cb46-2332" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb46-2333"><a href="#cb46-2333" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb46-2334"><a href="#cb46-2334" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"#000"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb46-2335"><a href="#cb46-2335" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 5px"</span><span class="op">,</span></span>
<span id="cb46-2336"><a href="#cb46-2336" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb46-2337"><a href="#cb46-2337" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb46-2338"><a href="#cb46-2338" aria-hidden="true" tabindex="-1"></a>    fontFamily <span class="op">=</span> <span class="st">"monospace"</span><span class="op">,</span></span>
<span id="cb46-2339"><a href="#cb46-2339" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb46-2340"><a href="#cb46-2340" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb46-2341"><a href="#cb46-2341" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb46-2342"><a href="#cb46-2342" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb46-2343"><a href="#cb46-2343" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb46-2344"><a href="#cb46-2344" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb46-2345"><a href="#cb46-2345" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb46-2346"><a href="#cb46-2346" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb46-2347"><a href="#cb46-2347" aria-hidden="true" tabindex="-1"></a>    fontFamily<span class="op">,</span></span>
<span id="cb46-2348"><a href="#cb46-2348" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb46-2349"><a href="#cb46-2349" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb46-2350"><a href="#cb46-2350" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2351"><a href="#cb46-2351" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">isLeapYear</span>(y) {</span>
<span id="cb46-2352"><a href="#cb46-2352" aria-hidden="true" tabindex="-1"></a>  y <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-2353"><a href="#cb46-2353" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> y <span class="op">%</span> <span class="dv">4</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> y <span class="op">%</span> <span class="dv">100</span> <span class="op">!=</span> <span class="dv">0</span> <span class="op">||</span> y <span class="op">%</span> <span class="dv">400</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb46-2354"><a href="#cb46-2354" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2355"><a href="#cb46-2355" aria-hidden="true" tabindex="-1"></a>elapsed <span class="op">=</span> {</span>
<span id="cb46-2356"><a href="#cb46-2356" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb46-2357"><a href="#cb46-2357" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb46-2358"><a href="#cb46-2358" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> Promises<span class="op">.</span><span class="fu">tick</span>(<span class="dv">864</span><span class="op">,</span> <span class="op">++</span>i)<span class="op">;</span></span>
<span id="cb46-2359"><a href="#cb46-2359" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2360"><a href="#cb46-2360" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2361"><a href="#cb46-2361" aria-hidden="true" tabindex="-1"></a>piecewiseColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">piecewise</span>(d3<span class="op">.</span><span class="at">interpolateRgb</span><span class="op">,</span> [</span>
<span id="cb46-2362"><a href="#cb46-2362" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0   0 red</span></span>
<span id="cb46-2363"><a href="#cb46-2363" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f50"</span><span class="op">,</span>    <span class="co">//  0.25  20 yr</span></span>
<span id="cb46-2364"><a href="#cb46-2364" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f60"</span><span class="op">,</span>    <span class="co">//  0.5   24 yr orangered</span></span>
<span id="cb46-2365"><a href="#cb46-2365" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f70"</span><span class="op">,</span>    <span class="co">//  0.75  28 yr</span></span>
<span id="cb46-2366"><a href="#cb46-2366" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f90"</span><span class="op">,</span>    <span class="co">//  1     36 yr orange</span></span>
<span id="cb46-2367"><a href="#cb46-2367" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fb0"</span><span class="op">,</span>    <span class="co">//  1.25  44 yr</span></span>
<span id="cb46-2368"><a href="#cb46-2368" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fc0"</span><span class="op">,</span>    <span class="co">//  1.5   48 yr yelloworange</span></span>
<span id="cb46-2369"><a href="#cb46-2369" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#fd0"</span><span class="op">,</span>    <span class="co">//  1.75  52 yr</span></span>
<span id="cb46-2370"><a href="#cb46-2370" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ff0"</span><span class="op">,</span>    <span class="co">//  2     60 yellow</span></span>
<span id="cb46-2371"><a href="#cb46-2371" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#ef0"</span><span class="op">,</span>    <span class="co">//  2.25  64 gy</span></span>
<span id="cb46-2372"><a href="#cb46-2372" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#df0"</span><span class="op">,</span>    <span class="co">//  2.5   68 gy limeyellow</span></span>
<span id="cb46-2373"><a href="#cb46-2373" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#cf0"</span><span class="op">,</span>    <span class="co">//  2.75  72 gy</span></span>
<span id="cb46-2374"><a href="#cb46-2374" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#af0"</span><span class="op">,</span>    <span class="co">//  3     80 gy lime</span></span>
<span id="cb46-2375"><a href="#cb46-2375" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#8f0"</span><span class="op">,</span>    <span class="co">//  3.25  88 gy</span></span>
<span id="cb46-2376"><a href="#cb46-2376" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#7f0"</span><span class="op">,</span>    <span class="co">//  3.5   92 gy greenlime</span></span>
<span id="cb46-2377"><a href="#cb46-2377" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#6f0"</span><span class="op">,</span>    <span class="co">//  3.75  96 gy</span></span>
<span id="cb46-2378"><a href="#cb46-2378" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f0"</span><span class="op">,</span>    <span class="co">//  4    120 green</span></span>
<span id="cb46-2379"><a href="#cb46-2379" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f7"</span><span class="op">,</span>    <span class="co">//  4.25 148 cg</span></span>
<span id="cb46-2380"><a href="#cb46-2380" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0f9"</span><span class="op">,</span>    <span class="co">//  4.5  156 cg cyangreen</span></span>
<span id="cb46-2381"><a href="#cb46-2381" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0fb"</span><span class="op">,</span>    <span class="co">//  4.75 164 cg</span></span>
<span id="cb46-2382"><a href="#cb46-2382" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0ff"</span><span class="op">,</span>    <span class="co">//  5    180 cyan</span></span>
<span id="cb46-2383"><a href="#cb46-2383" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0cf"</span><span class="op">,</span>    <span class="co">//  5.25 192 bc</span></span>
<span id="cb46-2384"><a href="#cb46-2384" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0bf"</span><span class="op">,</span>    <span class="co">//  5.5  196 bc azurecyan</span></span>
<span id="cb46-2385"><a href="#cb46-2385" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#0af"</span><span class="op">,</span>    <span class="co">//  5.75 200 bc</span></span>
<span id="cb46-2386"><a href="#cb46-2386" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#08f"</span><span class="op">,</span>    <span class="co">//  6    208 bc azure</span></span>
<span id="cb46-2387"><a href="#cb46-2387" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#06f"</span><span class="op">,</span>    <span class="co">//  6.25 216 bc</span></span>
<span id="cb46-2388"><a href="#cb46-2388" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#05f"</span><span class="op">,</span>    <span class="co">//  6.5  220 bc blueazure</span></span>
<span id="cb46-2389"><a href="#cb46-2389" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#04f"</span><span class="op">,</span>    <span class="co">//  6.75 224 bc</span></span>
<span id="cb46-2390"><a href="#cb46-2390" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#00f"</span><span class="op">,</span>    <span class="co">//  7    240 blue</span></span>
<span id="cb46-2391"><a href="#cb46-2391" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#50f"</span><span class="op">,</span>    <span class="co">//  7.25 260 mb</span></span>
<span id="cb46-2392"><a href="#cb46-2392" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#60f"</span><span class="op">,</span>    <span class="co">//  7.5  264 mb purpleblue</span></span>
<span id="cb46-2393"><a href="#cb46-2393" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#70f"</span><span class="op">,</span>    <span class="co">//  7.75 268 mb</span></span>
<span id="cb46-2394"><a href="#cb46-2394" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#90f"</span><span class="op">,</span>    <span class="co">//  8    276 mb purple</span></span>
<span id="cb46-2395"><a href="#cb46-2395" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#b0f"</span><span class="op">,</span>    <span class="co">//  8.25 284 mb</span></span>
<span id="cb46-2396"><a href="#cb46-2396" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#c0f"</span><span class="op">,</span>    <span class="co">//  8.5  288 mb violetpurple</span></span>
<span id="cb46-2397"><a href="#cb46-2397" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#d0f"</span><span class="op">,</span>    <span class="co">//  8.75 292 mb</span></span>
<span id="cb46-2398"><a href="#cb46-2398" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0f"</span><span class="op">,</span>    <span class="co">//  9    300 magenta</span></span>
<span id="cb46-2399"><a href="#cb46-2399" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f0a"</span><span class="op">,</span>    <span class="co">//  9.25 320 rm</span></span>
<span id="cb46-2400"><a href="#cb46-2400" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f08"</span><span class="op">,</span>    <span class="co">//  9.5  328 rm</span></span>
<span id="cb46-2401"><a href="#cb46-2401" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f06"</span><span class="op">,</span>    <span class="co">//  9.75 336 rm</span></span>
<span id="cb46-2402"><a href="#cb46-2402" aria-hidden="true" tabindex="-1"></a>  <span class="st">"#f00"</span><span class="op">,</span>    <span class="co">//  0        0 red</span></span>
<span id="cb46-2403"><a href="#cb46-2403" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb46-2404"><a href="#cb46-2404" aria-hidden="true" tabindex="-1"></a>slStr <span class="op">=</span> <span class="vs">`, 100%, 50%)`</span></span>
<span id="cb46-2405"><a href="#cb46-2405" aria-hidden="true" tabindex="-1"></a>elaTime <span class="op">=</span> elapsed <span class="op">%</span> <span class="fl">1e5</span></span>
<span id="cb46-2406"><a href="#cb46-2406" aria-hidden="true" tabindex="-1"></a>elaTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(elaTime<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(elaTime <span class="op">%</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">1000</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2407"><a href="#cb46-2407" aria-hidden="true" tabindex="-1"></a>decMoty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> decDate <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)</span>
<span id="cb46-2408"><a href="#cb46-2408" aria-hidden="true" tabindex="-1"></a>isoYear <span class="op">=</span> decYear <span class="op">+</span> (decMoty <span class="op">&gt;</span> <span class="dv">9</span>)</span>
<span id="cb46-2409"><a href="#cb46-2409" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> decMoty <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> decMoty <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> decMoty <span class="op">-</span> <span class="dv">9</span></span>
<span id="cb46-2410"><a href="#cb46-2410" aria-hidden="true" tabindex="-1"></a>decHour <span class="op">=</span> decTime <span class="op">*</span> <span class="dv">24</span></span>
<span id="cb46-2411"><a href="#cb46-2411" aria-hidden="true" tabindex="-1"></a>decMinute <span class="op">=</span> (decHour <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb46-2412"><a href="#cb46-2412" aria-hidden="true" tabindex="-1"></a>decSecond <span class="op">=</span> (decMinute <span class="op">%</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">60</span></span>
<span id="cb46-2413"><a href="#cb46-2413" aria-hidden="true" tabindex="-1"></a>isoHour <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decHour)</span>
<span id="cb46-2414"><a href="#cb46-2414" aria-hidden="true" tabindex="-1"></a>isoMinute <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decMinute)</span>
<span id="cb46-2415"><a href="#cb46-2415" aria-hidden="true" tabindex="-1"></a>isoSecond <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decSecond)</span>
<span id="cb46-2416"><a href="#cb46-2416" aria-hidden="true" tabindex="-1"></a>decDek <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">/</span> <span class="dv">10</span>)</span>
<span id="cb46-2417"><a href="#cb46-2417" aria-hidden="true" tabindex="-1"></a>decDod <span class="op">=</span> decDate <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-2418"><a href="#cb46-2418" aria-hidden="true" tabindex="-1"></a>decDotm <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(decDate <span class="op">-</span> (<span class="dv">153</span> <span class="op">*</span> decMoty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb46-2419"><a href="#cb46-2419" aria-hidden="true" tabindex="-1"></a>selDote <span class="op">=</span> <span class="fu">unix2dote</span>(selectedDate<span class="op">.</span><span class="fu">getTime</span>() <span class="op">-</span> <span class="dv">86400000</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-2420"><a href="#cb46-2420" aria-hidden="true" tabindex="-1"></a>selDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="fu">dote2date</span>(<span class="op">...</span>selDote)[<span class="dv">1</span>])</span>
<span id="cb46-2421"><a href="#cb46-2421" aria-hidden="true" tabindex="-1"></a>selTime <span class="op">=</span> selectedHour <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb46-2422"><a href="#cb46-2422" aria-hidden="true" tabindex="-1"></a>selTimeOne <span class="op">=</span> selTime <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-2423"><a href="#cb46-2423" aria-hidden="true" tabindex="-1"></a>selTimeTen <span class="op">=</span> selTime <span class="op">*</span> <span class="dv">10</span> <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-2424"><a href="#cb46-2424" aria-hidden="true" tabindex="-1"></a>selSnap <span class="op">=</span> selDate <span class="op">+</span> selTime</span>
<span id="cb46-2425"><a href="#cb46-2425" aria-hidden="true" tabindex="-1"></a>selLati <span class="op">=</span> <span class="fu">lati2turn</span>(location[<span class="dv">1</span>])</span>
<span id="cb46-2426"><a href="#cb46-2426" aria-hidden="true" tabindex="-1"></a>decDodHsl <span class="op">=</span> <span class="fu">textcolor</span>(decDod<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decDod <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2427"><a href="#cb46-2427" aria-hidden="true" tabindex="-1"></a>decDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(decDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decDate <span class="op">/</span> (<span class="dv">365</span> <span class="op">+</span> <span class="fu">isLeapYear</span>(decYear))))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2428"><a href="#cb46-2428" aria-hidden="true" tabindex="-1"></a>decTimeHsl <span class="op">=</span> <span class="fu">textcolor</span>(decTime<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(decTime <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2429"><a href="#cb46-2429" aria-hidden="true" tabindex="-1"></a>selDateHsl <span class="op">=</span> <span class="fu">textcolor</span>(selDate<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selDate <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2430"><a href="#cb46-2430" aria-hidden="true" tabindex="-1"></a>selLatiHsl <span class="op">=</span> <span class="fu">textcolor</span>(selLati<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>((selLati <span class="op">+</span> <span class="dv">250</span>) <span class="op">%</span> <span class="dv">250</span> <span class="op">/</span> <span class="dv">250</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2431"><a href="#cb46-2431" aria-hidden="true" tabindex="-1"></a>selTimeDay <span class="op">=</span> <span class="fu">textcolor</span>(selTimeOne<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2432"><a href="#cb46-2432" aria-hidden="true" tabindex="-1"></a>selTimeHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2433"><a href="#cb46-2433" aria-hidden="true" tabindex="-1"></a>selTimeHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(selTimeTen<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selTime))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2434"><a href="#cb46-2434" aria-hidden="true" tabindex="-1"></a>selZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2435"><a href="#cb46-2435" aria-hidden="true" tabindex="-1"></a>selSnapDay <span class="op">=</span> <span class="fu">textcolor</span>(selSnap<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">3</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">6</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2436"><a href="#cb46-2436" aria-hidden="true" tabindex="-1"></a>selSnapDec <span class="op">=</span> <span class="fu">textcolor</span>((selSnap <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">9</span><span class="op">,</span> <span class="st">"0"</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selSnap <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2437"><a href="#cb46-2437" aria-hidden="true" tabindex="-1"></a>decZoneHsl <span class="op">=</span> <span class="fu">textcolor</span>(selectedZone<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(selectedZone <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2438"><a href="#cb46-2438" aria-hidden="true" tabindex="-1"></a>viewof selectedDate <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022)</span>
<span id="cb46-2439"><a href="#cb46-2439" aria-hidden="true" tabindex="-1"></a>viewof selectedHour <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(date2022<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb46-2440"><a href="#cb46-2440" aria-hidden="true" tabindex="-1"></a>date2022 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="dv">2022</span><span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getMonth</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getDate</span>()<span class="op">,</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">getHours</span>())</span>
<span id="cb46-2441"><a href="#cb46-2441" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">set</span>(input<span class="op">,</span> value) {</span>
<span id="cb46-2442"><a href="#cb46-2442" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb46-2443"><a href="#cb46-2443" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb46-2444"><a href="#cb46-2444" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2445"><a href="#cb46-2445" aria-hidden="true" tabindex="-1"></a>hD121 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">121</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb46-2446"><a href="#cb46-2446" aria-hidden="true" tabindex="-1"></a>hD268 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">268</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb46-2447"><a href="#cb46-2447" aria-hidden="true" tabindex="-1"></a>hD305 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">305</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb46-2448"><a href="#cb46-2448" aria-hidden="true" tabindex="-1"></a>hD306 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">306</span> <span class="op">/</span> <span class="dv">365</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb46-2449"><a href="#cb46-2449" aria-hidden="true" tabindex="-1"></a>h1by320 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">1</span> <span class="op">/</span> <span class="dv">320</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb46-2450"><a href="#cb46-2450" aria-hidden="true" tabindex="-1"></a>h1by8640 <span class="op">=</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(<span class="dv">1</span> <span class="op">/</span> <span class="dv">8640</span>))<span class="op">.</span><span class="at">h</span></span>
<span id="cb46-2451"><a href="#cb46-2451" aria-hidden="true" tabindex="-1"></a>hues <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">fromEntries</span>([</span>
<span id="cb46-2452"><a href="#cb46-2452" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0083</span><span class="op">,</span></span>
<span id="cb46-2453"><a href="#cb46-2453" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0166</span><span class="op">,</span></span>
<span id="cb46-2454"><a href="#cb46-2454" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">0229</span><span class="op">,</span></span>
<span id="cb46-2455"><a href="#cb46-2455" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">025</span><span class="op">,</span></span>
<span id="cb46-2456"><a href="#cb46-2456" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">287</span><span class="op">,</span></span>
<span id="cb46-2457"><a href="#cb46-2457" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0333</span><span class="op">,</span></span>
<span id="cb46-2458"><a href="#cb46-2458" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">0416</span><span class="op">,</span></span>
<span id="cb46-2459"><a href="#cb46-2459" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="bn">05</span><span class="op">,</span></span>
<span id="cb46-2460"><a href="#cb46-2460" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">125</span><span class="op">,</span></span>
<span id="cb46-2461"><a href="#cb46-2461" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">333</span><span class="op">,</span></span>
<span id="cb46-2462"><a href="#cb46-2462" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">375</span><span class="op">,</span></span>
<span id="cb46-2463"><a href="#cb46-2463" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">429</span><span class="op">,</span></span>
<span id="cb46-2464"><a href="#cb46-2464" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">533</span><span class="op">,</span></span>
<span id="cb46-2465"><a href="#cb46-2465" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">969</span><span class="op">,</span></span>
<span id="cb46-2466"><a href="#cb46-2466" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="dv">999</span><span class="op">,</span></span>
<span id="cb46-2467"><a href="#cb46-2467" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> [i<span class="op">,</span> d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(i))<span class="op">.</span><span class="at">h</span>])</span>
<span id="cb46-2468"><a href="#cb46-2468" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb46-2469"><a href="#cb46-2469" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mattdzugan/population-by-time-zone-creating-a-dataset</span></span>
<span id="cb46-2470"><a href="#cb46-2470" aria-hidden="true" tabindex="-1"></a>populationByTimeZone <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"../../asset/populationByTimeZone.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb46-2471"><a href="#cb46-2471" aria-hidden="true" tabindex="-1"></a>sortedPop <span class="op">=</span> populationByTimeZone<span class="op">.</span><span class="fu">sort</span>(</span>
<span id="cb46-2472"><a href="#cb46-2472" aria-hidden="true" tabindex="-1"></a>  (a<span class="op">,</span> b) <span class="kw">=&gt;</span> sortParams[<span class="dv">1</span>] <span class="op">?</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">number</span><span class="op">,</span> b<span class="op">.</span><span class="at">number</span>) <span class="op">:</span> <span class="fu">sortFunc</span>(a<span class="op">.</span><span class="at">pop</span><span class="op">,</span> b<span class="op">.</span><span class="at">pop</span>)</span>
<span id="cb46-2473"><a href="#cb46-2473" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-2474"><a href="#cb46-2474" aria-hidden="true" tabindex="-1"></a>sortFunc <span class="op">=</span> sortParams[<span class="dv">0</span>] <span class="op">?</span> d3<span class="op">.</span><span class="at">ascending</span> <span class="op">:</span> d3<span class="op">.</span><span class="at">descending</span></span>
<span id="cb46-2475"><a href="#cb46-2475" aria-hidden="true" tabindex="-1"></a>popBySign <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(sortedPop<span class="op">,</span> v <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">sum</span>(v<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Sign</span>)</span>
<span id="cb46-2476"><a href="#cb46-2476" aria-hidden="true" tabindex="-1"></a>totalPop <span class="op">=</span> d3<span class="op">.</span><span class="fu">sum</span>(sortedPop<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">pop</span> <span class="op">/</span> <span class="fl">1e9</span>)</span>
<span id="cb46-2477"><a href="#cb46-2477" aria-hidden="true" tabindex="-1"></a>dzOff <span class="op">=</span> <span class="fu">unix2dote</span>(now<span class="op">,</span> offset)</span>
<span id="cb46-2478"><a href="#cb46-2478" aria-hidden="true" tabindex="-1"></a>ydzOff <span class="op">=</span> <span class="fu">dote2date</span>(<span class="op">...</span>dzOff)</span>
<span id="cb46-2479"><a href="#cb46-2479" aria-hidden="true" tabindex="-1"></a>decTimeOff <span class="op">=</span> ydzOff[<span class="dv">1</span>] <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-2480"><a href="#cb46-2480" aria-hidden="true" tabindex="-1"></a>decSignOff <span class="op">=</span> offset <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"+"</span> <span class="op">:</span> <span class="st">"–"</span></span>
<span id="cb46-2481"><a href="#cb46-2481" aria-hidden="true" tabindex="-1"></a>decOffsetPosi <span class="op">=</span> (offset <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-2482"><a href="#cb46-2482" aria-hidden="true" tabindex="-1"></a>decOffsetNega <span class="op">=</span> decOffsetPosi <span class="op">-</span> <span class="dv">10</span></span>
<span id="cb46-2483"><a href="#cb46-2483" aria-hidden="true" tabindex="-1"></a>decOffsetHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(offset)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2484"><a href="#cb46-2484" aria-hidden="true" tabindex="-1"></a>decOffsetHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(offset)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2485"><a href="#cb46-2485" aria-hidden="true" tabindex="-1"></a>decOffsetHsl2 <span class="op">=</span> <span class="fu">textcolor</span>(offset<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2486"><a href="#cb46-2486" aria-hidden="true" tabindex="-1"></a>decOffsetHslP <span class="op">=</span> <span class="fu">textcolor</span>(decOffsetPosi<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2487"><a href="#cb46-2487" aria-hidden="true" tabindex="-1"></a>decOffsetHslN <span class="op">=</span> <span class="fu">textcolor</span>(decOffsetNega<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decOffsetPosi <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2488"><a href="#cb46-2488" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl0 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2489"><a href="#cb46-2489" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl1 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2490"><a href="#cb46-2490" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl2 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2491"><a href="#cb46-2491" aria-hidden="true" tabindex="-1"></a>decTimeOffHsl3 <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2492"><a href="#cb46-2492" aria-hidden="true" tabindex="-1"></a>decTimeOffLeapNum <span class="op">=</span> offset <span class="op">*</span> <span class="dv">320</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb46-2493"><a href="#cb46-2493" aria-hidden="true" tabindex="-1"></a>decTimeOffLeapTodHsl <span class="op">=</span> <span class="fu">textcolor</span>((decTimeOff <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> <span class="dv">320</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decTimeOff))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2494"><a href="#cb46-2494" aria-hidden="true" tabindex="-1"></a>decTimeOffLeapTzoHsl <span class="op">=</span> <span class="fu">textcolor</span>(<span class="vs">`</span><span class="sc">${</span>decTimeOffLeapNum<span class="sc">}</span><span class="vs">/320`</span><span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>((decTimeOffLeapNum <span class="op">/</span> <span class="dv">320</span> <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span> <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2495"><a href="#cb46-2495" aria-hidden="true" tabindex="-1"></a>utcOffsetM <span class="op">=</span> <span class="op">-</span>(<span class="kw">new</span> <span class="bu">Date</span>)<span class="op">.</span><span class="fu">getTimezoneOffset</span>()</span>
<span id="cb46-2496"><a href="#cb46-2496" aria-hidden="true" tabindex="-1"></a>utcOffsetD <span class="op">=</span> utcOffsetM <span class="op">/</span> <span class="dv">144</span></span>
<span id="cb46-2497"><a href="#cb46-2497" aria-hidden="true" tabindex="-1"></a>utcOffsetP <span class="op">=</span> (utcOffsetD <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-2498"><a href="#cb46-2498" aria-hidden="true" tabindex="-1"></a>decZone <span class="op">=</span> ydz[<span class="dv">2</span>]</span>
<span id="cb46-2499"><a href="#cb46-2499" aria-hidden="true" tabindex="-1"></a>decZonePos <span class="op">=</span> (decZone <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-2500"><a href="#cb46-2500" aria-hidden="true" tabindex="-1"></a>utcOffDiff <span class="op">=</span> <span class="pp">parseFloat</span>((<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(utcOffsetD) <span class="op">-</span> utcOffsetD)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>))</span>
<span id="cb46-2501"><a href="#cb46-2501" aria-hidden="true" tabindex="-1"></a>utcOffHslM <span class="op">=</span> <span class="fu">textcolor</span>(utcOffsetM<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffsetP <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2502"><a href="#cb46-2502" aria-hidden="true" tabindex="-1"></a>utcOffHslD <span class="op">=</span> <span class="fu">textcolor</span>(<span class="pp">parseFloat</span>(utcOffsetD<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>))<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffsetP <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2503"><a href="#cb46-2503" aria-hidden="true" tabindex="-1"></a>decZonHslP <span class="op">=</span> <span class="fu">textcolor</span>(decZonePos<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(decZonePos <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2504"><a href="#cb46-2504" aria-hidden="true" tabindex="-1"></a>utcOffsetMdiffHsl <span class="op">=</span> <span class="fu">textcolor</span>(<span class="pp">parseFloat</span>((utcOffDiff <span class="op">*</span> <span class="dv">144</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>))<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffDiff <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2505"><a href="#cb46-2505" aria-hidden="true" tabindex="-1"></a>utcOffDiffHsl <span class="op">=</span> <span class="fu">textcolor</span>(utcOffDiff<span class="op">,</span> <span class="vs">`hsl(</span><span class="sc">${</span>d3<span class="op">.</span><span class="fu">hsl</span>(<span class="fu">piecewiseColor</span>(utcOffDiff <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="at">h</span><span class="sc">}</span><span class="vs">`</span> <span class="op">+</span> slStr)</span>
<span id="cb46-2506"><a href="#cb46-2506" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">date2dote</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb46-2507"><a href="#cb46-2507" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cote <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((year <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> year <span class="op">:</span> year <span class="op">-</span> <span class="dv">399</span>) <span class="op">/</span> <span class="dv">400</span>)<span class="op">,</span> yote <span class="op">=</span> year <span class="op">-</span> cote <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb46-2508"><a href="#cb46-2508" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [cote <span class="op">*</span> <span class="dv">146097</span> <span class="op">+</span> yote <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">4</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">100</span>) <span class="op">+</span> doty<span class="op">,</span> zone]</span>
<span id="cb46-2509"><a href="#cb46-2509" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2510"><a href="#cb46-2510" aria-hidden="true" tabindex="-1"></a>leapSecondDotes <span class="op">=</span> [</span>
<span id="cb46-2511"><a href="#cb46-2511" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1972</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2512"><a href="#cb46-2512" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1972</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2513"><a href="#cb46-2513" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1973</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2514"><a href="#cb46-2514" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1974</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2515"><a href="#cb46-2515" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1975</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2516"><a href="#cb46-2516" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1976</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2517"><a href="#cb46-2517" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1977</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2518"><a href="#cb46-2518" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1978</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2519"><a href="#cb46-2519" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1979</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2520"><a href="#cb46-2520" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1981</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2521"><a href="#cb46-2521" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1982</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2522"><a href="#cb46-2522" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1983</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2523"><a href="#cb46-2523" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1985</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2524"><a href="#cb46-2524" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1987</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2525"><a href="#cb46-2525" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1989</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2526"><a href="#cb46-2526" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1990</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2527"><a href="#cb46-2527" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1992</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2528"><a href="#cb46-2528" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1993</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2529"><a href="#cb46-2529" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1994</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2530"><a href="#cb46-2530" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1995</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2531"><a href="#cb46-2531" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1997</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2532"><a href="#cb46-2532" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1998</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2533"><a href="#cb46-2533" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2005</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2534"><a href="#cb46-2534" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2008</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2535"><a href="#cb46-2535" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2012</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2536"><a href="#cb46-2536" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2015</span><span class="op">,</span> <span class="dv">121</span>]<span class="op">,</span></span>
<span id="cb46-2537"><a href="#cb46-2537" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2016</span><span class="op">,</span> <span class="dv">305</span>]<span class="op">,</span></span>
<span id="cb46-2538"><a href="#cb46-2538" aria-hidden="true" tabindex="-1"></a>]<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> <span class="fu">date2dote</span>(<span class="op">...</span>x)[<span class="dv">0</span>])</span>
<span id="cb46-2539"><a href="#cb46-2539" aria-hidden="true" tabindex="-1"></a>leapSecondDote <span class="op">=</span> <span class="fu">date2dote</span>(leapSecondYear<span class="op">,</span> leapSecondDate)[<span class="dv">0</span>]</span>
<span id="cb46-2540"><a href="#cb46-2540" aria-hidden="true" tabindex="-1"></a>leapCount <span class="op">=</span> leapSecondDotes<span class="op">.</span><span class="fu">filter</span>(dote <span class="kw">=&gt;</span> leapSecondDote <span class="op">&gt;</span> dote)<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb46-2541"><a href="#cb46-2541" aria-hidden="true" tabindex="-1"></a>leapColor <span class="op">=</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(leapCount <span class="op">/</span> <span class="dv">86400</span>))<span class="op">.</span><span class="fu">formatHex</span>()</span>
<span id="cb46-2542"><a href="#cb46-2542" aria-hidden="true" tabindex="-1"></a>leapCountHsl <span class="op">=</span> <span class="fu">textcolor</span>(leapCount<span class="op">,</span> leapColor)</span>
<span id="cb46-2543"><a href="#cb46-2543" aria-hidden="true" tabindex="-1"></a>frac <span class="op">=</span> <span class="pp">require</span>(<span class="st">"fraction.js"</span>)</span>
<span id="cb46-2544"><a href="#cb46-2544" aria-hidden="true" tabindex="-1"></a>leapFrac <span class="op">=</span> <span class="fu">frac</span>(leapCount)<span class="op">.</span><span class="fu">div</span>(<span class="dv">8640</span>)<span class="op">.</span><span class="fu">toFraction</span>()</span>
<span id="cb46-2545"><a href="#cb46-2545" aria-hidden="true" tabindex="-1"></a>leapTzoHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(leapFrac<span class="op">,</span> leapColor)</span>
<span id="cb46-2546"><a href="#cb46-2546" aria-hidden="true" tabindex="-1"></a>leapTzoHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(leapFrac<span class="op">,</span> leapColor)</span>
<span id="cb46-2547"><a href="#cb46-2547" aria-hidden="true" tabindex="-1"></a>leapTzoHsl2 <span class="op">=</span> <span class="fu">textcolor</span>(leapFrac<span class="op">,</span> leapColor)</span>
<span id="cb46-2548"><a href="#cb46-2548" aria-hidden="true" tabindex="-1"></a>hmsTzo <span class="op">=</span> <span class="fu">frac</span>(hmsinput[<span class="dv">0</span>])<span class="op">.</span><span class="fu">div</span>(<span class="dv">24</span>)<span class="op">.</span><span class="fu">add</span>(hmsinput[<span class="dv">1</span>]<span class="op">,</span> <span class="dv">1440</span>)<span class="op">.</span><span class="fu">add</span>(hmsinput[<span class="dv">2</span>]<span class="op">,</span> <span class="dv">86400</span>)<span class="op">.</span><span class="fu">mod</span>(<span class="dv">1</span>)</span>
<span id="cb46-2549"><a href="#cb46-2549" aria-hidden="true" tabindex="-1"></a>hmsTzox10 <span class="op">=</span> hmsTzo<span class="op">.</span><span class="fu">mul</span>(<span class="dv">10</span>)</span>
<span id="cb46-2550"><a href="#cb46-2550" aria-hidden="true" tabindex="-1"></a>pluralx10 <span class="op">=</span> hmsTzox10<span class="op">.</span><span class="fu">equals</span>(<span class="dv">1</span>) <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="st">"s"</span></span>
<span id="cb46-2551"><a href="#cb46-2551" aria-hidden="true" tabindex="-1"></a>hmsRounded <span class="op">=</span> hmsTzox10<span class="op">.</span><span class="fu">round</span>(digits <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb46-2552"><a href="#cb46-2552" aria-hidden="true" tabindex="-1"></a>hmsRef <span class="op">=</span> hmsRounded<span class="op">.</span><span class="fu">sub</span>(hmsTzox10)</span>
<span id="cb46-2553"><a href="#cb46-2553" aria-hidden="true" tabindex="-1"></a>hmsRefHsl <span class="op">=</span> <span class="fu">textcolor</span>(hmsRef<span class="op">.</span><span class="fu">abs</span>()<span class="op">.</span><span class="fu">toFraction</span>()<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(<span class="bu">Number</span>(hmsRef<span class="op">.</span><span class="fu">div</span>(<span class="dv">10</span>))))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2554"><a href="#cb46-2554" aria-hidden="true" tabindex="-1"></a>hmsRefSign <span class="op">=</span> hmsRef<span class="op">.</span><span class="fu">lt</span>(<span class="dv">0</span>) <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb46-2555"><a href="#cb46-2555" aria-hidden="true" tabindex="-1"></a>hmsTzoHsl <span class="op">=</span> <span class="fu">textcolor</span>(hmsTzox10<span class="op">.</span><span class="fu">toFraction</span>()<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(<span class="bu">Number</span>(hmsTzo)))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2556"><a href="#cb46-2556" aria-hidden="true" tabindex="-1"></a>hmsRodHsl <span class="op">=</span> <span class="fu">textcolor</span>(hmsRounded<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(<span class="bu">Number</span>(hmsRounded<span class="op">.</span><span class="fu">div</span>(<span class="dv">10</span>))))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2557"><a href="#cb46-2557" aria-hidden="true" tabindex="-1"></a>hmsTod <span class="op">=</span> (zeroTime <span class="op">+</span> hmsTzo) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-2558"><a href="#cb46-2558" aria-hidden="true" tabindex="-1"></a>hmsTodHsl <span class="op">=</span> <span class="fu">textcolor</span>((hmsTod <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(hmsTod))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2559"><a href="#cb46-2559" aria-hidden="true" tabindex="-1"></a>leapTod <span class="op">=</span> (zeroTime <span class="op">+</span> leapCount <span class="op">/</span> <span class="dv">86400</span>) <span class="op">%</span> <span class="dv">1</span></span>
<span id="cb46-2560"><a href="#cb46-2560" aria-hidden="true" tabindex="-1"></a>leapDecidayTod <span class="op">=</span> (leapTod <span class="op">*</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)</span>
<span id="cb46-2561"><a href="#cb46-2561" aria-hidden="true" tabindex="-1"></a>leapTodHsl0 <span class="op">=</span> <span class="fu">textcolor</span>(leapDecidayTod<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(leapTod))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2562"><a href="#cb46-2562" aria-hidden="true" tabindex="-1"></a>leapTodHsl1 <span class="op">=</span> <span class="fu">textcolor</span>(leapDecidayTod<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(leapTod))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2563"><a href="#cb46-2563" aria-hidden="true" tabindex="-1"></a>longInputHsl <span class="op">=</span> <span class="fu">textcolor</span>(longInput<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(longInput <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2564"><a href="#cb46-2564" aria-hidden="true" tabindex="-1"></a>eot <span class="op">=</span> <span class="fu">getEot</span>(leapSecondDate)</span>
<span id="cb46-2565"><a href="#cb46-2565" aria-hidden="true" tabindex="-1"></a>astTzo <span class="op">=</span> eot <span class="op">+</span> longInput</span>
<span id="cb46-2566"><a href="#cb46-2566" aria-hidden="true" tabindex="-1"></a>astTzoHsl <span class="op">=</span> <span class="fu">textcolor</span>(astTzo<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(astTzo <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2567"><a href="#cb46-2567" aria-hidden="true" tabindex="-1"></a>solarNoon <span class="op">=</span> (<span class="dv">5</span> <span class="op">-</span> astTzo <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-2568"><a href="#cb46-2568" aria-hidden="true" tabindex="-1"></a>solarNoonHsl <span class="op">=</span> <span class="fu">textcolor</span>(solarNoon<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(solarNoon <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2569"><a href="#cb46-2569" aria-hidden="true" tabindex="-1"></a>solarDiff <span class="op">=</span> zeroTime <span class="op">-</span> solarNoon</span>
<span id="cb46-2570"><a href="#cb46-2570" aria-hidden="true" tabindex="-1"></a>solarSign <span class="op">=</span> solarDiff <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"-"</span> <span class="op">:</span> <span class="st">"+"</span></span>
<span id="cb46-2571"><a href="#cb46-2571" aria-hidden="true" tabindex="-1"></a>solarDiffHsl <span class="op">=</span> <span class="fu">textcolor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(solarDiff)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>((solarDiff <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span> <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2572"><a href="#cb46-2572" aria-hidden="true" tabindex="-1"></a>eotHsl <span class="op">=</span> <span class="fu">textcolor</span>(eot<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(eot <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2573"><a href="#cb46-2573" aria-hidden="true" tabindex="-1"></a>eotSum <span class="op">=</span> (zeroTime <span class="op">+</span> astTzo <span class="op">+</span> <span class="dv">10</span>) <span class="op">%</span> <span class="dv">10</span></span>
<span id="cb46-2574"><a href="#cb46-2574" aria-hidden="true" tabindex="-1"></a>eotSumHsl <span class="op">=</span> <span class="fu">textcolor</span>(eotSum<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="fu">color</span>(<span class="fu">piecewiseColor</span>(eotSum <span class="op">/</span> <span class="dv">10</span>))<span class="op">.</span><span class="fu">formatHex</span>())</span>
<span id="cb46-2575"><a href="#cb46-2575" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mcmcclur/adaptive-plotter</span></span>
<span id="cb46-2576"><a href="#cb46-2576" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">build_samples</span>(f<span class="op">,</span> a<span class="op">,</span> b<span class="op">,</span> opts <span class="op">=</span> {}) {</span>
<span id="cb46-2577"><a href="#cb46-2577" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> { N <span class="op">=</span> <span class="dv">9</span><span class="op">,</span> max_depth <span class="op">=</span> <span class="dv">6</span> } <span class="op">=</span> opts<span class="op">;</span></span>
<span id="cb46-2578"><a href="#cb46-2578" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dx <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> N<span class="op">;</span></span>
<span id="cb46-2579"><a href="#cb46-2579" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> root_intervals <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({ <span class="dt">length</span><span class="op">:</span> N })<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb46-2580"><a href="#cb46-2580" aria-hidden="true" tabindex="-1"></a>    (_<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="kw">new</span> <span class="fu">Interval</span>(a <span class="op">+</span> i <span class="op">*</span> dx<span class="op">,</span> a <span class="op">+</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> dx<span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb46-2581"><a href="#cb46-2581" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb46-2582"><a href="#cb46-2582" aria-hidden="true" tabindex="-1"></a>  root_intervals<span class="op">.</span><span class="fu">forEach</span>((I) <span class="kw">=&gt;</span> {</span>
<span id="cb46-2583"><a href="#cb46-2583" aria-hidden="true" tabindex="-1"></a>    I<span class="op">.</span><span class="at">fa</span> <span class="op">=</span> <span class="fu">f</span>(I<span class="op">.</span><span class="at">a</span>)<span class="op">;</span></span>
<span id="cb46-2584"><a href="#cb46-2584" aria-hidden="true" tabindex="-1"></a>    I<span class="op">.</span><span class="at">fb</span> <span class="op">=</span> <span class="fu">f</span>(I<span class="op">.</span><span class="at">b</span>)<span class="op">;</span></span>
<span id="cb46-2585"><a href="#cb46-2585" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb46-2586"><a href="#cb46-2586" aria-hidden="true" tabindex="-1"></a>  root_intervals<span class="op">.</span><span class="fu">reverse</span>()<span class="op">;</span></span>
<span id="cb46-2587"><a href="#cb46-2587" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> stack <span class="op">=</span> root_intervals<span class="op">;</span></span>
<span id="cb46-2588"><a href="#cb46-2588" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb46-2589"><a href="#cb46-2589" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> pts <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb46-2590"><a href="#cb46-2590" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> nodeRight<span class="op">,</span> nodeLeft<span class="op">;</span></span>
<span id="cb46-2591"><a href="#cb46-2591" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (stack<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> cnt<span class="op">++</span> <span class="op">&lt;</span> <span class="dv">100000</span>) {</span>
<span id="cb46-2592"><a href="#cb46-2592" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> node <span class="op">=</span> stack<span class="op">.</span><span class="fu">pop</span>()<span class="op">;</span></span>
<span id="cb46-2593"><a href="#cb46-2593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">test</span>(f<span class="op">,</span> node<span class="op">,</span> opts)) {</span>
<span id="cb46-2594"><a href="#cb46-2594" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> midpoint <span class="op">=</span> node<span class="op">.</span><span class="at">midpoint</span><span class="op">;</span></span>
<span id="cb46-2595"><a href="#cb46-2595" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> new_depth <span class="op">=</span> node<span class="op">.</span><span class="at">depth</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb46-2596"><a href="#cb46-2596" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (new_depth <span class="op">&lt;=</span> max_depth) {</span>
<span id="cb46-2597"><a href="#cb46-2597" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> a_left <span class="op">=</span> node<span class="op">.</span><span class="at">a</span><span class="op">;</span></span>
<span id="cb46-2598"><a href="#cb46-2598" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> b_left <span class="op">=</span> midpoint<span class="op">;</span></span>
<span id="cb46-2599"><a href="#cb46-2599" aria-hidden="true" tabindex="-1"></a>        nodeLeft <span class="op">=</span> <span class="kw">new</span> <span class="fu">Interval</span>(a_left<span class="op">,</span> b_left<span class="op">,</span> new_depth)<span class="op">;</span></span>
<span id="cb46-2600"><a href="#cb46-2600" aria-hidden="true" tabindex="-1"></a>        nodeLeft<span class="op">.</span><span class="at">fa</span> <span class="op">=</span> <span class="fu">f</span>(a_left)<span class="op">;</span></span>
<span id="cb46-2601"><a href="#cb46-2601" aria-hidden="true" tabindex="-1"></a>        nodeLeft<span class="op">.</span><span class="at">fb</span> <span class="op">=</span> <span class="fu">f</span>(b_left)<span class="op">;</span></span>
<span id="cb46-2602"><a href="#cb46-2602" aria-hidden="true" tabindex="-1"></a>        node<span class="op">.</span><span class="at">left</span> <span class="op">=</span> nodeLeft<span class="op">;</span></span>
<span id="cb46-2603"><a href="#cb46-2603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2604"><a href="#cb46-2604" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> a_right <span class="op">=</span> midpoint<span class="op">;</span></span>
<span id="cb46-2605"><a href="#cb46-2605" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> b_right <span class="op">=</span> node<span class="op">.</span><span class="at">b</span><span class="op">;</span></span>
<span id="cb46-2606"><a href="#cb46-2606" aria-hidden="true" tabindex="-1"></a>        nodeRight <span class="op">=</span> <span class="kw">new</span> <span class="fu">Interval</span>(a_right<span class="op">,</span> b_right<span class="op">,</span> new_depth)<span class="op">;</span></span>
<span id="cb46-2607"><a href="#cb46-2607" aria-hidden="true" tabindex="-1"></a>        nodeRight<span class="op">.</span><span class="at">fa</span> <span class="op">=</span> <span class="fu">f</span>(a_left)<span class="op">;</span></span>
<span id="cb46-2608"><a href="#cb46-2608" aria-hidden="true" tabindex="-1"></a>        nodeRight<span class="op">.</span><span class="at">fb</span> <span class="op">=</span> <span class="fu">f</span>(b_left)<span class="op">;</span></span>
<span id="cb46-2609"><a href="#cb46-2609" aria-hidden="true" tabindex="-1"></a>        node<span class="op">.</span><span class="at">right</span> <span class="op">=</span> nodeRight<span class="op">;</span></span>
<span id="cb46-2610"><a href="#cb46-2610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2611"><a href="#cb46-2611" aria-hidden="true" tabindex="-1"></a>        stack<span class="op">.</span><span class="fu">push</span>(nodeRight)<span class="op">;</span></span>
<span id="cb46-2612"><a href="#cb46-2612" aria-hidden="true" tabindex="-1"></a>        stack<span class="op">.</span><span class="fu">push</span>(nodeLeft)<span class="op">;</span></span>
<span id="cb46-2613"><a href="#cb46-2613" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb46-2614"><a href="#cb46-2614" aria-hidden="true" tabindex="-1"></a>        pts<span class="op">.</span><span class="fu">push</span>(node<span class="op">.</span><span class="at">a</span>)<span class="op">;</span></span>
<span id="cb46-2615"><a href="#cb46-2615" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb46-2616"><a href="#cb46-2616" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb46-2617"><a href="#cb46-2617" aria-hidden="true" tabindex="-1"></a>      pts<span class="op">.</span><span class="fu">push</span>(node<span class="op">.</span><span class="at">a</span>)<span class="op">;</span></span>
<span id="cb46-2618"><a href="#cb46-2618" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-2619"><a href="#cb46-2619" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2620"><a href="#cb46-2620" aria-hidden="true" tabindex="-1"></a>  pts<span class="op">.</span><span class="fu">push</span>(b)<span class="op">;</span></span>
<span id="cb46-2621"><a href="#cb46-2621" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  pts = pts.map(x =&gt; ({ x: x, y: f(x) }));</span></span>
<span id="cb46-2622"><a href="#cb46-2622" aria-hidden="true" tabindex="-1"></a>  pts <span class="op">=</span> pts<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> [x<span class="op">,</span> <span class="fu">f</span>(x)])<span class="op">;</span></span>
<span id="cb46-2623"><a href="#cb46-2623" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (opts<span class="op">.</span><span class="at">show_roots</span>) {</span>
<span id="cb46-2624"><a href="#cb46-2624" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> function_roots <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb46-2625"><a href="#cb46-2625" aria-hidden="true" tabindex="-1"></a>    pts<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span> (o<span class="op">,</span> i) {</span>
<span id="cb46-2626"><a href="#cb46-2626" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="op">&lt;</span> pts<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(o<span class="op">.</span><span class="at">y</span>) <span class="op">!=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(pts[i <span class="op">+</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">y</span>)) {</span>
<span id="cb46-2627"><a href="#cb46-2627" aria-hidden="true" tabindex="-1"></a>        function_roots<span class="op">.</span><span class="fu">push</span>((o<span class="op">.</span><span class="at">x</span> <span class="op">+</span> pts[i <span class="op">+</span> <span class="dv">1</span>]<span class="op">.</span><span class="at">x</span>) <span class="op">/</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb46-2628"><a href="#cb46-2628" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb46-2629"><a href="#cb46-2629" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb46-2630"><a href="#cb46-2630" aria-hidden="true" tabindex="-1"></a>    pts<span class="op">.</span><span class="at">function_roots</span> <span class="op">=</span> function_roots<span class="op">;</span></span>
<span id="cb46-2631"><a href="#cb46-2631" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2632"><a href="#cb46-2632" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> pts<span class="op">;</span></span>
<span id="cb46-2633"><a href="#cb46-2633" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2634"><a href="#cb46-2634" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">test</span>(f<span class="op">,</span> I<span class="op">,</span> opts <span class="op">=</span> {}) {</span>
<span id="cb46-2635"><a href="#cb46-2635" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> { angle_tolerance <span class="op">=</span> <span class="fl">0.01</span><span class="op">,</span> check_roots <span class="op">=</span> <span class="kw">false</span> } <span class="op">=</span> opts<span class="op">;</span></span>
<span id="cb46-2636"><a href="#cb46-2636" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a <span class="op">=</span> I<span class="op">.</span><span class="at">a</span><span class="op">;</span></span>
<span id="cb46-2637"><a href="#cb46-2637" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> b <span class="op">=</span> I<span class="op">.</span><span class="at">b</span><span class="op">;</span></span>
<span id="cb46-2638"><a href="#cb46-2638" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> dx2 <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb46-2639"><a href="#cb46-2639" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> m <span class="op">=</span> (a <span class="op">+</span> b) <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb46-2640"><a href="#cb46-2640" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> fm <span class="op">=</span> <span class="fu">f</span>(m)<span class="op">;</span></span>
<span id="cb46-2641"><a href="#cb46-2641" aria-hidden="true" tabindex="-1"></a>  I<span class="op">.</span><span class="at">midpoint</span> <span class="op">=</span> m<span class="op">;</span></span>
<span id="cb46-2642"><a href="#cb46-2642" aria-hidden="true" tabindex="-1"></a>  I<span class="op">.</span><span class="at">f_mid</span> <span class="op">=</span> fm<span class="op">;</span></span>
<span id="cb46-2643"><a href="#cb46-2643" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (check_roots <span class="op">&amp;&amp;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(I<span class="op">.</span><span class="at">fa</span>) <span class="op">!=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sign</span>(I<span class="op">.</span><span class="at">fb</span>)) {</span>
<span id="cb46-2644"><a href="#cb46-2644" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb46-2645"><a href="#cb46-2645" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2646"><a href="#cb46-2646" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> alpha <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>((I<span class="op">.</span><span class="at">f_mid</span> <span class="op">-</span> I<span class="op">.</span><span class="at">fa</span>) <span class="op">/</span> dx2)<span class="op">;</span></span>
<span id="cb46-2647"><a href="#cb46-2647" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> beta <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">atan</span>((I<span class="op">.</span><span class="at">fb</span> <span class="op">-</span> I<span class="op">.</span><span class="at">f_mid</span>) <span class="op">/</span> dx2)<span class="op">;</span></span>
<span id="cb46-2648"><a href="#cb46-2648" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(alpha <span class="op">-</span> beta) <span class="op">&gt;</span> angle_tolerance<span class="op">;</span></span>
<span id="cb46-2649"><a href="#cb46-2649" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2650"><a href="#cb46-2650" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Interval {</span>
<span id="cb46-2651"><a href="#cb46-2651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(a<span class="op">,</span> b<span class="op">,</span> depth) {</span>
<span id="cb46-2652"><a href="#cb46-2652" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">a</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb46-2653"><a href="#cb46-2653" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">b</span> <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb46-2654"><a href="#cb46-2654" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">depth</span> <span class="op">=</span> depth<span class="op">;</span></span>
<span id="cb46-2655"><a href="#cb46-2655" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-2656"><a href="#cb46-2656" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-2657"><a href="#cb46-2657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-2658"><a href="#cb46-2658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2661"><a href="#cb46-2661" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb46-2662"><a href="#cb46-2662" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb46-2663"><a href="#cb46-2663" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: false</span></span>
<span id="cb46-2664"><a href="#cb46-2664" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb46-2665"><a href="#cb46-2665" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb46-2666"><a href="#cb46-2666" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorNight {</span></span>
<span id="cb46-2667"><a href="#cb46-2667" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #416f86;</span></span>
<span id="cb46-2668"><a href="#cb46-2668" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: white;</span></span>
<span id="cb46-2669"><a href="#cb46-2669" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 2px 0px 4px;</span></span>
<span id="cb46-2670"><a href="#cb46-2670" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2671"><a href="#cb46-2671" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2672"><a href="#cb46-2672" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2673"><a href="#cb46-2673" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2674"><a href="#cb46-2674" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorDay {</span></span>
<span id="cb46-2675"><a href="#cb46-2675" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #ffe438;</span></span>
<span id="cb46-2676"><a href="#cb46-2676" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: black;</span></span>
<span id="cb46-2677"><a href="#cb46-2677" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 3px 0px 4px;</span></span>
<span id="cb46-2678"><a href="#cb46-2678" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2679"><a href="#cb46-2679" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2680"><a href="#cb46-2680" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2681"><a href="#cb46-2681" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2682"><a href="#cb46-2682" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorBkg {</span></span>
<span id="cb46-2683"><a href="#cb46-2683" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2684"><a href="#cb46-2684" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="bu">window</span><span class="op">.</span><span class="at">darkmode</span> <span class="op">?</span> <span class="st">"white"</span> <span class="op">:</span> <span class="st">"black"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2685"><a href="#cb46-2685" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2686"><a href="#cb46-2686" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2687"><a href="#cb46-2687" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2688"><a href="#cb46-2688" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2689"><a href="#cb46-2689" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2690"><a href="#cb46-2690" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0 {</span></span>
<span id="cb46-2691"><a href="#cb46-2691" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(0 100% 50%);</span></span>
<span id="cb46-2692"><a href="#cb46-2692" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(0, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2693"><a href="#cb46-2693" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2694"><a href="#cb46-2694" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2695"><a href="#cb46-2695" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2696"><a href="#cb46-2696" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2697"><a href="#cb46-2697" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2698"><a href="#cb46-2698" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1by8640 {</span></span>
<span id="cb46-2699"><a href="#cb46-2699" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>h1by8640<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2700"><a href="#cb46-2700" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>h1by8640<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2701"><a href="#cb46-2701" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2702"><a href="#cb46-2702" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2703"><a href="#cb46-2703" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2704"><a href="#cb46-2704" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2705"><a href="#cb46-2705" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2706"><a href="#cb46-2706" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1 {</span></span>
<span id="cb46-2707"><a href="#cb46-2707" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(300 100% 50%);</span></span>
<span id="cb46-2708"><a href="#cb46-2708" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(300, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2709"><a href="#cb46-2709" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2710"><a href="#cb46-2710" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2711"><a href="#cb46-2711" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2712"><a href="#cb46-2712" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2713"><a href="#cb46-2713" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2714"><a href="#cb46-2714" aria-hidden="true" tabindex="-1"></a><span class="vs">.color2 {</span></span>
<span id="cb46-2715"><a href="#cb46-2715" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(280 100% 50%);</span></span>
<span id="cb46-2716"><a href="#cb46-2716" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(280, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2717"><a href="#cb46-2717" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2718"><a href="#cb46-2718" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2719"><a href="#cb46-2719" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2720"><a href="#cb46-2720" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2721"><a href="#cb46-2721" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2722"><a href="#cb46-2722" aria-hidden="true" tabindex="-1"></a><span class="vs">.color3 {</span></span>
<span id="cb46-2723"><a href="#cb46-2723" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(240 100% 50%);</span></span>
<span id="cb46-2724"><a href="#cb46-2724" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(240, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2725"><a href="#cb46-2725" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2726"><a href="#cb46-2726" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2727"><a href="#cb46-2727" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2728"><a href="#cb46-2728" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2729"><a href="#cb46-2729" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2730"><a href="#cb46-2730" aria-hidden="true" tabindex="-1"></a><span class="vs">.color4 {</span></span>
<span id="cb46-2731"><a href="#cb46-2731" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(200 100% 50%);</span></span>
<span id="cb46-2732"><a href="#cb46-2732" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(200, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2733"><a href="#cb46-2733" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2734"><a href="#cb46-2734" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2735"><a href="#cb46-2735" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2736"><a href="#cb46-2736" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2737"><a href="#cb46-2737" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2738"><a href="#cb46-2738" aria-hidden="true" tabindex="-1"></a><span class="vs">.color5 {</span></span>
<span id="cb46-2739"><a href="#cb46-2739" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(180 100% 50%);</span></span>
<span id="cb46-2740"><a href="#cb46-2740" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(180, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2741"><a href="#cb46-2741" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2742"><a href="#cb46-2742" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2743"><a href="#cb46-2743" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2744"><a href="#cb46-2744" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2745"><a href="#cb46-2745" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2746"><a href="#cb46-2746" aria-hidden="true" tabindex="-1"></a><span class="vs">.color583 {</span></span>
<span id="cb46-2747"><a href="#cb46-2747" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(129.88235294117646 100% 50%);</span></span>
<span id="cb46-2748"><a href="#cb46-2748" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(129.88235294117646, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2749"><a href="#cb46-2749" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2750"><a href="#cb46-2750" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2751"><a href="#cb46-2751" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2752"><a href="#cb46-2752" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2753"><a href="#cb46-2753" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2754"><a href="#cb46-2754" aria-hidden="true" tabindex="-1"></a><span class="vs">.color6 {</span></span>
<span id="cb46-2755"><a href="#cb46-2755" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(120 100% 50%);</span></span>
<span id="cb46-2756"><a href="#cb46-2756" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(120, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2757"><a href="#cb46-2757" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2758"><a href="#cb46-2758" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2759"><a href="#cb46-2759" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2760"><a href="#cb46-2760" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2761"><a href="#cb46-2761" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2762"><a href="#cb46-2762" aria-hidden="true" tabindex="-1"></a><span class="vs">.color7 {</span></span>
<span id="cb46-2763"><a href="#cb46-2763" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(80 100% 50%);</span></span>
<span id="cb46-2764"><a href="#cb46-2764" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(80, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2765"><a href="#cb46-2765" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2766"><a href="#cb46-2766" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2767"><a href="#cb46-2767" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2768"><a href="#cb46-2768" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2769"><a href="#cb46-2769" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2770"><a href="#cb46-2770" aria-hidden="true" tabindex="-1"></a><span class="vs">.color8 {</span></span>
<span id="cb46-2771"><a href="#cb46-2771" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(60 100% 50%);</span></span>
<span id="cb46-2772"><a href="#cb46-2772" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(60, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2773"><a href="#cb46-2773" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2774"><a href="#cb46-2774" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2775"><a href="#cb46-2775" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2776"><a href="#cb46-2776" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2777"><a href="#cb46-2777" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2778"><a href="#cb46-2778" aria-hidden="true" tabindex="-1"></a><span class="vs">.color9 {</span></span>
<span id="cb46-2779"><a href="#cb46-2779" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(40 100% 50%);</span></span>
<span id="cb46-2780"><a href="#cb46-2780" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(40, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2781"><a href="#cb46-2781" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2782"><a href="#cb46-2782" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2783"><a href="#cb46-2783" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2784"><a href="#cb46-2784" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2785"><a href="#cb46-2785" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2786"><a href="#cb46-2786" aria-hidden="true" tabindex="-1"></a><span class="vs">.color375 {</span></span>
<span id="cb46-2787"><a href="#cb46-2787" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2788"><a href="#cb46-2788" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.375</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2789"><a href="#cb46-2789" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2790"><a href="#cb46-2790" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2791"><a href="#cb46-2791" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2792"><a href="#cb46-2792" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2793"><a href="#cb46-2793" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2794"><a href="#cb46-2794" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0083 {</span></span>
<span id="cb46-2795"><a href="#cb46-2795" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2796"><a href="#cb46-2796" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0083</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2797"><a href="#cb46-2797" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2798"><a href="#cb46-2798" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2799"><a href="#cb46-2799" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2800"><a href="#cb46-2800" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2801"><a href="#cb46-2801" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2802"><a href="#cb46-2802" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0166 {</span></span>
<span id="cb46-2803"><a href="#cb46-2803" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2804"><a href="#cb46-2804" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0166</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2805"><a href="#cb46-2805" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2806"><a href="#cb46-2806" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2807"><a href="#cb46-2807" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2808"><a href="#cb46-2808" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2809"><a href="#cb46-2809" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2810"><a href="#cb46-2810" aria-hidden="true" tabindex="-1"></a><span class="vs">.color55by24 {</span></span>
<span id="cb46-2811"><a href="#cb46-2811" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2812"><a href="#cb46-2812" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">0229</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2813"><a href="#cb46-2813" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2814"><a href="#cb46-2814" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2815"><a href="#cb46-2815" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2816"><a href="#cb46-2816" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2817"><a href="#cb46-2817" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2818"><a href="#cb46-2818" aria-hidden="true" tabindex="-1"></a><span class="vs">.color125 {</span></span>
<span id="cb46-2819"><a href="#cb46-2819" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2820"><a href="#cb46-2820" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="op">.</span><span class="dv">125</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2821"><a href="#cb46-2821" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2822"><a href="#cb46-2822" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2823"><a href="#cb46-2823" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2824"><a href="#cb46-2824" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2825"><a href="#cb46-2825" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2826"><a href="#cb46-2826" aria-hidden="true" tabindex="-1"></a><span class="vs">.color025 {</span></span>
<span id="cb46-2827"><a href="#cb46-2827" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2828"><a href="#cb46-2828" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.025</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2829"><a href="#cb46-2829" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2830"><a href="#cb46-2830" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2831"><a href="#cb46-2831" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2832"><a href="#cb46-2832" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2833"><a href="#cb46-2833" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2834"><a href="#cb46-2834" aria-hidden="true" tabindex="-1"></a><span class="vs">.color287 {</span></span>
<span id="cb46-2835"><a href="#cb46-2835" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2836"><a href="#cb46-2836" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.287</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2837"><a href="#cb46-2837" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2838"><a href="#cb46-2838" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2839"><a href="#cb46-2839" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2840"><a href="#cb46-2840" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2841"><a href="#cb46-2841" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2842"><a href="#cb46-2842" aria-hidden="true" tabindex="-1"></a><span class="vs">.color333 {</span></span>
<span id="cb46-2843"><a href="#cb46-2843" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2844"><a href="#cb46-2844" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2845"><a href="#cb46-2845" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2846"><a href="#cb46-2846" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2847"><a href="#cb46-2847" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2848"><a href="#cb46-2848" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2849"><a href="#cb46-2849" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2850"><a href="#cb46-2850" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0333 {</span></span>
<span id="cb46-2851"><a href="#cb46-2851" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2852"><a href="#cb46-2852" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0333</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2853"><a href="#cb46-2853" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2854"><a href="#cb46-2854" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2855"><a href="#cb46-2855" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2856"><a href="#cb46-2856" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2857"><a href="#cb46-2857" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2858"><a href="#cb46-2858" aria-hidden="true" tabindex="-1"></a><span class="vs">.color0416 {</span></span>
<span id="cb46-2859"><a href="#cb46-2859" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2860"><a href="#cb46-2860" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.0416</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2861"><a href="#cb46-2861" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2862"><a href="#cb46-2862" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2863"><a href="#cb46-2863" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2864"><a href="#cb46-2864" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2865"><a href="#cb46-2865" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2866"><a href="#cb46-2866" aria-hidden="true" tabindex="-1"></a><span class="vs">.color429 {</span></span>
<span id="cb46-2867"><a href="#cb46-2867" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2868"><a href="#cb46-2868" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.429</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2869"><a href="#cb46-2869" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2870"><a href="#cb46-2870" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2871"><a href="#cb46-2871" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2872"><a href="#cb46-2872" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2873"><a href="#cb46-2873" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2874"><a href="#cb46-2874" aria-hidden="true" tabindex="-1"></a><span class="vs">.color05 {</span></span>
<span id="cb46-2875"><a href="#cb46-2875" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2876"><a href="#cb46-2876" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.05</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2877"><a href="#cb46-2877" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2878"><a href="#cb46-2878" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2879"><a href="#cb46-2879" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2880"><a href="#cb46-2880" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2881"><a href="#cb46-2881" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2882"><a href="#cb46-2882" aria-hidden="true" tabindex="-1"></a><span class="vs">.color533 {</span></span>
<span id="cb46-2883"><a href="#cb46-2883" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2884"><a href="#cb46-2884" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.533</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2885"><a href="#cb46-2885" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2886"><a href="#cb46-2886" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2887"><a href="#cb46-2887" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2888"><a href="#cb46-2888" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2889"><a href="#cb46-2889" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2890"><a href="#cb46-2890" aria-hidden="true" tabindex="-1"></a><span class="vs">.color969 {</span></span>
<span id="cb46-2891"><a href="#cb46-2891" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2892"><a href="#cb46-2892" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.969</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2893"><a href="#cb46-2893" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2894"><a href="#cb46-2894" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2895"><a href="#cb46-2895" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2896"><a href="#cb46-2896" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2897"><a href="#cb46-2897" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2898"><a href="#cb46-2898" aria-hidden="true" tabindex="-1"></a><span class="vs">.color999 {</span></span>
<span id="cb46-2899"><a href="#cb46-2899" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2900"><a href="#cb46-2900" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hues[<span class="fl">0.999</span>]<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2901"><a href="#cb46-2901" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2902"><a href="#cb46-2902" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2903"><a href="#cb46-2903" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2904"><a href="#cb46-2904" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2905"><a href="#cb46-2905" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2906"><a href="#cb46-2906" aria-hidden="true" tabindex="-1"></a><span class="vs">.color1by320 {</span></span>
<span id="cb46-2907"><a href="#cb46-2907" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2908"><a href="#cb46-2908" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>h1by320<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2909"><a href="#cb46-2909" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2910"><a href="#cb46-2910" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2911"><a href="#cb46-2911" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2912"><a href="#cb46-2912" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2913"><a href="#cb46-2913" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2914"><a href="#cb46-2914" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD121 {</span></span>
<span id="cb46-2915"><a href="#cb46-2915" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2916"><a href="#cb46-2916" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD121<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2917"><a href="#cb46-2917" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2918"><a href="#cb46-2918" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2919"><a href="#cb46-2919" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2920"><a href="#cb46-2920" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2921"><a href="#cb46-2921" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2922"><a href="#cb46-2922" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD268 {</span></span>
<span id="cb46-2923"><a href="#cb46-2923" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2924"><a href="#cb46-2924" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD268<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2925"><a href="#cb46-2925" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2926"><a href="#cb46-2926" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2927"><a href="#cb46-2927" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2928"><a href="#cb46-2928" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2929"><a href="#cb46-2929" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2930"><a href="#cb46-2930" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD305 {</span></span>
<span id="cb46-2931"><a href="#cb46-2931" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2932"><a href="#cb46-2932" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD305<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2933"><a href="#cb46-2933" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2934"><a href="#cb46-2934" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2935"><a href="#cb46-2935" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2936"><a href="#cb46-2936" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2937"><a href="#cb46-2937" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2938"><a href="#cb46-2938" aria-hidden="true" tabindex="-1"></a><span class="vs">.colorD306 {</span></span>
<span id="cb46-2939"><a href="#cb46-2939" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs"> 100% 50%);</span></span>
<span id="cb46-2940"><a href="#cb46-2940" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: </span><span class="sc">${</span><span class="fu">yiq</span>(<span class="vs">`hsl(</span><span class="sc">${</span>hD306<span class="sc">}</span><span class="vs">, 100%, 50%)`</span>) <span class="op">&gt;</span> <span class="fl">0.51</span> <span class="op">?</span> <span class="st">"black"</span> <span class="op">:</span> <span class="st">"white"</span><span class="sc">}</span><span class="vs">;</span></span>
<span id="cb46-2941"><a href="#cb46-2941" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0px 5px;</span></span>
<span id="cb46-2942"><a href="#cb46-2942" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb46-2943"><a href="#cb46-2943" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: 400;</span></span>
<span id="cb46-2944"><a href="#cb46-2944" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: monospace;</span></span>
<span id="cb46-2945"><a href="#cb46-2945" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb46-2946"><a href="#cb46-2946" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb46-2947"><a href="#cb46-2947" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb46-2948"><a href="#cb46-2948" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-2949"><a href="#cb46-2949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2950"><a href="#cb46-2950" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb46-2951"><a href="#cb46-2951" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb46-2952"><a href="#cb46-2952" aria-hidden="true" tabindex="-1"></a><span class="in">svg.barclock {</span></span>
<span id="cb46-2953"><a href="#cb46-2953" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb46-2954"><a href="#cb46-2954" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-2955"><a href="#cb46-2955" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2956"><a href="#cb46-2956" aria-hidden="true" tabindex="-1"></a><span class="in">.tickLabel, .tickLabel1, .tickLabel2, .timeLabel {</span></span>
<span id="cb46-2957"><a href="#cb46-2957" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: monospace;</span></span>
<span id="cb46-2958"><a href="#cb46-2958" aria-hidden="true" tabindex="-1"></a><span class="in">  text-anchor: middle;</span></span>
<span id="cb46-2959"><a href="#cb46-2959" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2960"><a href="#cb46-2960" aria-hidden="true" tabindex="-1"></a><span class="in">.timeLabel {</span></span>
<span id="cb46-2961"><a href="#cb46-2961" aria-hidden="true" tabindex="-1"></a><span class="in">  text-anchor: start;</span></span>
<span id="cb46-2962"><a href="#cb46-2962" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2963"><a href="#cb46-2963" aria-hidden="true" tabindex="-1"></a><span class="in">.timeBar, .timeBarFull, .timeBarFullN {</span></span>
<span id="cb46-2964"><a href="#cb46-2964" aria-hidden="true" tabindex="-1"></a><span class="in">  x: 1px;</span></span>
<span id="cb46-2965"><a href="#cb46-2965" aria-hidden="true" tabindex="-1"></a><span class="in">  height: 25px;</span></span>
<span id="cb46-2966"><a href="#cb46-2966" aria-hidden="true" tabindex="-1"></a><span class="in">  rx: 5px;</span></span>
<span id="cb46-2967"><a href="#cb46-2967" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #aaa;</span></span>
<span id="cb46-2968"><a href="#cb46-2968" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2969"><a href="#cb46-2969" aria-hidden="true" tabindex="-1"></a><span class="in">.tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB, .tickB1 {</span></span>
<span id="cb46-2970"><a href="#cb46-2970" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: none;</span></span>
<span id="cb46-2971"><a href="#cb46-2971" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: #666;</span></span>
<span id="cb46-2972"><a href="#cb46-2972" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 1px;</span></span>
<span id="cb46-2973"><a href="#cb46-2973" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2974"><a href="#cb46-2974" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock {</span></span>
<span id="cb46-2975"><a href="#cb46-2975" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #000;</span></span>
<span id="cb46-2976"><a href="#cb46-2976" aria-hidden="true" tabindex="-1"></a><span class="in">  font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;</span></span>
<span id="cb46-2977"><a href="#cb46-2977" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-2978"><a href="#cb46-2978" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2979"><a href="#cb46-2979" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock #rim {</span></span>
<span id="cb46-2980"><a href="#cb46-2980" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: none;</span></span>
<span id="cb46-2981"><a href="#cb46-2981" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke: #999;</span></span>
<span id="cb46-2982"><a href="#cb46-2982" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3px;</span></span>
<span id="cb46-2983"><a href="#cb46-2983" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2984"><a href="#cb46-2984" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .second-hand {</span></span>
<span id="cb46-2985"><a href="#cb46-2985" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3;</span></span>
<span id="cb46-2986"><a href="#cb46-2986" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2987"><a href="#cb46-2987" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .minute-hand {</span></span>
<span id="cb46-2988"><a href="#cb46-2988" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 8;</span></span>
<span id="cb46-2989"><a href="#cb46-2989" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-linecap: round;</span></span>
<span id="cb46-2990"><a href="#cb46-2990" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2991"><a href="#cb46-2991" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hour-hand {</span></span>
<span id="cb46-2992"><a href="#cb46-2992" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 12;</span></span>
<span id="cb46-2993"><a href="#cb46-2993" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-linecap: round;</span></span>
<span id="cb46-2994"><a href="#cb46-2994" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2995"><a href="#cb46-2995" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hands-cover {</span></span>
<span id="cb46-2996"><a href="#cb46-2996" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3;</span></span>
<span id="cb46-2997"><a href="#cb46-2997" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: #fff;</span></span>
<span id="cb46-2998"><a href="#cb46-2998" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-2999"><a href="#cb46-2999" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .second-tick {</span></span>
<span id="cb46-3000"><a href="#cb46-3000" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 3;</span></span>
<span id="cb46-3001"><a href="#cb46-3001" aria-hidden="true" tabindex="-1"></a><span class="in">  fill: #000;</span></span>
<span id="cb46-3002"><a href="#cb46-3002" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3003"><a href="#cb46-3003" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hour-tick {</span></span>
<span id="cb46-3004"><a href="#cb46-3004" aria-hidden="true" tabindex="-1"></a><span class="in">  stroke-width: 8; // same as the minute hand</span></span>
<span id="cb46-3005"><a href="#cb46-3005" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3006"><a href="#cb46-3006" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .second-label {</span></span>
<span id="cb46-3007"><a href="#cb46-3007" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 18px;</span></span>
<span id="cb46-3008"><a href="#cb46-3008" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3009"><a href="#cb46-3009" aria-hidden="true" tabindex="-1"></a><span class="in">.analogclock .hour-label {</span></span>
<span id="cb46-3010"><a href="#cb46-3010" aria-hidden="true" tabindex="-1"></a><span class="in">  font-size: 32px</span></span>
<span id="cb46-3011"><a href="#cb46-3011" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3012"><a href="#cb46-3012" aria-hidden="true" tabindex="-1"></a><span class="in">.clocks * {</span></span>
<span id="cb46-3013"><a href="#cb46-3013" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: -10px 0px 10px 0px;</span></span>
<span id="cb46-3014"><a href="#cb46-3014" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0px;</span></span>
<span id="cb46-3015"><a href="#cb46-3015" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3016"><a href="#cb46-3016" aria-hidden="true" tabindex="-1"></a><span class="in">#title-block-header &gt; div:nth-child(2) {</span></span>
<span id="cb46-3017"><a href="#cb46-3017" aria-hidden="true" tabindex="-1"></a><span class="in">  display: none;</span></span>
<span id="cb46-3018"><a href="#cb46-3018" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3019"><a href="#cb46-3019" aria-hidden="true" tabindex="-1"></a><span class="in">h4.hiddenheading, h5.hiddenheading {</span></span>
<span id="cb46-3020"><a href="#cb46-3020" aria-hidden="true" tabindex="-1"></a><span class="in">  display: none;</span></span>
<span id="cb46-3021"><a href="#cb46-3021" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3022"><a href="#cb46-3022" aria-hidden="true" tabindex="-1"></a><span class="in">div.cell-output:has(#daylightapp) {</span></span>
<span id="cb46-3023"><a href="#cb46-3023" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-3024"><a href="#cb46-3024" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3025"><a href="#cb46-3025" aria-hidden="true" tabindex="-1"></a><span class="in">div.cell-output:has(#formEl) {</span></span>
<span id="cb46-3026"><a href="#cb46-3026" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-3027"><a href="#cb46-3027" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3028"><a href="#cb46-3028" aria-hidden="true" tabindex="-1"></a><span class="in">#daylightapp {</span></span>
<span id="cb46-3029"><a href="#cb46-3029" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-3030"><a href="#cb46-3030" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3031"><a href="#cb46-3031" aria-hidden="true" tabindex="-1"></a><span class="in">#daylightapp * {</span></span>
<span id="cb46-3032"><a href="#cb46-3032" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-3033"><a href="#cb46-3033" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3034"><a href="#cb46-3034" aria-hidden="true" tabindex="-1"></a><span class="in">#solar-system * {</span></span>
<span id="cb46-3035"><a href="#cb46-3035" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-3036"><a href="#cb46-3036" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3037"><a href="#cb46-3037" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepopstackedbar {</span></span>
<span id="cb46-3038"><a href="#cb46-3038" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb46-3039"><a href="#cb46-3039" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3040"><a href="#cb46-3040" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div {</span></span>
<span id="cb46-3041"><a href="#cb46-3041" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb46-3042"><a href="#cb46-3042" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3043"><a href="#cb46-3043" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form {</span></span>
<span id="cb46-3044"><a href="#cb46-3044" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 180px;</span></span>
<span id="cb46-3045"><a href="#cb46-3045" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3046"><a href="#cb46-3046" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form label {</span></span>
<span id="cb46-3047"><a href="#cb46-3047" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 120px;</span></span>
<span id="cb46-3048"><a href="#cb46-3048" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3049"><a href="#cb46-3049" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form:nth-child(1) {</span></span>
<span id="cb46-3050"><a href="#cb46-3050" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-right: 8px;</span></span>
<span id="cb46-3051"><a href="#cb46-3051" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3052"><a href="#cb46-3052" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles div form:nth-child(2) label {</span></span>
<span id="cb46-3053"><a href="#cb46-3053" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 110px;</span></span>
<span id="cb46-3054"><a href="#cb46-3054" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3055"><a href="#cb46-3055" aria-hidden="true" tabindex="-1"></a><span class="in">#timezonepoptoggles input[type=checkbox] {</span></span>
<span id="cb46-3056"><a href="#cb46-3056" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-top: 8px;</span></span>
<span id="cb46-3057"><a href="#cb46-3057" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb46-3058"><a href="#cb46-3058" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb46-3059"><a href="#cb46-3059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Martin Laptev</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/maptv/maptv.github.io/blob/main/dec/time/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maptv" target="_blank">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/maptv" target="_blank">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:maptv@ireni.co">
      <i class="bi bi-envelope-at" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>