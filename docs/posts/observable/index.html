<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.489">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Laptev">

<title>Observable</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../posts/quarto/index.html" rel="prev">
<link href="../../media/dec.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Observable">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../media/dec.png" alt="10-point star made up of 100 triangles" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Martin Laptev</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://maptv.github.io"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://maptv.github.io/posts"> <i class="bi bi-pencil" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maptv"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/maptv"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:maptv@vt.edu"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/quarto/index.html">Intro to</a></li><li class="breadcrumb-item"><a href="../../posts/observable/index.html">Observable</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/quarto/index.html">Intro to</a></li><li class="breadcrumb-item"><a href="../../posts/observable/index.html">Observable</a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Observable</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">decüóìÔ∏èüïì</div>
                <div class="quarto-category">observable</div>
                <div class="quarto-category">quarto</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-body">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://maptv.github.io">Martin Laptev</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2023+254</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Intro to</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/quarto/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/observable/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Observable</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full column-body" id="quarto-document-content">





<section id="sec-intro" class="level1 page-columns page-full">
<h1>Introduction</h1>
<section id="sec-intro-doty" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-intro-doty">Day-of-the-year</h2>
<p><code>Decalendar</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> is a <a href="https://en.wikipedia.org/wiki/Decimal">decimal</a> calendarüóìÔ∏èsystem and <code>Declock</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> is a decimal timekeeping‚è≥system. Instead of months, weeks, hours, minutes, and seconds, <code>Decalendar</code> and <code>Declock</code> use a number called the day-of-the-year (<code>doty</code>)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. <a href="#fig-bar-doty" class="quarto-xref">Figure&nbsp;1</a> displays the current <code>doty</code> <span>(<span id="ojs-element-id-1"></span>)</span> as a bar chart. The <a href="https://en.wikipedia.org/wiki/Decimal#:~:text=The%20integer%20part%20or%20integral%20part%20of%20a%20decimal%20numeral%20is%20the%20integer%20written%20to%20the%20left%20of%20the%20decimal%20separator">integer part</a> of the <code>doty</code> is the <code>Decalendar</code> date<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <span>(<span id="ojs-element-id-16"></span>)</span> and the <a href="https://en.wikipedia.org/wiki/Decimal#:~:text=The%20part%20from%20the%20decimal%20separator%20to%20the%20right%20is%20the%20fractional%20part%2C%20which%20equals%20the%20difference%20between%20the%20numeral%20and%20its%20integer%20part.">fractional part</a> is the <code>Declock</code> time<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> <span>(<span id="ojs-element-id-17"></span>).</span></p>
<p>The top two bars in <a href="#fig-bar-doty" class="quarto-xref">Figure&nbsp;1</a> (Êó¨ and Êó•) show the two components of the <code>Decalendar</code> date <span>(<span id="ojs-element-id-18"></span>):</span> the <code>dek</code><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> <span>(<span id="ojs-element-id-2"></span>)</span> and the day-of-the-<code>dek</code><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> <span>(<span id="ojs-element-id-3"></span>).</span> A <code>dek</code> is a group of 10 days that fulfills the role of months and weeks in <code>Decalendar</code>. Therefore, the <code>dek</code> and the day-of-the-<code>dek</code> (<code>dotd</code>) in <code>Decalendar</code> dates are analogous to the month and day-of-the-month (<code>dotm</code>) in <a href="https://en.wikipedia.org/wiki/ISO_8601#Calendar_dates">calendar dates</a> (<code>mm-dd</code>) and the week and day-of-the-week (<code>dotw</code>) in <a href="https://en.wikipedia.org/wiki/ISO_8601#Week_dates">week dates</a> (<code>Www-d</code>).</p>
<p>The bottom three bars in <a href="#fig-bar-doty" class="quarto-xref">Figure&nbsp;1</a> (%, ‚Ä∞, and ‚ô´) show components of the <code>Declock</code> time <span>(<span id="ojs-element-id-19"></span>):</span> <code>cents</code><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> <span>(<span id="ojs-element-id-4"></span>),</span> <code>mils</code><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> <span>(<span id="ojs-element-id-5"></span>),</span> and <code>beats</code><a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> <span>(<span id="ojs-element-id-6"></span>).</span> A <code>cent</code> is 1% of the day, which is a little less than a quarter hour. A <code>mil</code> (<code>‚Ä∞</code>) is a tenth of a <code>cent</code>, which is close to a minute and a half. A <code>beat</code> is 1% of a <code>mil</code>, which is almost as long as a second, and can be thought of as a heart‚ù§Ô∏èbeat or musicalüéµ<a href="https://en.wikipedia.org/wiki/Beat_(music)#:~:text=the%20beat%20is%20the%20basic%20unit%20of%20time">beat</a> with a constant <a href="https://en.wikipedia.org/wiki/Heart_rate#:~:text=The%20American%20Heart%20Association%20states%20the%20normal%20resting%20adult%20human%20heart%20rate%20is%2060%2D100%20bpm.">rate</a> or <a href="https://en.wikipedia.org/wiki/Tempo#Basic_tempo_markings:~:text=Adagietto%20%E2%80%93%20slower%20than,56%E2%80%93108%C2%A0bpm">tempo</a> of 69.4ÃÖ beats per minute. In addition to displaying time on clocksüï∞Ô∏èand‚åöÔ∏èwatches, <code>beats</code> can be used to measure durations, such as the time since this webpage was loaded: <span><span id="ojs-element-id-7"></span>.</span></p>
<div class="cell column-body" data-layout-align="center">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="44" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 43;"><span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@fheyen/barchart-clock</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> W <span class="op">=</span> width <span class="op">&gt;</span> <span class="dv">1250</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">2</span> <span class="op">/</span> <span class="dv">3</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">1150</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">3</span> <span class="op">/</span> <span class="dv">4</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">1050</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">5</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">950</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">5</span> <span class="op">/</span> <span class="dv">6</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">850</span> <span class="op">?</span> width <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">750</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.02</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">650</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.06</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">550</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">450</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.14</span> <span class="op">:</span> width <span class="op">*</span> <span class="fl">1.18</span><span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">156</span><span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W<span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleM <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleCandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDek <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">37</span>])</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="st">'dek'</span><span class="op">,</span> <span class="st">'dotd'</span><span class="op">,</span> <span class="st">'cents'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Dek/Dotd</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDek</span>(<span class="bu">Number</span>(dotyDek)<span class="op">+</span><span class="bu">Number</span>(dotyDotd)<span class="op">/</span><span class="dv">10</span><span class="op">+</span><span class="bu">Number</span>(barCents)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDek</span>(dotyDek))</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(<span class="bu">Number</span>(dotyDotd)<span class="op">+</span><span class="bu">Number</span>(barCents)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(dotyDotd))</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickDek'</span>)</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">37</span>))</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickDek'</span>)</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDek</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">2</span> <span class="op">:</span> <span class="dv">3</span>)<span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">6</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickDotd'</span>)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickDotd'</span>)</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">49</span>)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel'</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span> width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">37</span><span class="op">:</span> <span class="dv">35</span><span class="op">,</span> width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">2</span><span class="op">:</span> <span class="dv">3</span>))</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel'</span>)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDek</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">22</span>)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(<span class="bu">Number</span>(barCents)<span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">10</span><span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(barCents))</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(<span class="bu">Number</span>(barMils)<span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barMb)<span class="op">/</span><span class="dv">100000</span>))</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(barMils))</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM1'</span>)</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM1'</span>)</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="fl">92.5</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="fl">2.5</span>)</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">47</span>)</span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel2'</span>)</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel2'</span>)</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">112</span>)</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(<span class="bu">Number</span>(barBeats)<span class="op">+</span><span class="bu">Number</span>(barMb)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(barBeats))</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`</span><span class="sc">${</span>dotyDek<span class="sc">}</span><span class="vs">Êó¨`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>dotyDotd<span class="sc">}</span><span class="vs">Êó•`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barCents<span class="sc">}</span><span class="vs">%`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMils<span class="sc">}</span><span class="vs">‚Ä∞`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeats<span class="sc">}</span><span class="vs">‚ô´`</span>])</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-bar-doty" class="cell-output cell-output-display quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-bar-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Doty bar chart
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="224" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 223;"><span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a><span class="vs">  .tickLabel, .tickLabel1, .tickLabel2, .timeLabel {</span></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #000;</span></span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-family: sans-serif;</span></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 20px;</span></span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a><span class="vs">    text-anchor: middle;</span></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeLabel {</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a><span class="vs">    text-anchor: start;</span></span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBar, .timeBarFull {</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a><span class="vs">    x: 1px;</span></span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a><span class="vs">    height: 25px;</span></span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a><span class="vs">    rx: 5px;</span></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a><span class="vs">    stroke: #aaa;</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBar {</span></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #e8e8e8;</span></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBarFull {</span></span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #ccffff;</span></span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a><span class="vs">  .background {</span></span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: white;</span></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a><span class="vs">  .tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB {</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a><span class="vs">    stroke: none;</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #666;</span></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 1px;</span></span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<p>As an alternative to <code>doty</code> dates, <code>Decalendar</code> can express dates in fractional years, which are similar to the <a href="https://en.wikipedia.org/wiki/Decimal_time#Fractional_days">fractional days</a> used in <code>doty</code> times. Fractional year dates<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> can be combined with years into one number and are useful for marking periods of 73 days in the <code>Decalendar</code> year. Every 73 days, the <code>Decalendar</code> fractional year date increases by .2 (‚Öï). The current <code>Decalendar</code> fractional year date is <span><span id="ojs-element-id-20"></span>.</span></p>
<p>Now it‚Äôs your turn! Move the slidersüéöÔ∏èin <a href="#exm-intro-doty" class="quarto-xref">Example&nbsp;1</a> to adjust the <code>doty</code>, fractional year, month, and <code>dotm</code> values and see the corresponding 1) Northern Hemisphere season, 2) Southern Hemisphere season, and 3) Zodiac sign in <a href="#lst-intro-doty" class="quarto-xref">Listing&nbsp;1</a>. Try selecting a special date, like your birthdayüéÇ! You can also press the Play‚ñ∂Ô∏èbutton and then sit back and watch the sliders cycleüîÑback and forth from the start to the end of the <code>Decalendar</code> year. The sliders cycle through an entire year in 36.5 <code>beats</code>, a million times fasterüèéÔ∏èthan the actual speed of time!</p>
<div id="exm-intro-doty" class="theorem example page-columns page-full">
<p><span class="theorem-title"><strong>Example 1 </strong></span>&nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="270" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 269;"><span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>viewof inputDoty <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">365</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">306</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"doty"</span>})<span class="op">;</span></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>viewof year <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="op">.</span><span class="dv">999</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"year"</span>})<span class="op">,</span></span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> (x <span class="kw">=&gt;</span> x <span class="op">/</span> <span class="dv">365</span>)<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> (x <span class="kw">=&gt;</span> x <span class="op">*</span> <span class="dv">365</span>)}</span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>viewof monthInput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"month"</span>})<span class="op">,</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2month<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> month2doty}</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>viewof dotmInput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">31</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"dotm"</span>})<span class="op">,</span></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2dotm<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> (x <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(( <span class="dv">153</span> <span class="op">*</span> (</span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>        viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">&gt;</span> <span class="dv">2</span></span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">-</span> <span class="dv">3</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> x <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>))})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<div class="g-col-5">
<ol type="1">
<li><span><span id="ojs-element-id-8"></span></span></li>
<li><span><span id="ojs-element-id-9"></span></span></li>
<li><span><span id="ojs-element-id-10"></span></span></li>
</ol>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="299" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 298;"><span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>viewof scrubberDoty <span class="op">=</span> <span class="fu">Scrubber</span>(numbers<span class="op">,</span> {<span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">alternate</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">delay</span><span class="op">:</span> <span class="fl">86.4</span><span class="op">,</span> <span class="dt">loopDelay</span><span class="op">:</span> <span class="dv">864</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="lst-intro-doty" class="listing">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="listing quarto-float-caption quarto-float-lst" id="lst-intro-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;1: Date to season conversion
</figcaption>
<div aria-describedby="lst-intro-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre id="lst-intro-doty"><code></code></pre>
</div>
</figure>
</div>
</div></div></div>

</section>
<section id="sec-intro-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-intro-year">Year</h2>
<p><code>Doty</code> dates (<code>day</code>) and <a href="https://en.wikipedia.org/wiki/Timestamp#:~:text=A%20timestamp%20is%20a%20sequence%20of%20characters%20or%20encoded%20information%20identifying%20when%20a%20certain%20event%20occurred%2C%20usually%20giving%20date%20and%20time%20of%20day%2C%20sometimes%20accurate%20to%20a%20small%20fraction%20of%20a%20second.">timestamps</a> (<code>day.stamp</code>) do not include years and thus can be reused from year to year. When a <code>doty</code> is combined with a year, it forms a <code>Decalendar</code> <code>ordinal</code><a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> (<code>deco</code>) and represents a specific date (<code>year+day</code>) or time (<code>year+day.stamp</code>) in a specific year, instead of a date (<code>day</code>) or time (<code>day.stamp</code>) that occurs every year or every leap year. Using the <a href="https://observablehq.com/about">Observable</a> <a href="https://observablehq.com/@observablehq/input-date#cell-111">datetime input</a> in <a href="#exm-intro-date" class="quarto-xref">Example&nbsp;2</a>, you can select a year, month, <code>dotm</code>, hour, and minute to see the equivalent 1) <code>deco</code> timestamp (<code>year+day.clock</code>) and 2) year date (<code>year.yyy</code>) in <a href="#lst-intro-date" class="quarto-xref">Listing&nbsp;2</a>. For comparison, the current <code>deco</code> timestamp is <span><span id="ojs-element-id-11"></span>.</span></p>
<div id="exm-intro-date" class="theorem example page-columns page-full">
<p><span class="theorem-title"><strong>Example 2 </strong></span>&nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="631" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 630;"><span id="cb11-631"><a href="#cb11-631" aria-hidden="true" tabindex="-1"></a>viewof inputDatetime <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">datetime</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1970-01-01T00:00"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="g-col-5">
<ol type="1">
<li><span><span id="ojs-element-id-12"></span></span></li>
<li><span><span id="ojs-element-id-13"></span></span></li>
</ol>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="lst-intro-date" class="listing" data-cap-location="margin">
<figure class="quarto-float quarto-float-lst figure">
<div aria-describedby="lst-intro-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre id="lst-intro-date" class="" data-cap-location="margin"><code></code></pre>
</div>
<figcaption class="listing quarto-float-caption quarto-float-lst" id="lst-intro-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;2: Date and time conversion
</figcaption>
</figure>
</div>
</div></div></div>
<p>In <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a>, you can enter numeric year and <code>doty</code> values or type in a free-form <code>deco</code> to see the resulting 1) <a href="https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations">ISO 8601 timestamp</a> (<code>year-mm-ddThh:mm:ss</code>) and 2) year date in <a href="#lst-intro-deco" class="quarto-xref">Listing&nbsp;3</a>. <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a> also has a Play‚ñ∂Ô∏èbutton in that cycles from <code>Day</code> <code>0</code> to <code>Day</code> <code>365</code> of <code>Year</code> <code>1969</code>. The cycle goes up to <code>Day</code> <code>0</code> of <code>Year</code> <code>1970</code>, because <code>Year</code> <code>1969</code> is a common year and does not have a <code>Day</code> <code>365</code>.</p>
<p>Interacting with the <a href="https://observablehq.com/@observablehq/input-range#m">number</a> inputs in <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a>, standardizes the <code>deco</code> in the <a href="https://observablehq.com/@observablehq/input-text">text</a> input to ensure years are integers and <code>doty</code> values are positive numbers below 366. Nevertheless, all of the inputs in <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a> support negative and fractional year and <code>doty</code> values. Negative <code>doty</code> values <a href="https://en.wikipedia.org/wiki/Shift_operator">shift</a> dates backward in time from the start of a given year into a previous year. Similarly, negative years shift dates backward starting from <code>Year</code> <code>0</code>, which is 1 BCE (Before the <a href="https://en.wikipedia.org/wiki/Common_Era">Common Era</a>).</p>
<div id="exm-intro-deco" class="theorem example page-columns page-full">
<p><span class="theorem-title"><strong>Example 3 </strong></span>&nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="658" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 657;"><span id="cb12-658"><a href="#cb12-658" aria-hidden="true" tabindex="-1"></a>viewof yd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb12-659"><a href="#cb12-659" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">number</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1969"</span>})<span class="op">,</span></span>
<span id="cb12-660"><a href="#cb12-660" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">number</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"doty"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"306"</span>})</span>
<span id="cb12-661"><a href="#cb12-661" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="666" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 665;"><span id="cb13-666"><a href="#cb13-666" aria-hidden="true" tabindex="-1"></a>viewof decoOutput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb13-667"><a href="#cb13-667" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"deco"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"year+day.ddd"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1969+306"</span>})<span class="op">,</span></span>
<span id="cb13-668"><a href="#cb13-668" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">bind</span><span class="op">:</span> viewof yd<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2deco<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> deco2doty})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="g-col-5">
<ol type="1">
<li><span><span id="ojs-element-id-14"></span></span></li>
<li><span><span id="ojs-element-id-15"></span></span></li>
</ol>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="678" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 677;"><span id="cb14-678"><a href="#cb14-678" aria-hidden="true" tabindex="-1"></a>viewof scrubberDeco <span class="op">=</span> <span class="fu">Scrubber</span>(numbers<span class="op">,</span> {<span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">alternate</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">delay</span><span class="op">:</span> <span class="fl">86.4</span><span class="op">,</span> <span class="dt">loopDelay</span><span class="op">:</span> <span class="dv">864</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="lst-intro-deco" class="listing" data-cap-location="margin">
<figure class="quarto-float quarto-float-lst figure">
<div aria-describedby="lst-intro-deco-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre id="lst-intro-deco" class="" data-cap-location="margin"><code></code></pre>
</div>
<figcaption class="listing quarto-float-caption quarto-float-lst" id="lst-intro-deco-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;3: Deco timestamp conversion
</figcaption>
</figure>
</div>
</div></div></div>

</section>
<section id="sec-intro-dek" class="level2">
<h2 class="anchored" data-anchor-id="sec-intro-dek">Dek</h2>
<p>As mentioned in <a href="#sec-intro-doty" class="quarto-xref">Section&nbsp;1.1</a>, <code>deks</code> function as both months and weeks in <code>Decalendar</code>. A <code>dek</code> consists of 2 groups of 5 days called <code>pents</code><a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>. Each <code>pent</code> can follow a sequence of workdays and restdays called a <code>pently</code> schedule<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>. fig-schedules compares the typical weekly schedule and the <code>Schedule</code> <code>3</code> <code>pently</code> schedule. Like other <code>pently</code> schedules, <code>Schedule</code> <code>3</code> is named after the number of workdays it contains. The 3 workdays in <code>Schedule</code> <code>3</code> are followed by a 2-day <code>pentend</code>, the <code>Decalender</code> equivalent of a weekend.</p>
<p>Unlike <code>Schedule</code> <code>3</code> and the other <code>pently</code> schedules, the weekly schedule is asymmetric and divides up workdays into proportions that are easier to express as fractions: 3/8 (.375), 1/3 (.3ÃÖ), and 7/24 (0.2916ÃÖ). In contrast, <code>pently</code> schedules divides each workday into simple, symmetrical proportions that are never <a href="https://en.wikipedia.org/wiki/Repeating_decimal">repeating decimal</a> numbers. The <code>Schedule</code> <code>3</code> workday is longer the typical 9-to-5, but the longer workday is compensated by more frequent restdays.</p>
<p><a href="#exm-intro-pent" class="quarto-xref">Example&nbsp;4</a> provides the opportunity to explore all four of the <code>pently</code> schedules. <code>Schedule</code> <code>3</code> is the default <code>pently</code> schedule, and should be followed unless there is a compelling reason to do otherwise. Despite having different numbers of workdays, all <code>pently</code> schedules keep the amount of spent at work constant at 1.2 days (120 <code>cents</code>) per <code>pent</code>. Every <code>pently</code> schedule also splits up workdays symmetrically so that the time before work is equal to the time after work. You can select which schedule to view in <a href="#exm-intro-pent" class="quarto-xref">Example&nbsp;4</a> using the <a href="https://observablehq.com/about">Observable</a> <a href="https://observablehq.com/@observablehq/input-radio">radio inputs</a>.</p>
<p>You can also use the <a href="https://observablehq.com/@mootari/range-slider">interval sliders</a> to create a custom schedule and the Download‚¨áÔ∏èbutton to obtain the schedule data. Each interval is summarized by a <code>Declock</code> <code>slice</code> shown next to its slider. <code>Decalendar</code> and <code>Declock</code> <code>slices</code> are inspired by <a href="https://en.wikipedia.org/wiki/Array_slicing#:~:text=In%20computer%20programming%2C%20array%20slicing%20is%20an%20operation%20that%20extracts%20a%20subset%20of%20elements%20from%20an%20array%20and%20packages%20them%20as%20another%20array">array slicing</a> in computer programming and are used to represent date and time intervals. The <code>slice</code> that summarizes the <code>Schedule</code> <code>3</code> workday is <code>.3:.7</code>, where .3 (7.2 hours) is the <code>start</code> and .7 (16.8 hours) is the <code>stop</code>.</p>
<div id="exm-intro-pent" class="theorem example">
<p><span class="theorem-title"><strong>Example 4 </strong></span>&nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="813" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 812;"><span id="cb19-813"><a href="#cb19-813" aria-hidden="true" tabindex="-1"></a>viewof intervals <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb19-814"><a href="#cb19-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'0 or 5'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-815"><a href="#cb19-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'1 or 6'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-816"><a href="#cb19-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'2 or 7'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-817"><a href="#cb19-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'3 or 8'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-818"><a href="#cb19-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'4 or 9'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-819"><a href="#cb19-819" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="g-col-5">
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="827" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 826;"><span id="cb20-827"><a href="#cb20-827" aria-hidden="true" tabindex="-1"></a>viewof schedule <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"sched."</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span>})</span>
<span id="cb20-828"><a href="#cb20-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-829"><a href="#cb20-829" aria-hidden="true" tabindex="-1"></a>viewof filename <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"name"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter the filename"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="vs">`schedule</span><span class="sc">${</span>schedule<span class="sc">}</span><span class="vs">.csv`</span>})</span>
<span id="cb20-830"><a href="#cb20-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-831"><a href="#cb20-831" aria-hidden="true" tabindex="-1"></a><span class="fu">button</span>(durations<span class="op">,</span> filename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="841" data-source-offset="0" data-cap-location="margin"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 840;"><span id="cb21-841"><a href="#cb21-841" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dec/pent</span></span>
<span id="cb21-842"><a href="#cb21-842" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb21-843"><a href="#cb21-843" aria-hidden="true" tabindex="-1"></a>  <span class="dt">className</span><span class="op">:</span> <span class="st">"schedule-explorer"</span><span class="op">,</span></span>
<span id="cb21-844"><a href="#cb21-844" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span>}<span class="op">,</span></span>
<span id="cb21-845"><a href="#cb21-845" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {<span class="dt">scheme</span><span class="op">:</span> <span class="st">"Set1"</span><span class="op">,</span> <span class="dt">legend</span><span class="op">:</span> <span class="st">"swatches"</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb21-846"><a href="#cb21-846" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb21-847"><a href="#cb21-847" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb21-848"><a href="#cb21-848" aria-hidden="true" tabindex="-1"></a>  Plot<span class="op">.</span><span class="fu">barY</span>(durations<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"label"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"group"</span>})<span class="op">,</span></span>
<span id="cb21-849"><a href="#cb21-849" aria-hidden="true" tabindex="-1"></a>  Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb21-850"><a href="#cb21-850" aria-hidden="true" tabindex="-1"></a>      durations<span class="op">,</span></span>
<span id="cb21-851"><a href="#cb21-851" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">stackY</span>(</span>
<span id="cb21-852"><a href="#cb21-852" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">groupX</span>(</span>
<span id="cb21-853"><a href="#cb21-853" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">y</span><span class="op">:</span> <span class="st">"first"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"first"</span> }<span class="op">,</span></span>
<span id="cb21-854"><a href="#cb21-854" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb21-855"><a href="#cb21-855" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"label"</span><span class="op">,</span></span>
<span id="cb21-856"><a href="#cb21-856" aria-hidden="true" tabindex="-1"></a>            <span class="dt">z</span><span class="op">:</span> <span class="st">"group"</span><span class="op">,</span></span>
<span id="cb21-857"><a href="#cb21-857" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span></span>
<span id="cb21-858"><a href="#cb21-858" aria-hidden="true" tabindex="-1"></a>            <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">duration</span> <span class="op">&lt;</span> <span class="op">.</span><span class="bn">0001</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="fu">formatDecimal</span>(d<span class="op">.</span><span class="at">duration</span>))<span class="op">,</span></span>
<span id="cb21-859"><a href="#cb21-859" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb21-860"><a href="#cb21-860" aria-hidden="true" tabindex="-1"></a>            <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb21-861"><a href="#cb21-861" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">36</span><span class="op">,</span></span>
<span id="cb21-862"><a href="#cb21-862" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb21-863"><a href="#cb21-863" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-864"><a href="#cb21-864" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb21-865"><a href="#cb21-865" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb21-866"><a href="#cb21-866" aria-hidden="true" tabindex="-1"></a>  ]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-intro-dek" class="cell-output cell-output-display quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-dek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-19" data-nodetype="expression">

</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-intro-dek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Pently schedule explorer
</figcaption>
</figure>
</div>
</div>
</div>
<p><code>Slices</code> can be used to select <code>Declock</code> time intervals, as in <a href="#exm-intro-pent" class="quarto-xref">Example&nbsp;4</a> above, or <code>Decalendar</code> date intervals, as in <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> below. <code>Decalendar</code> date intervals can represent events take place over multiple days. In addition to <code>slices</code>, <code>Decalendar</code> and <code>Declock</code> intervals can also be chosen using <code>spreads</code>. Use the <a href="https://observablehq.com/about">Observable</a> <a href="https://observablehq.com/@observablehq/input-button">button</a> and <a href="https://observablehq.com/@observablehq/input-checkbox">checkbox</a> inputs in <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> to display different <code>dotd</code> combinations in <a href="#fig-intro-dotd" class="quarto-xref">Figure&nbsp;3</a>. <a href="#fig-intro-dotd" class="quarto-xref">Figure&nbsp;3</a> shows dates selected by a <code>slice</code> in <span class="blue">blue</span>, dates selected by a <code>spread</code> in <span class="orange">orange</span>, dates selected by both in <span class="green">green</span>, and dates selected by neither in <span class="gray">gray</span>.</p>
<p>The <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> button and checkbox inputs will modify the associated <code>slice</code> and <code>spread</code> text and numeric inputs as needed to select the desired days-of-the-<code>dek</code>. The numeric inputs for <code>slices</code> are the <code>start</code>üé¨index, the <code>stop</code>üõëindex, and the <code>step</code>üë£size, which are separated by colons (<code>start:stop:step</code>) when combined into a <code>slice</code>. Similarly, the numeric inputs for <code>spreads</code> are the <code>start</code>üé¨orüõë<code>stop</code> index, the <code>span</code>ü™Ωsize, the <code>split</code> size, and the <code>space</code> size, which are typically delimited by greater-than signs (<code>start&gt;span&gt;split&gt;space</code>) or a mix of greater-than and less-than signs (<code>stop&lt;span&gt;split&gt;space</code>).</p>
<p>The numeric inputs in <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> cannot capture the full power of <code>spreads</code> and <code>slices</code>, because <code>slices</code> can have any number of <code>steps</code> and, likewise, <code>spreads</code> can have any number of alternating <code>split</code> and <code>space</code> sizes. We can select all even or odd days-of-the-<code>dek</code> using a <code>slice</code> with a single <code>step</code> (<code>::2</code> or <code>1::2</code>) or a <code>spread</code> with one <code>split</code>-<code>space</code> pair (<code>&gt;&gt;&gt;1</code> or <code>1&gt;&gt;&gt;1</code>). More complex patterns, such as prime or composite days-of-the-<code>dek</code>, require multiple <code>step</code> sizes for <code>slices</code> (<code>2:::2:2:5</code> or <code>4::2:2::5</code>) or multiple <code>split</code>-<code>space</code> pairs (<code>2&gt;&gt;2&gt;1&gt;&gt;1&gt;&gt;4</code> or <code>4&gt;&gt;&gt;1&gt;&gt;1&gt;2&gt;4</code>).</p>
<div id="exm-intro-dotd" class="theorem example">
<p><span class="theorem-title"><strong>Example 5 </strong></span>&nbsp;</p>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="882" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 881;"><span id="cb22-882"><a href="#cb22-882" aria-hidden="true" tabindex="-1"></a>viewof sliceDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"slice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">6</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="887" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 886;"><span id="cb23-887"><a href="#cb23-887" aria-hidden="true" tabindex="-1"></a>viewof spreadDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"spread"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">6</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="892" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 891;"><span id="cb24-892"><a href="#cb24-892" aria-hidden="true" tabindex="-1"></a>viewof togglePlot <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">button</span>([</span>
<span id="cb24-893"><a href="#cb24-893" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="st">"None"</span> <span class="op">:</span> <span class="st">"All"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]]<span class="op">,</span></span>
<span id="cb24-894"><a href="#cb24-894" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="st">"Even"</span> <span class="op">:</span> <span class="st">"Odd"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">9</span>]]<span class="op">,</span></span>
<span id="cb24-895"><a href="#cb24-895" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Prime&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Prime"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span>]]<span class="op">,</span></span>
<span id="cb24-896"><a href="#cb24-896" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Composite&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Composite"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span>]]<span class="op">,</span></span>
<span id="cb24-897"><a href="#cb24-897" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Schedule2&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Schedule2"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span>]]<span class="op">,</span></span>
<span id="cb24-898"><a href="#cb24-898" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Schedule3&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Schedule3"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span>]]<span class="op">,</span></span>
<span id="cb24-899"><a href="#cb24-899" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Schedule4&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Schedule4"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span>]]<span class="op">,</span></span>
<span id="cb24-900"><a href="#cb24-900" aria-hidden="true" tabindex="-1"></a>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> []<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"select"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="grid">
<div class="g-col-6">
<div class="cell btn-row">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="909" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 908;"><span id="cb25-909"><a href="#cb25-909" aria-hidden="true" tabindex="-1"></a>viewof invertDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"invert"</span>})</span>
<span id="cb25-910"><a href="#cb25-910" aria-hidden="true" tabindex="-1"></a>viewof sliceOrSpread <span class="op">=</span> <span class="fu">toggleSwitch</span>({<span class="dt">textOn</span><span class="op">:</span> invertDotd <span class="op">?</span> <span class="st">"Spread"</span> <span class="op">:</span> <span class="st">'Slice'</span> <span class="op">,</span> <span class="dt">textOff</span><span class="op">:</span> invertDotd <span class="op">?</span> <span class="st">"Slice"</span> <span class="op">:</span> <span class="st">'Spread'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="915" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 914;"><span id="cb26-915"><a href="#cb26-915" aria-hidden="true" tabindex="-1"></a>viewof sliceInputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb26-916"><a href="#cb26-916" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter start index"</span>})<span class="op">,</span></span>
<span id="cb26-917"><a href="#cb26-917" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"stop"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">366</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter stop index"</span>})<span class="op">,</span></span>
<span id="cb26-918"><a href="#cb26-918" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter step size"</span>})<span class="op">,</span></span>
<span id="cb26-919"><a href="#cb26-919" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb26-920"><a href="#cb26-920" aria-hidden="true" tabindex="-1"></a>viewof sliceString <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb26-921"><a href="#cb26-921" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"slice"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter slice string"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"0:366"</span>})<span class="op">,</span></span>
<span id="cb26-922"><a href="#cb26-922" aria-hidden="true" tabindex="-1"></a>{<span class="dt">bind</span><span class="op">:</span> viewof sliceInputs<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> encodeSlice<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> decodeSlice})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<div class="g-col-6">
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="929" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 928;"><span id="cb27-929"><a href="#cb27-929" aria-hidden="true" tabindex="-1"></a>viewof spreadInputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb27-930"><a href="#cb27-930" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter start index"</span>})<span class="op">,</span></span>
<span id="cb27-931"><a href="#cb27-931" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"span"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">366</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter span size"</span>})<span class="op">,</span></span>
<span id="cb27-932"><a href="#cb27-932" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"split"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter split size"</span>})<span class="op">,</span></span>
<span id="cb27-933"><a href="#cb27-933" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"space"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter space size"</span>})<span class="op">,</span></span>
<span id="cb27-934"><a href="#cb27-934" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb27-935"><a href="#cb27-935" aria-hidden="true" tabindex="-1"></a>viewof spreadString <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb27-936"><a href="#cb27-936" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"spread"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter spread string"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"0&gt;366&gt;3&gt;2"</span>})<span class="op">,</span></span>
<span id="cb27-937"><a href="#cb27-937" aria-hidden="true" tabindex="-1"></a>{<span class="dt">bind</span><span class="op">:</span> viewof spreadInputs<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> encodeSpread<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> decodeSpread})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-25-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-25-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="947" data-source-offset="0" data-cap-location="margin"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 946;"><span id="cb28-947"><a href="#cb28-947" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dec/dotd</span></span>
<span id="cb28-948"><a href="#cb28-948" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb28-949"><a href="#cb28-949" aria-hidden="true" tabindex="-1"></a>  <span class="dt">className</span><span class="op">:</span> <span class="st">"date-selector"</span><span class="op">,</span></span>
<span id="cb28-950"><a href="#cb28-950" aria-hidden="true" tabindex="-1"></a>  <span class="dt">padding</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb28-951"><a href="#cb28-951" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">axis</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"band"</span>}<span class="op">,</span></span>
<span id="cb28-952"><a href="#cb28-952" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"band"</span>}<span class="op">,</span></span>
<span id="cb28-953"><a href="#cb28-953" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb28-954"><a href="#cb28-954" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">cell</span>(dates<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> d <span class="kw">=&gt;</span></span>
<span id="cb28-955"><a href="#cb28-955" aria-hidden="true" tabindex="-1"></a>      sliceArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">&amp;&amp;</span> spreadArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">?</span> <span class="st">"green"</span> <span class="op">:</span></span>
<span id="cb28-956"><a href="#cb28-956" aria-hidden="true" tabindex="-1"></a>      sliceArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">&amp;&amp;</span> <span class="op">!</span>spreadArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">?</span> <span class="st">"blue"</span> <span class="op">:</span></span>
<span id="cb28-957"><a href="#cb28-957" aria-hidden="true" tabindex="-1"></a>      <span class="op">!</span>sliceArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">&amp;&amp;</span> spreadArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">?</span> <span class="st">"orange"</span> <span class="op">:</span> <span class="st">"grey"</span><span class="op">,</span></span>
<span id="cb28-958"><a href="#cb28-958" aria-hidden="true" tabindex="-1"></a>      <span class="dt">inset</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb28-959"><a href="#cb28-959" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>(dates<span class="op">,</span> {</span>
<span id="cb28-960"><a href="#cb28-960" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]<span class="op">,</span></span>
<span id="cb28-961"><a href="#cb28-961" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span></span>
<span id="cb28-962"><a href="#cb28-962" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb28-963"><a href="#cb28-963" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb28-964"><a href="#cb28-964" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span>})</span>
<span id="cb28-965"><a href="#cb28-965" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb28-966"><a href="#cb28-966" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-intro-dotd" class="cell-output cell-output-display quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-dotd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-26" data-nodetype="expression">

</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-intro-dotd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Decalendar date selector
</figcaption>
</figure>
</div>
</div>
</div>

</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
<script src="../../time.js"></script>
<style>
#title-block-header > div.quarto-title-banner.page-columns.page-full {
  margin: 0px;
  padding: 0px;
}
main#quarto-document-content {
    margin: 0px;
    padding: 0px;
}

header#title-block-header {
  margin: 0px;
}
</style>


<!-- -->

<div class="ojs-auto-generated hidden">
<script type="ojs-module-contents">
{"contents":[
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledDotyDate}.${styledDotyTime}</span>`", "cellName":"ojs-element-id-1"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledDek}</span>`", "cellName":"ojs-element-id-2"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledDotd}</span>`", "cellName":"ojs-element-id-3"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledCent}</span>`", "cellName":"ojs-element-id-4"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledMil}</span>`", "cellName":"ojs-element-id-5"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledBeat}</span>`", "cellName":"ojs-element-id-6"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledTickTime}</span>`", "cellName":"ojs-element-id-7"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${inputDotySeason[0]}</span>`", "cellName":"ojs-element-id-8"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${inputDotySeason[1]}</span>`", "cellName":"ojs-element-id-9"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${inputDotyZodiac}</span>`", "cellName":"ojs-element-id-10"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledYear}+${styledDotyDate1}.${styledDotyTime1}</span>`", "cellName":"ojs-element-id-11"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${dtYear}+${dtDotyDate}${dtDotyTimeDelimiter}${dtDotyTime}</span>`", "cellName":"ojs-element-id-12"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledOutputDatetimeYear}</span>`", "cellName":"ojs-element-id-13"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledIsocYear}-${styledIsocMd}T${styledIsocTime}</span>`", "cellName":"ojs-element-id-14"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${styledOutputDecoYear}</span>`", "cellName":"ojs-element-id-15"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${setStyle(dotyDate, d3.schemePaired[1])}</span>`", "cellName":"ojs-element-id-16"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${setStyle(dotyTime, d3.schemePaired[2])}</span>`", "cellName":"ojs-element-id-17"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${setStyle(dotyDate, d3.schemePaired[1])}</span>`", "cellName":"ojs-element-id-18"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${setStyle(dotyTime, d3.schemePaired[2])}</span>`", "cellName":"ojs-element-id-19"}
,
  {"methodName":"interpret","inline":"true","source":"htl.html`<span>${setStyle(yearDate.toString().slice(4), d3.schemePaired[10])}</span>`", "cellName":"ojs-element-id-20"}
]}
</script>
</div>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="sec-ojs-code-doty" class="level4 appendix"><h2 class="anchored quarto-appendix-heading"><code>Doty</code> Observable code</h2><div class="quarto-appendix-contents">




</div></section><section id="functions" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Functions</h2><div class="quarto-appendix-contents">

<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" data-startfrom="318" data-source-offset="-62"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 317;"><span id="cb5-318"><a href="#cb5-318" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">set</span>(input<span class="op">,</span> value) {</span>
<span id="cb5-319"><a href="#cb5-319" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb5-320"><a href="#cb5-320" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb5-321"><a href="#cb5-321" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-322"><a href="#cb5-322" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mbostock/scrubber</span></span>
<span id="cb5-323"><a href="#cb5-323" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Scrubber</span>(values<span class="op">,</span> {</span>
<span id="cb5-324"><a href="#cb5-324" aria-hidden="true" tabindex="-1"></a>  format <span class="op">=</span> value <span class="kw">=&gt;</span> value<span class="op">,</span></span>
<span id="cb5-325"><a href="#cb5-325" aria-hidden="true" tabindex="-1"></a>  initial <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb5-326"><a href="#cb5-326" aria-hidden="true" tabindex="-1"></a>  direction <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb5-327"><a href="#cb5-327" aria-hidden="true" tabindex="-1"></a>  delay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb5-328"><a href="#cb5-328" aria-hidden="true" tabindex="-1"></a>  autoplay <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-329"><a href="#cb5-329" aria-hidden="true" tabindex="-1"></a>  loop <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-330"><a href="#cb5-330" aria-hidden="true" tabindex="-1"></a>  loopDelay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb5-331"><a href="#cb5-331" aria-hidden="true" tabindex="-1"></a>  alternate <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb5-332"><a href="#cb5-332" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb5-333"><a href="#cb5-333" aria-hidden="true" tabindex="-1"></a>  values <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(values)<span class="op">;</span></span>
<span id="cb5-334"><a href="#cb5-334" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;"&gt;</span></span>
<span id="cb5-335"><a href="#cb5-335" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;button name=b type=button style="background-color:#002ead;color:#fff;border-radius:10px;margin-left:.4em;width: 5em;"&gt;&lt;/button&gt;</span></span>
<span id="cb5-336"><a href="#cb5-336" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;label style="display: flex; align-items: center;"&gt;</span></span>
<span id="cb5-337"><a href="#cb5-337" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;input name=i type=range min=0 max=</span><span class="sc">${</span>values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="sc">}</span><span class="vs"> value=</span><span class="sc">${</span>initial<span class="sc">}</span><span class="vs"> step=1 style="display: none;"&gt;</span></span>
<span id="cb5-338"><a href="#cb5-338" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;output name=o style="display: none;"&gt;&lt;/output&gt;</span></span>
<span id="cb5-339"><a href="#cb5-339" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/label&gt;</span></span>
<span id="cb5-340"><a href="#cb5-340" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb5-341"><a href="#cb5-341" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-342"><a href="#cb5-342" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-343"><a href="#cb5-343" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-344"><a href="#cb5-344" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">start</span>() {</span>
<span id="cb5-345"><a href="#cb5-345" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Pause"</span><span class="op">;</span></span>
<span id="cb5-346"><a href="#cb5-346" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb5-347"><a href="#cb5-347" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> delay)<span class="op">;</span></span>
<span id="cb5-348"><a href="#cb5-348" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-349"><a href="#cb5-349" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">stop</span>() {</span>
<span id="cb5-350"><a href="#cb5-350" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Play"</span><span class="op">;</span></span>
<span id="cb5-351"><a href="#cb5-351" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-352"><a href="#cb5-352" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (timer <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearTimeout</span>(timer)<span class="op">,</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-353"><a href="#cb5-353" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-354"><a href="#cb5-354" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-355"><a href="#cb5-355" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">running</span>() {</span>
<span id="cb5-356"><a href="#cb5-356" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> frame <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> timer <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> interval <span class="op">!==</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-357"><a href="#cb5-357" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> (direction <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span> direction <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="kw">NaN</span>)) {</span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>loop) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (alternate) direction <span class="op">=</span> <span class="op">-</span>direction<span class="op">;</span></span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (loopDelay <span class="op">!==</span> <span class="kw">null</span>) {</span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a>        timer <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> (<span class="fu">step</span>()<span class="op">,</span> <span class="fu">start</span>())<span class="op">,</span> loopDelay)<span class="op">;</span></span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step</span>()<span class="op">;</span></span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">step</span>() {</span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction <span class="op">+</span> values<span class="op">.</span><span class="at">length</span>) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> <span class="bu">event</span> <span class="kw">=&gt;</span> {</span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">event</span> <span class="op">&amp;&amp;</span> <span class="bu">event</span><span class="op">.</span><span class="at">isTrusted</span> <span class="op">&amp;&amp;</span> <span class="fu">running</span>()) <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> values[form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span>]<span class="op">;</span></span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">o</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="fu">format</span>(form<span class="op">.</span><span class="at">value</span><span class="op">,</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span><span class="op">,</span> values)<span class="op">;</span></span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">running</span>()) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> alternate <span class="op">&amp;&amp;</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>    <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">oninput</span>()<span class="op">;</span></span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (autoplay) <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">disposal</span>(form)<span class="op">.</span><span class="fu">then</span>(stop)<span class="op">;</span></span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@juang1744/transform-input/1</span></span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a>transformInput <span class="op">=</span> <span class="kw">function</span>(target<span class="op">,</span> {<span class="dt">bind</span><span class="op">:</span> source<span class="op">,</span> transform <span class="op">=</span> identity<span class="op">,</span> involutory <span class="op">=</span> <span class="kw">false</span><span class="op">,</span> invert <span class="op">=</span> involutory <span class="op">?</span> transform <span class="op">:</span> <span class="fu">inverse</span>(transform)} <span class="op">=</span> {}){</span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (source <span class="op">===</span> <span class="kw">undefined</span>) {</span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a>    source <span class="op">=</span> target<span class="op">;</span></span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>source<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">sourceInputHandler</span>() {</span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTransform</span>(target)<span class="op">.</span><span class="fu">to</span>(<span class="fu">transform</span>(source<span class="op">.</span><span class="at">value</span>))<span class="op">.</span><span class="fu">andDispatchEvent</span>()<span class="op">;</span></span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">targetInputHandler</span>() {</span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTransform</span>(source)<span class="op">.</span><span class="fu">to</span>(<span class="fu">invert</span>(target<span class="op">.</span><span class="at">value</span>))<span class="op">.</span><span class="fu">andDispatchEvent</span>()<span class="op">;</span></span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a>  source<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a>  target<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sourceInputHandler</span>()<span class="op">;</span></span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> target<span class="op">;</span></span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>setTransform <span class="op">=</span> (input) <span class="kw">=&gt;</span> ({<span class="dt">to</span><span class="op">:</span> (value) <span class="kw">=&gt;</span> (input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">,</span> {<span class="dt">andDispatchEvent</span><span class="op">:</span> (<span class="bu">event</span> <span class="op">=</span> <span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span>)) <span class="kw">=&gt;</span> input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="bu">event</span>)})})<span class="op">;</span></span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">inverse</span>(f) {</span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span> (f) {</span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="dt">identity</span><span class="op">:</span>  <span class="cf">return</span> identity<span class="op">;</span></span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span><span class="op">:</span> <span class="cf">return</span> square<span class="op">;</span></span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span><span class="op">:</span>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span><span class="op">;</span></span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span><span class="op">:</span>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span><span class="op">;</span></span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a>    <span class="cf">default</span><span class="op">:</span>        <span class="cf">return</span> (x <span class="kw">=&gt;</span> <span class="fu">solve</span>(f<span class="op">,</span> x<span class="op">,</span> x))<span class="op">;</span></span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">solve</span>(f<span class="op">,</span> y<span class="op">,</span> x <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dx <span class="op">=</span> <span class="fl">1e-6</span><span class="op">;</span></span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> steps <span class="op">=</span> <span class="dv">100</span><span class="op">,</span> deltax<span class="op">,</span> fx<span class="op">,</span> dfx<span class="op">;</span></span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a>    <span class="cf">do</span> {</span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a>      fx <span class="op">=</span> <span class="fu">f</span>(x)</span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a>      dfx <span class="op">=</span> (<span class="fu">f</span>(x <span class="op">+</span> dx) <span class="op">-</span> fx) <span class="op">||</span> dx<span class="op">;</span></span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a>      deltax <span class="op">=</span> dx <span class="op">*</span> (fx <span class="op">-</span> y)<span class="op">/</span>dfx</span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a>      x <span class="op">-=</span> deltax<span class="op">;</span></span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">while</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(deltax) <span class="op">&gt;</span> dx <span class="op">&amp;&amp;</span> <span class="op">--</span>steps <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> steps <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="kw">NaN</span> <span class="op">:</span> x<span class="op">;</span></span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">square</span>(x) {</span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> x<span class="op">;</span></span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">identity</span>(x) {</span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor</span></span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setStyle</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;=</span> <span class="fl">0.6</span> <span class="op">?</span> <span class="st">"#111"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 1px"</span><span class="op">,</span></span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>    fontSize <span class="op">=</span> <span class="st">"1em"</span><span class="op">,</span></span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2doty</span>(days <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a>        dotc <span class="op">=</span> days <span class="op">-</span> era <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a>        yotc <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dotc <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)) <span class="op">/</span> <span class="dv">365</span>)<span class="op">;</span></span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [yotc <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">,</span> dotc <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">100</span>) <span class="op">-</span> yotc <span class="op">*</span> <span class="dv">365</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">4</span>)]<span class="op">;</span></span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2doty</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">dote2doty</span>(ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span>)</span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a><span class="co">// https://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2dote</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cycle <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((year <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> year <span class="op">:</span> year <span class="op">-</span> <span class="dv">399</span>) <span class="op">/</span> <span class="dv">400</span>)<span class="op">,</span></span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a>    yote <span class="op">=</span> year <span class="op">-</span> cycle <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle <span class="op">*</span> <span class="dv">146097</span> <span class="op">+</span> yote <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">4</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">100</span>) <span class="op">+</span> doty <span class="op">-</span> zone</span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2deco</span>(yearDoty <span class="op">=</span> [<span class="dv">1969</span><span class="op">,</span> <span class="dv">306</span>]<span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yd <span class="op">=</span> <span class="fu">dote2doty</span>(<span class="fu">doty2dote</span>(yearDoty[<span class="dv">0</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yearDoty[<span class="dv">1</span>])))<span class="op">;</span></span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>yd[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span>(yd[<span class="dv">1</span>])<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}${</span></span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a>        yearDoty[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">includes</span>(<span class="st">"."</span>) <span class="op">?</span> <span class="st">"."</span> <span class="op">+</span> (</span>
<span id="cb5-492"><a href="#cb5-492" aria-hidden="true" tabindex="-1"></a>            (yearDoty[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">?</span> (yearDoty[<span class="dv">1</span>] <span class="op">-</span> zone)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)<span class="op">.</span><span class="fu">pop</span>()</span>
<span id="cb5-493"><a href="#cb5-493" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> [<span class="op">...</span>(yearDoty[<span class="dv">1</span>] <span class="op">-</span> zone)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)<span class="op">.</span><span class="fu">pop</span>()]<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb5-494"><a href="#cb5-494" aria-hidden="true" tabindex="-1"></a>                (e<span class="op">,</span> i<span class="op">,</span> a) <span class="kw">=&gt;</span> (i <span class="op">+</span> <span class="dv">1</span> <span class="op">===</span> a<span class="op">.</span><span class="at">length</span>) <span class="op">?</span> <span class="dv">10</span> <span class="op">-</span> e <span class="op">:</span> <span class="dv">9</span> <span class="op">-</span> e</span>
<span id="cb5-495"><a href="#cb5-495" aria-hidden="true" tabindex="-1"></a>            )<span class="op">.</span><span class="fu">join</span>(<span class="st">""</span>)</span>
<span id="cb5-496"><a href="#cb5-496" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">:</span> <span class="st">""</span></span>
<span id="cb5-497"><a href="#cb5-497" aria-hidden="true" tabindex="-1"></a>    <span class="sc">}</span><span class="vs">`</span></span>
<span id="cb5-498"><a href="#cb5-498" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-499"><a href="#cb5-499" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2deco</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-500"><a href="#cb5-500" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2deco</span>(<span class="fu">unix2doty</span>(ms))<span class="op">;</span></span>
<span id="cb5-501"><a href="#cb5-501" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb5-502"><a href="#cb5-502" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb5-503"><a href="#cb5-503" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greg2doty</span>(month <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> day <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb5-504"><a href="#cb5-504" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb5-505"><a href="#cb5-505" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> day <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb5-506"><a href="#cb5-506" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb5-507"><a href="#cb5-507" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb5-508"><a href="#cb5-508" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2greg</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-509"><a href="#cb5-509" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb5-510"><a href="#cb5-510" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(m <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> m <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> m <span class="op">-</span> <span class="dv">9</span>)<span class="op">,</span> doty <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">153</span> <span class="op">*</span> m <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb5-511"><a href="#cb5-511" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-512"><a href="#cb5-512" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2toty</span>(doty <span class="op">=</span> <span class="dv">306</span>) {</span>
<span id="cb5-513"><a href="#cb5-513" aria-hidden="true" tabindex="-1"></a>    doty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty)</span>
<span id="cb5-514"><a href="#cb5-514" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">205</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">295</span>) <span class="op">?</span> [<span class="st">"FallüçÅ"</span><span class="op">,</span> <span class="st">"Springüåº"</span>] <span class="op">:</span></span>
<span id="cb5-515"><a href="#cb5-515" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">110</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">205</span>) <span class="op">?</span> [<span class="st">"Summer‚òÄÔ∏è"</span><span class="op">,</span> <span class="st">"Winter‚ùÑÔ∏è"</span>] <span class="op">:</span></span>
<span id="cb5-516"><a href="#cb5-516" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">20</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">110</span>) <span class="op">?</span> [<span class="st">"Springüåº"</span><span class="op">,</span> <span class="st">"FallüçÅ"</span>] <span class="op">:</span></span>
<span id="cb5-517"><a href="#cb5-517" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">0</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">20</span>) <span class="op">||</span> (<span class="dv">295</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;=</span> <span class="dv">365</span>)</span>
<span id="cb5-518"><a href="#cb5-518" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> [<span class="st">"Winter‚ùÑÔ∏è"</span><span class="op">,</span> <span class="st">"Summer‚òÄÔ∏è"</span>] <span class="op">:</span> <span class="st">"Unknown"</span></span>
<span id="cb5-519"><a href="#cb5-519" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-520"><a href="#cb5-520" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2zodi</span>(doty <span class="op">=</span> <span class="dv">306</span>) {</span>
<span id="cb5-521"><a href="#cb5-521" aria-hidden="true" tabindex="-1"></a>    doty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty)</span>
<span id="cb5-522"><a href="#cb5-522" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">20</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">50</span>) <span class="op">?</span> <span class="st">"Aries‚ôàÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-523"><a href="#cb5-523" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">50</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">81</span>) <span class="op">?</span> <span class="st">"Taurus‚ôâÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-524"><a href="#cb5-524" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">81</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">112</span>) <span class="op">?</span> <span class="st">"Gemini‚ôäÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-525"><a href="#cb5-525" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">112</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">144</span>) <span class="op">?</span> <span class="st">"Cancer‚ôãÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-526"><a href="#cb5-526" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">144</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">175</span>) <span class="op">?</span> <span class="st">"Leo‚ôåÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-527"><a href="#cb5-527" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">175</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">206</span>) <span class="op">?</span> <span class="st">"Virgo‚ôçÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-528"><a href="#cb5-528" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">206</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">236</span>) <span class="op">?</span> <span class="st">"Libra‚ôéÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-529"><a href="#cb5-529" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">236</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">266</span>) <span class="op">?</span> <span class="st">"Scorpio‚ôèÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-530"><a href="#cb5-530" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">266</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">296</span>) <span class="op">?</span> <span class="st">"Sagittarius‚ôêÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-531"><a href="#cb5-531" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">296</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">325</span>) <span class="op">?</span> <span class="st">"Capricorn‚ôëÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-532"><a href="#cb5-532" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">325</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">355</span>) <span class="op">?</span> <span class="st">"Aquarius‚ôíÔ∏è"</span> <span class="op">:</span></span>
<span id="cb5-533"><a href="#cb5-533" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">355</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;=</span> <span class="dv">365</span>) <span class="op">||</span> (<span class="dv">0</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">20</span>)</span>
<span id="cb5-534"><a href="#cb5-534" aria-hidden="true" tabindex="-1"></a>     <span class="op">?</span> <span class="st">"Pisces‚ôìÔ∏è"</span> <span class="op">:</span> <span class="st">"Unknown"</span></span>
<span id="cb5-535"><a href="#cb5-535" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-536"><a href="#cb5-536" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2month</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-537"><a href="#cb5-537" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb5-538"><a href="#cb5-538" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(m <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> m <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> m <span class="op">-</span> <span class="dv">9</span>)<span class="op">;</span></span>
<span id="cb5-539"><a href="#cb5-539" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-540"><a href="#cb5-540" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">month2doty</span>(month <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb5-541"><a href="#cb5-541" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb5-542"><a href="#cb5-542" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span></span>
<span id="cb5-543"><a href="#cb5-543" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb5-544"><a href="#cb5-544" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2dotm</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-545"><a href="#cb5-545" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb5-546"><a href="#cb5-546" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> doty <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">153</span> <span class="op">*</span> m <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-547"><a href="#cb5-547" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-19" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="variables" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Variables</h2><div class="quarto-appendix-contents">

<div class="cell" data-output="all">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" data-startfrom="554" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 553;"><span id="cb6-554"><a href="#cb6-554" aria-hidden="true" tabindex="-1"></a>width</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" data-startfrom="555" data-source-offset="-6"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 554;"><span id="cb7-555"><a href="#cb7-555" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> {</span>
<span id="cb7-556"><a href="#cb7-556" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="kw">true</span>) {</span>
<span id="cb7-557"><a href="#cb7-557" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()<span class="op">;</span></span>
<span id="cb7-558"><a href="#cb7-558" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-559"><a href="#cb7-559" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-560"><a href="#cb7-560" aria-hidden="true" tabindex="-1"></a>tick <span class="op">=</span> {</span>
<span id="cb7-561"><a href="#cb7-561" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-562"><a href="#cb7-562" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb7-563"><a href="#cb7-563" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> Promises<span class="op">.</span><span class="fu">tick</span>(<span class="dv">864</span><span class="op">,</span> <span class="op">++</span>i)<span class="op">;</span></span>
<span id="cb7-564"><a href="#cb7-564" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-565"><a href="#cb7-565" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-566"><a href="#cb7-566" aria-hidden="true" tabindex="-1"></a>tickDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(tick <span class="op">/</span> <span class="fl">1e5</span>)</span>
<span id="cb7-567"><a href="#cb7-567" aria-hidden="true" tabindex="-1"></a>tickTime <span class="op">=</span> tick <span class="op">%</span> <span class="fl">1e5</span></span>
<span id="cb7-568"><a href="#cb7-568" aria-hidden="true" tabindex="-1"></a>tickDelimiter <span class="op">=</span> (tickDate <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">?</span> <span class="st">"."</span> <span class="op">:</span> <span class="st">""</span></span>
<span id="cb7-569"><a href="#cb7-569" aria-hidden="true" tabindex="-1"></a>barTime <span class="op">=</span> <span class="fu">unix2dote</span>(unix)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">1</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb7-570"><a href="#cb7-570" aria-hidden="true" tabindex="-1"></a>barCents <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb7-571"><a href="#cb7-571" aria-hidden="true" tabindex="-1"></a>barMils <span class="op">=</span> barTime[<span class="dv">2</span>]</span>
<span id="cb7-572"><a href="#cb7-572" aria-hidden="true" tabindex="-1"></a>barBeats <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb7-573"><a href="#cb7-573" aria-hidden="true" tabindex="-1"></a>barMb <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span>)</span>
<span id="cb7-574"><a href="#cb7-574" aria-hidden="true" tabindex="-1"></a>deco <span class="op">=</span> <span class="fu">unix2deco</span>(unix)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">14</span>)</span>
<span id="cb7-575"><a href="#cb7-575" aria-hidden="true" tabindex="-1"></a>doty <span class="op">=</span> deco<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span>)</span>
<span id="cb7-576"><a href="#cb7-576" aria-hidden="true" tabindex="-1"></a>dotyDate <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>)</span>
<span id="cb7-577"><a href="#cb7-577" aria-hidden="true" tabindex="-1"></a>dotyTime <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span>)</span>
<span id="cb7-578"><a href="#cb7-578" aria-hidden="true" tabindex="-1"></a>dotyDek <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb7-579"><a href="#cb7-579" aria-hidden="true" tabindex="-1"></a>dotyDotd <span class="op">=</span> doty[<span class="dv">2</span>]</span>
<span id="cb7-580"><a href="#cb7-580" aria-hidden="true" tabindex="-1"></a>iso <span class="op">=</span> {</span>
<span id="cb7-581"><a href="#cb7-581" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="kw">true</span>) {</span>
<span id="cb7-582"><a href="#cb7-582" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">toISOString</span>()</span>
<span id="cb7-583"><a href="#cb7-583" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-584"><a href="#cb7-584" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-585"><a href="#cb7-585" aria-hidden="true" tabindex="-1"></a>isoDate <span class="op">=</span> iso<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb7-586"><a href="#cb7-586" aria-hidden="true" tabindex="-1"></a>isoTime <span class="op">=</span> iso<span class="op">.</span><span class="fu">slice</span>(<span class="dv">11</span><span class="op">,</span> <span class="dv">19</span>)</span>
<span id="cb7-587"><a href="#cb7-587" aria-hidden="true" tabindex="-1"></a>season <span class="op">=</span> <span class="fu">doty2toty</span>(dotyDate)</span>
<span id="cb7-588"><a href="#cb7-588" aria-hidden="true" tabindex="-1"></a>zodiac <span class="op">=</span> <span class="fu">doty2zodi</span>(dotyDate)</span>
<span id="cb7-589"><a href="#cb7-589" aria-hidden="true" tabindex="-1"></a>inputDotySeason <span class="op">=</span> <span class="fu">doty2toty</span>(inputDoty)</span>
<span id="cb7-590"><a href="#cb7-590" aria-hidden="true" tabindex="-1"></a>inputDotyZodiac <span class="op">=</span> <span class="fu">doty2zodi</span>(inputDoty)</span>
<span id="cb7-591"><a href="#cb7-591" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">366</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-25" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" data-startfrom="595" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 594;"><span id="cb8-595"><a href="#cb8-595" aria-hidden="true" tabindex="-1"></a>styledYear <span class="op">=</span> <span class="fu">setStyle</span>(deco<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb8-596"><a href="#cb8-596" aria-hidden="true" tabindex="-1"></a>styledDotyDate <span class="op">=</span> <span class="fu">setStyle</span>(dotyDate<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb8-597"><a href="#cb8-597" aria-hidden="true" tabindex="-1"></a>styledDotyTime <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb8-598"><a href="#cb8-598" aria-hidden="true" tabindex="-1"></a>styledDotyDate1 <span class="op">=</span> <span class="fu">setStyle</span>(dotyDate<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb8-599"><a href="#cb8-599" aria-hidden="true" tabindex="-1"></a>styledDotyTime1 <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb8-600"><a href="#cb8-600" aria-hidden="true" tabindex="-1"></a>styledTickTime <span class="op">=</span> <span class="fu">setStyle</span>(tickTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb8-601"><a href="#cb8-601" aria-hidden="true" tabindex="-1"></a>styledDek <span class="op">=</span> <span class="fu">setStyle</span>(dotyDek<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">0</span>])</span>
<span id="cb8-602"><a href="#cb8-602" aria-hidden="true" tabindex="-1"></a>styledDotd <span class="op">=</span> <span class="fu">setStyle</span>(dotyDotd<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">9</span>])</span>
<span id="cb8-603"><a href="#cb8-603" aria-hidden="true" tabindex="-1"></a>styledCent <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">7</span>])</span>
<span id="cb8-604"><a href="#cb8-604" aria-hidden="true" tabindex="-1"></a>styledMil <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime[<span class="dv">2</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">6</span>])</span>
<span id="cb8-605"><a href="#cb8-605" aria-hidden="true" tabindex="-1"></a>styledBeat <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">5</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">11</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="set-values" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Set values</h2><div class="quarto-appendix-contents">

<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="611" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 610;"><span id="cb9-611"><a href="#cb9-611" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof inputDoty<span class="op">,</span> scrubberDoty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<details class="code-fold hidden">
<summary>Code</summary>
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="616" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 615;"><span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof decoOutput<span class="op">,</span> <span class="vs">`1969+</span><span class="sc">${</span>scrubberDeco<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="expression">

</div>
</div>
</div>
</div></section><section id="sec-ojs-code-deco" class="level4 appendix"><h2 class="anchored quarto-appendix-heading"><code>Deco</code> Observable code</h2><div class="quarto-appendix-contents">



</div></section><section id="functions-1" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Functions</h2><div class="quarto-appendix-contents">

<div class="sourceCode" id="cb15"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>copyq<span class="op">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2doty</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days <span class="op">=</span> ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span><span class="op">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        dote <span class="op">=</span> days <span class="op">-</span> (era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)) <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        year <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dote <span class="op">-</span> dote <span class="op">/</span> <span class="dv">1460</span> <span class="op">+</span> dote <span class="op">/</span> <span class="dv">36524</span> <span class="op">-</span> dote <span class="op">/</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">365</span>) <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [year<span class="op">,</span> days <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(year <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">4</span> <span class="op">-</span> year <span class="op">/</span> <span class="dv">100</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">400</span>)]<span class="op">;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> [year<span class="op">,</span> doty] <span class="op">=</span> <span class="fu">unix2doty</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())<span class="op">,</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    datetime <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>year<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    (day <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty))<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">.</span><span class="sc">${</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>((doty <span class="op">-</span> day) <span class="op">*</span> <span class="fl">1e5</span>))<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">5</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">+0`</span><span class="op">;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">copy</span>(datetime)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">copySelection</span>(datetime)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" data-startfrom="715" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 714;"><span id="cb16-715"><a href="#cb16-715" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">zone2hour</span>(zone <span class="op">=</span> <span class="st">"Z"</span>) {</span>
<span id="cb16-716"><a href="#cb16-716" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (zone <span class="op">=</span> zone<span class="op">.</span><span class="fu">toUpperCase</span>()) <span class="op">==</span> <span class="st">"Z"</span> <span class="op">?</span> <span class="dv">0</span></span>
<span id="cb16-717"><a href="#cb16-717" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&gt;</span> <span class="st">"@"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&lt;</span> <span class="st">"J"</span> <span class="op">?</span> zone<span class="op">.</span><span class="fu">charCodeAt</span>() <span class="op">-</span> <span class="dv">64</span></span>
<span id="cb16-718"><a href="#cb16-718" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&gt;</span> <span class="st">"J"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&lt;</span> <span class="st">"N"</span> <span class="op">?</span> zone<span class="op">.</span><span class="fu">charCodeAt</span>() <span class="op">-</span> <span class="dv">65</span></span>
<span id="cb16-719"><a href="#cb16-719" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&lt;</span> <span class="st">"Z"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&gt;</span> <span class="st">"M"</span> <span class="op">?</span> <span class="op">-</span>(zone<span class="op">.</span><span class="fu">charCodeAt</span>() <span class="op">-</span> <span class="dv">77</span>)</span>
<span id="cb16-720"><a href="#cb16-720" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone<span class="op">;</span></span>
<span id="cb16-721"><a href="#cb16-721" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-722"><a href="#cb16-722" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">deco2doty</span>(timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span>) {</span>
<span id="cb16-723"><a href="#cb16-723" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> arr <span class="op">=</span> timestamp<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=</span><span class="sc">[+-]|[a-zA-Z])</span><span class="ss">/</span><span class="op">,</span> <span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb16-724"><a href="#cb16-724" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span> (arr<span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb16-725"><a href="#cb16-725" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span> <span class="cf">return</span> [<span class="fu">unix2doty</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())[<span class="dv">0</span>]<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb16-726"><a href="#cb16-726" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span> <span class="cf">return</span> (<span class="ss">/</span><span class="sc">^[a-zA-Z]+$</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(arr[<span class="dv">1</span>]))</span>
<span id="cb16-727"><a href="#cb16-727" aria-hidden="true" tabindex="-1"></a>            <span class="op">?</span> [<span class="fu">unix2doty</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())[<span class="dv">0</span>]<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="fu">zone2hour</span>(arr[<span class="dv">1</span>]) <span class="op">/</span> <span class="dv">24</span>]</span>
<span id="cb16-728"><a href="#cb16-728" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> [<span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">1</span>])<span class="op">,</span> <span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb16-729"><a href="#cb16-729" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb16-730"><a href="#cb16-730" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">1</span>])<span class="op">,</span> <span class="ss">/</span><span class="sc">^[a-zA-Z]+$</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(arr[<span class="dv">2</span>])</span>
<span id="cb16-731"><a href="#cb16-731" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> <span class="fu">zone2hour</span>(arr[<span class="dv">2</span>]) <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb16-732"><a href="#cb16-732" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="pp">parseFloat</span>(arr[<span class="dv">2</span>]<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">([+-])</span><span class="ss">/</span><span class="op">,</span> <span class="st">"$1</span><span class="sc">\.</span><span class="st">"</span>))]<span class="op">;</span></span>
<span id="cb16-733"><a href="#cb16-733" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-734"><a href="#cb16-734" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">deco2deco</span>(timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span>) {</span>
<span id="cb16-735"><a href="#cb16-735" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2deco</span>(<span class="fu">deco2doty</span>(timestamp))</span>
<span id="cb16-736"><a href="#cb16-736" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-737"><a href="#cb16-737" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2doty</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-738"><a href="#cb16-738" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2doty</span>(<span class="fu">doty2dote</span>(year<span class="op">,</span> doty<span class="op">,</span> zone))<span class="op">;</span></span>
<span id="cb16-739"><a href="#cb16-739" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-740"><a href="#cb16-740" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2unix</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-741"><a href="#cb16-741" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="fu">doty2dote</span>(year<span class="op">,</span> doty<span class="op">,</span> zone) <span class="op">-</span> <span class="dv">719468</span>) <span class="op">*</span> <span class="dv">86400000</span><span class="op">;</span></span>
<span id="cb16-742"><a href="#cb16-742" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-743"><a href="#cb16-743" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2isoc</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-744"><a href="#cb16-744" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="fu">doty2unix</span>(year<span class="op">,</span> doty<span class="op">,</span> zone))<span class="op">.</span><span class="fu">toISOString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">0</span>]</span>
<span id="cb16-745"><a href="#cb16-745" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-746"><a href="#cb16-746" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">deco2isoc</span>(timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span>) {</span>
<span id="cb16-747"><a href="#cb16-747" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2isoc</span>(<span class="op">...</span><span class="fu">deco2doty</span>(timestamp))</span>
<span id="cb16-748"><a href="#cb16-748" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-749"><a href="#cb16-749" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-750"><a href="#cb16-750" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span><span class="op">;</span></span>
<span id="cb16-751"><a href="#cb16-751" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-752"><a href="#cb16-752" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2year</span>(days <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb16-753"><a href="#cb16-753" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb16-754"><a href="#cb16-754" aria-hidden="true" tabindex="-1"></a>        dotc <span class="op">=</span> days <span class="op">-</span> era <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb16-755"><a href="#cb16-755" aria-hidden="true" tabindex="-1"></a>        yotc <span class="op">=</span> (dotc <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)) <span class="op">/</span> <span class="dv">365</span><span class="op">;</span></span>
<span id="cb16-756"><a href="#cb16-756" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> yotc <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb16-757"><a href="#cb16-757" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-758"><a href="#cb16-758" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2year</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-759"><a href="#cb16-759" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2year</span>(<span class="fu">doty2dote</span>(year<span class="op">,</span> doty<span class="op">,</span> zone))<span class="op">;</span></span>
<span id="cb16-760"><a href="#cb16-760" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-761"><a href="#cb16-761" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2year</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-762"><a href="#cb16-762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2year</span>(<span class="fu">unix2dote</span>(ms))<span class="op">;</span></span>
<span id="cb16-763"><a href="#cb16-763" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="variables-1" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Variables</h2><div class="quarto-appendix-contents">

<div class="cell" data-output="all">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" data-startfrom="770" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 769;"><span id="cb17-770"><a href="#cb17-770" aria-hidden="true" tabindex="-1"></a>tzOffsetInMs <span class="op">=</span> inputDatetime<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">*</span> <span class="dv">60000</span></span>
<span id="cb17-771"><a href="#cb17-771" aria-hidden="true" tabindex="-1"></a>utcDatetime <span class="op">=</span> inputDatetime <span class="op">-</span> tzOffsetInMs</span>
<span id="cb17-772"><a href="#cb17-772" aria-hidden="true" tabindex="-1"></a>outputDatetimeDeco <span class="op">=</span> <span class="fu">unix2deco</span>(utcDatetime)</span>
<span id="cb17-773"><a href="#cb17-773" aria-hidden="true" tabindex="-1"></a>dtDoty <span class="op">=</span> outputDatetimeDeco<span class="op">.</span><span class="fu">split</span>(<span class="st">"+"</span>)[<span class="dv">1</span>]</span>
<span id="cb17-774"><a href="#cb17-774" aria-hidden="true" tabindex="-1"></a>dtDotyDateRaw <span class="op">=</span> dtDoty<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">0</span>]</span>
<span id="cb17-775"><a href="#cb17-775" aria-hidden="true" tabindex="-1"></a>dtDotyTimeRaw <span class="op">=</span> dtDoty<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">1</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb17-776"><a href="#cb17-776" aria-hidden="true" tabindex="-1"></a>outputDatetimeYear <span class="op">=</span> <span class="fu">unix2year</span>(utcDatetime)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb17-777"><a href="#cb17-777" aria-hidden="true" tabindex="-1"></a>dtDotyTimeDelimiter <span class="op">=</span> dtDotyTimeRaw <span class="op">?</span> <span class="st">"."</span> <span class="op">:</span> <span class="st">""</span></span>
<span id="cb17-778"><a href="#cb17-778" aria-hidden="true" tabindex="-1"></a>outputDecoYear <span class="op">=</span> <span class="fu">doty2year</span>(<span class="op">...</span>yd)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb17-779"><a href="#cb17-779" aria-hidden="true" tabindex="-1"></a>outputIsoc <span class="op">=</span> <span class="fu">doty2isoc</span>(<span class="op">...</span>yd)</span>
<span id="cb17-780"><a href="#cb17-780" aria-hidden="true" tabindex="-1"></a>yearDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(<span class="fu">unix2year</span>(unix) <span class="op">*</span> <span class="fl">1e3</span>) <span class="op">/</span> <span class="fl">1e3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" data-startfrom="784" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 783;"><span id="cb18-784"><a href="#cb18-784" aria-hidden="true" tabindex="-1"></a>dtYear <span class="op">=</span> <span class="fu">setStyle</span>(outputDatetimeDeco<span class="op">.</span><span class="fu">split</span>(<span class="st">"+"</span>)[<span class="dv">0</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb18-785"><a href="#cb18-785" aria-hidden="true" tabindex="-1"></a>dtDotyDate <span class="op">=</span> <span class="fu">setStyle</span>(dtDotyDateRaw<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb18-786"><a href="#cb18-786" aria-hidden="true" tabindex="-1"></a>dtDotyTime <span class="op">=</span> dtDotyTimeRaw <span class="op">?</span> <span class="fu">setStyle</span>(dtDotyTimeRaw<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>]) <span class="op">:</span> <span class="st">""</span></span>
<span id="cb18-787"><a href="#cb18-787" aria-hidden="true" tabindex="-1"></a>styledIsocYear <span class="op">=</span> <span class="fu">setStyle</span>(outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb18-788"><a href="#cb18-788" aria-hidden="true" tabindex="-1"></a>styledIsocMd <span class="op">=</span> <span class="fu">setStyle</span>(outputIsoc<span class="op">.</span><span class="fu">slice</span>(outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span><span class="op">+</span><span class="dv">1</span><span class="op">,</span>outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span><span class="op">+</span><span class="dv">6</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">5</span>])</span>
<span id="cb18-789"><a href="#cb18-789" aria-hidden="true" tabindex="-1"></a>styledIsocTime <span class="op">=</span> <span class="fu">setStyle</span>(outputIsoc<span class="op">.</span><span class="fu">slice</span>(outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span><span class="op">+</span><span class="dv">7</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">4</span>])</span>
<span id="cb18-790"><a href="#cb18-790" aria-hidden="true" tabindex="-1"></a>styledOutputDatetimeYear <span class="op">=</span> <span class="fu">setStyle</span>(outputDatetimeYear<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb18-791"><a href="#cb18-791" aria-hidden="true" tabindex="-1"></a>styledOutputDecoYear <span class="op">=</span> <span class="fu">setStyle</span>(outputDecoYear<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-8" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="sec-ojs-code-dek" class="level4 appendix"><h2 class="anchored quarto-appendix-heading"><code>Dek</code> Observable code</h2><div class="quarto-appendix-contents">




</div></section><section id="functions-2" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Functions</h2><div class="quarto-appendix-contents">

<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29" data-startfrom="978" data-source-offset="-50"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 977;"><span id="cb29-978"><a href="#cb29-978" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">interval</span>(range <span class="op">=</span> []<span class="op">,</span> options <span class="op">=</span> {}) {</span>
<span id="cb29-979"><a href="#cb29-979" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> [min <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> max <span class="op">=</span> <span class="dv">1</span>] <span class="op">=</span> range<span class="op">;</span></span>
<span id="cb29-980"><a href="#cb29-980" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb29-981"><a href="#cb29-981" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="op">.</span><span class="bn">001</span><span class="op">,</span></span>
<span id="cb29-982"><a href="#cb29-982" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb29-983"><a href="#cb29-983" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> [min<span class="op">,</span> max]<span class="op">,</span></span>
<span id="cb29-984"><a href="#cb29-984" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>start<span class="sc">}</span><span class="vs"> ‚Ä¶ </span><span class="sc">${</span>end<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb29-985"><a href="#cb29-985" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb29-986"><a href="#cb29-986" aria-hidden="true" tabindex="-1"></a>    width<span class="op">,</span></span>
<span id="cb29-987"><a href="#cb29-987" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">,</span></span>
<span id="cb29-988"><a href="#cb29-988" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> options<span class="op">;</span></span>
<span id="cb29-989"><a href="#cb29-989" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> __ns__ <span class="op">=</span> DOM<span class="op">.</span><span class="fu">uid</span>(<span class="st">'scope'</span>)<span class="op">.</span><span class="at">id</span><span class="op">;</span></span>
<span id="cb29-990"><a href="#cb29-990" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> css <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb29-991"><a href="#cb29-991" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb29-992"><a href="#cb29-992" aria-hidden="true" tabindex="-1"></a><span class="vs">  font: 13px/1.2 var(--sans-serif);</span></span>
<span id="cb29-993"><a href="#cb29-993" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: flex;</span></span>
<span id="cb29-994"><a href="#cb29-994" aria-hidden="true" tabindex="-1"></a><span class="vs">  align-items: baseline;</span></span>
<span id="cb29-995"><a href="#cb29-995" aria-hidden="true" tabindex="-1"></a><span class="vs">  flex-wrap: wrap;</span></span>
<span id="cb29-996"><a href="#cb29-996" aria-hidden="true" tabindex="-1"></a><span class="vs">  max-width: 100%;</span></span>
<span id="cb29-997"><a href="#cb29-997" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: auto;</span></span>
<span id="cb29-998"><a href="#cb29-998" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-999"><a href="#cb29-999" aria-hidden="true" tabindex="-1"></a><span class="vs">@media only screen and (min-width: 30em) {</span></span>
<span id="cb29-1000"><a href="#cb29-1000" aria-hidden="true" tabindex="-1"></a><span class="vs">  #</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb29-1001"><a href="#cb29-1001" aria-hidden="true" tabindex="-1"></a><span class="vs">    flex-wrap: nowrap;</span></span>
<span id="cb29-1002"><a href="#cb29-1002" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 360px;</span></span>
<span id="cb29-1003"><a href="#cb29-1003" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb29-1004"><a href="#cb29-1004" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1005"><a href="#cb29-1005" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .label {</span></span>
<span id="cb29-1006"><a href="#cb29-1006" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 50px;</span></span>
<span id="cb29-1007"><a href="#cb29-1007" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 5px 0 4px 0;</span></span>
<span id="cb29-1008"><a href="#cb29-1008" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-right: .5px;</span></span>
<span id="cb29-1009"><a href="#cb29-1009" aria-hidden="true" tabindex="-1"></a><span class="vs">  flex-shrink: 0;</span></span>
<span id="cb29-1010"><a href="#cb29-1010" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1011"><a href="#cb29-1011" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .form {</span></span>
<span id="cb29-1012"><a href="#cb29-1012" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: flex;</span></span>
<span id="cb29-1013"><a href="#cb29-1013" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb29-1014"><a href="#cb29-1014" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1015"><a href="#cb29-1015" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .range {</span></span>
<span id="cb29-1016"><a href="#cb29-1016" aria-hidden="true" tabindex="-1"></a><span class="vs">  flex-shrink: 1;</span></span>
<span id="cb29-1017"><a href="#cb29-1017" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb29-1018"><a href="#cb29-1018" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1019"><a href="#cb29-1019" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .range-slider {</span></span>
<span id="cb29-1020"><a href="#cb29-1020" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb29-1021"><a href="#cb29-1021" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1022"><a href="#cb29-1022" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb29-1023"><a href="#cb29-1023" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> $range <span class="op">=</span> <span class="fu">rangeInput</span>({min<span class="op">,</span> max<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [value[<span class="dv">0</span>]<span class="op">,</span> value[<span class="dv">1</span>]]<span class="op">,</span> step<span class="op">,</span> color<span class="op">,</span> width<span class="op">,</span> theme})<span class="op">;</span></span>
<span id="cb29-1024"><a href="#cb29-1024" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> $output <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;output&gt;`</span><span class="op">;</span></span>
<span id="cb29-1025"><a href="#cb29-1025" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> $view <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div id=</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs">&gt;</span></span>
<span id="cb29-1026"><a href="#cb29-1026" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>label <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="st">''</span> <span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;div class="label"&gt;</span><span class="sc">${</span>label<span class="sc">}</span><span class="vs">`</span><span class="sc">}</span></span>
<span id="cb29-1027"><a href="#cb29-1027" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div class=form&gt;</span></span>
<span id="cb29-1028"><a href="#cb29-1028" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class=range&gt;</span></span>
<span id="cb29-1029"><a href="#cb29-1029" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>$range<span class="sc">}</span><span class="vs">&lt;div class=range-output style="display: inline-block;"&gt;</span><span class="sc">${</span>$output<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb29-1030"><a href="#cb29-1030" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;</span></span>
<span id="cb29-1031"><a href="#cb29-1031" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb29-1032"><a href="#cb29-1032" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">html</span><span class="vs">`&lt;style&gt;</span><span class="sc">${</span>css<span class="sc">}</span><span class="vs">`</span><span class="sc">}</span></span>
<span id="cb29-1033"><a href="#cb29-1033" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb29-1034"><a href="#cb29-1034" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> update <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb29-1035"><a href="#cb29-1035" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> content <span class="op">=</span> <span class="fu">format</span>([$range<span class="op">.</span><span class="at">value</span>[<span class="dv">0</span>]<span class="op">,</span> $range<span class="op">.</span><span class="at">value</span>[<span class="dv">1</span>]])<span class="op">;</span></span>
<span id="cb29-1036"><a href="#cb29-1036" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="kw">typeof</span> content <span class="op">===</span> <span class="st">'string'</span>) $output<span class="op">.</span><span class="at">value</span> <span class="op">=</span> content<span class="op">;</span></span>
<span id="cb29-1037"><a href="#cb29-1037" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb29-1038"><a href="#cb29-1038" aria-hidden="true" tabindex="-1"></a>      <span class="cf">while</span>($output<span class="op">.</span><span class="at">lastChild</span>) $output<span class="op">.</span><span class="at">lastChild</span><span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb29-1039"><a href="#cb29-1039" aria-hidden="true" tabindex="-1"></a>      $output<span class="op">.</span><span class="fu">appendChild</span>(content)<span class="op">;</span></span>
<span id="cb29-1040"><a href="#cb29-1040" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1041"><a href="#cb29-1041" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1042"><a href="#cb29-1042" aria-hidden="true" tabindex="-1"></a>  $range<span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> update<span class="op">;</span></span>
<span id="cb29-1043"><a href="#cb29-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>()<span class="op">;</span></span>
<span id="cb29-1044"><a href="#cb29-1044" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">defineProperty</span>($view<span class="op">,</span> <span class="st">'value'</span><span class="op">,</span> {</span>
<span id="cb29-1045"><a href="#cb29-1045" aria-hidden="true" tabindex="-1"></a>    <span class="kw">get</span><span class="op">:</span> () <span class="kw">=&gt;</span> $range<span class="op">.</span><span class="at">value</span><span class="op">,</span></span>
<span id="cb29-1046"><a href="#cb29-1046" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span><span class="op">:</span> ([a<span class="op">,</span> b]) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1047"><a href="#cb29-1047" aria-hidden="true" tabindex="-1"></a>      $range<span class="op">.</span><span class="at">value</span> <span class="op">=</span> [a<span class="op">,</span> b]<span class="op">;</span></span>
<span id="cb29-1048"><a href="#cb29-1048" aria-hidden="true" tabindex="-1"></a>      <span class="fu">update</span>()<span class="op">;</span></span>
<span id="cb29-1049"><a href="#cb29-1049" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-1050"><a href="#cb29-1050" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb29-1051"><a href="#cb29-1051" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1052"><a href="#cb29-1052" aria-hidden="true" tabindex="-1"></a>cssLength <span class="op">=</span> v <span class="kw">=&gt;</span> v <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="kw">typeof</span> v <span class="op">===</span> <span class="st">'number'</span> <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>v<span class="sc">}</span><span class="vs">px`</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>v<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb29-1053"><a href="#cb29-1053" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">randomScope</span>(prefix <span class="op">=</span> <span class="st">'scope-'</span>) {</span>
<span id="cb29-1054"><a href="#cb29-1054" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> prefix <span class="op">+</span> (<span class="bu">performance</span><span class="op">.</span><span class="fu">now</span>() <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>())<span class="op">.</span><span class="fu">toString</span>(<span class="dv">32</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="st">'.'</span><span class="op">,</span> <span class="st">'-'</span>)<span class="op">;</span></span>
<span id="cb29-1055"><a href="#cb29-1055" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1056"><a href="#cb29-1056" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">rangeInput</span>(options <span class="op">=</span> {}) {</span>
<span id="cb29-1057"><a href="#cb29-1057" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb29-1058"><a href="#cb29-1058" aria-hidden="true" tabindex="-1"></a>    min <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb29-1059"><a href="#cb29-1059" aria-hidden="true" tabindex="-1"></a>    max <span class="op">=</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb29-1060"><a href="#cb29-1060" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="st">'any'</span><span class="op">,</span></span>
<span id="cb29-1061"><a href="#cb29-1061" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> defaultValue <span class="op">=</span> [min<span class="op">,</span> max]<span class="op">,</span></span>
<span id="cb29-1062"><a href="#cb29-1062" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb29-1063"><a href="#cb29-1063" aria-hidden="true" tabindex="-1"></a>    width<span class="op">,</span></span>
<span id="cb29-1064"><a href="#cb29-1064" aria-hidden="true" tabindex="-1"></a>    theme <span class="op">=</span> theme_Flat<span class="op">,</span></span>
<span id="cb29-1065"><a href="#cb29-1065" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> options<span class="op">;</span></span>
<span id="cb29-1066"><a href="#cb29-1066" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> controls <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb29-1067"><a href="#cb29-1067" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scope <span class="op">=</span> <span class="fu">randomScope</span>()<span class="op">;</span></span>
<span id="cb29-1068"><a href="#cb29-1068" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clamp <span class="op">=</span> (a<span class="op">,</span> b<span class="op">,</span> v) <span class="kw">=&gt;</span> v <span class="op">&lt;</span> a <span class="op">?</span> a <span class="op">:</span> v <span class="op">&gt;</span> b <span class="op">?</span> b <span class="op">:</span> v<span class="op">;</span></span>
<span id="cb29-1069"><a href="#cb29-1069" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> html <span class="op">=</span> htl<span class="op">.</span><span class="at">html</span><span class="op">;</span></span>
<span id="cb29-1070"><a href="#cb29-1070" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Will be used to sanitize values while avoiding floating point issues.</span></span>
<span id="cb29-1071"><a href="#cb29-1071" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> input <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;input type=range </span><span class="sc">${</span>{min<span class="op">,</span> max<span class="op">,</span> step}<span class="sc">}</span><span class="vs">&gt;`</span><span class="op">;</span></span>
<span id="cb29-1072"><a href="#cb29-1072" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dom <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class=</span><span class="sc">${</span><span class="vs">`</span><span class="sc">${</span>scope<span class="sc">}</span><span class="vs"> range-slider`</span><span class="sc">}</span><span class="vs"> style=</span><span class="sc">${</span>{</span>
<span id="cb29-1073"><a href="#cb29-1073" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb29-1074"><a href="#cb29-1074" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="fu">cssLength</span>(width)<span class="op">,</span></span>
<span id="cb29-1075"><a href="#cb29-1075" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span></span>
<span id="cb29-1076"><a href="#cb29-1076" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">track</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="range-track"&gt;</span></span>
<span id="cb29-1077"><a href="#cb29-1077" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">zone</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="range-track-zone"&gt;</span></span>
<span id="cb29-1078"><a href="#cb29-1078" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">range</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="range-select" tabindex=0&gt;</span></span>
<span id="cb29-1079"><a href="#cb29-1079" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">min</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="thumb thumb-min" tabindex=0&gt;`</span><span class="sc">}</span></span>
<span id="cb29-1080"><a href="#cb29-1080" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">max</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="thumb thumb-max" tabindex=0&gt;`</span><span class="sc">}</span></span>
<span id="cb29-1081"><a href="#cb29-1081" aria-hidden="true" tabindex="-1"></a><span class="vs">      `</span><span class="sc">}</span></span>
<span id="cb29-1082"><a href="#cb29-1082" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span><span class="sc">}</span></span>
<span id="cb29-1083"><a href="#cb29-1083" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="sc">}</span></span>
<span id="cb29-1084"><a href="#cb29-1084" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span><span class="fu">html</span><span class="vs">`&lt;style&gt;</span><span class="sc">${</span>theme<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/:scope</span><span class="sc">\b</span><span class="ss">/g</span><span class="op">,</span> <span class="st">'.'</span><span class="op">+</span>scope)<span class="sc">}</span><span class="vs">`</span><span class="sc">}</span></span>
<span id="cb29-1085"><a href="#cb29-1085" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb29-1086"><a href="#cb29-1086" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> value <span class="op">=</span> []<span class="op">,</span> changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1087"><a href="#cb29-1087" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">defineProperty</span>(dom<span class="op">,</span> <span class="st">'value'</span><span class="op">,</span> {</span>
<span id="cb29-1088"><a href="#cb29-1088" aria-hidden="true" tabindex="-1"></a>    <span class="kw">get</span><span class="op">:</span> () <span class="kw">=&gt;</span> [<span class="op">...</span>value]<span class="op">,</span></span>
<span id="cb29-1089"><a href="#cb29-1089" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span><span class="op">:</span> ([a<span class="op">,</span> b]) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1090"><a href="#cb29-1090" aria-hidden="true" tabindex="-1"></a>      value <span class="op">=</span> <span class="fu">sanitize</span>(a<span class="op">,</span> b)<span class="op">;</span></span>
<span id="cb29-1091"><a href="#cb29-1091" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateRange</span>()<span class="op">;</span></span>
<span id="cb29-1092"><a href="#cb29-1092" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-1093"><a href="#cb29-1093" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb29-1094"><a href="#cb29-1094" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sanitize <span class="op">=</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1095"><a href="#cb29-1095" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="pp">isNaN</span>(a) <span class="op">?</span> min <span class="op">:</span> ((input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> a)<span class="op">,</span> input<span class="op">.</span><span class="at">valueAsNumber</span>)<span class="op">;</span></span>
<span id="cb29-1096"><a href="#cb29-1096" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="pp">isNaN</span>(b) <span class="op">?</span> max <span class="op">:</span> ((input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> b)<span class="op">,</span> input<span class="op">.</span><span class="at">valueAsNumber</span>)<span class="op">;</span></span>
<span id="cb29-1097"><a href="#cb29-1097" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(a<span class="op">,</span> b)<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(a<span class="op">,</span> b)]<span class="op">;</span></span>
<span id="cb29-1098"><a href="#cb29-1098" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1099"><a href="#cb29-1099" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updateRange <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb29-1100"><a href="#cb29-1100" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ratio <span class="op">=</span> v <span class="kw">=&gt;</span> (v <span class="op">-</span> min) <span class="op">/</span> (max <span class="op">-</span> min)<span class="op">;</span></span>
<span id="cb29-1101"><a href="#cb29-1101" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="fu">setProperty</span>(<span class="st">'--range-min'</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">ratio</span>(value[<span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span><span class="sc">}</span><span class="vs">%`</span>)<span class="op">;</span></span>
<span id="cb29-1102"><a href="#cb29-1102" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="fu">setProperty</span>(<span class="st">'--range-max'</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">ratio</span>(value[<span class="dv">1</span>]) <span class="op">*</span> <span class="dv">100</span><span class="sc">}</span><span class="vs">%`</span>)<span class="op">;</span></span>
<span id="cb29-1103"><a href="#cb29-1103" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1104"><a href="#cb29-1104" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dispatch <span class="op">=</span> name <span class="kw">=&gt;</span> {</span>
<span id="cb29-1105"><a href="#cb29-1105" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(name<span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb29-1106"><a href="#cb29-1106" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1107"><a href="#cb29-1107" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> setValue <span class="op">=</span> (vmin<span class="op">,</span> vmax) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1108"><a href="#cb29-1108" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [pmin<span class="op">,</span> pmax] <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb29-1109"><a href="#cb29-1109" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> <span class="fu">sanitize</span>(vmin<span class="op">,</span> vmax)<span class="op">;</span></span>
<span id="cb29-1110"><a href="#cb29-1110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateRange</span>()<span class="op">;</span></span>
<span id="cb29-1111"><a href="#cb29-1111" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Only dispatch if values have changed.</span></span>
<span id="cb29-1112"><a href="#cb29-1112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(pmin <span class="op">===</span> value[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> pmax <span class="op">===</span> value[<span class="dv">1</span>]) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1113"><a href="#cb29-1113" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatch</span>(<span class="st">'input'</span>)<span class="op">;</span></span>
<span id="cb29-1114"><a href="#cb29-1114" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-1115"><a href="#cb29-1115" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1116"><a href="#cb29-1116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setValue</span>(<span class="op">...</span>defaultValue)<span class="op">;</span></span>
<span id="cb29-1117"><a href="#cb29-1117" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mousemove handlers.</span></span>
<span id="cb29-1118"><a href="#cb29-1118" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handlers <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb29-1119"><a href="#cb29-1119" aria-hidden="true" tabindex="-1"></a>    [controls<span class="op">.</span><span class="at">min</span><span class="op">,</span> (dt<span class="op">,</span> ov) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1120"><a href="#cb29-1120" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> v <span class="op">=</span> <span class="fu">clamp</span>(min<span class="op">,</span> ov[<span class="dv">1</span>]<span class="op">,</span> ov[<span class="dv">0</span>] <span class="op">+</span> dt <span class="op">*</span> (max <span class="op">-</span> min))<span class="op">;</span></span>
<span id="cb29-1121"><a href="#cb29-1121" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span>(v<span class="op">,</span> ov[<span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb29-1122"><a href="#cb29-1122" aria-hidden="true" tabindex="-1"></a>    }]<span class="op">,</span></span>
<span id="cb29-1123"><a href="#cb29-1123" aria-hidden="true" tabindex="-1"></a>    [controls<span class="op">.</span><span class="at">max</span><span class="op">,</span> (dt<span class="op">,</span> ov) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1124"><a href="#cb29-1124" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> v <span class="op">=</span> <span class="fu">clamp</span>(ov[<span class="dv">0</span>]<span class="op">,</span> max<span class="op">,</span> ov[<span class="dv">1</span>] <span class="op">+</span> dt <span class="op">*</span> (max <span class="op">-</span> min))<span class="op">;</span></span>
<span id="cb29-1125"><a href="#cb29-1125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span>(ov[<span class="dv">0</span>]<span class="op">,</span> v)<span class="op">;</span></span>
<span id="cb29-1126"><a href="#cb29-1126" aria-hidden="true" tabindex="-1"></a>    }]<span class="op">,</span></span>
<span id="cb29-1127"><a href="#cb29-1127" aria-hidden="true" tabindex="-1"></a>    [controls<span class="op">.</span><span class="at">range</span><span class="op">,</span> (dt<span class="op">,</span> ov) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1128"><a href="#cb29-1128" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> d <span class="op">=</span> ov[<span class="dv">1</span>] <span class="op">-</span> ov[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb29-1129"><a href="#cb29-1129" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> v <span class="op">=</span> <span class="fu">clamp</span>(min<span class="op">,</span> max <span class="op">-</span> d<span class="op">,</span> ov[<span class="dv">0</span>] <span class="op">+</span> dt <span class="op">*</span> (max <span class="op">-</span> min))<span class="op">;</span></span>
<span id="cb29-1130"><a href="#cb29-1130" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span>(v<span class="op">,</span> v <span class="op">+</span> d)<span class="op">;</span></span>
<span id="cb29-1131"><a href="#cb29-1131" aria-hidden="true" tabindex="-1"></a>    }]<span class="op">,</span></span>
<span id="cb29-1132"><a href="#cb29-1132" aria-hidden="true" tabindex="-1"></a>  ])<span class="op">;</span></span>
<span id="cb29-1133"><a href="#cb29-1133" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Returns client offset object.</span></span>
<span id="cb29-1134"><a href="#cb29-1134" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointer <span class="op">=</span> e <span class="kw">=&gt;</span> e<span class="op">.</span><span class="at">touches</span> <span class="op">?</span> e<span class="op">.</span><span class="at">touches</span>[<span class="dv">0</span>] <span class="op">:</span> e<span class="op">;</span></span>
<span id="cb29-1135"><a href="#cb29-1135" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Note: Chrome defaults "passive" for touch events to true.</span></span>
<span id="cb29-1136"><a href="#cb29-1136" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> on  <span class="op">=</span> (e<span class="op">,</span> fn) <span class="kw">=&gt;</span> e<span class="op">.</span><span class="fu">split</span>(<span class="st">' '</span>)<span class="op">.</span><span class="fu">map</span>(e <span class="kw">=&gt;</span> <span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(e<span class="op">,</span> fn<span class="op">,</span> {<span class="dt">passive</span><span class="op">:</span> <span class="kw">false</span>}))<span class="op">;</span></span>
<span id="cb29-1137"><a href="#cb29-1137" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> off <span class="op">=</span> (e<span class="op">,</span> fn) <span class="kw">=&gt;</span> e<span class="op">.</span><span class="fu">split</span>(<span class="st">' '</span>)<span class="op">.</span><span class="fu">map</span>(e <span class="kw">=&gt;</span> <span class="bu">document</span><span class="op">.</span><span class="fu">removeEventListener</span>(e<span class="op">,</span> fn<span class="op">,</span> {<span class="dt">passive</span><span class="op">:</span> <span class="kw">false</span>}))<span class="op">;</span></span>
<span id="cb29-1138"><a href="#cb29-1138" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> initialX<span class="op">,</span> initialV<span class="op">,</span> target<span class="op">,</span> dragging <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1139"><a href="#cb29-1139" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">handleDrag</span>(e) {</span>
<span id="cb29-1140"><a href="#cb29-1140" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Gracefully handle exit and reentry of the viewport.</span></span>
<span id="cb29-1141"><a href="#cb29-1141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>e<span class="op">.</span><span class="at">buttons</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>e<span class="op">.</span><span class="at">touches</span>) {</span>
<span id="cb29-1142"><a href="#cb29-1142" aria-hidden="true" tabindex="-1"></a>      <span class="fu">handleDragStop</span>()<span class="op">;</span></span>
<span id="cb29-1143"><a href="#cb29-1143" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1144"><a href="#cb29-1144" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1145"><a href="#cb29-1145" aria-hidden="true" tabindex="-1"></a>    dragging <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-1146"><a href="#cb29-1146" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> w <span class="op">=</span> controls<span class="op">.</span><span class="at">zone</span><span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb29-1147"><a href="#cb29-1147" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb29-1148"><a href="#cb29-1148" aria-hidden="true" tabindex="-1"></a>    handlers<span class="op">.</span><span class="fu">get</span>(target)((<span class="fu">pointer</span>(e)<span class="op">.</span><span class="at">clientX</span> <span class="op">-</span> initialX) <span class="op">/</span> w<span class="op">,</span> initialV)<span class="op">;</span></span>
<span id="cb29-1149"><a href="#cb29-1149" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1150"><a href="#cb29-1150" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">handleDragStop</span>(e) {</span>
<span id="cb29-1151"><a href="#cb29-1151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">off</span>(<span class="st">'mousemove touchmove'</span><span class="op">,</span> handleDrag)<span class="op">;</span></span>
<span id="cb29-1152"><a href="#cb29-1152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">off</span>(<span class="st">'mouseup touchend'</span><span class="op">,</span> handleDragStop)<span class="op">;</span></span>
<span id="cb29-1153"><a href="#cb29-1153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(changed) <span class="fu">dispatch</span>(<span class="st">'change'</span>)<span class="op">;</span></span>
<span id="cb29-1154"><a href="#cb29-1154" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1155"><a href="#cb29-1155" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(handleDragStop)<span class="op">;</span></span>
<span id="cb29-1156"><a href="#cb29-1156" aria-hidden="true" tabindex="-1"></a>  dom<span class="op">.</span><span class="at">ontouchstart</span> <span class="op">=</span> dom<span class="op">.</span><span class="at">onmousedown</span> <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb29-1157"><a href="#cb29-1157" aria-hidden="true" tabindex="-1"></a>    dragging <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1158"><a href="#cb29-1158" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1159"><a href="#cb29-1159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>handlers<span class="op">.</span><span class="fu">has</span>(e<span class="op">.</span><span class="at">target</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1160"><a href="#cb29-1160" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on</span>(<span class="st">'mousemove touchmove'</span><span class="op">,</span> handleDrag)<span class="op">;</span></span>
<span id="cb29-1161"><a href="#cb29-1161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on</span>(<span class="st">'mouseup touchend'</span><span class="op">,</span> handleDragStop)<span class="op">;</span></span>
<span id="cb29-1162"><a href="#cb29-1162" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb29-1163"><a href="#cb29-1163" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">stopPropagation</span>()<span class="op">;</span></span>
<span id="cb29-1164"><a href="#cb29-1164" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb29-1165"><a href="#cb29-1165" aria-hidden="true" tabindex="-1"></a>    initialX <span class="op">=</span> <span class="fu">pointer</span>(e)<span class="op">.</span><span class="at">clientX</span><span class="op">;</span></span>
<span id="cb29-1166"><a href="#cb29-1166" aria-hidden="true" tabindex="-1"></a>    initialV <span class="op">=</span> value<span class="op">.</span><span class="fu">slice</span>()<span class="op">;</span></span>
<span id="cb29-1167"><a href="#cb29-1167" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1168"><a href="#cb29-1168" aria-hidden="true" tabindex="-1"></a>  controls<span class="op">.</span><span class="at">track</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb29-1169"><a href="#cb29-1169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(dragging) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1170"><a href="#cb29-1170" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1171"><a href="#cb29-1171" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> r <span class="op">=</span> controls<span class="op">.</span><span class="at">zone</span><span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">;</span></span>
<span id="cb29-1172"><a href="#cb29-1172" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> t <span class="op">=</span> <span class="fu">clamp</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> (<span class="fu">pointer</span>(e)<span class="op">.</span><span class="at">clientX</span> <span class="op">-</span> r<span class="op">.</span><span class="at">left</span>) <span class="op">/</span> r<span class="op">.</span><span class="at">width</span>)<span class="op">;</span></span>
<span id="cb29-1173"><a href="#cb29-1173" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> v <span class="op">=</span> min <span class="op">+</span> t <span class="op">*</span> (max <span class="op">-</span> min)<span class="op">;</span></span>
<span id="cb29-1174"><a href="#cb29-1174" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [vmin<span class="op">,</span> vmax] <span class="op">=</span> value<span class="op">,</span> d <span class="op">=</span> vmax <span class="op">-</span> vmin<span class="op">;</span></span>
<span id="cb29-1175"><a href="#cb29-1175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(v <span class="op">&lt;</span> vmin) <span class="fu">setValue</span>(v<span class="op">,</span> v <span class="op">+</span> d)<span class="op">;</span></span>
<span id="cb29-1176"><a href="#cb29-1176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(v <span class="op">&gt;</span> vmax) <span class="fu">setValue</span>(v <span class="op">-</span> d<span class="op">,</span> v)<span class="op">;</span></span>
<span id="cb29-1177"><a href="#cb29-1177" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(changed) <span class="fu">dispatch</span>(<span class="st">'change'</span>)<span class="op">;</span></span>
<span id="cb29-1178"><a href="#cb29-1178" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1179"><a href="#cb29-1179" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dom<span class="op">;</span></span>
<span id="cb29-1180"><a href="#cb29-1180" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1181"><a href="#cb29-1181" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">formatDecimal</span>(number) {</span>
<span id="cb29-1182"><a href="#cb29-1182" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> number <span class="op">==</span> <span class="dv">1</span> <span class="op">?</span> number <span class="op">:</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(number <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> <span class="dv">100</span>)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb29-1183"><a href="#cb29-1183" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1184"><a href="#cb29-1184" aria-hidden="true" tabindex="-1"></a>button <span class="op">=</span> (data<span class="op">,</span> filename <span class="op">=</span> <span class="st">'data.csv'</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1185"><a href="#cb29-1185" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>data) <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">'Array of data required as first argument'</span>)<span class="op">;</span></span>
<span id="cb29-1186"><a href="#cb29-1186" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> downloadData<span class="op">;</span></span>
<span id="cb29-1187"><a href="#cb29-1187" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (filename<span class="op">.</span><span class="fu">includes</span>(<span class="st">'.csv'</span>)) {</span>
<span id="cb29-1188"><a href="#cb29-1188" aria-hidden="true" tabindex="-1"></a>    downloadData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([d3<span class="op">.</span><span class="fu">csvFormat</span>(data)]<span class="op">,</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"text/csv"</span> })<span class="op">;</span></span>
<span id="cb29-1189"><a href="#cb29-1189" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-1190"><a href="#cb29-1190" aria-hidden="true" tabindex="-1"></a>    downloadData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(data<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span>)]<span class="op">,</span> {</span>
<span id="cb29-1191"><a href="#cb29-1191" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"application/json"</span></span>
<span id="cb29-1192"><a href="#cb29-1192" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb29-1193"><a href="#cb29-1193" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1194"><a href="#cb29-1194" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> DOM<span class="op">.</span><span class="fu">download</span>(</span>
<span id="cb29-1195"><a href="#cb29-1195" aria-hidden="true" tabindex="-1"></a>    downloadData<span class="op">,</span></span>
<span id="cb29-1196"><a href="#cb29-1196" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">,</span></span>
<span id="cb29-1197"><a href="#cb29-1197" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Download"</span></span>
<span id="cb29-1198"><a href="#cb29-1198" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1199"><a href="#cb29-1199" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1200"><a href="#cb29-1200" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">invert</span>(arr) {</span>
<span id="cb29-1201"><a href="#cb29-1201" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> invertDotd <span class="op">?</span> [<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]<span class="op">.</span><span class="fu">map</span>(n <span class="kw">=&gt;</span> <span class="op">!</span>arr<span class="op">.</span><span class="fu">includes</span>(n))<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> x <span class="op">?</span> i <span class="op">:</span> <span class="kw">null</span>)<span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> i <span class="op">!==</span> <span class="kw">null</span>) <span class="op">:</span> arr</span>
<span id="cb29-1202"><a href="#cb29-1202" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1203"><a href="#cb29-1203" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb29-1204"><a href="#cb29-1204" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">toggleSwitch</span>(options <span class="op">=</span> { <span class="dt">textOn</span><span class="op">:</span> <span class="st">'True'</span><span class="op">,</span> <span class="dt">textOff</span><span class="op">:</span> <span class="st">'False'</span> }) {</span>
<span id="cb29-1205"><a href="#cb29-1205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> button <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="button-switch""&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb29-1206"><a href="#cb29-1206" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> options<span class="op">.</span><span class="at">textOn</span><span class="op">;</span></span>
<span id="cb29-1207"><a href="#cb29-1207" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-1208"><a href="#cb29-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1209"><a href="#cb29-1209" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb29-1210"><a href="#cb29-1210" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>button<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb29-1211"><a href="#cb29-1211" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> button<span class="op">.</span><span class="at">value</span> <span class="op">?</span> options<span class="op">.</span><span class="at">textOn</span> <span class="op">:</span> options<span class="op">.</span><span class="at">textOff</span><span class="op">;</span></span>
<span id="cb29-1212"><a href="#cb29-1212" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span>))<span class="op">;</span></span>
<span id="cb29-1213"><a href="#cb29-1213" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1214"><a href="#cb29-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1215"><a href="#cb29-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addButtonStyle</span>()</span>
<span id="cb29-1216"><a href="#cb29-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1217"><a href="#cb29-1217" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> button<span class="op">;</span></span>
<span id="cb29-1218"><a href="#cb29-1218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1219"><a href="#cb29-1219" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb29-1220"><a href="#cb29-1220" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">addButtonStyle</span>() {</span>
<span id="cb29-1221"><a href="#cb29-1221" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'style'</span>)<span class="op">;</span></span>
<span id="cb29-1222"><a href="#cb29-1222" aria-hidden="true" tabindex="-1"></a>  el<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">'type'</span><span class="op">,</span> <span class="st">'text/css'</span>)<span class="op">;</span></span>
<span id="cb29-1223"><a href="#cb29-1223" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="at">head</span><span class="op">.</span><span class="fu">appendChild</span>(el)<span class="op">;</span></span>
<span id="cb29-1224"><a href="#cb29-1224" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> el<span class="op">.</span><span class="at">sheet</span><span class="op">;</span></span>
<span id="cb29-1225"><a href="#cb29-1225" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">addRule</span>(rule) {</span>
<span id="cb29-1226"><a href="#cb29-1226" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb29-1227"><a href="#cb29-1227" aria-hidden="true" tabindex="-1"></a>      sheet<span class="op">.</span><span class="fu">insertRule</span>(rule<span class="op">,</span> sheet<span class="op">.</span><span class="at">cssRules</span><span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb29-1228"><a href="#cb29-1228" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">catch</span> (e) {</span>
<span id="cb29-1229"><a href="#cb29-1229" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">warn</span>(<span class="st">'Error inserting rule'</span><span class="op">,</span> rule<span class="op">,</span> e)<span class="op">;</span></span>
<span id="cb29-1230"><a href="#cb29-1230" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1231"><a href="#cb29-1231" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1232"><a href="#cb29-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span>(</span>
<span id="cb29-1233"><a href="#cb29-1233" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.button-switch { -webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;display: inline-block;-webkit-border-radius: 2px;-moz-border-radius: 2px;border-radius: 2px;background-color: #EFEFEF;padding: 0px 7px 0px 7px;text-align: center;border: 1px solid grey;width: auto;color: #1c1c1c;font-size: 14px;font-family: sans-serif;text-decoration: none; }'</span></span>
<span id="cb29-1234"><a href="#cb29-1234" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1235"><a href="#cb29-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span>(</span>
<span id="cb29-1236"><a href="#cb29-1236" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.button-switch:hover { background-color: #E5E5E5;border: 1px solid #454545; }'</span></span>
<span id="cb29-1237"><a href="#cb29-1237" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1238"><a href="#cb29-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span>(</span>
<span id="cb29-1239"><a href="#cb29-1239" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.button-switch:active { background-color: #f5f5f5;border: 1px solid grey; }'</span></span>
<span id="cb29-1240"><a href="#cb29-1240" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1241"><a href="#cb29-1241" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1242"><a href="#cb29-1242" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setSpreadDotd</span>(dotd) {</span>
<span id="cb29-1243"><a href="#cb29-1243" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dotdLength <span class="op">=</span> dotd<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb29-1244"><a href="#cb29-1244" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">10</span>) {<span class="cf">return</span> <span class="st">"&gt;"</span>}</span>
<span id="cb29-1245"><a href="#cb29-1245" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">0</span>) {<span class="cf">return</span> <span class="st">"&gt;0"</span>}</span>
<span id="cb29-1246"><a href="#cb29-1246" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">1</span>) {<span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>dotd[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">&gt;&gt;1&gt;9`</span>}</span>
<span id="cb29-1247"><a href="#cb29-1247" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> steps <span class="op">=</span> dotd<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> dotd[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> x)</span>
<span id="cb29-1248"><a href="#cb29-1248" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(i))<span class="op">,</span></span>
<span id="cb29-1249"><a href="#cb29-1249" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb29-1250"><a href="#cb29-1250" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> split <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-1251"><a href="#cb29-1251" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> step <span class="kw">of</span> steps) {</span>
<span id="cb29-1252"><a href="#cb29-1252" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (step <span class="op">!==</span> <span class="dv">1</span>) {</span>
<span id="cb29-1253"><a href="#cb29-1253" aria-hidden="true" tabindex="-1"></a>       result<span class="op">.</span><span class="fu">push</span>([split<span class="op">,</span> step <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb29-1254"><a href="#cb29-1254" aria-hidden="true" tabindex="-1"></a>       split <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb29-1255"><a href="#cb29-1255" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb29-1256"><a href="#cb29-1256" aria-hidden="true" tabindex="-1"></a>      split <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb29-1257"><a href="#cb29-1257" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1258"><a href="#cb29-1258" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1259"><a href="#cb29-1259" aria-hidden="true" tabindex="-1"></a>  result<span class="op">.</span><span class="fu">push</span>(split)</span>
<span id="cb29-1260"><a href="#cb29-1260" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> flat <span class="op">=</span> []<span class="op">.</span><span class="fu">concat</span>(<span class="op">...</span>result)<span class="op">,</span></span>
<span id="cb29-1261"><a href="#cb29-1261" aria-hidden="true" tabindex="-1"></a>    resultSum <span class="op">=</span> flat<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb29-1262"><a href="#cb29-1262" aria-hidden="true" tabindex="-1"></a>    uniq <span class="op">=</span> [<span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(flat)]<span class="op">;</span></span>
<span id="cb29-1263"><a href="#cb29-1263" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [dotd[<span class="dv">0</span>] <span class="op">?</span> dotd[<span class="dv">0</span>] <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">null</span>]<span class="op">.</span><span class="fu">concat</span>(<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(uniq) <span class="op">===</span> <span class="st">"[1]"</span> <span class="op">?</span> [<span class="kw">null</span><span class="op">,</span> <span class="dv">1</span>] <span class="op">:</span> uniq<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> uniq<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>) <span class="op">===</span> <span class="dv">5</span> <span class="op">?</span> uniq <span class="op">:</span> flat<span class="op">.</span><span class="fu">concat</span>(<span class="dv">10</span> <span class="op">-</span> resultSum)<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> i <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> x <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> x))<span class="op">.</span><span class="fu">join</span>(<span class="st">"&gt;"</span>)</span>
<span id="cb29-1264"><a href="#cb29-1264" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1265"><a href="#cb29-1265" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setSliceDotd</span>(dotd) {</span>
<span id="cb29-1266"><a href="#cb29-1266" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dotdLength <span class="op">=</span> dotd<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb29-1267"><a href="#cb29-1267" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">10</span>) {<span class="cf">return</span> <span class="st">":"</span>}</span>
<span id="cb29-1268"><a href="#cb29-1268" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">0</span>) {<span class="cf">return</span> <span class="st">":0"</span>}</span>
<span id="cb29-1269"><a href="#cb29-1269" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> steps <span class="op">=</span> dotd<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> dotd[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> x)</span>
<span id="cb29-1270"><a href="#cb29-1270" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(i))<span class="op">,</span></span>
<span id="cb29-1271"><a href="#cb29-1271" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">=</span> steps<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb29-1272"><a href="#cb29-1272" aria-hidden="true" tabindex="-1"></a>    uniq <span class="op">=</span> [<span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(steps<span class="op">.</span><span class="fu">concat</span>(<span class="dv">10</span> <span class="op">-</span> stepSum))]<span class="op">;</span></span>
<span id="cb29-1273"><a href="#cb29-1273" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [dotd[<span class="dv">0</span>] <span class="op">?</span> dotd[<span class="dv">0</span>] <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">null</span>]<span class="op">.</span><span class="fu">concat</span>(uniq<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> uniq <span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(steps) <span class="op">===</span> <span class="st">"[1,4,1]"</span> <span class="op">?</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">4</span>] <span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(steps) <span class="op">===</span> <span class="st">"[1,1,3,1,1]"</span> <span class="op">?</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">3</span>] <span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(steps) <span class="op">===</span> <span class="st">"[1,1,1,2,1,1,1]"</span> <span class="op">?</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>] <span class="op">:</span> steps<span class="op">.</span><span class="fu">concat</span>(<span class="dv">10</span> <span class="op">-</span> stepSum)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> x <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> x))<span class="op">.</span><span class="fu">join</span>(<span class="st">":"</span>)<span class="op">;</span></span>
<span id="cb29-1274"><a href="#cb29-1274" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1275"><a href="#cb29-1275" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">encodeSlice</span>(<span class="op">...</span>args) {</span>
<span id="cb29-1276"><a href="#cb29-1276" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> args<span class="op">.</span><span class="fu">join</span>()<span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">","</span><span class="op">,</span> <span class="st">":"</span>)</span>
<span id="cb29-1277"><a href="#cb29-1277" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1278"><a href="#cb29-1278" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">decodeSlice</span>(s) {</span>
<span id="cb29-1279"><a href="#cb29-1279" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> [start<span class="op">,</span> stop<span class="op">,</span> <span class="op">...</span>steps] <span class="op">=</span> s<span class="op">.</span><span class="fu">split</span>(<span class="st">":"</span>)<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">===</span> <span class="st">""</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span>(i))</span>
<span id="cb29-1280"><a href="#cb29-1280" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> step <span class="op">=</span> steps[<span class="dv">0</span>] <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span><span class="op">:</span> steps[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb29-1281"><a href="#cb29-1281" aria-hidden="true" tabindex="-1"></a>  start <span class="op">=</span> start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">365</span> <span class="op">:</span> start<span class="op">;</span></span>
<span id="cb29-1282"><a href="#cb29-1282" aria-hidden="true" tabindex="-1"></a>  stop <span class="op">=</span> stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">366</span> <span class="op">:</span> stop<span class="op">;</span></span>
<span id="cb29-1283"><a href="#cb29-1283" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [start<span class="op">,</span> stop<span class="op">,</span> step]</span>
<span id="cb29-1284"><a href="#cb29-1284" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1285"><a href="#cb29-1285" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">decodeSpread</span>(spread) {</span>
<span id="cb29-1286"><a href="#cb29-1286" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> spread<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^</span><span class="ss">&lt;/</span><span class="op">,</span> <span class="st">"366&lt;"</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^</span><span class="ss">&gt;/</span><span class="op">,</span> <span class="st">"0&gt;"</span>)</span>
<span id="cb29-1287"><a href="#cb29-1287" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=^</span><span class="sc">\d|</span><span class="ss">&lt;</span><span class="sc">|</span><span class="ss">&gt;</span><span class="sc">)</span><span class="ss">/</span>)<span class="op">.</span><span class="fu">map</span>(s <span class="kw">=&gt;</span> s<span class="op">.</span><span class="fu">replace</span>(<span class="st">"&lt;"</span><span class="op">,</span> <span class="st">"-"</span>)</span>
<span id="cb29-1288"><a href="#cb29-1288" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">replace</span>(<span class="st">"&gt;"</span><span class="op">,</span> <span class="st">""</span>))<span class="op">.</span><span class="fu">map</span>(s <span class="kw">=&gt;</span> s <span class="op">===</span> <span class="st">""</span> <span class="op">||</span> <span class="pp">isNaN</span>(s) <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span>(s))</span>
<span id="cb29-1289"><a href="#cb29-1289" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1290"><a href="#cb29-1290" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">encodeSpread</span>(args) {</span>
<span id="cb29-1291"><a href="#cb29-1291" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> args<span class="op">.</span><span class="fu">map</span>(a <span class="kw">=&gt;</span> <span class="pp">isNaN</span>(a) <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> a)<span class="op">.</span><span class="fu">join</span>(<span class="st">"&gt;"</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="st">"&gt;-"</span><span class="op">,</span> <span class="st">"&lt;"</span>)</span>
<span id="cb29-1292"><a href="#cb29-1292" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1293"><a href="#cb29-1293" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">slice</span>(self<span class="op">,</span> start<span class="op">,</span> stop<span class="op">,</span> steps<span class="op">,</span> <span class="op">...</span>args) {</span>
<span id="cb29-1294"><a href="#cb29-1294" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> len <span class="op">=</span> self<span class="op">.</span><span class="at">length</span><span class="op">,</span> result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb29-1295"><a href="#cb29-1295" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (steps <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> len <span class="op">===</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1296"><a href="#cb29-1296" aria-hidden="true" tabindex="-1"></a>  steps <span class="op">=</span> (<span class="op">!</span>steps <span class="op">||</span> steps<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> [<span class="dv">1</span>] <span class="op">:</span></span>
<span id="cb29-1297"><a href="#cb29-1297" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> steps <span class="op">===</span> <span class="st">"number"</span> <span class="op">?</span> [steps] <span class="op">:</span></span>
<span id="cb29-1298"><a href="#cb29-1298" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> steps <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(steps<span class="op">,</span> <span class="bu">Number</span>) <span class="op">:</span></span>
<span id="cb29-1299"><a href="#cb29-1299" aria-hidden="true" tabindex="-1"></a>    steps)<span class="op">.</span><span class="fu">concat</span>(args<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> i))<span class="op">;</span></span>
<span id="cb29-1300"><a href="#cb29-1300" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stepCount <span class="op">=</span> steps<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb29-1301"><a href="#cb29-1301" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">=</span> steps<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1302"><a href="#cb29-1302" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stepSum <span class="op">===</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1303"><a href="#cb29-1303" aria-hidden="true" tabindex="-1"></a>  start <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb29-1304"><a href="#cb29-1304" aria-hidden="true" tabindex="-1"></a>    start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span></span>
<span id="cb29-1305"><a href="#cb29-1305" aria-hidden="true" tabindex="-1"></a>    start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span></span>
<span id="cb29-1306"><a href="#cb29-1306" aria-hidden="true" tabindex="-1"></a>    start <span class="op">&gt;=</span> len <span class="op">?</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span></span>
<span id="cb29-1307"><a href="#cb29-1307" aria-hidden="true" tabindex="-1"></a>    start <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> start <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb29-1308"><a href="#cb29-1308" aria-hidden="true" tabindex="-1"></a>    start<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1309"><a href="#cb29-1309" aria-hidden="true" tabindex="-1"></a>  stop <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb29-1310"><a href="#cb29-1310" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb29-1311"><a href="#cb29-1311" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span></span>
<span id="cb29-1312"><a href="#cb29-1312" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">&gt;=</span> len <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb29-1313"><a href="#cb29-1313" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> stop <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb29-1314"><a href="#cb29-1314" aria-hidden="true" tabindex="-1"></a>    stop<span class="op">,</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb29-1315"><a href="#cb29-1315" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (</span>
<span id="cb29-1316"><a href="#cb29-1316" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> i <span class="op">=</span> start<span class="op">,</span> counter <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-1317"><a href="#cb29-1317" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> i <span class="op">&lt;</span> stop <span class="op">:</span> i <span class="op">&gt;</span> stop<span class="op">;</span></span>
<span id="cb29-1318"><a href="#cb29-1318" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> steps[counter]</span>
<span id="cb29-1319"><a href="#cb29-1319" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb29-1320"><a href="#cb29-1320" aria-hidden="true" tabindex="-1"></a>    result<span class="op">.</span><span class="fu">push</span>(self[i])<span class="op">;</span></span>
<span id="cb29-1321"><a href="#cb29-1321" aria-hidden="true" tabindex="-1"></a>    counter <span class="op">=</span> (counter <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> stepCount<span class="op">;</span></span>
<span id="cb29-1322"><a href="#cb29-1322" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1323"><a href="#cb29-1323" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb29-1324"><a href="#cb29-1324" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1325"><a href="#cb29-1325" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">spread</span>(self<span class="op">,</span> startOrStop<span class="op">,</span> span<span class="op">,</span> splitsAndSpaces<span class="op">,</span> <span class="op">...</span>args) {</span>
<span id="cb29-1326"><a href="#cb29-1326" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> len <span class="op">=</span> self<span class="op">.</span><span class="at">length</span><span class="op">,</span> result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb29-1327"><a href="#cb29-1327" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (span <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> len <span class="op">===</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1328"><a href="#cb29-1328" aria-hidden="true" tabindex="-1"></a>  splitsAndSpaces <span class="op">=</span> (<span class="op">!</span>splitsAndSpaces <span class="op">||</span> splitsAndSpaces<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> [<span class="dv">1</span>] <span class="op">:</span></span>
<span id="cb29-1329"><a href="#cb29-1329" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> splitsAndSpaces <span class="op">===</span> <span class="st">"number"</span> <span class="op">?</span> [splitsAndSpaces] <span class="op">:</span></span>
<span id="cb29-1330"><a href="#cb29-1330" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> splitsAndSpaces <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(splitsAndSpaces<span class="op">,</span> <span class="bu">Number</span>) <span class="op">:</span></span>
<span id="cb29-1331"><a href="#cb29-1331" aria-hidden="true" tabindex="-1"></a>    splitsAndSpaces)<span class="op">.</span><span class="fu">concat</span>(args<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> i))<span class="op">;</span></span>
<span id="cb29-1332"><a href="#cb29-1332" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> splitCount <span class="op">=</span> splitsAndSpaces<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb29-1333"><a href="#cb29-1333" aria-hidden="true" tabindex="-1"></a>    splitSpaceSum <span class="op">=</span> splitsAndSpaces<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1334"><a href="#cb29-1334" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (splitSpaceSum <span class="op">&lt;=</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1335"><a href="#cb29-1335" aria-hidden="true" tabindex="-1"></a>  startOrStop <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb29-1336"><a href="#cb29-1336" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">||</span> startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> span <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span></span>
<span id="cb29-1337"><a href="#cb29-1337" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> startOrStop <span class="op">&gt;</span> len <span class="op">&amp;&amp;</span> span <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb29-1338"><a href="#cb29-1338" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb29-1339"><a href="#cb29-1339" aria-hidden="true" tabindex="-1"></a>    startOrStop<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1340"><a href="#cb29-1340" aria-hidden="true" tabindex="-1"></a>  span <span class="op">=</span> span <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> startOrStop <span class="op">+</span> span <span class="op">&gt;</span> len <span class="op">?</span> len <span class="op">-</span> startOrStop <span class="op">:</span></span>
<span id="cb29-1341"><a href="#cb29-1341" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">+</span> span <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span>startOrStop<span class="op">:</span> span<span class="op">;</span></span>
<span id="cb29-1342"><a href="#cb29-1342" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> start <span class="op">=</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">:</span> startOrStop <span class="op">+</span> span<span class="op">,</span></span>
<span id="cb29-1343"><a href="#cb29-1343" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">=</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">+</span> span <span class="op">:</span> startOrStop<span class="op">;</span></span>
<span id="cb29-1344"><a href="#cb29-1344" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> start<span class="op">,</span> c <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> arr <span class="op">=</span> []<span class="op">;</span> i <span class="op">&lt;</span> stop<span class="op">;</span> i <span class="op">+=</span> splitsAndSpaces[c]) {</span>
<span id="cb29-1345"><a href="#cb29-1345" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((c <span class="op">=</span> (c <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> splitCount) <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> i <span class="op">+</span> splitsAndSpaces[c] <span class="op">&lt;=</span> stop) {</span>
<span id="cb29-1346"><a href="#cb29-1346" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ((arr <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> splitsAndSpaces[c]}<span class="op">,</span> (_<span class="op">,</span> j) <span class="kw">=&gt;</span> j <span class="op">+</span> i)<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb29-1347"><a href="#cb29-1347" aria-hidden="true" tabindex="-1"></a>        index <span class="kw">=&gt;</span> self[index])<span class="op">.</span><span class="fu">filter</span>(item <span class="kw">=&gt;</span> item <span class="op">!==</span> <span class="kw">undefined</span>)</span>
<span id="cb29-1348"><a href="#cb29-1348" aria-hidden="true" tabindex="-1"></a>          )<span class="op">.</span><span class="at">length</span> <span class="op">==</span> splitsAndSpaces[c]) { result<span class="op">.</span><span class="fu">push</span>(arr) }</span>
<span id="cb29-1349"><a href="#cb29-1349" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1350"><a href="#cb29-1350" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1351"><a href="#cb29-1351" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb29-1352"><a href="#cb29-1352" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-17" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="variables-2" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Variables</h2><div class="quarto-appendix-contents">

<div class="cell" data-output="all">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30" data-startfrom="1359" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1358;"><span id="cb30-1359"><a href="#cb30-1359" aria-hidden="true" tabindex="-1"></a>nested <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> intervals<span class="op">.</span><span class="at">length</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> ([</span>
<span id="cb30-1360"><a href="#cb30-1360" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb30-1361"><a href="#cb30-1361" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>i<span class="sc">}</span><span class="vs"> or </span><span class="sc">${</span>i<span class="op">+</span><span class="dv">5</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb30-1362"><a href="#cb30-1362" aria-hidden="true" tabindex="-1"></a>  <span class="dt">duration</span><span class="op">:</span> intervals[i][<span class="dv">1</span>] <span class="op">!==</span> intervals[i][<span class="dv">0</span>] <span class="op">?</span> intervals[i][<span class="dv">0</span>] <span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb30-1363"><a href="#cb30-1363" aria-hidden="true" tabindex="-1"></a>  <span class="dt">group</span><span class="op">:</span> <span class="st">"Rest"</span></span>
<span id="cb30-1364"><a href="#cb30-1364" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb30-1365"><a href="#cb30-1365" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb30-1366"><a href="#cb30-1366" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>i<span class="sc">}</span><span class="vs"> or </span><span class="sc">${</span>i<span class="op">+</span><span class="dv">5</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb30-1367"><a href="#cb30-1367" aria-hidden="true" tabindex="-1"></a>  <span class="dt">duration</span><span class="op">:</span> intervals[i][<span class="dv">1</span>]<span class="op">-</span>intervals[i][<span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb30-1368"><a href="#cb30-1368" aria-hidden="true" tabindex="-1"></a>  <span class="dt">group</span><span class="op">:</span> <span class="st">"Work"</span></span>
<span id="cb30-1369"><a href="#cb30-1369" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb30-1370"><a href="#cb30-1370" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb30-1371"><a href="#cb30-1371" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>i<span class="sc">}</span><span class="vs"> or </span><span class="sc">${</span>i<span class="op">+</span><span class="dv">5</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb30-1372"><a href="#cb30-1372" aria-hidden="true" tabindex="-1"></a>  <span class="dt">duration</span><span class="op">:</span> intervals[i][<span class="dv">1</span>] <span class="op">!==</span> intervals[i][<span class="dv">0</span>] <span class="op">?</span> <span class="dv">1</span><span class="op">-</span>intervals[i][<span class="dv">1</span>] <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb30-1373"><a href="#cb30-1373" aria-hidden="true" tabindex="-1"></a>  <span class="dt">group</span><span class="op">:</span> <span class="st">"Rest"</span></span>
<span id="cb30-1374"><a href="#cb30-1374" aria-hidden="true" tabindex="-1"></a>  }]))</span>
<span id="cb30-1375"><a href="#cb30-1375" aria-hidden="true" tabindex="-1"></a>durations <span class="op">=</span> []<span class="op">.</span><span class="fu">concat</span>(<span class="op">...</span>nested)</span>
<span id="cb30-1376"><a href="#cb30-1376" aria-hidden="true" tabindex="-1"></a>theme_Flat <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb30-1377"><a href="#cb30-1377" aria-hidden="true" tabindex="-1"></a><span class="vs">/* Options */</span></span>
<span id="cb30-1378"><a href="#cb30-1378" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope {</span></span>
<span id="cb30-1379"><a href="#cb30-1379" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: #3b99fc;</span></span>
<span id="cb30-1380"><a href="#cb30-1380" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 240px;</span></span>
<span id="cb30-1381"><a href="#cb30-1381" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1382"><a href="#cb30-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1383"><a href="#cb30-1383" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope {</span></span>
<span id="cb30-1384"><a href="#cb30-1384" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1385"><a href="#cb30-1385" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: inline-block;</span></span>
<span id="cb30-1386"><a href="#cb30-1386" aria-hidden="true" tabindex="-1"></a><span class="vs">  --thumb-size: 15px;</span></span>
<span id="cb30-1387"><a href="#cb30-1387" aria-hidden="true" tabindex="-1"></a><span class="vs">  --thumb-radius: calc(var(--thumb-size) / 2);</span></span>
<span id="cb30-1388"><a href="#cb30-1388" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: var(--thumb-radius) 0;</span></span>
<span id="cb30-1389"><a href="#cb30-1389" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin: 2px;</span></span>
<span id="cb30-1390"><a href="#cb30-1390" aria-hidden="true" tabindex="-1"></a><span class="vs">  vertical-align: middle;</span></span>
<span id="cb30-1391"><a href="#cb30-1391" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1392"><a href="#cb30-1392" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-track {</span></span>
<span id="cb30-1393"><a href="#cb30-1393" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1394"><a href="#cb30-1394" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1395"><a href="#cb30-1395" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 7px;</span></span>
<span id="cb30-1396"><a href="#cb30-1396" aria-hidden="true" tabindex="-1"></a><span class="vs">  background-color: hsl(0, 0%, 80%);</span></span>
<span id="cb30-1397"><a href="#cb30-1397" aria-hidden="true" tabindex="-1"></a><span class="vs">  overflow: visible;</span></span>
<span id="cb30-1398"><a href="#cb30-1398" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb30-1399"><a href="#cb30-1399" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0 var(--thumb-radius);</span></span>
<span id="cb30-1400"><a href="#cb30-1400" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1401"><a href="#cb30-1401" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-track-zone {</span></span>
<span id="cb30-1402"><a href="#cb30-1402" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1403"><a href="#cb30-1403" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1404"><a href="#cb30-1404" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1405"><a href="#cb30-1405" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-select {</span></span>
<span id="cb30-1406"><a href="#cb30-1406" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1407"><a href="#cb30-1407" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1408"><a href="#cb30-1408" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: var(--range-min);</span></span>
<span id="cb30-1409"><a href="#cb30-1409" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: calc(var(--range-max) - var(--range-min));</span></span>
<span id="cb30-1410"><a href="#cb30-1410" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: ew-resize;</span></span>
<span id="cb30-1411"><a href="#cb30-1411" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: currentColor;</span></span>
<span id="cb30-1412"><a href="#cb30-1412" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 7px;</span></span>
<span id="cb30-1413"><a href="#cb30-1413" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: inherit;</span></span>
<span id="cb30-1414"><a href="#cb30-1414" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1415"><a href="#cb30-1415" aria-hidden="true" tabindex="-1"></a><span class="vs">/* Expands the hotspot area. */</span></span>
<span id="cb30-1416"><a href="#cb30-1416" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-select:before {</span></span>
<span id="cb30-1417"><a href="#cb30-1417" aria-hidden="true" tabindex="-1"></a><span class="vs">  content: "";</span></span>
<span id="cb30-1418"><a href="#cb30-1418" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb30-1419"><a href="#cb30-1419" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb30-1420"><a href="#cb30-1420" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: var(--thumb-size);</span></span>
<span id="cb30-1421"><a href="#cb30-1421" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: 0;</span></span>
<span id="cb30-1422"><a href="#cb30-1422" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: calc(2px - var(--thumb-radius));</span></span>
<span id="cb30-1423"><a href="#cb30-1423" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1424"><a href="#cb30-1424" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-select:focus,</span></span>
<span id="cb30-1425"><a href="#cb30-1425" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb:focus {</span></span>
<span id="cb30-1426"><a href="#cb30-1426" aria-hidden="true" tabindex="-1"></a><span class="vs">  outline: none;</span></span>
<span id="cb30-1427"><a href="#cb30-1427" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1428"><a href="#cb30-1428" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb {</span></span>
<span id="cb30-1429"><a href="#cb30-1429" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1430"><a href="#cb30-1430" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb30-1431"><a href="#cb30-1431" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: var(--thumb-size);</span></span>
<span id="cb30-1432"><a href="#cb30-1432" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: var(--thumb-size);</span></span>
<span id="cb30-1433"><a href="#cb30-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1434"><a href="#cb30-1434" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #fcfcfc;</span></span>
<span id="cb30-1435"><a href="#cb30-1435" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: -4px;</span></span>
<span id="cb30-1436"><a href="#cb30-1436" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 100%;</span></span>
<span id="cb30-1437"><a href="#cb30-1437" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: 1px solid hsl(0,0%,55%);</span></span>
<span id="cb30-1438"><a href="#cb30-1438" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: default;</span></span>
<span id="cb30-1439"><a href="#cb30-1439" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin: 0;</span></span>
<span id="cb30-1440"><a href="#cb30-1440" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1441"><a href="#cb30-1441" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb:active {</span></span>
<span id="cb30-1442"><a href="#cb30-1442" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-shadow: inset 0 var(--thumb-size) #0002;</span></span>
<span id="cb30-1443"><a href="#cb30-1443" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1444"><a href="#cb30-1444" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb-min {</span></span>
<span id="cb30-1445"><a href="#cb30-1445" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: calc(-1px - var(--thumb-radius));</span></span>
<span id="cb30-1446"><a href="#cb30-1446" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1447"><a href="#cb30-1447" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb-max {</span></span>
<span id="cb30-1448"><a href="#cb30-1448" aria-hidden="true" tabindex="-1"></a><span class="vs">  right: calc(-1px - var(--thumb-radius));</span></span>
<span id="cb30-1449"><a href="#cb30-1449" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1450"><a href="#cb30-1450" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb30-1451"><a href="#cb30-1451" aria-hidden="true" tabindex="-1"></a>schedules <span class="op">=</span> [</span>
<span id="cb30-1452"><a href="#cb30-1452" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">2</span><span class="op">,</span> <span class="op">.</span><span class="dv">8</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">2</span><span class="op">,</span> <span class="op">.</span><span class="dv">8</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span></span>
<span id="cb30-1453"><a href="#cb30-1453" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span></span>
<span id="cb30-1454"><a href="#cb30-1454" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span></span>
<span id="cb30-1455"><a href="#cb30-1455" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]]<span class="op">,</span></span>
<span id="cb30-1456"><a href="#cb30-1456" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb30-1457"><a href="#cb30-1457" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">366</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> i<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>))</span>
<span id="cb30-1458"><a href="#cb30-1458" aria-hidden="true" tabindex="-1"></a>sliceArray <span class="op">=</span> <span class="fu">slice</span>(dates<span class="op">,</span> <span class="op">...</span>sliceString<span class="op">.</span><span class="fu">split</span>(<span class="st">":"</span>)<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">===</span> <span class="st">""</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span>(i)))</span>
<span id="cb30-1459"><a href="#cb30-1459" aria-hidden="true" tabindex="-1"></a>spreadArray <span class="op">=</span> []<span class="op">.</span><span class="fu">concat</span>(<span class="op">...</span><span class="fu">spread</span>(dates<span class="op">,</span> <span class="op">...</span><span class="fu">decodeSpread</span>(spreadString)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-7" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="set-values-1" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Set values</h2><div class="quarto-appendix-contents">

<div class="cell hidden">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31" data-startfrom="1466" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1465;"><span id="cb31-1466"><a href="#cb31-1466" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof intervals<span class="op">,</span> schedules[schedule<span class="op">-</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-1" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32" data-startfrom="1467" data-source-offset="-45"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1466;"><span id="cb32-1467"><a href="#cb32-1467" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof spreadString<span class="op">,</span> <span class="fu">setSpreadDotd</span>(spreadDotd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-2" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33" data-startfrom="1468" data-source-offset="-97"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1467;"><span id="cb33-1468"><a href="#cb33-1468" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof sliceString<span class="op">,</span> <span class="fu">setSliceDotd</span>(sliceDotd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-3" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34" data-startfrom="1469" data-source-offset="-146"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1468;"><span id="cb34-1469"><a href="#cb34-1469" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb34-1470"><a href="#cb34-1470" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (invertDotd <span class="op">?</span> <span class="op">!</span>sliceOrSpread <span class="op">:</span> sliceOrSpread) {</span>
<span id="cb34-1471"><a href="#cb34-1471" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof sliceDotd<span class="op">,</span> <span class="fu">invert</span>(togglePlot))</span>
<span id="cb34-1472"><a href="#cb34-1472" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb34-1473"><a href="#cb34-1473" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof spreadDotd<span class="op">,</span> <span class="fu">invert</span>(togglePlot))</span>
<span id="cb34-1474"><a href="#cb34-1474" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1475"><a href="#cb34-1475" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-4" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div></section><aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><code>Decalendar</code>: a calendar system that uses <code>deks</code> instead of months and weeks<a href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p><code>Declock</code>: a timekeeping system that uses fractional days instead of hours, minutes, and seconds<a href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn3"><p><code>doty</code>: day-of-the-year; an alternative to months, weeks, hours, minutes, and seconds<a href="#fnref3" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn4"><p><code>doty</code> date: the integer part of the <code>doty</code>; an alternate to calendar dates and week dates<a href="#fnref4" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn5"><p><code>doty</code> time: the fractional part of the <code>doty</code>; an alternate to hours, minutes and seconds<a href="#fnref5" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn6"><p><code>dek</code>: a group of 10 days; the first two digits of the <code>Decalendar</code> date; an alternate to month and weeks<a href="#fnref6" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn7"><p><code>dotd</code>: one of the 10 days in a <code>dek</code>; the last digit of the <code>Decalendar</code> date; an alternate to the day-of-the-month and day-of-the-week<a href="#fnref7" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn8"><p><code>cent</code>: a hundredth (<span class="math inline">\(10^{-2}\)</span>) of a day; the first 2 digits of the <code>doty</code> time; an alternate to quarter hours<a href="#fnref8" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn9"><p><code>mil</code>: a thousandth (<span class="math inline">\(10^{-3}\)</span>) of a day; the first 3 digits of the <code>doty</code> time; an alternate to minutes<a href="#fnref9" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn10"><p><code>beat</code>: a hundred thousandth (<span class="math inline">\(10^{-5}\)</span>) of a day; the first 5 digits of the <code>doty</code> time; an alternate to seconds<a href="#fnref10" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn11"><p>fractional year date: a year and the proportion of that year that has passed; an alternative to <code>Decalendar</code> dates<a href="#fnref11" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn12"><p><code>deco</code>: a date and time format consisting of a year and a <code>doty</code> and analogous to ISO 8601 dates<a href="#fnref12" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn13"><p><code>pent</code>: a group of 5 days; half of a <code>dek</code><a href="#fnref13" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn14"><p><code>pently</code> schedule: one of a set of workday and restday schedules for the 5 days of the <code>pent</code><a href="#fnref14" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</aside><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{laptev2023,
  author = {Laptev, Martin},
  title = {Observable},
  pages = {undefined},
  date = {2023},
  url = {https://maptv.github.io},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-laptev2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Laptev, Martin. 2023. <span>‚ÄúObservable.‚Äù</span> 2023. <a href="https://maptv.github.io">https://maptv.github.io</a>.
</div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
{"contents":[{"methodName":"interpret","cellName":"ojs-cell-1","inline":false,"source":"// https://observablehq.com/@fheyen/barchart-clock\n{\nconst W = width > 1250 ? width * 2 / 3 : width > 1150 ? width * 3 / 4 : width > 1050 ? width * 4 / 5 : width > 950 ? width * 5 / 6 : width > 850 ? width : width > 750 ? width * 1.02 : width > 650 ? width * 1.06 : width > 550 ? width * 1.1 : width > 450 ? width * 1.14 : width * 1.18;\n  const H = 156;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W, H]);\n  const xRange = [0, W - 100];\n  const scaleM = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleCandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  const scaleDek = d3.scaleLinear()\n    .domain([0, 37])\n    .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data(['dek', 'dotd', 'cents', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=>i*30+firstBarY)\n  // Dek/Dotd\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d => scaleDek(Number(dotyDek)+Number(dotyDotd)/10+Number(barCents)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY)\n    .attr('width', d => scaleDek(dotyDek))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d => scaleM(Number(dotyDotd)+Number(barCents)/100+Number(barMils)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+30)\n    .attr('width', d => scaleM(dotyDotd))\n  svg.selectAll('.tickDek')\n    .data(d3.range(width > 500 ? 4: 6, 37))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickDek')\n    .attr('x', d=>scaleDek(d)+barX)\n    .attr('y', firstBarY)\n    .attr('height', d=>d%(width > 500 ? 2 : 3)===0? 6:4)\n  // Cent ticks\n  svg.selectAll('.tickDotd')\n    .data(d3.range(width > 500 ? 1: 2, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickDotd')\n    .attr('x', d=>scaleM(d)+barX)\n    .attr('y', firstBarY+49)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel')\n    .data(d3.range(width > 500 ? 4: 6, width > 500 ? 37: 35, width > 500 ? 2: 3))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel')\n    .attr('x', d=>scaleDek(d)+barX+.5)\n    .attr('y', firstBarY+22)\n    .text(d=>d)\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d => scaleCandB(Number(barCents)+Number(barMils)/10+Number(barBeats)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+60)\n    .attr('width', d => scaleCandB(barCents))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+90)\n    .attr('width', d => scaleM(Number(barMils)+Number(barBeats)/100+Number(barMb)/100000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+90)\n    .attr('width', d => scaleM(barMils))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width > 500 ? 10 : 20, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=>scaleM(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=>d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width > 500 ? 10 : 20, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=>scaleM(d/10)+barX)\n    .attr('y', d=>d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=>d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width > 500 ? 1 : 2, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=>scaleM(d)+barX)\n    .attr('y', firstBarY+90)\n    .attr('height', 6)\n  svg.selectAll('.tickM1')\n    .data(d3.range(width > 500 ? 1 : 2, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM1')\n    .attr('x', d=>scaleM(d)+barX)\n    .attr('y', firstBarY+92.5)\n    .attr('height', 2.5)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width > 500 ? 1 : 2, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=>scaleM(d)+barX+.5)\n    .attr('y', firstBarY+47)\n    .text(d=>d)\n  svg.selectAll('.tickLabel2')\n    .data(d3.range(width > 500 ? 1 : 2, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel2')\n    .attr('x', d=>scaleM(d)+barX+.5)\n    .attr('y', firstBarY+112)\n    .text(d=>d)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+120)\n    .attr('width', d => scaleCandB(Number(barBeats)+Number(barMb)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+120)\n    .attr('width', d => scaleCandB(barBeats))\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width > 500 ? 10 : 20, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=>scaleM(d/10)+barX)\n    .attr('y', firstBarY+120)\n    .attr('height', d=>d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`${dotyDek}Êó¨`, `${dotyDotd}Êó•`, `${barCents}%`, `${barMils}‚Ä∞`, `${barBeats}‚ô´`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=>i*30+firstBarY+20)\n    .text(d=>d)\n  return svg.node();\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-2","inline":false,"source":"html`<style>\n  .tickLabel, .tickLabel1, .tickLabel2, .timeLabel {\n    fill: #000;\n    font-family: sans-serif;\n    font-size: 20px;\n    text-anchor: middle;\n  }\n  .timeLabel {\n    text-anchor: start;\n  }\n  .timeBar, .timeBarFull {\n    x: 1px;\n    height: 25px;\n    rx: 5px;\n    stroke: #aaa;\n  }\n  .timeBar {\n    fill: #e8e8e8;\n  }\n  .timeBarFull {\n    fill: #ccffff;\n  }\n  .background {\n    fill: white;\n  }\n  .tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB {\n    stroke: none;\n    fill: #666;\n    width: 1px;\n  }\n</style>`\n"},{"methodName":"interpret","cellName":"ojs-cell-3","inline":false,"source":"viewof inputDoty = Inputs.range([0, 365], {value: 306, step: 1, label: \"doty\"});\n\nviewof year = transformInput(\n    Inputs.range([0, .999], {step: .001, label: \"year\"}),\n    {bind: viewof inputDoty, transform: (x => x / 365), invert: (x => x * 365)}\n);\n\nviewof monthInput = transformInput(\n    Inputs.range([1, 12], {step: 1, label: \"month\"}),\n    {bind: viewof inputDoty, transform: doty2month, invert: month2doty}\n);\n\nviewof dotmInput = transformInput(\n    Inputs.range([1, 31], {step: 1, label: \"dotm\"}),\n    {bind: viewof inputDoty, transform: doty2dotm, invert: (x => Math.floor(( 153 * (\n        viewof monthInput.value > 2\n        ? viewof monthInput.value - 3\n        : viewof monthInput.value + 9) + 2\n    ) / 5 + x - 1\n))});\n"},{"methodName":"interpret","cellName":"ojs-cell-4","inline":false,"source":"viewof scrubberDoty = Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864})\n"},{"methodName":"interpret","cellName":"ojs-cell-5","inline":false,"source":"// https://observablehq.com/@observablehq/synchronized-inputs\nfunction set(input, value) {\n  input.value = value;\n  input.dispatchEvent(new Event(\"input\", {bubbles: true}));\n}\n// https://observablehq.com/@mbostock/scrubber\nfunction Scrubber(values, {\n  format = value => value,\n  initial = 0,\n  direction = 1,\n  delay = null,\n  autoplay = true,\n  loop = true,\n  loopDelay = null,\n  alternate = false\n} = {}) {\n  values = Array.from(values);\n  const form = html`<form style=\"font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;\">\n  <button name=b type=button style=\"background-color:#002ead;color:#fff;border-radius:10px;margin-left:.4em;width: 5em;\"></button>\n  <label style=\"display: flex; align-items: center;\">\n    <input name=i type=range min=0 max=${values.length - 1} value=${initial} step=1 style=\"display: none;\">\n    <output name=o style=\"display: none;\"></output>\n  </label>\n</form>`;\n  let frame = null;\n  let timer = null;\n  let interval = null;\n  function start() {\n    form.b.textContent = \"Pause\";\n    if (delay === null) frame = requestAnimationFrame(tick);\n    else interval = setInterval(tick, delay);\n  }\n  function stop() {\n    form.b.textContent = \"Play\";\n    if (frame !== null) cancelAnimationFrame(frame), frame = null;\n    if (timer !== null) clearTimeout(timer), timer = null;\n    if (interval !== null) clearInterval(interval), interval = null;\n  }\n  function running() {\n    return frame !== null || timer !== null || interval !== null;\n  }\n  function tick() {\n    if (form.i.valueAsNumber === (direction > 0 ? values.length - 1 : direction < 0 ? 0 : NaN)) {\n      if (!loop) return stop();\n      if (alternate) direction = -direction;\n      if (loopDelay !== null) {\n        if (frame !== null) cancelAnimationFrame(frame), frame = null;\n        if (interval !== null) clearInterval(interval), interval = null;\n        timer = setTimeout(() => (step(), start()), loopDelay);\n        return;\n      }\n    }\n    if (delay === null) frame = requestAnimationFrame(tick);\n    step();\n  }\n  function step() {\n    form.i.valueAsNumber = (form.i.valueAsNumber + direction + values.length) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", {bubbles: true}));\n  }\n  form.i.oninput = event => {\n    if (event && event.isTrusted && running()) stop();\n    form.value = values[form.i.valueAsNumber];\n    form.o.value = format(form.value, form.i.valueAsNumber, values);\n  };\n  form.b.onclick = () => {\n    if (running()) return stop();\n    direction = alternate && form.i.valueAsNumber === values.length - 1 ? -1 : 1;\n    form.i.valueAsNumber = (form.i.valueAsNumber + direction) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", {bubbles: true}));\n    start();\n  };\n  form.i.oninput();\n  if (autoplay) start();\n  else stop();\n  Inputs.disposal(form).then(stop);\n  return form;\n}\n// https://observablehq.com/@juang1744/transform-input/1\ntransformInput = function(target, {bind: source, transform = identity, involutory = false, invert = involutory ? transform : inverse(transform)} = {}){\n  if (source === undefined) {\n    source = target;\n    target = html`<div>${source}</div>`;\n  }\n  function sourceInputHandler() {\n    target.removeEventListener(\"input\", targetInputHandler);\n    setTransform(target).to(transform(source.value)).andDispatchEvent();\n    target.addEventListener(\"input\", targetInputHandler);\n  }\n  function targetInputHandler() {\n    source.removeEventListener(\"input\", sourceInputHandler);\n    setTransform(source).to(invert(target.value)).andDispatchEvent();\n    source.addEventListener(\"input\", sourceInputHandler);\n  }\n  source.addEventListener(\"input\", sourceInputHandler);\n  target.addEventListener(\"input\", targetInputHandler);\n  invalidation.then(() => {\n    source.removeEventListener(\"input\", sourceInputHandler);\n    target.removeEventListener(\"input\", targetInputHandler);\n  });\n\n  sourceInputHandler();\n  return target;\n}\nsetTransform = (input) => ({to: (value) => (input.value = value, {andDispatchEvent: (event = new Event(\"input\")) => input.dispatchEvent(event)})});\nfunction inverse(f) {\n  switch (f) {\n    case identity:  return identity;\n    case Math.sqrt: return square;\n    case Math.log:  return Math.exp;\n    case Math.exp:  return Math.log;\n    default:        return (x => solve(f, x, x));\n  }\n  function solve(f, y, x = 0) {\n    const dx = 1e-6;\n    let steps = 100, deltax, fx, dfx;\n    do {\n      fx = f(x)\n      dfx = (f(x + dx) - fx) || dx;\n      deltax = dx * (fx - y)/dfx\n      x -= deltax;\n    } while (Math.abs(deltax) > dx && --steps > 0);\n    return steps === 0 ? NaN : x;\n  }\n\n  function square(x) {\n    return x * x;\n  }\n}\nfunction identity(x) {\n  return x;\n}\n// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) >= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`<span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}>${content}</span>`;\n}\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction dote2doty(days = 719468) {\n    const era = Math.floor((days >= 0 ? days : days - 146096) / 146097),\n        dotc = days - era * 146097,\n        yotc = Math.floor((dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365);\n    return [yotc + era * 400, dotc + Math.floor(yotc / 100) - yotc * 365 - Math.floor(yotc / 4)];\n}\nfunction unix2doty(ms = 0) {\n  return dote2doty(ms / 86400000 + 719468)\n}\n// https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nfunction doty2dote(year = 1969, doty = 0, zone = 0) {\n    const cycle = Math.floor((year >= 0 ? year : year - 399) / 400),\n    yote = year - cycle * 400;\n    return cycle * 146097 + yote * 365 + Math.floor(yote / 4) - Math.floor(yote / 100) + doty - zone\n}\nfunction doty2deco(yearDoty = [1969, 306], zone = 0) {\n    const yd = dote2doty(doty2dote(yearDoty[0], Math.floor(yearDoty[1])));\n    return `${yd[0]}+${(yd[1]).toString().padStart(3, \"0\")}${\n        yearDoty[1].toString().includes(\".\") ? \".\" + (\n            (yearDoty[1] > 0) ? (yearDoty[1] - zone).toString().split(\".\").pop()\n            : [...(yearDoty[1] - zone).toString().split(\".\").pop()].map(\n                (e, i, a) => (i + 1 === a.length) ? 10 - e : 9 - e\n            ).join(\"\")\n        ) : \"\"\n    }`\n}\nfunction unix2deco(ms = 0) {\n    return doty2deco(unix2doty(ms));\n};\n// http://howardhinnant.github.io/date_algorithms.html#days_from_civil\nfunction greg2doty(month = 1, day = 1) {\n    return Math.floor(\n        (153 * (month > 2 ? month - 3 : month + 9) + 2) / 5 + day - 1\n)}\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction doty2greg(doty = 0) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return [Math.floor(m < 10 ? m + 3 : m - 9), doty - Math.floor((153 * m + 2) / 5) + 1];\n}\nfunction doty2toty(doty = 306) {\n    doty = Math.floor(doty)\n    return (205 <= doty && doty < 295) ? [\"FallüçÅ\", \"Springüåº\"] :\n        (110 <= doty && doty < 205) ? [\"Summer‚òÄÔ∏è\", \"Winter‚ùÑÔ∏è\"] :\n        (20 <= doty && doty < 110) ? [\"Springüåº\", \"FallüçÅ\"] :\n        (0 <= doty && doty < 20) || (295 <= doty && doty <= 365)\n        ? [\"Winter‚ùÑÔ∏è\", \"Summer‚òÄÔ∏è\"] : \"Unknown\"\n}\nfunction doty2zodi(doty = 306) {\n    doty = Math.floor(doty)\n    return (20 <= doty && doty < 50) ? \"Aries‚ôàÔ∏è\" :\n     (50 <= doty && doty < 81) ? \"Taurus‚ôâÔ∏è\" :\n     (81 <= doty && doty < 112) ? \"Gemini‚ôäÔ∏è\" :\n     (112 <= doty && doty < 144) ? \"Cancer‚ôãÔ∏è\" :\n     (144 <= doty && doty < 175) ? \"Leo‚ôåÔ∏è\" :\n     (175 <= doty && doty < 206) ? \"Virgo‚ôçÔ∏è\" :\n     (206 <= doty && doty < 236) ? \"Libra‚ôéÔ∏è\" :\n     (236 <= doty && doty < 266) ? \"Scorpio‚ôèÔ∏è\" :\n     (266 <= doty && doty < 296) ? \"Sagittarius‚ôêÔ∏è\" :\n     (296 <= doty && doty < 325) ? \"Capricorn‚ôëÔ∏è\" :\n     (325 <= doty && doty < 355) ? \"Aquarius‚ôíÔ∏è\" :\n     (355 <= doty && doty <= 365) || (0 <= doty && doty < 20)\n     ? \"Pisces‚ôìÔ∏è\" : \"Unknown\"\n}\nfunction doty2month(doty = 0) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return Math.floor(m < 10 ? m + 3 : m - 9);\n}\nfunction month2doty(month = 1) {\n    return Math.floor(\n        (153 * (month > 2 ? month - 3 : month + 9) + 2) / 5\n)}\nfunction doty2dotm(doty = 0) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return doty - Math.floor((153 * m + 2) / 5) + 1;\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-6","inline":false,"source":"width\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\ntick = {\n  let i = 0;\n  while (true) {\n    yield Promises.tick(864, ++i);\n  }\n}\ntickDate = Math.floor(tick / 1e5)\ntickTime = tick % 1e5\ntickDelimiter = (tickDate > 0) ? \".\" : \"\"\nbarTime = unix2dote(unix).toString().split(\".\")[1].slice(0, 8)\nbarCents = barTime.slice(0, 2)\nbarMils = barTime[2]\nbarBeats = barTime.slice(3, 5)\nbarMb = barTime.slice(5)\ndeco = unix2deco(unix).slice(0, 14)\ndoty = deco.slice(5)\ndotyDate = doty.slice(0, 3)\ndotyTime = doty.slice(4)\ndotyDek = doty.slice(0, 2)\ndotyDotd = doty[2]\niso = {\n  while(true) {\n    yield new Date().toISOString()\n  }\n}\nisoDate = iso.slice(5, 10)\nisoTime = iso.slice(11, 19)\nseason = doty2toty(dotyDate)\nzodiac = doty2zodi(dotyDate)\ninputDotySeason = doty2toty(inputDoty)\ninputDotyZodiac = doty2zodi(inputDoty)\nnumbers = Array.from({length: 366}, (_, i) => i)\n"},{"methodName":"interpret","cellName":"ojs-cell-7","inline":false,"source":"styledYear = setStyle(deco.slice(0, 4), d3.schemePaired[10])\nstyledDotyDate = setStyle(dotyDate, d3.schemePaired[1])\nstyledDotyTime = setStyle(dotyTime, d3.schemePaired[2])\nstyledDotyDate1 = setStyle(dotyDate, d3.schemePaired[1])\nstyledDotyTime1 = setStyle(dotyTime, d3.schemePaired[2])\nstyledTickTime = setStyle(tickTime, d3.schemePaired[2])\nstyledDek = setStyle(dotyDek, d3.schemePaired[0])\nstyledDotd = setStyle(dotyDotd, d3.schemePaired[9])\nstyledCent = setStyle(dotyTime.slice(0, 2), d3.schemePaired[7])\nstyledMil = setStyle(dotyTime[2], d3.schemePaired[6])\nstyledBeat = setStyle(dotyTime.slice(3, 5), d3.schemePaired[11])\n"},{"methodName":"interpret","cellName":"ojs-cell-8","inline":false,"source":"set(viewof inputDoty, scrubberDoty)\n"},{"methodName":"interpret","cellName":"ojs-cell-9","inline":false,"source":"set(viewof decoOutput, `1969+${scrubberDeco.toString().padStart(3, \"0\")}`)\n"},{"methodName":"interpret","cellName":"ojs-cell-10","inline":false,"source":"viewof inputDatetime = Inputs.datetime({label: \"date\", value: \"1970-01-01T00:00\"})\n"},{"methodName":"interpret","cellName":"ojs-cell-11","inline":false,"source":"viewof yd = Inputs.form([\n  Inputs.number({label: \"year\", value: \"1969\"}),\n  Inputs.number({label: \"doty\", value: \"306\"})\n])\n"},{"methodName":"interpret","cellName":"ojs-cell-12","inline":false,"source":"viewof decoOutput = transformInput(\n  Inputs.text({label: \"deco\", placeholder: \"year+day.ddd\", value: \"1969+306\"}),\n  {bind: viewof yd, transform: doty2deco, invert: deco2doty});\n"},{"methodName":"interpret","cellName":"ojs-cell-13","inline":false,"source":"viewof scrubberDeco = Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864})\n"},{"methodName":"interpret","cellName":"ojs-cell-14","inline":false,"source":"function zone2hour(zone = \"Z\") {\n    return (zone = zone.toUpperCase()) == \"Z\" ? 0\n        : zone > \"@\" && zone < \"J\" ? zone.charCodeAt() - 64\n        : zone > \"J\" && zone < \"N\" ? zone.charCodeAt() - 65\n        : zone < \"Z\" && zone > \"M\" ? -(zone.charCodeAt() - 77)\n        : zone;\n}\nfunction deco2doty(timestamp = \"1969+306.00000Z\") {\n    const arr = timestamp.toString().split(/(?=[+-]|[a-zA-Z])/, 3);\n    switch (arr.length) {\n        case 1: return [unix2doty(Date.now())[0], parseFloat(arr[0]), 0];\n        case 2: return (/^[a-zA-Z]+$/.test(arr[1]))\n            ? [unix2doty(Date.now())[0], parseFloat(arr[0]), zone2hour(arr[1]) / 24]\n            : [parseFloat(arr[0]), parseFloat(arr[1]), 0];\n    };\n    return [parseFloat(arr[0]), parseFloat(arr[1]), /^[a-zA-Z]+$/.test(arr[2])\n        ? zone2hour(arr[2]) / 24\n        : parseFloat(arr[2].replace(/([+-])/, \"$1\\.\"))];\n}\nfunction deco2deco(timestamp = \"1969+306.00000Z\") {\n    return doty2deco(deco2doty(timestamp))\n}\nfunction doty2doty(year = 1969, doty = 0, zone = 0) {\n    return dote2doty(doty2dote(year, doty, zone));\n}\nfunction doty2unix(year = 1969, doty = 306, zone = 0) {\n    return (doty2dote(year, doty, zone) - 719468) * 86400000;\n}\nfunction doty2isoc(year = 1969, doty = 306, zone = 0) {\n    return new Date(doty2unix(year, doty, zone)).toISOString().split(\".\")[0]\n}\nfunction deco2isoc(timestamp = \"1969+306.00000Z\") {\n    return doty2isoc(...deco2doty(timestamp))\n}\nfunction unix2dote(ms = 0) {\n  return ms / 86400000 + 719468;\n}\nfunction dote2year(days = 719468) {\n    const era = Math.floor((days >= 0 ? days : days - 146096) / 146097),\n        dotc = days - era * 146097,\n        yotc = (dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365;\n    return yotc + era * 400;\n}\nfunction doty2year(year = 1969, doty = 306, zone = 0) {\n    return dote2year(doty2dote(year, doty, zone));\n}\nfunction unix2year(ms = 0) {\n    return dote2year(unix2dote(ms));\n};\n"},{"methodName":"interpret","cellName":"ojs-cell-15","inline":false,"source":"tzOffsetInMs = inputDatetime.getTimezoneOffset() * 60000\nutcDatetime = inputDatetime - tzOffsetInMs\noutputDatetimeDeco = unix2deco(utcDatetime)\ndtDoty = outputDatetimeDeco.split(\"+\")[1]\ndtDotyDateRaw = dtDoty.split(\".\")[0]\ndtDotyTimeRaw = dtDoty.split(\".\")[1].slice(0, 5)\noutputDatetimeYear = unix2year(utcDatetime).toString().slice(0, 8)\ndtDotyTimeDelimiter = dtDotyTimeRaw ? \".\" : \"\"\noutputDecoYear = doty2year(...yd).toString().slice(0, 8)\noutputIsoc = doty2isoc(...yd)\nyearDate = Math.ceil(unix2year(unix) * 1e3) / 1e3\n"},{"methodName":"interpret","cellName":"ojs-cell-16","inline":false,"source":"dtYear = setStyle(outputDatetimeDeco.split(\"+\")[0], d3.schemePaired[10])\ndtDotyDate = setStyle(dtDotyDateRaw, d3.schemePaired[1])\ndtDotyTime = dtDotyTimeRaw ? setStyle(dtDotyTimeRaw, d3.schemePaired[2]) : \"\"\nstyledIsocYear = setStyle(outputIsoc.split(/(?=-)/)[0], d3.schemePaired[10])\nstyledIsocMd = setStyle(outputIsoc.slice(outputIsoc.split(/(?=-)/)[0].length+1,outputIsoc.split(/(?=-)/)[0].length+6), d3.schemePaired[5])\nstyledIsocTime = setStyle(outputIsoc.slice(outputIsoc.split(/(?=-)/)[0].length+7), d3.schemePaired[4])\nstyledOutputDatetimeYear = setStyle(outputDatetimeYear, d3.schemePaired[10])\nstyledOutputDecoYear = setStyle(outputDecoYear, d3.schemePaired[10])\n"},{"methodName":"interpret","cellName":"ojs-cell-17","inline":false,"source":"viewof intervals = Inputs.form([\n  interval([0, 1], {step: .01, value: [.3, .7], label: '0 or 5', width: 250, format: ([start, end]) => start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '1 or 6', width: 250, format: ([start, end]) => start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '2 or 7', width: 250, format: ([start, end]) => start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '3 or 8', width: 250, format: ([start, end]) => start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '4 or 9', width: 250, format: ([start, end]) => start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n])\n"},{"methodName":"interpret","cellName":"ojs-cell-18","inline":false,"source":"viewof schedule = Inputs.radio([2, 3, 4, 5], {label: \"sched.\", value: 3})\n\nviewof filename = Inputs.text({label: \"name\", placeholder: \"Enter the filename\", value: `schedule${schedule}.csv`})\n\nbutton(durations, filename)\n"},{"methodName":"interpret","cellName":"ojs-cell-19","inline":false,"source":"\n// https://observablehq.com/@dec/pent\nPlot.plot({\n  className: \"schedule-explorer\",\n  x: {label: null},\n  color: {scheme: \"Set1\", legend: \"swatches\", reverse: true},\n  y: {label: null, domain: [1, 0]},\n  marks: [\n  Plot.barY(durations, {x: \"label\", y: \"duration\", fill: \"group\"}),\n  Plot.textY(\n      durations,\n      Plot.stackY(\n        Plot.groupX(\n          { y: \"first\", text: \"first\" },\n          {\n            x: \"label\",\n            z: \"group\",\n            y: \"duration\",\n            text: (d) => (d.duration < .0001 ? null : formatDecimal(d.duration)),\n            fill: \"white\",\n            stroke: \"black\",\n            fontSize: 36,\n          }\n        )\n      )\n    ),\n  ]})\n"},{"methodName":"interpret","cellName":"ojs-cell-20","inline":false,"source":"viewof sliceDotd = Inputs.checkbox([...Array(10).keys()], {label: \"slice\", value: [1, 6]})\n"},{"methodName":"interpret","cellName":"ojs-cell-21","inline":false,"source":"viewof spreadDotd = Inputs.checkbox([...Array(10).keys()], {label: \"spread\", value: [1, 6]})\n"},{"methodName":"interpret","cellName":"ojs-cell-22","inline":false,"source":"viewof togglePlot = Inputs.button([\n  [invertDotd ? \"None\" : \"All\", value => [...Array(10).keys()]],\n  [invertDotd ? \"Even\" : \"Odd\", value => [1, 3, 5, 7, 9]],\n  [invertDotd ? html`<s>Prime</s>` : \"Prime\", value => [2, 3, 5, 7]],\n  [invertDotd ? html`<s>Composite</s>` : \"Composite\", value => [4, 6, 8, 9]],\n  [invertDotd ? html`<s>Schedule2</s>` : \"Schedule2\", value => [0, 1, 5, 6]],\n  [invertDotd ? html`<s>Schedule3</s>` : \"Schedule3\", value => [0, 1, 2, 5, 6, 7]],\n  [invertDotd ? html`<s>Schedule4</s>` : \"Schedule4\", value => [0, 1, 2, 3, 5, 6, 7, 8]],\n], {value: [], label: \"select\"})\n"},{"methodName":"interpret","cellName":"ojs-cell-23","inline":false,"source":"viewof invertDotd = Inputs.toggle({label: \"invert\"})\nviewof sliceOrSpread = toggleSwitch({textOn: invertDotd ? \"Spread\" : 'Slice' , textOff: invertDotd ? \"Slice\" : 'Spread'})\n"},{"methodName":"interpret","cellName":"ojs-cell-24","inline":false,"source":"viewof sliceInputs = Inputs.form([\n    Inputs.number([-366, 366], {step: 1, label: \"start\", value: 1, placeholder: \"Enter start index\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"stop\", value: 366, placeholder: \"Enter stop index\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"step\", value: 5, placeholder: \"Enter step size\"}),\n])\nviewof sliceString = transformInput(\n  Inputs.text({label: \"slice\", placeholder: \"Enter slice string\", value: \"0:366\"}),\n{bind: viewof sliceInputs, transform: encodeSlice, invert: decodeSlice});\n"},{"methodName":"interpret","cellName":"ojs-cell-25","inline":false,"source":"viewof spreadInputs = Inputs.form([\n    Inputs.number([-366, 366], {step: 1, label: \"start\", value: 0, placeholder: \"Enter start index\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"span\", value: 366, placeholder: \"Enter span size\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"split\", value: 3, placeholder: \"Enter split size\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"space\", value: 2, placeholder: \"Enter space size\"}),\n])\nviewof spreadString = transformInput(\n  Inputs.text({label: \"spread\", placeholder: \"Enter spread string\", value: \"0>366>3>2\"}),\n{bind: viewof spreadInputs, transform: encodeSpread, invert: decodeSpread});\n"},{"methodName":"interpret","cellName":"ojs-cell-26","inline":false,"source":"// https://observablehq.com/@dec/dotd\nPlot.plot({\n  className: \"date-selector\",\n  padding: 0,\n  x: {axis: \"top\", label: null, type: \"band\"},\n  y: {label: null, type: \"band\"},\n  marks: [\n    Plot.cell(dates, {x: d => d[2], y: d => d.slice(0, 2), fill: d =>\n      sliceArray.includes(d) && spreadArray.includes(d) ? \"green\" :\n      sliceArray.includes(d) && !spreadArray.includes(d) ? \"blue\" :\n      !sliceArray.includes(d) && spreadArray.includes(d) ? \"orange\" : \"grey\",\n      inset: 0.5}),\n    Plot.text(dates, {\n    x: d => d[2],\n    y: d => d.slice(0, 2),\n    fill: \"white\",\n    stroke: \"black\",\n    fontSize: 20})\n  ]\n})\n"},{"methodName":"interpret","cellName":"ojs-cell-27","inline":false,"source":"// https://observablehq.com/@mootari/range-slider\nfunction interval(range = [], options = {}) {\n  const [min = 0, max = 1] = range;\n  const {\n    step = .001,\n    label = null,\n    value = [min, max],\n    format = ([start, end]) => `${start} ‚Ä¶ ${end}`,\n    color,\n    width,\n    theme,\n  } = options;\n  const __ns__ = DOM.uid('scope').id;\n  const css = `\n#${__ns__} {\n  font: 13px/1.2 var(--sans-serif);\n  display: flex;\n  align-items: baseline;\n  flex-wrap: wrap;\n  max-width: 100%;\n  width: auto;\n}\n@media only screen and (min-width: 30em) {\n  #${__ns__} {\n    flex-wrap: nowrap;\n    width: 360px;\n  }\n}\n#${__ns__} .label {\n  width: 50px;\n  padding: 5px 0 4px 0;\n  margin-right: .5px;\n  flex-shrink: 0;\n}\n#${__ns__} .form {\n  display: flex;\n  width: 100%;\n}\n#${__ns__} .range {\n  flex-shrink: 1;\n  width: 100%;\n}\n#${__ns__} .range-slider {\n  width: 100%;\n}\n  `;\n  const $range = rangeInput({min, max, value: [value[0], value[1]], step, color, width, theme});\n  const $output = html`<output>`;\n  const $view = html`<div id=${__ns__}>\n${label == null ? '' : html`<div class=\"label\">${label}`}\n<div class=form>\n  <div class=range>\n    ${$range}<div class=range-output style=\"display: inline-block;\">${$output}</div>\n  </div>\n</div>\n${html`<style>${css}`}\n  `;\n  const update = () => {\n    const content = format([$range.value[0], $range.value[1]]);\n    if(typeof content === 'string') $output.value = content;\n    else {\n      while($output.lastChild) $output.lastChild.remove();\n      $output.appendChild(content);\n    }\n  };\n  $range.oninput = update;\n  update();\n  return Object.defineProperty($view, 'value', {\n    get: () => $range.value,\n    set: ([a, b]) => {\n      $range.value = [a, b];\n      update();\n    },\n  });\n}\ncssLength = v => v == null ? null : typeof v === 'number' ? `${v}px` : `${v}`\nfunction randomScope(prefix = 'scope-') {\n  return prefix + (performance.now() + Math.random()).toString(32).replace('.', '-');\n}\nfunction rangeInput(options = {}) {\n  const {\n    min = 0,\n    max = 100,\n    step = 'any',\n    value: defaultValue = [min, max],\n    color,\n    width,\n    theme = theme_Flat,\n  } = options;\n  const controls = {};\n  const scope = randomScope();\n  const clamp = (a, b, v) => v < a ? a : v > b ? b : v;\n  const html = htl.html;\n  // Will be used to sanitize values while avoiding floating point issues.\n  const input = html`<input type=range ${{min, max, step}}>`;\n  const dom = html`<div class=${`${scope} range-slider`} style=${{\n    color,\n    width: cssLength(width),\n  }}>\n  ${controls.track = html`<div class=\"range-track\">\n    ${controls.zone = html`<div class=\"range-track-zone\">\n      ${controls.range = html`<div class=\"range-select\" tabindex=0>\n        ${controls.min = html`<div class=\"thumb thumb-min\" tabindex=0>`}\n        ${controls.max = html`<div class=\"thumb thumb-max\" tabindex=0>`}\n      `}\n    `}\n  `}\n  ${html`<style>${theme.replace(/:scope\\b/g, '.'+scope)}`}\n</div>`;\n  let value = [], changed = false;\n  Object.defineProperty(dom, 'value', {\n    get: () => [...value],\n    set: ([a, b]) => {\n      value = sanitize(a, b);\n      updateRange();\n    },\n  });\n  const sanitize = (a, b) => {\n    a = isNaN(a) ? min : ((input.value = a), input.valueAsNumber);\n    b = isNaN(b) ? max : ((input.value = b), input.valueAsNumber);\n    return [Math.min(a, b), Math.max(a, b)];\n  }\n  const updateRange = () => {\n    const ratio = v => (v - min) / (max - min);\n    dom.style.setProperty('--range-min', `${ratio(value[0]) * 100}%`);\n    dom.style.setProperty('--range-max', `${ratio(value[1]) * 100}%`);\n  };\n  const dispatch = name => {\n    dom.dispatchEvent(new Event(name, {bubbles: true}));\n  };\n  const setValue = (vmin, vmax) => {\n    const [pmin, pmax] = value;\n    value = sanitize(vmin, vmax);\n    updateRange();\n    // Only dispatch if values have changed.\n    if(pmin === value[0] && pmax === value[1]) return;\n    dispatch('input');\n    changed = true;\n  };\n  setValue(...defaultValue);\n  // Mousemove handlers.\n  const handlers = new Map([\n    [controls.min, (dt, ov) => {\n      const v = clamp(min, ov[1], ov[0] + dt * (max - min));\n      setValue(v, ov[1]);\n    }],\n    [controls.max, (dt, ov) => {\n      const v = clamp(ov[0], max, ov[1] + dt * (max - min));\n      setValue(ov[0], v);\n    }],\n    [controls.range, (dt, ov) => {\n      const d = ov[1] - ov[0];\n      const v = clamp(min, max - d, ov[0] + dt * (max - min));\n      setValue(v, v + d);\n    }],\n  ]);\n  // Returns client offset object.\n  const pointer = e => e.touches ? e.touches[0] : e;\n  // Note: Chrome defaults \"passive\" for touch events to true.\n  const on  = (e, fn) => e.split(' ').map(e => document.addEventListener(e, fn, {passive: false}));\n  const off = (e, fn) => e.split(' ').map(e => document.removeEventListener(e, fn, {passive: false}));\n  let initialX, initialV, target, dragging = false;\n  function handleDrag(e) {\n    // Gracefully handle exit and reentry of the viewport.\n    if(!e.buttons && !e.touches) {\n      handleDragStop();\n      return;\n    }\n    dragging = true;\n    const w = controls.zone.getBoundingClientRect().width;\n    e.preventDefault();\n    handlers.get(target)((pointer(e).clientX - initialX) / w, initialV);\n  }\n  function handleDragStop(e) {\n    off('mousemove touchmove', handleDrag);\n    off('mouseup touchend', handleDragStop);\n    if(changed) dispatch('change');\n  }\n  invalidation.then(handleDragStop);\n  dom.ontouchstart = dom.onmousedown = e => {\n    dragging = false;\n    changed = false;\n    if(!handlers.has(e.target)) return;\n    on('mousemove touchmove', handleDrag);\n    on('mouseup touchend', handleDragStop);\n    e.preventDefault();\n    e.stopPropagation();\n    target = e.target;\n    initialX = pointer(e).clientX;\n    initialV = value.slice();\n  };\n  controls.track.onclick = e => {\n    if(dragging) return;\n    changed = false;\n    const r = controls.zone.getBoundingClientRect();\n    const t = clamp(0, 1, (pointer(e).clientX - r.left) / r.width);\n    const v = min + t * (max - min);\n    const [vmin, vmax] = value, d = vmax - vmin;\n    if(v < vmin) setValue(v, v + d);\n    else if(v > vmax) setValue(v - d, v);\n    if(changed) dispatch('change');\n  };\n  return dom;\n}\nfunction formatDecimal(number) {\n  return number == 1 ? number : (Math.round(number * 100) / 100).toString().slice(1)\n}\nbutton = (data, filename = 'data.csv') => {\n  if (!data) throw new Error('Array of data required as first argument');\n  let downloadData;\n  if (filename.includes('.csv')) {\n    downloadData = new Blob([d3.csvFormat(data)], { type: \"text/csv\" });\n  } else {\n    downloadData = new Blob([JSON.stringify(data, null, 2)], {\n      type: \"application/json\"\n    });\n  }\n  return DOM.download(\n    downloadData,\n    filename,\n    \"Download\"\n  );\n}\nfunction invert(arr) {\n  return invertDotd ? [...Array(10).keys()].map(n => !arr.includes(n)).map((x, i) => x ? i : null).filter(i => i !== null) : arr\n}\n// https://observablehq.com/@chrispahm/toggle-switch-input-button\nfunction toggleSwitch(options = { textOn: 'True', textOff: 'False' }) {\n  const button = html`<div class=\"button-switch\"\"></div>`;\n  button.innerText = options.textOn;\n  button.value = true;\n\n  button.onclick = () => {\n    button.value = !button.value;\n    button.innerText = button.value ? options.textOn : options.textOff;\n    button.dispatchEvent(new CustomEvent(\"input\"));\n  };\n\n  addButtonStyle()\n\n  return button;\n}\n// https://observablehq.com/@chrispahm/toggle-switch-input-button\nfunction addButtonStyle() {\n  var el = document.createElement('style');\n  el.setAttribute('type', 'text/css');\n  document.head.appendChild(el);\n  var sheet = el.sheet;\n  function addRule(rule) {\n    try {\n      sheet.insertRule(rule, sheet.cssRules.length);\n    } catch (e) {\n      console.warn('Error inserting rule', rule, e);\n    }\n  }\n  addRule(\n    '.button-switch { -webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;display: inline-block;-webkit-border-radius: 2px;-moz-border-radius: 2px;border-radius: 2px;background-color: #EFEFEF;padding: 0px 7px 0px 7px;text-align: center;border: 1px solid grey;width: auto;color: #1c1c1c;font-size: 14px;font-family: sans-serif;text-decoration: none; }'\n  );\n  addRule(\n    '.button-switch:hover { background-color: #E5E5E5;border: 1px solid #454545; }'\n  );\n  addRule(\n    '.button-switch:active { background-color: #f5f5f5;border: 1px solid grey; }'\n  );\n}\nfunction setSpreadDotd(dotd) {\n  const dotdLength = dotd.length;\n  if (dotdLength === 10) {return \">\"}\n  if (dotdLength === 0) {return \">0\"}\n  if (dotdLength === 1) {return `${dotd[0]}>>1>9`}\n  const steps = dotd.map((x, i) => dotd[i + 1] - x)\n    .filter(i => !isNaN(i)),\n    result = [];\n  let split = 1;\n  for (const step of steps) {\n    if (step !== 1) {\n       result.push([split, step - 1])\n       split = 1\n    } else {\n      split += 1\n    }\n  }\n  result.push(split)\n  const flat = [].concat(...result),\n    resultSum = flat.reduce((a, b) => a + b, 0),\n    uniq = [...new Set(flat)];\n  return [dotd[0] ? dotd[0] : null, null].concat(JSON.stringify(uniq) === \"[1]\" ? [null, 1] : uniq.length === 2 && uniq.reduce((a, b) => a + b, 0) === 5 ? uniq : flat.concat(10 - resultSum).map((x, i) => i % 2 === 0 && x === 1 ? null : x)).join(\">\")\n}\nfunction setSliceDotd(dotd) {\n  const dotdLength = dotd.length;\n  if (dotdLength === 10) {return \":\"}\n  if (dotdLength === 0) {return \":0\"}\n  const steps = dotd.map((x, i) => dotd[i + 1] - x)\n    .filter(i => !isNaN(i)),\n    stepSum = steps.reduce((a, b) => a + b, 0),\n    uniq = [...new Set(steps.concat(10 - stepSum))];\n  return [dotd[0] ? dotd[0] : null, null].concat(uniq.length === 1 ? uniq : JSON.stringify(steps) === \"[1,4,1]\" ? [1, 4] : JSON.stringify(steps) === \"[1,1,3,1,1]\" ? [1, 1, 3] : JSON.stringify(steps) === \"[1,1,1,2,1,1,1]\" ? [1, 1, 1, 2] : steps.concat(10 - stepSum).map(x => x === 1 ? null : x)).join(\":\");\n}\nfunction encodeSlice(...args) {\n  return args.join().replaceAll(\",\", \":\")\n}\nfunction decodeSlice(s) {\n  let [start, stop, ...steps] = s.split(\":\").map(i => i === \"\" ? null : Number(i))\n  const step = steps[0] == null ? 1: steps[0];\n  start = start == null && step >= 0 ? 0 : start == null && step < 0 ? 365 : start;\n  stop = stop == null && step >= 0 ? 366 : stop;\n  return [start, stop, step]\n}\nfunction decodeSpread(spread) {\n  return spread.replace(/^</, \"366<\").replace(/^>/, \"0>\")\n    .split(/(?=^\\d|<|>)/).map(s => s.replace(\"<\", \"-\")\n    .replace(\">\", \"\")).map(s => s === \"\" || isNaN(s) ? null : Number(s))\n}\nfunction encodeSpread(args) {\n  return args.map(a => isNaN(a) ? null : a).join(\">\").replace(\">-\", \"<\")\n}\nfunction slice(self, start, stop, steps, ...args) {\n  const len = self.length, result = [];\n  if (steps === 0 || len === 0) { return result };\n  steps = (!steps || steps.length === 0 ? [1] :\n    typeof steps === \"number\" ? [steps] :\n    typeof steps === \"string\" ? Array.from(steps, Number) :\n    steps).concat(args.map(i => i == null ? 1 : i));\n  const stepCount = steps.length,\n    stepSum = steps.reduce((a, b) => a + b, 0);\n  if (stepSum === 0) { return result };\n  start = Math.max(\n    start == null && stepSum > 0 ? 0 :\n    start == null && stepSum < 0 ? len - 1 :\n    start >= len ? len - 1 :\n    start < 0 ? start + len :\n    start, 0);\n  stop = Math.max(\n    stop == null && stepSum > 0 ? len :\n    stop == null && stepSum < 0 ? -1 :\n    stop >= len ? len :\n    stop < 0 ? stop + len :\n    stop, -1);\n  for (\n    let i = start, counter = -1;\n    stepSum > 0 ? i < stop : i > stop;\n    i += steps[counter]\n  ) {\n    result.push(self[i]);\n    counter = (counter + 1) % stepCount;\n  };\n  return result;\n}\nfunction spread(self, startOrStop, span, splitsAndSpaces, ...args) {\n  const len = self.length, result = [];\n  if (span === 0 || len === 0) { return result };\n  splitsAndSpaces = (!splitsAndSpaces || splitsAndSpaces.length === 0 ? [1] :\n    typeof splitsAndSpaces === \"number\" ? [splitsAndSpaces] :\n    typeof splitsAndSpaces === \"string\" ? Array.from(splitsAndSpaces, Number) :\n    splitsAndSpaces).concat(args.map(i => i == null ? 1 : i));\n    const splitCount = splitsAndSpaces.length,\n    splitSpaceSum = splitsAndSpaces.reduce((a, b) => a + b, 0);\n  if (splitSpaceSum <= 0) { return result };\n  startOrStop = Math.max(\n    startOrStop == null && span > 0 || startOrStop == null && span == null ? 0 :\n    startOrStop == null || startOrStop > len && span < 0 ? len :\n    startOrStop < 0 ? startOrStop + len :\n    startOrStop, 0);\n  span = span == null || startOrStop + span > len ? len - startOrStop :\n    startOrStop + span < 0 ? -startOrStop: span;\n  const start = span > 0 ? startOrStop : startOrStop + span,\n    stop = span > 0 ? startOrStop + span : startOrStop;\n  for (let i = start, c = -1, arr = []; i < stop; i += splitsAndSpaces[c]) {\n    if ((c = (c + 1) % splitCount) % 2 === 0 && i + splitsAndSpaces[c] <= stop) {\n      if ((arr = Array.from({length: splitsAndSpaces[c]}, (_, j) => j + i).map(\n        index => self[index]).filter(item => item !== undefined)\n          ).length == splitsAndSpaces[c]) { result.push(arr) }\n    }\n  };\n  return result;\n}\n"},{"methodName":"interpret","cellName":"ojs-cell-28","inline":false,"source":"nested = Array.from({length: intervals.length}, (_, i) => ([\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1] !== intervals[i][0] ? intervals[i][0] : 1,\n  group: \"Rest\"\n},\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1]-intervals[i][0],\n  group: \"Work\"\n},\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1] !== intervals[i][0] ? 1-intervals[i][1] : null,\n  group: \"Rest\"\n  }]))\ndurations = [].concat(...nested)\ntheme_Flat = `\n/* Options */\n:scope {\n  color: #3b99fc;\n  width: 240px;\n}\n\n:scope {\n  position: relative;\n  display: inline-block;\n  --thumb-size: 15px;\n  --thumb-radius: calc(var(--thumb-size) / 2);\n  padding: var(--thumb-radius) 0;\n  margin: 2px;\n  vertical-align: middle;\n}\n:scope .range-track {\n  box-sizing: border-box;\n  position: relative;\n  height: 7px;\n  background-color: hsl(0, 0%, 80%);\n  overflow: visible;\n  border-radius: 4px;\n  padding: 0 var(--thumb-radius);\n}\n:scope .range-track-zone {\n  box-sizing: border-box;\n  position: relative;\n}\n:scope .range-select {\n  box-sizing: border-box;\n  position: relative;\n  left: var(--range-min);\n  width: calc(var(--range-max) - var(--range-min));\n  cursor: ew-resize;\n  background: currentColor;\n  height: 7px;\n  border: inherit;\n}\n/* Expands the hotspot area. */\n:scope .range-select:before {\n  content: \"\";\n  position: absolute;\n  width: 100%;\n  height: var(--thumb-size);\n  left: 0;\n  top: calc(2px - var(--thumb-radius));\n}\n:scope .range-select:focus,\n:scope .thumb:focus {\n  outline: none;\n}\n:scope .thumb {\n  box-sizing: border-box;\n  position: absolute;\n  width: var(--thumb-size);\n  height: var(--thumb-size);\n\n  background: #fcfcfc;\n  top: -4px;\n  border-radius: 100%;\n  border: 1px solid hsl(0,0%,55%);\n  cursor: default;\n  margin: 0;\n}\n:scope .thumb:active {\n  box-shadow: inset 0 var(--thumb-size) #0002;\n}\n:scope .thumb-min {\n  left: calc(-1px - var(--thumb-radius));\n}\n:scope .thumb-max {\n  right: calc(-1px - var(--thumb-radius));\n}\n`\nschedules = [\n  [[.2, .8], [.2, .8], [0, 0], [0, 0], [0, 0]],\n  [[.3, .7], [.3, .7], [.3, .7], [0, 0], [0, 0]],\n  [[.35, .65], [.35, .65], [.35, .65], [.35, .65], [0, 0]],\n  [[.38, .62], [.38, .62], [.38, .62], [.38, .62], [.38, .62]],\n]\ndates = Array.from({length: 366}, (_, i) => i.toString().padStart(3, \"0\"))\nsliceArray = slice(dates, ...sliceString.split(\":\").map(i => i === \"\" ? null : Number(i)))\nspreadArray = [].concat(...spread(dates, ...decodeSpread(spreadString)))\n"},{"methodName":"interpret","cellName":"ojs-cell-29","inline":false,"source":"set(viewof intervals, schedules[schedule-2])\nset(viewof spreadString, setSpreadDotd(spreadDotd))\nset(viewof sliceString, setSliceDotd(sliceDotd))\n{\n  if (invertDotd ? !sliceOrSpread : sliceOrSpread) {\n    set(viewof sliceDotd, invert(togglePlot))\n  } else {\n    set(viewof spreadDotd, invert(togglePlot))\n  }\n}\n\n"},{"methodName":"interpretQuiet","source":"shinyInput('inputDoty')"},{"methodName":"interpretQuiet","source":"shinyInput('year')"},{"methodName":"interpretQuiet","source":"shinyInput('monthInput')"},{"methodName":"interpretQuiet","source":"shinyInput('dotmInput')"},{"methodName":"interpretQuiet","source":"shinyInput('scrubberDoty')"},{"methodName":"interpretQuiet","source":"shinyInput('inputDatetime')"},{"methodName":"interpretQuiet","source":"shinyInput('yd')"},{"methodName":"interpretQuiet","source":"shinyInput('decoOutput')"},{"methodName":"interpretQuiet","source":"shinyInput('scrubberDeco')"},{"methodName":"interpretQuiet","source":"shinyInput('intervals')"},{"methodName":"interpretQuiet","source":"shinyInput('schedule')"},{"methodName":"interpretQuiet","source":"shinyInput('filename')"},{"methodName":"interpretQuiet","source":"shinyInput('sliceDotd')"},{"methodName":"interpretQuiet","source":"shinyInput('spreadDotd')"},{"methodName":"interpretQuiet","source":"shinyInput('togglePlot')"},{"methodName":"interpretQuiet","source":"shinyInput('invertDotd')"},{"methodName":"interpretQuiet","source":"shinyInput('sliceOrSpread')"},{"methodName":"interpretQuiet","source":"shinyInput('sliceInputs')"},{"methodName":"interpretQuiet","source":"shinyInput('sliceString')"},{"methodName":"interpretQuiet","source":"shinyInput('spreadInputs')"},{"methodName":"interpretQuiet","source":"shinyInput('spreadString')"}]}
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../posts/observable";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/maptv\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../../posts/quarto/index.html" class="pagination-link  aria-label=" quarto"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Quarto</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Observable</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - decüóìÔ∏èüïì</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - observable</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">  - quarto</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction {#sec-intro}</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Day-of-the-year {#sec-intro-doty}</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="in">`Decalendar`</span><span class="ot">[^1]</span> is a <span class="co">[</span><span class="ot">decimal</span><span class="co">](https://en.wikipedia.org/wiki/Decimal)</span> calendarüóìÔ∏èsystem and <span class="in">`Declock`</span><span class="ot">[^2]</span> is a decimal timekeeping‚è≥system. Instead of months, weeks, hours, minutes, and seconds, <span class="in">`Decalendar`</span> and <span class="in">`Declock`</span> use a number called the day-of-the-year (<span class="in">`doty`</span>)<span class="ot">[^3]</span>. @fig-bar-doty displays the current <span class="in">`doty`</span> (\${styledDotyDate}.\${styledDotyTime}) as a bar chart. The <span class="co">[</span><span class="ot">integer part</span><span class="co">](https://en.wikipedia.org/wiki/Decimal#:~:text=The%20integer%20part%20or%20integral%20part%20of%20a%20decimal%20numeral%20is%20the%20integer%20written%20to%20the%20left%20of%20the%20decimal%20separator)</span> of the <span class="in">`doty`</span> is the <span class="in">`Decalendar`</span> date<span class="ot">[^4]</span> (\${setStyle(dotyDate, d3.schemePaired<span class="sc">\[</span>1<span class="sc">\]</span>)}) and the <span class="co">[</span><span class="ot">fractional part</span><span class="co">](https://en.wikipedia.org/wiki/Decimal#:~:text=The%20part%20from%20the%20decimal%20separator%20to%20the%20right%20is%20the%20fractional%20part%2C%20which%20equals%20the%20difference%20between%20the%20numeral%20and%20its%20integer%20part.)</span> is the <span class="in">`Declock`</span> time<span class="ot">[^5]</span> (\${setStyle(dotyTime, d3.schemePaired<span class="sc">\[</span>2<span class="sc">\]</span>)}).</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span><span class="in">`Decalendar`</span>: a calendar system that uses <span class="in">`deks`</span> instead of months and weeks</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span><span class="in">`Declock`</span>: a timekeeping system that uses fractional days instead of hours, minutes, and seconds</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span><span class="in">`doty`</span>: day-of-the-year; an alternative to months, weeks, hours, minutes, and seconds</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span><span class="in">`doty`</span> date: the integer part of the <span class="in">`doty`</span>; an alternate to calendar dates and week dates</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span><span class="in">`doty`</span> time: the fractional part of the <span class="in">`doty`</span>; an alternate to hours, minutes and seconds</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>The top two bars in @fig-bar-doty (Êó¨ and Êó•) show the two components of the <span class="in">`Decalendar`</span> date (\${setStyle(dotyDate, d3.schemePaired<span class="sc">\[</span>1<span class="sc">\]</span>)}): the <span class="in">`dek`</span><span class="ot">[^6]</span> (\${styledDek}) and the day-of-the-<span class="in">`dek`</span><span class="ot">[^7]</span> (\${styledDotd}). A <span class="in">`dek`</span> is a group of 10 days that fulfills the role of months and weeks in <span class="in">`Decalendar`</span>. Therefore, the <span class="in">`dek`</span> and the day-of-the-<span class="in">`dek`</span> (<span class="in">`dotd`</span>) in <span class="in">`Decalendar`</span> dates are analogous to the month and day-of-the-month (<span class="in">`dotm`</span>) in <span class="co">[</span><span class="ot">calendar dates</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Calendar_dates)</span> (<span class="in">`mm-dd`</span>) and the week and day-of-the-week (<span class="in">`dotw`</span>) in <span class="co">[</span><span class="ot">week dates</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Week_dates)</span> (<span class="in">`Www-d`</span>).</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span><span class="in">`dek`</span>: a group of 10 days; the first two digits of the <span class="in">`Decalendar`</span> date; an alternate to month and weeks</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span><span class="in">`dotd`</span>: one of the 10 days in a <span class="in">`dek`</span>; the last digit of the <span class="in">`Decalendar`</span> date; an alternate to the day-of-the-month and day-of-the-week</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>The bottom three bars in @fig-bar-doty (%, ‚Ä∞, and ‚ô´) show components of the <span class="in">`Declock`</span> time (\${setStyle(dotyTime, d3.schemePaired<span class="sc">\[</span>2<span class="sc">\]</span>)}): <span class="in">`cents`</span><span class="ot">[^8]</span> (\${styledCent}), <span class="in">`mils`</span><span class="ot">[^9]</span> (\${styledMil}), and <span class="in">`beats`</span><span class="ot">[^10]</span> (\${styledBeat}). A <span class="in">`cent`</span> is 1% of the day, which is a little less than a quarter hour. A <span class="in">`mil`</span> (<span class="in">`‚Ä∞`</span>) is a tenth of a <span class="in">`cent`</span>, which is close to a minute and a half. A <span class="in">`beat`</span> is 1% of a <span class="in">`mil`</span>, which is almost as long as a second, and can be thought of as a heart‚ù§Ô∏èbeat or musicalüéµ<span class="co">[</span><span class="ot">beat</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Beat_(music)#:~:text=the%20beat%20is%20the%20basic%20unit%20of%20time) with a constant <span class="co">[</span><span class="ot">rate</span><span class="co">](https://en.wikipedia.org/wiki/Heart_rate#:~:text=The%20American%20Heart%20Association%20states%20the%20normal%20resting%20adult%20human%20heart%20rate%20is%2060%2D100%20bpm.)</span> or <span class="co">[</span><span class="ot">tempo</span><span class="co">](https://en.wikipedia.org/wiki/Tempo#Basic_tempo_markings:~:text=Adagietto%20%E2%80%93%20slower%20than,56%E2%80%93108%C2%A0bpm)</span> of 69.4ÃÖ beats per minute. In addition to displaying time on clocksüï∞Ô∏èand‚åöÔ∏èwatches, <span class="in">`beats`</span> can be used to measure durations, such as the time since this webpage was loaded: \${styledTickTime}.</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="ot">[^8]: </span><span class="in">`cent`</span>: a hundredth ($10^{-2}$) of a day; the first 2 digits of the <span class="in">`doty`</span> time; an alternate to quarter hours</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="ot">[^9]: </span><span class="in">`mil`</span>: a thousandth ($10^{-3}$) of a day; the first 3 digits of the <span class="in">`doty`</span> time; an alternate to minutes</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="ot">[^10]: </span><span class="in">`beat`</span>: a hundred thousandth ($10^{-5}$) of a day; the first 5 digits of the <span class="in">`doty`</span> time; an alternate to seconds</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: fig-bar-doty</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Doty bar chart"</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: "center"</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="in">//| column: body</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@fheyen/barchart-clock</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="in">{</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="in">const W = width &gt; 1250 ? width * 2 / 3 : width &gt; 1150 ? width * 3 / 4 : width &gt; 1050 ? width * 4 / 5 : width &gt; 950 ? width * 5 / 6 : width &gt; 850 ? width : width &gt; 750 ? width * 1.02 : width &gt; 650 ? width * 1.06 : width &gt; 550 ? width * 1.1 : width &gt; 450 ? width * 1.14 : width * 1.18;</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a><span class="in">  const H = 156;</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a><span class="in">  const barX = 1;</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="in">  const firstBarY = 1;</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="in">  const svg = d3</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a><span class="in">    .create("svg")</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("width", W)</span></span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr("viewBox", [0, 0, W, H]);</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="in">  const xRange = [0, W - 100];</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a><span class="in">  const scaleM = d3.scaleLinear()</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="in">    .domain([0, 10])</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a><span class="in">    .range(xRange);</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="in">  const scaleCandB = d3.scaleLinear()</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a><span class="in">    .domain([0, 100])</span></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a><span class="in">    .range(xRange);</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a><span class="in">  const scaleDek = d3.scaleLinear()</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a><span class="in">    .domain([0, 37])</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a><span class="in">    .range(xRange);</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a><span class="in">  // Background bars to show where 100% lies</span></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.background')</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(['dek', 'dotd', 'cents', "mils", 'beats'])</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'background timeBar')</span></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', W-100)</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', (d,i)=&gt;i*30+firstBarY)</span></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a><span class="in">  // Dek/Dotd</span></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBar')</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY)</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleDek(Number(dotyDek)+Number(dotyDotd)/10+Number(barCents)/1000))</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBarFull')</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY)</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleDek(dotyDek))</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBar')</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+30)</span></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleM(Number(dotyDotd)+Number(barCents)/100+Number(barMils)/1000))</span></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBarFull')</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+30)</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleM(dotyDotd))</span></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickDek')</span></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 4: 6, 37))</span></span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickDek')</span></span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleDek(d)+barX)</span></span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY)</span></span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('height', d=&gt;d%(width &gt; 500 ? 2 : 3)===0? 6:4)</span></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a><span class="in">  // Cent ticks</span></span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickDotd')</span></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 1: 2, 10))</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickDotd')</span></span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d)+barX)</span></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+49)</span></span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('height', 6)</span></span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickLabel')</span></span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 4: 6, width &gt; 500 ? 37: 35, width &gt; 500 ? 2: 3))</span></span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('text')</span></span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickLabel')</span></span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleDek(d)+barX+.5)</span></span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+22)</span></span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a><span class="in">    .text(d=&gt;d)</span></span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a><span class="in">  // Cents/Mils</span></span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBar')</span></span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+60)</span></span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleCandB(Number(barCents)+Number(barMils)/10+Number(barBeats)/1000))</span></span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBarFull')</span></span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+60)</span></span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleCandB(barCents))</span></span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBar')</span></span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+90)</span></span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleM(Number(barMils)+Number(barBeats)/100+Number(barMb)/100000))</span></span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBarFull')</span></span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+90)</span></span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleM(barMils))</span></span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a><span class="in">  // Cent ticks</span></span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickC')</span></span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 10 : 20, 100))</span></span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickC')</span></span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d/10)+barX)</span></span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+60)</span></span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('height', d=&gt;d%2===0? 8:5)</span></span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickC1')</span></span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 10 : 20, 100))</span></span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickC1')</span></span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d/10)+barX)</span></span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)</span></span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('height', d=&gt;d%2===0? 8:5)</span></span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a><span class="in">  // Mil ticks</span></span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickM')</span></span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 1 : 2, 10))</span></span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickM')</span></span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d)+barX)</span></span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+90)</span></span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('height', 6)</span></span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickM1')</span></span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 1 : 2, 10))</span></span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickM1')</span></span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d)+barX)</span></span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+92.5)</span></span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('height', 2.5)</span></span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickLabel1')</span></span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 1 : 2, 10))</span></span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('text')</span></span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickLabel1')</span></span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d)+barX+.5)</span></span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+47)</span></span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a><span class="in">    .text(d=&gt;d)</span></span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickLabel2')</span></span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 1 : 2, 10))</span></span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('text')</span></span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickLabel2')</span></span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d)+barX+.5)</span></span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+112)</span></span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a><span class="in">    .text(d=&gt;d)</span></span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a><span class="in">  // Beats</span></span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBar')</span></span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+120)</span></span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleCandB(Number(barBeats)+Number(barMb)/1000))</span></span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a><span class="in">  svg</span></span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeBarFull')</span></span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+120)</span></span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('width', d =&gt; scaleCandB(barBeats))</span></span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a><span class="in">  // Beat ticks</span></span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.tickB')</span></span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a><span class="in">    .data(d3.range(width &gt; 500 ? 10 : 20, 100))</span></span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('rect')</span></span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'tickB')</span></span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', d=&gt;scaleM(d/10)+barX)</span></span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', firstBarY+120)</span></span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('height', d=&gt;d%2===0? 9:6)</span></span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a><span class="in">  // Labels</span></span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a><span class="in">  svg.selectAll('.timeLabel')</span></span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a><span class="in">    .data([`${dotyDek}Êó¨`, `${dotyDotd}Êó•`, `${barCents}%`, `${barMils}‚Ä∞`, `${barBeats}‚ô´`])</span></span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a><span class="in">    .enter()</span></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a><span class="in">    .append('text')</span></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('class', 'timeLabel')</span></span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('x', barX+2)</span></span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a><span class="in">    .attr('y', (d,i)=&gt;i*30+firstBarY+20)</span></span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a><span class="in">    .text(d=&gt;d)</span></span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a><span class="in">  return svg.node();</span></span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a><span class="in">html`&lt;style&gt;</span></span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickLabel, .tickLabel1, .tickLabel2, .timeLabel {</span></span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a><span class="in">    fill: #000;</span></span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a><span class="in">    font-family: sans-serif;</span></span>
<span id="cb35-233"><a href="#cb35-233" aria-hidden="true" tabindex="-1"></a><span class="in">    font-size: 20px;</span></span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a><span class="in">    text-anchor: middle;</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a><span class="in">  .timeLabel {</span></span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a><span class="in">    text-anchor: start;</span></span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a><span class="in">  .timeBar, .timeBarFull {</span></span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a><span class="in">    x: 1px;</span></span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a><span class="in">    height: 25px;</span></span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a><span class="in">    rx: 5px;</span></span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a><span class="in">    stroke: #aaa;</span></span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a><span class="in">  .timeBar {</span></span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a><span class="in">    fill: #e8e8e8;</span></span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a><span class="in">  .timeBarFull {</span></span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a><span class="in">    fill: #ccffff;</span></span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a><span class="in">  .background {</span></span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a><span class="in">    fill: white;</span></span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a><span class="in">  .tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB {</span></span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a><span class="in">    stroke: none;</span></span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a><span class="in">    fill: #666;</span></span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a><span class="in">    width: 1px;</span></span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;`</span></span>
<span id="cb35-260"><a href="#cb35-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a>As an alternative to <span class="in">`doty`</span> dates, <span class="in">`Decalendar`</span> can express dates in fractional years, which are similar to the <span class="co">[</span><span class="ot">fractional days</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#Fractional_days)</span> used in <span class="in">`doty`</span> times. Fractional year dates<span class="ot">[^11]</span> can be combined with years into one number and are useful for marking periods of 73 days in the <span class="in">`Decalendar`</span> year. Every 73 days, the <span class="in">`Decalendar`</span> fractional year date increases by .2 (‚Öï). The current <span class="in">`Decalendar`</span> fractional year date is \${setStyle(yearDate.toString().slice(4), d3.schemePaired<span class="sc">\[</span>10<span class="sc">\]</span>)}.</span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a><span class="ot">[^11]: </span>fractional year date: a year and the proportion of that year that has passed; an alternative to <span class="in">`Decalendar`</span> dates</span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a>Now it's your turn! Move the slidersüéöÔ∏èin @exm-intro-doty to adjust the <span class="in">`doty`</span>, fractional year, month, and <span class="in">`dotm`</span> values and see the corresponding 1) Northern Hemisphere season, 2) Southern Hemisphere season, and 3) Zodiac sign in @lst-intro-doty. Try selecting a special date, like your birthdayüéÇ! You can also press the Play‚ñ∂Ô∏èbutton and then sit back and watch the sliders cycleüîÑback and forth from the start to the end of the <span class="in">`Decalendar`</span> year. The sliders cycle through an entire year in 36.5 <span class="in">`beats`</span>, a million times fasterüèéÔ∏èthan the actual speed of time!</span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-doty}</span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a>::: g-col-7</span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a><span class="in">viewof inputDoty = Inputs.range([0, 365], {value: 306, step: 1, label: "doty"});</span></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a><span class="in">viewof year = transformInput(</span></span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.range([0, .999], {step: .001, label: "year"}),</span></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a><span class="in">    {bind: viewof inputDoty, transform: (x =&gt; x / 365), invert: (x =&gt; x * 365)}</span></span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a><span class="in">);</span></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a><span class="in">viewof monthInput = transformInput(</span></span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.range([1, 12], {step: 1, label: "month"}),</span></span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a><span class="in">    {bind: viewof inputDoty, transform: doty2month, invert: month2doty}</span></span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a><span class="in">);</span></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a><span class="in">viewof dotmInput = transformInput(</span></span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.range([1, 31], {step: 1, label: "dotm"}),</span></span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a><span class="in">    {bind: viewof inputDoty, transform: doty2dotm, invert: (x =&gt; Math.floor(( 153 * (</span></span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a><span class="in">        viewof monthInput.value &gt; 2</span></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a><span class="in">        ? viewof monthInput.value - 3</span></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a><span class="in">        : viewof monthInput.value + 9) + 2</span></span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a><span class="in">    ) / 5 + x - 1</span></span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a><span class="in">))});</span></span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a>::: g-col-5</span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>\${inputDotySeason<span class="sc">\[</span>0<span class="sc">\]</span>}</span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>\${inputDotySeason<span class="sc">\[</span>1<span class="sc">\]</span>}</span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>\${inputDotyZodiac}</span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a><span class="in">viewof scrubberDoty = Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864})</span></span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a><span class="in">``` {#lst-intro-doty lst-cap="Date to season conversion"}</span></span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `Doty` Observable code {#sec-ojs-code-doty .appendix}</span></span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Functions {.appendix}</span></span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@observablehq/synchronized-inputs</span></span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a><span class="in">function set(input, value) {</span></span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a><span class="in">  input.value = value;</span></span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a><span class="in">  input.dispatchEvent(new Event("input", {bubbles: true}));</span></span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@mbostock/scrubber</span></span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a><span class="in">function Scrubber(values, {</span></span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a><span class="in">  format = value =&gt; value,</span></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a><span class="in">  initial = 0,</span></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a><span class="in">  direction = 1,</span></span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a><span class="in">  delay = null,</span></span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a><span class="in">  autoplay = true,</span></span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a><span class="in">  loop = true,</span></span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a><span class="in">  loopDelay = null,</span></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a><span class="in">  alternate = false</span></span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a><span class="in">} = {}) {</span></span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a><span class="in">  values = Array.from(values);</span></span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a><span class="in">  const form = html`&lt;form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;"&gt;</span></span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;button name=b type=button style="background-color:#002ead;color:#fff;border-radius:10px;margin-left:.4em;width: 5em;"&gt;&lt;/button&gt;</span></span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;label style="display: flex; align-items: center;"&gt;</span></span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;input name=i type=range min=0 max=${values.length - 1} value=${initial} step=1 style="display: none;"&gt;</span></span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a><span class="in">    &lt;output name=o style="display: none;"&gt;&lt;/output&gt;</span></span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/label&gt;</span></span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/form&gt;`;</span></span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a><span class="in">  let frame = null;</span></span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a><span class="in">  let timer = null;</span></span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a><span class="in">  let interval = null;</span></span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a><span class="in">  function start() {</span></span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a><span class="in">    form.b.textContent = "Pause";</span></span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a><span class="in">    if (delay === null) frame = requestAnimationFrame(tick);</span></span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a><span class="in">    else interval = setInterval(tick, delay);</span></span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a><span class="in">  function stop() {</span></span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a><span class="in">    form.b.textContent = "Play";</span></span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a><span class="in">    if (frame !== null) cancelAnimationFrame(frame), frame = null;</span></span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a><span class="in">    if (timer !== null) clearTimeout(timer), timer = null;</span></span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a><span class="in">    if (interval !== null) clearInterval(interval), interval = null;</span></span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a><span class="in">  function running() {</span></span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a><span class="in">    return frame !== null || timer !== null || interval !== null;</span></span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a><span class="in">  function tick() {</span></span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a><span class="in">    if (form.i.valueAsNumber === (direction &gt; 0 ? values.length - 1 : direction &lt; 0 ? 0 : NaN)) {</span></span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a><span class="in">      if (!loop) return stop();</span></span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a><span class="in">      if (alternate) direction = -direction;</span></span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a><span class="in">      if (loopDelay !== null) {</span></span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a><span class="in">        if (frame !== null) cancelAnimationFrame(frame), frame = null;</span></span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a><span class="in">        if (interval !== null) clearInterval(interval), interval = null;</span></span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a><span class="in">        timer = setTimeout(() =&gt; (step(), start()), loopDelay);</span></span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a><span class="in">        return;</span></span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a><span class="in">    if (delay === null) frame = requestAnimationFrame(tick);</span></span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a><span class="in">    step();</span></span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a><span class="in">  function step() {</span></span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a><span class="in">    form.i.valueAsNumber = (form.i.valueAsNumber + direction + values.length) % values.length;</span></span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a><span class="in">    form.i.dispatchEvent(new CustomEvent("input", {bubbles: true}));</span></span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a><span class="in">  form.i.oninput = event =&gt; {</span></span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a><span class="in">    if (event &amp;&amp; event.isTrusted &amp;&amp; running()) stop();</span></span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a><span class="in">    form.value = values[form.i.valueAsNumber];</span></span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a><span class="in">    form.o.value = format(form.value, form.i.valueAsNumber, values);</span></span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a><span class="in">  form.b.onclick = () =&gt; {</span></span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a><span class="in">    if (running()) return stop();</span></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a><span class="in">    direction = alternate &amp;&amp; form.i.valueAsNumber === values.length - 1 ? -1 : 1;</span></span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a><span class="in">    form.i.valueAsNumber = (form.i.valueAsNumber + direction) % values.length;</span></span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a><span class="in">    form.i.dispatchEvent(new CustomEvent("input", {bubbles: true}));</span></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a><span class="in">    start();</span></span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a><span class="in">  form.i.oninput();</span></span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a><span class="in">  if (autoplay) start();</span></span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a><span class="in">  else stop();</span></span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a><span class="in">  Inputs.disposal(form).then(stop);</span></span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a><span class="in">  return form;</span></span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@juang1744/transform-input/1</span></span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a><span class="in">transformInput = function(target, {bind: source, transform = identity, involutory = false, invert = involutory ? transform : inverse(transform)} = {}){</span></span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a><span class="in">  if (source === undefined) {</span></span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a><span class="in">    source = target;</span></span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a><span class="in">    target = html`&lt;div&gt;${source}&lt;/div&gt;`;</span></span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a><span class="in">  function sourceInputHandler() {</span></span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a><span class="in">    target.removeEventListener("input", targetInputHandler);</span></span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a><span class="in">    setTransform(target).to(transform(source.value)).andDispatchEvent();</span></span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a><span class="in">    target.addEventListener("input", targetInputHandler);</span></span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a><span class="in">  function targetInputHandler() {</span></span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a><span class="in">    source.removeEventListener("input", sourceInputHandler);</span></span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a><span class="in">    setTransform(source).to(invert(target.value)).andDispatchEvent();</span></span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a><span class="in">    source.addEventListener("input", sourceInputHandler);</span></span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a><span class="in">  source.addEventListener("input", sourceInputHandler);</span></span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a><span class="in">  target.addEventListener("input", targetInputHandler);</span></span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a><span class="in">  invalidation.then(() =&gt; {</span></span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a><span class="in">    source.removeEventListener("input", sourceInputHandler);</span></span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a><span class="in">    target.removeEventListener("input", targetInputHandler);</span></span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a><span class="in">  sourceInputHandler();</span></span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a><span class="in">  return target;</span></span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a><span class="in">setTransform = (input) =&gt; ({to: (value) =&gt; (input.value = value, {andDispatchEvent: (event = new Event("input")) =&gt; input.dispatchEvent(event)})});</span></span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a><span class="in">function inverse(f) {</span></span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a><span class="in">  switch (f) {</span></span>
<span id="cb35-433"><a href="#cb35-433" aria-hidden="true" tabindex="-1"></a><span class="in">    case identity:  return identity;</span></span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a><span class="in">    case Math.sqrt: return square;</span></span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a><span class="in">    case Math.log:  return Math.exp;</span></span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a><span class="in">    case Math.exp:  return Math.log;</span></span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a><span class="in">    default:        return (x =&gt; solve(f, x, x));</span></span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a><span class="in">  function solve(f, y, x = 0) {</span></span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a><span class="in">    const dx = 1e-6;</span></span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a><span class="in">    let steps = 100, deltax, fx, dfx;</span></span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a><span class="in">    do {</span></span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a><span class="in">      fx = f(x)</span></span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a><span class="in">      dfx = (f(x + dx) - fx) || dx;</span></span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a><span class="in">      deltax = dx * (fx - y)/dfx</span></span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a><span class="in">      x -= deltax;</span></span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a><span class="in">    } while (Math.abs(deltax) &gt; dx &amp;&amp; --steps &gt; 0);</span></span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a><span class="in">    return steps === 0 ? NaN : x;</span></span>
<span id="cb35-449"><a href="#cb35-449" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-450"><a href="#cb35-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a><span class="in">  function square(x) {</span></span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a><span class="in">    return x * x;</span></span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a><span class="in">function identity(x) {</span></span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a><span class="in">  return x;</span></span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor</span></span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a><span class="in">function setStyle(content, style = {}) {</span></span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a><span class="in">  function yiq(color) {</span></span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a><span class="in">    const {r, g, b} = d3.rgb(color);</span></span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a><span class="in">    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1</span></span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a><span class="in">  const {</span></span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a><span class="in">    background,</span></span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a><span class="in">    color = yiq(background) &gt;= 0.6 ? "#111" : "white",</span></span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a><span class="in">    padding = "0 1px",</span></span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a><span class="in">    borderRadius = "4px",</span></span>
<span id="cb35-469"><a href="#cb35-469" aria-hidden="true" tabindex="-1"></a><span class="in">    fontWeight = 900,</span></span>
<span id="cb35-470"><a href="#cb35-470" aria-hidden="true" tabindex="-1"></a><span class="in">    fontSize = "1em",</span></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a><span class="in">    ...rest</span></span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a><span class="in">  } = typeof style === "string" ? {background: style} : style;</span></span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a><span class="in">  return htl.html`&lt;span style=${{</span></span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a><span class="in">    background,</span></span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a><span class="in">    color,</span></span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a><span class="in">    padding,</span></span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a><span class="in">    borderRadius,</span></span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a><span class="in">    fontWeight,</span></span>
<span id="cb35-479"><a href="#cb35-479" aria-hidden="true" tabindex="-1"></a><span class="in">    ...rest</span></span>
<span id="cb35-480"><a href="#cb35-480" aria-hidden="true" tabindex="-1"></a><span class="in">  }}&gt;${content}&lt;/span&gt;`;</span></span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a><span class="in">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a><span class="in">function dote2doty(days = 719468) {</span></span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a><span class="in">    const era = Math.floor((days &gt;= 0 ? days : days - 146096) / 146097),</span></span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a><span class="in">        dotc = days - era * 146097,</span></span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a><span class="in">        yotc = Math.floor((dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365);</span></span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a><span class="in">    return [yotc + era * 400, dotc + Math.floor(yotc / 100) - yotc * 365 - Math.floor(yotc / 4)];</span></span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a><span class="in">function unix2doty(ms = 0) {</span></span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a><span class="in">  return dote2doty(ms / 86400000 + 719468)</span></span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a><span class="in">// https://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb35-493"><a href="#cb35-493" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2dote(year = 1969, doty = 0, zone = 0) {</span></span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a><span class="in">    const cycle = Math.floor((year &gt;= 0 ? year : year - 399) / 400),</span></span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a><span class="in">    yote = year - cycle * 400;</span></span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a><span class="in">    return cycle * 146097 + yote * 365 + Math.floor(yote / 4) - Math.floor(yote / 100) + doty - zone</span></span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2deco(yearDoty = [1969, 306], zone = 0) {</span></span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a><span class="in">    const yd = dote2doty(doty2dote(yearDoty[0], Math.floor(yearDoty[1])));</span></span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a><span class="in">    return `${yd[0]}+${(yd[1]).toString().padStart(3, "0")}${</span></span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a><span class="in">        yearDoty[1].toString().includes(".") ? "." + (</span></span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a><span class="in">            (yearDoty[1] &gt; 0) ? (yearDoty[1] - zone).toString().split(".").pop()</span></span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a><span class="in">            : [...(yearDoty[1] - zone).toString().split(".").pop()].map(</span></span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a><span class="in">                (e, i, a) =&gt; (i + 1 === a.length) ? 10 - e : 9 - e</span></span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a><span class="in">            ).join("")</span></span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a><span class="in">        ) : ""</span></span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a><span class="in">    }`</span></span>
<span id="cb35-508"><a href="#cb35-508" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a><span class="in">function unix2deco(ms = 0) {</span></span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a><span class="in">    return doty2deco(unix2doty(ms));</span></span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a><span class="in">};</span></span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a><span class="in">// http://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a><span class="in">function greg2doty(month = 1, day = 1) {</span></span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a><span class="in">    return Math.floor(</span></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a><span class="in">        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5 + day - 1</span></span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a><span class="in">)}</span></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a><span class="in">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2greg(doty = 0) {</span></span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a><span class="in">    const m = Math.floor((5 * doty + 2) / 153);</span></span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a><span class="in">    return [Math.floor(m &lt; 10 ? m + 3 : m - 9), doty - Math.floor((153 * m + 2) / 5) + 1];</span></span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2toty(doty = 306) {</span></span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a><span class="in">    doty = Math.floor(doty)</span></span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a><span class="in">    return (205 &lt;= doty &amp;&amp; doty &lt; 295) ? ["FallüçÅ", "Springüåº"] :</span></span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a><span class="in">        (110 &lt;= doty &amp;&amp; doty &lt; 205) ? ["Summer‚òÄÔ∏è", "Winter‚ùÑÔ∏è"] :</span></span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a><span class="in">        (20 &lt;= doty &amp;&amp; doty &lt; 110) ? ["Springüåº", "FallüçÅ"] :</span></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a><span class="in">        (0 &lt;= doty &amp;&amp; doty &lt; 20) || (295 &lt;= doty &amp;&amp; doty &lt;= 365)</span></span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a><span class="in">        ? ["Winter‚ùÑÔ∏è", "Summer‚òÄÔ∏è"] : "Unknown"</span></span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2zodi(doty = 306) {</span></span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a><span class="in">    doty = Math.floor(doty)</span></span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a><span class="in">    return (20 &lt;= doty &amp;&amp; doty &lt; 50) ? "Aries‚ôàÔ∏è" :</span></span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a><span class="in">     (50 &lt;= doty &amp;&amp; doty &lt; 81) ? "Taurus‚ôâÔ∏è" :</span></span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a><span class="in">     (81 &lt;= doty &amp;&amp; doty &lt; 112) ? "Gemini‚ôäÔ∏è" :</span></span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a><span class="in">     (112 &lt;= doty &amp;&amp; doty &lt; 144) ? "Cancer‚ôãÔ∏è" :</span></span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a><span class="in">     (144 &lt;= doty &amp;&amp; doty &lt; 175) ? "Leo‚ôåÔ∏è" :</span></span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a><span class="in">     (175 &lt;= doty &amp;&amp; doty &lt; 206) ? "Virgo‚ôçÔ∏è" :</span></span>
<span id="cb35-538"><a href="#cb35-538" aria-hidden="true" tabindex="-1"></a><span class="in">     (206 &lt;= doty &amp;&amp; doty &lt; 236) ? "Libra‚ôéÔ∏è" :</span></span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a><span class="in">     (236 &lt;= doty &amp;&amp; doty &lt; 266) ? "Scorpio‚ôèÔ∏è" :</span></span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a><span class="in">     (266 &lt;= doty &amp;&amp; doty &lt; 296) ? "Sagittarius‚ôêÔ∏è" :</span></span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a><span class="in">     (296 &lt;= doty &amp;&amp; doty &lt; 325) ? "Capricorn‚ôëÔ∏è" :</span></span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a><span class="in">     (325 &lt;= doty &amp;&amp; doty &lt; 355) ? "Aquarius‚ôíÔ∏è" :</span></span>
<span id="cb35-543"><a href="#cb35-543" aria-hidden="true" tabindex="-1"></a><span class="in">     (355 &lt;= doty &amp;&amp; doty &lt;= 365) || (0 &lt;= doty &amp;&amp; doty &lt; 20)</span></span>
<span id="cb35-544"><a href="#cb35-544" aria-hidden="true" tabindex="-1"></a><span class="in">     ? "Pisces‚ôìÔ∏è" : "Unknown"</span></span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2month(doty = 0) {</span></span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a><span class="in">    const m = Math.floor((5 * doty + 2) / 153);</span></span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a><span class="in">    return Math.floor(m &lt; 10 ? m + 3 : m - 9);</span></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a><span class="in">function month2doty(month = 1) {</span></span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a><span class="in">    return Math.floor(</span></span>
<span id="cb35-552"><a href="#cb35-552" aria-hidden="true" tabindex="-1"></a><span class="in">        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5</span></span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a><span class="in">)}</span></span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2dotm(doty = 0) {</span></span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a><span class="in">    const m = Math.floor((5 * doty + 2) / 153);</span></span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a><span class="in">    return doty - Math.floor((153 * m + 2) / 5) + 1;</span></span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variables {.appendix}</span></span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-565"><a href="#cb35-565" aria-hidden="true" tabindex="-1"></a><span class="in">//| output: all</span></span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a><span class="in">width</span></span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a><span class="in">unix = {</span></span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a><span class="in">  while(true) {</span></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a><span class="in">    yield Date.now();</span></span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a><span class="in">tick = {</span></span>
<span id="cb35-573"><a href="#cb35-573" aria-hidden="true" tabindex="-1"></a><span class="in">  let i = 0;</span></span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a><span class="in">  while (true) {</span></span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a><span class="in">    yield Promises.tick(864, ++i);</span></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a><span class="in">tickDate = Math.floor(tick / 1e5)</span></span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a><span class="in">tickTime = tick % 1e5</span></span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a><span class="in">tickDelimiter = (tickDate &gt; 0) ? "." : ""</span></span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a><span class="in">barTime = unix2dote(unix).toString().split(".")[1].slice(0, 8)</span></span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a><span class="in">barCents = barTime.slice(0, 2)</span></span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a><span class="in">barMils = barTime[2]</span></span>
<span id="cb35-584"><a href="#cb35-584" aria-hidden="true" tabindex="-1"></a><span class="in">barBeats = barTime.slice(3, 5)</span></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a><span class="in">barMb = barTime.slice(5)</span></span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a><span class="in">deco = unix2deco(unix).slice(0, 14)</span></span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a><span class="in">doty = deco.slice(5)</span></span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a><span class="in">dotyDate = doty.slice(0, 3)</span></span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a><span class="in">dotyTime = doty.slice(4)</span></span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a><span class="in">dotyDek = doty.slice(0, 2)</span></span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a><span class="in">dotyDotd = doty[2]</span></span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a><span class="in">iso = {</span></span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a><span class="in">  while(true) {</span></span>
<span id="cb35-594"><a href="#cb35-594" aria-hidden="true" tabindex="-1"></a><span class="in">    yield new Date().toISOString()</span></span>
<span id="cb35-595"><a href="#cb35-595" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a><span class="in">isoDate = iso.slice(5, 10)</span></span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a><span class="in">isoTime = iso.slice(11, 19)</span></span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a><span class="in">season = doty2toty(dotyDate)</span></span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a><span class="in">zodiac = doty2zodi(dotyDate)</span></span>
<span id="cb35-601"><a href="#cb35-601" aria-hidden="true" tabindex="-1"></a><span class="in">inputDotySeason = doty2toty(inputDoty)</span></span>
<span id="cb35-602"><a href="#cb35-602" aria-hidden="true" tabindex="-1"></a><span class="in">inputDotyZodiac = doty2zodi(inputDoty)</span></span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a><span class="in">numbers = Array.from({length: 366}, (_, i) =&gt; i)</span></span>
<span id="cb35-604"><a href="#cb35-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-605"><a href="#cb35-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-609"><a href="#cb35-609" aria-hidden="true" tabindex="-1"></a><span class="in">styledYear = setStyle(deco.slice(0, 4), d3.schemePaired[10])</span></span>
<span id="cb35-610"><a href="#cb35-610" aria-hidden="true" tabindex="-1"></a><span class="in">styledDotyDate = setStyle(dotyDate, d3.schemePaired[1])</span></span>
<span id="cb35-611"><a href="#cb35-611" aria-hidden="true" tabindex="-1"></a><span class="in">styledDotyTime = setStyle(dotyTime, d3.schemePaired[2])</span></span>
<span id="cb35-612"><a href="#cb35-612" aria-hidden="true" tabindex="-1"></a><span class="in">styledDotyDate1 = setStyle(dotyDate, d3.schemePaired[1])</span></span>
<span id="cb35-613"><a href="#cb35-613" aria-hidden="true" tabindex="-1"></a><span class="in">styledDotyTime1 = setStyle(dotyTime, d3.schemePaired[2])</span></span>
<span id="cb35-614"><a href="#cb35-614" aria-hidden="true" tabindex="-1"></a><span class="in">styledTickTime = setStyle(tickTime, d3.schemePaired[2])</span></span>
<span id="cb35-615"><a href="#cb35-615" aria-hidden="true" tabindex="-1"></a><span class="in">styledDek = setStyle(dotyDek, d3.schemePaired[0])</span></span>
<span id="cb35-616"><a href="#cb35-616" aria-hidden="true" tabindex="-1"></a><span class="in">styledDotd = setStyle(dotyDotd, d3.schemePaired[9])</span></span>
<span id="cb35-617"><a href="#cb35-617" aria-hidden="true" tabindex="-1"></a><span class="in">styledCent = setStyle(dotyTime.slice(0, 2), d3.schemePaired[7])</span></span>
<span id="cb35-618"><a href="#cb35-618" aria-hidden="true" tabindex="-1"></a><span class="in">styledMil = setStyle(dotyTime[2], d3.schemePaired[6])</span></span>
<span id="cb35-619"><a href="#cb35-619" aria-hidden="true" tabindex="-1"></a><span class="in">styledBeat = setStyle(dotyTime.slice(3, 5), d3.schemePaired[11])</span></span>
<span id="cb35-620"><a href="#cb35-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-621"><a href="#cb35-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-622"><a href="#cb35-622" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Set values {.appendix}</span></span>
<span id="cb35-623"><a href="#cb35-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-626"><a href="#cb35-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-627"><a href="#cb35-627" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-628"><a href="#cb35-628" aria-hidden="true" tabindex="-1"></a><span class="in">set(viewof inputDoty, scrubberDoty)</span></span>
<span id="cb35-629"><a href="#cb35-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-630"><a href="#cb35-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-633"><a href="#cb35-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-634"><a href="#cb35-634" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-635"><a href="#cb35-635" aria-hidden="true" tabindex="-1"></a><span class="in">set(viewof decoOutput, `1969+${scrubberDeco.toString().padStart(3, "0")}`)</span></span>
<span id="cb35-636"><a href="#cb35-636" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-637"><a href="#cb35-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-638"><a href="#cb35-638" aria-hidden="true" tabindex="-1"></a><span class="fu">## Year {#sec-intro-year}</span></span>
<span id="cb35-639"><a href="#cb35-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-640"><a href="#cb35-640" aria-hidden="true" tabindex="-1"></a><span class="in">`Doty`</span> dates (<span class="in">`day`</span>) and <span class="co">[</span><span class="ot">timestamps</span><span class="co">](https://en.wikipedia.org/wiki/Timestamp#:~:text=A%20timestamp%20is%20a%20sequence%20of%20characters%20or%20encoded%20information%20identifying%20when%20a%20certain%20event%20occurred%2C%20usually%20giving%20date%20and%20time%20of%20day%2C%20sometimes%20accurate%20to%20a%20small%20fraction%20of%20a%20second.)</span> (<span class="in">`day.stamp`</span>) do not include years and thus can be reused from year to year. When a <span class="in">`doty`</span> is combined with a year, it forms a <span class="in">`Decalendar`</span> <span class="in">`ordinal`</span><span class="ot">[^12]</span> (<span class="in">`deco`</span>) and represents a specific date (<span class="in">`year+day`</span>) or time (<span class="in">`year+day.stamp`</span>) in a specific year, instead of a date (<span class="in">`day`</span>) or time (<span class="in">`day.stamp`</span>) that occurs every year or every leap year. Using the <span class="co">[</span><span class="ot">Observable</span><span class="co">](https://observablehq.com/about)</span> <span class="co">[</span><span class="ot">datetime input</span><span class="co">](https://observablehq.com/@observablehq/input-date#cell-111)</span> in @exm-intro-date, you can select a year, month, <span class="in">`dotm`</span>, hour, and minute to see the equivalent 1) <span class="in">`deco`</span> timestamp (<span class="in">`year+day.clock`</span>) and 2) year date (<span class="in">`year.yyy`</span>) in @lst-intro-date. For comparison, the current <span class="in">`deco`</span> timestamp is \${styledYear}+\${styledDotyDate1}.\${styledDotyTime1}.</span>
<span id="cb35-641"><a href="#cb35-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-642"><a href="#cb35-642" aria-hidden="true" tabindex="-1"></a><span class="ot">[^12]: </span><span class="in">`deco`</span>: a date and time format consisting of a year and a <span class="in">`doty`</span> and analogous to ISO 8601 dates</span>
<span id="cb35-643"><a href="#cb35-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-644"><a href="#cb35-644" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-date}</span>
<span id="cb35-645"><a href="#cb35-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-646"><a href="#cb35-646" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-647"><a href="#cb35-647" aria-hidden="true" tabindex="-1"></a>::: g-col-7</span>
<span id="cb35-650"><a href="#cb35-650" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-651"><a href="#cb35-651" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-652"><a href="#cb35-652" aria-hidden="true" tabindex="-1"></a><span class="in">viewof inputDatetime = Inputs.datetime({label: "date", value: "1970-01-01T00:00"})</span></span>
<span id="cb35-653"><a href="#cb35-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-654"><a href="#cb35-654" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-655"><a href="#cb35-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-656"><a href="#cb35-656" aria-hidden="true" tabindex="-1"></a>::: g-col-5</span>
<span id="cb35-657"><a href="#cb35-657" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>\${dtYear}+\${dtDotyDate}\${dtDotyTimeDelimiter}\${dtDotyTime}</span>
<span id="cb35-658"><a href="#cb35-658" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>\${styledOutputDatetimeYear}</span>
<span id="cb35-659"><a href="#cb35-659" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-660"><a href="#cb35-660" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-661"><a href="#cb35-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-662"><a href="#cb35-662" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb35-663"><a href="#cb35-663" aria-hidden="true" tabindex="-1"></a><span class="in">``` {#lst-intro-date lst-cap="Date and time conversion" cap-location="margin"}</span></span>
<span id="cb35-664"><a href="#cb35-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-665"><a href="#cb35-665" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-666"><a href="#cb35-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-667"><a href="#cb35-667" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-668"><a href="#cb35-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-669"><a href="#cb35-669" aria-hidden="true" tabindex="-1"></a>In @exm-intro-deco, you can enter numeric year and <span class="in">`doty`</span> values or type in a free-form <span class="in">`deco`</span> to see the resulting 1) <span class="co">[</span><span class="ot">ISO 8601 timestamp</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations)</span> (<span class="in">`year-mm-ddThh:mm:ss`</span>) and 2) year date in @lst-intro-deco. @exm-intro-deco also has a Play‚ñ∂Ô∏èbutton in that cycles from <span class="in">`Day`</span> <span class="in">`0`</span> to <span class="in">`Day`</span> <span class="in">`365`</span> of <span class="in">`Year`</span> <span class="in">`1969`</span>. The cycle goes up to <span class="in">`Day`</span> <span class="in">`0`</span> of <span class="in">`Year`</span> <span class="in">`1970`</span>, because <span class="in">`Year`</span> <span class="in">`1969`</span> is a common year and does not have a <span class="in">`Day`</span> <span class="in">`365`</span>.</span>
<span id="cb35-670"><a href="#cb35-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-671"><a href="#cb35-671" aria-hidden="true" tabindex="-1"></a>Interacting with the <span class="co">[</span><span class="ot">number</span><span class="co">](https://observablehq.com/@observablehq/input-range#m)</span> inputs in @exm-intro-deco, standardizes the <span class="in">`deco`</span> in the <span class="co">[</span><span class="ot">text</span><span class="co">](https://observablehq.com/@observablehq/input-text)</span> input to ensure years are integers and <span class="in">`doty`</span> values are positive numbers below 366. Nevertheless, all of the inputs in @exm-intro-deco support negative and fractional year and <span class="in">`doty`</span> values. Negative <span class="in">`doty`</span> values <span class="co">[</span><span class="ot">shift</span><span class="co">](https://en.wikipedia.org/wiki/Shift_operator)</span> dates backward in time from the start of a given year into a previous year. Similarly, negative years shift dates backward starting from <span class="in">`Year`</span> <span class="in">`0`</span>, which is 1 BCE (Before the <span class="co">[</span><span class="ot">Common Era</span><span class="co">](https://en.wikipedia.org/wiki/Common_Era)</span>).</span>
<span id="cb35-672"><a href="#cb35-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-673"><a href="#cb35-673" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-deco}</span>
<span id="cb35-674"><a href="#cb35-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-675"><a href="#cb35-675" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-676"><a href="#cb35-676" aria-hidden="true" tabindex="-1"></a>::: g-col-7</span>
<span id="cb35-679"><a href="#cb35-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-680"><a href="#cb35-680" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-681"><a href="#cb35-681" aria-hidden="true" tabindex="-1"></a><span class="in">viewof yd = Inputs.form([</span></span>
<span id="cb35-682"><a href="#cb35-682" aria-hidden="true" tabindex="-1"></a><span class="in">  Inputs.number({label: "year", value: "1969"}),</span></span>
<span id="cb35-683"><a href="#cb35-683" aria-hidden="true" tabindex="-1"></a><span class="in">  Inputs.number({label: "doty", value: "306"})</span></span>
<span id="cb35-684"><a href="#cb35-684" aria-hidden="true" tabindex="-1"></a><span class="in">])</span></span>
<span id="cb35-685"><a href="#cb35-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-686"><a href="#cb35-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-689"><a href="#cb35-689" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-690"><a href="#cb35-690" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-691"><a href="#cb35-691" aria-hidden="true" tabindex="-1"></a><span class="in">viewof decoOutput = transformInput(</span></span>
<span id="cb35-692"><a href="#cb35-692" aria-hidden="true" tabindex="-1"></a><span class="in">  Inputs.text({label: "deco", placeholder: "year+day.ddd", value: "1969+306"}),</span></span>
<span id="cb35-693"><a href="#cb35-693" aria-hidden="true" tabindex="-1"></a><span class="in">  {bind: viewof yd, transform: doty2deco, invert: deco2doty});</span></span>
<span id="cb35-694"><a href="#cb35-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-695"><a href="#cb35-695" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-696"><a href="#cb35-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-697"><a href="#cb35-697" aria-hidden="true" tabindex="-1"></a>::: g-col-5</span>
<span id="cb35-698"><a href="#cb35-698" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>\${styledIsocYear}-\${styledIsocMd}T\${styledIsocTime}</span>
<span id="cb35-699"><a href="#cb35-699" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>\${styledOutputDecoYear}</span>
<span id="cb35-700"><a href="#cb35-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-703"><a href="#cb35-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-704"><a href="#cb35-704" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-705"><a href="#cb35-705" aria-hidden="true" tabindex="-1"></a><span class="in">viewof scrubberDeco = Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864})</span></span>
<span id="cb35-706"><a href="#cb35-706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-707"><a href="#cb35-707" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-708"><a href="#cb35-708" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-709"><a href="#cb35-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-710"><a href="#cb35-710" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb35-711"><a href="#cb35-711" aria-hidden="true" tabindex="-1"></a><span class="in">``` {#lst-intro-deco lst-cap="Deco timestamp conversion" cap-location="margin"}</span></span>
<span id="cb35-712"><a href="#cb35-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-713"><a href="#cb35-713" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-714"><a href="#cb35-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-715"><a href="#cb35-715" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-716"><a href="#cb35-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-717"><a href="#cb35-717" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `Deco` Observable code {#sec-ojs-code-deco .appendix}</span></span>
<span id="cb35-718"><a href="#cb35-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-719"><a href="#cb35-719" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Functions {.appendix}</span></span>
<span id="cb35-720"><a href="#cb35-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-721"><a href="#cb35-721" aria-hidden="true" tabindex="-1"></a><span class="in">``` javascript</span></span>
<span id="cb35-722"><a href="#cb35-722" aria-hidden="true" tabindex="-1"></a>copyq<span class="op">:</span></span>
<span id="cb35-723"><a href="#cb35-723" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2doty</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-724"><a href="#cb35-724" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days <span class="op">=</span> ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span><span class="op">,</span></span>
<span id="cb35-725"><a href="#cb35-725" aria-hidden="true" tabindex="-1"></a>        dote <span class="op">=</span> days <span class="op">-</span> (era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)) <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb35-726"><a href="#cb35-726" aria-hidden="true" tabindex="-1"></a>        year <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dote <span class="op">-</span> dote <span class="op">/</span> <span class="dv">1460</span> <span class="op">+</span> dote <span class="op">/</span> <span class="dv">36524</span> <span class="op">-</span> dote <span class="op">/</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">365</span>) <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb35-727"><a href="#cb35-727" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [year<span class="op">,</span> days <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(year <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">4</span> <span class="op">-</span> year <span class="op">/</span> <span class="dv">100</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">400</span>)]<span class="op">;</span></span>
<span id="cb35-728"><a href="#cb35-728" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-729"><a href="#cb35-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-730"><a href="#cb35-730" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> [year<span class="op">,</span> doty] <span class="op">=</span> <span class="fu">unix2doty</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())<span class="op">,</span></span>
<span id="cb35-731"><a href="#cb35-731" aria-hidden="true" tabindex="-1"></a>    datetime <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>year<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span></span>
<span id="cb35-732"><a href="#cb35-732" aria-hidden="true" tabindex="-1"></a>    (day <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty))<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">.</span><span class="sc">${</span></span>
<span id="cb35-733"><a href="#cb35-733" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>((doty <span class="op">-</span> day) <span class="op">*</span> <span class="fl">1e5</span>))<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">5</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">+0`</span><span class="op">;</span></span>
<span id="cb35-734"><a href="#cb35-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-735"><a href="#cb35-735" aria-hidden="true" tabindex="-1"></a><span class="fu">copy</span>(datetime)</span>
<span id="cb35-736"><a href="#cb35-736" aria-hidden="true" tabindex="-1"></a><span class="fu">copySelection</span>(datetime)</span>
<span id="cb35-737"><a href="#cb35-737" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>()</span>
<span id="cb35-738"><a href="#cb35-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-739"><a href="#cb35-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-742"><a href="#cb35-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-743"><a href="#cb35-743" aria-hidden="true" tabindex="-1"></a><span class="in">function zone2hour(zone = "Z") {</span></span>
<span id="cb35-744"><a href="#cb35-744" aria-hidden="true" tabindex="-1"></a><span class="in">    return (zone = zone.toUpperCase()) == "Z" ? 0</span></span>
<span id="cb35-745"><a href="#cb35-745" aria-hidden="true" tabindex="-1"></a><span class="in">        : zone &gt; "@" &amp;&amp; zone &lt; "J" ? zone.charCodeAt() - 64</span></span>
<span id="cb35-746"><a href="#cb35-746" aria-hidden="true" tabindex="-1"></a><span class="in">        : zone &gt; "J" &amp;&amp; zone &lt; "N" ? zone.charCodeAt() - 65</span></span>
<span id="cb35-747"><a href="#cb35-747" aria-hidden="true" tabindex="-1"></a><span class="in">        : zone &lt; "Z" &amp;&amp; zone &gt; "M" ? -(zone.charCodeAt() - 77)</span></span>
<span id="cb35-748"><a href="#cb35-748" aria-hidden="true" tabindex="-1"></a><span class="in">        : zone;</span></span>
<span id="cb35-749"><a href="#cb35-749" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-750"><a href="#cb35-750" aria-hidden="true" tabindex="-1"></a><span class="in">function deco2doty(timestamp = "1969+306.00000Z") {</span></span>
<span id="cb35-751"><a href="#cb35-751" aria-hidden="true" tabindex="-1"></a><span class="in">    const arr = timestamp.toString().split(/(?=[+-]|[a-zA-Z])/, 3);</span></span>
<span id="cb35-752"><a href="#cb35-752" aria-hidden="true" tabindex="-1"></a><span class="in">    switch (arr.length) {</span></span>
<span id="cb35-753"><a href="#cb35-753" aria-hidden="true" tabindex="-1"></a><span class="in">        case 1: return [unix2doty(Date.now())[0], parseFloat(arr[0]), 0];</span></span>
<span id="cb35-754"><a href="#cb35-754" aria-hidden="true" tabindex="-1"></a><span class="in">        case 2: return (/^[a-zA-Z]+$/.test(arr[1]))</span></span>
<span id="cb35-755"><a href="#cb35-755" aria-hidden="true" tabindex="-1"></a><span class="in">            ? [unix2doty(Date.now())[0], parseFloat(arr[0]), zone2hour(arr[1]) / 24]</span></span>
<span id="cb35-756"><a href="#cb35-756" aria-hidden="true" tabindex="-1"></a><span class="in">            : [parseFloat(arr[0]), parseFloat(arr[1]), 0];</span></span>
<span id="cb35-757"><a href="#cb35-757" aria-hidden="true" tabindex="-1"></a><span class="in">    };</span></span>
<span id="cb35-758"><a href="#cb35-758" aria-hidden="true" tabindex="-1"></a><span class="in">    return [parseFloat(arr[0]), parseFloat(arr[1]), /^[a-zA-Z]+$/.test(arr[2])</span></span>
<span id="cb35-759"><a href="#cb35-759" aria-hidden="true" tabindex="-1"></a><span class="in">        ? zone2hour(arr[2]) / 24</span></span>
<span id="cb35-760"><a href="#cb35-760" aria-hidden="true" tabindex="-1"></a><span class="in">        : parseFloat(arr[2].replace(/([+-])/, "$1\."))];</span></span>
<span id="cb35-761"><a href="#cb35-761" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-762"><a href="#cb35-762" aria-hidden="true" tabindex="-1"></a><span class="in">function deco2deco(timestamp = "1969+306.00000Z") {</span></span>
<span id="cb35-763"><a href="#cb35-763" aria-hidden="true" tabindex="-1"></a><span class="in">    return doty2deco(deco2doty(timestamp))</span></span>
<span id="cb35-764"><a href="#cb35-764" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-765"><a href="#cb35-765" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2doty(year = 1969, doty = 0, zone = 0) {</span></span>
<span id="cb35-766"><a href="#cb35-766" aria-hidden="true" tabindex="-1"></a><span class="in">    return dote2doty(doty2dote(year, doty, zone));</span></span>
<span id="cb35-767"><a href="#cb35-767" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-768"><a href="#cb35-768" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2unix(year = 1969, doty = 306, zone = 0) {</span></span>
<span id="cb35-769"><a href="#cb35-769" aria-hidden="true" tabindex="-1"></a><span class="in">    return (doty2dote(year, doty, zone) - 719468) * 86400000;</span></span>
<span id="cb35-770"><a href="#cb35-770" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-771"><a href="#cb35-771" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2isoc(year = 1969, doty = 306, zone = 0) {</span></span>
<span id="cb35-772"><a href="#cb35-772" aria-hidden="true" tabindex="-1"></a><span class="in">    return new Date(doty2unix(year, doty, zone)).toISOString().split(".")[0]</span></span>
<span id="cb35-773"><a href="#cb35-773" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-774"><a href="#cb35-774" aria-hidden="true" tabindex="-1"></a><span class="in">function deco2isoc(timestamp = "1969+306.00000Z") {</span></span>
<span id="cb35-775"><a href="#cb35-775" aria-hidden="true" tabindex="-1"></a><span class="in">    return doty2isoc(...deco2doty(timestamp))</span></span>
<span id="cb35-776"><a href="#cb35-776" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-777"><a href="#cb35-777" aria-hidden="true" tabindex="-1"></a><span class="in">function unix2dote(ms = 0) {</span></span>
<span id="cb35-778"><a href="#cb35-778" aria-hidden="true" tabindex="-1"></a><span class="in">  return ms / 86400000 + 719468;</span></span>
<span id="cb35-779"><a href="#cb35-779" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-780"><a href="#cb35-780" aria-hidden="true" tabindex="-1"></a><span class="in">function dote2year(days = 719468) {</span></span>
<span id="cb35-781"><a href="#cb35-781" aria-hidden="true" tabindex="-1"></a><span class="in">    const era = Math.floor((days &gt;= 0 ? days : days - 146096) / 146097),</span></span>
<span id="cb35-782"><a href="#cb35-782" aria-hidden="true" tabindex="-1"></a><span class="in">        dotc = days - era * 146097,</span></span>
<span id="cb35-783"><a href="#cb35-783" aria-hidden="true" tabindex="-1"></a><span class="in">        yotc = (dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365;</span></span>
<span id="cb35-784"><a href="#cb35-784" aria-hidden="true" tabindex="-1"></a><span class="in">    return yotc + era * 400;</span></span>
<span id="cb35-785"><a href="#cb35-785" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-786"><a href="#cb35-786" aria-hidden="true" tabindex="-1"></a><span class="in">function doty2year(year = 1969, doty = 306, zone = 0) {</span></span>
<span id="cb35-787"><a href="#cb35-787" aria-hidden="true" tabindex="-1"></a><span class="in">    return dote2year(doty2dote(year, doty, zone));</span></span>
<span id="cb35-788"><a href="#cb35-788" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-789"><a href="#cb35-789" aria-hidden="true" tabindex="-1"></a><span class="in">function unix2year(ms = 0) {</span></span>
<span id="cb35-790"><a href="#cb35-790" aria-hidden="true" tabindex="-1"></a><span class="in">    return dote2year(unix2dote(ms));</span></span>
<span id="cb35-791"><a href="#cb35-791" aria-hidden="true" tabindex="-1"></a><span class="in">};</span></span>
<span id="cb35-792"><a href="#cb35-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-793"><a href="#cb35-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-794"><a href="#cb35-794" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variables {.appendix}</span></span>
<span id="cb35-795"><a href="#cb35-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-798"><a href="#cb35-798" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-799"><a href="#cb35-799" aria-hidden="true" tabindex="-1"></a><span class="in">//| output: all</span></span>
<span id="cb35-800"><a href="#cb35-800" aria-hidden="true" tabindex="-1"></a><span class="in">tzOffsetInMs = inputDatetime.getTimezoneOffset() * 60000</span></span>
<span id="cb35-801"><a href="#cb35-801" aria-hidden="true" tabindex="-1"></a><span class="in">utcDatetime = inputDatetime - tzOffsetInMs</span></span>
<span id="cb35-802"><a href="#cb35-802" aria-hidden="true" tabindex="-1"></a><span class="in">outputDatetimeDeco = unix2deco(utcDatetime)</span></span>
<span id="cb35-803"><a href="#cb35-803" aria-hidden="true" tabindex="-1"></a><span class="in">dtDoty = outputDatetimeDeco.split("+")[1]</span></span>
<span id="cb35-804"><a href="#cb35-804" aria-hidden="true" tabindex="-1"></a><span class="in">dtDotyDateRaw = dtDoty.split(".")[0]</span></span>
<span id="cb35-805"><a href="#cb35-805" aria-hidden="true" tabindex="-1"></a><span class="in">dtDotyTimeRaw = dtDoty.split(".")[1].slice(0, 5)</span></span>
<span id="cb35-806"><a href="#cb35-806" aria-hidden="true" tabindex="-1"></a><span class="in">outputDatetimeYear = unix2year(utcDatetime).toString().slice(0, 8)</span></span>
<span id="cb35-807"><a href="#cb35-807" aria-hidden="true" tabindex="-1"></a><span class="in">dtDotyTimeDelimiter = dtDotyTimeRaw ? "." : ""</span></span>
<span id="cb35-808"><a href="#cb35-808" aria-hidden="true" tabindex="-1"></a><span class="in">outputDecoYear = doty2year(...yd).toString().slice(0, 8)</span></span>
<span id="cb35-809"><a href="#cb35-809" aria-hidden="true" tabindex="-1"></a><span class="in">outputIsoc = doty2isoc(...yd)</span></span>
<span id="cb35-810"><a href="#cb35-810" aria-hidden="true" tabindex="-1"></a><span class="in">yearDate = Math.ceil(unix2year(unix) * 1e3) / 1e3</span></span>
<span id="cb35-811"><a href="#cb35-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-812"><a href="#cb35-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-815"><a href="#cb35-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-816"><a href="#cb35-816" aria-hidden="true" tabindex="-1"></a><span class="in">dtYear = setStyle(outputDatetimeDeco.split("+")[0], d3.schemePaired[10])</span></span>
<span id="cb35-817"><a href="#cb35-817" aria-hidden="true" tabindex="-1"></a><span class="in">dtDotyDate = setStyle(dtDotyDateRaw, d3.schemePaired[1])</span></span>
<span id="cb35-818"><a href="#cb35-818" aria-hidden="true" tabindex="-1"></a><span class="in">dtDotyTime = dtDotyTimeRaw ? setStyle(dtDotyTimeRaw, d3.schemePaired[2]) : ""</span></span>
<span id="cb35-819"><a href="#cb35-819" aria-hidden="true" tabindex="-1"></a><span class="in">styledIsocYear = setStyle(outputIsoc.split(/(?=-)/)[0], d3.schemePaired[10])</span></span>
<span id="cb35-820"><a href="#cb35-820" aria-hidden="true" tabindex="-1"></a><span class="in">styledIsocMd = setStyle(outputIsoc.slice(outputIsoc.split(/(?=-)/)[0].length+1,outputIsoc.split(/(?=-)/)[0].length+6), d3.schemePaired[5])</span></span>
<span id="cb35-821"><a href="#cb35-821" aria-hidden="true" tabindex="-1"></a><span class="in">styledIsocTime = setStyle(outputIsoc.slice(outputIsoc.split(/(?=-)/)[0].length+7), d3.schemePaired[4])</span></span>
<span id="cb35-822"><a href="#cb35-822" aria-hidden="true" tabindex="-1"></a><span class="in">styledOutputDatetimeYear = setStyle(outputDatetimeYear, d3.schemePaired[10])</span></span>
<span id="cb35-823"><a href="#cb35-823" aria-hidden="true" tabindex="-1"></a><span class="in">styledOutputDecoYear = setStyle(outputDecoYear, d3.schemePaired[10])</span></span>
<span id="cb35-824"><a href="#cb35-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-825"><a href="#cb35-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-826"><a href="#cb35-826" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dek {#sec-intro-dek}</span></span>
<span id="cb35-827"><a href="#cb35-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-828"><a href="#cb35-828" aria-hidden="true" tabindex="-1"></a>As mentioned in @sec-intro-doty, <span class="in">`deks`</span> function as both months and weeks in <span class="in">`Decalendar`</span>. A <span class="in">`dek`</span> consists of 2 groups of 5 days called <span class="in">`pents`</span><span class="ot">[^13]</span>. Each <span class="in">`pent`</span> can follow a sequence of workdays and restdays called a <span class="in">`pently`</span> schedule<span class="ot">[^14]</span>. fig-schedules compares the typical weekly schedule and the <span class="in">`Schedule`</span> <span class="in">`3`</span> <span class="in">`pently`</span> schedule. Like other <span class="in">`pently`</span> schedules, <span class="in">`Schedule`</span> <span class="in">`3`</span> is named after the number of workdays it contains. The 3 workdays in <span class="in">`Schedule`</span> <span class="in">`3`</span> are followed by a 2-day <span class="in">`pentend`</span>, the <span class="in">`Decalender`</span> equivalent of a weekend.</span>
<span id="cb35-829"><a href="#cb35-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-830"><a href="#cb35-830" aria-hidden="true" tabindex="-1"></a><span class="ot">[^13]: </span><span class="in">`pent`</span>: a group of 5 days; half of a <span class="in">`dek`</span></span>
<span id="cb35-831"><a href="#cb35-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-832"><a href="#cb35-832" aria-hidden="true" tabindex="-1"></a><span class="ot">[^14]: </span><span class="in">`pently`</span> schedule: one of a set of workday and restday schedules for the 5 days of the <span class="in">`pent`</span></span>
<span id="cb35-833"><a href="#cb35-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-834"><a href="#cb35-834" aria-hidden="true" tabindex="-1"></a>Unlike <span class="in">`Schedule`</span> <span class="in">`3`</span> and the other <span class="in">`pently`</span> schedules, the weekly schedule is asymmetric and divides up workdays into proportions that are easier to express as fractions: 3/8 (.375), 1/3 (.3ÃÖ), and 7/24 (0.2916ÃÖ). In contrast, <span class="in">`pently`</span> schedules divides each workday into simple, symmetrical proportions that are never <span class="co">[</span><span class="ot">repeating decimal</span><span class="co">](https://en.wikipedia.org/wiki/Repeating_decimal)</span> numbers. The <span class="in">`Schedule`</span> <span class="in">`3`</span> workday is longer the typical 9-to-5, but the longer workday is compensated by more frequent restdays.</span>
<span id="cb35-835"><a href="#cb35-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-836"><a href="#cb35-836" aria-hidden="true" tabindex="-1"></a>@exm-intro-pent provides the opportunity to explore all four of the <span class="in">`pently`</span> schedules. <span class="in">`Schedule`</span> <span class="in">`3`</span> is the default <span class="in">`pently`</span> schedule, and should be followed unless there is a compelling reason to do otherwise. Despite having different numbers of workdays, all <span class="in">`pently`</span> schedules keep the amount of spent at work constant at 1.2 days (120 <span class="in">`cents`</span>) per <span class="in">`pent`</span>. Every <span class="in">`pently`</span> schedule also splits up workdays symmetrically so that the time before work is equal to the time after work. You can select which schedule to view in @exm-intro-pent using the <span class="co">[</span><span class="ot">Observable</span><span class="co">](https://observablehq.com/about)</span> <span class="co">[</span><span class="ot">radio inputs</span><span class="co">](https://observablehq.com/@observablehq/input-radio)</span>.</span>
<span id="cb35-837"><a href="#cb35-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-838"><a href="#cb35-838" aria-hidden="true" tabindex="-1"></a>You can also use the <span class="co">[</span><span class="ot">interval sliders</span><span class="co">](https://observablehq.com/@mootari/range-slider)</span> to create a custom schedule and the Download‚¨áÔ∏èbutton to obtain the schedule data. Each interval is summarized by a <span class="in">`Declock`</span> <span class="in">`slice`</span> shown next to its slider. <span class="in">`Decalendar`</span> and <span class="in">`Declock`</span> <span class="in">`slices`</span> are inspired by <span class="co">[</span><span class="ot">array slicing</span><span class="co">](https://en.wikipedia.org/wiki/Array_slicing#:~:text=In%20computer%20programming%2C%20array%20slicing%20is%20an%20operation%20that%20extracts%20a%20subset%20of%20elements%20from%20an%20array%20and%20packages%20them%20as%20another%20array)</span> in computer programming and are used to represent date and time intervals. The <span class="in">`slice`</span> that summarizes the <span class="in">`Schedule`</span> <span class="in">`3`</span> workday is <span class="in">`.3:.7`</span>, where .3 (7.2 hours) is the <span class="in">`start`</span> and .7 (16.8 hours) is the <span class="in">`stop`</span>.</span>
<span id="cb35-839"><a href="#cb35-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-840"><a href="#cb35-840" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-pent}</span>
<span id="cb35-841"><a href="#cb35-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-842"><a href="#cb35-842" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-843"><a href="#cb35-843" aria-hidden="true" tabindex="-1"></a>::: g-col-7</span>
<span id="cb35-846"><a href="#cb35-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-847"><a href="#cb35-847" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-848"><a href="#cb35-848" aria-hidden="true" tabindex="-1"></a><span class="in">viewof intervals = Inputs.form([</span></span>
<span id="cb35-849"><a href="#cb35-849" aria-hidden="true" tabindex="-1"></a><span class="in">  interval([0, 1], {step: .01, value: [.3, .7], label: '0 or 5', width: 250, format: ([start, end]) =&gt; start === end ? "" : `${formatDecimal(start)}:${formatDecimal(end)}`}),</span></span>
<span id="cb35-850"><a href="#cb35-850" aria-hidden="true" tabindex="-1"></a><span class="in">  interval([0, 1], {step: .01, value: [.3, .7], label: '1 or 6', width: 250, format: ([start, end]) =&gt; start === end ? "" : `${formatDecimal(start)}:${formatDecimal(end)}`}),</span></span>
<span id="cb35-851"><a href="#cb35-851" aria-hidden="true" tabindex="-1"></a><span class="in">  interval([0, 1], {step: .01, value: [.3, .7], label: '2 or 7', width: 250, format: ([start, end]) =&gt; start === end ? "" : `${formatDecimal(start)}:${formatDecimal(end)}`}),</span></span>
<span id="cb35-852"><a href="#cb35-852" aria-hidden="true" tabindex="-1"></a><span class="in">  interval([0, 1], {step: .01, value: [0, 0], label: '3 or 8', width: 250, format: ([start, end]) =&gt; start === end ? "" : `${formatDecimal(start)}:${formatDecimal(end)}`}),</span></span>
<span id="cb35-853"><a href="#cb35-853" aria-hidden="true" tabindex="-1"></a><span class="in">  interval([0, 1], {step: .01, value: [0, 0], label: '4 or 9', width: 250, format: ([start, end]) =&gt; start === end ? "" : `${formatDecimal(start)}:${formatDecimal(end)}`}),</span></span>
<span id="cb35-854"><a href="#cb35-854" aria-hidden="true" tabindex="-1"></a><span class="in">])</span></span>
<span id="cb35-855"><a href="#cb35-855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-856"><a href="#cb35-856" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-857"><a href="#cb35-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-858"><a href="#cb35-858" aria-hidden="true" tabindex="-1"></a>::: g-col-5</span>
<span id="cb35-861"><a href="#cb35-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-862"><a href="#cb35-862" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-863"><a href="#cb35-863" aria-hidden="true" tabindex="-1"></a><span class="in">viewof schedule = Inputs.radio([2, 3, 4, 5], {label: "sched.", value: 3})</span></span>
<span id="cb35-864"><a href="#cb35-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-865"><a href="#cb35-865" aria-hidden="true" tabindex="-1"></a><span class="in">viewof filename = Inputs.text({label: "name", placeholder: "Enter the filename", value: `schedule${schedule}.csv`})</span></span>
<span id="cb35-866"><a href="#cb35-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-867"><a href="#cb35-867" aria-hidden="true" tabindex="-1"></a><span class="in">button(durations, filename)</span></span>
<span id="cb35-868"><a href="#cb35-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-869"><a href="#cb35-869" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-870"><a href="#cb35-870" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-871"><a href="#cb35-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-874"><a href="#cb35-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-875"><a href="#cb35-875" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-876"><a href="#cb35-876" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: fig-intro-dek</span></span>
<span id="cb35-877"><a href="#cb35-877" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Pently schedule explorer"</span></span>
<span id="cb35-878"><a href="#cb35-878" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap-location: margin</span></span>
<span id="cb35-879"><a href="#cb35-879" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: center</span></span>
<span id="cb35-880"><a href="#cb35-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-881"><a href="#cb35-881" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@dec/pent</span></span>
<span id="cb35-882"><a href="#cb35-882" aria-hidden="true" tabindex="-1"></a><span class="in">Plot.plot({</span></span>
<span id="cb35-883"><a href="#cb35-883" aria-hidden="true" tabindex="-1"></a><span class="in">  className: "schedule-explorer",</span></span>
<span id="cb35-884"><a href="#cb35-884" aria-hidden="true" tabindex="-1"></a><span class="in">  x: {label: null},</span></span>
<span id="cb35-885"><a href="#cb35-885" aria-hidden="true" tabindex="-1"></a><span class="in">  color: {scheme: "Set1", legend: "swatches", reverse: true},</span></span>
<span id="cb35-886"><a href="#cb35-886" aria-hidden="true" tabindex="-1"></a><span class="in">  y: {label: null, domain: [1, 0]},</span></span>
<span id="cb35-887"><a href="#cb35-887" aria-hidden="true" tabindex="-1"></a><span class="in">  marks: [</span></span>
<span id="cb35-888"><a href="#cb35-888" aria-hidden="true" tabindex="-1"></a><span class="in">  Plot.barY(durations, {x: "label", y: "duration", fill: "group"}),</span></span>
<span id="cb35-889"><a href="#cb35-889" aria-hidden="true" tabindex="-1"></a><span class="in">  Plot.textY(</span></span>
<span id="cb35-890"><a href="#cb35-890" aria-hidden="true" tabindex="-1"></a><span class="in">      durations,</span></span>
<span id="cb35-891"><a href="#cb35-891" aria-hidden="true" tabindex="-1"></a><span class="in">      Plot.stackY(</span></span>
<span id="cb35-892"><a href="#cb35-892" aria-hidden="true" tabindex="-1"></a><span class="in">        Plot.groupX(</span></span>
<span id="cb35-893"><a href="#cb35-893" aria-hidden="true" tabindex="-1"></a><span class="in">          { y: "first", text: "first" },</span></span>
<span id="cb35-894"><a href="#cb35-894" aria-hidden="true" tabindex="-1"></a><span class="in">          {</span></span>
<span id="cb35-895"><a href="#cb35-895" aria-hidden="true" tabindex="-1"></a><span class="in">            x: "label",</span></span>
<span id="cb35-896"><a href="#cb35-896" aria-hidden="true" tabindex="-1"></a><span class="in">            z: "group",</span></span>
<span id="cb35-897"><a href="#cb35-897" aria-hidden="true" tabindex="-1"></a><span class="in">            y: "duration",</span></span>
<span id="cb35-898"><a href="#cb35-898" aria-hidden="true" tabindex="-1"></a><span class="in">            text: (d) =&gt; (d.duration &lt; .0001 ? null : formatDecimal(d.duration)),</span></span>
<span id="cb35-899"><a href="#cb35-899" aria-hidden="true" tabindex="-1"></a><span class="in">            fill: "white",</span></span>
<span id="cb35-900"><a href="#cb35-900" aria-hidden="true" tabindex="-1"></a><span class="in">            stroke: "black",</span></span>
<span id="cb35-901"><a href="#cb35-901" aria-hidden="true" tabindex="-1"></a><span class="in">            fontSize: 36,</span></span>
<span id="cb35-902"><a href="#cb35-902" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb35-903"><a href="#cb35-903" aria-hidden="true" tabindex="-1"></a><span class="in">        )</span></span>
<span id="cb35-904"><a href="#cb35-904" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb35-905"><a href="#cb35-905" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb35-906"><a href="#cb35-906" aria-hidden="true" tabindex="-1"></a><span class="in">  ]})</span></span>
<span id="cb35-907"><a href="#cb35-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-908"><a href="#cb35-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-909"><a href="#cb35-909" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-910"><a href="#cb35-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-911"><a href="#cb35-911" aria-hidden="true" tabindex="-1"></a><span class="in">`Slices`</span> can be used to select <span class="in">`Declock`</span> time intervals, as in @exm-intro-pent above, or <span class="in">`Decalendar`</span> date intervals, as in @exm-intro-dotd below. <span class="in">`Decalendar`</span> date intervals can represent events take place over multiple days. In addition to <span class="in">`slices`</span>, <span class="in">`Decalendar`</span> and <span class="in">`Declock`</span> intervals can also be chosen using <span class="in">`spreads`</span>. Use the <span class="co">[</span><span class="ot">Observable</span><span class="co">](https://observablehq.com/about)</span> <span class="co">[</span><span class="ot">button</span><span class="co">](https://observablehq.com/@observablehq/input-button)</span> and <span class="co">[</span><span class="ot">checkbox</span><span class="co">](https://observablehq.com/@observablehq/input-checkbox)</span> inputs in @exm-intro-dotd to display different <span class="in">`dotd`</span> combinations in @fig-intro-dotd. @fig-intro-dotd shows dates selected by a <span class="in">`slice`</span> in <span class="co">[</span><span class="ot">blue</span><span class="co">]</span>{.blue}, dates selected by a <span class="in">`spread`</span> in <span class="co">[</span><span class="ot">orange</span><span class="co">]</span>{.orange}, dates selected by both in <span class="co">[</span><span class="ot">green</span><span class="co">]</span>{.green}, and dates selected by neither in <span class="co">[</span><span class="ot">gray</span><span class="co">]</span>{.gray}.</span>
<span id="cb35-912"><a href="#cb35-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-913"><a href="#cb35-913" aria-hidden="true" tabindex="-1"></a>The @exm-intro-dotd button and checkbox inputs will modify the associated <span class="in">`slice`</span> and <span class="in">`spread`</span> text and numeric inputs as needed to select the desired days-of-the-<span class="in">`dek`</span>. The numeric inputs for <span class="in">`slices`</span> are the <span class="in">`start`</span>üé¨index, the <span class="in">`stop`</span>üõëindex, and the <span class="in">`step`</span>üë£size, which are separated by colons (<span class="in">`start:stop:step`</span>) when combined into a <span class="in">`slice`</span>. Similarly, the numeric inputs for <span class="in">`spreads`</span> are the <span class="in">`start`</span>üé¨orüõë<span class="in">`stop`</span> index, the <span class="in">`span`</span>ü™Ωsize, the <span class="in">`split`</span> size, and the <span class="in">`space`</span> size, which are typically delimited by greater-than signs (<span class="in">`start&gt;span&gt;split&gt;space`</span>) or a mix of greater-than and less-than signs (<span class="in">`stop&lt;span&gt;split&gt;space`</span>).</span>
<span id="cb35-914"><a href="#cb35-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-915"><a href="#cb35-915" aria-hidden="true" tabindex="-1"></a>The numeric inputs in @exm-intro-dotd cannot capture the full power of <span class="in">`spreads`</span> and <span class="in">`slices`</span>, because <span class="in">`slices`</span> can have any number of <span class="in">`steps`</span> and, likewise, <span class="in">`spreads`</span> can have any number of alternating <span class="in">`split`</span> and <span class="in">`space`</span> sizes. We can select all even or odd days-of-the-<span class="in">`dek`</span> using a <span class="in">`slice`</span> with a single <span class="in">`step`</span> (<span class="in">`::2`</span> or <span class="in">`1::2`</span>) or a <span class="in">`spread`</span> with one <span class="in">`split`</span>-<span class="in">`space`</span> pair (<span class="in">`&gt;&gt;&gt;1`</span> or <span class="in">`1&gt;&gt;&gt;1`</span>). More complex patterns, such as prime or composite days-of-the-<span class="in">`dek`</span>, require multiple <span class="in">`step`</span> sizes for <span class="in">`slices`</span> (<span class="in">`2:::2:2:5`</span> or <span class="in">`4::2:2::5`</span>) or multiple <span class="in">`split`</span>-<span class="in">`space`</span> pairs (<span class="in">`2&gt;&gt;2&gt;1&gt;&gt;1&gt;&gt;4`</span> or <span class="in">`4&gt;&gt;&gt;1&gt;&gt;1&gt;2&gt;4`</span>).</span>
<span id="cb35-916"><a href="#cb35-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-917"><a href="#cb35-917" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-dotd}</span>
<span id="cb35-918"><a href="#cb35-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-921"><a href="#cb35-921" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-922"><a href="#cb35-922" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-923"><a href="#cb35-923" aria-hidden="true" tabindex="-1"></a><span class="in">viewof sliceDotd = Inputs.checkbox([...Array(10).keys()], {label: "slice", value: [1, 6]})</span></span>
<span id="cb35-924"><a href="#cb35-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-925"><a href="#cb35-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-928"><a href="#cb35-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-929"><a href="#cb35-929" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-930"><a href="#cb35-930" aria-hidden="true" tabindex="-1"></a><span class="in">viewof spreadDotd = Inputs.checkbox([...Array(10).keys()], {label: "spread", value: [1, 6]})</span></span>
<span id="cb35-931"><a href="#cb35-931" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-932"><a href="#cb35-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-935"><a href="#cb35-935" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-936"><a href="#cb35-936" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-937"><a href="#cb35-937" aria-hidden="true" tabindex="-1"></a><span class="in">viewof togglePlot = Inputs.button([</span></span>
<span id="cb35-938"><a href="#cb35-938" aria-hidden="true" tabindex="-1"></a><span class="in">  [invertDotd ? "None" : "All", value =&gt; [...Array(10).keys()]],</span></span>
<span id="cb35-939"><a href="#cb35-939" aria-hidden="true" tabindex="-1"></a><span class="in">  [invertDotd ? "Even" : "Odd", value =&gt; [1, 3, 5, 7, 9]],</span></span>
<span id="cb35-940"><a href="#cb35-940" aria-hidden="true" tabindex="-1"></a><span class="in">  [invertDotd ? html`&lt;s&gt;Prime&lt;/s&gt;` : "Prime", value =&gt; [2, 3, 5, 7]],</span></span>
<span id="cb35-941"><a href="#cb35-941" aria-hidden="true" tabindex="-1"></a><span class="in">  [invertDotd ? html`&lt;s&gt;Composite&lt;/s&gt;` : "Composite", value =&gt; [4, 6, 8, 9]],</span></span>
<span id="cb35-942"><a href="#cb35-942" aria-hidden="true" tabindex="-1"></a><span class="in">  [invertDotd ? html`&lt;s&gt;Schedule2&lt;/s&gt;` : "Schedule2", value =&gt; [0, 1, 5, 6]],</span></span>
<span id="cb35-943"><a href="#cb35-943" aria-hidden="true" tabindex="-1"></a><span class="in">  [invertDotd ? html`&lt;s&gt;Schedule3&lt;/s&gt;` : "Schedule3", value =&gt; [0, 1, 2, 5, 6, 7]],</span></span>
<span id="cb35-944"><a href="#cb35-944" aria-hidden="true" tabindex="-1"></a><span class="in">  [invertDotd ? html`&lt;s&gt;Schedule4&lt;/s&gt;` : "Schedule4", value =&gt; [0, 1, 2, 3, 5, 6, 7, 8]],</span></span>
<span id="cb35-945"><a href="#cb35-945" aria-hidden="true" tabindex="-1"></a><span class="in">], {value: [], label: "select"})</span></span>
<span id="cb35-946"><a href="#cb35-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-947"><a href="#cb35-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-948"><a href="#cb35-948" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-949"><a href="#cb35-949" aria-hidden="true" tabindex="-1"></a>::: g-col-6</span>
<span id="cb35-952"><a href="#cb35-952" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-953"><a href="#cb35-953" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-954"><a href="#cb35-954" aria-hidden="true" tabindex="-1"></a><span class="in">//| classes: btn-row</span></span>
<span id="cb35-955"><a href="#cb35-955" aria-hidden="true" tabindex="-1"></a><span class="in">viewof invertDotd = Inputs.toggle({label: "invert"})</span></span>
<span id="cb35-956"><a href="#cb35-956" aria-hidden="true" tabindex="-1"></a><span class="in">viewof sliceOrSpread = toggleSwitch({textOn: invertDotd ? "Spread" : 'Slice' , textOff: invertDotd ? "Slice" : 'Spread'})</span></span>
<span id="cb35-957"><a href="#cb35-957" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-958"><a href="#cb35-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-961"><a href="#cb35-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-962"><a href="#cb35-962" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-963"><a href="#cb35-963" aria-hidden="true" tabindex="-1"></a><span class="in">viewof sliceInputs = Inputs.form([</span></span>
<span id="cb35-964"><a href="#cb35-964" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.number([-366, 366], {step: 1, label: "start", value: 1, placeholder: "Enter start index"}),</span></span>
<span id="cb35-965"><a href="#cb35-965" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.number([-366, 366], {step: 1, label: "stop", value: 366, placeholder: "Enter stop index"}),</span></span>
<span id="cb35-966"><a href="#cb35-966" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.number([-366, 366], {step: 1, label: "step", value: 5, placeholder: "Enter step size"}),</span></span>
<span id="cb35-967"><a href="#cb35-967" aria-hidden="true" tabindex="-1"></a><span class="in">])</span></span>
<span id="cb35-968"><a href="#cb35-968" aria-hidden="true" tabindex="-1"></a><span class="in">viewof sliceString = transformInput(</span></span>
<span id="cb35-969"><a href="#cb35-969" aria-hidden="true" tabindex="-1"></a><span class="in">  Inputs.text({label: "slice", placeholder: "Enter slice string", value: "0:366"}),</span></span>
<span id="cb35-970"><a href="#cb35-970" aria-hidden="true" tabindex="-1"></a><span class="in">{bind: viewof sliceInputs, transform: encodeSlice, invert: decodeSlice});</span></span>
<span id="cb35-971"><a href="#cb35-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-972"><a href="#cb35-972" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-973"><a href="#cb35-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-974"><a href="#cb35-974" aria-hidden="true" tabindex="-1"></a>::: g-col-6</span>
<span id="cb35-977"><a href="#cb35-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-978"><a href="#cb35-978" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-979"><a href="#cb35-979" aria-hidden="true" tabindex="-1"></a><span class="in">viewof spreadInputs = Inputs.form([</span></span>
<span id="cb35-980"><a href="#cb35-980" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.number([-366, 366], {step: 1, label: "start", value: 0, placeholder: "Enter start index"}),</span></span>
<span id="cb35-981"><a href="#cb35-981" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.number([-366, 366], {step: 1, label: "span", value: 366, placeholder: "Enter span size"}),</span></span>
<span id="cb35-982"><a href="#cb35-982" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.number([-366, 366], {step: 1, label: "split", value: 3, placeholder: "Enter split size"}),</span></span>
<span id="cb35-983"><a href="#cb35-983" aria-hidden="true" tabindex="-1"></a><span class="in">    Inputs.number([-366, 366], {step: 1, label: "space", value: 2, placeholder: "Enter space size"}),</span></span>
<span id="cb35-984"><a href="#cb35-984" aria-hidden="true" tabindex="-1"></a><span class="in">])</span></span>
<span id="cb35-985"><a href="#cb35-985" aria-hidden="true" tabindex="-1"></a><span class="in">viewof spreadString = transformInput(</span></span>
<span id="cb35-986"><a href="#cb35-986" aria-hidden="true" tabindex="-1"></a><span class="in">  Inputs.text({label: "spread", placeholder: "Enter spread string", value: "0&gt;366&gt;3&gt;2"}),</span></span>
<span id="cb35-987"><a href="#cb35-987" aria-hidden="true" tabindex="-1"></a><span class="in">{bind: viewof spreadInputs, transform: encodeSpread, invert: decodeSpread});</span></span>
<span id="cb35-988"><a href="#cb35-988" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-989"><a href="#cb35-989" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-990"><a href="#cb35-990" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-991"><a href="#cb35-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-994"><a href="#cb35-994" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-995"><a href="#cb35-995" aria-hidden="true" tabindex="-1"></a><span class="in">//| echo: false</span></span>
<span id="cb35-996"><a href="#cb35-996" aria-hidden="true" tabindex="-1"></a><span class="in">//| label: fig-intro-dotd</span></span>
<span id="cb35-997"><a href="#cb35-997" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap: "Decalendar date selector"</span></span>
<span id="cb35-998"><a href="#cb35-998" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-cap-location: margin</span></span>
<span id="cb35-999"><a href="#cb35-999" aria-hidden="true" tabindex="-1"></a><span class="in">//| fig-align: center</span></span>
<span id="cb35-1000"><a href="#cb35-1000" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@dec/dotd</span></span>
<span id="cb35-1001"><a href="#cb35-1001" aria-hidden="true" tabindex="-1"></a><span class="in">Plot.plot({</span></span>
<span id="cb35-1002"><a href="#cb35-1002" aria-hidden="true" tabindex="-1"></a><span class="in">  className: "date-selector",</span></span>
<span id="cb35-1003"><a href="#cb35-1003" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0,</span></span>
<span id="cb35-1004"><a href="#cb35-1004" aria-hidden="true" tabindex="-1"></a><span class="in">  x: {axis: "top", label: null, type: "band"},</span></span>
<span id="cb35-1005"><a href="#cb35-1005" aria-hidden="true" tabindex="-1"></a><span class="in">  y: {label: null, type: "band"},</span></span>
<span id="cb35-1006"><a href="#cb35-1006" aria-hidden="true" tabindex="-1"></a><span class="in">  marks: [</span></span>
<span id="cb35-1007"><a href="#cb35-1007" aria-hidden="true" tabindex="-1"></a><span class="in">    Plot.cell(dates, {x: d =&gt; d[2], y: d =&gt; d.slice(0, 2), fill: d =&gt;</span></span>
<span id="cb35-1008"><a href="#cb35-1008" aria-hidden="true" tabindex="-1"></a><span class="in">      sliceArray.includes(d) &amp;&amp; spreadArray.includes(d) ? "green" :</span></span>
<span id="cb35-1009"><a href="#cb35-1009" aria-hidden="true" tabindex="-1"></a><span class="in">      sliceArray.includes(d) &amp;&amp; !spreadArray.includes(d) ? "blue" :</span></span>
<span id="cb35-1010"><a href="#cb35-1010" aria-hidden="true" tabindex="-1"></a><span class="in">      !sliceArray.includes(d) &amp;&amp; spreadArray.includes(d) ? "orange" : "grey",</span></span>
<span id="cb35-1011"><a href="#cb35-1011" aria-hidden="true" tabindex="-1"></a><span class="in">      inset: 0.5}),</span></span>
<span id="cb35-1012"><a href="#cb35-1012" aria-hidden="true" tabindex="-1"></a><span class="in">    Plot.text(dates, {</span></span>
<span id="cb35-1013"><a href="#cb35-1013" aria-hidden="true" tabindex="-1"></a><span class="in">    x: d =&gt; d[2],</span></span>
<span id="cb35-1014"><a href="#cb35-1014" aria-hidden="true" tabindex="-1"></a><span class="in">    y: d =&gt; d.slice(0, 2),</span></span>
<span id="cb35-1015"><a href="#cb35-1015" aria-hidden="true" tabindex="-1"></a><span class="in">    fill: "white",</span></span>
<span id="cb35-1016"><a href="#cb35-1016" aria-hidden="true" tabindex="-1"></a><span class="in">    stroke: "black",</span></span>
<span id="cb35-1017"><a href="#cb35-1017" aria-hidden="true" tabindex="-1"></a><span class="in">    fontSize: 20})</span></span>
<span id="cb35-1018"><a href="#cb35-1018" aria-hidden="true" tabindex="-1"></a><span class="in">  ]</span></span>
<span id="cb35-1019"><a href="#cb35-1019" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb35-1020"><a href="#cb35-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1021"><a href="#cb35-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1022"><a href="#cb35-1022" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-1023"><a href="#cb35-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1024"><a href="#cb35-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `Dek` Observable code {#sec-ojs-code-dek .appendix}</span></span>
<span id="cb35-1025"><a href="#cb35-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1026"><a href="#cb35-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Functions {.appendix}</span></span>
<span id="cb35-1027"><a href="#cb35-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1030"><a href="#cb35-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1031"><a href="#cb35-1031" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@mootari/range-slider</span></span>
<span id="cb35-1032"><a href="#cb35-1032" aria-hidden="true" tabindex="-1"></a><span class="in">function interval(range = [], options = {}) {</span></span>
<span id="cb35-1033"><a href="#cb35-1033" aria-hidden="true" tabindex="-1"></a><span class="in">  const [min = 0, max = 1] = range;</span></span>
<span id="cb35-1034"><a href="#cb35-1034" aria-hidden="true" tabindex="-1"></a><span class="in">  const {</span></span>
<span id="cb35-1035"><a href="#cb35-1035" aria-hidden="true" tabindex="-1"></a><span class="in">    step = .001,</span></span>
<span id="cb35-1036"><a href="#cb35-1036" aria-hidden="true" tabindex="-1"></a><span class="in">    label = null,</span></span>
<span id="cb35-1037"><a href="#cb35-1037" aria-hidden="true" tabindex="-1"></a><span class="in">    value = [min, max],</span></span>
<span id="cb35-1038"><a href="#cb35-1038" aria-hidden="true" tabindex="-1"></a><span class="in">    format = ([start, end]) =&gt; `${start} ‚Ä¶ ${end}`,</span></span>
<span id="cb35-1039"><a href="#cb35-1039" aria-hidden="true" tabindex="-1"></a><span class="in">    color,</span></span>
<span id="cb35-1040"><a href="#cb35-1040" aria-hidden="true" tabindex="-1"></a><span class="in">    width,</span></span>
<span id="cb35-1041"><a href="#cb35-1041" aria-hidden="true" tabindex="-1"></a><span class="in">    theme,</span></span>
<span id="cb35-1042"><a href="#cb35-1042" aria-hidden="true" tabindex="-1"></a><span class="in">  } = options;</span></span>
<span id="cb35-1043"><a href="#cb35-1043" aria-hidden="true" tabindex="-1"></a><span class="in">  const __ns__ = DOM.uid('scope').id;</span></span>
<span id="cb35-1044"><a href="#cb35-1044" aria-hidden="true" tabindex="-1"></a><span class="in">  const css = `</span></span>
<span id="cb35-1045"><a href="#cb35-1045" aria-hidden="true" tabindex="-1"></a><span class="in">#${__ns__} {</span></span>
<span id="cb35-1046"><a href="#cb35-1046" aria-hidden="true" tabindex="-1"></a><span class="in">  font: 13px/1.2 var(--sans-serif);</span></span>
<span id="cb35-1047"><a href="#cb35-1047" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb35-1048"><a href="#cb35-1048" aria-hidden="true" tabindex="-1"></a><span class="in">  align-items: baseline;</span></span>
<span id="cb35-1049"><a href="#cb35-1049" aria-hidden="true" tabindex="-1"></a><span class="in">  flex-wrap: wrap;</span></span>
<span id="cb35-1050"><a href="#cb35-1050" aria-hidden="true" tabindex="-1"></a><span class="in">  max-width: 100%;</span></span>
<span id="cb35-1051"><a href="#cb35-1051" aria-hidden="true" tabindex="-1"></a><span class="in">  width: auto;</span></span>
<span id="cb35-1052"><a href="#cb35-1052" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1053"><a href="#cb35-1053" aria-hidden="true" tabindex="-1"></a><span class="in">@media only screen and (min-width: 30em) {</span></span>
<span id="cb35-1054"><a href="#cb35-1054" aria-hidden="true" tabindex="-1"></a><span class="in">  #${__ns__} {</span></span>
<span id="cb35-1055"><a href="#cb35-1055" aria-hidden="true" tabindex="-1"></a><span class="in">    flex-wrap: nowrap;</span></span>
<span id="cb35-1056"><a href="#cb35-1056" aria-hidden="true" tabindex="-1"></a><span class="in">    width: 360px;</span></span>
<span id="cb35-1057"><a href="#cb35-1057" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1058"><a href="#cb35-1058" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1059"><a href="#cb35-1059" aria-hidden="true" tabindex="-1"></a><span class="in">#${__ns__} .label {</span></span>
<span id="cb35-1060"><a href="#cb35-1060" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 50px;</span></span>
<span id="cb35-1061"><a href="#cb35-1061" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 5px 0 4px 0;</span></span>
<span id="cb35-1062"><a href="#cb35-1062" aria-hidden="true" tabindex="-1"></a><span class="in">  margin-right: .5px;</span></span>
<span id="cb35-1063"><a href="#cb35-1063" aria-hidden="true" tabindex="-1"></a><span class="in">  flex-shrink: 0;</span></span>
<span id="cb35-1064"><a href="#cb35-1064" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1065"><a href="#cb35-1065" aria-hidden="true" tabindex="-1"></a><span class="in">#${__ns__} .form {</span></span>
<span id="cb35-1066"><a href="#cb35-1066" aria-hidden="true" tabindex="-1"></a><span class="in">  display: flex;</span></span>
<span id="cb35-1067"><a href="#cb35-1067" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb35-1068"><a href="#cb35-1068" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1069"><a href="#cb35-1069" aria-hidden="true" tabindex="-1"></a><span class="in">#${__ns__} .range {</span></span>
<span id="cb35-1070"><a href="#cb35-1070" aria-hidden="true" tabindex="-1"></a><span class="in">  flex-shrink: 1;</span></span>
<span id="cb35-1071"><a href="#cb35-1071" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb35-1072"><a href="#cb35-1072" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1073"><a href="#cb35-1073" aria-hidden="true" tabindex="-1"></a><span class="in">#${__ns__} .range-slider {</span></span>
<span id="cb35-1074"><a href="#cb35-1074" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb35-1075"><a href="#cb35-1075" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1076"><a href="#cb35-1076" aria-hidden="true" tabindex="-1"></a><span class="in">  `;</span></span>
<span id="cb35-1077"><a href="#cb35-1077" aria-hidden="true" tabindex="-1"></a><span class="in">  const $range = rangeInput({min, max, value: [value[0], value[1]], step, color, width, theme});</span></span>
<span id="cb35-1078"><a href="#cb35-1078" aria-hidden="true" tabindex="-1"></a><span class="in">  const $output = html`&lt;output&gt;`;</span></span>
<span id="cb35-1079"><a href="#cb35-1079" aria-hidden="true" tabindex="-1"></a><span class="in">  const $view = html`&lt;div id=${__ns__}&gt;</span></span>
<span id="cb35-1080"><a href="#cb35-1080" aria-hidden="true" tabindex="-1"></a><span class="in">${label == null ? '' : html`&lt;div class="label"&gt;${label}`}</span></span>
<span id="cb35-1081"><a href="#cb35-1081" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div class=form&gt;</span></span>
<span id="cb35-1082"><a href="#cb35-1082" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;div class=range&gt;</span></span>
<span id="cb35-1083"><a href="#cb35-1083" aria-hidden="true" tabindex="-1"></a><span class="in">    ${$range}&lt;div class=range-output style="display: inline-block;"&gt;${$output}&lt;/div&gt;</span></span>
<span id="cb35-1084"><a href="#cb35-1084" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb35-1085"><a href="#cb35-1085" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb35-1086"><a href="#cb35-1086" aria-hidden="true" tabindex="-1"></a><span class="in">${html`&lt;style&gt;${css}`}</span></span>
<span id="cb35-1087"><a href="#cb35-1087" aria-hidden="true" tabindex="-1"></a><span class="in">  `;</span></span>
<span id="cb35-1088"><a href="#cb35-1088" aria-hidden="true" tabindex="-1"></a><span class="in">  const update = () =&gt; {</span></span>
<span id="cb35-1089"><a href="#cb35-1089" aria-hidden="true" tabindex="-1"></a><span class="in">    const content = format([$range.value[0], $range.value[1]]);</span></span>
<span id="cb35-1090"><a href="#cb35-1090" aria-hidden="true" tabindex="-1"></a><span class="in">    if(typeof content === 'string') $output.value = content;</span></span>
<span id="cb35-1091"><a href="#cb35-1091" aria-hidden="true" tabindex="-1"></a><span class="in">    else {</span></span>
<span id="cb35-1092"><a href="#cb35-1092" aria-hidden="true" tabindex="-1"></a><span class="in">      while($output.lastChild) $output.lastChild.remove();</span></span>
<span id="cb35-1093"><a href="#cb35-1093" aria-hidden="true" tabindex="-1"></a><span class="in">      $output.appendChild(content);</span></span>
<span id="cb35-1094"><a href="#cb35-1094" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb35-1095"><a href="#cb35-1095" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1096"><a href="#cb35-1096" aria-hidden="true" tabindex="-1"></a><span class="in">  $range.oninput = update;</span></span>
<span id="cb35-1097"><a href="#cb35-1097" aria-hidden="true" tabindex="-1"></a><span class="in">  update();</span></span>
<span id="cb35-1098"><a href="#cb35-1098" aria-hidden="true" tabindex="-1"></a><span class="in">  return Object.defineProperty($view, 'value', {</span></span>
<span id="cb35-1099"><a href="#cb35-1099" aria-hidden="true" tabindex="-1"></a><span class="in">    get: () =&gt; $range.value,</span></span>
<span id="cb35-1100"><a href="#cb35-1100" aria-hidden="true" tabindex="-1"></a><span class="in">    set: ([a, b]) =&gt; {</span></span>
<span id="cb35-1101"><a href="#cb35-1101" aria-hidden="true" tabindex="-1"></a><span class="in">      $range.value = [a, b];</span></span>
<span id="cb35-1102"><a href="#cb35-1102" aria-hidden="true" tabindex="-1"></a><span class="in">      update();</span></span>
<span id="cb35-1103"><a href="#cb35-1103" aria-hidden="true" tabindex="-1"></a><span class="in">    },</span></span>
<span id="cb35-1104"><a href="#cb35-1104" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb35-1105"><a href="#cb35-1105" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1106"><a href="#cb35-1106" aria-hidden="true" tabindex="-1"></a><span class="in">cssLength = v =&gt; v == null ? null : typeof v === 'number' ? `${v}px` : `${v}`</span></span>
<span id="cb35-1107"><a href="#cb35-1107" aria-hidden="true" tabindex="-1"></a><span class="in">function randomScope(prefix = 'scope-') {</span></span>
<span id="cb35-1108"><a href="#cb35-1108" aria-hidden="true" tabindex="-1"></a><span class="in">  return prefix + (performance.now() + Math.random()).toString(32).replace('.', '-');</span></span>
<span id="cb35-1109"><a href="#cb35-1109" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1110"><a href="#cb35-1110" aria-hidden="true" tabindex="-1"></a><span class="in">function rangeInput(options = {}) {</span></span>
<span id="cb35-1111"><a href="#cb35-1111" aria-hidden="true" tabindex="-1"></a><span class="in">  const {</span></span>
<span id="cb35-1112"><a href="#cb35-1112" aria-hidden="true" tabindex="-1"></a><span class="in">    min = 0,</span></span>
<span id="cb35-1113"><a href="#cb35-1113" aria-hidden="true" tabindex="-1"></a><span class="in">    max = 100,</span></span>
<span id="cb35-1114"><a href="#cb35-1114" aria-hidden="true" tabindex="-1"></a><span class="in">    step = 'any',</span></span>
<span id="cb35-1115"><a href="#cb35-1115" aria-hidden="true" tabindex="-1"></a><span class="in">    value: defaultValue = [min, max],</span></span>
<span id="cb35-1116"><a href="#cb35-1116" aria-hidden="true" tabindex="-1"></a><span class="in">    color,</span></span>
<span id="cb35-1117"><a href="#cb35-1117" aria-hidden="true" tabindex="-1"></a><span class="in">    width,</span></span>
<span id="cb35-1118"><a href="#cb35-1118" aria-hidden="true" tabindex="-1"></a><span class="in">    theme = theme_Flat,</span></span>
<span id="cb35-1119"><a href="#cb35-1119" aria-hidden="true" tabindex="-1"></a><span class="in">  } = options;</span></span>
<span id="cb35-1120"><a href="#cb35-1120" aria-hidden="true" tabindex="-1"></a><span class="in">  const controls = {};</span></span>
<span id="cb35-1121"><a href="#cb35-1121" aria-hidden="true" tabindex="-1"></a><span class="in">  const scope = randomScope();</span></span>
<span id="cb35-1122"><a href="#cb35-1122" aria-hidden="true" tabindex="-1"></a><span class="in">  const clamp = (a, b, v) =&gt; v &lt; a ? a : v &gt; b ? b : v;</span></span>
<span id="cb35-1123"><a href="#cb35-1123" aria-hidden="true" tabindex="-1"></a><span class="in">  const html = htl.html;</span></span>
<span id="cb35-1124"><a href="#cb35-1124" aria-hidden="true" tabindex="-1"></a><span class="in">  // Will be used to sanitize values while avoiding floating point issues.</span></span>
<span id="cb35-1125"><a href="#cb35-1125" aria-hidden="true" tabindex="-1"></a><span class="in">  const input = html`&lt;input type=range ${{min, max, step}}&gt;`;</span></span>
<span id="cb35-1126"><a href="#cb35-1126" aria-hidden="true" tabindex="-1"></a><span class="in">  const dom = html`&lt;div class=${`${scope} range-slider`} style=${{</span></span>
<span id="cb35-1127"><a href="#cb35-1127" aria-hidden="true" tabindex="-1"></a><span class="in">    color,</span></span>
<span id="cb35-1128"><a href="#cb35-1128" aria-hidden="true" tabindex="-1"></a><span class="in">    width: cssLength(width),</span></span>
<span id="cb35-1129"><a href="#cb35-1129" aria-hidden="true" tabindex="-1"></a><span class="in">  }}&gt;</span></span>
<span id="cb35-1130"><a href="#cb35-1130" aria-hidden="true" tabindex="-1"></a><span class="in">  ${controls.track = html`&lt;div class="range-track"&gt;</span></span>
<span id="cb35-1131"><a href="#cb35-1131" aria-hidden="true" tabindex="-1"></a><span class="in">    ${controls.zone = html`&lt;div class="range-track-zone"&gt;</span></span>
<span id="cb35-1132"><a href="#cb35-1132" aria-hidden="true" tabindex="-1"></a><span class="in">      ${controls.range = html`&lt;div class="range-select" tabindex=0&gt;</span></span>
<span id="cb35-1133"><a href="#cb35-1133" aria-hidden="true" tabindex="-1"></a><span class="in">        ${controls.min = html`&lt;div class="thumb thumb-min" tabindex=0&gt;`}</span></span>
<span id="cb35-1134"><a href="#cb35-1134" aria-hidden="true" tabindex="-1"></a><span class="in">        ${controls.max = html`&lt;div class="thumb thumb-max" tabindex=0&gt;`}</span></span>
<span id="cb35-1135"><a href="#cb35-1135" aria-hidden="true" tabindex="-1"></a><span class="in">      `}</span></span>
<span id="cb35-1136"><a href="#cb35-1136" aria-hidden="true" tabindex="-1"></a><span class="in">    `}</span></span>
<span id="cb35-1137"><a href="#cb35-1137" aria-hidden="true" tabindex="-1"></a><span class="in">  `}</span></span>
<span id="cb35-1138"><a href="#cb35-1138" aria-hidden="true" tabindex="-1"></a><span class="in">  ${html`&lt;style&gt;${theme.replace(/:scope\b/g, '.'+scope)}`}</span></span>
<span id="cb35-1139"><a href="#cb35-1139" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/div&gt;`;</span></span>
<span id="cb35-1140"><a href="#cb35-1140" aria-hidden="true" tabindex="-1"></a><span class="in">  let value = [], changed = false;</span></span>
<span id="cb35-1141"><a href="#cb35-1141" aria-hidden="true" tabindex="-1"></a><span class="in">  Object.defineProperty(dom, 'value', {</span></span>
<span id="cb35-1142"><a href="#cb35-1142" aria-hidden="true" tabindex="-1"></a><span class="in">    get: () =&gt; [...value],</span></span>
<span id="cb35-1143"><a href="#cb35-1143" aria-hidden="true" tabindex="-1"></a><span class="in">    set: ([a, b]) =&gt; {</span></span>
<span id="cb35-1144"><a href="#cb35-1144" aria-hidden="true" tabindex="-1"></a><span class="in">      value = sanitize(a, b);</span></span>
<span id="cb35-1145"><a href="#cb35-1145" aria-hidden="true" tabindex="-1"></a><span class="in">      updateRange();</span></span>
<span id="cb35-1146"><a href="#cb35-1146" aria-hidden="true" tabindex="-1"></a><span class="in">    },</span></span>
<span id="cb35-1147"><a href="#cb35-1147" aria-hidden="true" tabindex="-1"></a><span class="in">  });</span></span>
<span id="cb35-1148"><a href="#cb35-1148" aria-hidden="true" tabindex="-1"></a><span class="in">  const sanitize = (a, b) =&gt; {</span></span>
<span id="cb35-1149"><a href="#cb35-1149" aria-hidden="true" tabindex="-1"></a><span class="in">    a = isNaN(a) ? min : ((input.value = a), input.valueAsNumber);</span></span>
<span id="cb35-1150"><a href="#cb35-1150" aria-hidden="true" tabindex="-1"></a><span class="in">    b = isNaN(b) ? max : ((input.value = b), input.valueAsNumber);</span></span>
<span id="cb35-1151"><a href="#cb35-1151" aria-hidden="true" tabindex="-1"></a><span class="in">    return [Math.min(a, b), Math.max(a, b)];</span></span>
<span id="cb35-1152"><a href="#cb35-1152" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1153"><a href="#cb35-1153" aria-hidden="true" tabindex="-1"></a><span class="in">  const updateRange = () =&gt; {</span></span>
<span id="cb35-1154"><a href="#cb35-1154" aria-hidden="true" tabindex="-1"></a><span class="in">    const ratio = v =&gt; (v - min) / (max - min);</span></span>
<span id="cb35-1155"><a href="#cb35-1155" aria-hidden="true" tabindex="-1"></a><span class="in">    dom.style.setProperty('--range-min', `${ratio(value[0]) * 100}%`);</span></span>
<span id="cb35-1156"><a href="#cb35-1156" aria-hidden="true" tabindex="-1"></a><span class="in">    dom.style.setProperty('--range-max', `${ratio(value[1]) * 100}%`);</span></span>
<span id="cb35-1157"><a href="#cb35-1157" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1158"><a href="#cb35-1158" aria-hidden="true" tabindex="-1"></a><span class="in">  const dispatch = name =&gt; {</span></span>
<span id="cb35-1159"><a href="#cb35-1159" aria-hidden="true" tabindex="-1"></a><span class="in">    dom.dispatchEvent(new Event(name, {bubbles: true}));</span></span>
<span id="cb35-1160"><a href="#cb35-1160" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1161"><a href="#cb35-1161" aria-hidden="true" tabindex="-1"></a><span class="in">  const setValue = (vmin, vmax) =&gt; {</span></span>
<span id="cb35-1162"><a href="#cb35-1162" aria-hidden="true" tabindex="-1"></a><span class="in">    const [pmin, pmax] = value;</span></span>
<span id="cb35-1163"><a href="#cb35-1163" aria-hidden="true" tabindex="-1"></a><span class="in">    value = sanitize(vmin, vmax);</span></span>
<span id="cb35-1164"><a href="#cb35-1164" aria-hidden="true" tabindex="-1"></a><span class="in">    updateRange();</span></span>
<span id="cb35-1165"><a href="#cb35-1165" aria-hidden="true" tabindex="-1"></a><span class="in">    // Only dispatch if values have changed.</span></span>
<span id="cb35-1166"><a href="#cb35-1166" aria-hidden="true" tabindex="-1"></a><span class="in">    if(pmin === value[0] &amp;&amp; pmax === value[1]) return;</span></span>
<span id="cb35-1167"><a href="#cb35-1167" aria-hidden="true" tabindex="-1"></a><span class="in">    dispatch('input');</span></span>
<span id="cb35-1168"><a href="#cb35-1168" aria-hidden="true" tabindex="-1"></a><span class="in">    changed = true;</span></span>
<span id="cb35-1169"><a href="#cb35-1169" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1170"><a href="#cb35-1170" aria-hidden="true" tabindex="-1"></a><span class="in">  setValue(...defaultValue);</span></span>
<span id="cb35-1171"><a href="#cb35-1171" aria-hidden="true" tabindex="-1"></a><span class="in">  // Mousemove handlers.</span></span>
<span id="cb35-1172"><a href="#cb35-1172" aria-hidden="true" tabindex="-1"></a><span class="in">  const handlers = new Map([</span></span>
<span id="cb35-1173"><a href="#cb35-1173" aria-hidden="true" tabindex="-1"></a><span class="in">    [controls.min, (dt, ov) =&gt; {</span></span>
<span id="cb35-1174"><a href="#cb35-1174" aria-hidden="true" tabindex="-1"></a><span class="in">      const v = clamp(min, ov[1], ov[0] + dt * (max - min));</span></span>
<span id="cb35-1175"><a href="#cb35-1175" aria-hidden="true" tabindex="-1"></a><span class="in">      setValue(v, ov[1]);</span></span>
<span id="cb35-1176"><a href="#cb35-1176" aria-hidden="true" tabindex="-1"></a><span class="in">    }],</span></span>
<span id="cb35-1177"><a href="#cb35-1177" aria-hidden="true" tabindex="-1"></a><span class="in">    [controls.max, (dt, ov) =&gt; {</span></span>
<span id="cb35-1178"><a href="#cb35-1178" aria-hidden="true" tabindex="-1"></a><span class="in">      const v = clamp(ov[0], max, ov[1] + dt * (max - min));</span></span>
<span id="cb35-1179"><a href="#cb35-1179" aria-hidden="true" tabindex="-1"></a><span class="in">      setValue(ov[0], v);</span></span>
<span id="cb35-1180"><a href="#cb35-1180" aria-hidden="true" tabindex="-1"></a><span class="in">    }],</span></span>
<span id="cb35-1181"><a href="#cb35-1181" aria-hidden="true" tabindex="-1"></a><span class="in">    [controls.range, (dt, ov) =&gt; {</span></span>
<span id="cb35-1182"><a href="#cb35-1182" aria-hidden="true" tabindex="-1"></a><span class="in">      const d = ov[1] - ov[0];</span></span>
<span id="cb35-1183"><a href="#cb35-1183" aria-hidden="true" tabindex="-1"></a><span class="in">      const v = clamp(min, max - d, ov[0] + dt * (max - min));</span></span>
<span id="cb35-1184"><a href="#cb35-1184" aria-hidden="true" tabindex="-1"></a><span class="in">      setValue(v, v + d);</span></span>
<span id="cb35-1185"><a href="#cb35-1185" aria-hidden="true" tabindex="-1"></a><span class="in">    }],</span></span>
<span id="cb35-1186"><a href="#cb35-1186" aria-hidden="true" tabindex="-1"></a><span class="in">  ]);</span></span>
<span id="cb35-1187"><a href="#cb35-1187" aria-hidden="true" tabindex="-1"></a><span class="in">  // Returns client offset object.</span></span>
<span id="cb35-1188"><a href="#cb35-1188" aria-hidden="true" tabindex="-1"></a><span class="in">  const pointer = e =&gt; e.touches ? e.touches[0] : e;</span></span>
<span id="cb35-1189"><a href="#cb35-1189" aria-hidden="true" tabindex="-1"></a><span class="in">  // Note: Chrome defaults "passive" for touch events to true.</span></span>
<span id="cb35-1190"><a href="#cb35-1190" aria-hidden="true" tabindex="-1"></a><span class="in">  const on  = (e, fn) =&gt; e.split(' ').map(e =&gt; document.addEventListener(e, fn, {passive: false}));</span></span>
<span id="cb35-1191"><a href="#cb35-1191" aria-hidden="true" tabindex="-1"></a><span class="in">  const off = (e, fn) =&gt; e.split(' ').map(e =&gt; document.removeEventListener(e, fn, {passive: false}));</span></span>
<span id="cb35-1192"><a href="#cb35-1192" aria-hidden="true" tabindex="-1"></a><span class="in">  let initialX, initialV, target, dragging = false;</span></span>
<span id="cb35-1193"><a href="#cb35-1193" aria-hidden="true" tabindex="-1"></a><span class="in">  function handleDrag(e) {</span></span>
<span id="cb35-1194"><a href="#cb35-1194" aria-hidden="true" tabindex="-1"></a><span class="in">    // Gracefully handle exit and reentry of the viewport.</span></span>
<span id="cb35-1195"><a href="#cb35-1195" aria-hidden="true" tabindex="-1"></a><span class="in">    if(!e.buttons &amp;&amp; !e.touches) {</span></span>
<span id="cb35-1196"><a href="#cb35-1196" aria-hidden="true" tabindex="-1"></a><span class="in">      handleDragStop();</span></span>
<span id="cb35-1197"><a href="#cb35-1197" aria-hidden="true" tabindex="-1"></a><span class="in">      return;</span></span>
<span id="cb35-1198"><a href="#cb35-1198" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb35-1199"><a href="#cb35-1199" aria-hidden="true" tabindex="-1"></a><span class="in">    dragging = true;</span></span>
<span id="cb35-1200"><a href="#cb35-1200" aria-hidden="true" tabindex="-1"></a><span class="in">    const w = controls.zone.getBoundingClientRect().width;</span></span>
<span id="cb35-1201"><a href="#cb35-1201" aria-hidden="true" tabindex="-1"></a><span class="in">    e.preventDefault();</span></span>
<span id="cb35-1202"><a href="#cb35-1202" aria-hidden="true" tabindex="-1"></a><span class="in">    handlers.get(target)((pointer(e).clientX - initialX) / w, initialV);</span></span>
<span id="cb35-1203"><a href="#cb35-1203" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1204"><a href="#cb35-1204" aria-hidden="true" tabindex="-1"></a><span class="in">  function handleDragStop(e) {</span></span>
<span id="cb35-1205"><a href="#cb35-1205" aria-hidden="true" tabindex="-1"></a><span class="in">    off('mousemove touchmove', handleDrag);</span></span>
<span id="cb35-1206"><a href="#cb35-1206" aria-hidden="true" tabindex="-1"></a><span class="in">    off('mouseup touchend', handleDragStop);</span></span>
<span id="cb35-1207"><a href="#cb35-1207" aria-hidden="true" tabindex="-1"></a><span class="in">    if(changed) dispatch('change');</span></span>
<span id="cb35-1208"><a href="#cb35-1208" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1209"><a href="#cb35-1209" aria-hidden="true" tabindex="-1"></a><span class="in">  invalidation.then(handleDragStop);</span></span>
<span id="cb35-1210"><a href="#cb35-1210" aria-hidden="true" tabindex="-1"></a><span class="in">  dom.ontouchstart = dom.onmousedown = e =&gt; {</span></span>
<span id="cb35-1211"><a href="#cb35-1211" aria-hidden="true" tabindex="-1"></a><span class="in">    dragging = false;</span></span>
<span id="cb35-1212"><a href="#cb35-1212" aria-hidden="true" tabindex="-1"></a><span class="in">    changed = false;</span></span>
<span id="cb35-1213"><a href="#cb35-1213" aria-hidden="true" tabindex="-1"></a><span class="in">    if(!handlers.has(e.target)) return;</span></span>
<span id="cb35-1214"><a href="#cb35-1214" aria-hidden="true" tabindex="-1"></a><span class="in">    on('mousemove touchmove', handleDrag);</span></span>
<span id="cb35-1215"><a href="#cb35-1215" aria-hidden="true" tabindex="-1"></a><span class="in">    on('mouseup touchend', handleDragStop);</span></span>
<span id="cb35-1216"><a href="#cb35-1216" aria-hidden="true" tabindex="-1"></a><span class="in">    e.preventDefault();</span></span>
<span id="cb35-1217"><a href="#cb35-1217" aria-hidden="true" tabindex="-1"></a><span class="in">    e.stopPropagation();</span></span>
<span id="cb35-1218"><a href="#cb35-1218" aria-hidden="true" tabindex="-1"></a><span class="in">    target = e.target;</span></span>
<span id="cb35-1219"><a href="#cb35-1219" aria-hidden="true" tabindex="-1"></a><span class="in">    initialX = pointer(e).clientX;</span></span>
<span id="cb35-1220"><a href="#cb35-1220" aria-hidden="true" tabindex="-1"></a><span class="in">    initialV = value.slice();</span></span>
<span id="cb35-1221"><a href="#cb35-1221" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1222"><a href="#cb35-1222" aria-hidden="true" tabindex="-1"></a><span class="in">  controls.track.onclick = e =&gt; {</span></span>
<span id="cb35-1223"><a href="#cb35-1223" aria-hidden="true" tabindex="-1"></a><span class="in">    if(dragging) return;</span></span>
<span id="cb35-1224"><a href="#cb35-1224" aria-hidden="true" tabindex="-1"></a><span class="in">    changed = false;</span></span>
<span id="cb35-1225"><a href="#cb35-1225" aria-hidden="true" tabindex="-1"></a><span class="in">    const r = controls.zone.getBoundingClientRect();</span></span>
<span id="cb35-1226"><a href="#cb35-1226" aria-hidden="true" tabindex="-1"></a><span class="in">    const t = clamp(0, 1, (pointer(e).clientX - r.left) / r.width);</span></span>
<span id="cb35-1227"><a href="#cb35-1227" aria-hidden="true" tabindex="-1"></a><span class="in">    const v = min + t * (max - min);</span></span>
<span id="cb35-1228"><a href="#cb35-1228" aria-hidden="true" tabindex="-1"></a><span class="in">    const [vmin, vmax] = value, d = vmax - vmin;</span></span>
<span id="cb35-1229"><a href="#cb35-1229" aria-hidden="true" tabindex="-1"></a><span class="in">    if(v &lt; vmin) setValue(v, v + d);</span></span>
<span id="cb35-1230"><a href="#cb35-1230" aria-hidden="true" tabindex="-1"></a><span class="in">    else if(v &gt; vmax) setValue(v - d, v);</span></span>
<span id="cb35-1231"><a href="#cb35-1231" aria-hidden="true" tabindex="-1"></a><span class="in">    if(changed) dispatch('change');</span></span>
<span id="cb35-1232"><a href="#cb35-1232" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1233"><a href="#cb35-1233" aria-hidden="true" tabindex="-1"></a><span class="in">  return dom;</span></span>
<span id="cb35-1234"><a href="#cb35-1234" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1235"><a href="#cb35-1235" aria-hidden="true" tabindex="-1"></a><span class="in">function formatDecimal(number) {</span></span>
<span id="cb35-1236"><a href="#cb35-1236" aria-hidden="true" tabindex="-1"></a><span class="in">  return number == 1 ? number : (Math.round(number * 100) / 100).toString().slice(1)</span></span>
<span id="cb35-1237"><a href="#cb35-1237" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1238"><a href="#cb35-1238" aria-hidden="true" tabindex="-1"></a><span class="in">button = (data, filename = 'data.csv') =&gt; {</span></span>
<span id="cb35-1239"><a href="#cb35-1239" aria-hidden="true" tabindex="-1"></a><span class="in">  if (!data) throw new Error('Array of data required as first argument');</span></span>
<span id="cb35-1240"><a href="#cb35-1240" aria-hidden="true" tabindex="-1"></a><span class="in">  let downloadData;</span></span>
<span id="cb35-1241"><a href="#cb35-1241" aria-hidden="true" tabindex="-1"></a><span class="in">  if (filename.includes('.csv')) {</span></span>
<span id="cb35-1242"><a href="#cb35-1242" aria-hidden="true" tabindex="-1"></a><span class="in">    downloadData = new Blob([d3.csvFormat(data)], { type: "text/csv" });</span></span>
<span id="cb35-1243"><a href="#cb35-1243" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb35-1244"><a href="#cb35-1244" aria-hidden="true" tabindex="-1"></a><span class="in">    downloadData = new Blob([JSON.stringify(data, null, 2)], {</span></span>
<span id="cb35-1245"><a href="#cb35-1245" aria-hidden="true" tabindex="-1"></a><span class="in">      type: "application/json"</span></span>
<span id="cb35-1246"><a href="#cb35-1246" aria-hidden="true" tabindex="-1"></a><span class="in">    });</span></span>
<span id="cb35-1247"><a href="#cb35-1247" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1248"><a href="#cb35-1248" aria-hidden="true" tabindex="-1"></a><span class="in">  return DOM.download(</span></span>
<span id="cb35-1249"><a href="#cb35-1249" aria-hidden="true" tabindex="-1"></a><span class="in">    downloadData,</span></span>
<span id="cb35-1250"><a href="#cb35-1250" aria-hidden="true" tabindex="-1"></a><span class="in">    filename,</span></span>
<span id="cb35-1251"><a href="#cb35-1251" aria-hidden="true" tabindex="-1"></a><span class="in">    "Download"</span></span>
<span id="cb35-1252"><a href="#cb35-1252" aria-hidden="true" tabindex="-1"></a><span class="in">  );</span></span>
<span id="cb35-1253"><a href="#cb35-1253" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1254"><a href="#cb35-1254" aria-hidden="true" tabindex="-1"></a><span class="in">function invert(arr) {</span></span>
<span id="cb35-1255"><a href="#cb35-1255" aria-hidden="true" tabindex="-1"></a><span class="in">  return invertDotd ? [...Array(10).keys()].map(n =&gt; !arr.includes(n)).map((x, i) =&gt; x ? i : null).filter(i =&gt; i !== null) : arr</span></span>
<span id="cb35-1256"><a href="#cb35-1256" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1257"><a href="#cb35-1257" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb35-1258"><a href="#cb35-1258" aria-hidden="true" tabindex="-1"></a><span class="in">function toggleSwitch(options = { textOn: 'True', textOff: 'False' }) {</span></span>
<span id="cb35-1259"><a href="#cb35-1259" aria-hidden="true" tabindex="-1"></a><span class="in">  const button = html`&lt;div class="button-switch""&gt;&lt;/div&gt;`;</span></span>
<span id="cb35-1260"><a href="#cb35-1260" aria-hidden="true" tabindex="-1"></a><span class="in">  button.innerText = options.textOn;</span></span>
<span id="cb35-1261"><a href="#cb35-1261" aria-hidden="true" tabindex="-1"></a><span class="in">  button.value = true;</span></span>
<span id="cb35-1262"><a href="#cb35-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1263"><a href="#cb35-1263" aria-hidden="true" tabindex="-1"></a><span class="in">  button.onclick = () =&gt; {</span></span>
<span id="cb35-1264"><a href="#cb35-1264" aria-hidden="true" tabindex="-1"></a><span class="in">    button.value = !button.value;</span></span>
<span id="cb35-1265"><a href="#cb35-1265" aria-hidden="true" tabindex="-1"></a><span class="in">    button.innerText = button.value ? options.textOn : options.textOff;</span></span>
<span id="cb35-1266"><a href="#cb35-1266" aria-hidden="true" tabindex="-1"></a><span class="in">    button.dispatchEvent(new CustomEvent("input"));</span></span>
<span id="cb35-1267"><a href="#cb35-1267" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1268"><a href="#cb35-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1269"><a href="#cb35-1269" aria-hidden="true" tabindex="-1"></a><span class="in">  addButtonStyle()</span></span>
<span id="cb35-1270"><a href="#cb35-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1271"><a href="#cb35-1271" aria-hidden="true" tabindex="-1"></a><span class="in">  return button;</span></span>
<span id="cb35-1272"><a href="#cb35-1272" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1273"><a href="#cb35-1273" aria-hidden="true" tabindex="-1"></a><span class="in">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb35-1274"><a href="#cb35-1274" aria-hidden="true" tabindex="-1"></a><span class="in">function addButtonStyle() {</span></span>
<span id="cb35-1275"><a href="#cb35-1275" aria-hidden="true" tabindex="-1"></a><span class="in">  var el = document.createElement('style');</span></span>
<span id="cb35-1276"><a href="#cb35-1276" aria-hidden="true" tabindex="-1"></a><span class="in">  el.setAttribute('type', 'text/css');</span></span>
<span id="cb35-1277"><a href="#cb35-1277" aria-hidden="true" tabindex="-1"></a><span class="in">  document.head.appendChild(el);</span></span>
<span id="cb35-1278"><a href="#cb35-1278" aria-hidden="true" tabindex="-1"></a><span class="in">  var sheet = el.sheet;</span></span>
<span id="cb35-1279"><a href="#cb35-1279" aria-hidden="true" tabindex="-1"></a><span class="in">  function addRule(rule) {</span></span>
<span id="cb35-1280"><a href="#cb35-1280" aria-hidden="true" tabindex="-1"></a><span class="in">    try {</span></span>
<span id="cb35-1281"><a href="#cb35-1281" aria-hidden="true" tabindex="-1"></a><span class="in">      sheet.insertRule(rule, sheet.cssRules.length);</span></span>
<span id="cb35-1282"><a href="#cb35-1282" aria-hidden="true" tabindex="-1"></a><span class="in">    } catch (e) {</span></span>
<span id="cb35-1283"><a href="#cb35-1283" aria-hidden="true" tabindex="-1"></a><span class="in">      console.warn('Error inserting rule', rule, e);</span></span>
<span id="cb35-1284"><a href="#cb35-1284" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb35-1285"><a href="#cb35-1285" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1286"><a href="#cb35-1286" aria-hidden="true" tabindex="-1"></a><span class="in">  addRule(</span></span>
<span id="cb35-1287"><a href="#cb35-1287" aria-hidden="true" tabindex="-1"></a><span class="in">    '.button-switch { -webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;display: inline-block;-webkit-border-radius: 2px;-moz-border-radius: 2px;border-radius: 2px;background-color: #EFEFEF;padding: 0px 7px 0px 7px;text-align: center;border: 1px solid grey;width: auto;color: #1c1c1c;font-size: 14px;font-family: sans-serif;text-decoration: none; }'</span></span>
<span id="cb35-1288"><a href="#cb35-1288" aria-hidden="true" tabindex="-1"></a><span class="in">  );</span></span>
<span id="cb35-1289"><a href="#cb35-1289" aria-hidden="true" tabindex="-1"></a><span class="in">  addRule(</span></span>
<span id="cb35-1290"><a href="#cb35-1290" aria-hidden="true" tabindex="-1"></a><span class="in">    '.button-switch:hover { background-color: #E5E5E5;border: 1px solid #454545; }'</span></span>
<span id="cb35-1291"><a href="#cb35-1291" aria-hidden="true" tabindex="-1"></a><span class="in">  );</span></span>
<span id="cb35-1292"><a href="#cb35-1292" aria-hidden="true" tabindex="-1"></a><span class="in">  addRule(</span></span>
<span id="cb35-1293"><a href="#cb35-1293" aria-hidden="true" tabindex="-1"></a><span class="in">    '.button-switch:active { background-color: #f5f5f5;border: 1px solid grey; }'</span></span>
<span id="cb35-1294"><a href="#cb35-1294" aria-hidden="true" tabindex="-1"></a><span class="in">  );</span></span>
<span id="cb35-1295"><a href="#cb35-1295" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1296"><a href="#cb35-1296" aria-hidden="true" tabindex="-1"></a><span class="in">function setSpreadDotd(dotd) {</span></span>
<span id="cb35-1297"><a href="#cb35-1297" aria-hidden="true" tabindex="-1"></a><span class="in">  const dotdLength = dotd.length;</span></span>
<span id="cb35-1298"><a href="#cb35-1298" aria-hidden="true" tabindex="-1"></a><span class="in">  if (dotdLength === 10) {return "&gt;"}</span></span>
<span id="cb35-1299"><a href="#cb35-1299" aria-hidden="true" tabindex="-1"></a><span class="in">  if (dotdLength === 0) {return "&gt;0"}</span></span>
<span id="cb35-1300"><a href="#cb35-1300" aria-hidden="true" tabindex="-1"></a><span class="in">  if (dotdLength === 1) {return `${dotd[0]}&gt;&gt;1&gt;9`}</span></span>
<span id="cb35-1301"><a href="#cb35-1301" aria-hidden="true" tabindex="-1"></a><span class="in">  const steps = dotd.map((x, i) =&gt; dotd[i + 1] - x)</span></span>
<span id="cb35-1302"><a href="#cb35-1302" aria-hidden="true" tabindex="-1"></a><span class="in">    .filter(i =&gt; !isNaN(i)),</span></span>
<span id="cb35-1303"><a href="#cb35-1303" aria-hidden="true" tabindex="-1"></a><span class="in">    result = [];</span></span>
<span id="cb35-1304"><a href="#cb35-1304" aria-hidden="true" tabindex="-1"></a><span class="in">  let split = 1;</span></span>
<span id="cb35-1305"><a href="#cb35-1305" aria-hidden="true" tabindex="-1"></a><span class="in">  for (const step of steps) {</span></span>
<span id="cb35-1306"><a href="#cb35-1306" aria-hidden="true" tabindex="-1"></a><span class="in">    if (step !== 1) {</span></span>
<span id="cb35-1307"><a href="#cb35-1307" aria-hidden="true" tabindex="-1"></a><span class="in">       result.push([split, step - 1])</span></span>
<span id="cb35-1308"><a href="#cb35-1308" aria-hidden="true" tabindex="-1"></a><span class="in">       split = 1</span></span>
<span id="cb35-1309"><a href="#cb35-1309" aria-hidden="true" tabindex="-1"></a><span class="in">    } else {</span></span>
<span id="cb35-1310"><a href="#cb35-1310" aria-hidden="true" tabindex="-1"></a><span class="in">      split += 1</span></span>
<span id="cb35-1311"><a href="#cb35-1311" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb35-1312"><a href="#cb35-1312" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1313"><a href="#cb35-1313" aria-hidden="true" tabindex="-1"></a><span class="in">  result.push(split)</span></span>
<span id="cb35-1314"><a href="#cb35-1314" aria-hidden="true" tabindex="-1"></a><span class="in">  const flat = [].concat(...result),</span></span>
<span id="cb35-1315"><a href="#cb35-1315" aria-hidden="true" tabindex="-1"></a><span class="in">    resultSum = flat.reduce((a, b) =&gt; a + b, 0),</span></span>
<span id="cb35-1316"><a href="#cb35-1316" aria-hidden="true" tabindex="-1"></a><span class="in">    uniq = [...new Set(flat)];</span></span>
<span id="cb35-1317"><a href="#cb35-1317" aria-hidden="true" tabindex="-1"></a><span class="in">  return [dotd[0] ? dotd[0] : null, null].concat(JSON.stringify(uniq) === "[1]" ? [null, 1] : uniq.length === 2 &amp;&amp; uniq.reduce((a, b) =&gt; a + b, 0) === 5 ? uniq : flat.concat(10 - resultSum).map((x, i) =&gt; i % 2 === 0 &amp;&amp; x === 1 ? null : x)).join("&gt;")</span></span>
<span id="cb35-1318"><a href="#cb35-1318" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1319"><a href="#cb35-1319" aria-hidden="true" tabindex="-1"></a><span class="in">function setSliceDotd(dotd) {</span></span>
<span id="cb35-1320"><a href="#cb35-1320" aria-hidden="true" tabindex="-1"></a><span class="in">  const dotdLength = dotd.length;</span></span>
<span id="cb35-1321"><a href="#cb35-1321" aria-hidden="true" tabindex="-1"></a><span class="in">  if (dotdLength === 10) {return ":"}</span></span>
<span id="cb35-1322"><a href="#cb35-1322" aria-hidden="true" tabindex="-1"></a><span class="in">  if (dotdLength === 0) {return ":0"}</span></span>
<span id="cb35-1323"><a href="#cb35-1323" aria-hidden="true" tabindex="-1"></a><span class="in">  const steps = dotd.map((x, i) =&gt; dotd[i + 1] - x)</span></span>
<span id="cb35-1324"><a href="#cb35-1324" aria-hidden="true" tabindex="-1"></a><span class="in">    .filter(i =&gt; !isNaN(i)),</span></span>
<span id="cb35-1325"><a href="#cb35-1325" aria-hidden="true" tabindex="-1"></a><span class="in">    stepSum = steps.reduce((a, b) =&gt; a + b, 0),</span></span>
<span id="cb35-1326"><a href="#cb35-1326" aria-hidden="true" tabindex="-1"></a><span class="in">    uniq = [...new Set(steps.concat(10 - stepSum))];</span></span>
<span id="cb35-1327"><a href="#cb35-1327" aria-hidden="true" tabindex="-1"></a><span class="in">  return [dotd[0] ? dotd[0] : null, null].concat(uniq.length === 1 ? uniq : JSON.stringify(steps) === "[1,4,1]" ? [1, 4] : JSON.stringify(steps) === "[1,1,3,1,1]" ? [1, 1, 3] : JSON.stringify(steps) === "[1,1,1,2,1,1,1]" ? [1, 1, 1, 2] : steps.concat(10 - stepSum).map(x =&gt; x === 1 ? null : x)).join(":");</span></span>
<span id="cb35-1328"><a href="#cb35-1328" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1329"><a href="#cb35-1329" aria-hidden="true" tabindex="-1"></a><span class="in">function encodeSlice(...args) {</span></span>
<span id="cb35-1330"><a href="#cb35-1330" aria-hidden="true" tabindex="-1"></a><span class="in">  return args.join().replaceAll(",", ":")</span></span>
<span id="cb35-1331"><a href="#cb35-1331" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1332"><a href="#cb35-1332" aria-hidden="true" tabindex="-1"></a><span class="in">function decodeSlice(s) {</span></span>
<span id="cb35-1333"><a href="#cb35-1333" aria-hidden="true" tabindex="-1"></a><span class="in">  let [start, stop, ...steps] = s.split(":").map(i =&gt; i === "" ? null : Number(i))</span></span>
<span id="cb35-1334"><a href="#cb35-1334" aria-hidden="true" tabindex="-1"></a><span class="in">  const step = steps[0] == null ? 1: steps[0];</span></span>
<span id="cb35-1335"><a href="#cb35-1335" aria-hidden="true" tabindex="-1"></a><span class="in">  start = start == null &amp;&amp; step &gt;= 0 ? 0 : start == null &amp;&amp; step &lt; 0 ? 365 : start;</span></span>
<span id="cb35-1336"><a href="#cb35-1336" aria-hidden="true" tabindex="-1"></a><span class="in">  stop = stop == null &amp;&amp; step &gt;= 0 ? 366 : stop;</span></span>
<span id="cb35-1337"><a href="#cb35-1337" aria-hidden="true" tabindex="-1"></a><span class="in">  return [start, stop, step]</span></span>
<span id="cb35-1338"><a href="#cb35-1338" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1339"><a href="#cb35-1339" aria-hidden="true" tabindex="-1"></a><span class="in">function decodeSpread(spread) {</span></span>
<span id="cb35-1340"><a href="#cb35-1340" aria-hidden="true" tabindex="-1"></a><span class="in">  return spread.replace(/^&lt;/, "366&lt;").replace(/^&gt;/, "0&gt;")</span></span>
<span id="cb35-1341"><a href="#cb35-1341" aria-hidden="true" tabindex="-1"></a><span class="in">    .split(/(?=^\d|&lt;|&gt;)/).map(s =&gt; s.replace("&lt;", "-")</span></span>
<span id="cb35-1342"><a href="#cb35-1342" aria-hidden="true" tabindex="-1"></a><span class="in">    .replace("&gt;", "")).map(s =&gt; s === "" || isNaN(s) ? null : Number(s))</span></span>
<span id="cb35-1343"><a href="#cb35-1343" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1344"><a href="#cb35-1344" aria-hidden="true" tabindex="-1"></a><span class="in">function encodeSpread(args) {</span></span>
<span id="cb35-1345"><a href="#cb35-1345" aria-hidden="true" tabindex="-1"></a><span class="in">  return args.map(a =&gt; isNaN(a) ? null : a).join("&gt;").replace("&gt;-", "&lt;")</span></span>
<span id="cb35-1346"><a href="#cb35-1346" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1347"><a href="#cb35-1347" aria-hidden="true" tabindex="-1"></a><span class="in">function slice(self, start, stop, steps, ...args) {</span></span>
<span id="cb35-1348"><a href="#cb35-1348" aria-hidden="true" tabindex="-1"></a><span class="in">  const len = self.length, result = [];</span></span>
<span id="cb35-1349"><a href="#cb35-1349" aria-hidden="true" tabindex="-1"></a><span class="in">  if (steps === 0 || len === 0) { return result };</span></span>
<span id="cb35-1350"><a href="#cb35-1350" aria-hidden="true" tabindex="-1"></a><span class="in">  steps = (!steps || steps.length === 0 ? [1] :</span></span>
<span id="cb35-1351"><a href="#cb35-1351" aria-hidden="true" tabindex="-1"></a><span class="in">    typeof steps === "number" ? [steps] :</span></span>
<span id="cb35-1352"><a href="#cb35-1352" aria-hidden="true" tabindex="-1"></a><span class="in">    typeof steps === "string" ? Array.from(steps, Number) :</span></span>
<span id="cb35-1353"><a href="#cb35-1353" aria-hidden="true" tabindex="-1"></a><span class="in">    steps).concat(args.map(i =&gt; i == null ? 1 : i));</span></span>
<span id="cb35-1354"><a href="#cb35-1354" aria-hidden="true" tabindex="-1"></a><span class="in">  const stepCount = steps.length,</span></span>
<span id="cb35-1355"><a href="#cb35-1355" aria-hidden="true" tabindex="-1"></a><span class="in">    stepSum = steps.reduce((a, b) =&gt; a + b, 0);</span></span>
<span id="cb35-1356"><a href="#cb35-1356" aria-hidden="true" tabindex="-1"></a><span class="in">  if (stepSum === 0) { return result };</span></span>
<span id="cb35-1357"><a href="#cb35-1357" aria-hidden="true" tabindex="-1"></a><span class="in">  start = Math.max(</span></span>
<span id="cb35-1358"><a href="#cb35-1358" aria-hidden="true" tabindex="-1"></a><span class="in">    start == null &amp;&amp; stepSum &gt; 0 ? 0 :</span></span>
<span id="cb35-1359"><a href="#cb35-1359" aria-hidden="true" tabindex="-1"></a><span class="in">    start == null &amp;&amp; stepSum &lt; 0 ? len - 1 :</span></span>
<span id="cb35-1360"><a href="#cb35-1360" aria-hidden="true" tabindex="-1"></a><span class="in">    start &gt;= len ? len - 1 :</span></span>
<span id="cb35-1361"><a href="#cb35-1361" aria-hidden="true" tabindex="-1"></a><span class="in">    start &lt; 0 ? start + len :</span></span>
<span id="cb35-1362"><a href="#cb35-1362" aria-hidden="true" tabindex="-1"></a><span class="in">    start, 0);</span></span>
<span id="cb35-1363"><a href="#cb35-1363" aria-hidden="true" tabindex="-1"></a><span class="in">  stop = Math.max(</span></span>
<span id="cb35-1364"><a href="#cb35-1364" aria-hidden="true" tabindex="-1"></a><span class="in">    stop == null &amp;&amp; stepSum &gt; 0 ? len :</span></span>
<span id="cb35-1365"><a href="#cb35-1365" aria-hidden="true" tabindex="-1"></a><span class="in">    stop == null &amp;&amp; stepSum &lt; 0 ? -1 :</span></span>
<span id="cb35-1366"><a href="#cb35-1366" aria-hidden="true" tabindex="-1"></a><span class="in">    stop &gt;= len ? len :</span></span>
<span id="cb35-1367"><a href="#cb35-1367" aria-hidden="true" tabindex="-1"></a><span class="in">    stop &lt; 0 ? stop + len :</span></span>
<span id="cb35-1368"><a href="#cb35-1368" aria-hidden="true" tabindex="-1"></a><span class="in">    stop, -1);</span></span>
<span id="cb35-1369"><a href="#cb35-1369" aria-hidden="true" tabindex="-1"></a><span class="in">  for (</span></span>
<span id="cb35-1370"><a href="#cb35-1370" aria-hidden="true" tabindex="-1"></a><span class="in">    let i = start, counter = -1;</span></span>
<span id="cb35-1371"><a href="#cb35-1371" aria-hidden="true" tabindex="-1"></a><span class="in">    stepSum &gt; 0 ? i &lt; stop : i &gt; stop;</span></span>
<span id="cb35-1372"><a href="#cb35-1372" aria-hidden="true" tabindex="-1"></a><span class="in">    i += steps[counter]</span></span>
<span id="cb35-1373"><a href="#cb35-1373" aria-hidden="true" tabindex="-1"></a><span class="in">  ) {</span></span>
<span id="cb35-1374"><a href="#cb35-1374" aria-hidden="true" tabindex="-1"></a><span class="in">    result.push(self[i]);</span></span>
<span id="cb35-1375"><a href="#cb35-1375" aria-hidden="true" tabindex="-1"></a><span class="in">    counter = (counter + 1) % stepCount;</span></span>
<span id="cb35-1376"><a href="#cb35-1376" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1377"><a href="#cb35-1377" aria-hidden="true" tabindex="-1"></a><span class="in">  return result;</span></span>
<span id="cb35-1378"><a href="#cb35-1378" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1379"><a href="#cb35-1379" aria-hidden="true" tabindex="-1"></a><span class="in">function spread(self, startOrStop, span, splitsAndSpaces, ...args) {</span></span>
<span id="cb35-1380"><a href="#cb35-1380" aria-hidden="true" tabindex="-1"></a><span class="in">  const len = self.length, result = [];</span></span>
<span id="cb35-1381"><a href="#cb35-1381" aria-hidden="true" tabindex="-1"></a><span class="in">  if (span === 0 || len === 0) { return result };</span></span>
<span id="cb35-1382"><a href="#cb35-1382" aria-hidden="true" tabindex="-1"></a><span class="in">  splitsAndSpaces = (!splitsAndSpaces || splitsAndSpaces.length === 0 ? [1] :</span></span>
<span id="cb35-1383"><a href="#cb35-1383" aria-hidden="true" tabindex="-1"></a><span class="in">    typeof splitsAndSpaces === "number" ? [splitsAndSpaces] :</span></span>
<span id="cb35-1384"><a href="#cb35-1384" aria-hidden="true" tabindex="-1"></a><span class="in">    typeof splitsAndSpaces === "string" ? Array.from(splitsAndSpaces, Number) :</span></span>
<span id="cb35-1385"><a href="#cb35-1385" aria-hidden="true" tabindex="-1"></a><span class="in">    splitsAndSpaces).concat(args.map(i =&gt; i == null ? 1 : i));</span></span>
<span id="cb35-1386"><a href="#cb35-1386" aria-hidden="true" tabindex="-1"></a><span class="in">    const splitCount = splitsAndSpaces.length,</span></span>
<span id="cb35-1387"><a href="#cb35-1387" aria-hidden="true" tabindex="-1"></a><span class="in">    splitSpaceSum = splitsAndSpaces.reduce((a, b) =&gt; a + b, 0);</span></span>
<span id="cb35-1388"><a href="#cb35-1388" aria-hidden="true" tabindex="-1"></a><span class="in">  if (splitSpaceSum &lt;= 0) { return result };</span></span>
<span id="cb35-1389"><a href="#cb35-1389" aria-hidden="true" tabindex="-1"></a><span class="in">  startOrStop = Math.max(</span></span>
<span id="cb35-1390"><a href="#cb35-1390" aria-hidden="true" tabindex="-1"></a><span class="in">    startOrStop == null &amp;&amp; span &gt; 0 || startOrStop == null &amp;&amp; span == null ? 0 :</span></span>
<span id="cb35-1391"><a href="#cb35-1391" aria-hidden="true" tabindex="-1"></a><span class="in">    startOrStop == null || startOrStop &gt; len &amp;&amp; span &lt; 0 ? len :</span></span>
<span id="cb35-1392"><a href="#cb35-1392" aria-hidden="true" tabindex="-1"></a><span class="in">    startOrStop &lt; 0 ? startOrStop + len :</span></span>
<span id="cb35-1393"><a href="#cb35-1393" aria-hidden="true" tabindex="-1"></a><span class="in">    startOrStop, 0);</span></span>
<span id="cb35-1394"><a href="#cb35-1394" aria-hidden="true" tabindex="-1"></a><span class="in">  span = span == null || startOrStop + span &gt; len ? len - startOrStop :</span></span>
<span id="cb35-1395"><a href="#cb35-1395" aria-hidden="true" tabindex="-1"></a><span class="in">    startOrStop + span &lt; 0 ? -startOrStop: span;</span></span>
<span id="cb35-1396"><a href="#cb35-1396" aria-hidden="true" tabindex="-1"></a><span class="in">  const start = span &gt; 0 ? startOrStop : startOrStop + span,</span></span>
<span id="cb35-1397"><a href="#cb35-1397" aria-hidden="true" tabindex="-1"></a><span class="in">    stop = span &gt; 0 ? startOrStop + span : startOrStop;</span></span>
<span id="cb35-1398"><a href="#cb35-1398" aria-hidden="true" tabindex="-1"></a><span class="in">  for (let i = start, c = -1, arr = []; i &lt; stop; i += splitsAndSpaces[c]) {</span></span>
<span id="cb35-1399"><a href="#cb35-1399" aria-hidden="true" tabindex="-1"></a><span class="in">    if ((c = (c + 1) % splitCount) % 2 === 0 &amp;&amp; i + splitsAndSpaces[c] &lt;= stop) {</span></span>
<span id="cb35-1400"><a href="#cb35-1400" aria-hidden="true" tabindex="-1"></a><span class="in">      if ((arr = Array.from({length: splitsAndSpaces[c]}, (_, j) =&gt; j + i).map(</span></span>
<span id="cb35-1401"><a href="#cb35-1401" aria-hidden="true" tabindex="-1"></a><span class="in">        index =&gt; self[index]).filter(item =&gt; item !== undefined)</span></span>
<span id="cb35-1402"><a href="#cb35-1402" aria-hidden="true" tabindex="-1"></a><span class="in">          ).length == splitsAndSpaces[c]) { result.push(arr) }</span></span>
<span id="cb35-1403"><a href="#cb35-1403" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb35-1404"><a href="#cb35-1404" aria-hidden="true" tabindex="-1"></a><span class="in">  };</span></span>
<span id="cb35-1405"><a href="#cb35-1405" aria-hidden="true" tabindex="-1"></a><span class="in">  return result;</span></span>
<span id="cb35-1406"><a href="#cb35-1406" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1407"><a href="#cb35-1407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1408"><a href="#cb35-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1409"><a href="#cb35-1409" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variables {.appendix}</span></span>
<span id="cb35-1410"><a href="#cb35-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1413"><a href="#cb35-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1414"><a href="#cb35-1414" aria-hidden="true" tabindex="-1"></a><span class="in">//| output: all</span></span>
<span id="cb35-1415"><a href="#cb35-1415" aria-hidden="true" tabindex="-1"></a><span class="in">nested = Array.from({length: intervals.length}, (_, i) =&gt; ([</span></span>
<span id="cb35-1416"><a href="#cb35-1416" aria-hidden="true" tabindex="-1"></a><span class="in">  {</span></span>
<span id="cb35-1417"><a href="#cb35-1417" aria-hidden="true" tabindex="-1"></a><span class="in">  label: `${i} or ${i+5}`,</span></span>
<span id="cb35-1418"><a href="#cb35-1418" aria-hidden="true" tabindex="-1"></a><span class="in">  duration: intervals[i][1] !== intervals[i][0] ? intervals[i][0] : 1,</span></span>
<span id="cb35-1419"><a href="#cb35-1419" aria-hidden="true" tabindex="-1"></a><span class="in">  group: "Rest"</span></span>
<span id="cb35-1420"><a href="#cb35-1420" aria-hidden="true" tabindex="-1"></a><span class="in">},</span></span>
<span id="cb35-1421"><a href="#cb35-1421" aria-hidden="true" tabindex="-1"></a><span class="in">  {</span></span>
<span id="cb35-1422"><a href="#cb35-1422" aria-hidden="true" tabindex="-1"></a><span class="in">  label: `${i} or ${i+5}`,</span></span>
<span id="cb35-1423"><a href="#cb35-1423" aria-hidden="true" tabindex="-1"></a><span class="in">  duration: intervals[i][1]-intervals[i][0],</span></span>
<span id="cb35-1424"><a href="#cb35-1424" aria-hidden="true" tabindex="-1"></a><span class="in">  group: "Work"</span></span>
<span id="cb35-1425"><a href="#cb35-1425" aria-hidden="true" tabindex="-1"></a><span class="in">},</span></span>
<span id="cb35-1426"><a href="#cb35-1426" aria-hidden="true" tabindex="-1"></a><span class="in">  {</span></span>
<span id="cb35-1427"><a href="#cb35-1427" aria-hidden="true" tabindex="-1"></a><span class="in">  label: `${i} or ${i+5}`,</span></span>
<span id="cb35-1428"><a href="#cb35-1428" aria-hidden="true" tabindex="-1"></a><span class="in">  duration: intervals[i][1] !== intervals[i][0] ? 1-intervals[i][1] : null,</span></span>
<span id="cb35-1429"><a href="#cb35-1429" aria-hidden="true" tabindex="-1"></a><span class="in">  group: "Rest"</span></span>
<span id="cb35-1430"><a href="#cb35-1430" aria-hidden="true" tabindex="-1"></a><span class="in">  }]))</span></span>
<span id="cb35-1431"><a href="#cb35-1431" aria-hidden="true" tabindex="-1"></a><span class="in">durations = [].concat(...nested)</span></span>
<span id="cb35-1432"><a href="#cb35-1432" aria-hidden="true" tabindex="-1"></a><span class="in">theme_Flat = `</span></span>
<span id="cb35-1433"><a href="#cb35-1433" aria-hidden="true" tabindex="-1"></a><span class="in">/* Options */</span></span>
<span id="cb35-1434"><a href="#cb35-1434" aria-hidden="true" tabindex="-1"></a><span class="in">:scope {</span></span>
<span id="cb35-1435"><a href="#cb35-1435" aria-hidden="true" tabindex="-1"></a><span class="in">  color: #3b99fc;</span></span>
<span id="cb35-1436"><a href="#cb35-1436" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 240px;</span></span>
<span id="cb35-1437"><a href="#cb35-1437" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1438"><a href="#cb35-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1439"><a href="#cb35-1439" aria-hidden="true" tabindex="-1"></a><span class="in">:scope {</span></span>
<span id="cb35-1440"><a href="#cb35-1440" aria-hidden="true" tabindex="-1"></a><span class="in">  position: relative;</span></span>
<span id="cb35-1441"><a href="#cb35-1441" aria-hidden="true" tabindex="-1"></a><span class="in">  display: inline-block;</span></span>
<span id="cb35-1442"><a href="#cb35-1442" aria-hidden="true" tabindex="-1"></a><span class="in">  --thumb-size: 15px;</span></span>
<span id="cb35-1443"><a href="#cb35-1443" aria-hidden="true" tabindex="-1"></a><span class="in">  --thumb-radius: calc(var(--thumb-size) / 2);</span></span>
<span id="cb35-1444"><a href="#cb35-1444" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: var(--thumb-radius) 0;</span></span>
<span id="cb35-1445"><a href="#cb35-1445" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: 2px;</span></span>
<span id="cb35-1446"><a href="#cb35-1446" aria-hidden="true" tabindex="-1"></a><span class="in">  vertical-align: middle;</span></span>
<span id="cb35-1447"><a href="#cb35-1447" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1448"><a href="#cb35-1448" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .range-track {</span></span>
<span id="cb35-1449"><a href="#cb35-1449" aria-hidden="true" tabindex="-1"></a><span class="in">  box-sizing: border-box;</span></span>
<span id="cb35-1450"><a href="#cb35-1450" aria-hidden="true" tabindex="-1"></a><span class="in">  position: relative;</span></span>
<span id="cb35-1451"><a href="#cb35-1451" aria-hidden="true" tabindex="-1"></a><span class="in">  height: 7px;</span></span>
<span id="cb35-1452"><a href="#cb35-1452" aria-hidden="true" tabindex="-1"></a><span class="in">  background-color: hsl(0, 0%, 80%);</span></span>
<span id="cb35-1453"><a href="#cb35-1453" aria-hidden="true" tabindex="-1"></a><span class="in">  overflow: visible;</span></span>
<span id="cb35-1454"><a href="#cb35-1454" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 4px;</span></span>
<span id="cb35-1455"><a href="#cb35-1455" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0 var(--thumb-radius);</span></span>
<span id="cb35-1456"><a href="#cb35-1456" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1457"><a href="#cb35-1457" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .range-track-zone {</span></span>
<span id="cb35-1458"><a href="#cb35-1458" aria-hidden="true" tabindex="-1"></a><span class="in">  box-sizing: border-box;</span></span>
<span id="cb35-1459"><a href="#cb35-1459" aria-hidden="true" tabindex="-1"></a><span class="in">  position: relative;</span></span>
<span id="cb35-1460"><a href="#cb35-1460" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1461"><a href="#cb35-1461" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .range-select {</span></span>
<span id="cb35-1462"><a href="#cb35-1462" aria-hidden="true" tabindex="-1"></a><span class="in">  box-sizing: border-box;</span></span>
<span id="cb35-1463"><a href="#cb35-1463" aria-hidden="true" tabindex="-1"></a><span class="in">  position: relative;</span></span>
<span id="cb35-1464"><a href="#cb35-1464" aria-hidden="true" tabindex="-1"></a><span class="in">  left: var(--range-min);</span></span>
<span id="cb35-1465"><a href="#cb35-1465" aria-hidden="true" tabindex="-1"></a><span class="in">  width: calc(var(--range-max) - var(--range-min));</span></span>
<span id="cb35-1466"><a href="#cb35-1466" aria-hidden="true" tabindex="-1"></a><span class="in">  cursor: ew-resize;</span></span>
<span id="cb35-1467"><a href="#cb35-1467" aria-hidden="true" tabindex="-1"></a><span class="in">  background: currentColor;</span></span>
<span id="cb35-1468"><a href="#cb35-1468" aria-hidden="true" tabindex="-1"></a><span class="in">  height: 7px;</span></span>
<span id="cb35-1469"><a href="#cb35-1469" aria-hidden="true" tabindex="-1"></a><span class="in">  border: inherit;</span></span>
<span id="cb35-1470"><a href="#cb35-1470" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1471"><a href="#cb35-1471" aria-hidden="true" tabindex="-1"></a><span class="in">/* Expands the hotspot area. */</span></span>
<span id="cb35-1472"><a href="#cb35-1472" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .range-select:before {</span></span>
<span id="cb35-1473"><a href="#cb35-1473" aria-hidden="true" tabindex="-1"></a><span class="in">  content: "";</span></span>
<span id="cb35-1474"><a href="#cb35-1474" aria-hidden="true" tabindex="-1"></a><span class="in">  position: absolute;</span></span>
<span id="cb35-1475"><a href="#cb35-1475" aria-hidden="true" tabindex="-1"></a><span class="in">  width: 100%;</span></span>
<span id="cb35-1476"><a href="#cb35-1476" aria-hidden="true" tabindex="-1"></a><span class="in">  height: var(--thumb-size);</span></span>
<span id="cb35-1477"><a href="#cb35-1477" aria-hidden="true" tabindex="-1"></a><span class="in">  left: 0;</span></span>
<span id="cb35-1478"><a href="#cb35-1478" aria-hidden="true" tabindex="-1"></a><span class="in">  top: calc(2px - var(--thumb-radius));</span></span>
<span id="cb35-1479"><a href="#cb35-1479" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1480"><a href="#cb35-1480" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .range-select:focus,</span></span>
<span id="cb35-1481"><a href="#cb35-1481" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .thumb:focus {</span></span>
<span id="cb35-1482"><a href="#cb35-1482" aria-hidden="true" tabindex="-1"></a><span class="in">  outline: none;</span></span>
<span id="cb35-1483"><a href="#cb35-1483" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1484"><a href="#cb35-1484" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .thumb {</span></span>
<span id="cb35-1485"><a href="#cb35-1485" aria-hidden="true" tabindex="-1"></a><span class="in">  box-sizing: border-box;</span></span>
<span id="cb35-1486"><a href="#cb35-1486" aria-hidden="true" tabindex="-1"></a><span class="in">  position: absolute;</span></span>
<span id="cb35-1487"><a href="#cb35-1487" aria-hidden="true" tabindex="-1"></a><span class="in">  width: var(--thumb-size);</span></span>
<span id="cb35-1488"><a href="#cb35-1488" aria-hidden="true" tabindex="-1"></a><span class="in">  height: var(--thumb-size);</span></span>
<span id="cb35-1489"><a href="#cb35-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1490"><a href="#cb35-1490" aria-hidden="true" tabindex="-1"></a><span class="in">  background: #fcfcfc;</span></span>
<span id="cb35-1491"><a href="#cb35-1491" aria-hidden="true" tabindex="-1"></a><span class="in">  top: -4px;</span></span>
<span id="cb35-1492"><a href="#cb35-1492" aria-hidden="true" tabindex="-1"></a><span class="in">  border-radius: 100%;</span></span>
<span id="cb35-1493"><a href="#cb35-1493" aria-hidden="true" tabindex="-1"></a><span class="in">  border: 1px solid hsl(0,0%,55%);</span></span>
<span id="cb35-1494"><a href="#cb35-1494" aria-hidden="true" tabindex="-1"></a><span class="in">  cursor: default;</span></span>
<span id="cb35-1495"><a href="#cb35-1495" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: 0;</span></span>
<span id="cb35-1496"><a href="#cb35-1496" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1497"><a href="#cb35-1497" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .thumb:active {</span></span>
<span id="cb35-1498"><a href="#cb35-1498" aria-hidden="true" tabindex="-1"></a><span class="in">  box-shadow: inset 0 var(--thumb-size) #0002;</span></span>
<span id="cb35-1499"><a href="#cb35-1499" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1500"><a href="#cb35-1500" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .thumb-min {</span></span>
<span id="cb35-1501"><a href="#cb35-1501" aria-hidden="true" tabindex="-1"></a><span class="in">  left: calc(-1px - var(--thumb-radius));</span></span>
<span id="cb35-1502"><a href="#cb35-1502" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1503"><a href="#cb35-1503" aria-hidden="true" tabindex="-1"></a><span class="in">:scope .thumb-max {</span></span>
<span id="cb35-1504"><a href="#cb35-1504" aria-hidden="true" tabindex="-1"></a><span class="in">  right: calc(-1px - var(--thumb-radius));</span></span>
<span id="cb35-1505"><a href="#cb35-1505" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1506"><a href="#cb35-1506" aria-hidden="true" tabindex="-1"></a><span class="in">`</span></span>
<span id="cb35-1507"><a href="#cb35-1507" aria-hidden="true" tabindex="-1"></a><span class="in">schedules = [</span></span>
<span id="cb35-1508"><a href="#cb35-1508" aria-hidden="true" tabindex="-1"></a><span class="in">  [[.2, .8], [.2, .8], [0, 0], [0, 0], [0, 0]],</span></span>
<span id="cb35-1509"><a href="#cb35-1509" aria-hidden="true" tabindex="-1"></a><span class="in">  [[.3, .7], [.3, .7], [.3, .7], [0, 0], [0, 0]],</span></span>
<span id="cb35-1510"><a href="#cb35-1510" aria-hidden="true" tabindex="-1"></a><span class="in">  [[.35, .65], [.35, .65], [.35, .65], [.35, .65], [0, 0]],</span></span>
<span id="cb35-1511"><a href="#cb35-1511" aria-hidden="true" tabindex="-1"></a><span class="in">  [[.38, .62], [.38, .62], [.38, .62], [.38, .62], [.38, .62]],</span></span>
<span id="cb35-1512"><a href="#cb35-1512" aria-hidden="true" tabindex="-1"></a><span class="in">]</span></span>
<span id="cb35-1513"><a href="#cb35-1513" aria-hidden="true" tabindex="-1"></a><span class="in">dates = Array.from({length: 366}, (_, i) =&gt; i.toString().padStart(3, "0"))</span></span>
<span id="cb35-1514"><a href="#cb35-1514" aria-hidden="true" tabindex="-1"></a><span class="in">sliceArray = slice(dates, ...sliceString.split(":").map(i =&gt; i === "" ? null : Number(i)))</span></span>
<span id="cb35-1515"><a href="#cb35-1515" aria-hidden="true" tabindex="-1"></a><span class="in">spreadArray = [].concat(...spread(dates, ...decodeSpread(spreadString)))</span></span>
<span id="cb35-1516"><a href="#cb35-1516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1517"><a href="#cb35-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1518"><a href="#cb35-1518" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Set values {.appendix}</span></span>
<span id="cb35-1519"><a href="#cb35-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1522"><a href="#cb35-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1523"><a href="#cb35-1523" aria-hidden="true" tabindex="-1"></a><span class="in">//| output: false</span></span>
<span id="cb35-1524"><a href="#cb35-1524" aria-hidden="true" tabindex="-1"></a><span class="in">set(viewof intervals, schedules[schedule-2])</span></span>
<span id="cb35-1525"><a href="#cb35-1525" aria-hidden="true" tabindex="-1"></a><span class="in">set(viewof spreadString, setSpreadDotd(spreadDotd))</span></span>
<span id="cb35-1526"><a href="#cb35-1526" aria-hidden="true" tabindex="-1"></a><span class="in">set(viewof sliceString, setSliceDotd(sliceDotd))</span></span>
<span id="cb35-1527"><a href="#cb35-1527" aria-hidden="true" tabindex="-1"></a><span class="in">{</span></span>
<span id="cb35-1528"><a href="#cb35-1528" aria-hidden="true" tabindex="-1"></a><span class="in">  if (invertDotd ? !sliceOrSpread : sliceOrSpread) {</span></span>
<span id="cb35-1529"><a href="#cb35-1529" aria-hidden="true" tabindex="-1"></a><span class="in">    set(viewof sliceDotd, invert(togglePlot))</span></span>
<span id="cb35-1530"><a href="#cb35-1530" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb35-1531"><a href="#cb35-1531" aria-hidden="true" tabindex="-1"></a><span class="in">    set(viewof spreadDotd, invert(togglePlot))</span></span>
<span id="cb35-1532"><a href="#cb35-1532" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb35-1533"><a href="#cb35-1533" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1534"><a href="#cb35-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1535"><a href="#cb35-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-1536"><a href="#cb35-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1537"><a href="#cb35-1537" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb35-1538"><a href="#cb35-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1539"><a href="#cb35-1539" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb35-1540"><a href="#cb35-1540" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-1541"><a href="#cb35-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1542"><a href="#cb35-1542" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendix {#appendix}</span></span>
<span id="cb35-1543"><a href="#cb35-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1544"><a href="#cb35-1544" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb35-1545"><a href="#cb35-1545" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;script src="../../time.js"&gt;&lt;/script&gt;</span></span>
<span id="cb35-1546"><a href="#cb35-1546" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb35-1547"><a href="#cb35-1547" aria-hidden="true" tabindex="-1"></a><span class="in">#title-block-header &gt; div.quarto-title-banner.page-columns.page-full {</span></span>
<span id="cb35-1548"><a href="#cb35-1548" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: 0px;</span></span>
<span id="cb35-1549"><a href="#cb35-1549" aria-hidden="true" tabindex="-1"></a><span class="in">  padding: 0px;</span></span>
<span id="cb35-1550"><a href="#cb35-1550" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1551"><a href="#cb35-1551" aria-hidden="true" tabindex="-1"></a><span class="in">main#quarto-document-content {</span></span>
<span id="cb35-1552"><a href="#cb35-1552" aria-hidden="true" tabindex="-1"></a><span class="in">    margin: 0px;</span></span>
<span id="cb35-1553"><a href="#cb35-1553" aria-hidden="true" tabindex="-1"></a><span class="in">    padding: 0px;</span></span>
<span id="cb35-1554"><a href="#cb35-1554" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1555"><a href="#cb35-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1556"><a href="#cb35-1556" aria-hidden="true" tabindex="-1"></a><span class="in">header#title-block-header {</span></span>
<span id="cb35-1557"><a href="#cb35-1557" aria-hidden="true" tabindex="-1"></a><span class="in">  margin: 0px;</span></span>
<span id="cb35-1558"><a href="#cb35-1558" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb35-1559"><a href="#cb35-1559" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb35-1560"><a href="#cb35-1560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>