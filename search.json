[
  {
    "objectID": "software/observable/index.html",
    "href": "software/observable/index.html",
    "title": "Observable",
    "section": "",
    "text": "The goal of this blog post, the fourth in my Tools blog post series, is to set up the Visual Studio Code (VSCode) source-code editor to run in the remote development environments provided by the Codespaces and GitPod computing platforms. To accomplish this goal, we will use VSCode to edit a setup script and configuration files in a Git repository (repo) named dotfiles.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style D stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart",
    "crumbs": [
      "Software",
      "Observable"
    ]
  },
  {
    "objectID": "software/observable/index.html#tldr",
    "href": "software/observable/index.html#tldr",
    "title": "Observable",
    "section": "",
    "text": "The goal of this blog post, the fourth in my Tools blog post series, is to set up the Visual Studio Code (VSCode) source-code editor to run in the remote development environments provided by the Codespaces and GitPod computing platforms. To accomplish this goal, we will use VSCode to edit a setup script and configuration files in a Git repository (repo) named dotfiles.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style D stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart",
    "crumbs": [
      "Software",
      "Observable"
    ]
  },
  {
    "objectID": "software/observable/index.html#sec-intro",
    "href": "software/observable/index.html#sec-intro",
    "title": "Observable",
    "section": "Introduction",
    "text": "Introduction\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Observable"
    ]
  },
  {
    "objectID": "software/observable/index.html#sec-intro-doty",
    "href": "software/observable/index.html#sec-intro-doty",
    "title": "Observable",
    "section": "Day-of-the-year",
    "text": "Day-of-the-year\nDecalendar1 is a decimal calendarüóìÔ∏èsystem and Declock2 is a decimal timekeeping‚è≥system. Instead of months, weeks, hours, minutes, and seconds, Decalendar and Declock use a number called the day-of-the-year (doty)3. Figure¬†2 displays the current doty () as a bar chart. The integer part of the doty is the Decalendar date4 () and the fractional part is the Declock time5 ().\nThe top two bars in Figure¬†2 (Êó¨ and Êó•) show the two components of the Decalendar date (): the dek6 () and the day-of-the-dek7 (). A dek is a group of 10 days that fulfills the role of months and weeks in Decalendar. Therefore, the dek and the day-of-the-dek (dotd) in Decalendar dates are analogous to the month and day-of-the-month (dotm) in calendar dates (mm-dd) and the week and day-of-the-week (dotw) in week dates (Www-d).\nThe bottom three bars in Figure¬†2 (%, ‚Ä∞, and ‚ô´) show components of the Declock time (): cents8 (), mils9 (), and beats10 (). A cent is 1% of the day, which is a little less than a quarter hour. A mil (‚Ä∞) is a tenth of a cent, which is close to a minute and a half. A beat is 1% of a mil, which is almost as long as a second, and can be thought of as a heart‚ù§Ô∏èbeat or musicalüéµbeat with a constant rate or tempo of 69.4ÃÖ beats per minute. In addition to displaying time on clocksüï∞Ô∏èand‚åöÔ∏èwatches, beats can be used to measure durations, such as the time since this webpage was loaded: .\n\n// https://observablehq.com/@fheyen/barchart-clock\n{\nconst W = width &gt; 1250 ? width * 2 / 3 : width &gt; 1150 ? width * 3 / 4 : width &gt; 1050 ? width * 4 / 5 : width &gt; 950 ? width * 5 / 6 : width &gt; 850 ? width : width &gt; 750 ? width * 1.02 : width &gt; 650 ? width * 1.06 : width &gt; 550 ? width * 1.1 : width &gt; 450 ? width * 1.14 : width * 1.18;\n  const H = 156;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W, H]);\n  const xRange = [0, W - 100];\n  const scaleM = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleCandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  const scaleDek = d3.scaleLinear()\n    .domain([0, 37])\n    .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data(['dek', 'dotd', 'cents', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=&gt;i*30+firstBarY)\n  // Dek/Dotd\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDek(Number(dotyDek)+Number(dotyDotd)/10+Number(barCents)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDek(dotyDek))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleM(Number(dotyDotd)+Number(barCents)/100+Number(barMils)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleM(dotyDotd))\n  svg.selectAll('.tickDek')\n    .data(d3.range(width &gt; 500 ? 4: 6, 37))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickDek')\n    .attr('x', d=&gt;scaleDek(d)+barX)\n    .attr('y', firstBarY)\n    .attr('height', d=&gt;d%(width &gt; 500 ? 2 : 3)===0? 6:4)\n  // Cent ticks\n  svg.selectAll('.tickDotd')\n    .data(d3.range(width &gt; 500 ? 1: 2, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickDotd')\n    .attr('x', d=&gt;scaleM(d)+barX)\n    .attr('y', firstBarY+49)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel')\n    .data(d3.range(width &gt; 500 ? 4: 6, width &gt; 500 ? 37: 35, width &gt; 500 ? 2: 3))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel')\n    .attr('x', d=&gt;scaleDek(d)+barX+.5)\n    .attr('y', firstBarY+22)\n    .text(d=&gt;d)\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleCandB(Number(barCents)+Number(barMils)/10+Number(barBeats)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleCandB(barCents))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+90)\n    .attr('width', d =&gt; scaleM(Number(barMils)+Number(barBeats)/100+Number(barMb)/100000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+90)\n    .attr('width', d =&gt; scaleM(barMils))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width &gt; 500 ? 10 : 20, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=&gt;scaleM(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width &gt; 500 ? 10 : 20, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=&gt;scaleM(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width &gt; 500 ? 1 : 2, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=&gt;scaleM(d)+barX)\n    .attr('y', firstBarY+90)\n    .attr('height', 6)\n  svg.selectAll('.tickM1')\n    .data(d3.range(width &gt; 500 ? 1 : 2, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM1')\n    .attr('x', d=&gt;scaleM(d)+barX)\n    .attr('y', firstBarY+92.5)\n    .attr('height', 2.5)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width &gt; 500 ? 1 : 2, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=&gt;scaleM(d)+barX+.5)\n    .attr('y', firstBarY+47)\n    .text(d=&gt;d)\n  svg.selectAll('.tickLabel2')\n    .data(d3.range(width &gt; 500 ? 1 : 2, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel2')\n    .attr('x', d=&gt;scaleM(d)+barX+.5)\n    .attr('y', firstBarY+112)\n    .text(d=&gt;d)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+120)\n    .attr('width', d =&gt; scaleCandB(Number(barBeats)+Number(barMb)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+120)\n    .attr('width', d =&gt; scaleCandB(barBeats))\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width &gt; 500 ? 10 : 20, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=&gt;scaleM(d/10)+barX)\n    .attr('y', firstBarY+120)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`${dotyDek}Êó¨`, `${dotyDotd}Êó•`, `${barCents}%`, `${barMils}‚Ä∞`, `${barBeats}‚ô´`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=&gt;i*30+firstBarY+20)\n    .text(d=&gt;d)\n  return svg.node();\n}\n\n\n\n\n\n\n\n\nFigure¬†2: Doty bar chart\n\n\n\n\n\nhtml`&lt;style&gt;\n  .tickLabel, .tickLabel1, .tickLabel2, .timeLabel {\n    fill: #000;\n    font-family: sans-serif;\n    font-size: 20px;\n    text-anchor: middle;\n  }\n  .timeLabel {\n    text-anchor: start;\n  }\n  .timeBar, .timeBarFull {\n    x: 1px;\n    height: 25px;\n    rx: 5px;\n    stroke: #aaa;\n  }\n  .timeBar {\n    fill: #e8e8e8;\n  }\n  .timeBarFull {\n    fill: #ccffff;\n  }\n  .background {\n    fill: white;\n  }\n  .tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB {\n    stroke: none;\n    fill: #666;\n    width: 1px;\n  }\n&lt;/style&gt;`\n\n\n\n\n\n\nAs an alternative to doty dates, Decalendar can express dates in fractional years, which are similar to the fractional days used in doty times. Fractional year dates11 can be combined with years into one number and are useful for marking periods of 73 days in the Decalendar year. Every 73 days, the Decalendar fractional year date increases by .2 (‚Öï). The current Decalendar fractional year date is .\nNow it‚Äôs your turn! Move the slidersüéöÔ∏èin Example¬†1 to adjust the doty, fractional year, month, and dotm values and see the corresponding 1) Northern Hemisphere season, 2) Southern Hemisphere season, and 3) Zodiac sign in ../../List¬†1. Try selecting a special date, like your birthdayüéÇ! You can also press the Play‚ñ∂Ô∏èbutton and then sit back and watch the sliders cycleüîÑback and forth from the start to the end of the Decalendar year. The sliders cycle through an entire year in 36.5 beats, a million times fasterüèéÔ∏èthan the actual speed of time!\n\nExample 1 ¬†\n\n\n\nviewof inputDoty = Inputs.range([0, 365], {value: 306, step: 1, label: \"doty\"});\n\nviewof year = transformInput(\n    Inputs.range([0, .999], {step: .001, label: \"year\"}),\n    {bind: viewof inputDoty, transform: (x =&gt; x / 365), invert: (x =&gt; x * 365)}\n);\n\nviewof monthInput = transformInput(\n    Inputs.range([1, 12], {step: 1, label: \"month\"}),\n    {bind: viewof inputDoty, transform: doty2month, invert: month2doty}\n);\n\nviewof dotmInput = transformInput(\n    Inputs.range([1, 31], {step: 1, label: \"dotm\"}),\n    {bind: viewof inputDoty, transform: doty2dotm, invert: (x =&gt; Math.floor(( 153 * (\n        viewof monthInput.value &gt; 2\n        ? viewof monthInput.value - 3\n        : viewof monthInput.value + 9) + 2\n    ) / 5 + x - 1\n))});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof scrubberDoty = Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864})\n\n\n\n\n\n\n\n\n\n\n\n\n\n../../List¬†1: Date to season conversion",
    "crumbs": [
      "Software",
      "Observable"
    ]
  },
  {
    "objectID": "software/observable/index.html#sec-intro-year",
    "href": "software/observable/index.html#sec-intro-year",
    "title": "Observable",
    "section": "Year",
    "text": "Year\nDoty dates (day) and timestamps (day.stamp) do not include years and thus can be reused from year to year. When a doty is combined with a year, it forms a Decalendar ordinal12 (deco) and represents a specific date (year+day) or time (year+day.stamp) in a specific year, instead of a date (day) or time (day.stamp) that occurs every year or every leap year. Using the Observable datetime input in Example¬†2, you can select a year, month, dotm, hour, and minute to see the equivalent 1) deco timestamp (year+day.clock) and 2) year date (year.yyy) in ../../List¬†2. For comparison, the current deco timestamp is .\n\nExample 2 ¬†\n\n\n\nviewof inputDatetime = Inputs.datetime({label: \"date\", value: \"1970-01-01T00:00\"})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n../../List¬†2: Date and time conversion\n\n\n\n\nIn Example¬†3, you can enter numeric year and doty values or type in a free-form deco to see the resulting 1) ISO 8601 timestamp (year-mm-ddThh:mm:ss) and 2) year date in ../../List¬†3. Example¬†3 also has a Play‚ñ∂Ô∏èbutton in that cycles from Day 0 to Day 365 of Year 1969. The cycle goes up to Day 0 of Year 1970, because Year 1969 is a common year and does not have a Day 365.\nInteracting with the number inputs in Example¬†3, standardizes the deco in the text input to ensure years are integers and doty values are positive numbers below 366. Nevertheless, all of the inputs in Example¬†3 support negative and fractional year and doty values. Negative doty values shift dates backward in time from the start of a given year into a previous year. Similarly, negative years shift dates backward starting from Year 0, which is 1 BCE (Before the Common Era).\n\nExample 3 ¬†\n\n\n\nviewof yd = Inputs.form([\n  Inputs.number({label: \"year\", value: \"1969\"}),\n  Inputs.number({label: \"doty\", value: \"306\"})\n])\n\n\n\n\n\n\n\nviewof decoOutput = transformInput(\n  Inputs.text({label: \"deco\", placeholder: \"year+day.ddd\", value: \"1969+306\"}),\n  {bind: viewof yd, transform: doty2deco, invert: deco2doty});\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof scrubberDeco = Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n../../List¬†3: Deco timestamp conversion",
    "crumbs": [
      "Software",
      "Observable"
    ]
  },
  {
    "objectID": "software/observable/index.html#sec-intro-dek",
    "href": "software/observable/index.html#sec-intro-dek",
    "title": "Observable",
    "section": "Dek",
    "text": "Dek\nAs mentioned in Section¬†0.3, deks function as both months and weeks in Decalendar. A dek consists of 2 groups of 5 days called pents13. Each pent can follow a sequence of workdays and restdays called a pently schedule14. fig-schedules compares the typical weekly schedule and the Schedule 3 pently schedule. Like other pently schedules, Schedule 3 is named after the number of workdays it contains. The 3 workdays in Schedule 3 are followed by a 2-day pentend, the Decalender equivalent of a weekend.\nUnlike Schedule 3 and the other pently schedules, the weekly schedule is asymmetric and divides up workdays into proportions that are easier to express as fractions: 3/8 (.375), 1/3 (.3ÃÖ), and 7/24 (0.2916ÃÖ). In contrast, pently schedules divides each workday into simple, symmetrical proportions that are never repeating decimal numbers. The Schedule 3 workday is longer the typical 9-to-5, but the longer workday is compensated by more frequent restdays.\nExample¬†4 provides the opportunity to explore all four of the pently schedules. Schedule 3 is the default pently schedule, and should be followed unless there is a compelling reason to do otherwise. Despite having different numbers of workdays, all pently schedules keep the amount of spent at work constant at 1.2 days (120 cents) per pent. Every pently schedule also splits up workdays symmetrically so that the time before work is equal to the time after work. You can select which schedule to view in Example¬†4 using the Observable radio inputs.\nYou can also use the interval sliders to create a custom schedule and the Download‚¨áÔ∏èbutton to obtain the schedule data. Each interval is summarized by a Declock slice shown next to its slider. Decalendar and Declock slices are inspired by array slicing in computer programming and are used to represent date and time intervals. The slice that summarizes the Schedule 3 workday is .3:.7, where .3 (7.2 hours) is the start and .7 (16.8 hours) is the stop.\n\nExample 4 ¬†\n\n\n\nviewof intervals = Inputs.form([\n  interval([0, 1], {step: .01, value: [.3, .7], label: '0 or 5', width: 250, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '1 or 6', width: 250, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '2 or 7', width: 250, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '3 or 8', width: 250, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '4 or 9', width: 250, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}:${formatDecimal(end)}`}),\n])\n\n\n\n\n\n\n\n\n\nviewof schedule = Inputs.radio([2, 3, 4, 5], {label: \"sched.\", value: 3})\n\nviewof filename = Inputs.text({label: \"name\", placeholder: \"Enter the filename\", value: `schedule${schedule}.csv`})\n\nbutton(durations, filename)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// https://observablehq.com/@dec/pent\nPlot.plot({\n  className: \"schedule-explorer\",\n  x: {label: null},\n  color: {scheme: \"Set1\", legend: \"swatches\", reverse: true},\n  y: {label: null, domain: [1, 0]},\n  marks: [\n  Plot.barY(durations, {x: \"label\", y: \"duration\", fill: \"group\"}),\n  Plot.textY(\n      durations,\n      Plot.stackY(\n        Plot.groupX(\n          { y: \"first\", text: \"first\" },\n          {\n            x: \"label\",\n            z: \"group\",\n            y: \"duration\",\n            text: (d) =&gt; (d.duration &lt; .0001 ? null : formatDecimal(d.duration)),\n            fill: \"white\",\n            stroke: \"black\",\n            fontSize: 36,\n          }\n        )\n      )\n    ),\n  ]})\n\n\n\n\n\n\n\n\nFigure¬†3: Pently schedule explorer\n\n\n\n\n\nSlices can be used to select Declock time intervals, as in Example¬†4 above, or Decalendar date intervals, as in Example¬†5 below. Decalendar date intervals can represent events take place over multiple days. In addition to slices, Decalendar and Declock intervals can also be chosen using spreads. Use the Observable button and checkbox inputs in Example¬†5 to display different dotd combinations in Figure¬†4. Figure¬†4 shows dates selected by a slice in blue, dates selected by a spread in orange, dates selected by both in green, and dates selected by neither in gray.\nThe Example¬†5 button and checkbox inputs will modify the associated slice and spread text and numeric inputs as needed to select the desired days-of-the-dek. The numeric inputs for slices are the startüé¨index, the stopüõëindex, and the stepüë£size, which are separated by colons (start:stop:step) when combined into a slice. Similarly, the numeric inputs for spreads are the startüé¨orüõëstop index, the spanü™Ωsize, the split size, and the space size, which are typically delimited by greater-than signs (start&gt;span&gt;split&gt;space) or a mix of greater-than and less-than signs (stop&lt;span&gt;split&gt;space).\nThe numeric inputs in Example¬†5 cannot capture the full power of spreads and slices, because slices can have any number of steps and, likewise, spreads can have any number of alternating split and space sizes. We can select all even or odd days-of-the-dek using a slice with a single step (::2 or 1::2) or a spread with one split-space pair (&gt;&gt;&gt;1 or 1&gt;&gt;&gt;1). More complex patterns, such as prime or composite days-of-the-dek, require multiple step sizes for slices (2:::2:2:5 or 4::2:2::5) or multiple split-space pairs (2&gt;&gt;2&gt;1&gt;&gt;1&gt;&gt;4 or 4&gt;&gt;&gt;1&gt;&gt;1&gt;2&gt;4).\n\nExample 5 ¬†\n\nviewof sliceDotd = Inputs.checkbox([...Array(10).keys()], {label: \"slice\", value: [1, 6]})\n\n\n\n\n\n\n\nviewof spreadDotd = Inputs.checkbox([...Array(10).keys()], {label: \"spread\", value: [1, 6]})\n\n\n\n\n\n\n\nviewof togglePlot = Inputs.button([\n  [invertDotd ? \"None\" : \"All\", value =&gt; [...Array(10).keys()]],\n  [invertDotd ? \"Even\" : \"Odd\", value =&gt; [1, 3, 5, 7, 9]],\n  [invertDotd ? html`&lt;s&gt;Prime&lt;/s&gt;` : \"Prime\", value =&gt; [2, 3, 5, 7]],\n  [invertDotd ? html`&lt;s&gt;Composite&lt;/s&gt;` : \"Composite\", value =&gt; [4, 6, 8, 9]],\n  [invertDotd ? html`&lt;s&gt;Schedule2&lt;/s&gt;` : \"Schedule2\", value =&gt; [0, 1, 5, 6]],\n  [invertDotd ? html`&lt;s&gt;Schedule3&lt;/s&gt;` : \"Schedule3\", value =&gt; [0, 1, 2, 5, 6, 7]],\n  [invertDotd ? html`&lt;s&gt;Schedule4&lt;/s&gt;` : \"Schedule4\", value =&gt; [0, 1, 2, 3, 5, 6, 7, 8]],\n], {value: [], label: \"select\"})\n\n\n\n\n\n\n\n\n\nviewof invertDotd = Inputs.toggle({label: \"invert\"})\nviewof sliceOrSpread = toggleSwitch({textOn: invertDotd ? \"Spread\" : 'Slice' , textOff: invertDotd ? \"Slice\" : 'Spread'})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof sliceInputs = Inputs.form([\n    Inputs.number([-366, 366], {step: 1, label: \"start\", value: 1, placeholder: \"Enter start index\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"stop\", value: 366, placeholder: \"Enter stop index\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"step\", value: 5, placeholder: \"Enter step size\"}),\n])\nviewof sliceString = transformInput(\n  Inputs.text({label: \"slice\", placeholder: \"Enter slice string\", value: \"0:366\"}),\n{bind: viewof sliceInputs, transform: encodeSlice, invert: decodeSlice});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof spreadInputs = Inputs.form([\n    Inputs.number([-366, 366], {step: 1, label: \"start\", value: 0, placeholder: \"Enter start index\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"span\", value: 366, placeholder: \"Enter span size\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"split\", value: 3, placeholder: \"Enter split size\"}),\n    Inputs.number([-366, 366], {step: 1, label: \"space\", value: 2, placeholder: \"Enter space size\"}),\n])\nviewof spreadString = transformInput(\n  Inputs.text({label: \"spread\", placeholder: \"Enter spread string\", value: \"0&gt;366&gt;3&gt;2\"}),\n{bind: viewof spreadInputs, transform: encodeSpread, invert: decodeSpread});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// https://observablehq.com/@dec/dotd\nPlot.plot({\n  className: \"date-selector\",\n  padding: 0,\n  x: {axis: \"top\", label: null, type: \"band\"},\n  y: {label: null, type: \"band\"},\n  marks: [\n    Plot.cell(dates, {x: d =&gt; d[2], y: d =&gt; d.slice(0, 2), fill: d =&gt;\n      sliceArray.includes(d) && spreadArray.includes(d) ? \"green\" :\n      sliceArray.includes(d) && !spreadArray.includes(d) ? \"blue\" :\n      !sliceArray.includes(d) && spreadArray.includes(d) ? \"orange\" : \"grey\",\n      inset: 0.5}),\n    Plot.text(dates, {\n    x: d =&gt; d[2],\n    y: d =&gt; d.slice(0, 2),\n    fill: \"white\",\n    stroke: \"black\",\n    fontSize: 20})\n  ]\n})\n\n\n\n\n\n\n\n\nFigure¬†4: Decalendar date selector",
    "crumbs": [
      "Software",
      "Observable"
    ]
  },
  {
    "objectID": "software/observable/index.html#footnotes",
    "href": "software/observable/index.html#footnotes",
    "title": "Observable",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nDecalendar: a calendar system that uses deks instead of months and weeks‚Ü©Ô∏é\nDeclock: a timekeeping system that uses fractional days instead of hours, minutes, and seconds‚Ü©Ô∏é\ndoty: day-of-the-year; an alternative to months, weeks, hours, minutes, and seconds‚Ü©Ô∏é\ndoty date: the integer part of the doty; an alternate to calendar dates and week dates‚Ü©Ô∏é\ndoty time: the fractional part of the doty; an alternate to hours, minutes and seconds‚Ü©Ô∏é\ndek: a group of 10 days; the first two digits of the Decalendar date; an alternate to month and weeks‚Ü©Ô∏é\ndotd: one of the 10 days in a dek; the last digit of the Decalendar date; an alternate to the day-of-the-month and day-of-the-week‚Ü©Ô∏é\ncent: a hundredth (\\(10^{-2}\\)) of a day; the first 2 digits of the doty time; an alternate to quarter hours‚Ü©Ô∏é\nmil: a thousandth (\\(10^{-3}\\)) of a day; the first 3 digits of the doty time; an alternate to minutes‚Ü©Ô∏é\nbeat: a hundred thousandth (\\(10^{-5}\\)) of a day; the first 5 digits of the doty time; an alternate to seconds‚Ü©Ô∏é\nfractional year date: a year and the proportion of that year that has passed; an alternative to Decalendar dates‚Ü©Ô∏é\ndeco: a date and time format consisting of a year and a doty; analogous to ISO 8601 dates‚Ü©Ô∏é\npent: a group of 5 days; half of a dek‚Ü©Ô∏é\npently schedule: one of a set of workday and restday schedules for the 5 days of the pent‚Ü©Ô∏é",
    "crumbs": [
      "Software",
      "Observable"
    ]
  },
  {
    "objectID": "dec/iso/index.html",
    "href": "dec/iso/index.html",
    "title": "Date",
    "section": "",
    "text": "My website serves as a demonstration of both the Quarto publishing system and the Dec measurement system. I use several clever hacks to get Quarto to display all of the dates on my website in the Dec year+day format. Knowing the basics of Dec dates will help you to understand the Quarto filter, render script, and include file examples in my Quarto article.\nThe year+day format is based on the Dec date equation: \\(\\lfloor\\colorbox{yellow}{y}\\rfloor{+}\\colorbox{cyan}{d}{\\div}\\colorbox{orange}{n}{=}\\colorbox{yellow}{y}\\), where \\(\\lfloor\\colorbox{yellow}{y}\\rfloor{+}\\colorbox{cyan}{d}\\) is the Dec date, \\(\\lfloor\\colorbox{yellow}{y}\\rfloor\\) is the year obtained by flooring \\(\\colorbox{yellow}{y}\\), the decimal years that have passed since the Dec epoch (Year 0 Day 0 Dot 0), \\(\\colorbox{cyan}{d}\\) is the zero-based day of the year, and \\(\\colorbox{orange}{n}\\) is the number of days in \\(\\lfloor\\colorbox{yellow}{y}\\rfloor\\). The Dec date equation for today is .\nDec dates only include the first two terms from the left-hand side of the Dec date equation: \\(\\lfloor\\colorbox{yellow}{y}\\rfloor\\) and \\(\\colorbox{cyan}{d}\\). The right-hand side of the equation, \\(\\colorbox{yellow}{y}\\), can also be used as a date. We need \\(\\colorbox{orange}{n}\\) to calculate \\(\\colorbox{yellow}{y}\\) via the Dec date equation above and to obtain \\(\\colorbox{cyan}{d}\\) using the Dec day of the year equation: \\(\\colorbox{cyan}{d}{=}\\colorbox{yellow}{y}\\vcenter{\\text{\\%}}1{\\times}\\colorbox{orange}{n}\\). In simple terms, \\(\\colorbox{cyan}{d}\\) is the decimal part of \\(\\colorbox{yellow}{y}\\) multiplied by \\(\\colorbox{orange}{n}\\).\nTo find \\(\\colorbox{orange}{n}\\), we plug \\(\\lfloor\\colorbox{yellow}{y}\\rfloor\\) into the Dec year length equation below, where \\(\\vcenter{\\text\\%}\\) is the modulo operator, \\(\\land\\) is the logical conjunction operator (and), and \\(\\lor\\) is the logical disjunction operator (or). According to this equation, \\(\\colorbox{orange}{n}\\) is 366 if the subsequent year (Year \\(\\lfloor\\colorbox{yellow}{y}\\rfloor{+}1\\)) is a Gregorian calendar leap year and 365 if Year \\(\\lfloor\\colorbox{yellow}{y}\\rfloor{+}1\\) is a Gregorian calendar common year.\n\\[\\colorbox{orange}{n}=\\begin{cases}\n  366&{\\begin{align}\\text{if } (\\lfloor \\colorbox{yellow}{y}\\rfloor+1)\\vcenter{\\text{ \\% }}4=0\\\\\n  \\land(\\lfloor \\colorbox{yellow}{y}\\rfloor+1)\\vcenter{\\text{ \\% }}100\\neq0\\\\\n  \\lor(\\lfloor \\colorbox{yellow}{y}\\rfloor+1)\\vcenter{\\text{ \\% }}400=0\\end{align}}\\\\\\\\\n  365&{\\text{otherwise.}}\\end{cases}\\]\nIn addition to calculating \\(\\colorbox{yellow}{y}\\), \\(\\colorbox{orange}{n}\\) is needed to convert between year+day and year-day Dec dates. The year-day version of the Dec date equation is \\(\\lfloor\\colorbox{yellow}{y}\\rfloor{+}1{-}(\\colorbox{orange}{n}{-}\\colorbox{cyan}{d}){\\div}\\colorbox{orange}{n}{=}\\colorbox{yellow}{y}\\). In essence, \\(\\colorbox{orange}{n}{-}\\colorbox{cyan}{d}\\) is a ‚ÄúT-minus‚Äù countdown of the days until the start of Year \\(\\lfloor\\colorbox{yellow}{y}\\rfloor{+}1\\). The current year-day date, , tells us that Year  will begin in  days.\nThe difference between \\(\\colorbox{cyan}{d}\\) and \\(\\colorbox{orange}{n}{-}\\colorbox{cyan}{d}\\) can also be explained in terms of computer programming. If we think of years as arrays, \\(\\colorbox{cyan}{d}\\) and \\(\\colorbox{orange}{n}{-}\\colorbox{cyan}{d}\\) are like array indexes that can be used to identify array elements or combine them via slicing. In this analogy, \\(\\colorbox{cyan}{d}\\) is a positive index with a range of \\(0\\) to \\(\\colorbox{orange}{n}{-}1\\) and \\(\\colorbox{orange}{n}{-}\\colorbox{cyan}{d}\\) is a negative index that ranges from \\({-}\\colorbox{orange}{n}\\) to \\({-}1\\).\nTo extend the array index analogy, imagine that we can use a single number to look up all of the required information for any day in the current year.\nThe Play‚ñ∂Ô∏èbutton below cyclesüîÑthe range inputs beneath it through every day of the year (doty), month, and day of the month. The calendar plot beneath the range inputs highlights the doty in the top range input with a red box, distinguishes months with color, and shows the days of the week and ISO week numbers of the current year on its x- and y-axes, respectively.\n\nviewof dotyInput = Inputs.range([0, 364 + leapInput], {value: 306, step: 1, label: \"Day of the year\"});\nviewof monthInput = transformInput(\n  Inputs.range([1, 12], {step: 1, label: \"Month\"}),\n  {bind: viewof dotyInput, transform: doty2month, invert: month2doty}\n);\nviewof dotyInput1 = transformInput(\n  Inputs.range([-365 - leapInput, -1], {step: 1, label: \"Day of the year\"}),\n  {bind: viewof dotyInput, transform: subN, invert: addN}\n);\nviewof dotmInput = transformInput(\n  Inputs.range([1, 31], {step: 1, label: \"Day of the month\"}),\n  {bind: viewof dotyInput, transform: doty2dotm, invert: (x =&gt; Math.floor(( 153 * (\n    viewof monthInput.value &gt; 2\n    ? viewof monthInput.value - 3\n    : viewof monthInput.value + 9) + 2\n  ) / 5 + x - 1\n))});\nviewof leapscrub = Inputs.form([\n  Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864, format: y =&gt; \"\", inputStyle: \"display:none;\"}),\n  Inputs.toggle({label: \"Leap year\", value: false}),\n])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFirst day of the week of the year\n\nviewof dotwInput = Inputs.radio([\n  \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\",\n  ], {value: \"Sunday\"})\n\n\n\n\n\n\n\ncalPlot0 = Plot.plot({\n  padding: 0,\n  width: 1000,\n  height: 300,\n  className: \"calplot\",\n  marginBottom: 36,\n  marginLeft: 48,\n  y: {tickFormat: Plot.formatWeekday(\"en\", \"short\"), tickSize: 0,\n      domain: [-1, 0, 1, 2, 3, 4, 5, 6],\n      ticks: [0, 1, 2, 3, 4, 5, 6],\n      tickPadding: 2,\n  },\n  x: {interval: 1, label: \"Week\", type: \"band\", tickSize: 0, tickPadding: 2, labelOffset: 36},\n  //fx: {tickFormat: \"\"},\n  style: { fontSize: \"22px\" },\n  color: {\n    range: d3.schemePastel1.concat(d3.schemePastel2),\n    domain: months,\n    className: \"cal\",\n  },\n  marks: [\n    Plot.cell(datesCal0, {\n      x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n      y: d =&gt; d.getUTCDay(),\n      //fx: d =&gt; d.getUTCFullYear(),\n      fill: d =&gt; months[d.getUTCMonth()],\n      stroke: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"red\" : \"none\",\n      strokeWidth: 3,\n      inset: 0.5,\n    }),\n    Plot.text(datesCal0, {\n    x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n    y: d =&gt; d.getUTCDay(),\n    //fx: d =&gt; d.getUTCFullYear(),\n    text: d =&gt; d.getUTCDate() === 8 ? months[d.getUTCMonth()] : \"\",\n      y: -1,\n      frameAnchor: \"left\",\n    monospace: true,\n    fontSize: \"22px\"}),\n    Plot.text(datesCal0, {\n    x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n    y: d =&gt; d.getUTCDay(),\n    //fx: d =&gt; d.getUTCFullYear(),\n    fill: \"black\",\n    //stroke: \"white\",\n    text: d =&gt; d.getUTCDate(), //Math.floor(unix2doty(d.getTime())).toString().padStart(3, \"0\"),\n    monospace: true,\n    fontSize: \"22px\"})\n  ]\n})\n\n\n\n\n\n\n\ncalPlot1 = Plot.plot({\n  padding: 0,\n  width: 1000,\n  height: 300,\n  className: \"calplot\",\n  marginBottom: 36,\n  marginLeft: 48,\n  y: {tickFormat: Plot.formatWeekday(\"en\", \"short\"), tickSize: 0,\n      domain: [-1, 0, 1, 2, 3, 4, 5, 6],\n      ticks: [0, 1, 2, 3, 4, 5, 6],\n      tickPadding: 2,\n  },\n  x: {interval: 1, label: \"Week\", type: \"band\", tickSize: 0, tickPadding: 2, labelOffset: 36},\n  //fx: {tickFormat: \"\"},\n  style: { fontSize: \"22px\" },\n  color: {\n    range: d3.schemePastel1.concat(d3.schemePastel2),\n    domain: months,\n    className: \"cal\",\n  },\n  marks: [\n    Plot.cell(datesCal1, {\n      x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n      y: d =&gt; d.getUTCDay(),\n      //fx: d =&gt; d.getUTCFullYear(),\n      fill: d =&gt; months[d.getUTCMonth()],\n      stroke: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"red\" : \"none\",\n      strokeWidth: 3,\n      inset: 0.5,\n    }),\n    Plot.text(datesCal1, {\n    x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n    y: d =&gt; d.getUTCDay(),\n    //fx: d =&gt; d.getUTCFullYear(),\n    text: d =&gt; d.getUTCDate() === 8 ? months[d.getUTCMonth()] : \"\",\n      y: -1,\n      frameAnchor: \"left\",\n    monospace: true,\n    fontSize: \"22px\"}),\n    Plot.text(datesCal1, {\n    x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n    y: d =&gt; d.getUTCDay(),\n    //fx: d =&gt; d.getUTCFullYear(),\n    fill: \"black\",\n    //stroke: \"white\",\n    text: d =&gt; d.getUTCDate(), //Math.floor(unix2doty(d.getTime())).toString().padStart(3, \"0\"),\n    monospace: true,\n    fontSize: \"22px\"})\n  ]\n})\n\n\n\n\n\n\nDec dates and slices are similar to, but immeasurably more useful than, ISO 8601 ordinal dates and time intervals.\nBoth Dec and ISO ordinal dates consist of a year and a day of the year separated by a delimiter. ISO dates use Dec dates differ from ISO ordinal dates in their first day of the year value (0 versus 1), epoch (0000+000 versus 00-1+306), and method for determining the length of a year (applying the Gregorian calendar leap year rule to the subsequent year versus the given year).\nThe Dec epoch and year length determination method allow Dec days of the year to function as the equivalent of months and days of the month. Notably, Dec days of the year can represent annual events, such as birthdays. In contrast, ISO 8601 does not allow the year to be omitted and thus clumsily expresses annual events as intervals that include the full start date.\nEven though some its features are incompatible with ISO 8601, Dec supports round-trip conversion to all three ISO 8601 date formats. The Mermaid flowchart below shows how the Dec date 2029+226 can be converted into many different formats. You can jump to the section dedicated to a given format by clicking on its corresponding rectangle in the flowchart.\n\n\n\n\n\nflowchart LR\n   A[UNIX time\\n1890000000]&lt;--&gt;B[dote\\n741343]\n   C[Rata Die\\n741038]&lt;--&gt;B\n   D[Julian date\\n2462462.5]&lt;--&gt;B\n   subgraph ana[dote analogs]\n   A\n   C\n   D\n   end\n   subgraph decalendar[Dec]\n   B&lt;--&gt;E[date\\n2029+266]\n   H\n   I\n   end\n   E&lt;--&gt;F[month date\\n2029-11-22]\n   E&lt;--&gt;G[ordinal date\\n2029-326]\n   B~~~H((leap\\n0)):::empty--&gt;B\n   H---G\n   B~~~I((dotw\\n4)):::empty--&gt;B\n   I--&gt;J[week date\\n2029-W47-4]\n   subgraph iso[ISO 8601]\n   F\n   G\n   J\n   end\n   classDef empty stroke:none,fill:none;\n   %% B--&gt;H[HH:MM:SS\\n00:00:00]\n   style decalendar y:50px,x:190px,width:270px,height:250px;\n   click A \"#unix-time\"\n   click B \"#dote\"\n   click C \"#rata-die\"\n   click D \"#julian-date\"\n   click E \"#date\"\n   click F \"#month\"\n   click G \"#ordinal\"\n   click J \"#week\"\n\n\n\n\n\n\nIt is easy to convert a dote into a day of the week (dotw), UNIX timestamp, Julian date, or Rata Die fractional day.\nEach of the Dec and ISO 8601 subsections showcases a function that converts one of three possible inputs, typically dote, Dec date, or ISO month date, into its eponymous format using algorithms developed by Howard Hinnant. Dote analogs, like UNIX time and Julian dates, do not have their own function because they can be created from dotes via simple arithmetic.\nDote analogs\nUNIX time\nUNIX time is the number of seconds since the UNIX epoch. Dec uses days instead of seconds and has a different epoch. To work with UNIX timestamps, Dec converts them into days of the era (dotes) by first turning seconds into days and then shifting the epoch to 0000+000. The reverse conversion first shifts the epoch to 1969+306 and then turns days into seconds.\n\\[\\text{dote} = \\text{UNIX} \\div 86400 + 719468\\]\n\\[\\text{UNIX} = (\\text{dote} - 719468) \\times 86400\\]\nRata Die\nRata Die (RD) fractional days are almost identical to dotes. The only difference is that the RD epoch, 0000+305, is 305 days after the Dec epoch, 0000+000. Therefore, conversion between dotes and RD fractional days is as simple as adding or subtracting 305. For more information on RD fractional days, take a look at the book entitled ‚ÄúCalendrical Calculations‚Äù.\n\\[\\text{RD} = \\text{dote} - 305\\]\n\\[\\text{dote} = \\text{RD} + 305\\]\nJulian date\nA Julian date is a continuous count of days since -4713+298.5. Julian dates are commonly used in astronomy. To convert a dote to a Julian date, we add 1721119.5 days to the dote to shift the epoch to Year -4713 Day 298 Dot 5. To convert a dote to a Julian date, we subtract 1721119.5 days from the Julian date to shift the epoch to Year 0 Day 0 Dot 0.\n\\[\\text{JD} = \\text{dote} + 1721119.5\\]\n\\[\\text{dote} = \\text{JD} - 1721119.5\\]\nDec\nDote\nDec days of the era (dotes) are useful for calendrical calculations such as obtaining the number of days in between two dates. To create a dote from a UNIX timestamp, Dec date, or ISO month date, we can use the dote function shown below. Unlike the dote function, the isow2dote and isoo2dote functions can create dotes from ISO week and ordinal dates, respectively.\nDate\nAs shown in the code above and the equations below, the date function uses a dote to determine the cycle of the era (cote). The cote is used to calculated the day of the cycle (dotc), year of the cycle (yotc), year, and day of the year (doty). Head to the month and ordinal sections to see how the year and doty can be used to obtain ISO month and ordinal dates.\n\\[\\text{cote} = \\Biggl \\lfloor \\frac{\\begin{cases}\\text{dote}&{\\text{if } \\text{dote} \\geq 0;}\\\\\\text{dote}-146096&{\\text{otherwise.}}\\end{cases}}{146097} \\Biggr \\rfloor\\]\n\\[\\text{dotc} = \\text{dote} - \\text{cote} \\cdot 146097\\]\n\\[\\text{yotc} = \\biggl \\lfloor \\frac{\\text{dotc} - \\lfloor \\text{dotc}{\\div}{1460} \\rfloor + \\lfloor \\text{dotc}{\\div}{36524} \\rfloor - \\lfloor \\text{dotc}{\\div}{146096} \\rfloor}{365} \\biggr \\rfloor\\]\n\\[\\text{year} = \\text{yotc} + \\text{cote} * 400\\]\n\\[\\text{doty} = \\text{dotc} - (365 \\cdot \\text{yotc} + \\lfloor \\text{yotc}{\\div}{4} \\rfloor - \\lfloor \\text{yotc}{\\div}{100} \\rfloor + \\lfloor \\text{yotc}{\\div}{400} \\rfloor)\\]\nISO 8601\nOrdinal\nOn the surface, the only difference between Dec and ISO ordinal dates appears to be their delimiters (+ versus -), but they also have different first day of the year values ([0 versus 1](https://en.wikipedia.org/wiki/Zero-based_numbering#:~:h\nWeek\nIn addition to calculating \\(\\colorbox{orange}{n}\\), Dec uses the Gregorian calendar leap year rule to convert Dec dates to and from ordinal dates, as shown in the code below.\nDec dates can also be easily converted to and from ISO 8601 month dates.\n\nWeek and dotw values vary from year to year in a pattern called the solar cycle. Dec has no need for weeks, but uses solar cycles to convert Dec dates into days of the era (dotes). A day of the era (dote) is a continuous count of days since the Dec epoch which can be used for calendrical calculations or converted into a dotw or an ISO 8601 week date as shown below.\n\n\nJavaScript\nJulia\nLua\nPython\nR\n\n\n\n\n\nfunction unix2date(unix) {\n  const dote = unix / 86400 + 719468,\n    socy = Math.floor((\n      dote &gt;= 0 ? dote\n      : dote - 146096\n    ) / 146097),\n  dotc = dote - socy * 146097,\n  yotc = Math.floor((dotc\n    - Math.floor(dotc / 1460)\n    + Math.floor(dotc / 36524)\n    - Math.floor(dotc / 146096)\n  ) / 365);\n  return [\n    yotc + socy * 400,\n    dotc - (yotc * 365\n      + Math.floor(yotc / 4)\n      - Math.floor(yotc / 100)\n  )]}\nunix2date(1728000000)\nunix2date(1890000000)\n\n\n\n\n\n\nfunction unix2date(unix)\n    dote = unix / 86400 + 719468\n    socy = (\n        dote &gt;= 0 ? dote\n        : dote - 146096\n        ) √∑ 146097\n    dotc = dote - socy * 146097\n    yotc = (\n        dotc - dotc √∑ 1460\n        + dotc √∑ 36524\n        - dotc √∑ 146096\n    ) √∑ 365\n    return Int(\n        yotc + socy * 400),\n    dotc - (yotc * 365\n        + yotc √∑ 4\n        - yotc √∑ 100)\nend\nunix2date(1728000000)\nunix2date(1890000000)\n\n(2029, 266.0)\n\n\n\n\n\n\n\nfunction unix2date(unix)\n  local dote = unix / 86400 + 719468\n  local socy = (\n    dote &gt;= 0 and dote\n    or dote - 146096\n  ) // 146097\n  local dotc = dote - socy * 146097\n  local yotc = (\n    dotc - dotc // 1460\n    + dotc // 36524\n    - dotc // 146096\n  ) // 365\n  return {\n    math.floor(yotc + socy * 400),\n    dotc - (yotc * 365\n      + yotc // 4\n      - yotc // 100\n  )}\nend\nunix2date(1728000000)\nunix2date(1890000000)\n\n\n\n\n\n\ndef unix2date(unix):\n    dote = unix / 86400 + 719468\n    socy = (\n        dote if dote &gt;= 0\n        else dote - 146096\n    ) // 146097\n    dotc = dote - socy * 146097\n    yotc = (dotc\n        - dotc // 1460\n        + dotc // 36524\n        - dotc // 146096\n    ) // 365\n    return [\n        int(yotc + socy * 400),\n        dotc - (yotc * 365\n            + yotc // 4\n            - yotc // 100\n    )]\nunix2date(1728000000)\nunix2date(1890000000)\n\n\n\n\n\n\nunix2date &lt;- function(unix) {\n  dote = unix / 86400 + 719468\n  socy = ifelse(\n    dote &gt;= 0, dote,\n    dote - 146096\n  ) %/% 146097\n  dotc = dote - socy * 146097\n  yotc = (\n    dotc - dotc %/% 1460\n    + dotc %/% 36524\n    - dotc %/% 146096\n  ) %/% 365\n  c(\n    yotc + socy * 400,\n    dotc - (yotc * 365\n      + yotc %/% 4\n      - yotc %/% 100\n))}\nunix2date(1728000000)\nunix2date(1890000000)\n\n\n\n\n\nIf we ever need to convert between a doty and a Gregorian calendar month and day of the month without any conversion tools, we can use the Dec finger mnemonic, which is similar to the knuckle mnemonic. The numbers above the fingers in the image below indicate the doty of the last day of each Gregorian calendar month. The thumb, middle finger, and pinky represent months with 31 days, whereas the index and ring fingers stand for 30-day months.\n\n\nDec finger mnemonic\n\nThe southward equinox falls on Day 205 in Year 2024, 2025, 2028, and 2029. We can determine that Day 205 is September 22 by subtracting the Dec date of the last day of August (Day 183), the month preceding September, from the southward equinox doty: \\(205{-}183{=}22\\). To convert in the other direction, we would sum the doty and the day of the month: \\(183{+}22{=}205\\).\nThe finger mnemonic highlights a major difference between Dec and the Gregorian calendar: the Dec year starts on Day 0 just like the Roman calendar, the predecessor of the Gregorian and Julian calendars. For this reason, the Latin numeral prefixes in the names of the months of September, October, November, and December match their one-based indexes (7, 8, 9, and 10) in Dec and the Roman calendar, but not in the Julian or Gregorian calendars.\nThe knuckle and finger mnemonics attempt to make sense of the irregular pattern of month lengths in the Gregorian calendar. Rather than replace variable-length months with fixed-length months, Dec forgoes the use of months entirely and instead uses groups of ten days called deks.\nI generate all of the dates on my site from UNIX time using calculations that I adapted from the civil_from_days function in Howard Hinnant‚Äôs date library. Each tab in the tabset panel below shows a different implementation of a function called unix2date which converts UNIX time into year+day dates.\nIn this function, socy is an abbreviation for solar cycle and dote, dotc, and yotc are acronyms for ‚Äúday of the era‚Äù, ‚Äúday of the cycle‚Äù, and ‚Äúday of the cycle‚Äù, respectively. A solar cycle in the Gregorian calendar is 400 years. A calendar era is the time that has passed since a starting point called a calendar epoch. The Dec epoch is Year 0 Day 0.\nI use different programming languages to convert UNIX time in various places on my site. More specifically, I use a Python post-render script (date.py) for the dates on the page that lists all of the articles on my site, a Lua filter (date.lua) for the PUBLISHED date at the top of each article, and an include-after-body file that sources a JavaScript file (stamp.js) for the date in the above. citation information at the bottom of each article.\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction unix2dote(unix, zone) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (\n      10 - Math.round((new Date)\n        .getTimezoneOffset() / 144)\n    ) % 10) / 10 + 719468, zone]}\nfunction dote2doty(dote, zone = 0) {\n  const socy = Math.floor((\n      dote &gt;= 0 ? dote\n      : dote - 146096\n    ) / 146097),\n  dotc = dote - socy * 146097,\n  yotc = Math.floor((dotc\n    - Math.floor(dotc / 1460)\n    + Math.floor(dotc / 36524)\n    - Math.floor(dotc / 146096)\n  ) / 365);\n  return [\n    yotc + socy * 400,\n    dotc - (yotc * 365\n      + Math.floor(yotc / 4)\n      - Math.floor(yotc / 100)\n  ), zone]}\nfunction doty2deco0(year = 1969, doty = 306, zone = 0) {\n  return `${year.toString().padStart(4, \"0\")}+${Math.floor(doty).toString().padStart(3, \"0\")}${String(doty % 1 * 10).slice(0, 6)}-${zone}`\n}\nydz = dote2doty(...unix2dote(unix))\ndeco = doty2deco0(...ydz)\n// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) &gt;= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`&lt;span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}&gt;${content}&lt;/span&gt;`;\n}\nfunction year2leap(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\ndecoYear = deco.slice(0, 4)\nnextYear = parseInt(decoYear) + 1\ndecoDoty = deco.slice(5, 8)\nnDaysInYear = 365 + year2leap(ydz[0] + 1)\nTminus = nDaysInYear - decoDoty\nfracYear = (ydz[0] + (ydz[1] - ydz[2]) / nDaysInYear).toFixed(3)\nstyledDecoYear = setStyle(decoYear, d3.schemePaired[10])\nstyledNextYear = setStyle(nextYear, d3.schemePaired[10])\nstyledFracYear = setStyle(fracYear, d3.schemePaired[10])\nstyledDecoDoty = setStyle(decoDoty, d3.color(\"cyan\").formatHex())\nstyledDecoDoty1 = setStyle(decoDoty, d3.color(\"cyan\").formatHex())\nstyledDecoTminus = setStyle(Tminus, d3.color(\"pink\").formatHex())\nstyledDecoDek = setStyle(decoDoty.slice(0, 2), d3.color(\"cyan\").formatHex())\nstyledDecoDotd = setStyle(decoDoty[2], d3.color(\"cyan\").formatHex())\nstyledNdays = setStyle(nDaysInYear, d3.schemePaired[6])\nstyledNdays1 = setStyle(nDaysInYear, d3.schemePaired[6])\n// https://observablehq.com/@juang1744/transform-input/1\ntransformInput = function(target, {bind: source, transform = identity, involutory = false, invert = involutory ? transform : inverse(transform)} = {}){\n  if (source === undefined) {\n    source = target;\n    target = html`&lt;div&gt;${source}&lt;/div&gt;`;\n  }\n  function sourceInputHandler() {\n    target.removeEventListener(\"input\", targetInputHandler);\n    setTransform(target).to(transform(source.value)).andDispatchEvent();\n    target.addEventListener(\"input\", targetInputHandler);\n  }\n  function targetInputHandler() {\n    source.removeEventListener(\"input\", sourceInputHandler);\n    setTransform(source).to(invert(target.value)).andDispatchEvent();\n    source.addEventListener(\"input\", sourceInputHandler);\n  }\n  source.addEventListener(\"input\", sourceInputHandler);\n  target.addEventListener(\"input\", targetInputHandler);\n  invalidation.then(() =&gt; {\n    source.removeEventListener(\"input\", sourceInputHandler);\n    target.removeEventListener(\"input\", targetInputHandler);\n  });\n  sourceInputHandler();\n  return target;\n}\nsetTransform = (input) =&gt; ({to: (value) =&gt; (input.value = value, {andDispatchEvent: (event = new Event(\"input\")) =&gt; input.dispatchEvent(event)})});\nfunction inverse(f) {\n  switch (f) {\n    case identity:  return identity;\n    case Math.sqrt: return square;\n    case Math.log:  return Math.exp;\n    case Math.exp:  return Math.log;\n    default:        return (x =&gt; solve(f, x, x));\n  }\n  function solve(f, y, x = 0) {\n    const dx = 1e-6;\n    let steps = 100, deltax, fx, dfx;\n    do {\n      fx = f(x)\n      dfx = (f(x + dx) - fx) || dx;\n      deltax = dx * (fx - y)/dfx\n      x -= deltax;\n    } while (Math.abs(deltax) &gt; dx && --steps &gt; 0);\n    return steps === 0 ? NaN : x;\n  }\nfunction square(x) {\n    return x * x;\n  }\n}\nfunction identity(x) {\n  return x;\n}\nfunction doty2month(doty = 0) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return Math.floor(m &lt; 10 ? m + 3 : m - 9);\n}\nfunction month2doty(month = 1) {\n    return Math.floor(\n        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5\n)}\nfunction doty2dotm(doty = 0) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return doty - Math.floor((153 * m + 2) / 5) + 1;\n}\nnumbers = Array.from({length: 366}, (_, i) =&gt; i)\nset(viewof dotyInput, leapscrub[1])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction set(input, value) {\n  input.value = value;\n  input.dispatchEvent(new Event(\"input\", {bubbles: true}));\n}\n// https://observablehq.com/@mbostock/scrubber\nfunction Scrubber(values, {\n  format = value =&gt; value,\n  initial = 0,\n  direction = 1,\n  delay = null,\n  autoplay = true,\n  loop = true,\n  loopDelay = null,\n  alternate = false,\n  inputStyle = \"\"\n} = {}) {\n  values = Array.from(values);\n  const form = html`&lt;form style=\"font: 18px var(--monospace); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;\"&gt;\n  &lt;button name=b type=button style=\"margin-right: 0.4em; width: 5em;\"&gt;&lt;/button&gt;\n  &lt;label style=\"display: flex; align-items: center;\"&gt;\n    &lt;input name=i type=range min=0 max=${values.length - 1} value=${initial} step=1 style=${inputStyle}&gt;\n    &lt;output name=o style=\"margin-left: 0.4em;\"&gt;&lt;/output&gt;\n  &lt;/label&gt;\n&lt;/form&gt;`;\n  let frame = null;\n  let timer = null;\n  let interval = null;\n  function start() {\n    form.b.textContent = \"Stop\";\n    if (delay === null) frame = requestAnimationFrame(tick);\n    else interval = setInterval(tick, delay);\n  }\n  function stop() {\n    form.b.textContent = \"Play\";\n    if (frame !== null) cancelAnimationFrame(frame), frame = null;\n    if (timer !== null) clearTimeout(timer), timer = null;\n    if (interval !== null) clearInterval(interval), interval = null;\n  }\n  function running() {\n    return frame !== null || timer !== null || interval !== null;\n  }\n  function tick() {\n    if (form.i.valueAsNumber === (direction &gt; 0 ? values.length - 1 : direction &lt; 0 ? 0 : NaN)) {\n      if (!loop) return stop();\n      if (alternate) direction = -direction;\n      if (loopDelay !== null) {\n        if (frame !== null) cancelAnimationFrame(frame), frame = null;\n        if (interval !== null) clearInterval(interval), interval = null;\n        timer = setTimeout(() =&gt; (step(), start()), loopDelay);\n        return;\n      }\n    }\n    if (delay === null) frame = requestAnimationFrame(tick);\n    step();\n  }\n  function step() {\n    form.i.valueAsNumber = (form.i.valueAsNumber + direction + values.length) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", {bubbles: true}));\n  }\n  form.i.oninput = event =&gt; {\n    if (event && event.isTrusted && running()) stop();\n    form.value = values[form.i.valueAsNumber];\n    form.o.value = format(form.value, form.i.valueAsNumber, values);\n  };\n  form.b.onclick = () =&gt; {\n    if (running()) return stop();\n    direction = alternate && form.i.valueAsNumber === values.length - 1 ? -1 : 1;\n    form.i.valueAsNumber = (form.i.valueAsNumber + direction) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", {bubbles: true}));\n    start();\n  };\n  form.i.oninput();\n  if (autoplay) start();\n  else stop();\n  Inputs.disposal(form).then(stop);\n  return form;\n}\ncalYear = !leapInput && dotwInput == \"Monday\" ? 6 : !leapInput && dotwInput == \"Tuesday\" ? 7 : !leapInput && dotwInput == \"Wednesday\" ? 2 : !leapInput && dotwInput == \"Thursday\" ? 3 : !leapInput && dotwInput == \"Friday\" ? 9 : !leapInput && dotwInput == \"Saturday\" ? 10 : !leapInput && dotwInput == \"Sunday\" ? 11 : leapInput && dotwInput == \"Monday\" ? 12 : leapInput && dotwInput == \"Tuesday\" ? 24 : leapInput && dotwInput == \"Wednesday\" ? 8 : leapInput && dotwInput == \"Thursday\" ? 20 : leapInput && dotwInput == \"Friday\" ? 4 : leapInput && dotwInput == \"Saturday\" ? 16 : leapInput && dotwInput == \"Sunday\" ? 28 : 0;\nstartCal0 = new Date(calYear, 0, 0);\nstartCal1 = new Date(calYear, 6, 0);\nstartCal2 = new Date(calYear, 12, 0);\ndatesCal0 = d3.utcDays(startCal0, startCal1);\ndatesCal1 = d3.utcDays(startCal1, startCal2);\nmonths = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\nfunction unix2doty(unix) {\n  const dote = (\n    unix ?? Date.now()\n  ) / 86400000 + 719468,\n    socy = Math.floor((\n      dote &gt;= 0 ? dote\n      : dote - 146096\n    ) / 146097),\n  dotc = dote - socy * 146097,\n  yotc = Math.floor((dotc\n    - Math.floor(dotc / 1460)\n    + Math.floor(dotc / 36524)\n    - Math.floor(dotc / 146096)\n  ) / 365);\n  return dotc - (yotc * 365\n      + Math.floor(yotc / 4)\n      - Math.floor(yotc / 100)\n  )}\n\nfunction doty2dote(year = 1969, doty = 0, zone = 0) {\n    const cycle = Math.floor((year &gt;= 0 ? year : year - 399) / 400),\n    yote = year - cycle * 400;\n    return cycle * 146097 + yote * 365 + Math.floor(yote / 4) - Math.floor(yote / 100) + doty - zone\n}\nfunction doty2deco(yearDoty = [1969, 306], zone = 0) {\n    const yd = dote2doty(doty2dote(yearDoty[0], Math.floor(yearDoty[1])));\n    return `${yd[0].toString().padStart(4, \"0\")}+${yd[1].toString().padStart(3, \"0\")}${\n        yearDoty[1].toString().includes(\".\") ? \".\" + (\n            (yearDoty[1] &gt; 0) ? (yearDoty[1] - zone).toString().split(\".\").pop()\n            : [...(yearDoty[1] - zone).toString().split(\".\").pop()].map(\n                (e, i, a) =&gt; (i + 1 === a.length) ? 10 - e : 9 - e\n            ).join(\"\")\n        ) : \"\"\n    }`\n}\nfunction deco2doty(timestamp = \"1969+306.00000Z\") {\n    const arr = timestamp.toString().split(/(?=[+-]|[a-zA-Z])/, 3);\n    switch (arr.length) {\n        case 1: return [unix2doty(Date.now())[0], parseFloat(arr[0]), 0];\n        case 2: return (/^[a-zA-Z]+$/.test(arr[1]))\n            ? [unix2doty(Date.now())[0], parseFloat(arr[0]), zone2hour(arr[1]) / 24]\n            : [parseFloat(arr[0]), parseFloat(arr[1]), 0];\n    };\n    return [parseFloat(arr[0]), parseFloat(arr[1]), /^[a-zA-Z]+$/.test(arr[2])\n        ? zone2hour(arr[2]) / 24\n        : parseFloat(arr[2].replace(/([+-])/, \"$1\\.\"))];\n}\nfunction zone2hour(zone = \"Z\") {\n    return (zone = zone.toUpperCase()) == \"Z\" ? 0\n        : zone &gt; \"@\" && zone &lt; \"J\" ? zone.charCodeAt() - 64\n        : zone &gt; \"J\" && zone &lt; \"N\" ? zone.charCodeAt() - 65\n        : zone &lt; \"Z\" && zone &gt; \"M\" ? -(zone.charCodeAt() - 77)\n        : zone;\n}\nfunction doty2unix(year = 1969, doty = 306, zone = 0) {\n    return (doty2dote(year, doty, zone) - 719468) * 86400000;\n}\nfunction doty2isoc(yd) {\n    return new Date(doty2unix(...yd))\n}\nfunction doty2greg(doty = 306) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return [\n      Math.floor(m &lt; 10 ? m + 3 : m - 9),\n      Math.floor(doty - (153 * m + 2) / 5 + 2)\n    ];\n}\nfunction greg2doty(month = 1, day = 1) {\n    return Math.floor(\n        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5 + day - 1\n)}\nfunction greg2year(year = 1970, month = 1) { return year - (month &lt; 3) }\nfunction isoc2doty(isoc) {\n  return [greg2year(isoc.getFullYear(), isoc.getUTCMonth() + 1), greg2doty(isoc.getUTCMonth() + 1, isoc.getUTCDate())];\n}\nleapInput = leapscrub[0]\nfunction addN(d) { return d + 365 + leapInput }\nfunction subN(d) { return d - 365 - leapInput }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {Date},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/dec/date},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúDate.‚Äù 2024. https://maptv.github.io/dec/date.",
    "crumbs": [
      "Dec",
      "ISO 8601"
    ]
  },
  {
    "objectID": "dec/span/index.html",
    "href": "dec/span/index.html",
    "title": "Dec Time",
    "section": "",
    "text": "My website provides many examples of the Quarto publishing and the Dec measurement systems in action. I leverage Quarto support for the Observable data analysis and visualization system to display animated or interactive plots like the bar chart, clocks, solar terminator map, and line chart below.\n\nbarChart = {\nconst W = width;\n  const H = 88;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W * .87, H]);\n  const xRange = [0, W - 100];\n  const scaleDD = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleMandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data([\n      // 'dek', 'dotd',\n      'dd', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=&gt;i*30+firstBarY)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(Number(barBeats)+Number(barMb)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(barBeats))\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(Number(barDD)+Number(barMils)/100+Number(barBeats)/10000+Number(barMb)/10000000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(barDD))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(Number(barMils)+Number(barBeats)/100))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(barMils))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+30)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickB1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+47:firstBarY+50)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=&gt;scaleDD(d)+barX)\n    .attr('y', firstBarY+20)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=&gt;scaleDD(d)+barX+.5)\n    .attr('y', firstBarY+18)\n    .text(d=&gt;d)\n  // Cent ticks\n  svg.selectAll('.tickC2')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC2')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+10)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`${barDD}`, `${barMils}`, `${barBeats}`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=&gt;i*30+firstBarY+20)\n    .text(d=&gt;d);\n  svg.attr(\"id\", \"barClock\");\n  return svg.node();\n}\nbarChart1 = {\nconst W = width;\n  const H = 88;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W * .87, H]);\n  const xRange = [0, W - 100];\n  const scaleDD = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleMandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  // const scaleDek = d3.scaleLinear()\n  //  .domain([0, 37])\n  //  .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data([\n      // 'dek', 'dotd',\n      'dd', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=&gt;i*30+firstBarY)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(Number(barBeatsN)+Number(barMbN)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(barBeatsN))\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(Number(barDDN)+Number(barMilsN)/100+Number(barBeatsN)/10000+Number(barMbN)/10000000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(barDDN))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(Number(barMilsN)+Number(barBeatsN)/100))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(barMilsN))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+30)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickB1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+47:firstBarY+50)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=&gt;scaleDD(d)+barX)\n    .attr('y', firstBarY+20)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=&gt;scaleDD(d)+barX+.5)\n    .attr('y', firstBarY+18)\n    .text(d=&gt;d)\n  // Cent ticks\n  svg.selectAll('.tickC2')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC2')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+10)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`${barDDN}`, `${barMilsN}`, `${barBeatsN}`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=&gt;i*30+firstBarY+20)\n    .text(d=&gt;d);\n  svg.attr(\"id\", \"barClock\");\n  return svg.node();\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof location = worldMapCoordinates([162, 0], [width * .998, Math.round((21 / 40) * width)])\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\napp = {\n  const svg = d3.select(DOM.svg(width, height));\n  svg.style(\"user-select\", \"none\")\n     .style(\"-webkit-user-select\", \"none\");\n  const margin = {top: 0, left: 10, right: 10, bottom: 0, inner: 3};\n  const contentWidth = width - margin.left - margin.right - margin.inner;\n  const columnWidth = contentWidth / 2;\n  let selection = {\n    date: new Date(),\n    hour: new Date().getHours()\n  }\n  const renderPlot = () =&gt; {\n    svg.selectAll(\"#plot *\").remove();\n    svg.select(\"#plot\").call(daylightPlot, {\n      width: columnWidth / 1.28,\n      height: height / 1.51 - margin.top - margin.bottom,\n      year: new Date().getFullYear(),\n      latitude: location[1],\n      defaultDate: selection.date,\n      defaultHour: selection.hour\n    })\n  }\n  const renderGlobe = () =&gt; {\n    svg.selectAll(\"#globe *\").remove();\n    svg.selectAll(\"#globe\").call(globe, { width: columnWidth * 1.22, location, ...selection });\n  }\n  const renderSolarSystem = () =&gt; {\n    svg.selectAll(\"#solar-system *\").remove();\n    svg.selectAll(\"#solar-system\").call(solarSystem,\n                                        columnWidth / 1.08,\n                                        location,\n                                        selection.date,\n                                        selection.hour);\n  }\n  const setSelection = (newSelection, forceRender = false) =&gt; {\n    const prev = {...selection};\n    selection = newSelection;\n    svg.node().value = selection;\n    if (forceRender) {\n      renderPlot();\n      renderSolarSystem();\n      renderGlobe();\n    } else if (prev.hour !== selection.hour || prev.date !== selection.date) {\n      renderSolarSystem();\n      renderGlobe();\n    }\n  }\n  svg.append(\"g\")\n    .attr(\"id\", \"solar-system\")\n    .attr(\"transform\", `translate(${margin.left}, ${margin.top + height / 7.6})`);\n  const plot = svg.append(\"g\")\n    .attr(\"id\", \"plot\")\n    .attr(\"transform\", `translate(${margin.left}, ${margin.top + height / 4})`);\n  svg.append(\"g\")\n    .attr(\"id\", \"globe\")\n    .attr(\"transform\", `translate(${margin.left + margin.inner + columnWidth / 1.25}, ${margin.top + Number(columnWidth &lt; 300) * 16})`);\n  setSelection(selection, true);\n  const handleDateHourChange = ({ target, detail: { date, hour }}) =&gt; {\n    if (date != null && hour != null) setSelection({...selection, date, hour});\n  }\n  svg.node().addEventListener(EventType.DateHourChange, handleDateHourChange, false);\n  return svg.node();\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof schedule = Inputs.radio([2, 3, 4, 5], {label: \"Workdays per pent\", value: 3})\nviewof intervals = Inputs.form([\n  interval([0, 1], {step: .01, value: [.3, .7], label: '0 or 5', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '1 or 6', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '2 or 7', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '3 or 8', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '4 or 9', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n])\npentBar = Plot.plot({\n  x: {label: \"Day of the dek\", labelOffset: 36, labelArrow: true, labelAnchor: \"center\"},\n  style: {fontSize: \"16px\"},\n  marginBottom: 40,\n  marginLeft: 45,\n  width: width,\n  className: \"pentbar\",\n  color: {scheme: \"Set1\", legend: \"swatches\", reverse: true, className: \"pentbarlegend\"},\n  y: {label: \"Proportion of the day\", domain: [1, 0], tickPadding: 6, tickSize: -4, labelOffset: 44, labelArrow: true, labelAnchor: \"center\"},\n  marks: [\n  Plot.barY(durations, {x: \"label\", y: \"duration\", fill: \"group\"}),\n  Plot.textY(\n      durations,\n      Plot.stackY(\n        Plot.groupX(\n          { y: \"first\", text: \"first\",\n          },\n          {\n            x: \"label\",\n            z: \"group\",\n            y: \"duration\",\n            text: (d) =&gt; (d.duration &lt; .0001 ? null : formatDecimal(d.duration)),\n            fill: \"white\",\n            stroke: \"black\",\n            fontSize: 28,\n          }\n        )\n      )\n    ),\n  ]})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclock = {\n  const clockRadius = 200,\n    margin = 50,\n    w = (clockRadius + margin) * 2,\n    h = (clockRadius + margin) * 2,\n    hourHandLength = (2 * clockRadius) / 3,\n    minuteHandLength = clockRadius,\n    secondHandLength = clockRadius - 12,\n    secondHandBalance = 30,\n    secondTickStart = clockRadius,\n    secondTickLength = -10,\n    hourTickStart = clockRadius,\n    hourTickLength = -18,\n    secondLabelRadius = clockRadius + 16,\n    secondLabelYOffset = 5,\n    hourLabelRadius = clockRadius - 40,\n    hourLabelYOffset = 7,\n    radians = Math.PI / 180;\n  const ten = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 10]);\n  const sto = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 100]);\n  const handData = [\n    {\n      type: \"hour\",\n      value: 0,\n      length: -hourHandLength,\n      scale: ten\n    },\n    {\n      type: \"minute\",\n      value: 0,\n      length: -minuteHandLength,\n      scale: sto\n    },\n    {\n      type: \"second\",\n      value: 0,\n      length: -secondHandLength,\n      scale: sto,\n      balance: secondHandBalance\n    }\n  ];\n  function drawClock() {\n    // create all the clock elements\n    updateData(); //draw them in the correct starting position\n    const face = svg\n      .append(\"g\")\n      .attr(\"id\", \"clock-face\")\n      .attr(\"transform\", `translate(${[w / 2, h / 2]})`);\n    // add marks for seconds\n    face\n      .selectAll(\".second-tick\")\n      .data(d3.range(0, 100))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"second-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", secondTickStart)\n      .attr(\"y2\", secondTickStart + secondTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${sto(d)})`);\n    // and labels...\n    face\n      .selectAll(\".second-label\")\n      .data(d3.range(0, 100, 5))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"second-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; secondLabelRadius * Math.sin(sto(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt;\n          -secondLabelRadius * Math.cos(sto(d) * radians) + secondLabelYOffset\n      )\n      .text(d =&gt; d);\n    // ... and hours\n    face\n      .selectAll(\".hour-tick\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"hour-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", hourTickStart)\n      .attr(\"y2\", hourTickStart + hourTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${ten(d)})`);\n    face\n      .selectAll(\".hour-label\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"hour-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; hourLabelRadius * Math.sin(ten(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt; -hourLabelRadius * Math.cos(ten(d) * radians) + hourLabelYOffset\n      )\n      .text(d =&gt; d);\n    const hands = face.append(\"g\").attr(\"id\", \"clock-hands\");\n    hands\n      .selectAll(\"line\")\n      .data(handData)\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", d =&gt; d.type + \"-hand\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", d =&gt; d.balance || 0)\n      .attr(\"x2\", 0)\n      .attr(\"y2\", d =&gt; d.length)\n      .attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n    face\n      .append(\"g\")\n      .attr(\"id\", \"face-overlay\")\n      .append(\"circle\")\n      .attr(\"class\", \"hands-cover\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"r\", clockRadius / 20);\n  }\n  function moveHands() {\n    const sel = d3\n      .select(\"#clock-hands-final\")\n      .selectAll(\"line\")\n      .data(handData)\n      .transition();\n    if (fancySecondsOFF) sel.ease(d3.easeElastic.period(0.5));\n    sel.attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n  }\n  function updateData() {\n    handData[0].value = !fancySecondsOFF ? Math.floor(selectedExact * 10) : declock[0];\n    handData[1].value = !fancySecondsOFF ? Math.floor(selectedExact * 10 % 1 * 100) : declock.slice(2, 4);\n    handData[2].value = !fancySecondsOFF ? selectedExact * 10 % 1 * 100 % 1 * 100 : declock.slice(4, 6);\n  }\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"viewBox\", [0, 0, w, h])\n    .style(\"max-width\", \"350px\")\n    .attr(\"class\", \"clock-top\")\n    .attr(\"id\", \"clock\");\n  svg\n    .append(\"text\")\n    .text(\"+\" + selected)\n    .attr(\"x\", clockRadius + margin)\n    .attr(\"y\", clockRadius * 2 + margin * 1.975)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", 32)\n    .attr(\"font-family\", \"monospace\");\n  drawClock();\n  // Animation\n  const interval = setInterval(\n    () =&gt; {\n      updateData();\n      moveHands();\n    },\n    !fancySecondsOFF ? 10 : 864\n  );\n  invalidation.then(() =&gt; clearInterval(interval));\n  return svg.node();\n}\nclock1 = {\n  const clockRadius = 200,\n    margin = 50,\n    w = (clockRadius + margin) * 2,\n    h = (clockRadius + margin) * 2,\n    hourHandLength = (2 * clockRadius) / 3,\n    minuteHandLength = clockRadius,\n    secondHandLength = clockRadius - 12,\n    secondHandBalance = 30,\n    secondTickStart = clockRadius,\n    secondTickLength = -10,\n    hourTickStart = clockRadius,\n    hourTickLength = -18,\n    secondLabelRadius = clockRadius + 16,\n    secondLabelYOffset = 5,\n    hourLabelRadius = clockRadius - 40,\n    hourLabelYOffset = 7,\n    radians = Math.PI / 180;\n  const ten = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 10]);\n  const sto = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 100]);\n  const handData = [\n    {\n      type: \"hour\",\n      value: 0,\n      length: -hourHandLength,\n      scale: ten\n    },\n    {\n      type: \"minute\",\n      value: 0,\n      length: -minuteHandLength,\n      scale: sto\n    },\n    {\n      type: \"second\",\n      value: 0,\n      length: -secondHandLength,\n      scale: sto,\n      balance: secondHandBalance\n    }\n  ];\n  function drawClock() {\n    // create all the clock elements\n    updateData(); //draw them in the correct starting position\n    const face = svg\n      .append(\"g\")\n      .attr(\"id\", \"clock-face\")\n      .attr(\"transform\", `translate(${[w / 2, h / 2]})`);\n    // add marks for seconds\n    face\n      .selectAll(\".second-tick\")\n      .data(d3.range(0, 100))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"second-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", secondTickStart)\n      .attr(\"y2\", secondTickStart + secondTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${sto(d)})`);\n    // and labels...\n    face\n      .selectAll(\".second-label\")\n      .data(d3.range(0, 100, 5))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"second-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; secondLabelRadius * Math.sin(sto(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt;\n          -secondLabelRadius * Math.cos(sto(d) * radians) + secondLabelYOffset\n      )\n      .text(d =&gt; d);\n    // ... and hours\n    face\n      .selectAll(\".hour-tick\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"hour-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", hourTickStart)\n      .attr(\"y2\", hourTickStart + hourTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${ten(d)})`);\n    face\n      .selectAll(\".hour-label\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"hour-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; hourLabelRadius * Math.sin(ten(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt; -hourLabelRadius * Math.cos(ten(d) * radians) + hourLabelYOffset\n      )\n      .text(d =&gt; d);\n    const hands = face.append(\"g\").attr(\"id\", \"clock-hands\");\n    hands\n      .selectAll(\"line\")\n      .data(handData)\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", d =&gt; d.type + \"-hand\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", d =&gt; d.balance || 0)\n      .attr(\"x2\", 0)\n      .attr(\"y2\", d =&gt; d.length)\n      .attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n    face\n      .append(\"g\")\n      .attr(\"id\", \"face-overlay\")\n      .append(\"circle\")\n      .attr(\"class\", \"hands-cover\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"r\", clockRadius / 20);\n  }\n  function moveHands() {\n    const sel = d3\n      .select(\"#clock-hands-final\")\n      .selectAll(\"line\")\n      .data(handData)\n      .transition();\n    if (fancySecondsOFF) sel.ease(d3.easeElastic.period(0.5));\n    sel.attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n  }\n  function updateData() {\n    handData[0].value = !fancySecondsOFF ? Math.floor(selectedExactM * 10) : declockM[0];\n    handData[1].value = !fancySecondsOFF ? Math.floor(selectedExactM * 10 % 1 * 100) : declockM.slice(2, 4);\n    handData[2].value = !fancySecondsOFF ? selectedExactM * 10 % 1 * 100 % 1 * 100 : declockM.slice(4, 6);\n  }\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"viewBox\", [0, 0, w, h])\n    .style(\"max-width\", \"350px\")\n    .attr(\"class\", \"clock-btm\")\n    .attr(\"id\", \"clock\");\n  svg\n    .append(\"text\")\n    .text(\"-\" + selectedM)\n    .attr(\"x\", clockRadius + margin)\n    .attr(\"y\", clockRadius * 2 + margin * 1.975)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", 32)\n    .attr(\"font-family\", \"monospace\");\n  drawClock();\n  // Animation\n  const interval = setInterval(\n    () =&gt; {\n      updateData();\n      moveHands();\n    },\n    !fancySecondsOFF ? 10 : 864\n  );\n  invalidation.then(() =&gt; clearInterval(interval));\n  return svg.node();\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [(unix ?? Date.now()) / 86400000 + (\n    zone = zone ?? -Math.round(\n      (new Date).getTimezoneOffset() / 144)\n    ) / 10 + offset, zone]\n}\nfunction unix2dote1(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nselectedDote = unix2dote(unix, long2zone(location[0]))\nselectedExact = selectedDote[0] % 1\nselectedExactM = Math.abs(selectedExact - 1)\nbarTime = selectedExact.toString().slice(2)\nbarTimeN = selectedExactM.toString().slice(2)\nbarCents = barTime.slice(0, 2)\nbarCentsN = barTimeN.slice(0, 2)\nbarDD = barTime[0]\nbarDDN = barTimeN[0]\nbarMils = barTime.slice(1, 3)\nbarMilsN = barTimeN.slice(1, 3)\nbarBeats = barTime.slice(3, 5)\nbarBeatsN = barTimeN.slice(3, 5)\nbarMb = barTime.slice(5, 8)\nbarMbN = barTimeN.slice(5, 8)\nfunction lati2turn1(degrees = -180, e = 3) {\n  // turns: e=0, deciturns: e=1, etc.\n  return (degrees %= 360) / (360 / 10**e) % 10**e;\n}\nfunction dote2deco(dote = 719468, zone = 0, lead = \"0\", emoji = false, minus = false) {\nlet [year, doty] = dote2date(dote);\n  if (minus) {\n    doty = Math.abs(doty - (365 + Number(year2leap(year + 1))));\n    if (zone != null) {\n      zone = (10 - zone) % 10;\n    }\n  }\nreturn `${\n    (year + minus).toString().padStart(4, lead)}${minus ? \"-\" : \"+\"}${\n    Math.floor(doty).toString().padStart(3, lead)}${emoji ? \"üóìÔ∏è\" : \"\"}${(doty % 1 * 10).toFixed(4)}${\n    zone != null ? (minus ? \"+\" : \"-\") + String(zone) : \"\"}${emoji ? \"üï∞Ô∏è\" : \"\"}`\n}\ngraticule = d3.geoGraticule().stepMinor([36,36]).stepMajor([36,36])()\ngraticule.coordinates = graticule.coordinates.map(\n  i =&gt; i.map(j =&gt; j.map((k, index, arr) =&gt; i.length === 3 && index === 0 ? k - 18 : k))\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction long2turn(degrees = -180, e = 3) {\n  // turns: e=0, deciturns: e=1, etc.\n  return (((degrees %= 360) &lt; 0 ? degrees + 360 : degrees) + 18) / (360 / 10**e) % 10**e;\n}\n// https://github.com/topojson/world-atlas\nworld = d3.json(\"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\")\ncountries = topojson.feature(world, world.objects.countries)\ntopojson = require(\"topojson-client@3\")\nfunction long2zone(degrees = -180) {\n  return Math.floor(long2turn(degrees, 1));\n}\nfunction year2leap(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\nsolarSystem = (root, width, location, date, hour) =&gt; {\n  const earthRadius = 0.04 * width;\n  const sunRadius = 0.08 * width;\n  const solarSystemRadius = width / 2 - 20;\n  const stretch = 0.3;\n  const solarAngle = getSolarAngle(date);\n  const solarAngleDeg = (solarAngle * 180) / Math.PI;\n  const x = solarSystemRadius * Math.sin(solarAngle);\n  const y = stretch * solarSystemRadius * Math.cos(solarAngle);\n  const spin = 180 + -location[0] + solarAngleDeg + 360 * ((hour + 12) / 24);\n  const earthGeo = { type: \"Sphere\" };\n  const projection = d3\n    .geoOrthographic()\n    .fitWidth(earthRadius * 2, earthGeo)\n    .rotate([spin, 0, 23.5])\n    .translate([0, 0]);\n  const staticProjection = d3\n    .geoOrthographic()\n    .fitWidth(earthRadius * 2, earthGeo)\n    .rotate([solarAngleDeg - 90, 0])\n    .translate([0, 0]);\n  const path = d3.geoPath(projection).pointRadius(1.5);\n  const staticPath = d3.geoPath(staticProjection);\n  const solarSystem = root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${width / 2})`);\n  solarSystem.append(\"circle\").attr(\"r\", sunRadius).attr(\"fill\", colors.sun);\n  /* Draw orbit */\n  solarSystem\n    .append(\"ellipse\")\n    .attr(\"rx\", solarSystemRadius)\n    .attr(\"ry\", stretch * solarSystemRadius)\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", \"black\");\n  /* Draw month ticks */\n  d3.range(12).map((m) =&gt; {\n    const d = new Date(date.getFullYear(), m, 1);\n    const angle = getSolarAngle(d);\n    solarSystem\n      .append(\"line\")\n      .attr(\"x1\", (solarSystemRadius + 6) * Math.sin(angle))\n      .attr(\"y1\", (solarSystemRadius + 6) * stretch * Math.cos(angle))\n      .attr(\"x2\", (solarSystemRadius - 6) * Math.sin(angle))\n      .attr(\"y2\", (solarSystemRadius - 6) * stretch * Math.cos(angle))\n      .attr(\"stroke\", \"black\");\n    const startMonthAngle = getSolarAngle(new Date(date.getFullYear(), m, 1));\n    solarSystem\n      .append(\"text\")\n      .text(date2doty(d))\n      .attr(\"x\", (solarSystemRadius + 18) * Math.sin(startMonthAngle))\n      .attr(\n        \"y\",\n        (solarSystemRadius + 18) * 1.18 * stretch * Math.cos(startMonthAngle)\n      )\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n      .attr(\"dominant-baseline\", \"middle\")\n      .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n      .attr(\"font-family\", \"sans-serif\")\n      .attr(\"fill\", \"black\");\n  });\n  const earth = solarSystem\n    .append(\"g\")\n    .attr(\"transform\", `translate(${x}, ${y})`);\n  earth\n    .append(\"line\")\n    .attr(\"y1\", -1.5 * earthRadius)\n    .attr(\"y2\", 1.5 * earthRadius)\n    .attr(\"stroke\", \"blue\")\n    .attr(\"transform\", `rotate(-23.5)`);\n  earth.append(\"path\").attr(\"d\", path(earthGeo)).attr(\"fill\", colors.ocean);\n  earth.append(\"path\").attr(\"d\", path(land)).attr(\"fill\", colors.land);\n  earth.append(\"path\")\n  .attr(\"d\", path(countries))\n  .attr(\"stroke-width\", \".075\")\n  .attr(\"fill\", \"none\")\n  .attr(\"stroke\", \"#555\");\n  const shadowPolygon = [\n    [0, -90],\n    [0, 0],\n    [0, 90],\n    [180, 0],\n    [0, -90]\n  ];\n  earth\n    .append(\"path\")\n    .attr(\"d\", staticPath({ type: \"Polygon\", coordinates: [shadowPolygon] }))\n    .attr(\"fill\", \"rgba(0, 0, 0, 0.5)\");\n  earth\n    .append(\"path\")\n    .attr(\"d\", path({ type: \"Point\", coordinates: location }))\n    .attr(\"r\", 18)\n    .attr(\"stroke-width\", .3)\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", \"red\");\n}\nfunction greg2doty(month = 1, day = 1) {\n    return Math.floor(\n        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5 + day - 1\n)}\nfunction date2doty(date) {\n  return greg2doty(date.getMonth() + 1, date.getDate())\n}\nfunction date2doty1(date) {\n  const doty = greg2doty(date.getMonth() + 1, date.getDate())\n  return doty === 31 ? \"Day \" + String(doty) : doty\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\nglobe = (root, { width, location, date, hour }) =&gt; {\n  const solarAngle = getSolarAngle(date);\n  const solarAngleDeg = toDegrees(solarAngle);\n  const hourSpin = 360 * ((hour + 12) / 24);\n  const spin = (180 + -location[0] + solarAngleDeg + hourSpin);\n  const tilt = -15;\n  const projection = d3.geoOrthographic()\n                       .fitWidth(width, graticule)\n                       .rotate([spin, tilt, 23.5]);\n  const path = d3.geoPath(projection);\n  const unClippedProjection = d3.geoOrthographic()\n                                .clipAngle(null)\n                                .fitWidth(width, graticule)\n                                .rotate([spin, tilt, 23.5]);\n  const unClippedPath = d3.geoPath(unClippedProjection);\n  const staticProjection = d3.geoOrthographic()\n                             .fitWidth(width, graticule)\n                             .rotate([solarAngleDeg - 90, tilt]);\n  const staticPath = d3.geoPath(staticProjection);\n  const background = root.append(\"g\");\n  const earth = root.append(\"g\").style(\"opacity\", 0.75);\n  const foreground = root.append(\"g\");\n  earth.append(\"path\")\n    .attr(\"d\", path({type: \"Sphere\"}))\n    .attr(\"fill\", colors.ocean)\n    .attr(\"stroke\", \"#9ecbda\");\n  earth.append(\"path\")\n    .attr(\"d\", path(land))\n    .attr(\"fill\", colors.land);\n  earth.append(\"path\")\n    .attr(\"d\", path(countries))\n    .attr(\"stroke-width\", \"1\")\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", \"#000\");\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath({type: \"Point\", coordinates: location}))\n    .attr(\"fill\", \"red\");\n  const latitudeCoords = (latitude, start, end) =&gt; {\n    const longitudes = d3.range(start, end, 2).concat(end);\n    return longitudes.map(d =&gt; [d, latitude]);\n  }\n  const correctSpin = d3.geoRotation([-hourSpin, 0]);\n  const correctTilt = d3.geoRotation([6, 0, 0]);\n  /* total angular extent of day/night */\n  const dayExtent = 360 * dayLength(date, location[1]) / 24;\n  const nightExtent = 360 - dayExtent;\n  const dayLine = {\n    type: \"LineString\",\n    coordinates: latitudeCoords(location[1],\n                                location[0] - dayExtent / 2,\n                                location[0] + dayExtent / 2).map(d =&gt; correctSpin(d))\n  };\n  const nightLine = {\n    type: \"LineString\",\n    coordinates: latitudeCoords(location[1],\n                                location[0] - dayExtent / 2 - nightExtent,\n                                location[0] - dayExtent / 2).map(d =&gt; correctSpin(d))\n  };\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath(dayLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.day)\n    .attr(\"stroke-width\", 3);\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath(nightLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.night)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path(dayLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.day)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path(nightLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.night)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path({type: \"Point\", coordinates: location}))\n    .attr(\"stroke-width\", .5)\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", \"red\");\n  const shadowPolygon = [[0, -90], [0, 0], [0, 90], [180, 0], [0, -90]].map(d =&gt; correctTilt(d));\n  foreground.append(\"path\")\n    .attr(\"d\", staticPath({type: \"Polygon\", coordinates: [shadowPolygon]}))\n    .attr(\"fill\", \"rgba(0, 0, 0, 0.25)\");\n}\ndayOfYear = (date) =&gt; {\n  const yearStart = new Date(date.getFullYear(), 0, 1+60);\n  return Math.floor((date.getTime() - yearStart.getTime())/86400000) + 1\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\ndaylightPlot = (\n  root,\n  { width, height, year, latitude, defaultDate, defaultHour }\n) =&gt; {\n  const margin = { top: 24, bottom: 32, left: 48, right: 0 };\n  const chartWidth = width - margin.left - margin.right;\n  const chartHeight = height - margin.top - margin.bottom;\n  const xTickValues =\n    width &gt; 380 ? [3, 6, 9, 12, 15, 18, 21] : width &gt; 240 ? [6, 12, 18] : [12];\n  const xScale = d3\n    .scaleLinear()\n    .domain([0, 24])\n    .range([margin.left, margin.left + chartWidth])\n    .clamp(true);\n  // y-axis scale\n  const yScale = d3\n    .scaleTime()\n    .domain([new Date(year, 0, 1+60), new Date(year, 11, 31+60)])\n    .range([margin.top, margin.top + chartHeight])\n    .clamp(true);\n  // y-axis labels\n  const yAxis = d3\n    .axisLeft(yScale)\n    .tickValues(d3.timeMonth.range(new Date(year, 1, 1+60), new Date(year, 12, 1+57)))\n    .tickSize(chartWidth)\n    .tickFormat(date2doty1);\n  const xAxis = d3\n    .axisBottom(xScale)\n    .tickValues(xTickValues)\n    .tickSize(chartHeight)\n    .tickFormat((d) =&gt; {\n      return `${d / .024}`;\n    });\n  let date = defaultDate || new Date();\n  let hour = defaultHour != null ? defaultHour : date.getHours();\n  const handleMouseMove = (e) =&gt; {};\n  root\n    .append(\"rect\")\n    .attr(\"x\", margin.left)\n    .attr(\"y\", margin.top)\n    .attr(\"width\", chartWidth)\n    .attr(\"height\", chartHeight)\n    .attr(\"rx\", 0.05 * width)\n    .attr(\"fill\", colors.night);\n  root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left + chartWidth}, 0)`)\n    .call(yAxis)\n    .call((g) =&gt; g.select(\".domain\").remove())\n    .call((g) =&gt; g.selectAll(\".tick\").attr(\"color\", colors.grid))\n    //.call((g) =&gt; g.selectAll(\".tick text\").attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2)))\n    .call((g) =&gt; g.selectAll(\".tick text\").attr(\"color\", \"black\"))\n    .call((g) =&gt; g.selectAll(\".tick line\").attr(\"stroke-dasharray\", \"5 3\"));\n  root\n    .append(\"g\")\n    .attr(\"transform\", `translate(0, ${margin.top})`)\n    .call(xAxis)\n    .call((g) =&gt; g.select(\".domain\").remove())\n    .call((g) =&gt; g.selectAll(\".tick\").attr(\"color\", colors.grid))\n    //.call((g) =&gt; g.selectAll(\".tick text\").attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2)))\n    .call((g) =&gt; g.selectAll(\".tick text\").attr(\"color\", \"black\"))\n    .call((g) =&gt; g.selectAll(\".tick line\").attr(\"stroke-dasharray\", \"5 3\"));\n  root\n    .append(\"text\")\n    .text(\"Local Solar Time\")\n    .attr(\"x\", margin.left + chartWidth / 2)\n    .attr(\"y\", margin.top + chartHeight + margin.bottom - 2)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .attr(\"fill\", \"black\");\n  const data = yearDates(year)\n    .map((d) =&gt; [d, dayLength(d, latitude)])\n    .filter(([_, d]) =&gt; d &gt; 0);\n  /* Render separate polygons for each continuous sequence of\n   * days with more than 0 hours of day light\n   */\n  const polys = [];\n  let currentPoly = [];\n  for (let i = 0; i &lt; data.length; i++) {\n    const currentDate = data[i][0];\n    const prevDate = (data[i - 1] || [])[0];\n    if (\n      i === 0 ||\n      currentDate.getTime() - prevDate.getTime() &lt; 3600 * 24 * 1000 * 1.5\n    ) {\n      currentPoly.push(data[i]);\n    } else {\n      polys.push(currentPoly);\n      currentPoly = [data[i]];\n    }\n  }\n  polys.push(currentPoly);\n  polys.forEach((p) =&gt; {\n    const points = [\n      ...p.map(([d, l]) =&gt; `${xScale(12 - l / 2)},${yScale(d)}`),\n      ...p.reverse().map(([d, l]) =&gt; `${xScale(12 + l / 2)},${yScale(d)}`)\n    ].join(\" \");\n    root.append(\"polygon\").attr(\"points\", points).attr(\"fill\", colors.day);\n  });\n  /* Legend */\n  const legend = root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left + chartWidth / 2 - 64})`);\n  legend\n    .append(\"rect\")\n    .attr(\"rx\", 5)\n    .attr(\"x\", -25)\n    .attr(\"y\", 6)\n    .attr(\"width\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"height\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"fill\", colors.night);\n  legend\n    .append(\"text\")\n    .attr(\"x\", -8)\n    .attr(\"y\", 19)\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .text(\"Nighttime\");\n  legend\n    .append(\"rect\")\n    .attr(\"x\", 58)\n    .attr(\"rx\", 5)\n    .attr(\"y\", 6)\n    .attr(\"width\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"height\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"fill\", colors.day);\n  legend\n    .append(\"text\")\n    .attr(\"x\", 75)\n    .attr(\"y\", 19)\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .text(\"Daytime\");\n  /* Time and date controls */\n  const dateLine = root.append(\"g\");\n  const updateControlPositions = () =&gt; {\n    dateLine\n      .select(\"line\")\n      .attr(\"x1\", xScale(0))\n      .attr(\"y1\", yScale(date))\n      .attr(\"x2\", xScale(24))\n      .attr(\"y2\", yScale(date));\n    dateLine\n      .select(\"rect\")\n      .attr(\"x\", xScale(0))\n      .attr(\"y\", yScale(date) - 4);\n    root\n      .select(\"#time-control\")\n      .attr(\"cx\", xScale(hour))\n      .attr(\"cy\", yScale(date));\n  };\n  const dispatchDateHourChange = () =&gt; {\n    const detail = { date, hour };\n    const changeEvent = new CustomEvent(EventType.DateHourChange, {\n      detail,\n      bubbles: true\n    });\n    root.node().dispatchEvent(changeEvent);\n  };\n  const handleDateLineDrag = ({ y }) =&gt; {\n    date = yScale.invert(y);\n    updateControlPositions();\n    dispatchDateHourChange();\n  };\n  const handleTimeCircleDrag = ({ x }) =&gt; {\n    hour = xScale.invert(x);\n    updateControlPositions();\n    dispatchDateHourChange();\n  };\n  dateLine.append(\"line\").attr(\"stroke-width\", 4).attr(\"stroke\", \"red\");\n  dateLine\n    .append(\"rect\")\n    .attr(\"width\", chartWidth)\n    .attr(\"height\", 8)\n    .attr(\"fill\", \"rgba(0, 0, 0, 0)\")\n    .style(\"cursor\", \"row-resize\")\n    .call(d3.drag().on(\"drag\", handleDateLineDrag));\n  root\n    .append(\"circle\")\n    .attr(\"id\", \"time-control\")\n    .attr(\"r\", 12)\n    .attr(\"fill\", \"red\")\n    .attr(\"stroke-width\", .6)\n    .attr(\"stroke\", \"black\")\n    .style(\"cursor\", \"pointer\")\n    .call(d3.drag().on(\"drag\", handleTimeCircleDrag));\n  updateControlPositions();\n}\nfontSize = 12;\ngetSolarAngle = (date) =&gt; (dayOfYear(date) + 10) / 365 * Math.PI * 2 - Math.PI / 2;\n/*\n * Formulas uses the CBM model as reviewed here:\n * https://www.ikhebeenvraag.be/mediastorage/FSDocument/171/Forsythe+-+A+model+comparison+for+daylength+as+a+function+of+latitude+and+day+of+year+-+1995.pdf\n */\ndayLength = (date, latitude) =&gt; {\n  const yearStart = new Date(date.getFullYear(), 0, 1);\n  const dayOfYear = Math.floor((date.getTime() - yearStart.getTime())/86400000) + 1;\n  const revAngle = 0.2163108 + 2 * Math.atan(0.9671396 * Math.tan(0.00860 * (dayOfYear - 186)));\n  const decAngle = Math.asin(0.39795 * Math.cos(revAngle));\n  /* daylight coefficient selected for apparent sunrise/sunset */\n  const p = 0.8333\n  const intResult =\n    (Math.sin((p * Math.PI) / 180) +\n      Math.sin((latitude * Math.PI) / 180) * Math.sin(decAngle)) /\n    (Math.cos((latitude * Math.PI) / 180) * Math.cos(decAngle));\n  if (intResult &gt;= 1) return 24;\n  if (intResult &lt;= -1) return 0;\n  return 24 - 24 * Math.acos(intResult) / Math.PI;\n}\nyearDates = (year) =&gt; {\n  const startDate = new Date(year, 0, 1+60);\n  const endDate = new Date(year + 1, 0, 1+60);\n  return d3.timeDay.range(startDate, endDate);\n}\nheight = 0.65 * width;\nEventType = ({\n  LocationChange: \"LOCATION_CHANGE\",\n  DateHourChange: \"DATE_HOUR_CHANGE\"\n})\ncolors = ({\n  night: \"#719fb6\",\n  day: \"#ffe438\",\n  grid: \"#4b6a79\",\n  ocean: \"#adeeff\",\n  land: \"#f5f1dc\",\n  sun: \"#ffe438\"\n})\ntoRadians = (val) =&gt; val * Math.PI / 180\ntoDegrees = (val) =&gt; val * 180 / Math.PI;\nland = topojson.feature(world, world.objects.land);\nd3 = require(\"d3@7\", \"d3-geo-projection@3\")\nfunction input(config) {\n  let {\n    form,\n    type = \"text\",\n    attributes = {},\n    action,\n    getValue,\n    title,\n    description,\n    format,\n    display,\n    submit,\n    options\n  } = config;\n  const wrapper = html`&lt;div&gt;&lt;/div&gt;`;\n  if (!form)\n    form = html`&lt;form&gt;\n    &lt;input name=input type=${type} /&gt;\n  &lt;/form&gt;`;\n  Object.keys(attributes).forEach(key =&gt; {\n    const val = attributes[key];\n    if (val != null) form.input.setAttribute(key, val);\n  });\n  if (submit)\n    form.append(\n      html`&lt;input name=submit type=submit style=\"margin: 0 0.75em\" value=\"${\n        typeof submit == \"string\" ? submit : \"Submit\"\n      }\" /&gt;`\n    );\n  form.append(\n    html`&lt;output name=output style=\"font: 14px Menlo, Consolas, monospace; margin-left: 0.1em; text-align:center;\"&gt;&lt;/output&gt;`\n  );\n  if (title)\n    form.prepend(\n      html`&lt;div style=\"font: 700 0.9rem sans-serif; margin-bottom: 3px;\"&gt;${title}&lt;/div&gt;`\n    );\n  if (description)\n    form.append(\n      html`&lt;div style=\"font-size: 0.85rem; font-style: italic; margin-top: 3px;\"&gt;${description}&lt;/div&gt;`\n    );\n  if (format)\n    format = typeof format === \"function\" ? format : d3format.format(format);\n  if (action) {\n    action(form);\n  } else {\n    const verb = submit\n      ? \"onsubmit\"\n      : type == \"button\"\n      ? \"onclick\"\n      : type == \"checkbox\" || type == \"radio\"\n      ? \"onchange\"\n      : \"oninput\";\n    form[verb] = e =&gt; {\n      e && e.preventDefault();\n      const value = getValue ? getValue(form.input) : form.input.value;\n      if (form.output) {\n        const out = display ? display(value) : format ? format(value) : value;\n        if (out instanceof window.Element) {\n          while (form.output.hasChildNodes()) {\n            form.output.removeChild(form.output.lastChild);\n          }\n          form.output.append(out);\n        } else {\n          form.output.value = out;\n        }\n      }\n      form.value = value;\n      if (verb !== \"oninput\")\n        form.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n    };\n    if (verb !== \"oninput\")\n      wrapper.oninput = e =&gt; e && e.stopPropagation() && e.preventDefault();\n    if (verb !== \"onsubmit\") form.onsubmit = e =&gt; e && e.preventDefault();\n    form[verb]();\n  }\n  while (form.childNodes.length) {\n    wrapper.appendChild(form.childNodes[0]);\n  }\n  form.append(wrapper);\n  return form;\n}\nd3format = require(\"d3-format@1\")\n// https://observablehq.com/@enjalot/draggable-world-map-coordinates-input\nfunction worldMapCoordinates(config = {}, dimensions) {\n  const {\n    value = [], title, description, width = dimensions[0]\n  } = Array.isArray(config) ? {value: config} : config;\n  const height = dimensions[1];\n  let [lon, lat] = value;\n  lon = lon != null ? lon : null;\n  lat = lat != null ? lat : null;\n  const formEl = html`&lt;form style=\"width: ${width}px;\"&gt;&lt;/form&gt;`;\n  const context = DOM.context2d(width, height-width/13.2);\n  const canvas = context.canvas;\n  canvas.style.margin = `0px 0px -26px 0px`;\n  const projection = d3\n    .geoEquirectangular()\n    .precision(0.1)\n    .fitSize([width, height], { type: \"Sphere\" }).rotate([-153, 0]);\n  const path = d3.geoPath(projection, context).pointRadius(2.5);\n  formEl.append(canvas);\n  function draw() {\n    context.fillStyle = \"#fff\";\n    context.fillRect(0, 0, width, height);\n    context.beginPath(); path({type: \"Sphere\"});\n    context.fillStyle = colors.ocean; context.fill();\n    context.beginPath();\n    path(graticule);\n    context.lineWidth = 0.95;\n    context.strokeStyle = `#aaa`;\n    context.stroke();\n    context.beginPath();\n    path(land);\n    context.fillStyle = colors.land;\n    context.fill();\n    context.beginPath();\n    path(countries);\n    context.lineWidth = .95;\n    context.strokeStyle = `#000`;\n    context.stroke();\n    context.fillStyle = `#000`;\n    context.font = width &lt; 760 ? \"14px serif\" : width &lt; 990 ? \"17px serif\" : \"23px serif\";\n    d3.range(-1.5, 342 + 1, 36).map(x =&gt;  context.fillText(long2zone(x), ...projection([x, 84 - (width &lt; 400) * 3.6])));\n    d3.range(-1.5, 342 + 1, 36).map(x =&gt;  context.fillText(long2zone(x), ...projection([x, -66])));\n    context.beginPath(), path(night), context.fillStyle = \"rgba(0,0,255,0.1)\", context.fill();\n    context.beginPath(); path.pointRadius(17); path({type: \"Point\", coordinates: sun}); context.strokeStyle = \"#0008\"; context.fillStyle = \"#ff08\"; context.lineWidth = 1; context.stroke(); context.fill();\n    if (lon != null && lat != null) {\n      path.pointRadius(17); context.strokeStyle = \"black\";\n      context.beginPath(); path({type: \"Point\", coordinates: [lon, lat]}); context.lineWidth = 1; context.stroke();\n      context.lineWidth = 6;\n      path.pointRadius(14); context.strokeStyle = \"red\";\n      context.beginPath(); path({type: \"Point\", coordinates: [lon, lat]}); context.stroke();\n    }\n  }\n  let drag = d3.drag()\n    .on(\"drag\", (event) =&gt; {\n      let coords = projection.invert([event.x, event.y]);\n      lon = +coords[0].toFixed(2);\n      lat = +coords[1].toFixed(2);\n      draw();\n      canvas.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n    })\n  d3.select(canvas).call(drag)\n  canvas.onclick = function(ev) {\n    const { offsetX, offsetY } = ev;\n    let coords = projection.invert([offsetX, offsetY]);\n    lon = +coords[0].toFixed(2);\n    lat = +coords[1].toFixed(2);\n    draw();\n    canvas.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n  };\n  draw();\n  const form = input({\n    type: \"worldMapCoordinates\",\n    title,\n    description,\n    display: v =&gt; (width &gt; 400) ? html`&lt;div style=\"width: ${width}px; white-space: nowrap; color: #444; text-align: center; font: ${width / 50}px monospace; position: relative; top: -${width / 36}px;  margin-bottom: -.4em;\"&gt;\n            &lt;span style=\"color: #000;\"&gt;Zone:&lt;/span&gt; ${lon != null ? long2zone(lon) : \"\"}\n            &nbsp; &nbsp;\n            &lt;span style=\"color: #000;\"&gt;Longitude:&lt;/span&gt; ${lon != null ? (long2turn(lon)).toFixed(0) : \"\"}\n            &nbsp; &nbsp;\n            &lt;span style=\"color: #000;\"&gt;Latitude:&lt;/span&gt; ${lat != null ? ((lati2turn1(lat))).toFixed(0) : \"\"}\n          &lt;/div&gt;` : '',\n    getValue: () =&gt; [lon != null ? lon : null, lat != null ? lat : null],\n    form: formEl\n  });\n  return form;\n}\nsun = {\n  const now = new Date;\n  const day = new Date(+now).setUTCHours(0, 0, 0, 0);\n  const t = solar.century(now);\n  const longitude = (day - now) / 864e5 * 360 - 180;\n  return [longitude - solar.equationOfTime(t) / 4, solar.declination(t)];\n}\nnight = d3.geoCircle()\n    .radius(90)\n    .center(antipode(sun))\n  ()\nantipode = ([longitude, latitude]) =&gt; [longitude + 180, -latitude]\nsolar = require(\"solar-calculator@0.3/dist/solar-calculator.min.js\")\nviewof fancySecondsOFF = Inputs.toggle({\n  label: \"Ticking clock\",\n  value: false\n})\ndeclock = (selectedExact * 10).toFixed(4);\ndeclockM = (Math.abs(selectedExact - 1) * 10).toFixed(4);\nselected = `${declock}-${selectedZone}`\nselectedM = `${declockM}-${selectedZone}`\nselectedZone = selectedDote[1]\ndurations = [].concat(...nested)\nnested = Array.from({length: intervals.length}, (_, i) =&gt; ([\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1] !== intervals[i][0] ? intervals[i][0] : 1,\n  group: \"Rest\"\n},\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1]-intervals[i][0],\n  group: \"Work\"\n},\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1] !== intervals[i][0] ? 1-intervals[i][1] : null,\n  group: \"Rest\"\n  }]))\nschedules = [\n  [[.2, .8], [.2, .8], [0, 0], [0, 0], [0, 0]],\n  [[.3, .7], [.3, .7], [.3, .7], [0, 0], [0, 0]],\n  [[.35, .65], [.35, .65], [.35, .65], [.35, .65], [0, 0]],\n  [[.38, .62], [.38, .62], [.38, .62], [.38, .62], [.38, .62]],\n]\nset(viewof intervals, schedules[schedule-2])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction interval(range = [], options = {}) {\n  const [min = 0, max = 1] = range;\n  const {\n    step = .001,\n    label = null,\n    value = [min, max],\n    format = ([start, end]) =&gt; `${start} ‚Ä¶ ${end}`,\n    color,\n    width,\n    theme,\n  } = options;\n  const __ns__ = DOM.uid('scope').id;\n  const css = `\n#${__ns__} {\n  font: 13px/1.2 var(--sans-serif);\n  display: flex;\n  align-items: baseline;\n  flex-wrap: wrap;\n  max-width: 100%;\n  width: auto;\n}\n@media only screen and (min-width: 30em) {\n  #${__ns__} {\n    flex-wrap: nowrap;\n    width: 360px;\n  }\n}\n#${__ns__} .label {\n  width: 60px;\n  padding: 5px 0 4px 0;\n  margin-right: .5px;\n  flex-shrink: 0;\n}\n#${__ns__} .form {\n  display: flex;\n  width: 100%;\n}\n#${__ns__} .range {\n  flex-shrink: 1;\n  width: 100%;\n}\n#${__ns__} .range-slider {\n  width: 100%;\n}\n  `;\n  const $range = rangeInput({min, max, value: [value[0], value[1]], step, color, width, theme});\n  const $output = html`&lt;output&gt;`;\n  const $view = html`&lt;div id=${__ns__}&gt;\n${label == null ? '' : html`&lt;div class=\"label\"&gt;${label}`}\n&lt;div class=form&gt;\n  &lt;div class=range&gt;\n    ${$range}&lt;div class=range-output style=\"display: inline-block;\"&gt;${$output}&lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n${html`&lt;style&gt;${css}`}\n  `;\n  const update = () =&gt; {\n    const content = format([$range.value[0], $range.value[1]]);\n    if(typeof content === 'string') $output.value = content;\n    else {\n      while($output.lastChild) $output.lastChild.remove();\n      $output.appendChild(content);\n    }\n  };\n  $range.oninput = update;\n  update();\n  return Object.defineProperty($view, 'value', {\n    get: () =&gt; $range.value,\n    set: ([a, b]) =&gt; {\n      $range.value = [a, b];\n      update();\n    },\n  });\n}\nfunction rangeInput(options = {}) {\n  const {\n    min = 0,\n    max = 100,\n    step = 'any',\n    value: defaultValue = [min, max],\n    color,\n    width,\n    theme = theme_Flat,\n  } = options;\n  const controls = {};\n  const scope = randomScope();\n  const clamp = (a, b, v) =&gt; v &lt; a ? a : v &gt; b ? b : v;\n  const html = htl.html;\n  // Will be used to sanitize values while avoiding floating point issues.\n  const input = html`&lt;input type=range ${{min, max, step}}&gt;`;\n  const dom = html`&lt;div class=${`${scope} range-slider`} style=${{\n    color,\n    width: cssLength(width),\n  }}&gt;\n  ${controls.track = html`&lt;div class=\"range-track\"&gt;\n    ${controls.zone = html`&lt;div class=\"range-track-zone\"&gt;\n      ${controls.range = html`&lt;div class=\"range-select\" tabindex=0&gt;\n        ${controls.min = html`&lt;div class=\"thumb thumb-min\" tabindex=0&gt;`}\n        ${controls.max = html`&lt;div class=\"thumb thumb-max\" tabindex=0&gt;`}\n      `}\n    `}\n  `}\n  ${html`&lt;style&gt;${theme.replace(/:scope\\b/g, '.'+scope)}`}\n&lt;/div&gt;`;\n  let value = [], changed = false;\n  Object.defineProperty(dom, 'value', {\n    get: () =&gt; [...value],\n    set: ([a, b]) =&gt; {\n      value = sanitize(a, b);\n      updateRange();\n    },\n  });\n  const sanitize = (a, b) =&gt; {\n    a = isNaN(a) ? min : ((input.value = a), input.valueAsNumber);\n    b = isNaN(b) ? max : ((input.value = b), input.valueAsNumber);\n    return [Math.min(a, b), Math.max(a, b)];\n  }\n  const updateRange = () =&gt; {\n    const ratio = v =&gt; (v - min) / (max - min);\n    dom.style.setProperty('--range-min', `${ratio(value[0]) * 100}%`);\n    dom.style.setProperty('--range-max', `${ratio(value[1]) * 100}%`);\n  };\n  const dispatch = name =&gt; {\n    dom.dispatchEvent(new Event(name, {bubbles: true}));\n  };\n  const setValue = (vmin, vmax) =&gt; {\n    const [pmin, pmax] = value;\n    value = sanitize(vmin, vmax);\n    updateRange();\n    // Only dispatch if values have changed.\n    if(pmin === value[0] && pmax === value[1]) return;\n    dispatch('input');\n    changed = true;\n  };\n  setValue(...defaultValue);\n  // Mousemove handlers.\n  const handlers = new Map([\n    [controls.min, (dt, ov) =&gt; {\n      const v = clamp(min, ov[1], ov[0] + dt * (max - min));\n      setValue(v, ov[1]);\n    }],\n    [controls.max, (dt, ov) =&gt; {\n      const v = clamp(ov[0], max, ov[1] + dt * (max - min));\n      setValue(ov[0], v);\n    }],\n    [controls.range, (dt, ov) =&gt; {\n      const d = ov[1] - ov[0];\n      const v = clamp(min, max - d, ov[0] + dt * (max - min));\n      setValue(v, v + d);\n    }],\n  ]);\n  // Returns client offset object.\n  const pointer = e =&gt; e.touches ? e.touches[0] : e;\n  // Note: Chrome defaults \"passive\" for touch events to true.\n  const on  = (e, fn) =&gt; e.split(' ').map(e =&gt; document.addEventListener(e, fn, {passive: false}));\n  const off = (e, fn) =&gt; e.split(' ').map(e =&gt; document.removeEventListener(e, fn, {passive: false}));\n  let initialX, initialV, target, dragging = false;\n  function handleDrag(e) {\n    // Gracefully handle exit and reentry of the viewport.\n    if(!e.buttons && !e.touches) {\n      handleDragStop();\n      return;\n    }\n    dragging = true;\n    const w = controls.zone.getBoundingClientRect().width;\n    e.preventDefault();\n    handlers.get(target)((pointer(e).clientX - initialX) / w, initialV);\n  }\n  function handleDragStop(e) {\n    off('mousemove touchmove', handleDrag);\n    off('mouseup touchend', handleDragStop);\n    if(changed) dispatch('change');\n  }\n  invalidation.then(handleDragStop);\n  dom.ontouchstart = dom.onmousedown = e =&gt; {\n    dragging = false;\n    changed = false;\n    if(!handlers.has(e.target)) return;\n    on('mousemove touchmove', handleDrag);\n    on('mouseup touchend', handleDragStop);\n    e.preventDefault();\n    e.stopPropagation();\n    target = e.target;\n    initialX = pointer(e).clientX;\n    initialV = value.slice();\n  };\n  controls.track.onclick = e =&gt; {\n    if(dragging) return;\n    changed = false;\n    const r = controls.zone.getBoundingClientRect();\n    const t = clamp(0, 1, (pointer(e).clientX - r.left) / r.width);\n    const v = min + t * (max - min);\n    const [vmin, vmax] = value, d = vmax - vmin;\n    if(v &lt; vmin) setValue(v, v + d);\n    else if(v &gt; vmax) setValue(v - d, v);\n    if(changed) dispatch('change');\n  };\n  return dom;\n}\nfunction randomScope(prefix = 'scope-') {\n  return prefix + (performance.now() + Math.random()).toString(32).replace('.', '-');\n}\nfunction formatDecimal(number) {\n  return number == 1 ? number : (Math.round(number * 100) / 100).toString().slice(1)\n}\ncssLength = v =&gt; v == null ? null : typeof v === 'number' ? `${v}px` : `${v}`\ntheme_Flat = `\n/* Options */\n:scope {\n  color: #3b99fc;\n  width: 240px;\n}\n\n:scope {\n  position: relative;\n  display: inline-block;\n  --thumb-size: 15px;\n  --thumb-radius: calc(var(--thumb-size) / 2);\n  padding: var(--thumb-radius) 0;\n  margin: 2px;\n  vertical-align: middle;\n}\n:scope .range-track {\n  box-sizing: border-box;\n  position: relative;\n  height: 7px;\n  background-color: hsl(0, 0%, 80%);\n  overflow: visible;\n  border-radius: 4px;\n  padding: 0 var(--thumb-radius);\n}\n:scope .range-track-zone {\n  box-sizing: border-box;\n  position: relative;\n}\n:scope .range-select {\n  box-sizing: border-box;\n  position: relative;\n  left: var(--range-min);\n  width: calc(var(--range-max) - var(--range-min));\n  cursor: ew-resize;\n  background: currentColor;\n  height: 7px;\n  border: inherit;\n}\n/* Expands the hotspot area. */\n:scope .range-select:before {\n  content: \"\";\n  position: absolute;\n  width: 100%;\n  height: var(--thumb-size);\n  left: 0;\n  top: calc(2px - var(--thumb-radius));\n}\n:scope .range-select:focus,\n:scope .thumb:focus {\n  outline: none;\n}\n:scope .thumb {\n  box-sizing: border-box;\n  position: absolute;\n  width: var(--thumb-size);\n  height: var(--thumb-size);\n\n  background: #fcfcfc;\n  top: -4px;\n  border-radius: 100%;\n  border: 1px solid hsl(0,0%,55%);\n  cursor: default;\n  margin: 0;\n}\n:scope .thumb:active {\n  box-shadow: inset 0 var(--thumb-size) #0002;\n}\n:scope .thumb-min {\n  left: calc(-1px - var(--thumb-radius));\n}\n:scope .thumb-max {\n  right: calc(-1px - var(--thumb-radius));\n}\n`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topReuseCC BY-SA 4.0CitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {Dec {Time}},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/dec/time},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúDec Time.‚Äù 2024. https://maptv.github.io/dec/time.",
    "crumbs": [
      "Dec",
      "Span"
    ]
  },
  {
    "objectID": "software/quarto/index.html",
    "href": "software/quarto/index.html",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1."
  },
  {
    "objectID": "software/quarto/index.html#tldr",
    "href": "software/quarto/index.html#tldr",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1."
  },
  {
    "objectID": "software/quarto/index.html#sec-intro",
    "href": "software/quarto/index.html#sec-intro",
    "title": "Quarto",
    "section": "Introduction",
    "text": "Introduction\nQuarto is an open-source software system for turning plain-text source files into outputs like articles, books, blogs, dashboards, presentations, reports, and websites. Announced on 2022+149 by Posit CEO JJ Allaire, Quarto is already taking the worldüåêby storm‚õàÔ∏è!\nI strongly believe that everyone, regardless of their background and current technical skill level, can learn and benefit from Quarto. Getting started with Quarto is easy thanks to its excellent documentation and vibrant community of enthusiastic users and developers.\nRather than repeat the basic information already available elsewhere, I will share some advanced techniques along with the fundamental knowledge needed to understand how they work. The topics I cover are very technical, but my goal is to make the content on my blog as accessible as possible.\nThe first topic I will delve into is creating and publishing a website with Quarto. To follow the Quarto documentation on creating a website, you will need Visual Studio Code (VSCode), VSCodium, RStudio, or a terminal."
  },
  {
    "objectID": "software/quarto/index.html#sec-pub",
    "href": "software/quarto/index.html#sec-pub",
    "title": "Quarto",
    "section": "Publishing Quarto sites",
    "text": "Publishing Quarto sites\n\nInstalling tools\nIf you use macOS, Linux, or the Windows Subsystem for Linux (WSL), you can install all of the aforementioned tools with the Homebrew package manager. To install everything you will need to follow along with this blog post, you can first install Homebrew and then run brew bundle in a directory that contains the Brewfile shown in Example¬†1.\n\nExample 1 ¬†\n\n\nBrewfile\n\nbrew \"gh\"\nbrew \"git\"\nbrew \"glab\"\ncask \"github\"\ncask \"quarto\"\ncask \"rstudio\"\ncask \"vscodium\"\ncask \"visual-studio-code\"\nvscode \"quarto.quarto\"\nvscode \"REditorSupport.r\"\n\n\nUsing a package manager like Homebrew to install all the requirements with a single shell command like brew bundle is the fastest and easiest way to get ready to follow along with this blog post. If you are curious about how I set up my computer, you can take a look at my Brewfile and other configuration files in my setup repository (repo) on GitHub and GitLab.\nApart from RStudio, VSCode, and VSCodium, the Brewfile in Example¬†1 will install the Git version control system, the GitHub and GitLab command line interfaces (CLIs), and GitHub Desktop, a Git Graphical User Interface (GUI). For more information on Git, a tool used by 93% of software developers worldwide according to survey results published by StackOverflow on 2022+314, take a look at the ‚ÄúGitHub for supporting, reusing, contributing, and failing safely‚Äù post by Allison Horst and Julie Lowndes on the Openscapes blog.\nAs an alternative to installing tools on your computer, you can use the web interface provided by GitHub Codespaces. To set up a Codespace, you can remove the lines that start with cask from the Brewfile provided in Example¬†1 and add the file to a repo called dotfiles and along with a setup.sh file like the one shown in Example¬†2.\n\nExample 2 ¬†\n\n\nsetup.sh\n\necho | /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n(echo; echo 'eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"') &gt;&gt; /home/codespace/.profile\neval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"\nbrew bundle\n\n\n\n\nPublishing overview\nOnce you are done setting up your computer or Codespace, you create a Quarto website template and make your site publicly available on the internet using one of the many available publishing services. To explore and assess different publishing workflows and free website hosting options, I set up my personal website on four different web hosts: Quarto Pub, Netlify, GitHub Pages, and GitLab Pages.\nThere are so many different ways to publish a Quarto site that I decided to come up with a naming system for Quarto publishing methods. The naming system derives a code for each publishing method from the numbered lists in the Quarto publishing documentation. For example, I refer to the two methods to publish to Quarto Pub as Q1 and Q2:\nTable¬†1 uses this naming system in its Code column to identify the publishing methods I discuss in this blog post. Each publishing method targets a particular web Host, Renders content locally or on a remote server, and deploys sites using either the quarto publish or the git push shell Command.\n\n\n\n\n\n\nCode\nHost\nRender\nCommand\n\n\n\n\nG1\nGitHub\nLocal\npush\n\n\nG2\nGitHub\nLocal\npublish\n\n\nG3\nGitHub\nRemote\npush\n\n\nN1\nNetlify\nLocal\npublish\n\n\nN2\nNetlify\nLocal\npush\n\n\nN3\nNetlify\nRemote\npush\n\n\nQ1\nQuarto\nLocal\npublish\n\n\nQ2\nQuarto\nRemote\npush\n\n\n\n\n\nTable¬†1: Quarto website publishing methods\n\n\n\n\n\nGit workflow\nThe first publishing method I tried for my personal site was G1, which requires the use of Git to push all website content to a Git provider like GitHub or GitLab. After I set up GitHub Pages and GitLab Pages, I could update my website on both of these web hosts just by going through the standard Git workflow shown in Figure¬†2.\n\n\n\n\n\n\nflowchart LR\n   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)\n\n\n\n\nFigure¬†2: Git workflow\n\n\n\n\n\nTo make it easier to make incremental changes to my website and frequently release new content, I combined all of the git shell commands in Figure¬†2 into a shell alias. You can add shell aliases to a shell configuration file like .bashrc or .zshrc on your computer to shorten commands or combine any sequence of commands into one step.\nThe aacmp alias in the .zshrc file in my setup repo allows me to enter a free-form commit message directly on the command line without quotes, e.g.¬†qp edit first blog. If you decide to try my aacmp alias, please exercise extreme caution as any un-escaped or un-quoted metacharacters may yield surprising effects instead of being included verbatim in the commit message. For example, qp * will list the contents of the current directory in the commit message in place of the asterisk!\nAn alternative to a shell alias that combines git commands is a keyboard shortcut in Git-enabled GUI. Example¬†3 shows two files, tasks.json and update.sh, that we can use to set up VSCode, VSCodium, and GitHub Codespaces to go through the Git workflow whenever we press Ctrl+Shift+B on Linux/Windows or ‚åò+Shift+B on Mac (mnemonic: B is for Build).\n\nExample 3 ¬†\n\nupdate.shtasks.json\n\n\n\n\n\n\n\n\n\n\nThis mechanism is called Tasks and is used to automate software build tasks, which can include any steps required to build and publish a website. Importantly, the Tasks mechanism requires that the tasks.json file be added to the .vscode directory and that we enable execution of the update.sh script by running chmod +x update.sh in our project root.\nShell aliases and keyboard shortcuts can greatly facilitate the Git workflow which is essential not only for G1, but also G3, N3, and Q2. Unlike these other publishing methods, G1 leads to messy commits that contain changes to both source and output files.\n\n\nquarto publish\nTo have cleaner commits, I switched from G1 to G2 by adding quarto publish to my publishing workflow. With G2, I can track changes to my source files on my main branch and publish my output files to GitHub Pages and GitLab Pages from my gh-pages branch.\nQ1, N1, and G2 all use quarto publish to render website content locally and then deploy it in one fell swoop. If you do not plan to use the Git version control system or the advanced features offered by GitHub, GitLab, or Netlify, then I recommend deploying your site to Quarto Pub by running quarto publish quarto-pub (Q1 in Table¬†1).\nLike Q1, N1 is a deployment method that does not require Git and makes it possible to deploy our site with a single shell command: quarto publish netlify. N1 provides access to the advanced web hosting features offered by Netlify and can even render content as long as code execution is frozen.\nTo deploy my site to GitHub Pages, GitLab Pages, and Netlify, I combined G2 and N2. When I run quarto publish gh-pages, Quarto renders my site into my output directory, copies the output directory contents to the gh-pages branch of my local repo, and then commits and pushes the changes to my remote repos on GitHub and GitLab, which triggers Netlify to build my site from the gh-pages branch.\nTo summarize the Quarto publishing methods I discussed so far, Q1 and N1 are easy to configure and use, N2 automatically builds sites from Git repos, G1 is not recommended because it pollutes commits with output file changes, and G2 is more difficult to set up and use but provides clean commits and a nice separation of source and output files.\n\n\nGitHub Actions\nAll of the publishing methods I have discussed so far require us to generate output files locally by rendering our source files. In contrast, Q2, G3, and N3 make it possible to skip local rendering in favor of relying on GitHub Actions to handle all of the necessary steps.\nG3 is noteworthy, because it offers the same convenience of G1 but without messy commits that mix changes to source and output files. An added bonus of G3 is that rendering with GitHub Actions provides a reproducible computational environment that is not dependent on what you have installed on your computer.\nInstead of using GitHub Actions, I could have used GitLab CI/CD to build my site. I decided not to go down this route because the Quarto dev team has many GitHub Actions workflows available but currently no official support for GitLab CI/CD.\nBefore trying to use GitHub Actions or any other continuous integration systems in your publishing workflow, I suggest getting used to working with quarto publish (Q1, G2, or N1). You can always set up other publishing methods later without sacrificing anything, because all of the publishing methods except G1 can be combined together.\nIn Section¬†4, I will walk through the setup of both G2 and G3 to provide the option of rendering locally by running quarto publish or rendering remotely with GitHub Actions by pushing to the main branch. Along the way, I will share many practical tips and general advice that you can apply to any project."
  },
  {
    "objectID": "software/quarto/index.html#sec-set",
    "href": "software/quarto/index.html#sec-set",
    "title": "Quarto",
    "section": "Publishing setup",
    "text": "Publishing setup\n\nRepo setup\nBefore you can use GitHub Actions to publish your site, you will need a GitHub, an SSH key, and a repo like maptv.github.io that has a default branch called main and another branch which must be called gh-pages. If you want to publish on GitLab Pages, you will also need a GitLab account and an analogous GitLab repo like maptv.gitlab.io.\nYou can create the repo and the gh-pages branch using the web interface of https://github.com or https://gitlab.com in your browser, but the best way to start a new project is using the CLI for GitHub or GitLab in your terminal. First, run gh auth login or glab auth login and follow the prompts to authenticate via your web browser or with an authentication token.\nThe GitHub CLI allows you to add an SSH key to your account during or after authentication. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for adding an SSH key to your GitLab account.\nAfter authentication and SSH key setup, you can run the code in either of the code chunks in Example¬†4 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my .zshrc.\n\nExample 4 ¬†\n\nGitHubGitLab\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\ngh repo create USERNAME.github.io --add-readme --clone --public\ncd SITENAME\nquarto create project website USERNAME.github.io\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\nglab repo create USERNAME.gitlab.io --readme --defaultBranch main --public\ncd SITENAME\ngit pull origin main\ngit branch --set-upstream-to=origin/main main\nquarto create project website USERNAME.gitlab.io\n\n\n\n\nTo make it easier to maintain my site on both GitHub and GitLab Pages, I set up my local repo cloned to have two origin remote URLs using the code as shown in Example¬†5. Now, running quarto publish or git push in my local repo, updates my content on both GitHub and GitLab.\n\nExample 5 ¬†\ngit remote add lab git@gitlab.com:maptv/maptv.gitlab.io\ngit remote add hub git@github.com:maptv/maptv.github.io\ngit remote set-url --add origin $(git remote get-url lab)\n\nIf you want to have your website hosted on GitHub Pages, you will need to set gh-pages as your source branch in your repo settings. For GitLab Pages, you will need to add a .gitlab-ci.yml file to your repo and update your _quarto.yml file as shown in Example¬†6 to include .gitlab-ci.yml as a resource in your output directory.\n\nExample 6 ¬†\n\n.gitlab-ci.yml_quarto.yml\n\n\n# https://docs.gitlab.com/ee/user/project/pages/introduction.html#customize-the-default-folder\npages:\n  script: echo \"The site will be deployed to $CI_PAGES_URL\"\n  artifacts:\n    paths:\n      - \".\"\n  publish: \".\"\n  only:\n    - gh-pages\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\n\n\n\n\nBy default, GitLab Pages includes a random hash in site URLs. To shorten the URL of my GitLab Pages site to &lt;maptv.gitlab.io&gt;, I had to uncheck Use unique domain under Deploy &gt; Pages in the GitLab sidebar.\nAt this point, we have completed G2 setup and you should be able to run quarto publish gh-pages from your main branch to render your site and deploy it to GitHub and/or GitLab Pages. Deploying with quarto publish at least once is a prerequisite for setting up any of the publishing methods that rely on GitHub Actions, because quarto publish creates a _publish.yml file in the root of your project that is required for publishing via GitHub Actions.\n\n\nGitHub Actions\nIn addition to the steps described above, G3 setup requires that we create a .github/workflows directory and add a YAML file to that directory. Example¬†7 contains the gh-pages.yml file I use for my own site and the shell code that can used to obtain this file.\n\nExample 7 ¬†\n\ncurlgh-pages.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_dispatch:\n  push:\n    branches: [main]\n\nname: Quarto Publish\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out repository\n        uses: actions/checkout@v4\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n        with:\n          version: '1.4.489'\n          tinytex: true\n\n      - name: Install R\n        uses: r-lib/actions/setup-r@v2\n        with:\n          r-version: '4.2.0'\n\n      - name: Install R Dependencies\n        uses: r-lib/actions/setup-renv@v2\n        with:\n          cache-version: 1\n\n      - name: Install Python and Dependencies\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n          cache: 'pip'\n      - run: pip install jupyter\n      - run: pip install -r requirements.txt\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: Push To GitLab\n        env:\n          token: ${{ secrets.GITLAB_AUTH_TOKEN }}\n        run: |\n          echo Starting to push gh-pages branch to GitLab\n          git config user.name \"maptv\"\n          git config user.email \"129316885+maptv@users.noreply.github.com\"\n          git remote set-url origin \"https://oauth2:${token}@gitlab.com/maptv/maptv.gitlab.io\"\n          git push origin gh-pages\n\n\n\n\nThe gh-pages.yml file in Example¬†7 installs Quarto, the R and Python programming languages, and the packages in the renv.lock and requirements.txt files. If you do not need R and/or Python, you can remove any unnecessary portions of the file.\nTo modify the Python files that are installed by GitHub Actions, you can edit the requirements.txt file in your repo. To update your renv.lock file so that it includes all of the R packages your site requires, run renv::snapshot() in an R session or Rscript -e renv::snapshot() in a shell.\nAfter pushing the gh-pages.yml file, you can visit the Actions tab in your remote repo on GitHub to check the progress of the deployment of your site. If your site did not build successfully, you can go through the logs to try to diagnose the problem.\nI added a ‚ÄúPush to GitLab‚Äù step to my gh-pages.yml to make GitHub Actions push my remote gh-pages to GitLab so that my site is kept in sync on both GitHub and GitLab Pages. This required manually creating a token on GitLab and adding it to GitHub, which I accomplished using the GitHub CLI as shown in Example¬†8.\n\nExample 8 ¬†\ngh secret set GITLAB_AUTH_TOKEN\n\nAfter the setup described above, I now have two options for publishing my Quarto site: quarto publish and 2) git push. In addition to GitHub and GitLab Pages, both of these options automatically update my site on Netlify via N2.\nTo also automatically update my site on Quarto Pub, I created a separate GitHub Actions workflow by adding another YAML file to the .github/workflows directory in my repo. Example¬†9 shows my quarto-pub.yml file and the shell code that can be used to obtain it.\n\nExample 9 ¬†\n\ncurlquarto-pub.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_run:\n    workflows: [pages-build-deployment]\n    types: [completed]\n\nname: Update Quarto Pub\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Check out main repository\n        uses: actions/checkout@v4\n\n      - name: Check out _site\n        uses: actions/checkout@v4\n        with:\n          ref: gh-pages\n          path: _site\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: quarto-pub\n          render: false\n          QUARTO_PUB_AUTH_TOKEN: ${{ secrets.QUARTO_PUB_AUTH_TOKEN }}\n          GITHUB_USERNAME: maptv\n\n\n\n\nMy quarto-pub.yml file is based on Q2, but it runs upon completion of the pages-build-deployment workflow instead of a push to main. I changed the workflow trigger so that it runs after my GitHub Pages site is built, regardless of whether I triggered the build by running quarto publish gh-pages or pushing to main.\nFigure¬†3 summarizes all of the steps that occur during my Quarto publishing workflow. This workflow allows me to publish my site on four web hosts every time I run quarto publish gh-pages (G2) or git push (G3)!\n\n\n\n\n\n\nflowchart LR\n    A[local&lt;br/&gt;main]-.G2.-&gt;B[local&lt;br/&gt;gh-pages]-.G2.-&gt;C[GitHub&lt;br/&gt;gh-pages]\n    B[local&lt;br/&gt;gh-pages]-.G2.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;F[GitHub&lt;br/&gt;main]-.G3.-&gt;C[GitHub&lt;br/&gt;gh-pages]-.G3.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;G[GitLab&lt;br/&gt;main]\n    C[GitHub&lt;br/&gt;gh-pages]-.N2.-&gt;E[Netlify]\n    C[GitHub&lt;br/&gt;gh-pages]-.Q2.-&gt;H[Quarto&lt;br/&gt;Pub]\n\n\n\n\nFigure¬†3: Quarto publishing workflow\n\n\n\n\n\nSo far I have only noticed one difference between the four web hosts I use for my site: GitHub Pages is the only web host that properly differentiates between internal and external links. All of the other web hosts include the external link icon on all links regardless of whether they target my site or an external site.\nI tried unsuccessfully to solve this issue by setting the link-external-filter property to a regular expression. If you notice a problem with the link-external-icon feature on other web hosts, I suggest switching to GitHub Pages."
  },
  {
    "objectID": "software/quarto/index.html#sec-cust",
    "href": "software/quarto/index.html#sec-cust",
    "title": "Quarto",
    "section": "Customizing Quarto sites",
    "text": "Customizing Quarto sites\n\nSite navigation\nOnce your site is built and published, you can make it easier to navigate with a customized navigation bar (navbar) and sidebar, as described in the Quarto documentation. Check out the _quarto.yml files for my site and the Quarto documentation site to see how the navigation components are set up.\nIn my navbar, I added toggle buttons for reader mode and dark mode. The names of the other icons on right side of the navbar are included in the sidebar.\n\n\nHTML blocks\nMy navbar also provides the current date and time in Dec ordinal (deco) format, which counts the years since 1 BC and the days since March 1. Dec is a calendar and time system that I created and use throughout my blog.\nTo add a custom timestamp to the navbar, I put a &lt;script&gt; element that runs time.js in an HTML block in every Quarto markdown (.qmd) file, as shown in Example¬†10. Mine √áetinkaya-Rundel wrote about HTML blocks as part of her A Quarto tip a day project.\n\nExample 10 ¬†\n\n*.qmdtime.js\n\n\n```{=html}\n&lt;script src=\"time.js\"&gt;&lt;/script&gt;\n```\n\n\n\n\n\n\n\nHTML blocks are useful for running JavaScript code in the context of a single page on your site without affecting the others. I also use HTML blocks to add a &lt;style&gt; element to my .qmd files as a last ditch effort to fine tune the style of my site.\nBefore I resort to the &lt;style&gt; element approach, I try writing CSS in my style.css, light.css, and dark.css files. So far, this approach has been sufficient to make any styling changes I want, but if it every fails, I can use JavaScript to override the default styling provided by Quarto by modifying style attributes, which have the highest specificity in CSS.\n\n\nPost-render script\nI wanted to my blog‚Äôs listing page to show dates in the same format as the navbar timestamp. To accomplish this, I used a post-render script written in the Python programming language.\nPre- and post-render scripts are set as project options in the _quarto.yml file in the root of your Quarto project. Example¬†11 shows the date.py post-render script and how this script is referenced in _quarto.yml.\n\nExample 11 ¬†\n\n_quarto.ymldate.py\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\ndate-format: x\n\n\n# https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nimport bs4\n\ndef unix2doty(ms):\n    dote = ms / 86400000 + 719468\n    cykl = (\n        dote if dote &gt;= 0\n        else dote - 146096\n    ) // 146097\n    dotc = dote - cykl * 146097\n    yotc = (dotc\n        - dotc // 1460\n        + dotc // 36524\n        - dotc // 146096\n    ) // 365\n    return [\n        int(yotc + cykl * 400),\n        dotc - (yotc * 365\n            + yotc // 4\n            - yotc // 100\n        )\n    ]\n\nwith open(\"_site/list/index.html\") as infile:\n    txt = infile.read()\n    soup = bs4.BeautifulSoup(txt, features=\"html.parser\")\nfor div in soup.find_all(\"div\", {\"class\": \"card-file-modified\"}):\n    elem = div.find(\"p\")\n    if \"+\" not in elem.text:\n        y, d = unix2doty(int(div.text))\n        elem.string.replace_with(f\"{y:&gt;04}+{d.__floor__():&gt;03}\")\nfor div in soup.find_all(\"div\", {\"class\": \"listing-reading-time\"}):\n    if \"min\" in div.text:\n        div.string.replace_with(f\"{(int(div.text.split()[0]) / 1.44).__floor__()} milliday\")\nwith open(\"_site/list/index.html\", \"w\") as outfile:\n    outfile.write(str(soup))\n\n\n\n\nNormally, formatting dates in Quarto is as easy as setting the date-format YAML property. In my case it was more difficult, because I wanted dates based on Dec, the calendar and time system I created, instead of the ubiquitous Gregorian calendar.\nTo facilitate the calculations in date.py, I set date-format to x in my _metadata.yml file so all of the dates would be in millisecond UNIX time and I would not have to deal with Gregorian calendar date formats or time zones. After all of the dates are generated, my date.py script traverses the HTML in the output directory using Beautiful Soup and converts millisecond UNIX time dates into Dec dates (year+day).\n\n\nPandoc filter\nIn addition to customizing dates on the listing page of my blog, I wanted to customize the date format in every blog post. To complete this task, I used a Lua script as a Pandoc filter.\nPandoc is a program that converts documents into practically any format. The ‚Äúpan‚Äù in Pandoc comes from the Ancient Greek word for all. Pandoc strives to convert all document formats, just like Pangea contained all the land and a panacea solves all problems.\nQuarto uses Pandoc to convert markdown files into target format(s) like html or pdf. If the source files contain executable code, Quarto executes the code via one of two computational engines: Jupyter or Knitr. Figure¬†4 shows the Quarto workflow.\n\n\n\n\n\n\nflowchart LR\n   A[qmd&lt;br/&gt;ipynb]-.Knitr&lt;br/&gt;Jupyter.-&gt;B((md))-.Pandoc with&lt;br/&gt;Lua filters.-&gt;C(html&lt;br/&gt;pdf&lt;br/&gt;docx&lt;br/&gt;etc.)\n\n\n\n\nFigure¬†4: Quarto rendering workflow\n\n\n\n\n\nMine √áetinkaya-Rundel‚Äôs Quarto tip series includes a similar Quarto workflow mermaid diagram and her ‚ÄúHello, Quarto!‚Äù rstudio::conf(2022) keynote with Julia Stewart Lowndes contains truly beautiful Quarto workflow images by Allison Horst: 1, 2, 3, and 4.\nQuarto controls Pandoc, Jupyter, and Knitr in two ways: 1) with arguments passed to the Quarto CLI commands and 2) with YAML key-value pairs in .qmd, .ipynb, or .yml files.\nExample¬†12 shows how I set up every qmd file to generate the current date in millisecond UNIX time and designated date.lua as a Pandoc filter. Unlike post-render scripts, Pandoc filters are executed during the creation of the output files.\n\nExample 12 ¬†\n\n*.qmddate.lua\n\n\ndate: now\ndate-format: x\nfilters: date.lua\n\n\n-- https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nfunction unix2deco(ms)\n  local dote = ms / 86400000 + 719468\n  local cykl = (\n    dote &gt;= 0 and dote\n    or dote - 146096\n  ) // 146097\n  local dotc = dote - cykl * 146097\n  local yotc = (\n    dotc - dotc // 1460\n    + dotc // 36524\n    - dotc // 146096\n  ) // 365\n  return string.format(\n    \"%s+%s\",\n    math.floor(yotc + cykl * 400),\n    math.floor(dotc - (yotc * 365\n      + yotc // 4\n      - yotc // 100)))\nend\n\nlocal function to_decalendar(date)\n  local date = pandoc.utils.stringify(date)\n  local unix = date:match(\"(%d+)\")\n  return date:gsub(unix, unix2deco(unix))\nend\n\nfunction Meta(m)\n  m.date = to_decalendar(m.date)\n  return m\nend\n\n\n\n\nAll three of the customizations I described above convert millisecond UNIX time into a custom date format, but you can adapt these approaches to make all sorts of edits to your Quarto site. HTML blocks can run JavaScript which excels at making content dynamic and interactive, pre- and post-render scripts can be in any programming language, while Pandoc filters are written in Lua and modify output during rendering.\nComing up next on my blog is a post that Observable graphics. Get ready for an animated and interactive data visualization extravaganza!"
  },
  {
    "objectID": "quarto/index.html",
    "href": "quarto/index.html",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto"
    ]
  },
  {
    "objectID": "quarto/index.html#tldr",
    "href": "quarto/index.html#tldr",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto"
    ]
  },
  {
    "objectID": "quarto/index.html#sec-intro",
    "href": "quarto/index.html#sec-intro",
    "title": "Quarto",
    "section": "Introduction",
    "text": "Introduction\nQuarto is an open-source software system for turning plain-text source files into outputs like articles, books, blogs, dashboards, presentations, reports, and websites. Announced on 2022+149 by Posit CEO JJ Allaire, Quarto is already taking the worldüåêby storm‚õàÔ∏è!\nI strongly believe that everyone, regardless of their background and current technical skill level, can learn and benefit from Quarto. Getting started with Quarto is easy thanks to its excellent documentation and vibrant community of enthusiastic users and developers.\nRather than repeat the basic information already available elsewhere, I will share some advanced techniques along with the fundamental knowledge needed to understand how they work. The topics I cover are very technical, but my goal is to make the content on my blog as accessible as possible.\nThe first topic I will delve into is creating and publishing a website with Quarto. To follow the Quarto documentation on creating a website, you will need Visual Studio Code (VSCode), VSCodium, RStudio, or a terminal.",
    "crumbs": [
      "Software",
      "Quarto"
    ]
  },
  {
    "objectID": "quarto/index.html#sec-pub",
    "href": "quarto/index.html#sec-pub",
    "title": "Quarto",
    "section": "Publishing Quarto sites",
    "text": "Publishing Quarto sites\n\nInstalling tools\nIf you use macOS, Linux, or the Windows Subsystem for Linux (WSL), you can install all of the aforementioned tools with the Homebrew package manager. To install everything you will need to follow along with this blog post, you can first install Homebrew and then run brew bundle in a directory that contains the Brewfile shown in Example¬†1.\n\nExample 1 ¬†\n\n\nBrewfile\n\nbrew \"gh\"\nbrew \"git\"\nbrew \"glab\"\ncask \"github\"\ncask \"quarto\"\ncask \"rstudio\"\ncask \"vscodium\"\ncask \"visual-studio-code\"\nvscode \"quarto.quarto\"\nvscode \"REditorSupport.r\"\n\n\nUsing a package manager like Homebrew to install all the requirements with a single shell command like brew bundle is the fastest and easiest way to get ready to follow along with this blog post. If you are curious about how I set up my computer, you can take a look at my Brewfile and other configuration files in my setup repository (repo) on GitHub and GitLab.\nApart from RStudio, VSCode, and VSCodium, the Brewfile in Example¬†1 will install the Git version control system, the GitHub and GitLab command line interfaces (CLIs), and GitHub Desktop, a Git Graphical User Interface (GUI). For more information on Git, a tool used by 93% of software developers worldwide according to survey results published by StackOverflow on 2022+314, take a look at the ‚ÄúGitHub for supporting, reusing, contributing, and failing safely‚Äù post by Allison Horst and Julie Lowndes on the Openscapes blog.\nAs an alternative to installing tools on your computer, you can use the web interface provided by GitHub Codespaces. To set up a Codespace, you can remove the lines that start with cask from the Brewfile provided in Example¬†1 and add the file to a repo called dotfiles and along with a setup.sh file like the one shown in Example¬†2.\n\nExample 2 ¬†\n\n\nsetup.sh\n\necho | /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n(echo; echo 'eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"') &gt;&gt; /home/codespace/.profile\neval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"\nbrew bundle\n\n\n\n\nPublishing overview\nOnce you are done setting up your computer or Codespace, you create a Quarto website template and make your site publicly available on the internet using one of the many available publishing services. To explore and assess different publishing workflows and free website hosting options, I set up my personal website on four different web hosts: Quarto Pub, Netlify, GitHub Pages, and GitLab Pages.\nThere are so many different ways to publish a Quarto site that I decided to come up with a naming system for Quarto publishing methods. The naming system derives a code for each publishing method from the numbered lists in the Quarto publishing documentation. For example, I refer to the two methods to publish to Quarto Pub as Q1 and Q2:\nTable¬†1 uses this naming system in its Code column to identify the publishing methods I discuss in this blog post. Each publishing method targets a particular web Host, Renders content locally or on a remote server, and deploys sites using either the quarto publish or the git push shell Command.\n\n\n\n\n\n\nCode\nHost\nRender\nCommand\n\n\n\n\nG1\nGitHub\nLocal\npush\n\n\nG2\nGitHub\nLocal\npublish\n\n\nG3\nGitHub\nRemote\npush\n\n\nN1\nNetlify\nLocal\npublish\n\n\nN2\nNetlify\nLocal\npush\n\n\nN3\nNetlify\nRemote\npush\n\n\nQ1\nQuarto\nLocal\npublish\n\n\nQ2\nQuarto\nRemote\npush\n\n\n\n\n\nTable¬†1: Quarto website publishing methods\n\n\n\n\n\nGit workflow\nThe first publishing method I tried for my personal site was G1, which requires the use of Git to push all website content to a Git provider like GitHub or GitLab. After I set up GitHub Pages and GitLab Pages, I could update my website on both of these web hosts just by going through the standard Git workflow shown in Figure¬†2.\n\n\n\n\n\n\nflowchart LR\n   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)\n\n\n\n\nFigure¬†2: Git workflow\n\n\n\n\n\nTo make it easier to make incremental changes to my website and frequently release new content, I combined all of the git shell commands in Figure¬†2 into a shell alias. You can add shell aliases to a shell configuration file like .bashrc or .zshrc on your computer to shorten commands or combine any sequence of commands into one step.\nThe aacmp alias in the .zshrc file in my setup repo allows me to enter a free-form commit message directly on the command line without quotes, e.g.¬†qp edit first blog. If you decide to try my aacmp alias, please exercise extreme caution as any un-escaped or un-quoted metacharacters may yield surprising effects instead of being included verbatim in the commit message. For example, qp * will list the contents of the current directory in the commit message in place of the asterisk!\nAn alternative to a shell alias that combines git commands is a keyboard shortcut in Git-enabled GUI. Example¬†3 shows two files, tasks.json and update.sh, that we can use to set up VSCode, VSCodium, and GitHub Codespaces to go through the Git workflow whenever we press Ctrl+Shift+B on Linux/Windows or ‚åò+Shift+B on Mac (mnemonic: B is for Build).\n\nExample 3 ¬†\n\nupdate.shtasks.json\n\n\n\n\n\n\n\n\n\n\nThis mechanism is called Tasks and is used to automate software build tasks, which can include any steps required to build and publish a website. Importantly, the Tasks mechanism requires that the tasks.json file be added to the .vscode directory and that we enable execution of the update.sh script by running chmod +x update.sh in our project root.\nShell aliases and keyboard shortcuts can greatly facilitate the Git workflow which is essential not only for G1, but also G3, N3, and Q2. Unlike these other publishing methods, G1 leads to messy commits that contain changes to both source and output files.\n\n\nquarto publish\nTo have cleaner commits, I switched from G1 to G2 by adding quarto publish to my publishing workflow. With G2, I can track changes to my source files on my main branch and publish my output files to GitHub Pages and GitLab Pages from my gh-pages branch.\nQ1, N1, and G2 all use quarto publish to render website content locally and then deploy it in one fell swoop. If you do not plan to use the Git version control system or the advanced features offered by GitHub, GitLab, or Netlify, then I recommend deploying your site to Quarto Pub by running quarto publish quarto-pub (Q1 in Table¬†1).\nLike Q1, N1 is a deployment method that does not require Git and makes it possible to deploy our site with a single shell command: quarto publish netlify. N1 provides access to the advanced web hosting features offered by Netlify and can even render content as long as code execution is frozen.\nTo deploy my site to GitHub Pages, GitLab Pages, and Netlify, I combined G2 and N2. When I run quarto publish gh-pages, Quarto renders my site into my output directory, copies the output directory contents to the gh-pages branch of my local repo, and then commits and pushes the changes to my remote repos on GitHub and GitLab, which triggers Netlify to build my site from the gh-pages branch.\nTo summarize the Quarto publishing methods I discussed so far, Q1 and N1 are easy to configure and use, N2 automatically builds sites from Git repos, G1 is not recommended because it pollutes commits with output file changes, and G2 is more difficult to set up and use but provides clean commits and a nice separation of source and output files.\n\n\nGitHub Actions\nAll of the publishing methods I have discussed so far require us to generate output files locally by rendering our source files. In contrast, Q2, G3, and N3 make it possible to skip local rendering in favor of relying on GitHub Actions to handle all of the necessary steps.\nG3 is noteworthy, because it offers the same convenience of G1 but without messy commits that mix changes to source and output files. An added bonus of G3 is that rendering with GitHub Actions provides a reproducible computational environment that is not dependent on what you have installed on your computer.\nInstead of using GitHub Actions, I could have used GitLab CI/CD to build my site. I decided not to go down this route because the Quarto dev team has many GitHub Actions workflows available but currently no official support for GitLab CI/CD.\nBefore trying to use GitHub Actions or any other continuous integration systems in your publishing workflow, I suggest getting used to working with quarto publish (Q1, G2, or N1). You can always set up other publishing methods later without sacrificing anything, because all of the publishing methods except G1 can be combined together.\nIn Section¬†4, I will walk through the setup of both G2 and G3 to provide the option of rendering locally by running quarto publish or rendering remotely with GitHub Actions by pushing to the main branch. Along the way, I will share many practical tips and general advice that you can apply to any project.",
    "crumbs": [
      "Software",
      "Quarto"
    ]
  },
  {
    "objectID": "quarto/index.html#sec-set",
    "href": "quarto/index.html#sec-set",
    "title": "Quarto",
    "section": "Publishing setup",
    "text": "Publishing setup\n\nRepo setup\nBefore you can use GitHub Actions to publish your site, you will need a GitHub, an SSH key, and a repo like maptv.github.io that has a default branch called main and another branch which must be called gh-pages. If you want to publish on GitLab Pages, you will also need a GitLab account and an analogous GitLab repo like maptv.gitlab.io.\nYou can create the repo and the gh-pages branch using the web interface of https://github.com or https://gitlab.com in your browser, but the best way to start a new project is using the CLI for GitHub or GitLab in your terminal. First, run gh auth login or glab auth login and follow the prompts to authenticate via your web browser or with an authentication token.\nThe GitHub CLI allows you to add an SSH key to your account during or after authentication. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for adding an SSH key to your GitLab account.\nAfter authentication and SSH key setup, you can run the code in either of the code chunks in Example¬†4 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my .zshrc.\n\nExample 4 ¬†\n\nGitHubGitLab\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\ngh repo create USERNAME.github.io --add-readme --clone --public\ncd SITENAME\nquarto create project website USERNAME.github.io\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\nglab repo create USERNAME.gitlab.io --readme --defaultBranch main --public\ncd SITENAME\ngit pull origin main\ngit branch --set-upstream-to=origin/main main\nquarto create project website USERNAME.gitlab.io\n\n\n\n\nTo make it easier to maintain my site on both GitHub and GitLab Pages, I set up my local repo cloned to have two origin remote URLs using the code as shown in Example¬†5. Now, running quarto publish or git push in my local repo, updates my content on both GitHub and GitLab.\n\nExample 5 ¬†\ngit remote add lab git@gitlab.com:maptv/maptv.gitlab.io\ngit remote add hub git@github.com:maptv/maptv.github.io\ngit remote set-url --add origin $(git remote get-url lab)\n\nIf you want to have your website hosted on GitHub Pages, you will need to set gh-pages as your source branch in your repo settings. For GitLab Pages, you will need to add a .gitlab-ci.yml file to your repo and update your _quarto.yml file as shown in Example¬†6 to include .gitlab-ci.yml as a resource in your output directory.\n\nExample 6 ¬†\n\n.gitlab-ci.yml_quarto.yml\n\n\n\n\n\n\n\n\n\n\nBy default, GitLab Pages includes a random hash in site URLs. To shorten the URL of my GitLab Pages site to &lt;maptv.gitlab.io&gt;, I had to uncheck Use unique domain under Deploy &gt; Pages in the GitLab sidebar.\nAt this point, we have completed G2 setup and you should be able to run quarto publish gh-pages from your main branch to render your site and deploy it to GitHub and/or GitLab Pages. Deploying with quarto publish at least once is a prerequisite for setting up any of the publishing methods that rely on GitHub Actions, because quarto publish creates a _publish.yml file in the root of your project that is required for publishing via GitHub Actions.\n\n\nGitHub Actions\nIn addition to the steps described above, G3 setup requires that we create a .github/workflows directory and add a YAML file to that directory. Example¬†7 contains the gh-pages.yml file I use for my own site and the shell code that can used to obtain this file.\n\nExample 7 ¬†\n\ncurlgh-pages.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\n\n\n\n\n\nThe gh-pages.yml file in Example¬†7 installs Quarto, the R and Python programming languages, and the packages in the renv.lock and requirements.txt files. If you do not need R and/or Python, you can remove any unnecessary portions of the file.\nTo modify the Python files that are installed by GitHub Actions, you can edit the requirements.txt file in your repo. To update your renv.lock file so that it includes all of the R packages your site requires, run renv::snapshot() in an R session or Rscript -e renv::snapshot() in a shell.\nAfter pushing the gh-pages.yml file, you can visit the Actions tab in your remote repo on GitHub to check the progress of the deployment of your site. If your site did not build successfully, you can go through the logs to try to diagnose the problem.\nI added a ‚ÄúPush to GitLab‚Äù step to my gh-pages.yml to make GitHub Actions push my remote gh-pages to GitLab so that my site is kept in sync on both GitHub and GitLab Pages. This required manually creating a token on GitLab and adding it to GitHub, which I accomplished using the GitHub CLI as shown in Example¬†8.\n\nExample 8 ¬†\ngh secret set GITLAB_AUTH_TOKEN\n\nAfter the setup described above, I now have two options for publishing my Quarto site: quarto publish and 2) git push. In addition to GitHub and GitLab Pages, both of these options automatically update my site on Netlify via N2.\nTo also automatically update my site on Quarto Pub, I created a separate GitHub Actions workflow by adding another YAML file to the .github/workflows directory in my repo. Example¬†9 shows my quarto-pub.yml file and the shell code that can be used to obtain it.\n\nExample 9 ¬†\n\ncurlquarto-pub.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\n\n\n\n\n\nMy quarto-pub.yml file is based on Q2, but it runs upon completion of the pages-build-deployment workflow instead of a push to main. I changed the workflow trigger so that it runs after my GitHub Pages site is built, regardless of whether I triggered the build by running quarto publish gh-pages or pushing to main.\nFigure¬†3 summarizes all of the steps that occur during my Quarto publishing workflow. This workflow allows me to publish my site on four web hosts every time I run quarto publish gh-pages (G2) or git push (G3)!\n\n\n\n\n\n\nflowchart LR\n    A[local&lt;br/&gt;main]-.G2.-&gt;B[local&lt;br/&gt;gh-pages]-.G2.-&gt;C[GitHub&lt;br/&gt;gh-pages]\n    B[local&lt;br/&gt;gh-pages]-.G2.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;F[GitHub&lt;br/&gt;main]-.G3.-&gt;C[GitHub&lt;br/&gt;gh-pages]-.G3.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;G[GitLab&lt;br/&gt;main]\n    C[GitHub&lt;br/&gt;gh-pages]-.N2.-&gt;E[Netlify]\n    C[GitHub&lt;br/&gt;gh-pages]-.Q2.-&gt;H[Quarto&lt;br/&gt;Pub]\n\n\n\n\nFigure¬†3: Quarto publishing workflow\n\n\n\n\n\nSo far I have only noticed one difference between the four web hosts I use for my site: GitHub Pages is the only web host that properly differentiates between internal and external links. All of the other web hosts include the external link icon on all links regardless of whether they target my site or an external site.\nI tried unsuccessfully to solve this issue by setting the link-external-filter property to a regular expression. If you notice a problem with the link-external-icon feature on other web hosts, I suggest switching to GitHub Pages.",
    "crumbs": [
      "Software",
      "Quarto"
    ]
  },
  {
    "objectID": "quarto/index.html#sec-cust",
    "href": "quarto/index.html#sec-cust",
    "title": "Quarto",
    "section": "Customizing Quarto sites",
    "text": "Customizing Quarto sites\n\nSite navigation\nOnce your site is built and published, you can make it easier to navigate with a customized navigation bar (navbar) and sidebar, as described in the Quarto documentation. Check out the _quarto.yml files for my site and the Quarto documentation site to see how the navigation components are set up.\nIn my navbar, I added toggle buttons for reader mode and dark mode. The names of the other icons on right side of the navbar are included in the sidebar.\n\n\nHTML blocks\nMy navbar also provides the current date and time in Dec ordinal (deco) format, which counts the years since 1 BC and the days since March 1. Dec is a calendar and time system that I created and use throughout my blog.\nTo add a custom timestamp to the navbar, I put a &lt;script&gt; element that runs time.js in an HTML block in every Quarto markdown (.qmd) file, as shown in Example¬†10. Mine √áetinkaya-Rundel wrote about HTML blocks as part of her A Quarto tip a day project.\n\nExample 10 ¬†\n\n*.qmdtime.js\n\n\n```{=html}\n&lt;script src=\"time.js\"&gt;&lt;/script&gt;\n```\n\n\n\n\n\n\n\nHTML blocks are useful for running JavaScript code in the context of a single page on your site without affecting the others. I also use HTML blocks to add a &lt;style&gt; element to my .qmd files as a last ditch effort to fine tune the style of my site.\nBefore I resort to the &lt;style&gt; element approach, I try writing CSS in my style.css, light.css, and dark.css files. So far, this approach has been sufficient to make any styling changes I want, but if it every fails, I can use JavaScript to override the default styling provided by Quarto by modifying style attributes, which have the highest specificity in CSS.\n\n\nPost-render script\nI wanted to my blog‚Äôs listing page to show dates in the same format as the navbar timestamp. To accomplish this, I used a post-render script written in the Python programming language.\nPre- and post-render scripts are set as project options in the _quarto.yml file in the root of your Quarto project. Example¬†11 shows the date.py post-render script and how this script is referenced in _quarto.yml.\n\nExample 11 ¬†\n\n_quarto.ymldate.py\n\n\n\n\n\n\n\n\n\n\nNormally, formatting dates in Quarto is as easy as setting the date-format YAML property. In my case it was more difficult, because I wanted dates based on Dec, the calendar and time system I created, instead of the ubiquitous Gregorian calendar.\nTo facilitate the calculations in date.py, I set date-format to x in my _metadata.yml file so all of the dates would be in millisecond UNIX time and I would not have to deal with Gregorian calendar date formats or time zones. After all of the dates are generated, my date.py script traverses the HTML in the output directory using Beautiful Soup and converts millisecond UNIX time dates into Dec dates (year+day).\n\n\nPandoc filter\nIn addition to customizing dates on the listing page of my blog, I wanted to customize the date format in every blog post. To complete this task, I used a Lua script as a Pandoc filter.\nPandoc is a program that converts documents into practically any format. The ‚Äúpan‚Äù in Pandoc comes from the Ancient Greek word for all. Pandoc strives to convert all document formats, just like Pangea contained all the land and a panacea solves all problems.\nQuarto uses Pandoc to convert markdown files into target format(s) like html or pdf. If the source files contain executable code, Quarto executes the code via one of two computational engines: Jupyter or Knitr. Figure¬†4 shows the Quarto workflow.\n\n\n\n\n\n\nflowchart LR\n   A[qmd&lt;br/&gt;ipynb]-.Knitr&lt;br/&gt;Jupyter.-&gt;B((md))-.Pandoc with&lt;br/&gt;Lua filters.-&gt;C(html&lt;br/&gt;pdf&lt;br/&gt;docx&lt;br/&gt;etc.)\n\n\n\n\nFigure¬†4: Quarto rendering workflow\n\n\n\n\n\nMine √áetinkaya-Rundel‚Äôs Quarto tip series includes a similar Quarto workflow mermaid diagram and her ‚ÄúHello, Quarto!‚Äù rstudio::conf(2022) keynote with Julia Stewart Lowndes contains truly beautiful Quarto workflow images by Allison Horst: 1, 2, 3, and 4.\nQuarto controls Pandoc, Jupyter, and Knitr in two ways: 1) with arguments passed to the Quarto CLI commands and 2) with YAML key-value pairs in .qmd, .ipynb, or .yml files.\nExample¬†12 shows how I set up every qmd file to generate the current date in millisecond UNIX time and designated date.lua as a Pandoc filter. Unlike post-render scripts, Pandoc filters are executed during the creation of the output files.\n\nExample 12 ¬†\n\n*.qmddate.lua\n\n\ndate: now\ndate-format: x\nfilters: date.lua\n\n\n\n\n\n\n\nAll three of the customizations I described above convert millisecond UNIX time into a custom date format, but you can adapt these approaches to make all sorts of edits to your Quarto site. HTML blocks can run JavaScript which excels at making content dynamic and interactive, pre- and post-render scripts can be in any programming language, while Pandoc filters are written in Lua and modify output during rendering.\nComing up next on my blog is a post that Observable graphics. Get ready for an animated and interactive data visualization extravaganza!",
    "crumbs": [
      "Software",
      "Quarto"
    ]
  },
  {
    "objectID": "quarto/filter/index.html",
    "href": "quarto/filter/index.html",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto",
      "Filter"
    ]
  },
  {
    "objectID": "quarto/filter/index.html#tldr",
    "href": "quarto/filter/index.html#tldr",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto",
      "Filter"
    ]
  },
  {
    "objectID": "quarto/filter/index.html#sec-intro",
    "href": "quarto/filter/index.html#sec-intro",
    "title": "Quarto",
    "section": "Introduction",
    "text": "Introduction\nQuarto is an open-source software system for turning plain-text source files into outputs like articles, books, blogs, dashboards, presentations, reports, and websites. Announced on 2022+149 by Posit CEO JJ Allaire, Quarto is already taking the worldüåêby storm‚õàÔ∏è!\nI strongly believe that everyone, regardless of their background and current technical skill level, can learn and benefit from Quarto. Getting started with Quarto is easy thanks to its excellent documentation and vibrant community of enthusiastic users and developers.\nRather than repeat the basic information already available elsewhere, I will share some advanced techniques along with the fundamental knowledge needed to understand how they work. The topics I cover are very technical, but my goal is to make the content on my blog as accessible as possible.\nThe first topic I will delve into is creating and publishing a website with Quarto. To follow the Quarto documentation on creating a website, you will need Visual Studio Code (VSCode), VSCodium, RStudio, or a terminal.",
    "crumbs": [
      "Software",
      "Quarto",
      "Filter"
    ]
  },
  {
    "objectID": "quarto/filter/index.html#sec-pub",
    "href": "quarto/filter/index.html#sec-pub",
    "title": "Quarto",
    "section": "Publishing Quarto sites",
    "text": "Publishing Quarto sites\n\nInstalling tools\nIf you use macOS, Linux, or the Windows Subsystem for Linux (WSL), you can install all of the aforementioned tools with the Homebrew package manager. To install everything you will need to follow along with this blog post, you can first install Homebrew and then run brew bundle in a directory that contains the Brewfile shown in Example¬†1.\n\nExample 1 ¬†\n\n\nBrewfile\n\nbrew \"gh\"\nbrew \"git\"\nbrew \"glab\"\ncask \"github\"\ncask \"quarto\"\ncask \"rstudio\"\ncask \"vscodium\"\ncask \"visual-studio-code\"\nvscode \"quarto.quarto\"\nvscode \"REditorSupport.r\"\n\n\nUsing a package manager like Homebrew to install all the requirements with a single shell command like brew bundle is the fastest and easiest way to get ready to follow along with this blog post. If you are curious about how I set up my computer, you can take a look at my Brewfile and other configuration files in my setup repository (repo) on GitHub and GitLab.\nApart from RStudio, VSCode, and VSCodium, the Brewfile in Example¬†1 will install the Git version control system, the GitHub and GitLab command line interfaces (CLIs), and GitHub Desktop, a Git Graphical User Interface (GUI). For more information on Git, a tool used by 93% of software developers worldwide according to survey results published by StackOverflow on 2022+314, take a look at the ‚ÄúGitHub for supporting, reusing, contributing, and failing safely‚Äù post by Allison Horst and Julie Lowndes on the Openscapes blog.\nAs an alternative to installing tools on your computer, you can use the web interface provided by GitHub Codespaces. To set up a Codespace, you can remove the lines that start with cask from the Brewfile provided in Example¬†1 and add the file to a repo called dotfiles and along with a setup.sh file like the one shown in Example¬†2.\n\nExample 2 ¬†\n\n\nsetup.sh\n\necho | /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n(echo; echo 'eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"') &gt;&gt; /home/codespace/.profile\neval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"\nbrew bundle\n\n\n\n\nPublishing overview\nOnce you are done setting up your computer or Codespace, you create a Quarto website template and make your site publicly available on the internet using one of the many available publishing services. To explore and assess different publishing workflows and free website hosting options, I set up my personal website on four different web hosts: Quarto Pub, Netlify, GitHub Pages, and GitLab Pages.\nThere are so many different ways to publish a Quarto site that I decided to come up with a naming system for Quarto publishing methods. The naming system derives a code for each publishing method from the numbered lists in the Quarto publishing documentation. For example, I refer to the two methods to publish to Quarto Pub as Q1 and Q2:\nTable¬†1 uses this naming system in its Code column to identify the publishing methods I discuss in this blog post. Each publishing method targets a particular web Host, Renders content locally or on a remote server, and deploys sites using either the quarto publish or the git push shell Command.\n\n\n\n\n\n\nCode\nHost\nRender\nCommand\n\n\n\n\nG1\nGitHub\nLocal\npush\n\n\nG2\nGitHub\nLocal\npublish\n\n\nG3\nGitHub\nRemote\npush\n\n\nN1\nNetlify\nLocal\npublish\n\n\nN2\nNetlify\nLocal\npush\n\n\nN3\nNetlify\nRemote\npush\n\n\nQ1\nQuarto\nLocal\npublish\n\n\nQ2\nQuarto\nRemote\npush\n\n\n\n\n\nTable¬†1: Quarto website publishing methods\n\n\n\n\n\nGit workflow\nThe first publishing method I tried for my personal site was G1, which requires the use of Git to push all website content to a Git provider like GitHub or GitLab. After I set up GitHub Pages and GitLab Pages, I could update my website on both of these web hosts just by going through the standard Git workflow shown in Figure¬†2.\n\n\n\n\n\n\nflowchart LR\n   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)\n\n\n\n\nFigure¬†2: Git workflow\n\n\n\n\n\nTo make it easier to make incremental changes to my website and frequently release new content, I combined all of the git shell commands in Figure¬†2 into a shell alias. You can add shell aliases to a shell configuration file like .bashrc or .zshrc on your computer to shorten commands or combine any sequence of commands into one step.\nThe aacmp alias in the .zshrc file in my setup repo allows me to enter a free-form commit message directly on the command line without quotes, e.g.¬†qp edit first blog. If you decide to try my aacmp alias, please exercise extreme caution as any un-escaped or un-quoted metacharacters may yield surprising effects instead of being included verbatim in the commit message. For example, qp * will list the contents of the current directory in the commit message in place of the asterisk!\nAn alternative to a shell alias that combines git commands is a keyboard shortcut in Git-enabled GUI. Example¬†3 shows two files, tasks.json and update.sh, that we can use to set up VSCode, VSCodium, and GitHub Codespaces to go through the Git workflow whenever we press Ctrl+Shift+B on Linux/Windows or ‚åò+Shift+B on Mac (mnemonic: B is for Build).\n\nExample 3 ¬†\n\nupdate.shtasks.json\n\n\n\n\n\n\n\n\n\n\nThis mechanism is called Tasks and is used to automate software build tasks, which can include any steps required to build and publish a website. Importantly, the Tasks mechanism requires that the tasks.json file be added to the .vscode directory and that we enable execution of the update.sh script by running chmod +x update.sh in our project root.\nShell aliases and keyboard shortcuts can greatly facilitate the Git workflow which is essential not only for G1, but also G3, N3, and Q2. Unlike these other publishing methods, G1 leads to messy commits that contain changes to both source and output files.\n\n\nquarto publish\nTo have cleaner commits, I switched from G1 to G2 by adding quarto publish to my publishing workflow. With G2, I can track changes to my source files on my main branch and publish my output files to GitHub Pages and GitLab Pages from my gh-pages branch.\nQ1, N1, and G2 all use quarto publish to render website content locally and then deploy it in one fell swoop. If you do not plan to use the Git version control system or the advanced features offered by GitHub, GitLab, or Netlify, then I recommend deploying your site to Quarto Pub by running quarto publish quarto-pub (Q1 in Table¬†1).\nLike Q1, N1 is a deployment method that does not require Git and makes it possible to deploy our site with a single shell command: quarto publish netlify. N1 provides access to the advanced web hosting features offered by Netlify and can even render content as long as code execution is frozen.\nTo deploy my site to GitHub Pages, GitLab Pages, and Netlify, I combined G2 and N2. When I run quarto publish gh-pages, Quarto renders my site into my output directory, copies the output directory contents to the gh-pages branch of my local repo, and then commits and pushes the changes to my remote repos on GitHub and GitLab, which triggers Netlify to build my site from the gh-pages branch.\nTo summarize the Quarto publishing methods I discussed so far, Q1 and N1 are easy to configure and use, N2 automatically builds sites from Git repos, G1 is not recommended because it pollutes commits with output file changes, and G2 is more difficult to set up and use but provides clean commits and a nice separation of source and output files.\n\n\nGitHub Actions\nAll of the publishing methods I have discussed so far require us to generate output files locally by rendering our source files. In contrast, Q2, G3, and N3 make it possible to skip local rendering in favor of relying on GitHub Actions to handle all of the necessary steps.\nG3 is noteworthy, because it offers the same convenience of G1 but without messy commits that mix changes to source and output files. An added bonus of G3 is that rendering with GitHub Actions provides a reproducible computational environment that is not dependent on what you have installed on your computer.\nInstead of using GitHub Actions, I could have used GitLab CI/CD to build my site. I decided not to go down this route because the Quarto dev team has many GitHub Actions workflows available but currently no official support for GitLab CI/CD.\nBefore trying to use GitHub Actions or any other continuous integration systems in your publishing workflow, I suggest getting used to working with quarto publish (Q1, G2, or N1). You can always set up other publishing methods later without sacrificing anything, because all of the publishing methods except G1 can be combined together.\nIn Section¬†4, I will walk through the setup of both G2 and G3 to provide the option of rendering locally by running quarto publish or rendering remotely with GitHub Actions by pushing to the main branch. Along the way, I will share many practical tips and general advice that you can apply to any project.",
    "crumbs": [
      "Software",
      "Quarto",
      "Filter"
    ]
  },
  {
    "objectID": "quarto/filter/index.html#sec-set",
    "href": "quarto/filter/index.html#sec-set",
    "title": "Quarto",
    "section": "Publishing setup",
    "text": "Publishing setup\n\nRepo setup\nBefore you can use GitHub Actions to publish your site, you will need a GitHub, an SSH key, and a repo like maptv.github.io that has a default branch called main and another branch which must be called gh-pages. If you want to publish on GitLab Pages, you will also need a GitLab account and an analogous GitLab repo like maptv.gitlab.io.\nYou can create the repo and the gh-pages branch using the web interface of https://github.com or https://gitlab.com in your browser, but the best way to start a new project is using the CLI for GitHub or GitLab in your terminal. First, run gh auth login or glab auth login and follow the prompts to authenticate via your web browser or with an authentication token.\nThe GitHub CLI allows you to add an SSH key to your account during or after authentication. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for adding an SSH key to your GitLab account.\nAfter authentication and SSH key setup, you can run the code in either of the code chunks in Example¬†4 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my .zshrc.\n\nExample 4 ¬†\n\nGitHubGitLab\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\ngh repo create USERNAME.github.io --add-readme --clone --public\ncd SITENAME\nquarto create project website USERNAME.github.io\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\nglab repo create USERNAME.gitlab.io --readme --defaultBranch main --public\ncd SITENAME\ngit pull origin main\ngit branch --set-upstream-to=origin/main main\nquarto create project website USERNAME.gitlab.io\n\n\n\n\nTo make it easier to maintain my site on both GitHub and GitLab Pages, I set up my local repo cloned to have two origin remote URLs using the code as shown in Example¬†5. Now, running quarto publish or git push in my local repo, updates my content on both GitHub and GitLab.\n\nExample 5 ¬†\ngit remote add lab git@gitlab.com:maptv/maptv.gitlab.io\ngit remote add hub git@github.com:maptv/maptv.github.io\ngit remote set-url --add origin $(git remote get-url lab)\n\nIf you want to have your website hosted on GitHub Pages, you will need to set gh-pages as your source branch in your repo settings. For GitLab Pages, you will need to add a .gitlab-ci.yml file to your repo and update your _quarto.yml file as shown in Example¬†6 to include .gitlab-ci.yml as a resource in your output directory.\n\nExample 6 ¬†\n\n.gitlab-ci.yml_quarto.yml\n\n\n# https://docs.gitlab.com/ee/user/project/pages/introduction.html#customize-the-default-folder\npages:\n  script: echo \"The site will be deployed to $CI_PAGES_URL\"\n  artifacts:\n    paths:\n      - \".\"\n  publish: \".\"\n  only:\n    - gh-pages\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\n\n\n\n\nBy default, GitLab Pages includes a random hash in site URLs. To shorten the URL of my GitLab Pages site to &lt;maptv.gitlab.io&gt;, I had to uncheck Use unique domain under Deploy &gt; Pages in the GitLab sidebar.\nAt this point, we have completed G2 setup and you should be able to run quarto publish gh-pages from your main branch to render your site and deploy it to GitHub and/or GitLab Pages. Deploying with quarto publish at least once is a prerequisite for setting up any of the publishing methods that rely on GitHub Actions, because quarto publish creates a _publish.yml file in the root of your project that is required for publishing via GitHub Actions.\n\n\nGitHub Actions\nIn addition to the steps described above, G3 setup requires that we create a .github/workflows directory and add a YAML file to that directory. Example¬†7 contains the gh-pages.yml file I use for my own site and the shell code that can used to obtain this file.\n\nExample 7 ¬†\n\ncurlgh-pages.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_dispatch:\n  push:\n    branches: [main]\n\nname: Quarto Publish\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out repository\n        uses: actions/checkout@v4\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n        with:\n          version: '1.4.489'\n          tinytex: true\n\n      - name: Install R\n        uses: r-lib/actions/setup-r@v2\n        with:\n          r-version: '4.2.0'\n\n      - name: Install R Dependencies\n        uses: r-lib/actions/setup-renv@v2\n        with:\n          cache-version: 1\n\n      - name: Install Python and Dependencies\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n          cache: 'pip'\n      - run: pip install jupyter\n      - run: pip install -r requirements.txt\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: Push To GitLab\n        env:\n          token: ${{ secrets.GITLAB_AUTH_TOKEN }}\n        run: |\n          echo Starting to push gh-pages branch to GitLab\n          git config user.name \"maptv\"\n          git config user.email \"129316885+maptv@users.noreply.github.com\"\n          git remote set-url origin \"https://oauth2:${token}@gitlab.com/maptv/maptv.gitlab.io\"\n          git push origin gh-pages\n\n\n\n\nThe gh-pages.yml file in Example¬†7 installs Quarto, the R and Python programming languages, and the packages in the renv.lock and requirements.txt files. If you do not need R and/or Python, you can remove any unnecessary portions of the file.\nTo modify the Python files that are installed by GitHub Actions, you can edit the requirements.txt file in your repo. To update your renv.lock file so that it includes all of the R packages your site requires, run renv::snapshot() in an R session or Rscript -e renv::snapshot() in a shell.\nAfter pushing the gh-pages.yml file, you can visit the Actions tab in your remote repo on GitHub to check the progress of the deployment of your site. If your site did not build successfully, you can go through the logs to try to diagnose the problem.\nI added a ‚ÄúPush to GitLab‚Äù step to my gh-pages.yml to make GitHub Actions push my remote gh-pages to GitLab so that my site is kept in sync on both GitHub and GitLab Pages. This required manually creating a token on GitLab and adding it to GitHub, which I accomplished using the GitHub CLI as shown in Example¬†8.\n\nExample 8 ¬†\ngh secret set GITLAB_AUTH_TOKEN\n\nAfter the setup described above, I now have two options for publishing my Quarto site: quarto publish and 2) git push. In addition to GitHub and GitLab Pages, both of these options automatically update my site on Netlify via N2.\nTo also automatically update my site on Quarto Pub, I created a separate GitHub Actions workflow by adding another YAML file to the .github/workflows directory in my repo. Example¬†9 shows my quarto-pub.yml file and the shell code that can be used to obtain it.\n\nExample 9 ¬†\n\ncurlquarto-pub.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_run:\n    workflows: [pages-build-deployment]\n    types: [completed]\n\nname: Update Quarto Pub\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Check out main repository\n        uses: actions/checkout@v4\n\n      - name: Check out _site\n        uses: actions/checkout@v4\n        with:\n          ref: gh-pages\n          path: _site\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: quarto-pub\n          render: false\n          QUARTO_PUB_AUTH_TOKEN: ${{ secrets.QUARTO_PUB_AUTH_TOKEN }}\n          GITHUB_USERNAME: maptv\n\n\n\n\nMy quarto-pub.yml file is based on Q2, but it runs upon completion of the pages-build-deployment workflow instead of a push to main. I changed the workflow trigger so that it runs after my GitHub Pages site is built, regardless of whether I triggered the build by running quarto publish gh-pages or pushing to main.\nFigure¬†3 summarizes all of the steps that occur during my Quarto publishing workflow. This workflow allows me to publish my site on four web hosts every time I run quarto publish gh-pages (G2) or git push (G3)!\n\n\n\n\n\n\nflowchart LR\n    A[local&lt;br/&gt;main]-.G2.-&gt;B[local&lt;br/&gt;gh-pages]-.G2.-&gt;C[GitHub&lt;br/&gt;gh-pages]\n    B[local&lt;br/&gt;gh-pages]-.G2.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;F[GitHub&lt;br/&gt;main]-.G3.-&gt;C[GitHub&lt;br/&gt;gh-pages]-.G3.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;G[GitLab&lt;br/&gt;main]\n    C[GitHub&lt;br/&gt;gh-pages]-.N2.-&gt;E[Netlify]\n    C[GitHub&lt;br/&gt;gh-pages]-.Q2.-&gt;H[Quarto&lt;br/&gt;Pub]\n\n\n\n\nFigure¬†3: Quarto publishing workflow\n\n\n\n\n\nSo far I have only noticed one difference between the four web hosts I use for my site: GitHub Pages is the only web host that properly differentiates between internal and external links. All of the other web hosts include the external link icon on all links regardless of whether they target my site or an external site.\nI tried unsuccessfully to solve this issue by setting the link-external-filter property to a regular expression. If you notice a problem with the link-external-icon feature on other web hosts, I suggest switching to GitHub Pages.",
    "crumbs": [
      "Software",
      "Quarto",
      "Filter"
    ]
  },
  {
    "objectID": "quarto/filter/index.html#sec-cust",
    "href": "quarto/filter/index.html#sec-cust",
    "title": "Quarto",
    "section": "Customizing Quarto sites",
    "text": "Customizing Quarto sites\n\nSite navigation\nOnce your site is built and published, you can make it easier to navigate with a customized navigation bar (navbar) and sidebar, as described in the Quarto documentation. Check out the _quarto.yml files for my site and the Quarto documentation site to see how the navigation components are set up.\nIn my navbar, I added toggle buttons for reader mode and dark mode. The names of the other icons on right side of the navbar are included in the sidebar.\n\n\nHTML blocks\nMy navbar also provides the current date and time in Dec ordinal (deco) format, which counts the years since 1 BC and the days since March 1. Dec is a calendar and time system that I created and use throughout my blog.\nTo add a custom timestamp to the navbar, I put a &lt;script&gt; element that runs time.js in an HTML block in every Quarto markdown (.qmd) file, as shown in Example¬†10. Mine √áetinkaya-Rundel wrote about HTML blocks as part of her A Quarto tip a day project.\n\nExample 10 ¬†\n\n*.qmdtime.js\n\n\n```{=html}\n&lt;script src=\"time.js\"&gt;&lt;/script&gt;\n```\n\n\n\n\n\n\n\nHTML blocks are useful for running JavaScript code in the context of a single page on your site without affecting the others. I also use HTML blocks to add a &lt;style&gt; element to my .qmd files as a last ditch effort to fine tune the style of my site.\nBefore I resort to the &lt;style&gt; element approach, I try writing CSS in my style.css, light.css, and dark.css files. So far, this approach has been sufficient to make any styling changes I want, but if it every fails, I can use JavaScript to override the default styling provided by Quarto by modifying style attributes, which have the highest specificity in CSS.\n\n\nPost-render script\nI wanted to my blog‚Äôs listing page to show dates in the same format as the navbar timestamp. To accomplish this, I used a post-render script written in the Python programming language.\nPre- and post-render scripts are set as project options in the _quarto.yml file in the root of your Quarto project. Example¬†11 shows the date.py post-render script and how this script is referenced in _quarto.yml.\n\nExample 11 ¬†\n\n_quarto.ymldate.py\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\ndate-format: x\n\n\n# https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nimport bs4\n\ndef unix2doty(ms):\n    dote = ms / 86400000 + 719468\n    cykl = (\n        dote if dote &gt;= 0\n        else dote - 146096\n    ) // 146097\n    dotc = dote - cykl * 146097\n    yotc = (dotc\n        - dotc // 1460\n        + dotc // 36524\n        - dotc // 146096\n    ) // 365\n    return [\n        int(yotc + cykl * 400),\n        dotc - (yotc * 365\n            + yotc // 4\n            - yotc // 100\n        )\n    ]\n\nwith open(\"_site/list/index.html\") as infile:\n    txt = infile.read()\n    soup = bs4.BeautifulSoup(txt, features=\"html.parser\")\nfor div in soup.find_all(\"div\", {\"class\": \"card-file-modified\"}):\n    elem = div.find(\"p\")\n    if \"+\" not in elem.text:\n        y, d = unix2doty(int(div.text))\n        elem.string.replace_with(f\"{y:&gt;04}+{d.__floor__():&gt;03}\")\nfor div in soup.find_all(\"div\", {\"class\": \"listing-reading-time\"}):\n    if \"min\" in div.text:\n        div.string.replace_with(f\"{(int(div.text.split()[0]) / 1.44).__floor__()} milliday\")\nwith open(\"_site/list/index.html\", \"w\") as outfile:\n    outfile.write(str(soup))\n\n\n\n\nNormally, formatting dates in Quarto is as easy as setting the date-format YAML property. In my case it was more difficult, because I wanted dates based on Dec, the calendar and time system I created, instead of the ubiquitous Gregorian calendar.\nTo facilitate the calculations in date.py, I set date-format to x in my _metadata.yml file so all of the dates would be in millisecond UNIX time and I would not have to deal with Gregorian calendar date formats or time zones. After all of the dates are generated, my date.py script traverses the HTML in the output directory using Beautiful Soup and converts millisecond UNIX time dates into Dec dates (year+day).\n\n\nPandoc filter\nIn addition to customizing dates on the listing page of my blog, I wanted to customize the date format in every blog post. To complete this task, I used a Lua script as a Pandoc filter.\nPandoc is a program that converts documents into practically any format. The ‚Äúpan‚Äù in Pandoc comes from the Ancient Greek word for all. Pandoc strives to convert all document formats, just like Pangea contained all the land and a panacea solves all problems.\nQuarto uses Pandoc to convert markdown files into target format(s) like html or pdf. If the source files contain executable code, Quarto executes the code via one of two computational engines: Jupyter or Knitr. Figure¬†4 shows the Quarto workflow.\n\n\n\n\n\n\nflowchart LR\n   A[qmd&lt;br/&gt;ipynb]-.Knitr&lt;br/&gt;Jupyter.-&gt;B((md))-.Pandoc with&lt;br/&gt;Lua filters.-&gt;C(html&lt;br/&gt;pdf&lt;br/&gt;docx&lt;br/&gt;etc.)\n\n\n\n\nFigure¬†4: Quarto rendering workflow\n\n\n\n\n\nMine √áetinkaya-Rundel‚Äôs Quarto tip series includes a similar Quarto workflow mermaid diagram and her ‚ÄúHello, Quarto!‚Äù rstudio::conf(2022) keynote with Julia Stewart Lowndes contains truly beautiful Quarto workflow images by Allison Horst: 1, 2, 3, and 4.\nQuarto controls Pandoc, Jupyter, and Knitr in two ways: 1) with arguments passed to the Quarto CLI commands and 2) with YAML key-value pairs in .qmd, .ipynb, or .yml files.\nExample¬†12 shows how I set up every qmd file to generate the current date in millisecond UNIX time and designated date.lua as a Pandoc filter. Unlike post-render scripts, Pandoc filters are executed during the creation of the output files.\n\nExample 12 ¬†\n\n*.qmddate.lua\n\n\ndate: now\ndate-format: x\nfilters: date.lua\n\n\n-- https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nfunction unix2deco(ms)\n  local dote = ms / 86400000 + 719468\n  local cykl = (\n    dote &gt;= 0 and dote\n    or dote - 146096\n  ) // 146097\n  local dotc = dote - cykl * 146097\n  local yotc = (\n    dotc - dotc // 1460\n    + dotc // 36524\n    - dotc // 146096\n  ) // 365\n  return string.format(\n    \"%s+%s\",\n    math.floor(yotc + cykl * 400),\n    math.floor(dotc - (yotc * 365\n      + yotc // 4\n      - yotc // 100)))\nend\n\nlocal function to_decalendar(date)\n  local date = pandoc.utils.stringify(date)\n  local unix = date:match(\"(%d+)\")\n  return date:gsub(unix, unix2deco(unix))\nend\n\nfunction Meta(m)\n  m.date = to_decalendar(m.date)\n  return m\nend\n\n\n\n\nAll three of the customizations I described above convert millisecond UNIX time into a custom date format, but you can adapt these approaches to make all sorts of edits to your Quarto site. HTML blocks can run JavaScript which excels at making content dynamic and interactive, pre- and post-render scripts can be in any programming language, while Pandoc filters are written in Lua and modify output during rendering.\nComing up next on my blog is a post that Observable graphics. Get ready for an animated and interactive data visualization extravaganza!",
    "crumbs": [
      "Software",
      "Quarto",
      "Filter"
    ]
  },
  {
    "objectID": "software/positron/index.html",
    "href": "software/positron/index.html",
    "title": "Positron",
    "section": "",
    "text": "The goal of this blog post, the second in the Tools blog post series summarized by Figure¬†1, is to set up the Visual Studio Code (VSCode) source-code editor to run in the remote development environments provided by the Codespaces and GitPod computing platforms. To accomplish this goal, we will use VSCode to edit a setup script and configuration files in a Git repository (repo) named dotfiles.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../knitr\"\n   click F \"../jupyter\"\n   style B stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart",
    "crumbs": [
      "Software",
      "Positron"
    ]
  },
  {
    "objectID": "software/positron/index.html#tldr",
    "href": "software/positron/index.html#tldr",
    "title": "Positron",
    "section": "",
    "text": "The goal of this blog post, the second in the Tools blog post series summarized by Figure¬†1, is to set up the Visual Studio Code (VSCode) source-code editor to run in the remote development environments provided by the Codespaces and GitPod computing platforms. To accomplish this goal, we will use VSCode to edit a setup script and configuration files in a Git repository (repo) named dotfiles.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../knitr\"\n   click F \"../jupyter\"\n   style B stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart",
    "crumbs": [
      "Software",
      "Positron"
    ]
  },
  {
    "objectID": "software/positron/index.html#sec-intro",
    "href": "software/positron/index.html#sec-intro",
    "title": "Positron",
    "section": "Introduction",
    "text": "Introduction\nEven more Web-based editors can even run code and build software if equipped with computational resources via a service such as GitHub Codespaces and GitPod. have free tiers that should be sufficient for most . in cloud-based environments, which facilitates reproducibility. Notably,\nLike vscode.dev, these web-based editors provide access to the Visual Studio Code (VSCode) source-code editor via a web browser, but distinguish themselves from editors that instead of the local file system. from other services that such as by\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Positron"
    ]
  },
  {
    "objectID": "software/positron/index.html#sec-setup",
    "href": "software/positron/index.html#sec-setup",
    "title": "Positron",
    "section": "Setup",
    "text": "Setup\n\nHomebrew\nLinux, macOS, or Windows Subsystem for Linux (WSL) users can use Homebrew to install everything needed to follow along with this blog post. First, install Homebrew with the latest .pkg installer for macOS or by running the Example¬†1 Unix shell code in your terminal.\n\nExample 1 ¬†\n/bin/bash -c \"$(curl -fsSL https://raw.github\\\nusercontent.com/Homebrew/install/HEAD/install.sh)\"\n\nIf you are not completely satisfied with the integrated terminal built into your preferred source-code editor or the standalone terminal that comes with your operating system (OS), you can use Homebrew to install a new one. The standalone terminal I use most often is iTerm2, which is only for macOS, but I also have the following multi-OS terminals: Alacritty, Hyper, Kitty, and Tabby.\nAfter installing Homebrew, you can run brew doctor in your terminal to confirm that everything is set up correctly. If the brew command is not available, you need to follow the instructions provided after installation to add brew to your PATH variable.\nOnce Homebrew is ready, you can run the shell code in Example¬†2 to create a file called Brewfile with the echo shell command and install everything listed in this newly created Brewfile with the brew bundle shell command.\n\nExample 2 ¬†\necho 'brew \"gh\"\\nbrew \"git\"\\nbrew \"glab\"\ncask \"github\"\\ncask \"rstudio\"\\ncask \"vscodium\"\ncask \"visual-studio-code\"' &gt; Brewfile\nbrew bundle\n\nThe Brewfile created by the shell code in Example¬†2 installs:\n\nGit,\nthe command line interfaces (CLIs) for\n\nGitHub and\nGitLab,\n\nthe GitHub Desktop Git Graphical User Interface (GUI), and\nthree source-code editors:\n\nVisual Studio Code (VSCode),\nVSCodium, and\nRStudio.\n\n\nIf you are curious about how I set up my computer, you can take a look at my Brewfile and other configuration files in my setup repo on GitHub and GitLab. I will highlight a few configuration files in Section¬†4.\n\n\nCodespaces\nAs an alternative to installing tools on your computer, you can use GitHub Codespaces to perform all development tasks remotely. To get a feel for Codespaces, I recommend you first try the github.dev editor.\nBoth Codespaces and github.dev allow you to edit files in any GitHub repository via VSCode in your browser and load your VSCode settings automatically via Settings Sync, but github.dev can be started by going to any repo on GitHub and pressing . or changing the .com in the URL to .dev, e.g. https://github.com/maptv/maptv.github.io to https://github.dev/maptv/maptv.github.io. The github.dev editor starts up fast and is completely free, but comes with restrictions that prevent us from running code, building software, accessing the integrated terminal, or using non-web extensions.\nIn addition to being free of these restrictions, Codespaces allows us to use JupyterLab as the web interface instead of VSCode by appending /?editor=jupyter to the Codespaces URL. If you use a JetBrains integrated development environmentproducts, such as PyCharm (IDE), you can also try appending /?editor=jetbrains to the Codespaces URL and accessing Codespaces via JetBrains Gateway.\nEvery Codespaces instance (codespace) is pre-equipped with commonly used tools. If you want your codespaces to start with additional tools or settings for any tools other than VSCode, you will need to create a repo called dotfiles and enable automatic installation of your configuration files into every codespace you create.\n‚ÄúDotfiles‚Äù is a general term for files that contain user settings. The term ‚Äúdotfiles‚Äù is derived from hidden files in Unix and Unix-like environments, which have names that start with a dot (.). Despite the origin of the term, not all dotfiles are hidden files.\nIn fact, there is a new convention that places non-hidden configuration files in a hidden directory called .config. Despite the growing popularity of this new convention, many dotfiles are still stored according to the old convention, i.e. as hidden files in the home directory.\nExample¬†3 shows how the Vim and Neovim text editors differ in their approach to dotfile storage. The Vim configuration file ~/.vimrc follows the old convention, while the Neovim configuration file (~/.config/nvim/init.vim) follows the new convention, where ~ represents the home directory and / is directory delimiter used in Unix paths.\n\nExample 3 ¬†\n~\n‚îú‚îÄ‚îÄ .config\n‚îÇ¬†¬† ‚îî‚îÄ‚îÄ nvim\n‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ init.vim\n‚îî‚îÄ‚îÄ .vimrc\n\nIf do not have configuration files for any tool other than VSCode and do not need to install anything as part of Codespaces setup, you can forego creating a dotfiles repo and simply enable Settings Sync.\nyou can simply include all of your configuration files in your dotfiles repo with the desired directory structure, e.g.¬†as in Example¬†3. This way, whenever a codespace is created, its home directory (/home/codespace) will be set up to match your dotfiles repo using symbolic links.\nWhile this automatic dotfile setup approach does not allow you to install any additional tools, it is simple and avoids any installation steps that can significantly slow down build times. Importantly, if GitHub determines that your dotfiles repo contains a setup script based on its naming convention, it will not run the setup script and ignore any other files in the repo, because of the expectation that users with setup scripts will want to organize their configuration files themselves.\nFor more information on dotfiles, check out the resources at https://dotfiles.github.io. Regardless o you do have way to configure VSCode, you do not have to set up Codespaces. Instead you can any of the steps below https://docs.github.com/en/codespaces/setting-your-user-preferences/personalizing-github-codespaces-for-your-account#settings-sync\nThe setup script can install\nRegardless of whether you have a dotfiles repo, you can use Settings Sync to maintain consistency between your local and remote development environments. keep all of your configuration files in a repo called dotfiles. Instead\nbut we can add anything that may be missing with a Brewfile and a setup script.\nIn other words, we have the option to simply put configuration files in our dotfiles repo and not install anything.\nMy configuration files have dependencies that are not included in the default Codespaces image, so the configuration-files-only approach would not work for me. Codespaces of the expectation\nI chose setup.sh as the name of my setup script because it was shortest name that followed the naming convention set by GitHub and had the .sh filename extension.\nFor my configurationI need at very least convenient feature is disabled when we include a setup script in our dotfiles repo, because\nThe tools listed in the Brewfile can be installed with a shell script that GitHub will run when building the Codespace.\nIt is essential that your setup script be added to Git as an executable script! I only needed to run the shell code in Example¬†4 once for Git to change the mode of setup.sh and remember forever that its access permissions include execution (x).\n\nExample 4 ¬†\ngit add setup.sh --chmod=+x\n\nMaintaining local and remote settings may be challenging, but Homebrew makes it easier with the $HOMEBREW_PREFIX environment variable. This variable contains the Homebrew installation path that matches your computer hardware and OS.\nBefore you can use $HOMEBREW_PREFIX, the brew command needs to be added to your PATH. To ensure Codespaces setup, I added the code in Example¬†5 to my .zshrc.\n\nExample 5 ¬†\n\n\n.zshrc\n\nif [[ \"$(uname)\" == 'Linux' ]]; then\n    eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"\nfi\n\n\nTo prevent conflicts with web browser keybindings, you can install Codespaces as a Progressive Web App (PWA) by clicking on the ‚ÄúInstall Codespaces‚Äù icon at the end of the URL bar in Chrome or any Chromium-based web browser. When running as a PWA, Codespaces behaves like a desktop application and can thus provide a familiar user experience on any computer!\nOn macOS, the PWA installation location is ~/Applications/Chrome Apps.localized.\n\n\nRepository\nBefore you can benefit from everything GitHub and GitLab have to offer, you will need a GitHub and/or GitLab account and an SSH key. Even though there are other authentication methods, SSH keys are still the easiest way to authenticate to GitHub and GitLab.\nYou can create a repo using the web interface of https://github.com or https://gitlab.com in your browser, but the best way to start a new project is using the CLI for GitHub or GitLab in your terminal. First, run gh auth login or glab auth login and follow the prompts to authenticate via your web browser or with an authentication token.\nThe GitHub CLI allows you to add an SSH key to your account during or after authentication. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for adding an SSH key to your GitLab account.\nAfter authentication and SSH key setup, you can run the code in either of the code chunks in Example¬†6 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my .zshrc.\n\nExample 6 ¬†\n\nGitHubGitLab\n\n\ncd # start in home directory\nmkdir USERNAME\ncd USERNAME\ngh repo create REPONAME --add-readme --clone --public\ncd REPONAME\n\n\ncd # start in home directory\nmkdir USERNAME\ncd USERNAME\nglab repo create REPONAME --readme --defaultBranch main --public\ncd REPONAME\ngit pull origin main\ngit branch --set-upstream-to=origin/main main\n\n\n\n\nTo make it easier to backup my repos on both GitHub and GitLab, I set up each local repo to have two origin remote URLs using the code as shown in Example¬†7. With this setting, running git push in my local repo updates my remote repos on both GitHub and GitLab.\n\nExample 7 ¬†\ngit remote add lab git@gitlab.com:maptv/maptv.gitlab.io\ngit remote add hub git@github.com:maptv/maptv.github.io\ngit remote set-url --add origin $(git remote get-url lab)",
    "crumbs": [
      "Software",
      "Positron"
    ]
  },
  {
    "objectID": "software/positron/index.html#sec-workflow",
    "href": "software/positron/index.html#sec-workflow",
    "title": "Positron",
    "section": "Git workflow",
    "text": "Git workflow\nWhen I want to add or update the content on my site, I go through the steps in the standard Git workflow shown in Figure¬†2. Every time I ‚Äúpush‚Äù a collection of changes called a commit to my maptv.github.io repo on GitHub, a continuous integration (CI) system called GitHub Actions automatically completes the steps required to build and publish my website.\n\n\n\n\n\n\nflowchart LR\n   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)\n\n\n\n\nFigure¬†2: Git workflow\n\n\n\n\n\n\nShell aliases\nTo make it easier to make incremental changes to my website and frequently release new content, I combined all of the git shell commands in Figure¬†2 into shell aliases. You can add shell aliases to a shell configuration file like .bashrc or .zshrc on your computer to shorten one or more commands and any associated command arguments.\nThe git commit aliases in the .zshrc file in my setup repo on GitHub and GitLab target different groups of files for inclusion in the next commit. For example, cmp targets staged files, camp targets tracked files, a.cmp targets files in the current directory, and aacmp targets files in the repo.\nExample¬†8 shows the aacmp alias as an example of the shell alias syntax. The mnemonic device for this alias is add all, commit with a message, and push.\n\nExample 8 ¬†\n\n\n.zshrc\n\nalias aacmp=\"func() { git add --all && git commit --message \\\n    \\\"$(echo '${*:-$(echo $(git diff --name-status --cached \\\n    | tr \"[:space:]\" \" \"))}')\\\" && git push; }; func\"\n\n\nAliases like aacmp allow me to enter free-form commit messages directly on the command line without quotes, e.g.¬†aacmp edit first post. If you decide to try one of these aliases, please exercise extreme caution as any un-escaped or un-quoted metacharacters may yield surprising effects instead of being included verbatim in the commit message, e.g.¬†* is replaced by all of the file and directory names in the current directory!\nIf no commit message is provided after the aliases, a generic commit message is created that includes the change type and name of each changed file. In Section¬†4.2, I describe how I used this generic commit message approach to further simplify the Git workflow.\n\n\nKeybindings\nAn alternative to a shell alias that combines git commands is to use a keyboard shortcut in a Git Graphical User Interface (GUI) such as GitHub Desktop or the Git interface in a code editor like VSCode, VSCodium, or RStudio. I use keyboard shortcuts in VSCode and VSCodium to send shell commands to the integrated terminal without moving my focus away from the files I am editing.\nI created different shortcuts to control which files are included in each commit: ‚å•‚áßF for the current file only, ‚å•‚áßS for already staged files, ‚å•‚áßT for all tracked files, and ‚å•‚áßU for all files including untracked files. I also have keyboard shortcuts that affect a specific directory (and all of its subdirectories): ‚å•‚áßD for the current file‚Äôs directory, ‚å•‚áß. for shell‚Äôs current directory, ‚å•‚áßC for the current working directory according to VSCode/VSCodium, ‚å•‚áßW for the Workspace directory.\nExample¬†9 displays the ‚å•‚áßF shortcut as an example of the VSCode/VSCodium shortcut syntax. This shortcut uses the escape code for the return key (\\u000D) to run several git commands and predefined variables to insert the absolute (${file}) and relative (${relativeFile}) path to the currently open file.\n\nExample 9 ¬†\n\n\nkeybindings.json\n\n{\n  \"key\": \"shift+alt+f\",\n  \"command\": \"workbench.action.terminal.sendSequence\", \"args\": { \"text\":\n    \"git add ${file} && git commit -m \\\"M ${relativeFile}\\\" && git push\\u000D\" },\n  \"when\": \"terminalIsOpen\"\n}\n\n\nIf you want to set up similar shortcuts for yourself, take a look at my keybindings.json in my setup repo on GitHub and GitLab. As you create keyboard shortcuts, please be mindful of keybinding conflicts that may arise.\nTo set up a keyboard shortcut that runs a series of steps rather than a single line of shell code, I suggest you use the VSCode/VSCodium Tasks mechanism, a system designed to automate software build tasks. The default keyboard shortcut to run all tasks in a local or global task.json file is ‚åÉ‚áßB on Linux/Windows or ‚åò‚áßB on Mac (mnemonic: B is for Build), but you can bind other shortcuts to specific tasks.\nIf you use a text editor like Vim or Emacs, you can create keybindings for Vim plugins like fugitive or Emacs packages like magit that run through the entire Git workflow. Example¬†10 shows the Vim+fugitive equivalent of my ‚å•‚áßF VSCode/VSCodium keybinding.\n\nExample 10 ¬†\n\n\n.vimrc\n\nnnoremap &lt;A-S-f&gt; :Gw&lt;bar&gt;G! commit -m \"M \"%&lt;bar&gt;G! push&lt;CR&gt;\n\n\nThe drawback of my keyboard shortcut approach for the Git workflow is that it produces generic commit messages that are no very informative. Anyone reading the messages will not be able to tell what changes were made and more importantly why the changes were made.\nTo automatically generate commit messages based on the currently staged changes, we can use a Large Language Model (LLM). Generative artificial intelligence models like LLMs tend to be large in size and have atypical computational requirements, so I will save my adventures with LLMs for a different post.\nI really enjoy using Git, especially with shell aliases in my terminal and keyboard shortcuts in my favorite text editors. If we ever collaborate on a project together, you can be sure that I will insist on using Git!",
    "crumbs": [
      "Software",
      "Positron"
    ]
  },
  {
    "objectID": "software/knitr/index.html",
    "href": "software/knitr/index.html",
    "title": "Knitr",
    "section": "",
    "text": "The goal of this blog post, the last (index: -1) in my Tools blog post series, is to\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style F stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart"
  },
  {
    "objectID": "software/knitr/index.html#tldr",
    "href": "software/knitr/index.html#tldr",
    "title": "Knitr",
    "section": "",
    "text": "The goal of this blog post, the last (index: -1) in my Tools blog post series, is to\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style F stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart"
  },
  {
    "objectID": "software/knitr/index.html#sec-intro",
    "href": "software/knitr/index.html#sec-intro",
    "title": "Knitr",
    "section": "Introduction",
    "text": "Introduction"
  },
  {
    "objectID": "dec/size/index.html",
    "href": "dec/size/index.html",
    "title": "The Dec measurement system",
    "section": "",
    "text": "This section of my blog focuses on Dec, a measurement system that I created to measure‚è≥time,üìçposition,üß≠orientation,üìêangles, andüîÑcycles in turns (\\(\\tau\\)) instead of months, weeks, hours, minutes, seconds, and degrees. For time measurement, Dec uses days and years, which are turns of a celestial body on its axis and around the point it orbits, respectively.\n\nTimestamps\nThe numbers in the top left of the navigation bar (navbar) are components of a Dec timestamp that shows the current time: .\nDec timestamps are inspired by this equation: \\(\\texttt{y=\\lfloor{y}\\rfloor+}\\frac{\\texttt{d-z}}{\\texttt{n}}\\), where \\(\\texttt{y}\\) is decimal years (), \\(\\texttt{\\lfloor{y}\\rfloor}\\) is floored years (), \\(\\texttt{d}\\) is decidays (), \\(\\texttt{z}\\) is the Dec time zone (), and \\(\\texttt{n}\\) is the total number of decidays in the year ().\nIn addition to time, Dec also measuresgeographic andcelestial coordinates: longitude , latitude, azimuth, altitude, etc.\nImportantly, Dec time zones are derived from floored decidays of longitude (\\(\\texttt{z=\\lfloor{Œª}\\rfloor}\\)) and can be appended to the time of day (), but not to durations, e.g.¬†the centimillidays since this webpage was loaded: .\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\ntick = {\n  let i = 0;\n  while (true) {\n    yield Promises.tick(864, ++i);\n  }\n}\ntickTime = tick % 1e5\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nfunction dote2doty(days = 719468, zone = 0) {\n  const era = Math.floor((days &gt;= 0 ? days : days - 146096) / 146097), dotc = days - era * 146097,\n      yotc = Math.floor((dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365);\n  return [yotc + era * 400, dotc + Math.floor(yotc / 100) - yotc * 365 - Math.floor(yotc / 4), zone];\n}\nfunction doty2deco(year = 1969, doty = 306, zone = 0) {\n  return `${year.toString().padStart(4, \"0\")}+${Math.floor(doty).toString().padStart(3, \"0\")}${String(doty % 1 * 10).slice(0, 6)}-${zone}`\n}\nydz = dote2doty(...unix2dote(unix))\ndeco = doty2deco(...ydz)\n// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) &gt;= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`&lt;span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}&gt;${content}&lt;/span&gt;`;\n}\nfunction year2bool(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\ndecoYear = deco.slice(0, 4)\ndecoDate = deco.slice(5, 8)\ndecoTime = deco.slice(8, 14)\ndecoTimeZone = deco[15]\nnDaysInYear = 365 + year2bool(ydz[0] + 1)\nfracYear = (ydz[0] + (ydz[1] - ydz[2]) / nDaysInYear).toFixed(8)\nstyledDecoYear0 = setStyle(decoYear, d3.schemePaired[10])\nstyledDecoYear1 = setStyle(decoYear, d3.schemePaired[10])\nstyledFracYear = setStyle(fracYear, d3.schemePaired[10])\nstyledDecoDate0 = setStyle(decoDate, d3.schemePaired[1])\nstyledDecoDate1 = setStyle(decoDate, d3.schemePaired[1])\nstyledNdays = setStyle(nDaysInYear * 10, d3.schemePaired[1])\nstyledDecoTime0 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime1 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime2 = setStyle(decoTime, d3.schemePaired[2])\nstyledTimeZone0 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone1 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone2 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTickTime = setStyle(tickTime, d3.schemePastel2[0])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {The {Dec} Measurement System},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/blog/dec},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúThe Dec Measurement System.‚Äù 2024.\nhttps://maptv.github.io/blog/dec."
  },
  {
    "objectID": "dec/move/index.html",
    "href": "dec/move/index.html",
    "title": "The Dec measurement system",
    "section": "",
    "text": "This section of my blog focuses on Dec, a measurement system that I created to measure‚è≥time,üìçposition,üß≠orientation,üìêangles, andüîÑcycles in turns (\\(\\tau\\)) instead of months, weeks, hours, minutes, seconds, and degrees. For time measurement, Dec uses days and years, which are turns of a celestial body on its axis and around the point it orbits, respectively.\n\nTimestamps\nThe numbers in the top left of the navigation bar (navbar) are components of a Dec timestamp that shows the current time: .\nDec timestamps are inspired by this equation: \\(\\texttt{y=\\lfloor{y}\\rfloor+}\\frac{\\texttt{d-z}}{\\texttt{n}}\\), where \\(\\texttt{y}\\) is decimal years (), \\(\\texttt{\\lfloor{y}\\rfloor}\\) is floored years (), \\(\\texttt{d}\\) is decidays (), \\(\\texttt{z}\\) is the Dec time zone (), and \\(\\texttt{n}\\) is the total number of decidays in the year ().\nIn addition to time, Dec also measuresgeographic andcelestial coordinates: longitude , latitude, azimuth, altitude, etc.\nImportantly, Dec time zones are derived from floored decidays of longitude (\\(\\texttt{z=\\lfloor{Œª}\\rfloor}\\)) and can be appended to the time of day (), but not to durations, e.g.¬†the centimillidays since this webpage was loaded: .\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\ntick = {\n  let i = 0;\n  while (true) {\n    yield Promises.tick(864, ++i);\n  }\n}\ntickTime = tick % 1e5\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nfunction dote2doty(days = 719468, zone = 0) {\n  const era = Math.floor((days &gt;= 0 ? days : days - 146096) / 146097), dotc = days - era * 146097,\n      yotc = Math.floor((dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365);\n  return [yotc + era * 400, dotc + Math.floor(yotc / 100) - yotc * 365 - Math.floor(yotc / 4), zone];\n}\nfunction doty2deco(year = 1969, doty = 306, zone = 0) {\n  return `${year.toString().padStart(4, \"0\")}+${Math.floor(doty).toString().padStart(3, \"0\")}${String(doty % 1 * 10).slice(0, 6)}-${zone}`\n}\nydz = dote2doty(...unix2dote(unix))\ndeco = doty2deco(...ydz)\n// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) &gt;= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`&lt;span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}&gt;${content}&lt;/span&gt;`;\n}\nfunction year2bool(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\ndecoYear = deco.slice(0, 4)\ndecoDate = deco.slice(5, 8)\ndecoTime = deco.slice(8, 14)\ndecoTimeZone = deco[15]\nnDaysInYear = 365 + year2bool(ydz[0] + 1)\nfracYear = (ydz[0] + (ydz[1] - ydz[2]) / nDaysInYear).toFixed(8)\nstyledDecoYear0 = setStyle(decoYear, d3.schemePaired[10])\nstyledDecoYear1 = setStyle(decoYear, d3.schemePaired[10])\nstyledFracYear = setStyle(fracYear, d3.schemePaired[10])\nstyledDecoDate0 = setStyle(decoDate, d3.schemePaired[1])\nstyledDecoDate1 = setStyle(decoDate, d3.schemePaired[1])\nstyledNdays = setStyle(nDaysInYear * 10, d3.schemePaired[1])\nstyledDecoTime0 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime1 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime2 = setStyle(decoTime, d3.schemePaired[2])\nstyledTimeZone0 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone1 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone2 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTickTime = setStyle(tickTime, d3.schemePastel2[0])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {The {Dec} Measurement System},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/blog/dec},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúThe Dec Measurement System.‚Äù 2024.\nhttps://maptv.github.io/blog/dec."
  },
  {
    "objectID": "dec/day/index.html",
    "href": "dec/day/index.html",
    "title": "The Dec measurement system",
    "section": "",
    "text": "This section of my blog focuses on Dec, a measurement system that I created to measure‚è≥time,üìçposition,üß≠orientation,üìêangles, andüîÑcycles in turns (\\(\\tau\\)) instead of months, weeks, hours, minutes, seconds, and degrees. For time measurement, Dec uses days and years, which are turns of a celestial body on its axis and around the point it orbits, respectively.\n\nTimestamps\nThe numbers in the top left of the navigation bar (navbar) are components of a Dec timestamp that shows the current time: .\nDec timestamps are inspired by this equation: \\(\\texttt{y=\\lfloor{y}\\rfloor+}\\frac{\\texttt{d-z}}{\\texttt{n}}\\), where \\(\\texttt{y}\\) is decimal years (), \\(\\texttt{\\lfloor{y}\\rfloor}\\) is floored years (), \\(\\texttt{d}\\) is decidays (), \\(\\texttt{z}\\) is the Dec time zone (), and \\(\\texttt{n}\\) is the total number of decidays in the year ().\nIn addition to time, Dec also measuresgeographic andcelestial coordinates: longitude , latitude, azimuth, altitude, etc.\nImportantly, Dec time zones are derived from floored decidays of longitude (\\(\\texttt{z=\\lfloor{Œª}\\rfloor}\\)) and can be appended to the time of day (), but not to durations, e.g.¬†the centimillidays since this webpage was loaded: .\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\ntick = {\n  let i = 0;\n  while (true) {\n    yield Promises.tick(864, ++i);\n  }\n}\ntickTime = tick % 1e5\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nfunction dote2doty(days = 719468, zone = 0) {\n  const era = Math.floor((days &gt;= 0 ? days : days - 146096) / 146097), dotc = days - era * 146097,\n      yotc = Math.floor((dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365);\n  return [yotc + era * 400, dotc + Math.floor(yotc / 100) - yotc * 365 - Math.floor(yotc / 4), zone];\n}\nfunction doty2deco(year = 1969, doty = 306, zone = 0) {\n  return `${year.toString().padStart(4, \"0\")}+${Math.floor(doty).toString().padStart(3, \"0\")}${String(doty % 1 * 10).slice(0, 6)}-${zone}`\n}\nydz = dote2doty(...unix2dote(unix))\ndeco = doty2deco(...ydz)\n// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) &gt;= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`&lt;span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}&gt;${content}&lt;/span&gt;`;\n}\nfunction year2bool(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\ndecoYear = deco.slice(0, 4)\ndecoDate = deco.slice(5, 8)\ndecoTime = deco.slice(8, 14)\ndecoTimeZone = deco[15]\nnDaysInYear = 365 + year2bool(ydz[0] + 1)\nfracYear = (ydz[0] + (ydz[1] - ydz[2]) / nDaysInYear).toFixed(8)\nstyledDecoYear0 = setStyle(decoYear, d3.schemePaired[10])\nstyledDecoYear1 = setStyle(decoYear, d3.schemePaired[10])\nstyledFracYear = setStyle(fracYear, d3.schemePaired[10])\nstyledDecoDate0 = setStyle(decoDate, d3.schemePaired[1])\nstyledDecoDate1 = setStyle(decoDate, d3.schemePaired[1])\nstyledNdays = setStyle(nDaysInYear * 10, d3.schemePaired[1])\nstyledDecoTime0 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime1 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime2 = setStyle(decoTime, d3.schemePaired[2])\nstyledTimeZone0 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone1 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone2 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTickTime = setStyle(tickTime, d3.schemePastel2[0])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {The {Dec} Measurement System},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/blog/dec},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúThe Dec Measurement System.‚Äù 2024.\nhttps://maptv.github.io/blog/dec."
  },
  {
    "objectID": "ml/llm/index.html",
    "href": "ml/llm/index.html",
    "title": "LLM",
    "section": "",
    "text": "Large Language Models (LLMs) are a way to automatically generate text. more informative commit messages based on the currently staged changes.\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {LLM},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/ml/llm/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúLLM.‚Äù 2024. https://maptv.github.io/ml/llm/.",
    "crumbs": [
      "Machine Learning",
      "Language Models"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Greetings! \nWelcome to my personal website, which I created using the Quarto publishing system.\nYou are currently on the Home page of my site. You can use the Sidebar on the left to go to the About, Listing, and Curriculum Vitae (CV) pages of my site or my profile pages on GitHub and LinkedIn. The remaining items in the sidebar are sections that cover topics like art, history, and science. In addition to the sidebar, you can also use the arrows at the bottom to move between specific pages on my site.\nHave fun looking around!\n\n\n Back to top",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "dec/index.html",
    "href": "dec/index.html",
    "title": "The Dec measurement system",
    "section": "",
    "text": "This section of my site focuses on Dec, a measurement system that I created to measure‚è≥time,üìçposition,üß≠orientation,üìêangles, andüîÑcycles in turns (\\(\\tau\\)) instead of months, weeks, hours, minutes, seconds, and degrees. For time measurement, Dec uses days and years, which are turns of a celestial body on its axis and around the point it orbits, respectively.\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {The {Dec} Measurement System},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/dec},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúThe Dec Measurement System.‚Äù 2024.\nhttps://maptv.github.io/dec.",
    "crumbs": [
      "Dec"
    ]
  },
  {
    "objectID": "about/index.html",
    "href": "about/index.html",
    "title": "",
    "section": "",
    "text": "I am a data scientist and software engineer with a broad scientific background that ranges from biochemistry to epidemiology.\nI use the JavaScript, Python, and R programming languages along with the UNIX shell to build digital deliverables such as cloudinfrastructure, datadashboards, and machinelearning models.\nIn addition to programming languages, I also like natural languages! I speak English, Polish, Spanish, Russian, French, and Portuguese.\nMy favorite music genres are Zouk, Konpa, and Kizomba, but I also enjoy many different kinds of African, Caribbean, and Latin music.\n\n\n Back to top",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "cv/index.html",
    "href": "cv/index.html",
    "title": "Martin Skarzynski Laptev",
    "section": "",
    "text": "240-207-1654\n maptv@engineer.com\n maptv.github.io\n maptv\n maptv\n\n\n\nMission\nMy goal is to lead the next generation of scientists and engineers in building solutions that integrate substantive expertise from diverse fields with machine intelligence. Through my work, I strive to promote open source software, such as the Quarto publishing system, which I use to build dashboards, presentations, reports, websites, and other digital deliverables. Overall, I aim to leverage my broad scientific background and technical expertise to help transform the promises of science and technology into a better future for all of humanity.\n\n\nExperience\n\nLead Instructor, General Assembly 2019:\n\n\nTeaches open-enrollment and enterprise courses such as:\n\nReact Development\nData Analytics\nData Science\nPython Programming\nWeb Development\n\n\n\n\n\nLead Instructor, Data Society 2019:\n\n\nProvides enterprise clients with training in:\n\nMachine Learning\nDevOps & MLOps\nPython & R Programming\nGenerative AI\nGraph Analytics\nText Analysis & NLP\n\n\n\n\n\nSenior Domain Lead, Amazon Web Services 2022:2024\n\n\nProvided customers with scientific and technical expertise in:\n\nComputer Vision\nData Architecture\nData Visualization\nGenomics\nMachine Learning\nReal World Evidence\n\nBuilt Artificial Intelligence (AI) solutions and Machine Learning Operations (MLOps) systems using:\n\nAmazon SageMaker\nAWS Developer Tools\nAWS Lambda\nAmazon EventBridge\nAWS CloudFormation\nAWS IAM\nAmazon EMR\nAWS Databases\nAWS Service Catalog\n\nObtained 3 AWS certification\n\nPractical Data Science\nCloud Practitioner\nSolutions Architect Associate\n\n\n\n\n\nAdjunct Professor, Virginia Tech 2021:2024\n\n\nTaught two graduate courses for the Computer Science and Statistics Departments:\n\nMachine Learning\nData Analytics\n\n\n\n\n\nVice President, Data Community DC 2022:\n\nLeads a non‚Äëprofit organization that supports eleven Meetup groups\n\n\n\nAI Engineering Manager, Booz Allen Hamilton 2019:2023\n\nLed a team of data scientists and software developers working on a cyber intelligence application\nSpearheaded interdisciplinary COVID‚Äë19 visualization, genomics, and statistical modeling efforts\nObtained the Microsoft Azure Data Scientist Associate certification\n\n\n\nBiomedical Scientist, National Institutes of Health 2009:2022\n\n\nIntegrated clinical, laboratory, epidemiologic, genomic, and medical imaging data\nCombined deep learning and statistical inference using stacked ensembles\nConducted genomic analysis of immune and cancer cells\nDeveloped and tested pharmaceutical and immunotherapeutic agents\nQuantified cancer cell signaling pathways\nMentored trainees from various NIH training programs including:\n\nSIP\nMRSP\nHiSTEP\n\n\n\n\n\nBioinformatics and Data Science Co-Chair, FAES 2014:2021\n\n\nCo‚Äëadministered an academic program with over twenty faculty members\nTaught three graduate data science courses:\n\nPython Programming\nText Mining\nApplied Machine Learning\n\nTaught graduate biotechnology workshops on various topics including:\n\nPharmacometrics\nCellular Immunology\nFlow Cytometry\n\n\n\n\n\nAdjunct Professor, George Washington University 2015:2016\n\n\nTaught two undergraduate courses for the Women‚Äôs Leadership Program:\n\nBiology of Organisms\nWomen and Leadership\n\n\n\n\n\n\nEducation\n\nMPH, Epidemiology and Biostatistics, Johns Hopkins University 2018\nPhD, Tumor Biology, Georgetown University 2015\nMS, Biotechnology, Jagiellonian University 2009\nBA, Biology, St.¬†Mary‚Äôs College of Maryland 2007\n\n\n\nPublications\n\n\nPotentiating [mAb] therapy by targeting complement C3 [‚Ä¶] on lymphoma cells Submitted\nRecalibration of a deep learning model [‚Ä¶] to inform lung cancer screening intervals 2023\n[COVID] genome‚Äêbased severity predictions correspond to [‚Ä¶] higher viral load 2022\nLinking genotype to phenotype [‚Ä¶] in [COVID] [‚Ä¶] 2022\nVariants in [COVID] associated with mild or severe outcome 2021\nUsing prediction models to reduce [‚Ä¶] disparities in [‚Ä¶] lung cancer screening [‚Ä¶] 2021\nPathogenic role of [BCR] signaling and canonical NF-Œ∫B activation in [MCL] 2016\nInteractions between ibrutinib and anti‚ÄêCD20 antibodies [‚Ä¶] 2016\nHealth disparities in the immunoprevention of [HPV] [‚Ä¶] associated malignancies 2015\nDesigning the furin‚Äêcleavable linker in recombinant immunotoxins [‚Ä¶] 2015\nHarnessing the FcŒº receptor for [‚Ä¶] therapy of [CLL] 2014\n\n\n\n\nAwards\n\n\nCommunity Contribution of the Year Category Finalist, AWS Builder Awards 2023\nArtificial Intelligence Solutions Architect Award, BAH Emergent Skills Program 2022\nFellowship Research Award, Cancer Prevention Fellowship Program 2019\nFellows Award for Research Excellence, National Institutes of Health 2015\nOrloff Science Award, National Heart, Lung, Blood Institute 2014\nDirector‚Äôs Science Award, National Heart, Lung, Blood Institute 2014\n\n\n\n\nLanguages\n\n\nILR 5: English, Polish\nILR 4: Spanish, Russian\nILR 2: French, Portuguese\n\n\n\n\nSkills\n                                                                                                                      \n\n\n\n\n Back to top",
    "crumbs": [
      "CV/R√©sum√©"
    ]
  },
  {
    "objectID": "history/ww2/index.html",
    "href": "history/ww2/index.html",
    "title": "World War 2",
    "section": "",
    "text": "Day 184 in the Gregorian Decalendar is the first day of Season 2 by meteorological reckoning and also the anniversary of the start of the World War 2. On 1939+184, World War 2 started with the German invasion of Poland. On 1939+200, sixteen days after the start of the war, the Soviet Union invaded Poland from the East. Germany and the Soviet Union split Poland according to the Molotov‚ÄìRibbentrop Pact signed on 1939+175. The map below shows the German and Soviet invasions of Poland on Days 184 and 200, respectively, of Year 1939, as well as other military movements over the course of the subsequent 1.83 years before Germany ended the Molotov‚ÄìRibbentrop Pact on 1941+113 with its invasion of the Soviet Union as part of Operation Barbarossa.\nOn the map, exact dates on the map are in the year+day format and approximate dates are decimal years. For more information on these date formats, take a look at date page in the Measurement section of my site. Briefly, the day in year+day counts the days since Day 0 and can be divided by the number of days in the year to obtain the fractional part of the decimal year. In the legend, there is a date range in the start:stop format, which is inspired by the slice syntax in the Python programming language.\n\n\n\nMap of military movements in Europe from 1939 to 1941\n\n\nWorld War 2 officially ended on 1945+185, 6 years and 1 day after it began, when Japan surrendered. The German surrender on 1945+068 is commemorated with Victory in Europe Day, typically on Day 68 in the West. In contrast, many countries in Russia‚Äôs sphere of influence commemorate Victory Day on Day 69. The chosen commemoration date can therefore be viewed as having political significance. On Day 69, the European Union celebrates the anniversary of the 1950 Schuman Declaration with a holiday called Europe Day. The Schuman Declaration aimed at normalizing relations and promoting political integration in Europe. Today, many countries that were opponents in World War 2 are now close allies, notably Germany, France, and Poland and the US and Japan.\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {World {War} 2},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/history/ww2},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúWorld War 2.‚Äù 2024. https://maptv.github.io/history/ww2.",
    "crumbs": [
      "History",
      "World War 2"
    ]
  },
  {
    "objectID": "list/index.html",
    "href": "list/index.html",
    "title": "",
    "section": "",
    "text": "Dec Date\n\n\n31 min\n\n\nIntroducing the Dec calendar (Decalendar), which displays dates in years and days using math notation without the need for months or weeks.\n\n\n\n\nWord Count\n\n\n6,086 words\n\n\n\n\n\n\n1733373279095\n\n\n\n\n\n\n\n\n\n\n\n\n\nDec Time\n\n\n56 min\n\n\nIntroducing Declock, a timekeeping system that displays time in decimal days using math notation without the need for hours, minutes, or seconds.\n\n\n\n\nWord Count\n\n\n11,116 words\n\n\n\n\n\n\n1733376132012\n\n\n\n\n\n\n\n\n\n\n\n\n\nWorld War 2\n\n\n3 min\n\n\n\n\n\n\n\nWord Count\n\n\n409 words\n\n\n\n\n\n\n1725860445106\n\n\n\n\n\n\n\n\n\n\n\n\n\nGit\n\n\n14 min\n\n\n\ntool\n\n\ngit\n\n\n\n\n\n\n\n\nWord Count\n\n\n2,659 words\n\n\n\n\n\n\n1725581207475\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuarto\n\n\n19 min\n\n\n\ntool\n\n\nquarto\n\n\nweb dev\n\n\ngit\n\n\n\n\n\n\n\n\nWord Count\n\n\n3,763 words\n\n\n\n\n\n\n1725581207491\n\n\n\n\n\n\n\n\n\n\n\n\n\nObservable\n\n\n45 min\n\n\n\ntool\n\n\nobservable\n\n\nquarto\n\n\n\n\n\n\n\n\nWord Count\n\n\n8,966 words\n\n\n\n\n\n\n1725581207489\n\n\n\n\n\n\n\n\n\n\n\n\n\nJupyter\n\n\n1 min\n\n\n\ntool\n\n\nknitr\n\n\njupyter\n\n\nquarto\n\n\n\n\n\n\n\n\nWord Count\n\n\n79 words\n\n\n\n\n\n\n1725581207479\n\n\n\n\n\n\n\n\n\n\n\n\n\nKnitr\n\n\n1 min\n\n\n\ntool\n\n\nknitr\n\n\nquarto\n\n\n\n\n\n\n\n\nWord Count\n\n\n77 words\n\n\n\n\n\n\n1725581207488\n\n\n\n\n\n\n\n\n\n\n\n\n\nProbability\n\n\n5 min\n\n\n\nml\n\n\n\n\n\n\n\n\nWord Count\n\n\n913 words\n\n\n\n\n\n\n1725581207474\n\n\n\n\n\n\n\n\n\n\n\n\n\nLLM\n\n\n1 min\n\n\n\ntool\n\n\ngit\n\n\nllm\n\n\nml\n\n\n\n\n\n\n\n\nWord Count\n\n\n21 words\n\n\n\n\n\n\n1725581207466\n\n\n\n\n\n\n\nNo matching items\n\n Back to topAttributions\n\nAll artwork by @allison_horst except for the images related to the following articles:\n\nDec date, which shows an Observable calendarüóìÔ∏èplot\nDec time, which shows an Observable daylight‚òÄÔ∏èplot with globesüåç\nPositron, which combines the VSCode and VSCodium logos\nLLM, which was generated by DALL¬∑E 3 with the following prompt:\n\n\na cartoon image of a person climbing a mountain to obtain answers to their questions from an omniscient robotic guru with a glowing positronic brain\n\n\n\n\nCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/list/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. 2024. https://maptv.github.io/list/.",
    "crumbs": [
      "Article List"
    ]
  },
  {
    "objectID": "cv/pdf/index.html",
    "href": "cv/pdf/index.html",
    "title": "",
    "section": "",
    "text": "Code\n\n\n\n\n\n    \n\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/cv/pdf/},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. 2024. https://maptv.github.io/cv/pdf/."
  },
  {
    "objectID": "dec/geo/index.html",
    "href": "dec/geo/index.html",
    "title": "The Dec measurement system",
    "section": "",
    "text": "This section of my blog focuses on Dec, a measurement system that I created to measure‚è≥time,üìçposition,üß≠orientation,üìêangles, andüîÑcycles in turns (\\(\\tau\\)) instead of months, weeks, hours, minutes, seconds, and degrees. For time measurement, Dec uses days and years, which are turns of a celestial body on its axis and around the point it orbits, respectively.\n\nTimestamps\nThe numbers in the top left of the navigation bar (navbar) are components of a Dec timestamp that shows the current time: .\nDec timestamps are inspired by this equation: \\(\\texttt{y=\\lfloor{y}\\rfloor+}\\frac{\\texttt{d-z}}{\\texttt{n}}\\), where \\(\\texttt{y}\\) is decimal years (), \\(\\texttt{\\lfloor{y}\\rfloor}\\) is floored years (), \\(\\texttt{d}\\) is decidays (), \\(\\texttt{z}\\) is the Dec time zone (), and \\(\\texttt{n}\\) is the total number of decidays in the year ().\nIn addition to time, Dec also measuresgeographic andcelestial coordinates: longitude , latitude, azimuth, altitude, etc.\nImportantly, Dec time zones are derived from floored decidays of longitude (\\(\\texttt{z=\\lfloor{Œª}\\rfloor}\\)) and can be appended to the time of day (), but not to durations, e.g.¬†the centimillidays since this webpage was loaded: .\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\ntick = {\n  let i = 0;\n  while (true) {\n    yield Promises.tick(864, ++i);\n  }\n}\ntickTime = tick % 1e5\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nfunction dote2doty(days = 719468, zone = 0) {\n  const era = Math.floor((days &gt;= 0 ? days : days - 146096) / 146097), dotc = days - era * 146097,\n      yotc = Math.floor((dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365);\n  return [yotc + era * 400, dotc + Math.floor(yotc / 100) - yotc * 365 - Math.floor(yotc / 4), zone];\n}\nfunction doty2deco(year = 1969, doty = 306, zone = 0) {\n  return `${year.toString().padStart(4, \"0\")}+${Math.floor(doty).toString().padStart(3, \"0\")}${String(doty % 1 * 10).slice(0, 6)}-${zone}`\n}\nydz = dote2doty(...unix2dote(unix))\ndeco = doty2deco(...ydz)\n// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) &gt;= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`&lt;span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}&gt;${content}&lt;/span&gt;`;\n}\nfunction year2bool(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\ndecoYear = deco.slice(0, 4)\ndecoDate = deco.slice(5, 8)\ndecoTime = deco.slice(8, 14)\ndecoTimeZone = deco[15]\nnDaysInYear = 365 + year2bool(ydz[0] + 1)\nfracYear = (ydz[0] + (ydz[1] - ydz[2]) / nDaysInYear).toFixed(8)\nstyledDecoYear0 = setStyle(decoYear, d3.schemePaired[10])\nstyledDecoYear1 = setStyle(decoYear, d3.schemePaired[10])\nstyledFracYear = setStyle(fracYear, d3.schemePaired[10])\nstyledDecoDate0 = setStyle(decoDate, d3.schemePaired[1])\nstyledDecoDate1 = setStyle(decoDate, d3.schemePaired[1])\nstyledNdays = setStyle(nDaysInYear * 10, d3.schemePaired[1])\nstyledDecoTime0 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime1 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime2 = setStyle(decoTime, d3.schemePaired[2])\nstyledTimeZone0 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone1 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone2 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTickTime = setStyle(tickTime, d3.schemePastel2[0])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {The {Dec} Measurement System},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/blog/dec},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúThe Dec Measurement System.‚Äù 2024.\nhttps://maptv.github.io/blog/dec."
  },
  {
    "objectID": "dec/nav/index.html",
    "href": "dec/nav/index.html",
    "title": "The Dec measurement system",
    "section": "",
    "text": "This section of my blog focuses on Dec, a measurement system that I created to measure‚è≥time,üìçposition,üß≠orientation,üìêangles, andüîÑcycles in turns (\\(\\tau\\)) instead of months, weeks, hours, minutes, seconds, and degrees. For time measurement, Dec uses days and years, which are turns of a celestial body on its axis and around the point it orbits, respectively.\n\nTimestamps\nThe numbers in the top left of the navigation bar (navbar) are components of a Dec timestamp that shows the current time: .\nDec timestamps are inspired by this equation: \\(\\texttt{y=\\lfloor{y}\\rfloor+}\\frac{\\texttt{d-z}}{\\texttt{n}}\\), where \\(\\texttt{y}\\) is decimal years (), \\(\\texttt{\\lfloor{y}\\rfloor}\\) is floored years (), \\(\\texttt{d}\\) is decidays (), \\(\\texttt{z}\\) is the Dec time zone (), and \\(\\texttt{n}\\) is the total number of decidays in the year ().\nIn addition to time, Dec also measuresgeographic andcelestial coordinates: longitude , latitude, azimuth, altitude, etc.\nImportantly, Dec time zones are derived from floored decidays of longitude (\\(\\texttt{z=\\lfloor{Œª}\\rfloor}\\)) and can be appended to the time of day (), but not to durations, e.g.¬†the centimillidays since this webpage was loaded: .\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\ntick = {\n  let i = 0;\n  while (true) {\n    yield Promises.tick(864, ++i);\n  }\n}\ntickTime = tick % 1e5\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nfunction dote2doty(days = 719468, zone = 0) {\n  const era = Math.floor((days &gt;= 0 ? days : days - 146096) / 146097), dotc = days - era * 146097,\n      yotc = Math.floor((dotc - Math.floor(dotc / 1460) + Math.floor(dotc / 36524) - Math.floor(dotc / 146096)) / 365);\n  return [yotc + era * 400, dotc + Math.floor(yotc / 100) - yotc * 365 - Math.floor(yotc / 4), zone];\n}\nfunction doty2deco(year = 1969, doty = 306, zone = 0) {\n  return `${year.toString().padStart(4, \"0\")}+${Math.floor(doty).toString().padStart(3, \"0\")}${String(doty % 1 * 10).slice(0, 6)}-${zone}`\n}\nydz = dote2doty(...unix2dote(unix))\ndeco = doty2deco(...ydz)\n// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) &gt;= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`&lt;span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}&gt;${content}&lt;/span&gt;`;\n}\nfunction year2bool(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\ndecoYear = deco.slice(0, 4)\ndecoDate = deco.slice(5, 8)\ndecoTime = deco.slice(8, 14)\ndecoTimeZone = deco[15]\nnDaysInYear = 365 + year2bool(ydz[0] + 1)\nfracYear = (ydz[0] + (ydz[1] - ydz[2]) / nDaysInYear).toFixed(8)\nstyledDecoYear0 = setStyle(decoYear, d3.schemePaired[10])\nstyledDecoYear1 = setStyle(decoYear, d3.schemePaired[10])\nstyledFracYear = setStyle(fracYear, d3.schemePaired[10])\nstyledDecoDate0 = setStyle(decoDate, d3.schemePaired[1])\nstyledDecoDate1 = setStyle(decoDate, d3.schemePaired[1])\nstyledNdays = setStyle(nDaysInYear * 10, d3.schemePaired[1])\nstyledDecoTime0 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime1 = setStyle(decoTime, d3.schemePaired[2])\nstyledDecoTime2 = setStyle(decoTime, d3.schemePaired[2])\nstyledTimeZone0 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone1 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTimeZone2 = setStyle(decoTimeZone, d3.schemePaired[3])\nstyledTickTime = setStyle(tickTime, d3.schemePastel2[0])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topCitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {The {Dec} Measurement System},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/blog/dec},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúThe Dec Measurement System.‚Äù 2024.\nhttps://maptv.github.io/blog/dec."
  },
  {
    "objectID": "software/jupyter/index.html",
    "href": "software/jupyter/index.html",
    "title": "Jupyter",
    "section": "",
    "text": "The goal of this blog post, the second to last (index: -2) in my Tools blog post series, is to\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style E stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart",
    "crumbs": [
      "Software",
      "Jupyter"
    ]
  },
  {
    "objectID": "software/jupyter/index.html#tldr",
    "href": "software/jupyter/index.html#tldr",
    "title": "Jupyter",
    "section": "",
    "text": "The goal of this blog post, the second to last (index: -2) in my Tools blog post series, is to\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style E stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart",
    "crumbs": [
      "Software",
      "Jupyter"
    ]
  },
  {
    "objectID": "software/jupyter/index.html#sec-intro",
    "href": "software/jupyter/index.html#sec-intro",
    "title": "Jupyter",
    "section": "Introduction",
    "text": "Introduction",
    "crumbs": [
      "Software",
      "Jupyter"
    ]
  },
  {
    "objectID": "software/git/index.html",
    "href": "software/git/index.html",
    "title": "Git",
    "section": "",
    "text": "In this blog post, I show how to use the Git version control system and the command line interfaces (CLIs) for the GitHub and GitLab Git repository hosts to create a Git repository that contains setup files for the Codespaces and GitPod computing platforms.",
    "crumbs": [
      "Software",
      "Git"
    ]
  },
  {
    "objectID": "software/git/index.html#tldr",
    "href": "software/git/index.html#tldr",
    "title": "Git",
    "section": "",
    "text": "In this blog post, I show how to use the Git version control system and the command line interfaces (CLIs) for the GitHub and GitLab Git repository hosts to create a Git repository that contains setup files for the Codespaces and GitPod computing platforms.",
    "crumbs": [
      "Software",
      "Git"
    ]
  },
  {
    "objectID": "software/git/index.html#navigation-chart",
    "href": "software/git/index.html#navigation-chart",
    "title": "Git",
    "section": "Navigation Chart",
    "text": "Navigation Chart\nFigure¬†1 summarizes the relationship between this post (highlighted with a violet border) and the subsequent posts in my Tools blog post series. Click/tap on a node in Figure¬†1 to navigate to the corresponding post. If you cannot see Figure¬†1, rotate your smartphone screen to a horizontal (landscape) position.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style A stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart",
    "crumbs": [
      "Software",
      "Git"
    ]
  },
  {
    "objectID": "software/git/index.html#sec-intro",
    "href": "software/git/index.html#sec-intro",
    "title": "Git",
    "section": "Introduction",
    "text": "Introduction\nGit is a version control system developed by Linux creator Linus Torvalds. Since its first release in 2005+037, Git has largely replaced other version control systems and is used by 93% of software developers worldwide, according to survey results published by StackOverflow on 2022+314.\nThanks to Git, I can sleepüí§soundly at night, reassured by the knowledge that all of my progress on all of my ongoing projects is recorded. My progress is not only stored on my local computer, but also on Git repository hosts such as GitHub and GitLab.\nA Git repository (repo) is a directory that tracks the changes made to its contents. For more information on GitHub, the largest Git repo host, take a look at the ‚ÄúGitHub for supporting, reusing, contributing, and failing safely‚Äù post by Allison Horst and Julie Lowndes on the Openscapes blog.\nGitHub and GitLab do not only host repos, but also websites via GitHub Pages and GitLab Pages. In addition to providing basic web hosting for free, GitHub and GitLab offer free access to continuous integration (CI) systems called GitHub Actions and GitLab CI/CD that can automatically build and deploy software.\nAnother advantage of using Git is the availability of free web-based editors, such as github.dev, vscode.dev, and Web IDE, that make it possible to modify repo contents via a web browser without the need to keep local copies of repos or have anything installed locally. Cloud-based computing platforms like GitHub Codespaces and GitPod offer the same benefits of web-based editors, but also provide compute for running code and building software, thus enabling remote development on any computer with a web browser.\nBefore you can benefit from everything GitHub and/or GitLab have to offer, you will need to set up your computer so that you can work locally and/or configure a service like GitHub Codespaces or GitLab Web IDE for remote development in your web browser. In this post, I discuss local development environment setup with the Homebrew package manager and repo setup with the GitHub and GitLab CLI.\nIf you follow along to end of this post, you will have a repo called dotfiles that can be used for Codespaces and GitPod setup. I cover how to set up Codespaces and GitPod in my next blog post, which focuses on the Visual Studio Code (VSCode) and VSCodium source-code editors.",
    "crumbs": [
      "Software",
      "Git"
    ]
  },
  {
    "objectID": "software/git/index.html#sec-setup",
    "href": "software/git/index.html#sec-setup",
    "title": "Git",
    "section": "Setup",
    "text": "Setup\n\nHomebrew\nLinux, macOS, or Windows Subsystem for Linux (WSL) users can install everything needed to work through all of the examples in this blog post via the Homebrew](https://brew.sh) package manager. First, install Homebrew itself with the latest .pkg installer for macOS or by running the Example¬†1 Unix shell code in your terminal.\n\nExample 1 ¬†\n/bin/bash -c \"$(curl -fsSL https://\\\nraw.githubusercontent.com/Homebrew/\\\ninstall/HEAD/install.sh)\"\n\nIf you are not completely satisfied with the terminal that comes with your operating system (OS), you can use Homebrew to install a new terminal. The terminals I use most often are the iTerm2 standalone terminal and the integrated terminal built into my preferred source-code editor VSCodium. Unfortunately, iTerm2 is only for macOS, but there is an abundance of great multi-OS standalone terminals, such as Alacritty, Hyper, Kitty, and Tabby.\nAfter installing Homebrew, you can run brew doctor in your terminal to confirm that everything is set up correctly. If the brew command is not available, you need to follow the instructions provided after installation to add brew to your PATH variable.\nOnce Homebrew is ready, you can run the shell code in Example¬†2 to create a file called Brewfile with the echo shell command and install everything listed in this newly created Brewfile with the brew bundle shell command.\n\nExample 2 ¬†\necho 'brew \"gh\"\\nbrew \"git\"\nbrew \"glab\"\\ncask \"github\"' &gt; Brewfile\nbrew bundle\n\nThe Brewfile created by the shell code in Example¬†2 installs:\n\nGit,\nthe command line interfaces (CLIs) for\n\nGitHub and\nGitLab, and\n\nthe GitHub Desktop Git Graphical User Interface (GUI).\n\nAfter installing Git, you should go through the First-Time Git Setup or make sure you have a Git configuration file with the correct name and location, either ~/.gitconfig or ~/.config/git/config, where ~ represents the home directory and / is the directory delimiter used in Unix paths. When configuring Git, I recommend that you set your default editor to VSCode (code) or VSCodium (codium) as shown in Example¬†3.\n\nExample 3 ¬†\n\nShell.gitconfig\n\n\ngit config --global core.editor \"codium --wait\"\n\n\n[core]\n    editor = codium --wait\n\n\n\n\nIf you are curious about how I set up my computer, you can take a look at my Brewfile, .gitconfig, and other configuration files in my setup repo on GitHub and GitLab. In particular, I will highlight my Z shell configuration file (.zshrc) in Section¬†5.\n\n\nAuthentication\nBefore we get started, you will need to have created an account on GitHub and/or GitLab. You will need two authentication methods: 1) to sign into github.com or gitlab.com in your browser and 2) to run the git push shell command in your terminal. For git push to work, you will need either a Personal Access Token (PAT) or a Secure Shell (SSH) key.\nCreating a PAT on GitHub or GitLab is easy, but then you must also store your PAT in Keychain Access on Mac or Git Credential Manager on Windows and Linux to avoid having to enter your PAT every time you run git push in your terminal. In contrast, setting up an SSH key on GitHub or GitLab requires much more effort but you can set up a single SSH key and reuse it for GitHub, GitLab, and any other service that supports authentication via SSH key.\nWhen I set up a new computer, I create a SSH key using the command in ?@exm-keygen. I can add this key to my SSH agent simply by running ssh-add, but I also\nssh-keygen -t ed25519 -f ~/.ssh/id_ed25519 -C \\((uname -n)_\\)(sysctl hw.model | cut -f2 -d¬†)\nI use the\nIf you enter an empty passphrase when creating your SSH key, then you will not need Keychain Access or Git Credential Manager. frictionless experience by default, whereas PATs are more difficult than need to entered every time your. This major limitation of PATs can be circumvented by storing your PAT in Keychain Access on Mac or Git Credential Manager on Windows and Linux.\nThe instructions for setting up an SSH key can use your newly created key for both GitHub and GitLab, but if you have more than one account on the same Git repo host, you will need to create a separate key for each account and include each identity file in your ~/.ssh/config file as shown in Example¬†5.\nI can add this key that one SSH key is named ~/.ssh/id_rsa, ~/.ssh/id_ecdsa, ~/.ssh/id_ecdsa_sk, ~/.ssh/id_ed25519, ~/.ssh/id_ed25519_sk, or ~/.ssh/id_dsa.\nIso I can add it to my SSH agent simply by running ssh-add. unless I need to sign into multiple accounts on the same Git repository host.\nFor example, if I have separate accounts for work and personal projects, I create a separate SSH key for each account and include each identity file in my ~/.ssh/config file as shown in Example¬†5. If including ‚ÄúAddKeysToAgent yes‚Äù does not automatically add your SSH keys to your SSH agent, run ssh-add ~/.ssh/USERNAME to add each SSH key.\n\nExample 4 ¬†\n\n\n~/.ssh/config\n\nHost github-WORKUSERNAME\n    AddKeysToAgent yes\n    HostName github.com\n    IdentityFile ~/.ssh/WORKUSERNAME\n    IdentitiesOnly yes\n\nHost github-PERSONALUSERNAME\n    AddKeysToAgent yes\n    HostName github.com\n    IdentityFile ~/.ssh/PERSONALUSERNAME\n    IdentitiesOnly yes\n\n\nOf the many authentication methods, passkeys stand out because they can function as both a password and two-factor authentication (2FA), thus combining the two steps in the 2FA sign-in process into one. Passkeys will certainly become more common in the future, especially now that GitHub recently announced its plan to make 2FA mandatory for code contributors.\nWhen authenticating via SSH, we use SSH URLs, such as git@github.com:maptv/dotfiles.With PATs, we use HTTPS URLs such as https://github.com/maptv/dotfiles, instead of the\n\nExample 5 ¬†\n\n\n~/.ssh/config\n\nHost github-USERNAME1\n   HostName github.com\n   IdentityFile ~/.ssh/USERNAME1\n   IdentitiesOnly yes\n\nHost github-USERNAME2\n   HostName github.com\n   IdentityFile ~/.ssh/USERNAME2\n   IdentitiesOnly yes\n\n\nIf you have an identity file in your ~/.ssh/ directory that follows the naming convention, you can add it to your current shell session by running ssh-add. If not, you will need to provide the identity file as an argument, e.g.¬†ssh-add ~/.ssh/USERNAME1.\nYou can create a repo using the web interface of https://github.com or https://gitlab.com in your browser, but the best way to start a new project is using the CLI for GitHub or GitLab in your terminal. First, run gh auth login or glab auth login and follow the prompts to authenticate via your web browser or with an authentication token.\nThe GitHub CLI allows you to add an SSH key to your account during or after authentication. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for adding an SSH key to your GitLab account.\n\n\nRepository\nAfter authentication and SSH key setup, you can run the code in either of the code chunks in Example¬†6 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my .zshrc.\n\nExample 6 ¬†\n\nGitHubGitLab\n\n\ncd # start in home directory\nmkdir USERNAME\ncd USERNAME\ngh repo create REPONAME --add-readme --clone --public\ncd REPONAME\n\n\ncd # start in home directory\nmkdir USERNAME\ncd USERNAME\nglab repo create REPONAME --readme --defaultBranch main --public\ncd REPONAME\ngit pull origin main\ngit branch --set-upstream-to=origin/main main\n\n\n\n\nTo make it easier to backup my repos on both GitHub and GitLab, I set up each local repo to have two origin remote URLs using the code as shown in Example¬†7. With this setting, running git push in my local repo updates my remote repos on both GitHub and GitLab.\n\nExample 7 ¬†\ngit remote add lab git@gitlab.com:maptv/maptv.gitlab.io\ngit remote add hub git@github.com:maptv/maptv.github.io\ngit remote set-url --add origin $(git remote get-url lab)",
    "crumbs": [
      "Software",
      "Git"
    ]
  },
  {
    "objectID": "software/git/index.html#sec-workflow",
    "href": "software/git/index.html#sec-workflow",
    "title": "Git",
    "section": "Git workflow",
    "text": "Git workflow\nWhen I want to add or update the content on my site, I go through the steps in the standard Git workflow shown in Figure¬†2. Every time I ‚Äúpush‚Äù a collection of changes called a commit to my maptv.github.io repo on GitHub, a continuous integration (CI) system called GitHub Actions automatically completes the steps required to build and publish my website.\n\n\n\n\n\n\nflowchart LR\n   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)\n\n\n\n\nFigure¬†2: Git workflow\n\n\n\n\n\n\nShell aliases\nTo make it easier to make incremental changes to my website and frequently release new content, I combined all of the git shell commands in Figure¬†2 into shell aliases. You can add shell aliases to a shell configuration file like .bashrc or .zshrc on your computer to shorten one or more commands and any associated command arguments.\nThe git commit aliases in the .zshrc file in my setup repo on GitHub and GitLab target different groups of files for inclusion in the next commit. For example, cmp targets staged files, camp targets tracked files, a.cmp targets files in the current directory, and aacmp targets files in the repo.\nExample¬†8 shows the aacmp alias as an example of the shell alias syntax. The mnemonic device for this alias is add all, commit with a message, and push.\n\nExample 8 ¬†\n\n\n.zshrc\n\nalias aacmp=\"func() { git add --all && git commit --message \\\n    \\\"$(echo '${*:-$(echo $(git diff --name-status --cached \\\n    | tr \"[:space:]\" \" \"))}')\\\" && git push; }; func\"\n\n\nAliases like aacmp allow me to enter free-form commit messages directly on the command line without quotes, e.g.¬†aacmp edit first post. If you decide to try one of these aliases, please exercise extreme caution as any un-escaped or un-quoted metacharacters may yield surprising effects instead of being included verbatim in the commit message, e.g.¬†* is replaced by all of the file and directory names in the current directory!\nIf no commit message is provided after the aliases, a generic commit message is created that includes the change type and name of each changed file. In Section¬†5.2, I describe how I used this generic commit message approach to further simplify the Git workflow.\n\n\nKeybindings\nAn alternative to a shell alias that combines git commands is to use a keyboard shortcut in a Git Graphical User Interface (GUI) such as GitHub Desktop or the Git interface in a code editor like VSCode, VSCodium, or RStudio. I use keyboard shortcuts in VSCode and VSCodium to send shell commands to the integrated terminal without moving my focus away from the files I am editing.\nI created different shortcuts to control which files are included in each commit: ‚å•‚áßF for the current file only, ‚å•‚áßS for already staged files, ‚å•‚áßT for all tracked files, and ‚å•‚áßU for all files including untracked files. I also have keyboard shortcuts that affect a specific directory (and all of its subdirectories): ‚å•‚áßD for the current file‚Äôs directory, ‚å•‚áß. for shell‚Äôs current directory, ‚å•‚áßC for the current working directory according to VSCode/VSCodium, ‚å•‚áßW for the Workspace directory.\nExample¬†9 displays the ‚å•‚áßF shortcut as an example of the VSCode/VSCodium shortcut syntax. This shortcut uses the escape code for the return key (\\u000D) to run several git commands and predefined variables to insert the absolute (${file}) and relative (${relativeFile}) path to the currently open file.\n\nExample 9 ¬†\n\n\nkeybindings.json\n\n{\n  \"key\": \"shift+alt+f\",\n  \"command\": \"workbench.action.terminal.sendSequence\", \"args\": { \"text\":\n    \"git add ${file} && git commit -m \\\"M ${relativeFile}\\\" && git push\\u000D\" },\n  \"when\": \"terminalIsOpen\"\n}\n\n\nIf you want to set up similar shortcuts for yourself, take a look at my keybindings.json in my setup repo on GitHub and GitLab. As you create keyboard shortcuts, please be mindful of keybinding conflicts that may arise.\nTo set up a keyboard shortcut that runs a series of steps rather than a single line of shell code, I suggest you use the VSCode/VSCodium Tasks mechanism, a system designed to automate software build tasks. The default keyboard shortcut to run all tasks in a local or global task.json file is ‚åÉ‚áßB on Linux/Windows or ‚åò‚áßB on Mac (mnemonic: B is for Build), but you can bind other shortcuts to specific tasks.\nIf you use a text editor like Vim or Emacs, you can create keybindings for Vim plugins like fugitive or Emacs packages like magit that run through the entire Git workflow. Example¬†10 shows the Vim+fugitive equivalent of my ‚å•‚áßF VSCode/VSCodium keybinding.\n\nExample 10 ¬†\n\n\n.vimrc\n\nnnoremap &lt;A-S-f&gt; :Gw&lt;bar&gt;G! commit -m \"M \"%&lt;bar&gt;G! push&lt;CR&gt;\n\n\nThe drawback of my keyboard shortcut approach for the Git workflow is that it produces generic commit messages that are no very informative. Anyone reading the messages will not be able to tell what changes were made and more importantly why the changes were made.\nTo automatically generate commit messages based on the currently staged changes, we can use a Large Language Model (LLM). Generative artificial intelligence models like LLMs tend to be large in size and have atypical computational requirements, so I will save my adventures with LLMs for a different post.\nI really enjoy using Git, especially with shell aliases in my terminal and keyboard shortcuts in my favorite text editors. If we ever collaborate on a project together, you can be sure that I will insist on using Git!",
    "crumbs": [
      "Software",
      "Git"
    ]
  },
  {
    "objectID": "dec/time/index.html",
    "href": "dec/time/index.html",
    "title": "Dec Time",
    "section": "",
    "text": "Time\nMy website provides many examples of the Quarto publishing and the Dec measurement systems in action. I leverage Quarto support for the Observable data analysis and visualization system to create animated and interactive graphics like the clocksüïìand barüìächarts below, which display a Dec time like the one on the left side of the navigation bar (navbar) above.\nDec times are measured in fractional days. The shortest, longest, and thinnest clocküïìhands and the top, middle, and bottom barsüìäindicate the decidays, millidays, and centimillidays, respectively, of the time since the start, +, or until the end, -, of the day in the Dec time zone, , selected by the red‚≠ïÔ∏ècircle on the solar‚òÄÔ∏èterminator mapüó∫Ô∏èbeneath the barsüìä.\n\n\n\n\nbarChart = {\nconst W = width;\n  const H = 88;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W * .87, H]);\n  const xRange = [0, W - 100];\n  const scaleDD = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleMandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data([\n      'dd', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=&gt;i*30+firstBarY)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(Number(barBeats)))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(barBeats))\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(Number(barDD)+Number(barMils)/100+Number(barBeats)/10000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(barDD))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(Number(barMils)+Number(barBeats)/100))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(barMils))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+30)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickB1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+47:firstBarY+50)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=&gt;scaleDD(d)+barX)\n    .attr('y', firstBarY+20)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=&gt;scaleDD(d)+barX+.5)\n    .attr('y', firstBarY+18)\n    .text(d=&gt;d)\n    .style(\"font-size\", `{width &lt; 350 ? 12 : 20}px`)\n  // Cent ticks\n  svg.selectAll('.tickC2')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC2')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+10)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`+${barDD}`, `${barMils}`, `${barBeats}`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=&gt;i*30+firstBarY+20)\n    .text(d=&gt;d);\n  svg.attr(\"id\", \"barClock\");\n  return svg.node();\n}\nbarChart1 = {\nconst W = width;\n  const H = 88;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W * .87, H]);\n  const xRange = [0, W - 100];\n  const scaleDD = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleMandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  // const scaleDek = d3.scaleLinear()\n  //  .domain([0, 37])\n  //  .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data([\n      // 'dek', 'dotd',\n      'dd', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=&gt;i*30+firstBarY)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(Number(barBeatsN)))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(barBeatsN))\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(Number(barDDN)+Number(barMilsN)/100+Number(barBeatsN)/10000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(barDDN))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(Number(barMilsN)+Number(barBeatsN)/100))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(barMilsN))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+30)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickB1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+47:firstBarY+50)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=&gt;scaleDD(d)+barX)\n    .attr('y', firstBarY+20)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=&gt;scaleDD(d)+barX+.5)\n    .attr('y', firstBarY+18)\n    .text(d=&gt;d)\n  // Cent ticks\n  svg.selectAll('.tickC2')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC2')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+10)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`-${barDDN}`, `${barMilsN}`, `${barBeatsN}`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=&gt;i*30+firstBarY+20)\n    .text(d=&gt;d);\n  svg.attr(\"id\", \"barClock\");\n  return svg.node();\n}\nviewof location = worldMapCoordinates([162, 0], [width * .998, Math.round((21 / 40) * width)])\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\napp = {\n  const svg = d3.select(DOM.svg(width, height));\n  svg.style(\"user-select\", \"none\")\n     .style(\"-webkit-user-select\", \"none\");\n  const margin = {top: 0, left: 10, right: 10, bottom: 0, inner: 3};\n  const contentWidth = width - margin.left - margin.right - margin.inner;\n  const columnWidth = contentWidth / 2;\n  let selection = {\n    date: new Date(),\n    hour: new Date().getHours()\n  }\n  const renderPlot = () =&gt; {\n    svg.selectAll(\"#daylightplot *\").remove();\n    svg.select(\"#daylightplot\").call(daylightPlot, {\n      width: columnWidth / 1.28,\n      height: height / 1.51 - margin.top - margin.bottom,\n      year: new Date().getFullYear(),\n      latitude: location[1],\n      defaultDate: selection.date,\n      defaultHour: selection.hour\n    })\n  }\n  const renderGlobe = () =&gt; {\n    svg.selectAll(\"#globe *\").remove();\n    svg.selectAll(\"#globe\").call(globe, { width: columnWidth * 1.22, location, ...selection });\n  }\n  const renderSolarSystem = () =&gt; {\n    svg.selectAll(\"#solar-system *\").remove();\n    svg.selectAll(\"#solar-system\").call(solarSystem,\n                                        columnWidth / 1.08,\n                                        location,\n                                        selection.date,\n                                        selection.hour);\n  }\n  const setSelection = (newSelection, forceRender = false) =&gt; {\n    const prev = {...selection};\n    selection = newSelection;\n    svg.node().value = selection;\n    if (forceRender) {\n      renderPlot();\n      renderSolarSystem();\n      renderGlobe();\n    } else if (prev.hour !== selection.hour || prev.date !== selection.date) {\n      renderSolarSystem();\n      renderGlobe();\n    }\n  }\n  svg.append(\"g\")\n    .attr(\"id\", \"solar-system\")\n    .attr(\"transform\", `translate(${margin.left}, ${margin.top + height / 7.6})`);\n  const plot = svg.append(\"g\")\n    .attr(\"id\", \"daylightplot\")\n    .attr(\"transform\", `translate(${margin.left}, ${margin.top + height / 4})`);\n  svg.append(\"g\")\n    .attr(\"id\", \"globe\")\n    .attr(\"transform\", `translate(${margin.left + margin.inner + columnWidth / 1.25}, ${margin.top + Number(columnWidth &lt; 300) * 16})`);\n  setSelection(selection, true);\n  const handleDateHourChange = ({ target, detail: { date, hour }}) =&gt; {\n    if (date != null && hour != null) setSelection({...selection, date, hour});\n  }\n  svg.node().addEventListener(EventType.DateHourChange, handleDateHourChange, false);\n  return svg.node();\n}\n// https://observablehq.com/@d3/simple-clock\n// https://observablehq.com/@drio/lets-build-an-analog-clock\nclock = {\n  const clockRadius = 200,\n    margin = 50,\n    w = (clockRadius + margin) * 2,\n    h = (clockRadius + margin) * 2,\n    hourHandLength = (2 * clockRadius) / 3,\n    minuteHandLength = clockRadius,\n    secondHandLength = clockRadius - 12,\n    secondHandBalance = 30,\n    secondTickStart = clockRadius,\n    secondTickLength = -10,\n    hourTickStart = clockRadius,\n    hourTickLength = -18,\n    secondLabelRadius = clockRadius + 16,\n    secondLabelYOffset = 5,\n    hourLabelRadius = clockRadius - 40,\n    hourLabelYOffset = 7,\n    radians = Math.PI / 180;\n  const ten = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 10]);\n  const sto = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 100]);\n  const handData = [\n    {\n      type: \"hour\",\n      value: 0,\n      length: -hourHandLength,\n      scale: ten\n    },\n    {\n      type: \"minute\",\n      value: 0,\n      length: -minuteHandLength,\n      scale: sto\n    },\n    {\n      type: \"second\",\n      value: 0,\n      length: -secondHandLength,\n      scale: sto,\n      balance: secondHandBalance\n    }\n  ];\n  function drawClock() {\n    // create all the clock elements\n    updateData(); //draw them in the correct starting position\n    const face = svg\n      .append(\"g\")\n      .attr(\"id\", \"clock-face\")\n      .attr(\"transform\", `translate(${[w / 2, h / 2]})`);\n    // add marks for seconds\n    face\n      .selectAll(\".second-tick\")\n      .data(d3.range(0, 100))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"second-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", secondTickStart)\n      .attr(\"y2\", secondTickStart + secondTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${sto(d)})`);\n    // and labels...\n    face\n      .selectAll(\".second-label\")\n      .data(d3.range(0, 100, 5))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"second-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; secondLabelRadius * Math.sin(sto(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt;\n          -secondLabelRadius * Math.cos(sto(d) * radians) + secondLabelYOffset\n      )\n      .text(d =&gt; d);\n    // ... and hours\n    face\n      .selectAll(\".hour-tick\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"hour-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", hourTickStart)\n      .attr(\"y2\", hourTickStart + hourTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${ten(d)})`);\n    face\n      .selectAll(\".hour-label\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"hour-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; hourLabelRadius * Math.sin(ten(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt; -hourLabelRadius * Math.cos(ten(d) * radians) + hourLabelYOffset\n      )\n      .text(d =&gt; d);\n    const hands = face.append(\"g\").attr(\"id\", \"clock-hands\");\n    hands\n      .selectAll(\"line\")\n      .data(handData)\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", d =&gt; d.type + \"-hand\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", d =&gt; d.balance || 0)\n      .attr(\"x2\", 0)\n      .attr(\"y2\", d =&gt; d.length)\n      .attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n    face\n      .append(\"g\")\n      .attr(\"id\", \"face-overlay\")\n      .append(\"circle\")\n      .attr(\"class\", \"hands-cover\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"r\", clockRadius / 20);\n  }\n  function moveHands() {\n    const sel = d3\n      .select(\"#clock-hands-final\")\n      .selectAll(\"line\")\n      .data(handData)\n      .transition();\n    if (fancySecondsOFF) sel.ease(d3.easeElastic.period(0.5));\n    sel.attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n  }\n  function updateData() {\n    handData[0].value = !fancySecondsOFF ? Math.floor(selectedExact * 10) : decTime[0];\n    handData[1].value = !fancySecondsOFF ? Math.floor(selectedExact * 10 % 1 * 100) : decTime.slice(2, 4);\n    handData[2].value = !fancySecondsOFF ? selectedExact * 10 % 1 * 100 % 1 * 100 : decTime.slice(4, 6);\n  }\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"viewBox\", [0, 0, w, h])\n    .style(\"max-width\", \"350px\")\n    .attr(\"class\", \"clock-top\")\n    .attr(\"id\", \"clock\");\n  svg\n    .append(\"text\")\n    .text(`+${decTime}-${selectedZone}`)\n    .attr(\"x\", clockRadius + margin)\n    .attr(\"y\", clockRadius * 2 + margin * 1.975)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", 32)\n    .attr(\"font-family\", \"monospace\");\n  drawClock();\n  // Animation\n  const interval = setInterval(\n    () =&gt; {\n      updateData();\n      moveHands();\n    },\n    !fancySecondsOFF ? 10 : 864\n  );\n  invalidation.then(() =&gt; clearInterval(interval));\n  return svg.node();\n}\nclock1 = {\n  const clockRadius = 200,\n    margin = 50,\n    w = (clockRadius + margin) * 2,\n    h = (clockRadius + margin) * 2,\n    hourHandLength = (2 * clockRadius) / 3,\n    minuteHandLength = clockRadius,\n    secondHandLength = clockRadius - 12,\n    secondHandBalance = 30,\n    secondTickStart = clockRadius,\n    secondTickLength = -10,\n    hourTickStart = clockRadius,\n    hourTickLength = -18,\n    secondLabelRadius = clockRadius + 16,\n    secondLabelYOffset = 5,\n    hourLabelRadius = clockRadius - 40,\n    hourLabelYOffset = 7,\n    radians = Math.PI / 180;\n  const ten = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 10]);\n  const sto = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 100]);\n  const handData = [\n    {\n      type: \"hour\",\n      value: 0,\n      length: -hourHandLength,\n      scale: ten\n    },\n    {\n      type: \"minute\",\n      value: 0,\n      length: -minuteHandLength,\n      scale: sto\n    },\n    {\n      type: \"second\",\n      value: 0,\n      length: -secondHandLength,\n      scale: sto,\n      balance: secondHandBalance\n    }\n  ];\n  function drawClock() {\n    // create all the clock elements\n    updateData(); //draw them in the correct starting position\n    const face = svg\n      .append(\"g\")\n      .attr(\"id\", \"clock-face\")\n      .attr(\"transform\", `translate(${[w / 2, h / 2]})`);\n    // add marks for seconds\n    face\n      .selectAll(\".second-tick\")\n      .data(d3.range(0, 100))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"second-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", secondTickStart)\n      .attr(\"y2\", secondTickStart + secondTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${sto(d)})`);\n    // and labels...\n    face\n      .selectAll(\".second-label\")\n      .data(d3.range(0, 100, 5))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"second-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; secondLabelRadius * Math.sin(sto(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt;\n          -secondLabelRadius * Math.cos(sto(d) * radians) + secondLabelYOffset\n      )\n      .text(d =&gt; d);\n    // ... and hours\n    face\n      .selectAll(\".hour-tick\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"hour-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", hourTickStart)\n      .attr(\"y2\", hourTickStart + hourTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${ten(d)})`);\n    face\n      .selectAll(\".hour-label\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"hour-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; hourLabelRadius * Math.sin(ten(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt; -hourLabelRadius * Math.cos(ten(d) * radians) + hourLabelYOffset\n      )\n      .text(d =&gt; d);\n    const hands = face.append(\"g\").attr(\"id\", \"clock-hands\");\n    hands\n      .selectAll(\"line\")\n      .data(handData)\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", d =&gt; d.type + \"-hand\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", d =&gt; d.balance || 0)\n      .attr(\"x2\", 0)\n      .attr(\"y2\", d =&gt; d.length)\n      .attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n    face\n      .append(\"g\")\n      .attr(\"id\", \"face-overlay\")\n      .append(\"circle\")\n      .attr(\"class\", \"hands-cover\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"r\", clockRadius / 20);\n  }\n  function moveHands() {\n    const sel = d3\n      .select(\"#clock-hands-final\")\n      .selectAll(\"line\")\n      .data(handData)\n      .transition();\n    if (fancySecondsOFF) sel.ease(d3.easeElastic.period(0.5));\n    sel.attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n  }\n  function updateData() {\n    handData[0].value = !fancySecondsOFF ? Math.floor(selectedExactN * 10) : decTimeN[0];\n    handData[1].value = !fancySecondsOFF ? Math.floor(selectedExactN * 10 % 1 * 100) : decTimeN.slice(2, 4);\n    handData[2].value = !fancySecondsOFF ? selectedExactN * 10 % 1 * 100 % 1 * 100 : decTimeN.slice(4, 6);\n  }\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"viewBox\", [0, 0, w, h])\n    .style(\"max-width\", \"350px\")\n    .attr(\"class\", \"clock-btm\")\n    .attr(\"id\", \"clock\");\n  svg\n    .append(\"text\")\n    .text(`-${decTimeN}-${selectedZone}`)\n    .attr(\"x\", clockRadius + margin)\n    .attr(\"y\", clockRadius * 2 + margin * 1.975)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", 32)\n    .attr(\"font-family\", \"monospace\");\n  drawClock();\n  // Animation\n  const interval = setInterval(\n    () =&gt; {\n      updateData();\n      moveHands();\n    },\n    !fancySecondsOFF ? 10 : 864\n  );\n  invalidation.then(() =&gt; clearInterval(interval));\n  return svg.node();\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nwidth\n\n\n\n\n\n\nThe plot to the lower left of the mapüó∫Ô∏èvisualizes the nighttime (blue) and daytime (yellow) time of day (x-axis) throughout every day of the year (y-axis) at the latitude of the red‚≠ïÔ∏ècircle on the mapüó∫Ô∏è. The‚Üïvertical position of the red‚Äîline (time of day) and the‚ÜîÔ∏éÔ∏èhorizontal position of the redüî¥dot (day of the year) on the plot control theüåêglobes above and to the right of the plot.\n\n\nZone\nDrag the red‚≠ïÔ∏ècircle across the meridians (vertical‚Üïgray lines) on the mapüó∫Ô∏èto see how changing time zones affects the time. Only the first digit of the Dec times shown above, the deciday, varies across time zones, because the 10 Dec time zones, numbered 0 through 9 on the mapüó∫Ô∏è, are each 1 deciturn (d\\(\\tau\\)) wide. Simply put, a deciturn of longitude translates into a deciday of time.\nThe leftmost vertical‚Üïline on the mapüó∫Ô∏èis Meridian 0, the Dec International Date Line and prime meridian, which cuts across the Atlantic Ocean through IcelandüáÆüá∏just West of Africaüåçand is the boundary between Zone 9 and Zone 0, the rightmost and leftmost Dec time zones on the mapüó∫Ô∏è, respectively. Arranging Dec time zones from 0 to 9 yields a Pacific-centric mapüó∫Ô∏è.\nWhile only positive Dec time zones are shown on the mapüó∫Ô∏è, every Dec time zone can also be expressed as a negative number. Each pair of time zone numbers produces the same Dec time, but result in Dec datesüóìÔ∏è that are 1 day apart. Negative time zone numbers can be useful for getting Dec datesüóìÔ∏èto match Gregorian calendarüóìÔ∏èdates with negative UTC offsets.\nThere are 37 UTC offsets, but only 10 Dec time zones. Conversion between Dec time zones and UTC offsets is not straightforward, because UTC offsets are influenced by geographic and political boundaries, whereas Dec time zones are determined solely by longitude. If you know your longitude in degrees (¬∞) or centiturns (\\(c\\tau\\)), you can look up your Dec time zone in the table below.\n\n\n\n\n\n\n\n\n\n\n\n\n\nTZ+\nTZ-\nStart¬∞\nMid¬∞\nEnd¬∞\nStart\\(c\\tau\\)\nMid\\(c\\tau\\)\nEnd\\(c\\tau\\)\n\n\n\n\n9\n-1\n-54\n-36\n-18\n90\n95\n100\n\n\n8\n-2\n-90\n-72\n-54\n80\n85\n90\n\n\n7\n-3\n-126\n-108\n-90\n70\n75\n80\n\n\n6\n-4\n-162\n-144\n-126\n60\n65\n70\n\n\n5\n-5\n162\n180\n-162\n50\n55\n60\n\n\n4\n-6\n126\n144\n162\n40\n45\n50\n\n\n3\n-7\n90\n108\n126\n30\n35\n40\n\n\n2\n-8\n54\n72\n90\n20\n25\n30\n\n\n1\n-9\n18\n36\n54\n10\n15\n20\n\n\n0\n-10\n-18\n0\n18\n0\n5\n10\n\n\n\nDec times in Zone 0 and 5 can be directly converted to and from UTC times with an offset of 0 and 12 hours, respectively. The other Dec time zones will differ from the closest UTC time by 8.3, 16.6, 25, 33.3, 41.6 or 50 millidays. To find the difference Œ¥, convert the UTC offset hours oh and minutes om into deciturns of the longitude Œª and then subtract the Dec zone number z:\n\\[\\lambda = o_h \\div 2.4 + o_m \\div 144\\]\n\\[z = \\lfloor\\lambda + 1 \\div 2\\rfloor\\]\n\\[\\delta = \\lambda - z\\]\nWe can avoid dealing with the time zone difference by shifting the time zone so that we always convert between Zone 0 and UTC+00:00 or Zone 5 and UTC+12:00. To obtain the Zone 0 time, we evaluate a Dec time as a math expression, add 10, and get the remainder after dividing by 10 to make sure the result is less than 10 decidays: (   + 10) mod 10 = .\n\n\nUnit\nDec uses metric prefixes to create submultiples of a day that can naturally be combined together into a single decimal number. Conversion between decimal units is as simple as moving‚ÜîÔ∏éÔ∏èor removing‚ùåthe decimal separator. In contrast, times in hours, minutes, and seconds are typically expressed as mixed-radix hh:mm:ss number instead of a decimal number.\n\n\n\nPrefix\nPower\nhh:mm:ss.sss\n\n\n\n\n\n0\n24:00:00.000\n\n\ndeci\n-1\n02:24:00.000\n\n\ncenti\n-2\n00:14:24.000\n\n\nmilli\n-3\n00:01:26.400\n\n\ndecimilli\n-4\n00:00:08.640\n\n\ncentimilli\n-5\n00:00:00.864\n\n\n\nTo convert the hour h, minute m, and second s into the deciday d, Dec uses the following equation: d = h √∑ 2.4 + m √∑ 144 + s √∑ 8640. The current equation values in Zone  are:  =  √∑ 2.4 +  √∑ 144 +  √∑ 8640. Inversely, we can convert decidays into hours: h = d √ó 2.4, minutes: m = h mod 1 √ó 60, and seconds: s = m mod 1 √ó 60.\nObtain Dec time from UNIX time is better than dealing with hours, minutes, and seconds. To obtain the Dec time d+0 from the UNIX timestamp u, we divide u by 86400 to convert seconds to days, isolate the decimal part of the quotient, and then multiply by 10: d + 0 = u √∑ 86400 mod 1 √ó 10. The current values in this equation are  + 0 =  √∑ 86400 mod 1 √ó 10.\nThe concept of measuring time in decimal days is not novel. In the late 1700s, the French Republican calendar time system referred to decidays as decimal hours, centidays as d√©cimes, millidays as decimal minutes, and centimillidays as decimal seconds. Similarly, Swatch Internet Time, a decimal time system introduced in 1998, uses the term ‚Äú.beats‚Äù for millidays.\nSwatch Internet Time differs from Dec in that it has no time zones and is obtained from UTC+01:00 hours, minutes, and seconds. The major innovations described in this article are the Dec time zone system and the simple equation for obtaining Zone 0 Dec time from UNIX time, but Dec has much more to offer than deciday times and zones.\n\n\nNext\nThe next article in the Dec section compares Dec to the ISO 8601 international standard for dates and times. Like ISO 8601, Dec allows for combined date and time representations that can be paired up to express time intervals. In Dec, the combination of a date and time is called a snap and a time interval expressed as a pair of snaps is called a span.\nMy ISO 8601 article is unique because it avoids the use of Observable in favor of leveraging Jupyter support in Quarto to make the code underlying Dec available in multiple programming languages. Observable is a great visualization tool but does not translate well into Jupyter notebooks. After my ISO article, I return to the use of Observable in my Dec snap and span articles.\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [(unix ?? Date.now()) / 86400000 + (\n    zone = zone ?? -Math.round(\n      (new Date).getTimezoneOffset() / 144)\n    ) / 10 + offset, zone]\n}\nfunction unix2dote1(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nbrowserDote = unix2dote(unix)\nbrowserTime = browserDote[0] % 1 * 10\nbrowserZone = browserDote[1]\nbrowserSign = browserZone &gt; 0 ? \"-\" : \"+\"\nzone0time = (browserTime - browserZone + 10) % 10\nhours = browserTime * 2.4\nminutes = hours % 1 * 60\nseconds = minutes % 1 * 60\nselectedDote = unix2dote(unix, long2zone(location[0]))\nselectedExact = selectedDote[0] % 1\nselectedExactN = (1 - selectedExact) % 1\nselectedZone = selectedDote[1]\ndecTime = (selectedExact * 10).toFixed(4)\ndecTimeN = (selectedExactN * 10).toFixed(4)\nbarDD = decTime[0]\nbarDDN = decTimeN[0]\nbarMils = decTime.slice(2, 4)\nbarMilsN = decTimeN.slice(2, 4)\nbarBeats = decTime.slice(4, 6)\nbarBeatsN = decTimeN.slice(4, 6)\nfunction lati2turn1(degrees = -180, e = 3) {\n  // turns: e=0, deciturns: e=1, etc.\n  return (degrees %= 360) / (360 / 10**e) % 10**e;\n}\nfunction dote2deco(dote = 719468, zone = 0, lead = \"0\", emoji = false, minus = false) {\nlet [year, doty] = dote2date(dote);\n  if (minus) {\n    doty = Math.abs(doty - (365 + Number(year2leap(year + 1))));\n    if (zone != null) {\n      zone = (10 - zone) % 10;\n    }\n  }\nreturn `${\n    (year + minus).toString().padStart(4, lead)}${minus ? \"-\" : \"+\"}${\n    Math.floor(doty).toString().padStart(3, lead)}${emoji ? \"üóìÔ∏è\" : \"\"}${(doty % 1 * 10).toFixed(4)}${\n    zone != null ? (minus ? \"+\" : \"-\") + String(zone) : \"\"}${emoji ? \"üï∞Ô∏è\" : \"\"}`\n}\ngraticule = d3.geoGraticule().stepMinor([36,36]).stepMajor([36,36])()\ngraticule.coordinates = graticule.coordinates.map(\n  i =&gt; i.map(j =&gt; j.map((k, index, arr) =&gt; i.length === 3 && index === 0 ? k - 18 : k))\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction long2turn(degrees = -180, e = 3) {\n  // turns: e=0, deciturns: e=1, etc.\n  return (((degrees %= 360) &lt; 0 ? degrees + 360 : degrees) + 18) / (360 / 10**e) % 10**e;\n}\n// https://github.com/topojson/world-atlas\nworld = d3.json(\"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\")\ncountries = topojson.feature(world, world.objects.countries)\ntopojson = require(\"topojson-client@3\")\nfunction long2zone(degrees = -180) {\n  return Math.floor(long2turn(degrees, 1));\n}\nfunction year2leap(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\nsolarSystem = (root, width, location, date, hour) =&gt; {\n  const earthRadius = 0.04 * width;\n  const sunRadius = 0.08 * width;\n  const solarSystemRadius = width / 2 - 20;\n  const stretch = 0.3;\n  const solarAngle = getSolarAngle(date);\n  const solarAngleDeg = (solarAngle * 180) / Math.PI;\n  const x = solarSystemRadius * Math.sin(solarAngle);\n  const y = stretch * solarSystemRadius * Math.cos(solarAngle);\n  const spin = 180 + -location[0] + solarAngleDeg + 360 * ((hour + 12) / 24);\n  const earthGeo = { type: \"Sphere\" };\n  const projection = d3\n    .geoOrthographic()\n    .fitWidth(earthRadius * 2, earthGeo)\n    .rotate([spin, 0, 23.5])\n    .translate([0, 0]);\n  const staticProjection = d3\n    .geoOrthographic()\n    .fitWidth(earthRadius * 2, earthGeo)\n    .rotate([solarAngleDeg - 90, 0])\n    .translate([0, 0]);\n  const path = d3.geoPath(projection).pointRadius(1.5);\n  const staticPath = d3.geoPath(staticProjection);\n  const solarSystem = root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${width / 2})`);\n  solarSystem.append(\"circle\").attr(\"r\", sunRadius).attr(\"fill\", colors.sun);\n  /* Draw orbit */\n  solarSystem\n    .append(\"ellipse\")\n    .attr(\"rx\", solarSystemRadius)\n    .attr(\"ry\", stretch * solarSystemRadius)\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", \"black\");\n  /* Draw month ticks */\n  d3.range(12).map((m) =&gt; {\n    const d = new Date(date.getFullYear(), m, 1);\n    const angle = getSolarAngle(d);\n    solarSystem\n      .append(\"line\")\n      .attr(\"x1\", (solarSystemRadius + 6) * Math.sin(angle))\n      .attr(\"y1\", (solarSystemRadius + 6) * stretch * Math.cos(angle))\n      .attr(\"x2\", (solarSystemRadius - 6) * Math.sin(angle))\n      .attr(\"y2\", (solarSystemRadius - 6) * stretch * Math.cos(angle))\n      .attr(\"stroke\", \"black\");\n    const startMonthAngle = getSolarAngle(new Date(date.getFullYear(), m, 1));\n    solarSystem\n      .append(\"text\")\n      .text(date2doty(d))\n      .attr(\"x\", (solarSystemRadius + 18) * Math.sin(startMonthAngle))\n      .attr(\n        \"y\",\n        (solarSystemRadius + 18) * 1.18 * stretch * Math.cos(startMonthAngle)\n      )\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n      .attr(\"dominant-baseline\", \"middle\")\n      .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n      .attr(\"font-family\", \"sans-serif\")\n      .attr(\"fill\", \"black\");\n  });\n  const earth = solarSystem\n    .append(\"g\")\n    .attr(\"transform\", `translate(${x}, ${y})`);\n  earth\n    .append(\"line\")\n    .attr(\"y1\", -1.5 * earthRadius)\n    .attr(\"y2\", 1.5 * earthRadius)\n    .attr(\"stroke\", \"blue\")\n    .attr(\"transform\", `rotate(-23.5)`);\n  earth.append(\"path\").attr(\"d\", path(earthGeo)).attr(\"fill\", colors.ocean);\n  earth.append(\"path\").attr(\"d\", path(land)).attr(\"fill\", colors.land);\n  earth.append(\"path\")\n  .attr(\"d\", path(countries))\n  .attr(\"stroke-width\", \".075\")\n  .attr(\"fill\", \"none\")\n  .attr(\"stroke\", \"#555\");\n  const shadowPolygon = [\n    [0, -90],\n    [0, 0],\n    [0, 90],\n    [180, 0],\n    [0, -90]\n  ];\n  earth\n    .append(\"path\")\n    .attr(\"d\", staticPath({ type: \"Polygon\", coordinates: [shadowPolygon] }))\n    .attr(\"fill\", \"rgba(0, 0, 0, 0.5)\");\n  earth\n    .append(\"path\")\n    .attr(\"d\", path({ type: \"Point\", coordinates: location }))\n    .attr(\"r\", 18)\n    .attr(\"stroke-width\", .3)\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", \"red\");\n}\nfunction greg2doty(month = 1, day = 1) {\n    return Math.floor(\n        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5 + day - 1\n)}\nfunction date2doty(date) {\n  return greg2doty(date.getMonth() + 1, date.getDate())\n}\nfunction date2doty1(date) {\n  const doty = greg2doty(date.getMonth() + 1, date.getDate())\n  return doty === 31 ? \"Day \" + String(doty) : doty\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\nglobe = (root, { width, location, date, hour }) =&gt; {\n  const solarAngle = getSolarAngle(date);\n  const solarAngleDeg = toDegrees(solarAngle);\n  const hourSpin = 360 * ((hour + 12) / 24);\n  const spin = (180 + -location[0] + solarAngleDeg + hourSpin);\n  const tilt = -15;\n  const projection = d3.geoOrthographic()\n                       .fitWidth(width, graticule)\n                       .rotate([spin, tilt, 23.5]);\n  const path = d3.geoPath(projection);\n  const unClippedProjection = d3.geoOrthographic()\n                                .clipAngle(null)\n                                .fitWidth(width, graticule)\n                                .rotate([spin, tilt, 23.5]);\n  const unClippedPath = d3.geoPath(unClippedProjection);\n  const staticProjection = d3.geoOrthographic()\n                             .fitWidth(width, graticule)\n                             .rotate([solarAngleDeg - 90, tilt]);\n  const staticPath = d3.geoPath(staticProjection);\n  const background = root.append(\"g\");\n  const earth = root.append(\"g\").style(\"opacity\", 0.75);\n  const foreground = root.append(\"g\");\n  earth.append(\"path\")\n    .attr(\"d\", path({type: \"Sphere\"}))\n    .attr(\"fill\", colors.ocean)\n    .attr(\"stroke\", \"#9ecbda\");\n  earth.append(\"path\")\n    .attr(\"d\", path(graticule))\n    .attr(\"stroke-width\", \"1\")\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", \"#888\");\n  earth.append(\"path\")\n    .attr(\"d\", path(land))\n    .attr(\"fill\", colors.land);\n  earth.append(\"path\")\n    .attr(\"d\", path(countries))\n    .attr(\"stroke-width\", \"1\")\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", \"#000\");\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath({type: \"Point\", coordinates: location}))\n    .attr(\"fill\", \"red\");\n  const latitudeCoords = (latitude, start, end) =&gt; {\n    const longitudes = d3.range(start, end, 2).concat(end);\n    return longitudes.map(d =&gt; [d, latitude]);\n  }\n  const correctSpin = d3.geoRotation([-hourSpin, 0]);\n  const correctTilt = d3.geoRotation([6, 0, 0]);\n  /* total angular extent of day/night */\n  const dayExtent = 360 * dayLength(date, location[1]) / 24;\n  const nightExtent = 360 - dayExtent;\n  const dayLine = {\n    type: \"LineString\",\n    coordinates: latitudeCoords(location[1],\n                                location[0] - dayExtent / 2,\n                                location[0] + dayExtent / 2).map(d =&gt; correctSpin(d))\n  };\n  const nightLine = {\n    type: \"LineString\",\n    coordinates: latitudeCoords(location[1],\n                                location[0] - dayExtent / 2 - nightExtent,\n                                location[0] - dayExtent / 2).map(d =&gt; correctSpin(d))\n  };\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath(dayLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.day)\n    .attr(\"stroke-width\", 3);\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath(nightLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.night)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path(dayLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.day)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path(nightLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.night)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path({type: \"Point\", coordinates: location}))\n    .attr(\"stroke-width\", .5)\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", \"red\");\n  const shadowPolygon = [[0, -90], [0, 0], [0, 90], [180, 0], [0, -90]].map(d =&gt; correctTilt(d));\n  foreground.append(\"path\")\n    .attr(\"d\", staticPath({type: \"Polygon\", coordinates: [shadowPolygon]}))\n    .attr(\"fill\", \"rgba(0, 0, 0, 0.25)\");\n}\ndayOfYear = (date) =&gt; {\n  const yearStart = new Date(date.getFullYear(), 0, 1+60);\n  return Math.floor((date.getTime() - yearStart.getTime())/86400000) + 1\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\ndaylightPlot = (\n  root,\n  { width, height, year, latitude, defaultDate, defaultHour }\n) =&gt; {\n  const margin = { top: 24, bottom: 32, left: 48, right: 0 };\n  const chartWidth = width - margin.left - margin.right;\n  const chartHeight = height - margin.top - margin.bottom;\n  const xTickValues =\n    width &gt; 380 ? [3, 6, 9, 12, 15, 18, 21] : width &gt; 240 ? [6, 12, 18] : [12];\n  const xScale = d3\n    .scaleLinear()\n    .domain([0, 24])\n    .range([margin.left, margin.left + chartWidth])\n    .clamp(true);\n  // y-axis scale\n  const yScale = d3\n    .scaleTime()\n    .domain([new Date(year, 0, 1+60), new Date(year, 11, 31+60)])\n    .range([margin.top, margin.top + chartHeight])\n    .clamp(true);\n  // y-axis labels\n  const yAxis = d3\n    .axisLeft(yScale)\n    .tickValues(d3.timeMonth.range(new Date(year, 1, 1+60), new Date(year, 12, 1+57)))\n    .tickSize(chartWidth)\n    .tickFormat(date2doty1);\n  const xAxis = d3\n    .axisBottom(xScale)\n    .tickValues(xTickValues)\n    .tickSize(chartHeight)\n    .tickFormat((d) =&gt; {\n      return `${d / .024}`;\n    });\n  let date = defaultDate || new Date();\n  let hour = defaultHour != null ? defaultHour : date.getHours();\n  const handleMouseMove = (e) =&gt; {};\n  root\n    .append(\"rect\")\n    .attr(\"x\", margin.left)\n    .attr(\"y\", margin.top)\n    .attr(\"width\", chartWidth)\n    .attr(\"height\", chartHeight)\n    .attr(\"rx\", 0.05 * width)\n    .attr(\"fill\", colors.night);\n  root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left + chartWidth}, 0)`)\n    .call(yAxis)\n    .call((g) =&gt; g.select(\".domain\").remove())\n    .call((g) =&gt; g.selectAll(\".tick\").attr(\"color\", colors.grid))\n    //.call((g) =&gt; g.selectAll(\".tick text\").attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2)))\n    .call((g) =&gt; g.selectAll(\".tick text\").attr(\"color\", \"black\"))\n    .call((g) =&gt; g.selectAll(\".tick line\").attr(\"stroke-dasharray\", \"5 3\"));\n  root\n    .append(\"g\")\n    .attr(\"transform\", `translate(0, ${margin.top})`)\n    .call(xAxis)\n    .call((g) =&gt; g.select(\".domain\").remove())\n    .call((g) =&gt; g.selectAll(\".tick\").attr(\"color\", colors.grid))\n    //.call((g) =&gt; g.selectAll(\".tick text\").attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2)))\n    .call((g) =&gt; g.selectAll(\".tick text\").attr(\"color\", \"black\"))\n    .call((g) =&gt; g.selectAll(\".tick line\").attr(\"stroke-dasharray\", \"5 3\"));\n  root\n    .append(\"text\")\n    .text(\"Time of day (millidays)\")\n    .attr(\"x\", margin.left + chartWidth / 2)\n    .attr(\"y\", margin.top + chartHeight + margin.bottom - 2)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .attr(\"fill\", \"black\");\n  const data = yearDates(year)\n    .map((d) =&gt; [d, dayLength(d, latitude)])\n    .filter(([_, d]) =&gt; d &gt; 0);\n  /* Render separate polygons for each continuous sequence of\n   * days with more than 0 hours of day light\n   */\n  const polys = [];\n  let currentPoly = [];\n  for (let i = 0; i &lt; data.length; i++) {\n    const currentDate = data[i][0];\n    const prevDate = (data[i - 1] || [])[0];\n    if (\n      i === 0 ||\n      currentDate.getTime() - prevDate.getTime() &lt; 3600 * 24 * 1000 * 1.5\n    ) {\n      currentPoly.push(data[i]);\n    } else {\n      polys.push(currentPoly);\n      currentPoly = [data[i]];\n    }\n  }\n  polys.push(currentPoly);\n  polys.forEach((p) =&gt; {\n    const points = [\n      ...p.map(([d, l]) =&gt; `${xScale(12 - l / 2)},${yScale(d)}`),\n      ...p.reverse().map(([d, l]) =&gt; `${xScale(12 + l / 2)},${yScale(d)}`)\n    ].join(\" \");\n    root.append(\"polygon\").attr(\"points\", points).attr(\"fill\", colors.day);\n  });\n  /* Legend */\n  const legend = root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left + chartWidth / 2 - 64})`);\n  legend\n    .append(\"rect\")\n    .attr(\"rx\", 5)\n    .attr(\"x\", -25)\n    .attr(\"y\", 6)\n    .attr(\"width\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"height\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"fill\", colors.night);\n  legend\n    .append(\"text\")\n    .attr(\"x\", -8)\n    .attr(\"y\", 19)\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .text(\"Nighttime\");\n  legend\n    .append(\"rect\")\n    .attr(\"x\", 58)\n    .attr(\"rx\", 5)\n    .attr(\"y\", 6)\n    .attr(\"width\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"height\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"fill\", colors.day);\n  legend\n    .append(\"text\")\n    .attr(\"x\", 75)\n    .attr(\"y\", 19)\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .text(\"Daytime\");\n  /* Time and date controls */\n  const dateLine = root.append(\"g\");\n  const updateControlPositions = () =&gt; {\n    dateLine\n      .select(\"line\")\n      .attr(\"x1\", xScale(0))\n      .attr(\"y1\", yScale(date))\n      .attr(\"x2\", xScale(24))\n      .attr(\"y2\", yScale(date));\n    dateLine\n      .select(\"rect\")\n      .attr(\"x\", xScale(0))\n      .attr(\"y\", yScale(date) - 4);\n    root\n      .select(\"#time-control\")\n      .attr(\"cx\", xScale(hour))\n      .attr(\"cy\", yScale(date));\n  };\n  const dispatchDateHourChange = () =&gt; {\n    const detail = { date, hour };\n    const changeEvent = new CustomEvent(EventType.DateHourChange, {\n      detail,\n      bubbles: true\n    });\n    root.node().dispatchEvent(changeEvent);\n  };\n  const handleDateLineDrag = ({ y }) =&gt; {\n    date = yScale.invert(y);\n    updateControlPositions();\n    dispatchDateHourChange();\n  };\n  const handleTimeCircleDrag = ({ x }) =&gt; {\n    hour = xScale.invert(x);\n    updateControlPositions();\n    dispatchDateHourChange();\n  };\n  dateLine.append(\"line\").attr(\"stroke-width\", 4).attr(\"stroke\", \"red\");\n  dateLine\n    .append(\"rect\")\n    .attr(\"width\", chartWidth)\n    .attr(\"height\", 8)\n    .attr(\"fill\", \"rgba(0, 0, 0, 0)\")\n    .style(\"cursor\", \"row-resize\")\n    .call(d3.drag().on(\"drag\", handleDateLineDrag));\n  root\n    .append(\"circle\")\n    .attr(\"id\", \"time-control\")\n    .attr(\"r\", 12)\n    .attr(\"fill\", \"red\")\n    .attr(\"stroke-width\", .6)\n    .attr(\"stroke\", \"black\")\n    .style(\"cursor\", \"pointer\")\n    .call(d3.drag().on(\"drag\", handleTimeCircleDrag));\n  updateControlPositions();\n}\nfontSize = 12;\ngetSolarAngle = (date) =&gt; (dayOfYear(date) + 10) / 365 * Math.PI * 2 - Math.PI / 2;\n/*\n * Formulas uses the CBM model as reviewed here:\n * https://www.ikhebeenvraag.be/mediastorage/FSDocument/171/Forsythe+-+A+model+comparison+for+daylength+as+a+function+of+latitude+and+day+of+year+-+1995.pdf\n */\ndayLength = (date, latitude) =&gt; {\n  const yearStart = new Date(date.getFullYear(), 0, 1);\n  const dayOfYear = Math.floor((date.getTime() - yearStart.getTime())/86400000) + 1;\n  const revAngle = 0.2163108 + 2 * Math.atan(0.9671396 * Math.tan(0.00860 * (dayOfYear - 186)));\n  const decAngle = Math.asin(0.39795 * Math.cos(revAngle));\n  /* daylight coefficient selected for apparent sunrise/sunset */\n  const p = 0.8333\n  const intResult =\n    (Math.sin((p * Math.PI) / 180) +\n      Math.sin((latitude * Math.PI) / 180) * Math.sin(decAngle)) /\n    (Math.cos((latitude * Math.PI) / 180) * Math.cos(decAngle));\n  if (intResult &gt;= 1) return 24;\n  if (intResult &lt;= -1) return 0;\n  return 24 - 24 * Math.acos(intResult) / Math.PI;\n}\nyearDates = (year) =&gt; {\n  const startDate = new Date(year, 0, 1+60);\n  const endDate = new Date(year + 1, 0, 1+60);\n  return d3.timeDay.range(startDate, endDate);\n}\nheight = 0.65 * width;\nEventType = ({\n  LocationChange: \"LOCATION_CHANGE\",\n  DateHourChange: \"DATE_HOUR_CHANGE\"\n})\ncolors = ({\n  night: \"#719fb6\",\n  day: \"#ffe438\",\n  grid: \"#4b6a79\",\n  ocean: \"#adeeff\",\n  land: \"#f5f1dc\",\n  sun: \"#ffe438\"\n})\ntoRadians = (val) =&gt; val * Math.PI / 180\ntoDegrees = (val) =&gt; val * 180 / Math.PI;\nland = topojson.feature(world, world.objects.land);\nd3 = require(\"d3@7\", \"d3-geo-projection@3\")\nfunction input(config) {\n  let {\n    form,\n    type = \"text\",\n    attributes = {},\n    action,\n    getValue,\n    title,\n    description,\n    format,\n    display,\n    submit,\n    options\n  } = config;\n  const wrapper = html`&lt;div&gt;&lt;/div&gt;`;\n  if (!form)\n    form = html`&lt;form&gt;\n    &lt;input name=input type=${type} /&gt;\n  &lt;/form&gt;`;\n  Object.keys(attributes).forEach(key =&gt; {\n    const val = attributes[key];\n    if (val != null) form.input.setAttribute(key, val);\n  });\n  if (submit)\n    form.append(\n      html`&lt;input name=submit type=submit style=\"margin: 0 0.75em\" value=\"${\n        typeof submit == \"string\" ? submit : \"Submit\"\n      }\" /&gt;`\n    );\n  form.append(\n    html`&lt;output name=output style=\"font: 14px Menlo, Consolas, monospace; margin-left: 0.1em; text-align:center;\"&gt;&lt;/output&gt;`\n  );\n  if (title)\n    form.prepend(\n      html`&lt;div style=\"font: 700 0.9rem sans-serif; margin-bottom: 3px;\"&gt;${title}&lt;/div&gt;`\n    );\n  if (description)\n    form.append(\n      html`&lt;div style=\"font-size: 0.85rem; font-style: italic; margin-top: 3px;\"&gt;${description}&lt;/div&gt;`\n    );\n  if (format)\n    format = typeof format === \"function\" ? format : d3format.format(format);\n  if (action) {\n    action(form);\n  } else {\n    const verb = submit\n      ? \"onsubmit\"\n      : type == \"button\"\n      ? \"onclick\"\n      : type == \"checkbox\" || type == \"radio\"\n      ? \"onchange\"\n      : \"oninput\";\n    form[verb] = e =&gt; {\n      e && e.preventDefault();\n      const value = getValue ? getValue(form.input) : form.input.value;\n      if (form.output) {\n        const out = display ? display(value) : format ? format(value) : value;\n        if (out instanceof window.Element) {\n          while (form.output.hasChildNodes()) {\n            form.output.removeChild(form.output.lastChild);\n          }\n          form.output.append(out);\n        } else {\n          form.output.value = out;\n        }\n      }\n      form.value = value;\n      if (verb !== \"oninput\")\n        form.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n    };\n    if (verb !== \"oninput\")\n      wrapper.oninput = e =&gt; e && e.stopPropagation() && e.preventDefault();\n    if (verb !== \"onsubmit\") form.onsubmit = e =&gt; e && e.preventDefault();\n    form[verb]();\n  }\n  while (form.childNodes.length) {\n    wrapper.appendChild(form.childNodes[0]);\n  }\n  form.append(wrapper);\n  return form;\n}\nd3format = require(\"d3-format@1\")\n// https://observablehq.com/@enjalot/draggable-world-map-coordinates-input\nfunction worldMapCoordinates(config = {}, dimensions) {\n  const {\n    value = [], title, description, width = dimensions[0]\n  } = Array.isArray(config) ? {value: config} : config;\n  const height = dimensions[1];\n  let [lon, lat] = value;\n  lon = lon != null ? lon : null;\n  lat = lat != null ? lat : null;\n  const formEl = html`&lt;form style=\"width: ${width}px;\"&gt;&lt;/form&gt;`;\n  const context = DOM.context2d(width, height-width/13.2);\n  const canvas = context.canvas;\n  canvas.style.margin = `-10px 0px -26px 0px`;\n  const projection = d3\n    .geoEquirectangular()\n    .precision(0.1)\n    .fitSize([width, height], { type: \"Sphere\" }).rotate([-153, 0]);\n  const path = d3.geoPath(projection, context).pointRadius(2.5);\n  formEl.append(canvas);\n  function draw() {\n    context.fillStyle = \"#fff\";\n    context.fillRect(0, 0, width, height);\n    context.beginPath(); path({type: \"Sphere\"});\n    context.fillStyle = colors.ocean; context.fill();\n    context.beginPath();\n    path(graticule);\n    context.lineWidth = 0.95;\n    context.strokeStyle = `#aaa`;\n    context.stroke();\n    context.beginPath();\n    path(land);\n    context.fillStyle = colors.land;\n    context.fill();\n    context.beginPath();\n    path(countries);\n    context.lineWidth = .95;\n    context.strokeStyle = `#000`;\n    context.stroke();\n    context.fillStyle = `#000`;\n    context.font = width &lt; 760 ? \"14px serif\" : width &lt; 990 ? \"17px serif\" : \"23px serif\";\n    d3.range(-1.5, 342 + 1, 36).map(x =&gt;  context.fillText(long2zone(x), ...projection([x, 84 - (width &lt; 400) * 3.6])));\n    d3.range(-1.5, 342 + 1, 36).map(x =&gt;  context.fillText(long2zone(x), ...projection([x, -66])));\n    context.beginPath(), path(night), context.fillStyle = \"rgba(0,0,255,0.1)\", context.fill();\n    context.beginPath(); path.pointRadius(17); path({type: \"Point\", coordinates: sun}); context.strokeStyle = \"#0008\"; context.fillStyle = \"#ff08\"; context.lineWidth = 1; context.stroke(); context.fill();\n    if (lon != null && lat != null) {\n      path.pointRadius(17); context.strokeStyle = \"black\";\n      context.beginPath(); path({type: \"Point\", coordinates: [lon, lat]}); context.lineWidth = 1; context.stroke();\n      context.lineWidth = 6;\n      path.pointRadius(14); context.strokeStyle = \"red\";\n      context.beginPath(); path({type: \"Point\", coordinates: [lon, lat]}); context.stroke();\n    }\n  }\n  let drag = d3.drag()\n    .on(\"drag\", (event) =&gt; {\n      let coords = projection.invert([event.x, event.y]);\n      lon = +coords[0].toFixed(2);\n      lat = +coords[1].toFixed(2);\n      draw();\n      canvas.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n    })\n  d3.select(canvas).call(drag)\n  canvas.onclick = function(ev) {\n    const { offsetX, offsetY } = ev;\n    let coords = projection.invert([offsetX, offsetY]);\n    lon = +coords[0].toFixed(2);\n    lat = +coords[1].toFixed(2);\n    draw();\n    canvas.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n  };\n  draw();\n  const form = input({\n    type: \"worldMapCoordinates\",\n    title,\n    description,\n    display: v =&gt; (width &gt; 400) ? html`&lt;div style=\"width: ${width}px; white-space: nowrap; color: #444; text-align: center; font: ${width / 50}px monospace; position: relative; top: -${width / 36}px;  margin-bottom: -.4em;\"&gt;\n            &lt;span style=\"color: #000;\"&gt;Zone:&lt;/span&gt; ${lon != null ? long2zone(lon) : \"\"}\n            &nbsp; &nbsp;\n            &lt;span style=\"color: #000;\"&gt;Longitude:&lt;/span&gt; ${lon != null ? (long2turn(lon)).toFixed(0) : \"\"}\n            &nbsp; &nbsp;\n            &lt;span style=\"color: #000;\"&gt;Latitude:&lt;/span&gt; ${lat != null ? ((lati2turn1(lat))).toFixed(0) : \"\"}\n          &lt;/div&gt;` : '',\n    getValue: () =&gt; [lon != null ? lon : null, lat != null ? lat : null],\n    form: formEl\n  });\n  return form;\n}\nsun = {\n  const now = new Date;\n  const day = new Date(+now).setUTCHours(0, 0, 0, 0);\n  const t = solar.century(now);\n  const longitude = (day - now) / 864e5 * 360 - 180;\n  return [longitude - solar.equationOfTime(t) / 4, solar.declination(t)];\n}\nnight = d3.geoCircle()\n    .radius(90)\n    .center(antipode(sun))\n  ()\nantipode = ([longitude, latitude]) =&gt; [longitude + 180, -latitude]\nsolar = require(\"solar-calculator@0.3/dist/solar-calculator.min.js\")\nviewof fancySecondsOFF = Inputs.toggle({\n  label: \"Ticking clock\",\n  value: true,\n})\nfunction setStyle(content, style = {}) {\n  function yiq(color) {\n    const {r, g, b} = d3.rgb(color);\n    return (r * 299 + g * 587 + b * 114) / 1000 / 255; // returns values between 0 and 1\n  }\n  const {\n    background,\n    color = yiq(background) &gt;= 0.6 ? \"#111\" : \"white\",\n    padding = \"0 1px\",\n    borderRadius = \"4px\",\n    fontWeight = 900,\n    fontSize = \"1em\",\n    ...rest\n  } = typeof style === \"string\" ? {background: style} : style;\n  return htl.html`&lt;span style=${{\n    background,\n    color,\n    padding,\n    borderRadius,\n    fontWeight,\n    ...rest\n  }}&gt;${content}&lt;/span&gt;`;\n}\nstyledZone = setStyle(selectedZone, d3.color(\"chartreuse\").formatHex())\nstyledTime = setStyle(`+${decTime}`, d3.color(\"cyan\").formatHex())\nstyledTimeN = setStyle(`-${decTimeN}`, d3.color(\"pink\").formatHex())\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topReuseCC BY-SA 4.0CitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {Dec {Time}},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/dec/time},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúDec Time.‚Äù 2024. https://maptv.github.io/dec/time.",
    "crumbs": [
      "Dec",
      "Time"
    ]
  },
  {
    "objectID": "quarto/include/index.html",
    "href": "quarto/include/index.html",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto",
      "Include"
    ]
  },
  {
    "objectID": "quarto/include/index.html#tldr",
    "href": "quarto/include/index.html#tldr",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto",
      "Include"
    ]
  },
  {
    "objectID": "quarto/include/index.html#sec-intro",
    "href": "quarto/include/index.html#sec-intro",
    "title": "Quarto",
    "section": "Introduction",
    "text": "Introduction\nQuarto is an open-source software system for turning plain-text source files into outputs like articles, books, blogs, dashboards, presentations, reports, and websites. Announced on 2022+149 by Posit CEO JJ Allaire, Quarto is already taking the worldüåêby storm‚õàÔ∏è!\nI strongly believe that everyone, regardless of their background and current technical skill level, can learn and benefit from Quarto. Getting started with Quarto is easy thanks to its excellent documentation and vibrant community of enthusiastic users and developers.\nRather than repeat the basic information already available elsewhere, I will share some advanced techniques along with the fundamental knowledge needed to understand how they work. The topics I cover are very technical, but my goal is to make the content on my blog as accessible as possible.\nThe first topic I will delve into is creating and publishing a website with Quarto. To follow the Quarto documentation on creating a website, you will need Visual Studio Code (VSCode), VSCodium, RStudio, or a terminal.",
    "crumbs": [
      "Software",
      "Quarto",
      "Include"
    ]
  },
  {
    "objectID": "quarto/include/index.html#sec-pub",
    "href": "quarto/include/index.html#sec-pub",
    "title": "Quarto",
    "section": "Publishing Quarto sites",
    "text": "Publishing Quarto sites\n\nInstalling tools\nIf you use macOS, Linux, or the Windows Subsystem for Linux (WSL), you can install all of the aforementioned tools with the Homebrew package manager. To install everything you will need to follow along with this blog post, you can first install Homebrew and then run brew bundle in a directory that contains the Brewfile shown in Example¬†1.\n\nExample 1 ¬†\n\n\nBrewfile\n\nbrew \"gh\"\nbrew \"git\"\nbrew \"glab\"\ncask \"github\"\ncask \"quarto\"\ncask \"rstudio\"\ncask \"vscodium\"\ncask \"visual-studio-code\"\nvscode \"quarto.quarto\"\nvscode \"REditorSupport.r\"\n\n\nUsing a package manager like Homebrew to install all the requirements with a single shell command like brew bundle is the fastest and easiest way to get ready to follow along with this blog post. If you are curious about how I set up my computer, you can take a look at my Brewfile and other configuration files in my setup repository (repo) on GitHub and GitLab.\nApart from RStudio, VSCode, and VSCodium, the Brewfile in Example¬†1 will install the Git version control system, the GitHub and GitLab command line interfaces (CLIs), and GitHub Desktop, a Git Graphical User Interface (GUI). For more information on Git, a tool used by 93% of software developers worldwide according to survey results published by StackOverflow on 2022+314, take a look at the ‚ÄúGitHub for supporting, reusing, contributing, and failing safely‚Äù post by Allison Horst and Julie Lowndes on the Openscapes blog.\nAs an alternative to installing tools on your computer, you can use the web interface provided by GitHub Codespaces. To set up a Codespace, you can remove the lines that start with cask from the Brewfile provided in Example¬†1 and add the file to a repo called dotfiles and along with a setup.sh file like the one shown in Example¬†2.\n\nExample 2 ¬†\n\n\nsetup.sh\n\necho | /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n(echo; echo 'eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"') &gt;&gt; /home/codespace/.profile\neval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"\nbrew bundle\n\n\n\n\nPublishing overview\nOnce you are done setting up your computer or Codespace, you create a Quarto website template and make your site publicly available on the internet using one of the many available publishing services. To explore and assess different publishing workflows and free website hosting options, I set up my personal website on four different web hosts: Quarto Pub, Netlify, GitHub Pages, and GitLab Pages.\nThere are so many different ways to publish a Quarto site that I decided to come up with a naming system for Quarto publishing methods. The naming system derives a code for each publishing method from the numbered lists in the Quarto publishing documentation. For example, I refer to the two methods to publish to Quarto Pub as Q1 and Q2:\nTable¬†1 uses this naming system in its Code column to identify the publishing methods I discuss in this blog post. Each publishing method targets a particular web Host, Renders content locally or on a remote server, and deploys sites using either the quarto publish or the git push shell Command.\n\n\n\n\n\n\nCode\nHost\nRender\nCommand\n\n\n\n\nG1\nGitHub\nLocal\npush\n\n\nG2\nGitHub\nLocal\npublish\n\n\nG3\nGitHub\nRemote\npush\n\n\nN1\nNetlify\nLocal\npublish\n\n\nN2\nNetlify\nLocal\npush\n\n\nN3\nNetlify\nRemote\npush\n\n\nQ1\nQuarto\nLocal\npublish\n\n\nQ2\nQuarto\nRemote\npush\n\n\n\n\n\nTable¬†1: Quarto website publishing methods\n\n\n\n\n\nGit workflow\nThe first publishing method I tried for my personal site was G1, which requires the use of Git to push all website content to a Git provider like GitHub or GitLab. After I set up GitHub Pages and GitLab Pages, I could update my website on both of these web hosts just by going through the standard Git workflow shown in Figure¬†2.\n\n\n\n\n\n\nflowchart LR\n   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)\n\n\n\n\nFigure¬†2: Git workflow\n\n\n\n\n\nTo make it easier to make incremental changes to my website and frequently release new content, I combined all of the git shell commands in Figure¬†2 into a shell alias. You can add shell aliases to a shell configuration file like .bashrc or .zshrc on your computer to shorten commands or combine any sequence of commands into one step.\nThe aacmp alias in the .zshrc file in my setup repo allows me to enter a free-form commit message directly on the command line without quotes, e.g.¬†qp edit first blog. If you decide to try my aacmp alias, please exercise extreme caution as any un-escaped or un-quoted metacharacters may yield surprising effects instead of being included verbatim in the commit message. For example, qp * will list the contents of the current directory in the commit message in place of the asterisk!\nAn alternative to a shell alias that combines git commands is a keyboard shortcut in Git-enabled GUI. Example¬†3 shows two files, tasks.json and update.sh, that we can use to set up VSCode, VSCodium, and GitHub Codespaces to go through the Git workflow whenever we press Ctrl+Shift+B on Linux/Windows or ‚åò+Shift+B on Mac (mnemonic: B is for Build).\n\nExample 3 ¬†\n\nupdate.shtasks.json\n\n\n\n\n\n\n\n\n\n\nThis mechanism is called Tasks and is used to automate software build tasks, which can include any steps required to build and publish a website. Importantly, the Tasks mechanism requires that the tasks.json file be added to the .vscode directory and that we enable execution of the update.sh script by running chmod +x update.sh in our project root.\nShell aliases and keyboard shortcuts can greatly facilitate the Git workflow which is essential not only for G1, but also G3, N3, and Q2. Unlike these other publishing methods, G1 leads to messy commits that contain changes to both source and output files.\n\n\nquarto publish\nTo have cleaner commits, I switched from G1 to G2 by adding quarto publish to my publishing workflow. With G2, I can track changes to my source files on my main branch and publish my output files to GitHub Pages and GitLab Pages from my gh-pages branch.\nQ1, N1, and G2 all use quarto publish to render website content locally and then deploy it in one fell swoop. If you do not plan to use the Git version control system or the advanced features offered by GitHub, GitLab, or Netlify, then I recommend deploying your site to Quarto Pub by running quarto publish quarto-pub (Q1 in Table¬†1).\nLike Q1, N1 is a deployment method that does not require Git and makes it possible to deploy our site with a single shell command: quarto publish netlify. N1 provides access to the advanced web hosting features offered by Netlify and can even render content as long as code execution is frozen.\nTo deploy my site to GitHub Pages, GitLab Pages, and Netlify, I combined G2 and N2. When I run quarto publish gh-pages, Quarto renders my site into my output directory, copies the output directory contents to the gh-pages branch of my local repo, and then commits and pushes the changes to my remote repos on GitHub and GitLab, which triggers Netlify to build my site from the gh-pages branch.\nTo summarize the Quarto publishing methods I discussed so far, Q1 and N1 are easy to configure and use, N2 automatically builds sites from Git repos, G1 is not recommended because it pollutes commits with output file changes, and G2 is more difficult to set up and use but provides clean commits and a nice separation of source and output files.\n\n\nGitHub Actions\nAll of the publishing methods I have discussed so far require us to generate output files locally by rendering our source files. In contrast, Q2, G3, and N3 make it possible to skip local rendering in favor of relying on GitHub Actions to handle all of the necessary steps.\nG3 is noteworthy, because it offers the same convenience of G1 but without messy commits that mix changes to source and output files. An added bonus of G3 is that rendering with GitHub Actions provides a reproducible computational environment that is not dependent on what you have installed on your computer.\nInstead of using GitHub Actions, I could have used GitLab CI/CD to build my site. I decided not to go down this route because the Quarto dev team has many GitHub Actions workflows available but currently no official support for GitLab CI/CD.\nBefore trying to use GitHub Actions or any other continuous integration systems in your publishing workflow, I suggest getting used to working with quarto publish (Q1, G2, or N1). You can always set up other publishing methods later without sacrificing anything, because all of the publishing methods except G1 can be combined together.\nIn Section¬†4, I will walk through the setup of both G2 and G3 to provide the option of rendering locally by running quarto publish or rendering remotely with GitHub Actions by pushing to the main branch. Along the way, I will share many practical tips and general advice that you can apply to any project.",
    "crumbs": [
      "Software",
      "Quarto",
      "Include"
    ]
  },
  {
    "objectID": "quarto/include/index.html#sec-set",
    "href": "quarto/include/index.html#sec-set",
    "title": "Quarto",
    "section": "Publishing setup",
    "text": "Publishing setup\n\nRepo setup\nBefore you can use GitHub Actions to publish your site, you will need a GitHub, an SSH key, and a repo like maptv.github.io that has a default branch called main and another branch which must be called gh-pages. If you want to publish on GitLab Pages, you will also need a GitLab account and an analogous GitLab repo like maptv.gitlab.io.\nYou can create the repo and the gh-pages branch using the web interface of https://github.com or https://gitlab.com in your browser, but the best way to start a new project is using the CLI for GitHub or GitLab in your terminal. First, run gh auth login or glab auth login and follow the prompts to authenticate via your web browser or with an authentication token.\nThe GitHub CLI allows you to add an SSH key to your account during or after authentication. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for adding an SSH key to your GitLab account.\nAfter authentication and SSH key setup, you can run the code in either of the code chunks in Example¬†4 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my .zshrc.\n\nExample 4 ¬†\n\nGitHubGitLab\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\ngh repo create USERNAME.github.io --add-readme --clone --public\ncd SITENAME\nquarto create project website USERNAME.github.io\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\nglab repo create USERNAME.gitlab.io --readme --defaultBranch main --public\ncd SITENAME\ngit pull origin main\ngit branch --set-upstream-to=origin/main main\nquarto create project website USERNAME.gitlab.io\n\n\n\n\nTo make it easier to maintain my site on both GitHub and GitLab Pages, I set up my local repo cloned to have two origin remote URLs using the code as shown in Example¬†5. Now, running quarto publish or git push in my local repo, updates my content on both GitHub and GitLab.\n\nExample 5 ¬†\ngit remote add lab git@gitlab.com:maptv/maptv.gitlab.io\ngit remote add hub git@github.com:maptv/maptv.github.io\ngit remote set-url --add origin $(git remote get-url lab)\n\nIf you want to have your website hosted on GitHub Pages, you will need to set gh-pages as your source branch in your repo settings. For GitLab Pages, you will need to add a .gitlab-ci.yml file to your repo and update your _quarto.yml file as shown in Example¬†6 to include .gitlab-ci.yml as a resource in your output directory.\n\nExample 6 ¬†\n\n.gitlab-ci.yml_quarto.yml\n\n\n# https://docs.gitlab.com/ee/user/project/pages/introduction.html#customize-the-default-folder\npages:\n  script: echo \"The site will be deployed to $CI_PAGES_URL\"\n  artifacts:\n    paths:\n      - \".\"\n  publish: \".\"\n  only:\n    - gh-pages\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\n\n\n\n\nBy default, GitLab Pages includes a random hash in site URLs. To shorten the URL of my GitLab Pages site to &lt;maptv.gitlab.io&gt;, I had to uncheck Use unique domain under Deploy &gt; Pages in the GitLab sidebar.\nAt this point, we have completed G2 setup and you should be able to run quarto publish gh-pages from your main branch to render your site and deploy it to GitHub and/or GitLab Pages. Deploying with quarto publish at least once is a prerequisite for setting up any of the publishing methods that rely on GitHub Actions, because quarto publish creates a _publish.yml file in the root of your project that is required for publishing via GitHub Actions.\n\n\nGitHub Actions\nIn addition to the steps described above, G3 setup requires that we create a .github/workflows directory and add a YAML file to that directory. Example¬†7 contains the gh-pages.yml file I use for my own site and the shell code that can used to obtain this file.\n\nExample 7 ¬†\n\ncurlgh-pages.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_dispatch:\n  push:\n    branches: [main]\n\nname: Quarto Publish\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out repository\n        uses: actions/checkout@v4\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n        with:\n          version: '1.4.489'\n          tinytex: true\n\n      - name: Install R\n        uses: r-lib/actions/setup-r@v2\n        with:\n          r-version: '4.2.0'\n\n      - name: Install R Dependencies\n        uses: r-lib/actions/setup-renv@v2\n        with:\n          cache-version: 1\n\n      - name: Install Python and Dependencies\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n          cache: 'pip'\n      - run: pip install jupyter\n      - run: pip install -r requirements.txt\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: Push To GitLab\n        env:\n          token: ${{ secrets.GITLAB_AUTH_TOKEN }}\n        run: |\n          echo Starting to push gh-pages branch to GitLab\n          git config user.name \"maptv\"\n          git config user.email \"129316885+maptv@users.noreply.github.com\"\n          git remote set-url origin \"https://oauth2:${token}@gitlab.com/maptv/maptv.gitlab.io\"\n          git push origin gh-pages\n\n\n\n\nThe gh-pages.yml file in Example¬†7 installs Quarto, the R and Python programming languages, and the packages in the renv.lock and requirements.txt files. If you do not need R and/or Python, you can remove any unnecessary portions of the file.\nTo modify the Python files that are installed by GitHub Actions, you can edit the requirements.txt file in your repo. To update your renv.lock file so that it includes all of the R packages your site requires, run renv::snapshot() in an R session or Rscript -e renv::snapshot() in a shell.\nAfter pushing the gh-pages.yml file, you can visit the Actions tab in your remote repo on GitHub to check the progress of the deployment of your site. If your site did not build successfully, you can go through the logs to try to diagnose the problem.\nI added a ‚ÄúPush to GitLab‚Äù step to my gh-pages.yml to make GitHub Actions push my remote gh-pages to GitLab so that my site is kept in sync on both GitHub and GitLab Pages. This required manually creating a token on GitLab and adding it to GitHub, which I accomplished using the GitHub CLI as shown in Example¬†8.\n\nExample 8 ¬†\ngh secret set GITLAB_AUTH_TOKEN\n\nAfter the setup described above, I now have two options for publishing my Quarto site: quarto publish and 2) git push. In addition to GitHub and GitLab Pages, both of these options automatically update my site on Netlify via N2.\nTo also automatically update my site on Quarto Pub, I created a separate GitHub Actions workflow by adding another YAML file to the .github/workflows directory in my repo. Example¬†9 shows my quarto-pub.yml file and the shell code that can be used to obtain it.\n\nExample 9 ¬†\n\ncurlquarto-pub.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_run:\n    workflows: [pages-build-deployment]\n    types: [completed]\n\nname: Update Quarto Pub\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Check out main repository\n        uses: actions/checkout@v4\n\n      - name: Check out _site\n        uses: actions/checkout@v4\n        with:\n          ref: gh-pages\n          path: _site\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: quarto-pub\n          render: false\n          QUARTO_PUB_AUTH_TOKEN: ${{ secrets.QUARTO_PUB_AUTH_TOKEN }}\n          GITHUB_USERNAME: maptv\n\n\n\n\nMy quarto-pub.yml file is based on Q2, but it runs upon completion of the pages-build-deployment workflow instead of a push to main. I changed the workflow trigger so that it runs after my GitHub Pages site is built, regardless of whether I triggered the build by running quarto publish gh-pages or pushing to main.\nFigure¬†3 summarizes all of the steps that occur during my Quarto publishing workflow. This workflow allows me to publish my site on four web hosts every time I run quarto publish gh-pages (G2) or git push (G3)!\n\n\n\n\n\n\nflowchart LR\n    A[local&lt;br/&gt;main]-.G2.-&gt;B[local&lt;br/&gt;gh-pages]-.G2.-&gt;C[GitHub&lt;br/&gt;gh-pages]\n    B[local&lt;br/&gt;gh-pages]-.G2.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;F[GitHub&lt;br/&gt;main]-.G3.-&gt;C[GitHub&lt;br/&gt;gh-pages]-.G3.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;G[GitLab&lt;br/&gt;main]\n    C[GitHub&lt;br/&gt;gh-pages]-.N2.-&gt;E[Netlify]\n    C[GitHub&lt;br/&gt;gh-pages]-.Q2.-&gt;H[Quarto&lt;br/&gt;Pub]\n\n\n\n\nFigure¬†3: Quarto publishing workflow\n\n\n\n\n\nSo far I have only noticed one difference between the four web hosts I use for my site: GitHub Pages is the only web host that properly differentiates between internal and external links. All of the other web hosts include the external link icon on all links regardless of whether they target my site or an external site.\nI tried unsuccessfully to solve this issue by setting the link-external-filter property to a regular expression. If you notice a problem with the link-external-icon feature on other web hosts, I suggest switching to GitHub Pages.",
    "crumbs": [
      "Software",
      "Quarto",
      "Include"
    ]
  },
  {
    "objectID": "quarto/include/index.html#sec-cust",
    "href": "quarto/include/index.html#sec-cust",
    "title": "Quarto",
    "section": "Customizing Quarto sites",
    "text": "Customizing Quarto sites\n\nSite navigation\nOnce your site is built and published, you can make it easier to navigate with a customized navigation bar (navbar) and sidebar, as described in the Quarto documentation. Check out the _quarto.yml files for my site and the Quarto documentation site to see how the navigation components are set up.\nIn my navbar, I added toggle buttons for reader mode and dark mode. The names of the other icons on right side of the navbar are included in the sidebar.\n\n\nHTML blocks\nMy navbar also provides the current date and time in Dec ordinal (deco) format, which counts the years since 1 BC and the days since March 1. Dec is a calendar and time system that I created and use throughout my blog.\nTo add a custom timestamp to the navbar, I put a &lt;script&gt; element that runs time.js in an HTML block in every Quarto markdown (.qmd) file, as shown in Example¬†10. Mine √áetinkaya-Rundel wrote about HTML blocks as part of her A Quarto tip a day project.\n\nExample 10 ¬†\n\n*.qmdtime.js\n\n\n```{=html}\n&lt;script src=\"time.js\"&gt;&lt;/script&gt;\n```\n\n\n\n\n\n\n\nHTML blocks are useful for running JavaScript code in the context of a single page on your site without affecting the others. I also use HTML blocks to add a &lt;style&gt; element to my .qmd files as a last ditch effort to fine tune the style of my site.\nBefore I resort to the &lt;style&gt; element approach, I try writing CSS in my style.css, light.css, and dark.css files. So far, this approach has been sufficient to make any styling changes I want, but if it every fails, I can use JavaScript to override the default styling provided by Quarto by modifying style attributes, which have the highest specificity in CSS.\n\n\nPost-render script\nI wanted to my blog‚Äôs listing page to show dates in the same format as the navbar timestamp. To accomplish this, I used a post-render script written in the Python programming language.\nPre- and post-render scripts are set as project options in the _quarto.yml file in the root of your Quarto project. Example¬†11 shows the date.py post-render script and how this script is referenced in _quarto.yml.\n\nExample 11 ¬†\n\n_quarto.ymldate.py\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\ndate-format: x\n\n\n# https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nimport bs4\n\ndef unix2doty(ms):\n    dote = ms / 86400000 + 719468\n    cykl = (\n        dote if dote &gt;= 0\n        else dote - 146096\n    ) // 146097\n    dotc = dote - cykl * 146097\n    yotc = (dotc\n        - dotc // 1460\n        + dotc // 36524\n        - dotc // 146096\n    ) // 365\n    return [\n        int(yotc + cykl * 400),\n        dotc - (yotc * 365\n            + yotc // 4\n            - yotc // 100\n        )\n    ]\n\nwith open(\"_site/list/index.html\") as infile:\n    txt = infile.read()\n    soup = bs4.BeautifulSoup(txt, features=\"html.parser\")\nfor div in soup.find_all(\"div\", {\"class\": \"card-file-modified\"}):\n    elem = div.find(\"p\")\n    if \"+\" not in elem.text:\n        y, d = unix2doty(int(div.text))\n        elem.string.replace_with(f\"{y:&gt;04}+{d.__floor__():&gt;03}\")\nfor div in soup.find_all(\"div\", {\"class\": \"listing-reading-time\"}):\n    if \"min\" in div.text:\n        div.string.replace_with(f\"{(int(div.text.split()[0]) / 1.44).__floor__()} milliday\")\nwith open(\"_site/list/index.html\", \"w\") as outfile:\n    outfile.write(str(soup))\n\n\n\n\nNormally, formatting dates in Quarto is as easy as setting the date-format YAML property. In my case it was more difficult, because I wanted dates based on Dec, the calendar and time system I created, instead of the ubiquitous Gregorian calendar.\nTo facilitate the calculations in date.py, I set date-format to x in my _metadata.yml file so all of the dates would be in millisecond UNIX time and I would not have to deal with Gregorian calendar date formats or time zones. After all of the dates are generated, my date.py script traverses the HTML in the output directory using Beautiful Soup and converts millisecond UNIX time dates into Dec dates (year+day).\n\n\nPandoc filter\nIn addition to customizing dates on the listing page of my blog, I wanted to customize the date format in every blog post. To complete this task, I used a Lua script as a Pandoc filter.\nPandoc is a program that converts documents into practically any format. The ‚Äúpan‚Äù in Pandoc comes from the Ancient Greek word for all. Pandoc strives to convert all document formats, just like Pangea contained all the land and a panacea solves all problems.\nQuarto uses Pandoc to convert markdown files into target format(s) like html or pdf. If the source files contain executable code, Quarto executes the code via one of two computational engines: Jupyter or Knitr. Figure¬†4 shows the Quarto workflow.\n\n\n\n\n\n\nflowchart LR\n   A[qmd&lt;br/&gt;ipynb]-.Knitr&lt;br/&gt;Jupyter.-&gt;B((md))-.Pandoc with&lt;br/&gt;Lua filters.-&gt;C(html&lt;br/&gt;pdf&lt;br/&gt;docx&lt;br/&gt;etc.)\n\n\n\n\nFigure¬†4: Quarto rendering workflow\n\n\n\n\n\nMine √áetinkaya-Rundel‚Äôs Quarto tip series includes a similar Quarto workflow mermaid diagram and her ‚ÄúHello, Quarto!‚Äù rstudio::conf(2022) keynote with Julia Stewart Lowndes contains truly beautiful Quarto workflow images by Allison Horst: 1, 2, 3, and 4.\nQuarto controls Pandoc, Jupyter, and Knitr in two ways: 1) with arguments passed to the Quarto CLI commands and 2) with YAML key-value pairs in .qmd, .ipynb, or .yml files.\nExample¬†12 shows how I set up every qmd file to generate the current date in millisecond UNIX time and designated date.lua as a Pandoc filter. Unlike post-render scripts, Pandoc filters are executed during the creation of the output files.\n\nExample 12 ¬†\n\n*.qmddate.lua\n\n\ndate: now\ndate-format: x\nfilters: date.lua\n\n\n-- https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nfunction unix2deco(ms)\n  local dote = ms / 86400000 + 719468\n  local cykl = (\n    dote &gt;= 0 and dote\n    or dote - 146096\n  ) // 146097\n  local dotc = dote - cykl * 146097\n  local yotc = (\n    dotc - dotc // 1460\n    + dotc // 36524\n    - dotc // 146096\n  ) // 365\n  return string.format(\n    \"%s+%s\",\n    math.floor(yotc + cykl * 400),\n    math.floor(dotc - (yotc * 365\n      + yotc // 4\n      - yotc // 100)))\nend\n\nlocal function to_decalendar(date)\n  local date = pandoc.utils.stringify(date)\n  local unix = date:match(\"(%d+)\")\n  return date:gsub(unix, unix2deco(unix))\nend\n\nfunction Meta(m)\n  m.date = to_decalendar(m.date)\n  return m\nend\n\n\n\n\nAll three of the customizations I described above convert millisecond UNIX time into a custom date format, but you can adapt these approaches to make all sorts of edits to your Quarto site. HTML blocks can run JavaScript which excels at making content dynamic and interactive, pre- and post-render scripts can be in any programming language, while Pandoc filters are written in Lua and modify output during rendering.\nComing up next on my blog is a post that Observable graphics. Get ready for an animated and interactive data visualization extravaganza!",
    "crumbs": [
      "Software",
      "Quarto",
      "Include"
    ]
  },
  {
    "objectID": "quarto/script/index.html",
    "href": "quarto/script/index.html",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto",
      "Script"
    ]
  },
  {
    "objectID": "quarto/script/index.html#tldr",
    "href": "quarto/script/index.html#tldr",
    "title": "Quarto",
    "section": "",
    "text": "This blog post is the most important post in my Tools blog post series, as indicated by its centrality in Figure¬†1, node of the netw focuses on the use of Quarto to author and publish digital content. As the third post in my , which is summarized by Figure¬†1, and depends on the. is my blog post on Quarto. The subsequent posts in the series demonstrate how to use Observable, Jupyter, and Knitr to execute code in Quarto documents.\n\n\n\n\n\n\n\nflowchart TB\n   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]\n   C--&gt;D[Observable]\n   C--&gt;E[Jupyter]\n   C--&gt;F[Knitr]\n   click A \"../git\"\n   click B \"../vscode\"\n   click C \"../quarto\"\n   click D \"../observable\"\n   click E \"../jupyter\"\n   click F \"../knitr\"\n   style C stroke:#99f,stroke-width:5px\n\n\n\n\nFigure¬†1: Tools series navigation chart\n\n\n\n\nIf you do not have such a repo, you can create one by following along with the previous post in my tools blog post series, which is shown in Figure¬†1.",
    "crumbs": [
      "Software",
      "Quarto",
      "Script"
    ]
  },
  {
    "objectID": "quarto/script/index.html#sec-intro",
    "href": "quarto/script/index.html#sec-intro",
    "title": "Quarto",
    "section": "Introduction",
    "text": "Introduction\nQuarto is an open-source software system for turning plain-text source files into outputs like articles, books, blogs, dashboards, presentations, reports, and websites. Announced on 2022+149 by Posit CEO JJ Allaire, Quarto is already taking the worldüåêby storm‚õàÔ∏è!\nI strongly believe that everyone, regardless of their background and current technical skill level, can learn and benefit from Quarto. Getting started with Quarto is easy thanks to its excellent documentation and vibrant community of enthusiastic users and developers.\nRather than repeat the basic information already available elsewhere, I will share some advanced techniques along with the fundamental knowledge needed to understand how they work. The topics I cover are very technical, but my goal is to make the content on my blog as accessible as possible.\nThe first topic I will delve into is creating and publishing a website with Quarto. To follow the Quarto documentation on creating a website, you will need Visual Studio Code (VSCode), VSCodium, RStudio, or a terminal.",
    "crumbs": [
      "Software",
      "Quarto",
      "Script"
    ]
  },
  {
    "objectID": "quarto/script/index.html#sec-pub",
    "href": "quarto/script/index.html#sec-pub",
    "title": "Quarto",
    "section": "Publishing Quarto sites",
    "text": "Publishing Quarto sites\n\nInstalling tools\nIf you use macOS, Linux, or the Windows Subsystem for Linux (WSL), you can install all of the aforementioned tools with the Homebrew package manager. To install everything you will need to follow along with this blog post, you can first install Homebrew and then run brew bundle in a directory that contains the Brewfile shown in Example¬†1.\n\nExample 1 ¬†\n\n\nBrewfile\n\nbrew \"gh\"\nbrew \"git\"\nbrew \"glab\"\ncask \"github\"\ncask \"quarto\"\ncask \"rstudio\"\ncask \"vscodium\"\ncask \"visual-studio-code\"\nvscode \"quarto.quarto\"\nvscode \"REditorSupport.r\"\n\n\nUsing a package manager like Homebrew to install all the requirements with a single shell command like brew bundle is the fastest and easiest way to get ready to follow along with this blog post. If you are curious about how I set up my computer, you can take a look at my Brewfile and other configuration files in my setup repository (repo) on GitHub and GitLab.\nApart from RStudio, VSCode, and VSCodium, the Brewfile in Example¬†1 will install the Git version control system, the GitHub and GitLab command line interfaces (CLIs), and GitHub Desktop, a Git Graphical User Interface (GUI). For more information on Git, a tool used by 93% of software developers worldwide according to survey results published by StackOverflow on 2022+314, take a look at the ‚ÄúGitHub for supporting, reusing, contributing, and failing safely‚Äù post by Allison Horst and Julie Lowndes on the Openscapes blog.\nAs an alternative to installing tools on your computer, you can use the web interface provided by GitHub Codespaces. To set up a Codespace, you can remove the lines that start with cask from the Brewfile provided in Example¬†1 and add the file to a repo called dotfiles and along with a setup.sh file like the one shown in Example¬†2.\n\nExample 2 ¬†\n\n\nsetup.sh\n\necho | /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n(echo; echo 'eval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"') &gt;&gt; /home/codespace/.profile\neval \"$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)\"\nbrew bundle\n\n\n\n\nPublishing overview\nOnce you are done setting up your computer or Codespace, you create a Quarto website template and make your site publicly available on the internet using one of the many available publishing services. To explore and assess different publishing workflows and free website hosting options, I set up my personal website on four different web hosts: Quarto Pub, Netlify, GitHub Pages, and GitLab Pages.\nThere are so many different ways to publish a Quarto site that I decided to come up with a naming system for Quarto publishing methods. The naming system derives a code for each publishing method from the numbered lists in the Quarto publishing documentation. For example, I refer to the two methods to publish to Quarto Pub as Q1 and Q2:\nTable¬†1 uses this naming system in its Code column to identify the publishing methods I discuss in this blog post. Each publishing method targets a particular web Host, Renders content locally or on a remote server, and deploys sites using either the quarto publish or the git push shell Command.\n\n\n\n\n\n\nCode\nHost\nRender\nCommand\n\n\n\n\nG1\nGitHub\nLocal\npush\n\n\nG2\nGitHub\nLocal\npublish\n\n\nG3\nGitHub\nRemote\npush\n\n\nN1\nNetlify\nLocal\npublish\n\n\nN2\nNetlify\nLocal\npush\n\n\nN3\nNetlify\nRemote\npush\n\n\nQ1\nQuarto\nLocal\npublish\n\n\nQ2\nQuarto\nRemote\npush\n\n\n\n\n\nTable¬†1: Quarto website publishing methods\n\n\n\n\n\nGit workflow\nThe first publishing method I tried for my personal site was G1, which requires the use of Git to push all website content to a Git provider like GitHub or GitLab. After I set up GitHub Pages and GitLab Pages, I could update my website on both of these web hosts just by going through the standard Git workflow shown in Figure¬†2.\n\n\n\n\n\n\nflowchart LR\n   A[working&lt;br/&gt;directory]-.git&lt;br/&gt;add.-&gt;B{{staging&lt;br/&gt;area}}-.git&lt;br/&gt;commit.-&gt;C([local&lt;br/&gt;repo])-.git&lt;br/&gt;push.-&gt;D(remote&lt;br/&gt;repo)\n\n\n\n\nFigure¬†2: Git workflow\n\n\n\n\n\nTo make it easier to make incremental changes to my website and frequently release new content, I combined all of the git shell commands in Figure¬†2 into a shell alias. You can add shell aliases to a shell configuration file like .bashrc or .zshrc on your computer to shorten commands or combine any sequence of commands into one step.\nThe aacmp alias in the .zshrc file in my setup repo allows me to enter a free-form commit message directly on the command line without quotes, e.g.¬†qp edit first blog. If you decide to try my aacmp alias, please exercise extreme caution as any un-escaped or un-quoted metacharacters may yield surprising effects instead of being included verbatim in the commit message. For example, qp * will list the contents of the current directory in the commit message in place of the asterisk!\nAn alternative to a shell alias that combines git commands is a keyboard shortcut in Git-enabled GUI. Example¬†3 shows two files, tasks.json and update.sh, that we can use to set up VSCode, VSCodium, and GitHub Codespaces to go through the Git workflow whenever we press Ctrl+Shift+B on Linux/Windows or ‚åò+Shift+B on Mac (mnemonic: B is for Build).\n\nExample 3 ¬†\n\nupdate.shtasks.json\n\n\n\n\n\n\n\n\n\n\nThis mechanism is called Tasks and is used to automate software build tasks, which can include any steps required to build and publish a website. Importantly, the Tasks mechanism requires that the tasks.json file be added to the .vscode directory and that we enable execution of the update.sh script by running chmod +x update.sh in our project root.\nShell aliases and keyboard shortcuts can greatly facilitate the Git workflow which is essential not only for G1, but also G3, N3, and Q2. Unlike these other publishing methods, G1 leads to messy commits that contain changes to both source and output files.\n\n\nquarto publish\nTo have cleaner commits, I switched from G1 to G2 by adding quarto publish to my publishing workflow. With G2, I can track changes to my source files on my main branch and publish my output files to GitHub Pages and GitLab Pages from my gh-pages branch.\nQ1, N1, and G2 all use quarto publish to render website content locally and then deploy it in one fell swoop. If you do not plan to use the Git version control system or the advanced features offered by GitHub, GitLab, or Netlify, then I recommend deploying your site to Quarto Pub by running quarto publish quarto-pub (Q1 in Table¬†1).\nLike Q1, N1 is a deployment method that does not require Git and makes it possible to deploy our site with a single shell command: quarto publish netlify. N1 provides access to the advanced web hosting features offered by Netlify and can even render content as long as code execution is frozen.\nTo deploy my site to GitHub Pages, GitLab Pages, and Netlify, I combined G2 and N2. When I run quarto publish gh-pages, Quarto renders my site into my output directory, copies the output directory contents to the gh-pages branch of my local repo, and then commits and pushes the changes to my remote repos on GitHub and GitLab, which triggers Netlify to build my site from the gh-pages branch.\nTo summarize the Quarto publishing methods I discussed so far, Q1 and N1 are easy to configure and use, N2 automatically builds sites from Git repos, G1 is not recommended because it pollutes commits with output file changes, and G2 is more difficult to set up and use but provides clean commits and a nice separation of source and output files.\n\n\nGitHub Actions\nAll of the publishing methods I have discussed so far require us to generate output files locally by rendering our source files. In contrast, Q2, G3, and N3 make it possible to skip local rendering in favor of relying on GitHub Actions to handle all of the necessary steps.\nG3 is noteworthy, because it offers the same convenience of G1 but without messy commits that mix changes to source and output files. An added bonus of G3 is that rendering with GitHub Actions provides a reproducible computational environment that is not dependent on what you have installed on your computer.\nInstead of using GitHub Actions, I could have used GitLab CI/CD to build my site. I decided not to go down this route because the Quarto dev team has many GitHub Actions workflows available but currently no official support for GitLab CI/CD.\nBefore trying to use GitHub Actions or any other continuous integration systems in your publishing workflow, I suggest getting used to working with quarto publish (Q1, G2, or N1). You can always set up other publishing methods later without sacrificing anything, because all of the publishing methods except G1 can be combined together.\nIn Section¬†4, I will walk through the setup of both G2 and G3 to provide the option of rendering locally by running quarto publish or rendering remotely with GitHub Actions by pushing to the main branch. Along the way, I will share many practical tips and general advice that you can apply to any project.",
    "crumbs": [
      "Software",
      "Quarto",
      "Script"
    ]
  },
  {
    "objectID": "quarto/script/index.html#sec-set",
    "href": "quarto/script/index.html#sec-set",
    "title": "Quarto",
    "section": "Publishing setup",
    "text": "Publishing setup\n\nRepo setup\nBefore you can use GitHub Actions to publish your site, you will need a GitHub, an SSH key, and a repo like maptv.github.io that has a default branch called main and another branch which must be called gh-pages. If you want to publish on GitLab Pages, you will also need a GitLab account and an analogous GitLab repo like maptv.gitlab.io.\nYou can create the repo and the gh-pages branch using the web interface of https://github.com or https://gitlab.com in your browser, but the best way to start a new project is using the CLI for GitHub or GitLab in your terminal. First, run gh auth login or glab auth login and follow the prompts to authenticate via your web browser or with an authentication token.\nThe GitHub CLI allows you to add an SSH key to your account during or after authentication. The GitLab CLI does not handle SSH keys during authentication, but has a similar command for adding an SSH key to your GitLab account.\nAfter authentication and SSH key setup, you can run the code in either of the code chunks in Example¬†4 to set up your local and remote repos and create a Quarto website project in the local repo. You can create shell alias that combine all of the repo creation steps like I did in my .zshrc.\n\nExample 4 ¬†\n\nGitHubGitLab\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\ngh repo create USERNAME.github.io --add-readme --clone --public\ncd SITENAME\nquarto create project website USERNAME.github.io\n\n\ncd # start in home directory\nmkdir -p USERNAME\ncd USERNAME\nglab repo create USERNAME.gitlab.io --readme --defaultBranch main --public\ncd SITENAME\ngit pull origin main\ngit branch --set-upstream-to=origin/main main\nquarto create project website USERNAME.gitlab.io\n\n\n\n\nTo make it easier to maintain my site on both GitHub and GitLab Pages, I set up my local repo cloned to have two origin remote URLs using the code as shown in Example¬†5. Now, running quarto publish or git push in my local repo, updates my content on both GitHub and GitLab.\n\nExample 5 ¬†\ngit remote add lab git@gitlab.com:maptv/maptv.gitlab.io\ngit remote add hub git@github.com:maptv/maptv.github.io\ngit remote set-url --add origin $(git remote get-url lab)\n\nIf you want to have your website hosted on GitHub Pages, you will need to set gh-pages as your source branch in your repo settings. For GitLab Pages, you will need to add a .gitlab-ci.yml file to your repo and update your _quarto.yml file as shown in Example¬†6 to include .gitlab-ci.yml as a resource in your output directory.\n\nExample 6 ¬†\n\n.gitlab-ci.yml_quarto.yml\n\n\n# https://docs.gitlab.com/ee/user/project/pages/introduction.html#customize-the-default-folder\npages:\n  script: echo \"The site will be deployed to $CI_PAGES_URL\"\n  artifacts:\n    paths:\n      - \".\"\n  publish: \".\"\n  only:\n    - gh-pages\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\n\n\n\n\nBy default, GitLab Pages includes a random hash in site URLs. To shorten the URL of my GitLab Pages site to &lt;maptv.gitlab.io&gt;, I had to uncheck Use unique domain under Deploy &gt; Pages in the GitLab sidebar.\nAt this point, we have completed G2 setup and you should be able to run quarto publish gh-pages from your main branch to render your site and deploy it to GitHub and/or GitLab Pages. Deploying with quarto publish at least once is a prerequisite for setting up any of the publishing methods that rely on GitHub Actions, because quarto publish creates a _publish.yml file in the root of your project that is required for publishing via GitHub Actions.\n\n\nGitHub Actions\nIn addition to the steps described above, G3 setup requires that we create a .github/workflows directory and add a YAML file to that directory. Example¬†7 contains the gh-pages.yml file I use for my own site and the shell code that can used to obtain this file.\n\nExample 7 ¬†\n\ncurlgh-pages.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_dispatch:\n  push:\n    branches: [main]\n\nname: Quarto Publish\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out repository\n        uses: actions/checkout@v4\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n        with:\n          version: '1.4.489'\n          tinytex: true\n\n      - name: Install R\n        uses: r-lib/actions/setup-r@v2\n        with:\n          r-version: '4.2.0'\n\n      - name: Install R Dependencies\n        uses: r-lib/actions/setup-renv@v2\n        with:\n          cache-version: 1\n\n      - name: Install Python and Dependencies\n        uses: actions/setup-python@v4\n        with:\n          python-version: '3.10'\n          cache: 'pip'\n      - run: pip install jupyter\n      - run: pip install -r requirements.txt\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n\n      - name: Push To GitLab\n        env:\n          token: ${{ secrets.GITLAB_AUTH_TOKEN }}\n        run: |\n          echo Starting to push gh-pages branch to GitLab\n          git config user.name \"maptv\"\n          git config user.email \"129316885+maptv@users.noreply.github.com\"\n          git remote set-url origin \"https://oauth2:${token}@gitlab.com/maptv/maptv.gitlab.io\"\n          git push origin gh-pages\n\n\n\n\nThe gh-pages.yml file in Example¬†7 installs Quarto, the R and Python programming languages, and the packages in the renv.lock and requirements.txt files. If you do not need R and/or Python, you can remove any unnecessary portions of the file.\nTo modify the Python files that are installed by GitHub Actions, you can edit the requirements.txt file in your repo. To update your renv.lock file so that it includes all of the R packages your site requires, run renv::snapshot() in an R session or Rscript -e renv::snapshot() in a shell.\nAfter pushing the gh-pages.yml file, you can visit the Actions tab in your remote repo on GitHub to check the progress of the deployment of your site. If your site did not build successfully, you can go through the logs to try to diagnose the problem.\nI added a ‚ÄúPush to GitLab‚Äù step to my gh-pages.yml to make GitHub Actions push my remote gh-pages to GitLab so that my site is kept in sync on both GitHub and GitLab Pages. This required manually creating a token on GitLab and adding it to GitHub, which I accomplished using the GitHub CLI as shown in Example¬†8.\n\nExample 8 ¬†\ngh secret set GITLAB_AUTH_TOKEN\n\nAfter the setup described above, I now have two options for publishing my Quarto site: quarto publish and 2) git push. In addition to GitHub and GitLab Pages, both of these options automatically update my site on Netlify via N2.\nTo also automatically update my site on Quarto Pub, I created a separate GitHub Actions workflow by adding another YAML file to the .github/workflows directory in my repo. Example¬†9 shows my quarto-pub.yml file and the shell code that can be used to obtain it.\n\nExample 9 ¬†\n\ncurlquarto-pub.yml\n\n\nmkdir -p .github/workflows\ncd .github/workflows\ncurl -O https://raw.githubusercontent.com/maptv/maptv.github.io/main/.github/workflows/gh-pages.yml\n\n\non:\n  workflow_run:\n    workflows: [pages-build-deployment]\n    types: [completed]\n\nname: Update Quarto Pub\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Check out main repository\n        uses: actions/checkout@v4\n\n      - name: Check out _site\n        uses: actions/checkout@v4\n        with:\n          ref: gh-pages\n          path: _site\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: quarto-pub\n          render: false\n          QUARTO_PUB_AUTH_TOKEN: ${{ secrets.QUARTO_PUB_AUTH_TOKEN }}\n          GITHUB_USERNAME: maptv\n\n\n\n\nMy quarto-pub.yml file is based on Q2, but it runs upon completion of the pages-build-deployment workflow instead of a push to main. I changed the workflow trigger so that it runs after my GitHub Pages site is built, regardless of whether I triggered the build by running quarto publish gh-pages or pushing to main.\nFigure¬†3 summarizes all of the steps that occur during my Quarto publishing workflow. This workflow allows me to publish my site on four web hosts every time I run quarto publish gh-pages (G2) or git push (G3)!\n\n\n\n\n\n\nflowchart LR\n    A[local&lt;br/&gt;main]-.G2.-&gt;B[local&lt;br/&gt;gh-pages]-.G2.-&gt;C[GitHub&lt;br/&gt;gh-pages]\n    B[local&lt;br/&gt;gh-pages]-.G2.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;F[GitHub&lt;br/&gt;main]-.G3.-&gt;C[GitHub&lt;br/&gt;gh-pages]-.G3.-&gt;D[GitLab&lt;br/&gt;gh-pages]\n    A[local&lt;br/&gt;main]-.G3.-&gt;G[GitLab&lt;br/&gt;main]\n    C[GitHub&lt;br/&gt;gh-pages]-.N2.-&gt;E[Netlify]\n    C[GitHub&lt;br/&gt;gh-pages]-.Q2.-&gt;H[Quarto&lt;br/&gt;Pub]\n\n\n\n\nFigure¬†3: Quarto publishing workflow\n\n\n\n\n\nSo far I have only noticed one difference between the four web hosts I use for my site: GitHub Pages is the only web host that properly differentiates between internal and external links. All of the other web hosts include the external link icon on all links regardless of whether they target my site or an external site.\nI tried unsuccessfully to solve this issue by setting the link-external-filter property to a regular expression. If you notice a problem with the link-external-icon feature on other web hosts, I suggest switching to GitHub Pages.",
    "crumbs": [
      "Software",
      "Quarto",
      "Script"
    ]
  },
  {
    "objectID": "quarto/script/index.html#sec-cust",
    "href": "quarto/script/index.html#sec-cust",
    "title": "Quarto",
    "section": "Customizing Quarto sites",
    "text": "Customizing Quarto sites\n\nSite navigation\nOnce your site is built and published, you can make it easier to navigate with a customized navigation bar (navbar) and sidebar, as described in the Quarto documentation. Check out the _quarto.yml files for my site and the Quarto documentation site to see how the navigation components are set up.\nIn my navbar, I added toggle buttons for reader mode and dark mode. The names of the other icons on right side of the navbar are included in the sidebar.\n\n\nHTML blocks\nMy navbar also provides the current date and time in Dec ordinal (deco) format, which counts the years since 1 BC and the days since March 1. Dec is a calendar and time system that I created and use throughout my blog.\nTo add a custom timestamp to the navbar, I put a &lt;script&gt; element that runs time.js in an HTML block in every Quarto markdown (.qmd) file, as shown in Example¬†10. Mine √áetinkaya-Rundel wrote about HTML blocks as part of her A Quarto tip a day project.\n\nExample 10 ¬†\n\n*.qmdtime.js\n\n\n```{=html}\n&lt;script src=\"time.js\"&gt;&lt;/script&gt;\n```\n\n\n\n\n\n\n\nHTML blocks are useful for running JavaScript code in the context of a single page on your site without affecting the others. I also use HTML blocks to add a &lt;style&gt; element to my .qmd files as a last ditch effort to fine tune the style of my site.\nBefore I resort to the &lt;style&gt; element approach, I try writing CSS in my style.css, light.css, and dark.css files. So far, this approach has been sufficient to make any styling changes I want, but if it every fails, I can use JavaScript to override the default styling provided by Quarto by modifying style attributes, which have the highest specificity in CSS.\n\n\nPost-render script\nI wanted to my blog‚Äôs listing page to show dates in the same format as the navbar timestamp. To accomplish this, I used a post-render script written in the Python programming language.\nPre- and post-render scripts are set as project options in the _quarto.yml file in the root of your Quarto project. Example¬†11 shows the date.py post-render script and how this script is referenced in _quarto.yml.\n\nExample 11 ¬†\n\n_quarto.ymldate.py\n\n\nauthor:\n  - name: Martin Laptev\n    url: https://maptv.github.io\ndate-format: x\n\n\n# https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nimport bs4\n\ndef unix2doty(ms):\n    dote = ms / 86400000 + 719468\n    cykl = (\n        dote if dote &gt;= 0\n        else dote - 146096\n    ) // 146097\n    dotc = dote - cykl * 146097\n    yotc = (dotc\n        - dotc // 1460\n        + dotc // 36524\n        - dotc // 146096\n    ) // 365\n    return [\n        int(yotc + cykl * 400),\n        dotc - (yotc * 365\n            + yotc // 4\n            - yotc // 100\n        )\n    ]\n\nwith open(\"_site/list/index.html\") as infile:\n    txt = infile.read()\n    soup = bs4.BeautifulSoup(txt, features=\"html.parser\")\nfor div in soup.find_all(\"div\", {\"class\": \"card-file-modified\"}):\n    elem = div.find(\"p\")\n    if \"+\" not in elem.text:\n        y, d = unix2doty(int(div.text))\n        elem.string.replace_with(f\"{y:&gt;04}+{d.__floor__():&gt;03}\")\nfor div in soup.find_all(\"div\", {\"class\": \"listing-reading-time\"}):\n    if \"min\" in div.text:\n        div.string.replace_with(f\"{(int(div.text.split()[0]) / 1.44).__floor__()} milliday\")\nwith open(\"_site/list/index.html\", \"w\") as outfile:\n    outfile.write(str(soup))\n\n\n\n\nNormally, formatting dates in Quarto is as easy as setting the date-format YAML property. In my case it was more difficult, because I wanted dates based on Dec, the calendar and time system I created, instead of the ubiquitous Gregorian calendar.\nTo facilitate the calculations in date.py, I set date-format to x in my _metadata.yml file so all of the dates would be in millisecond UNIX time and I would not have to deal with Gregorian calendar date formats or time zones. After all of the dates are generated, my date.py script traverses the HTML in the output directory using Beautiful Soup and converts millisecond UNIX time dates into Dec dates (year+day).\n\n\nPandoc filter\nIn addition to customizing dates on the listing page of my blog, I wanted to customize the date format in every blog post. To complete this task, I used a Lua script as a Pandoc filter.\nPandoc is a program that converts documents into practically any format. The ‚Äúpan‚Äù in Pandoc comes from the Ancient Greek word for all. Pandoc strives to convert all document formats, just like Pangea contained all the land and a panacea solves all problems.\nQuarto uses Pandoc to convert markdown files into target format(s) like html or pdf. If the source files contain executable code, Quarto executes the code via one of two computational engines: Jupyter or Knitr. Figure¬†4 shows the Quarto workflow.\n\n\n\n\n\n\nflowchart LR\n   A[qmd&lt;br/&gt;ipynb]-.Knitr&lt;br/&gt;Jupyter.-&gt;B((md))-.Pandoc with&lt;br/&gt;Lua filters.-&gt;C(html&lt;br/&gt;pdf&lt;br/&gt;docx&lt;br/&gt;etc.)\n\n\n\n\nFigure¬†4: Quarto rendering workflow\n\n\n\n\n\nMine √áetinkaya-Rundel‚Äôs Quarto tip series includes a similar Quarto workflow mermaid diagram and her ‚ÄúHello, Quarto!‚Äù rstudio::conf(2022) keynote with Julia Stewart Lowndes contains truly beautiful Quarto workflow images by Allison Horst: 1, 2, 3, and 4.\nQuarto controls Pandoc, Jupyter, and Knitr in two ways: 1) with arguments passed to the Quarto CLI commands and 2) with YAML key-value pairs in .qmd, .ipynb, or .yml files.\nExample¬†12 shows how I set up every qmd file to generate the current date in millisecond UNIX time and designated date.lua as a Pandoc filter. Unlike post-render scripts, Pandoc filters are executed during the creation of the output files.\n\nExample 12 ¬†\n\n*.qmddate.lua\n\n\ndate: now\ndate-format: x\nfilters: date.lua\n\n\n-- https://howardhinnant.github.io/date_algorithms.html#days_from_civil\nfunction unix2deco(ms)\n  local dote = ms / 86400000 + 719468\n  local cykl = (\n    dote &gt;= 0 and dote\n    or dote - 146096\n  ) // 146097\n  local dotc = dote - cykl * 146097\n  local yotc = (\n    dotc - dotc // 1460\n    + dotc // 36524\n    - dotc // 146096\n  ) // 365\n  return string.format(\n    \"%s+%s\",\n    math.floor(yotc + cykl * 400),\n    math.floor(dotc - (yotc * 365\n      + yotc // 4\n      - yotc // 100)))\nend\n\nlocal function to_decalendar(date)\n  local date = pandoc.utils.stringify(date)\n  local unix = date:match(\"(%d+)\")\n  return date:gsub(unix, unix2deco(unix))\nend\n\nfunction Meta(m)\n  m.date = to_decalendar(m.date)\n  return m\nend\n\n\n\n\nAll three of the customizations I described above convert millisecond UNIX time into a custom date format, but you can adapt these approaches to make all sorts of edits to your Quarto site. HTML blocks can run JavaScript which excels at making content dynamic and interactive, pre- and post-render scripts can be in any programming language, while Pandoc filters are written in Lua and modify output during rendering.\nComing up next on my blog is a post that Observable graphics. Get ready for an animated and interactive data visualization extravaganza!",
    "crumbs": [
      "Software",
      "Quarto",
      "Script"
    ]
  },
  {
    "objectID": "dec/snap/index.html",
    "href": "dec/snap/index.html",
    "title": "Dec Time",
    "section": "",
    "text": "My website provides many examples of the Quarto publishing and the Dec measurement systems in action. I leverage Quarto support for the Observable data analysis and visualization system to display animated or interactive plots like the bar chart, clocks, solar terminator map, and line chart below.\n\nbarChart = {\nconst W = width;\n  const H = 88;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W * .87, H]);\n  const xRange = [0, W - 100];\n  const scaleDD = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleMandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data([\n      // 'dek', 'dotd',\n      'dd', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=&gt;i*30+firstBarY)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(Number(barBeats)+Number(barMb)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(barBeats))\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(Number(barDD)+Number(barMils)/100+Number(barBeats)/10000+Number(barMb)/10000000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(barDD))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(Number(barMils)+Number(barBeats)/100))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFull')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(barMils))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+30)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickB1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+47:firstBarY+50)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=&gt;scaleDD(d)+barX)\n    .attr('y', firstBarY+20)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=&gt;scaleDD(d)+barX+.5)\n    .attr('y', firstBarY+18)\n    .text(d=&gt;d)\n  // Cent ticks\n  svg.selectAll('.tickC2')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC2')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+10)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`${barDD}`, `${barMils}`, `${barBeats}`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=&gt;i*30+firstBarY+20)\n    .text(d=&gt;d);\n  svg.attr(\"id\", \"barClock\");\n  return svg.node();\n}\nbarChart1 = {\nconst W = width;\n  const H = 88;\n  const barX = 1;\n  const firstBarY = 1;\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"width\", W)\n    .attr(\"viewBox\", [0, 0, W * .87, H]);\n  const xRange = [0, W - 100];\n  const scaleDD = d3.scaleLinear()\n    .domain([0, 10])\n    .range(xRange);\n  const scaleMandB = d3.scaleLinear()\n    .domain([0, 100])\n    .range(xRange);\n  // const scaleDek = d3.scaleLinear()\n  //  .domain([0, 37])\n  //  .range(xRange);\n  // Background bars to show where 100% lies\n  svg.selectAll('.background')\n    .data([\n      // 'dek', 'dotd',\n      'dd', \"mils\", 'beats'])\n    .enter()\n    .append('rect')\n    .attr('class', 'background timeBar')\n    .attr('width', W-100)\n    .attr('y', (d,i)=&gt;i*30+firstBarY)\n  // Beats\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(Number(barBeatsN)+Number(barMbN)/1000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY+60)\n    .attr('width', d =&gt; scaleMandB(barBeatsN))\n  // Cents/Mils\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(Number(barDDN)+Number(barMilsN)/100+Number(barBeatsN)/10000+Number(barMbN)/10000000))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY)\n    .attr('width', d =&gt; scaleDD(barDDN))\n  svg\n    .append('rect')\n    .attr('class', 'timeBar')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(Number(barMilsN)+Number(barBeatsN)/100))\n  svg\n    .append('rect')\n    .attr('class', 'timeBarFullN')\n    .attr('y', firstBarY+30)\n    .attr('width', d =&gt; scaleMandB(barMilsN))\n  // Cent ticks\n  svg.selectAll('.tickC')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+30)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickB1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+77:firstBarY+80)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  svg.selectAll('.tickC1')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC1')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', d=&gt;d%2===0? firstBarY+47:firstBarY+50)\n    .attr('height', d=&gt;d%2===0? 8:5)\n  // Mil ticks\n  svg.selectAll('.tickM')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickM')\n    .attr('x', d=&gt;scaleDD(d)+barX)\n    .attr('y', firstBarY+20)\n    .attr('height', 6)\n  svg.selectAll('.tickLabel1')\n    .data(d3.range(width &gt; 500 ? 1 : 1, 10))\n    .enter()\n    .append('text')\n    .attr('class', 'tickLabel1')\n    .attr('x', d=&gt;scaleDD(d)+barX+.5)\n    .attr('y', firstBarY+18)\n    .text(d=&gt;d)\n  // Cent ticks\n  svg.selectAll('.tickC2')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickC2')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+10)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Beat ticks\n  svg.selectAll('.tickB')\n    .data(d3.range(width &gt; 500 ? 10 : 10, 100))\n    .enter()\n    .append('rect')\n    .attr('class', 'tickB')\n    .attr('x', d=&gt;scaleDD(d/10)+barX)\n    .attr('y', firstBarY+60)\n    .attr('height', d=&gt;d%2===0? 9:6)\n  // Labels\n  svg.selectAll('.timeLabel')\n    .data([`${barDDN}`, `${barMilsN}`, `${barBeatsN}`])\n    .enter()\n    .append('text')\n    .attr('class', 'timeLabel')\n    .attr('x', barX+2)\n    .attr('y', (d,i)=&gt;i*30+firstBarY+20)\n    .text(d=&gt;d);\n  svg.attr(\"id\", \"barClock\");\n  return svg.node();\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof location = worldMapCoordinates([162, 0], [width * .998, Math.round((21 / 40) * width)])\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\napp = {\n  const svg = d3.select(DOM.svg(width, height));\n  svg.style(\"user-select\", \"none\")\n     .style(\"-webkit-user-select\", \"none\");\n  const margin = {top: 0, left: 10, right: 10, bottom: 0, inner: 3};\n  const contentWidth = width - margin.left - margin.right - margin.inner;\n  const columnWidth = contentWidth / 2;\n  let selection = {\n    date: new Date(),\n    hour: new Date().getHours()\n  }\n  const renderPlot = () =&gt; {\n    svg.selectAll(\"#plot *\").remove();\n    svg.select(\"#plot\").call(daylightPlot, {\n      width: columnWidth / 1.28,\n      height: height / 1.51 - margin.top - margin.bottom,\n      year: new Date().getFullYear(),\n      latitude: location[1],\n      defaultDate: selection.date,\n      defaultHour: selection.hour\n    })\n  }\n  const renderGlobe = () =&gt; {\n    svg.selectAll(\"#globe *\").remove();\n    svg.selectAll(\"#globe\").call(globe, { width: columnWidth * 1.22, location, ...selection });\n  }\n  const renderSolarSystem = () =&gt; {\n    svg.selectAll(\"#solar-system *\").remove();\n    svg.selectAll(\"#solar-system\").call(solarSystem,\n                                        columnWidth / 1.08,\n                                        location,\n                                        selection.date,\n                                        selection.hour);\n  }\n  const setSelection = (newSelection, forceRender = false) =&gt; {\n    const prev = {...selection};\n    selection = newSelection;\n    svg.node().value = selection;\n    if (forceRender) {\n      renderPlot();\n      renderSolarSystem();\n      renderGlobe();\n    } else if (prev.hour !== selection.hour || prev.date !== selection.date) {\n      renderSolarSystem();\n      renderGlobe();\n    }\n  }\n  svg.append(\"g\")\n    .attr(\"id\", \"solar-system\")\n    .attr(\"transform\", `translate(${margin.left}, ${margin.top + height / 7.6})`);\n  const plot = svg.append(\"g\")\n    .attr(\"id\", \"plot\")\n    .attr(\"transform\", `translate(${margin.left}, ${margin.top + height / 4})`);\n  svg.append(\"g\")\n    .attr(\"id\", \"globe\")\n    .attr(\"transform\", `translate(${margin.left + margin.inner + columnWidth / 1.25}, ${margin.top + Number(columnWidth &lt; 300) * 16})`);\n  setSelection(selection, true);\n  const handleDateHourChange = ({ target, detail: { date, hour }}) =&gt; {\n    if (date != null && hour != null) setSelection({...selection, date, hour});\n  }\n  svg.node().addEventListener(EventType.DateHourChange, handleDateHourChange, false);\n  return svg.node();\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof schedule = Inputs.radio([2, 3, 4, 5], {label: \"Workdays per pent\", value: 3})\nviewof intervals = Inputs.form([\n  interval([0, 1], {step: .01, value: [.3, .7], label: '0 or 5', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '1 or 6', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [.3, .7], label: '2 or 7', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '3 or 8', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n  interval([0, 1], {step: .01, value: [0, 0], label: '4 or 9', width: 195, format: ([start, end]) =&gt; start === end ? \"\" : `${formatDecimal(start)}=${formatDecimal(end)}`}),\n])\npentBar = Plot.plot({\n  x: {label: \"Day of the dek\", labelOffset: 36, labelArrow: true, labelAnchor: \"center\"},\n  style: {fontSize: \"16px\"},\n  marginBottom: 40,\n  marginLeft: 45,\n  width: width,\n  className: \"pentbar\",\n  color: {scheme: \"Set1\", legend: \"swatches\", reverse: true, className: \"pentbarlegend\"},\n  y: {label: \"Proportion of the day\", domain: [1, 0], tickPadding: 6, tickSize: -4, labelOffset: 44, labelArrow: true, labelAnchor: \"center\"},\n  marks: [\n  Plot.barY(durations, {x: \"label\", y: \"duration\", fill: \"group\"}),\n  Plot.textY(\n      durations,\n      Plot.stackY(\n        Plot.groupX(\n          { y: \"first\", text: \"first\",\n          },\n          {\n            x: \"label\",\n            z: \"group\",\n            y: \"duration\",\n            text: (d) =&gt; (d.duration &lt; .0001 ? null : formatDecimal(d.duration)),\n            fill: \"white\",\n            stroke: \"black\",\n            fontSize: 28,\n          }\n        )\n      )\n    ),\n  ]})\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nclock = {\n  const clockRadius = 200,\n    margin = 50,\n    w = (clockRadius + margin) * 2,\n    h = (clockRadius + margin) * 2,\n    hourHandLength = (2 * clockRadius) / 3,\n    minuteHandLength = clockRadius,\n    secondHandLength = clockRadius - 12,\n    secondHandBalance = 30,\n    secondTickStart = clockRadius,\n    secondTickLength = -10,\n    hourTickStart = clockRadius,\n    hourTickLength = -18,\n    secondLabelRadius = clockRadius + 16,\n    secondLabelYOffset = 5,\n    hourLabelRadius = clockRadius - 40,\n    hourLabelYOffset = 7,\n    radians = Math.PI / 180;\n  const ten = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 10]);\n  const sto = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 100]);\n  const handData = [\n    {\n      type: \"hour\",\n      value: 0,\n      length: -hourHandLength,\n      scale: ten\n    },\n    {\n      type: \"minute\",\n      value: 0,\n      length: -minuteHandLength,\n      scale: sto\n    },\n    {\n      type: \"second\",\n      value: 0,\n      length: -secondHandLength,\n      scale: sto,\n      balance: secondHandBalance\n    }\n  ];\n  function drawClock() {\n    // create all the clock elements\n    updateData(); //draw them in the correct starting position\n    const face = svg\n      .append(\"g\")\n      .attr(\"id\", \"clock-face\")\n      .attr(\"transform\", `translate(${[w / 2, h / 2]})`);\n    // add marks for seconds\n    face\n      .selectAll(\".second-tick\")\n      .data(d3.range(0, 100))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"second-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", secondTickStart)\n      .attr(\"y2\", secondTickStart + secondTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${sto(d)})`);\n    // and labels...\n    face\n      .selectAll(\".second-label\")\n      .data(d3.range(0, 100, 5))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"second-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; secondLabelRadius * Math.sin(sto(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt;\n          -secondLabelRadius * Math.cos(sto(d) * radians) + secondLabelYOffset\n      )\n      .text(d =&gt; d);\n    // ... and hours\n    face\n      .selectAll(\".hour-tick\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"hour-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", hourTickStart)\n      .attr(\"y2\", hourTickStart + hourTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${ten(d)})`);\n    face\n      .selectAll(\".hour-label\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"hour-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; hourLabelRadius * Math.sin(ten(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt; -hourLabelRadius * Math.cos(ten(d) * radians) + hourLabelYOffset\n      )\n      .text(d =&gt; d);\n    const hands = face.append(\"g\").attr(\"id\", \"clock-hands\");\n    hands\n      .selectAll(\"line\")\n      .data(handData)\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", d =&gt; d.type + \"-hand\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", d =&gt; d.balance || 0)\n      .attr(\"x2\", 0)\n      .attr(\"y2\", d =&gt; d.length)\n      .attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n    face\n      .append(\"g\")\n      .attr(\"id\", \"face-overlay\")\n      .append(\"circle\")\n      .attr(\"class\", \"hands-cover\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"r\", clockRadius / 20);\n  }\n  function moveHands() {\n    const sel = d3\n      .select(\"#clock-hands-final\")\n      .selectAll(\"line\")\n      .data(handData)\n      .transition();\n    if (fancySecondsOFF) sel.ease(d3.easeElastic.period(0.5));\n    sel.attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n  }\n  function updateData() {\n    handData[0].value = !fancySecondsOFF ? Math.floor(selectedExact * 10) : declock[0];\n    handData[1].value = !fancySecondsOFF ? Math.floor(selectedExact * 10 % 1 * 100) : declock.slice(2, 4);\n    handData[2].value = !fancySecondsOFF ? selectedExact * 10 % 1 * 100 % 1 * 100 : declock.slice(4, 6);\n  }\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"viewBox\", [0, 0, w, h])\n    .style(\"max-width\", \"350px\")\n    .attr(\"class\", \"clock-top\")\n    .attr(\"id\", \"clock\");\n  svg\n    .append(\"text\")\n    .text(\"+\" + selected)\n    .attr(\"x\", clockRadius + margin)\n    .attr(\"y\", clockRadius * 2 + margin * 1.975)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", 32)\n    .attr(\"font-family\", \"monospace\");\n  drawClock();\n  // Animation\n  const interval = setInterval(\n    () =&gt; {\n      updateData();\n      moveHands();\n    },\n    !fancySecondsOFF ? 10 : 864\n  );\n  invalidation.then(() =&gt; clearInterval(interval));\n  return svg.node();\n}\nclock1 = {\n  const clockRadius = 200,\n    margin = 50,\n    w = (clockRadius + margin) * 2,\n    h = (clockRadius + margin) * 2,\n    hourHandLength = (2 * clockRadius) / 3,\n    minuteHandLength = clockRadius,\n    secondHandLength = clockRadius - 12,\n    secondHandBalance = 30,\n    secondTickStart = clockRadius,\n    secondTickLength = -10,\n    hourTickStart = clockRadius,\n    hourTickLength = -18,\n    secondLabelRadius = clockRadius + 16,\n    secondLabelYOffset = 5,\n    hourLabelRadius = clockRadius - 40,\n    hourLabelYOffset = 7,\n    radians = Math.PI / 180;\n  const ten = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 10]);\n  const sto = d3\n    .scaleLinear()\n    .range([0, 360])\n    .domain([0, 100]);\n  const handData = [\n    {\n      type: \"hour\",\n      value: 0,\n      length: -hourHandLength,\n      scale: ten\n    },\n    {\n      type: \"minute\",\n      value: 0,\n      length: -minuteHandLength,\n      scale: sto\n    },\n    {\n      type: \"second\",\n      value: 0,\n      length: -secondHandLength,\n      scale: sto,\n      balance: secondHandBalance\n    }\n  ];\n  function drawClock() {\n    // create all the clock elements\n    updateData(); //draw them in the correct starting position\n    const face = svg\n      .append(\"g\")\n      .attr(\"id\", \"clock-face\")\n      .attr(\"transform\", `translate(${[w / 2, h / 2]})`);\n    // add marks for seconds\n    face\n      .selectAll(\".second-tick\")\n      .data(d3.range(0, 100))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"second-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", secondTickStart)\n      .attr(\"y2\", secondTickStart + secondTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${sto(d)})`);\n    // and labels...\n    face\n      .selectAll(\".second-label\")\n      .data(d3.range(0, 100, 5))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"second-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; secondLabelRadius * Math.sin(sto(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt;\n          -secondLabelRadius * Math.cos(sto(d) * radians) + secondLabelYOffset\n      )\n      .text(d =&gt; d);\n    // ... and hours\n    face\n      .selectAll(\".hour-tick\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"hour-tick\")\n      .attr(\"x1\", 0)\n      .attr(\"x2\", 0)\n      .attr(\"y1\", hourTickStart)\n      .attr(\"y2\", hourTickStart + hourTickLength)\n      .attr(\"transform\", d =&gt; `rotate(${ten(d)})`);\n    face\n      .selectAll(\".hour-label\")\n      .data(d3.range(0, 10, 1))\n      .enter()\n      .append(\"text\")\n      .attr(\"class\", \"hour-label\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"x\", d =&gt; hourLabelRadius * Math.sin(ten(d) * radians))\n      .attr(\n        \"y\",\n        d =&gt; -hourLabelRadius * Math.cos(ten(d) * radians) + hourLabelYOffset\n      )\n      .text(d =&gt; d);\n    const hands = face.append(\"g\").attr(\"id\", \"clock-hands\");\n    hands\n      .selectAll(\"line\")\n      .data(handData)\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", d =&gt; d.type + \"-hand\")\n      .attr(\"x1\", 0)\n      .attr(\"y1\", d =&gt; d.balance || 0)\n      .attr(\"x2\", 0)\n      .attr(\"y2\", d =&gt; d.length)\n      .attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n    face\n      .append(\"g\")\n      .attr(\"id\", \"face-overlay\")\n      .append(\"circle\")\n      .attr(\"class\", \"hands-cover\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"r\", clockRadius / 20);\n  }\n  function moveHands() {\n    const sel = d3\n      .select(\"#clock-hands-final\")\n      .selectAll(\"line\")\n      .data(handData)\n      .transition();\n    if (fancySecondsOFF) sel.ease(d3.easeElastic.period(0.5));\n    sel.attr(\"transform\", d =&gt; `rotate(${d.scale(d.value)})`);\n  }\n  function updateData() {\n    handData[0].value = !fancySecondsOFF ? Math.floor(selectedExactM * 10) : declockM[0];\n    handData[1].value = !fancySecondsOFF ? Math.floor(selectedExactM * 10 % 1 * 100) : declockM.slice(2, 4);\n    handData[2].value = !fancySecondsOFF ? selectedExactM * 10 % 1 * 100 % 1 * 100 : declockM.slice(4, 6);\n  }\n  const svg = d3\n    .create(\"svg\")\n    .attr(\"viewBox\", [0, 0, w, h])\n    .style(\"max-width\", \"350px\")\n    .attr(\"class\", \"clock-btm\")\n    .attr(\"id\", \"clock\");\n  svg\n    .append(\"text\")\n    .text(\"-\" + selectedM)\n    .attr(\"x\", clockRadius + margin)\n    .attr(\"y\", clockRadius * 2 + margin * 1.975)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", 32)\n    .attr(\"font-family\", \"monospace\");\n  drawClock();\n  // Animation\n  const interval = setInterval(\n    () =&gt; {\n      updateData();\n      moveHands();\n    },\n    !fancySecondsOFF ? 10 : 864\n  );\n  invalidation.then(() =&gt; clearInterval(interval));\n  return svg.node();\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [(unix ?? Date.now()) / 86400000 + (\n    zone = zone ?? -Math.round(\n      (new Date).getTimezoneOffset() / 144)\n    ) / 10 + offset, zone]\n}\nfunction unix2dote1(unix, zone, offset = 719468) {\n  return [\n    (unix ?? Date.now()) / 86400000\n    + (zone = zone ?? (10 - Math.round(\n        (new Date).getTimezoneOffset() / 144)) % 10\n      ) / 10 + offset, zone]\n}\nselectedDote = unix2dote(unix, long2zone(location[0]))\nselectedExact = selectedDote[0] % 1\nselectedExactM = Math.abs(selectedExact - 1)\nbarTime = selectedExact.toString().slice(2)\nbarTimeN = selectedExactM.toString().slice(2)\nbarCents = barTime.slice(0, 2)\nbarCentsN = barTimeN.slice(0, 2)\nbarDD = barTime[0]\nbarDDN = barTimeN[0]\nbarMils = barTime.slice(1, 3)\nbarMilsN = barTimeN.slice(1, 3)\nbarBeats = barTime.slice(3, 5)\nbarBeatsN = barTimeN.slice(3, 5)\nbarMb = barTime.slice(5, 8)\nbarMbN = barTimeN.slice(5, 8)\nfunction lati2turn1(degrees = -180, e = 3) {\n  // turns: e=0, deciturns: e=1, etc.\n  return (degrees %= 360) / (360 / 10**e) % 10**e;\n}\nfunction dote2deco(dote = 719468, zone = 0, lead = \"0\", emoji = false, minus = false) {\nlet [year, doty] = dote2date(dote);\n  if (minus) {\n    doty = Math.abs(doty - (365 + Number(year2leap(year + 1))));\n    if (zone != null) {\n      zone = (10 - zone) % 10;\n    }\n  }\nreturn `${\n    (year + minus).toString().padStart(4, lead)}${minus ? \"-\" : \"+\"}${\n    Math.floor(doty).toString().padStart(3, lead)}${emoji ? \"üóìÔ∏è\" : \"\"}${(doty % 1 * 10).toFixed(4)}${\n    zone != null ? (minus ? \"+\" : \"-\") + String(zone) : \"\"}${emoji ? \"üï∞Ô∏è\" : \"\"}`\n}\ngraticule = d3.geoGraticule().stepMinor([36,36]).stepMajor([36,36])()\ngraticule.coordinates = graticule.coordinates.map(\n  i =&gt; i.map(j =&gt; j.map((k, index, arr) =&gt; i.length === 3 && index === 0 ? k - 18 : k))\n)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction long2turn(degrees = -180, e = 3) {\n  // turns: e=0, deciturns: e=1, etc.\n  return (((degrees %= 360) &lt; 0 ? degrees + 360 : degrees) + 18) / (360 / 10**e) % 10**e;\n}\n// https://github.com/topojson/world-atlas\nworld = d3.json(\"https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json\")\ncountries = topojson.feature(world, world.objects.countries)\ntopojson = require(\"topojson-client@3\")\nfunction long2zone(degrees = -180) {\n  return Math.floor(long2turn(degrees, 1));\n}\nfunction year2leap(year = 1970) {\n    return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\nsolarSystem = (root, width, location, date, hour) =&gt; {\n  const earthRadius = 0.04 * width;\n  const sunRadius = 0.08 * width;\n  const solarSystemRadius = width / 2 - 20;\n  const stretch = 0.3;\n  const solarAngle = getSolarAngle(date);\n  const solarAngleDeg = (solarAngle * 180) / Math.PI;\n  const x = solarSystemRadius * Math.sin(solarAngle);\n  const y = stretch * solarSystemRadius * Math.cos(solarAngle);\n  const spin = 180 + -location[0] + solarAngleDeg + 360 * ((hour + 12) / 24);\n  const earthGeo = { type: \"Sphere\" };\n  const projection = d3\n    .geoOrthographic()\n    .fitWidth(earthRadius * 2, earthGeo)\n    .rotate([spin, 0, 23.5])\n    .translate([0, 0]);\n  const staticProjection = d3\n    .geoOrthographic()\n    .fitWidth(earthRadius * 2, earthGeo)\n    .rotate([solarAngleDeg - 90, 0])\n    .translate([0, 0]);\n  const path = d3.geoPath(projection).pointRadius(1.5);\n  const staticPath = d3.geoPath(staticProjection);\n  const solarSystem = root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${width / 2})`);\n  solarSystem.append(\"circle\").attr(\"r\", sunRadius).attr(\"fill\", colors.sun);\n  /* Draw orbit */\n  solarSystem\n    .append(\"ellipse\")\n    .attr(\"rx\", solarSystemRadius)\n    .attr(\"ry\", stretch * solarSystemRadius)\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", \"black\");\n  /* Draw month ticks */\n  d3.range(12).map((m) =&gt; {\n    const d = new Date(date.getFullYear(), m, 1);\n    const angle = getSolarAngle(d);\n    solarSystem\n      .append(\"line\")\n      .attr(\"x1\", (solarSystemRadius + 6) * Math.sin(angle))\n      .attr(\"y1\", (solarSystemRadius + 6) * stretch * Math.cos(angle))\n      .attr(\"x2\", (solarSystemRadius - 6) * Math.sin(angle))\n      .attr(\"y2\", (solarSystemRadius - 6) * stretch * Math.cos(angle))\n      .attr(\"stroke\", \"black\");\n    const startMonthAngle = getSolarAngle(new Date(date.getFullYear(), m, 1));\n    solarSystem\n      .append(\"text\")\n      .text(date2doty(d))\n      .attr(\"x\", (solarSystemRadius + 18) * Math.sin(startMonthAngle))\n      .attr(\n        \"y\",\n        (solarSystemRadius + 18) * 1.18 * stretch * Math.cos(startMonthAngle)\n      )\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n      .attr(\"dominant-baseline\", \"middle\")\n      .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n      .attr(\"font-family\", \"sans-serif\")\n      .attr(\"fill\", \"black\");\n  });\n  const earth = solarSystem\n    .append(\"g\")\n    .attr(\"transform\", `translate(${x}, ${y})`);\n  earth\n    .append(\"line\")\n    .attr(\"y1\", -1.5 * earthRadius)\n    .attr(\"y2\", 1.5 * earthRadius)\n    .attr(\"stroke\", \"blue\")\n    .attr(\"transform\", `rotate(-23.5)`);\n  earth.append(\"path\").attr(\"d\", path(earthGeo)).attr(\"fill\", colors.ocean);\n  earth.append(\"path\").attr(\"d\", path(land)).attr(\"fill\", colors.land);\n  earth.append(\"path\")\n  .attr(\"d\", path(countries))\n  .attr(\"stroke-width\", \".075\")\n  .attr(\"fill\", \"none\")\n  .attr(\"stroke\", \"#555\");\n  const shadowPolygon = [\n    [0, -90],\n    [0, 0],\n    [0, 90],\n    [180, 0],\n    [0, -90]\n  ];\n  earth\n    .append(\"path\")\n    .attr(\"d\", staticPath({ type: \"Polygon\", coordinates: [shadowPolygon] }))\n    .attr(\"fill\", \"rgba(0, 0, 0, 0.5)\");\n  earth\n    .append(\"path\")\n    .attr(\"d\", path({ type: \"Point\", coordinates: location }))\n    .attr(\"r\", 18)\n    .attr(\"stroke-width\", .3)\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", \"red\");\n}\nfunction greg2doty(month = 1, day = 1) {\n    return Math.floor(\n        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5 + day - 1\n)}\nfunction date2doty(date) {\n  return greg2doty(date.getMonth() + 1, date.getDate())\n}\nfunction date2doty1(date) {\n  const doty = greg2doty(date.getMonth() + 1, date.getDate())\n  return doty === 31 ? \"Day \" + String(doty) : doty\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\nglobe = (root, { width, location, date, hour }) =&gt; {\n  const solarAngle = getSolarAngle(date);\n  const solarAngleDeg = toDegrees(solarAngle);\n  const hourSpin = 360 * ((hour + 12) / 24);\n  const spin = (180 + -location[0] + solarAngleDeg + hourSpin);\n  const tilt = -15;\n  const projection = d3.geoOrthographic()\n                       .fitWidth(width, graticule)\n                       .rotate([spin, tilt, 23.5]);\n  const path = d3.geoPath(projection);\n  const unClippedProjection = d3.geoOrthographic()\n                                .clipAngle(null)\n                                .fitWidth(width, graticule)\n                                .rotate([spin, tilt, 23.5]);\n  const unClippedPath = d3.geoPath(unClippedProjection);\n  const staticProjection = d3.geoOrthographic()\n                             .fitWidth(width, graticule)\n                             .rotate([solarAngleDeg - 90, tilt]);\n  const staticPath = d3.geoPath(staticProjection);\n  const background = root.append(\"g\");\n  const earth = root.append(\"g\").style(\"opacity\", 0.75);\n  const foreground = root.append(\"g\");\n  earth.append(\"path\")\n    .attr(\"d\", path({type: \"Sphere\"}))\n    .attr(\"fill\", colors.ocean)\n    .attr(\"stroke\", \"#9ecbda\");\n  earth.append(\"path\")\n    .attr(\"d\", path(land))\n    .attr(\"fill\", colors.land);\n  earth.append(\"path\")\n    .attr(\"d\", path(countries))\n    .attr(\"stroke-width\", \"1\")\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", \"#000\");\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath({type: \"Point\", coordinates: location}))\n    .attr(\"fill\", \"red\");\n  const latitudeCoords = (latitude, start, end) =&gt; {\n    const longitudes = d3.range(start, end, 2).concat(end);\n    return longitudes.map(d =&gt; [d, latitude]);\n  }\n  const correctSpin = d3.geoRotation([-hourSpin, 0]);\n  const correctTilt = d3.geoRotation([6, 0, 0]);\n  /* total angular extent of day/night */\n  const dayExtent = 360 * dayLength(date, location[1]) / 24;\n  const nightExtent = 360 - dayExtent;\n  const dayLine = {\n    type: \"LineString\",\n    coordinates: latitudeCoords(location[1],\n                                location[0] - dayExtent / 2,\n                                location[0] + dayExtent / 2).map(d =&gt; correctSpin(d))\n  };\n  const nightLine = {\n    type: \"LineString\",\n    coordinates: latitudeCoords(location[1],\n                                location[0] - dayExtent / 2 - nightExtent,\n                                location[0] - dayExtent / 2).map(d =&gt; correctSpin(d))\n  };\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath(dayLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.day)\n    .attr(\"stroke-width\", 3);\n  background.append(\"path\")\n    .attr(\"d\", unClippedPath(nightLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.night)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path(dayLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.day)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path(nightLine))\n    .attr(\"fill\", \"none\")\n    .attr(\"stroke\", colors.night)\n    .attr(\"stroke-width\", 3);\n  foreground.append(\"path\")\n    .attr(\"d\", path({type: \"Point\", coordinates: location}))\n    .attr(\"stroke-width\", .5)\n    .attr(\"stroke\", \"black\")\n    .attr(\"fill\", \"red\");\n  const shadowPolygon = [[0, -90], [0, 0], [0, 90], [180, 0], [0, -90]].map(d =&gt; correctTilt(d));\n  foreground.append(\"path\")\n    .attr(\"d\", staticPath({type: \"Polygon\", coordinates: [shadowPolygon]}))\n    .attr(\"fill\", \"rgba(0, 0, 0, 0.25)\");\n}\ndayOfYear = (date) =&gt; {\n  const yearStart = new Date(date.getFullYear(), 0, 1+60);\n  return Math.floor((date.getTime() - yearStart.getTime())/86400000) + 1\n}\n// https://observablehq.com/@dbridges/visualizing-seasonal-daylight\ndaylightPlot = (\n  root,\n  { width, height, year, latitude, defaultDate, defaultHour }\n) =&gt; {\n  const margin = { top: 24, bottom: 32, left: 48, right: 0 };\n  const chartWidth = width - margin.left - margin.right;\n  const chartHeight = height - margin.top - margin.bottom;\n  const xTickValues =\n    width &gt; 380 ? [3, 6, 9, 12, 15, 18, 21] : width &gt; 240 ? [6, 12, 18] : [12];\n  const xScale = d3\n    .scaleLinear()\n    .domain([0, 24])\n    .range([margin.left, margin.left + chartWidth])\n    .clamp(true);\n  // y-axis scale\n  const yScale = d3\n    .scaleTime()\n    .domain([new Date(year, 0, 1+60), new Date(year, 11, 31+60)])\n    .range([margin.top, margin.top + chartHeight])\n    .clamp(true);\n  // y-axis labels\n  const yAxis = d3\n    .axisLeft(yScale)\n    .tickValues(d3.timeMonth.range(new Date(year, 1, 1+60), new Date(year, 12, 1+57)))\n    .tickSize(chartWidth)\n    .tickFormat(date2doty1);\n  const xAxis = d3\n    .axisBottom(xScale)\n    .tickValues(xTickValues)\n    .tickSize(chartHeight)\n    .tickFormat((d) =&gt; {\n      return `${d / .024}`;\n    });\n  let date = defaultDate || new Date();\n  let hour = defaultHour != null ? defaultHour : date.getHours();\n  const handleMouseMove = (e) =&gt; {};\n  root\n    .append(\"rect\")\n    .attr(\"x\", margin.left)\n    .attr(\"y\", margin.top)\n    .attr(\"width\", chartWidth)\n    .attr(\"height\", chartHeight)\n    .attr(\"rx\", 0.05 * width)\n    .attr(\"fill\", colors.night);\n  root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left + chartWidth}, 0)`)\n    .call(yAxis)\n    .call((g) =&gt; g.select(\".domain\").remove())\n    .call((g) =&gt; g.selectAll(\".tick\").attr(\"color\", colors.grid))\n    //.call((g) =&gt; g.selectAll(\".tick text\").attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2)))\n    .call((g) =&gt; g.selectAll(\".tick text\").attr(\"color\", \"black\"))\n    .call((g) =&gt; g.selectAll(\".tick line\").attr(\"stroke-dasharray\", \"5 3\"));\n  root\n    .append(\"g\")\n    .attr(\"transform\", `translate(0, ${margin.top})`)\n    .call(xAxis)\n    .call((g) =&gt; g.select(\".domain\").remove())\n    .call((g) =&gt; g.selectAll(\".tick\").attr(\"color\", colors.grid))\n    //.call((g) =&gt; g.selectAll(\".tick text\").attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2)))\n    .call((g) =&gt; g.selectAll(\".tick text\").attr(\"color\", \"black\"))\n    .call((g) =&gt; g.selectAll(\".tick line\").attr(\"stroke-dasharray\", \"5 3\"));\n  root\n    .append(\"text\")\n    .text(\"Local Solar Time\")\n    .attr(\"x\", margin.left + chartWidth / 2)\n    .attr(\"y\", margin.top + chartHeight + margin.bottom - 2)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .attr(\"fill\", \"black\");\n  const data = yearDates(year)\n    .map((d) =&gt; [d, dayLength(d, latitude)])\n    .filter(([_, d]) =&gt; d &gt; 0);\n  /* Render separate polygons for each continuous sequence of\n   * days with more than 0 hours of day light\n   */\n  const polys = [];\n  let currentPoly = [];\n  for (let i = 0; i &lt; data.length; i++) {\n    const currentDate = data[i][0];\n    const prevDate = (data[i - 1] || [])[0];\n    if (\n      i === 0 ||\n      currentDate.getTime() - prevDate.getTime() &lt; 3600 * 24 * 1000 * 1.5\n    ) {\n      currentPoly.push(data[i]);\n    } else {\n      polys.push(currentPoly);\n      currentPoly = [data[i]];\n    }\n  }\n  polys.push(currentPoly);\n  polys.forEach((p) =&gt; {\n    const points = [\n      ...p.map(([d, l]) =&gt; `${xScale(12 - l / 2)},${yScale(d)}`),\n      ...p.reverse().map(([d, l]) =&gt; `${xScale(12 + l / 2)},${yScale(d)}`)\n    ].join(\" \");\n    root.append(\"polygon\").attr(\"points\", points).attr(\"fill\", colors.day);\n  });\n  /* Legend */\n  const legend = root\n    .append(\"g\")\n    .attr(\"transform\", `translate(${margin.left + chartWidth / 2 - 64})`);\n  legend\n    .append(\"rect\")\n    .attr(\"rx\", 5)\n    .attr(\"x\", -25)\n    .attr(\"y\", 6)\n    .attr(\"width\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"height\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"fill\", colors.night);\n  legend\n    .append(\"text\")\n    .attr(\"x\", -8)\n    .attr(\"y\", 19)\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .text(\"Nighttime\");\n  legend\n    .append(\"rect\")\n    .attr(\"x\", 58)\n    .attr(\"rx\", 5)\n    .attr(\"y\", 6)\n    .attr(\"width\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"height\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"fill\", colors.day);\n  legend\n    .append(\"text\")\n    .attr(\"x\", 75)\n    .attr(\"y\", 19)\n    .attr(\"font-size\", fontSize * (width &lt; 265 ? 1 : 1.2))\n    .attr(\"font-family\", \"sans-serif\")\n    .text(\"Daytime\");\n  /* Time and date controls */\n  const dateLine = root.append(\"g\");\n  const updateControlPositions = () =&gt; {\n    dateLine\n      .select(\"line\")\n      .attr(\"x1\", xScale(0))\n      .attr(\"y1\", yScale(date))\n      .attr(\"x2\", xScale(24))\n      .attr(\"y2\", yScale(date));\n    dateLine\n      .select(\"rect\")\n      .attr(\"x\", xScale(0))\n      .attr(\"y\", yScale(date) - 4);\n    root\n      .select(\"#time-control\")\n      .attr(\"cx\", xScale(hour))\n      .attr(\"cy\", yScale(date));\n  };\n  const dispatchDateHourChange = () =&gt; {\n    const detail = { date, hour };\n    const changeEvent = new CustomEvent(EventType.DateHourChange, {\n      detail,\n      bubbles: true\n    });\n    root.node().dispatchEvent(changeEvent);\n  };\n  const handleDateLineDrag = ({ y }) =&gt; {\n    date = yScale.invert(y);\n    updateControlPositions();\n    dispatchDateHourChange();\n  };\n  const handleTimeCircleDrag = ({ x }) =&gt; {\n    hour = xScale.invert(x);\n    updateControlPositions();\n    dispatchDateHourChange();\n  };\n  dateLine.append(\"line\").attr(\"stroke-width\", 4).attr(\"stroke\", \"red\");\n  dateLine\n    .append(\"rect\")\n    .attr(\"width\", chartWidth)\n    .attr(\"height\", 8)\n    .attr(\"fill\", \"rgba(0, 0, 0, 0)\")\n    .style(\"cursor\", \"row-resize\")\n    .call(d3.drag().on(\"drag\", handleDateLineDrag));\n  root\n    .append(\"circle\")\n    .attr(\"id\", \"time-control\")\n    .attr(\"r\", 12)\n    .attr(\"fill\", \"red\")\n    .attr(\"stroke-width\", .6)\n    .attr(\"stroke\", \"black\")\n    .style(\"cursor\", \"pointer\")\n    .call(d3.drag().on(\"drag\", handleTimeCircleDrag));\n  updateControlPositions();\n}\nfontSize = 12;\ngetSolarAngle = (date) =&gt; (dayOfYear(date) + 10) / 365 * Math.PI * 2 - Math.PI / 2;\n/*\n * Formulas uses the CBM model as reviewed here:\n * https://www.ikhebeenvraag.be/mediastorage/FSDocument/171/Forsythe+-+A+model+comparison+for+daylength+as+a+function+of+latitude+and+day+of+year+-+1995.pdf\n */\ndayLength = (date, latitude) =&gt; {\n  const yearStart = new Date(date.getFullYear(), 0, 1);\n  const dayOfYear = Math.floor((date.getTime() - yearStart.getTime())/86400000) + 1;\n  const revAngle = 0.2163108 + 2 * Math.atan(0.9671396 * Math.tan(0.00860 * (dayOfYear - 186)));\n  const decAngle = Math.asin(0.39795 * Math.cos(revAngle));\n  /* daylight coefficient selected for apparent sunrise/sunset */\n  const p = 0.8333\n  const intResult =\n    (Math.sin((p * Math.PI) / 180) +\n      Math.sin((latitude * Math.PI) / 180) * Math.sin(decAngle)) /\n    (Math.cos((latitude * Math.PI) / 180) * Math.cos(decAngle));\n  if (intResult &gt;= 1) return 24;\n  if (intResult &lt;= -1) return 0;\n  return 24 - 24 * Math.acos(intResult) / Math.PI;\n}\nyearDates = (year) =&gt; {\n  const startDate = new Date(year, 0, 1+60);\n  const endDate = new Date(year + 1, 0, 1+60);\n  return d3.timeDay.range(startDate, endDate);\n}\nheight = 0.65 * width;\nEventType = ({\n  LocationChange: \"LOCATION_CHANGE\",\n  DateHourChange: \"DATE_HOUR_CHANGE\"\n})\ncolors = ({\n  night: \"#719fb6\",\n  day: \"#ffe438\",\n  grid: \"#4b6a79\",\n  ocean: \"#adeeff\",\n  land: \"#f5f1dc\",\n  sun: \"#ffe438\"\n})\ntoRadians = (val) =&gt; val * Math.PI / 180\ntoDegrees = (val) =&gt; val * 180 / Math.PI;\nland = topojson.feature(world, world.objects.land);\nd3 = require(\"d3@7\", \"d3-geo-projection@3\")\nfunction input(config) {\n  let {\n    form,\n    type = \"text\",\n    attributes = {},\n    action,\n    getValue,\n    title,\n    description,\n    format,\n    display,\n    submit,\n    options\n  } = config;\n  const wrapper = html`&lt;div&gt;&lt;/div&gt;`;\n  if (!form)\n    form = html`&lt;form&gt;\n    &lt;input name=input type=${type} /&gt;\n  &lt;/form&gt;`;\n  Object.keys(attributes).forEach(key =&gt; {\n    const val = attributes[key];\n    if (val != null) form.input.setAttribute(key, val);\n  });\n  if (submit)\n    form.append(\n      html`&lt;input name=submit type=submit style=\"margin: 0 0.75em\" value=\"${\n        typeof submit == \"string\" ? submit : \"Submit\"\n      }\" /&gt;`\n    );\n  form.append(\n    html`&lt;output name=output style=\"font: 14px Menlo, Consolas, monospace; margin-left: 0.1em; text-align:center;\"&gt;&lt;/output&gt;`\n  );\n  if (title)\n    form.prepend(\n      html`&lt;div style=\"font: 700 0.9rem sans-serif; margin-bottom: 3px;\"&gt;${title}&lt;/div&gt;`\n    );\n  if (description)\n    form.append(\n      html`&lt;div style=\"font-size: 0.85rem; font-style: italic; margin-top: 3px;\"&gt;${description}&lt;/div&gt;`\n    );\n  if (format)\n    format = typeof format === \"function\" ? format : d3format.format(format);\n  if (action) {\n    action(form);\n  } else {\n    const verb = submit\n      ? \"onsubmit\"\n      : type == \"button\"\n      ? \"onclick\"\n      : type == \"checkbox\" || type == \"radio\"\n      ? \"onchange\"\n      : \"oninput\";\n    form[verb] = e =&gt; {\n      e && e.preventDefault();\n      const value = getValue ? getValue(form.input) : form.input.value;\n      if (form.output) {\n        const out = display ? display(value) : format ? format(value) : value;\n        if (out instanceof window.Element) {\n          while (form.output.hasChildNodes()) {\n            form.output.removeChild(form.output.lastChild);\n          }\n          form.output.append(out);\n        } else {\n          form.output.value = out;\n        }\n      }\n      form.value = value;\n      if (verb !== \"oninput\")\n        form.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n    };\n    if (verb !== \"oninput\")\n      wrapper.oninput = e =&gt; e && e.stopPropagation() && e.preventDefault();\n    if (verb !== \"onsubmit\") form.onsubmit = e =&gt; e && e.preventDefault();\n    form[verb]();\n  }\n  while (form.childNodes.length) {\n    wrapper.appendChild(form.childNodes[0]);\n  }\n  form.append(wrapper);\n  return form;\n}\nd3format = require(\"d3-format@1\")\n// https://observablehq.com/@enjalot/draggable-world-map-coordinates-input\nfunction worldMapCoordinates(config = {}, dimensions) {\n  const {\n    value = [], title, description, width = dimensions[0]\n  } = Array.isArray(config) ? {value: config} : config;\n  const height = dimensions[1];\n  let [lon, lat] = value;\n  lon = lon != null ? lon : null;\n  lat = lat != null ? lat : null;\n  const formEl = html`&lt;form style=\"width: ${width}px;\"&gt;&lt;/form&gt;`;\n  const context = DOM.context2d(width, height-width/13.2);\n  const canvas = context.canvas;\n  canvas.style.margin = `0px 0px -26px 0px`;\n  const projection = d3\n    .geoEquirectangular()\n    .precision(0.1)\n    .fitSize([width, height], { type: \"Sphere\" }).rotate([-153, 0]);\n  const path = d3.geoPath(projection, context).pointRadius(2.5);\n  formEl.append(canvas);\n  function draw() {\n    context.fillStyle = \"#fff\";\n    context.fillRect(0, 0, width, height);\n    context.beginPath(); path({type: \"Sphere\"});\n    context.fillStyle = colors.ocean; context.fill();\n    context.beginPath();\n    path(graticule);\n    context.lineWidth = 0.95;\n    context.strokeStyle = `#aaa`;\n    context.stroke();\n    context.beginPath();\n    path(land);\n    context.fillStyle = colors.land;\n    context.fill();\n    context.beginPath();\n    path(countries);\n    context.lineWidth = .95;\n    context.strokeStyle = `#000`;\n    context.stroke();\n    context.fillStyle = `#000`;\n    context.font = width &lt; 760 ? \"14px serif\" : width &lt; 990 ? \"17px serif\" : \"23px serif\";\n    d3.range(-1.5, 342 + 1, 36).map(x =&gt;  context.fillText(long2zone(x), ...projection([x, 84 - (width &lt; 400) * 3.6])));\n    d3.range(-1.5, 342 + 1, 36).map(x =&gt;  context.fillText(long2zone(x), ...projection([x, -66])));\n    context.beginPath(), path(night), context.fillStyle = \"rgba(0,0,255,0.1)\", context.fill();\n    context.beginPath(); path.pointRadius(17); path({type: \"Point\", coordinates: sun}); context.strokeStyle = \"#0008\"; context.fillStyle = \"#ff08\"; context.lineWidth = 1; context.stroke(); context.fill();\n    if (lon != null && lat != null) {\n      path.pointRadius(17); context.strokeStyle = \"black\";\n      context.beginPath(); path({type: \"Point\", coordinates: [lon, lat]}); context.lineWidth = 1; context.stroke();\n      context.lineWidth = 6;\n      path.pointRadius(14); context.strokeStyle = \"red\";\n      context.beginPath(); path({type: \"Point\", coordinates: [lon, lat]}); context.stroke();\n    }\n  }\n  let drag = d3.drag()\n    .on(\"drag\", (event) =&gt; {\n      let coords = projection.invert([event.x, event.y]);\n      lon = +coords[0].toFixed(2);\n      lat = +coords[1].toFixed(2);\n      draw();\n      canvas.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n    })\n  d3.select(canvas).call(drag)\n  canvas.onclick = function(ev) {\n    const { offsetX, offsetY } = ev;\n    let coords = projection.invert([offsetX, offsetY]);\n    lon = +coords[0].toFixed(2);\n    lat = +coords[1].toFixed(2);\n    draw();\n    canvas.dispatchEvent(new CustomEvent(\"input\", { bubbles: true }));\n  };\n  draw();\n  const form = input({\n    type: \"worldMapCoordinates\",\n    title,\n    description,\n    display: v =&gt; (width &gt; 400) ? html`&lt;div style=\"width: ${width}px; white-space: nowrap; color: #444; text-align: center; font: ${width / 50}px monospace; position: relative; top: -${width / 36}px;  margin-bottom: -.4em;\"&gt;\n            &lt;span style=\"color: #000;\"&gt;Zone:&lt;/span&gt; ${lon != null ? long2zone(lon) : \"\"}\n            &nbsp; &nbsp;\n            &lt;span style=\"color: #000;\"&gt;Longitude:&lt;/span&gt; ${lon != null ? (long2turn(lon)).toFixed(0) : \"\"}\n            &nbsp; &nbsp;\n            &lt;span style=\"color: #000;\"&gt;Latitude:&lt;/span&gt; ${lat != null ? ((lati2turn1(lat))).toFixed(0) : \"\"}\n          &lt;/div&gt;` : '',\n    getValue: () =&gt; [lon != null ? lon : null, lat != null ? lat : null],\n    form: formEl\n  });\n  return form;\n}\nsun = {\n  const now = new Date;\n  const day = new Date(+now).setUTCHours(0, 0, 0, 0);\n  const t = solar.century(now);\n  const longitude = (day - now) / 864e5 * 360 - 180;\n  return [longitude - solar.equationOfTime(t) / 4, solar.declination(t)];\n}\nnight = d3.geoCircle()\n    .radius(90)\n    .center(antipode(sun))\n  ()\nantipode = ([longitude, latitude]) =&gt; [longitude + 180, -latitude]\nsolar = require(\"solar-calculator@0.3/dist/solar-calculator.min.js\")\nviewof fancySecondsOFF = Inputs.toggle({\n  label: \"Ticking clock\",\n  value: false\n})\ndeclock = (selectedExact * 10).toFixed(4);\ndeclockM = (Math.abs(selectedExact - 1) * 10).toFixed(4);\nselected = `${declock}-${selectedZone}`\nselectedM = `${declockM}-${selectedZone}`\nselectedZone = selectedDote[1]\ndurations = [].concat(...nested)\nnested = Array.from({length: intervals.length}, (_, i) =&gt; ([\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1] !== intervals[i][0] ? intervals[i][0] : 1,\n  group: \"Rest\"\n},\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1]-intervals[i][0],\n  group: \"Work\"\n},\n  {\n  label: `${i} or ${i+5}`,\n  duration: intervals[i][1] !== intervals[i][0] ? 1-intervals[i][1] : null,\n  group: \"Rest\"\n  }]))\nschedules = [\n  [[.2, .8], [.2, .8], [0, 0], [0, 0], [0, 0]],\n  [[.3, .7], [.3, .7], [.3, .7], [0, 0], [0, 0]],\n  [[.35, .65], [.35, .65], [.35, .65], [.35, .65], [0, 0]],\n  [[.38, .62], [.38, .62], [.38, .62], [.38, .62], [.38, .62]],\n]\nset(viewof intervals, schedules[schedule-2])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction interval(range = [], options = {}) {\n  const [min = 0, max = 1] = range;\n  const {\n    step = .001,\n    label = null,\n    value = [min, max],\n    format = ([start, end]) =&gt; `${start} ‚Ä¶ ${end}`,\n    color,\n    width,\n    theme,\n  } = options;\n  const __ns__ = DOM.uid('scope').id;\n  const css = `\n#${__ns__} {\n  font: 13px/1.2 var(--sans-serif);\n  display: flex;\n  align-items: baseline;\n  flex-wrap: wrap;\n  max-width: 100%;\n  width: auto;\n}\n@media only screen and (min-width: 30em) {\n  #${__ns__} {\n    flex-wrap: nowrap;\n    width: 360px;\n  }\n}\n#${__ns__} .label {\n  width: 60px;\n  padding: 5px 0 4px 0;\n  margin-right: .5px;\n  flex-shrink: 0;\n}\n#${__ns__} .form {\n  display: flex;\n  width: 100%;\n}\n#${__ns__} .range {\n  flex-shrink: 1;\n  width: 100%;\n}\n#${__ns__} .range-slider {\n  width: 100%;\n}\n  `;\n  const $range = rangeInput({min, max, value: [value[0], value[1]], step, color, width, theme});\n  const $output = html`&lt;output&gt;`;\n  const $view = html`&lt;div id=${__ns__}&gt;\n${label == null ? '' : html`&lt;div class=\"label\"&gt;${label}`}\n&lt;div class=form&gt;\n  &lt;div class=range&gt;\n    ${$range}&lt;div class=range-output style=\"display: inline-block;\"&gt;${$output}&lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n${html`&lt;style&gt;${css}`}\n  `;\n  const update = () =&gt; {\n    const content = format([$range.value[0], $range.value[1]]);\n    if(typeof content === 'string') $output.value = content;\n    else {\n      while($output.lastChild) $output.lastChild.remove();\n      $output.appendChild(content);\n    }\n  };\n  $range.oninput = update;\n  update();\n  return Object.defineProperty($view, 'value', {\n    get: () =&gt; $range.value,\n    set: ([a, b]) =&gt; {\n      $range.value = [a, b];\n      update();\n    },\n  });\n}\nfunction rangeInput(options = {}) {\n  const {\n    min = 0,\n    max = 100,\n    step = 'any',\n    value: defaultValue = [min, max],\n    color,\n    width,\n    theme = theme_Flat,\n  } = options;\n  const controls = {};\n  const scope = randomScope();\n  const clamp = (a, b, v) =&gt; v &lt; a ? a : v &gt; b ? b : v;\n  const html = htl.html;\n  // Will be used to sanitize values while avoiding floating point issues.\n  const input = html`&lt;input type=range ${{min, max, step}}&gt;`;\n  const dom = html`&lt;div class=${`${scope} range-slider`} style=${{\n    color,\n    width: cssLength(width),\n  }}&gt;\n  ${controls.track = html`&lt;div class=\"range-track\"&gt;\n    ${controls.zone = html`&lt;div class=\"range-track-zone\"&gt;\n      ${controls.range = html`&lt;div class=\"range-select\" tabindex=0&gt;\n        ${controls.min = html`&lt;div class=\"thumb thumb-min\" tabindex=0&gt;`}\n        ${controls.max = html`&lt;div class=\"thumb thumb-max\" tabindex=0&gt;`}\n      `}\n    `}\n  `}\n  ${html`&lt;style&gt;${theme.replace(/:scope\\b/g, '.'+scope)}`}\n&lt;/div&gt;`;\n  let value = [], changed = false;\n  Object.defineProperty(dom, 'value', {\n    get: () =&gt; [...value],\n    set: ([a, b]) =&gt; {\n      value = sanitize(a, b);\n      updateRange();\n    },\n  });\n  const sanitize = (a, b) =&gt; {\n    a = isNaN(a) ? min : ((input.value = a), input.valueAsNumber);\n    b = isNaN(b) ? max : ((input.value = b), input.valueAsNumber);\n    return [Math.min(a, b), Math.max(a, b)];\n  }\n  const updateRange = () =&gt; {\n    const ratio = v =&gt; (v - min) / (max - min);\n    dom.style.setProperty('--range-min', `${ratio(value[0]) * 100}%`);\n    dom.style.setProperty('--range-max', `${ratio(value[1]) * 100}%`);\n  };\n  const dispatch = name =&gt; {\n    dom.dispatchEvent(new Event(name, {bubbles: true}));\n  };\n  const setValue = (vmin, vmax) =&gt; {\n    const [pmin, pmax] = value;\n    value = sanitize(vmin, vmax);\n    updateRange();\n    // Only dispatch if values have changed.\n    if(pmin === value[0] && pmax === value[1]) return;\n    dispatch('input');\n    changed = true;\n  };\n  setValue(...defaultValue);\n  // Mousemove handlers.\n  const handlers = new Map([\n    [controls.min, (dt, ov) =&gt; {\n      const v = clamp(min, ov[1], ov[0] + dt * (max - min));\n      setValue(v, ov[1]);\n    }],\n    [controls.max, (dt, ov) =&gt; {\n      const v = clamp(ov[0], max, ov[1] + dt * (max - min));\n      setValue(ov[0], v);\n    }],\n    [controls.range, (dt, ov) =&gt; {\n      const d = ov[1] - ov[0];\n      const v = clamp(min, max - d, ov[0] + dt * (max - min));\n      setValue(v, v + d);\n    }],\n  ]);\n  // Returns client offset object.\n  const pointer = e =&gt; e.touches ? e.touches[0] : e;\n  // Note: Chrome defaults \"passive\" for touch events to true.\n  const on  = (e, fn) =&gt; e.split(' ').map(e =&gt; document.addEventListener(e, fn, {passive: false}));\n  const off = (e, fn) =&gt; e.split(' ').map(e =&gt; document.removeEventListener(e, fn, {passive: false}));\n  let initialX, initialV, target, dragging = false;\n  function handleDrag(e) {\n    // Gracefully handle exit and reentry of the viewport.\n    if(!e.buttons && !e.touches) {\n      handleDragStop();\n      return;\n    }\n    dragging = true;\n    const w = controls.zone.getBoundingClientRect().width;\n    e.preventDefault();\n    handlers.get(target)((pointer(e).clientX - initialX) / w, initialV);\n  }\n  function handleDragStop(e) {\n    off('mousemove touchmove', handleDrag);\n    off('mouseup touchend', handleDragStop);\n    if(changed) dispatch('change');\n  }\n  invalidation.then(handleDragStop);\n  dom.ontouchstart = dom.onmousedown = e =&gt; {\n    dragging = false;\n    changed = false;\n    if(!handlers.has(e.target)) return;\n    on('mousemove touchmove', handleDrag);\n    on('mouseup touchend', handleDragStop);\n    e.preventDefault();\n    e.stopPropagation();\n    target = e.target;\n    initialX = pointer(e).clientX;\n    initialV = value.slice();\n  };\n  controls.track.onclick = e =&gt; {\n    if(dragging) return;\n    changed = false;\n    const r = controls.zone.getBoundingClientRect();\n    const t = clamp(0, 1, (pointer(e).clientX - r.left) / r.width);\n    const v = min + t * (max - min);\n    const [vmin, vmax] = value, d = vmax - vmin;\n    if(v &lt; vmin) setValue(v, v + d);\n    else if(v &gt; vmax) setValue(v - d, v);\n    if(changed) dispatch('change');\n  };\n  return dom;\n}\nfunction randomScope(prefix = 'scope-') {\n  return prefix + (performance.now() + Math.random()).toString(32).replace('.', '-');\n}\nfunction formatDecimal(number) {\n  return number == 1 ? number : (Math.round(number * 100) / 100).toString().slice(1)\n}\ncssLength = v =&gt; v == null ? null : typeof v === 'number' ? `${v}px` : `${v}`\ntheme_Flat = `\n/* Options */\n:scope {\n  color: #3b99fc;\n  width: 240px;\n}\n\n:scope {\n  position: relative;\n  display: inline-block;\n  --thumb-size: 15px;\n  --thumb-radius: calc(var(--thumb-size) / 2);\n  padding: var(--thumb-radius) 0;\n  margin: 2px;\n  vertical-align: middle;\n}\n:scope .range-track {\n  box-sizing: border-box;\n  position: relative;\n  height: 7px;\n  background-color: hsl(0, 0%, 80%);\n  overflow: visible;\n  border-radius: 4px;\n  padding: 0 var(--thumb-radius);\n}\n:scope .range-track-zone {\n  box-sizing: border-box;\n  position: relative;\n}\n:scope .range-select {\n  box-sizing: border-box;\n  position: relative;\n  left: var(--range-min);\n  width: calc(var(--range-max) - var(--range-min));\n  cursor: ew-resize;\n  background: currentColor;\n  height: 7px;\n  border: inherit;\n}\n/* Expands the hotspot area. */\n:scope .range-select:before {\n  content: \"\";\n  position: absolute;\n  width: 100%;\n  height: var(--thumb-size);\n  left: 0;\n  top: calc(2px - var(--thumb-radius));\n}\n:scope .range-select:focus,\n:scope .thumb:focus {\n  outline: none;\n}\n:scope .thumb {\n  box-sizing: border-box;\n  position: absolute;\n  width: var(--thumb-size);\n  height: var(--thumb-size);\n\n  background: #fcfcfc;\n  top: -4px;\n  border-radius: 100%;\n  border: 1px solid hsl(0,0%,55%);\n  cursor: default;\n  margin: 0;\n}\n:scope .thumb:active {\n  box-shadow: inset 0 var(--thumb-size) #0002;\n}\n:scope .thumb-min {\n  left: calc(-1px - var(--thumb-radius));\n}\n:scope .thumb-max {\n  right: calc(-1px - var(--thumb-radius));\n}\n`\nmove = {\n  d3.select(pentBar)\n    .select(\"div\")\n    .raise() // Places swatch below the plot\n    .style(\"float\", \"right\"); // Floats the swatch on the right.\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topReuseCC BY-SA 4.0CitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {Dec {Time}},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/dec/time},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúDec Time.‚Äù 2024. https://maptv.github.io/dec/time.",
    "crumbs": [
      "Dec",
      "Snap"
    ]
  },
  {
    "objectID": "dec/date/index.html",
    "href": "dec/date/index.html",
    "title": "Dec Date",
    "section": "",
    "text": "My website serves as a demonstration of both the Quarto publishing system and the Dec measurement system. I use several clever hacks to get Quarto to display all of the dates on my website in the Dec year+day format. Knowing the basics of Dec dates will help you to understand the articles on filter, script, and include files in the Quarto section of my site.\nAmong its many features, Quarto offers support for the Observable data analysis and visualization system. In the Observable calendarüóìÔ∏èplots below, Gregorian calendar months are identified by color and each day of the year has its own cell. Despite these similarities, the two plots illustrate how the Dec (top) and Gregorian (bottom) calendars differ.\n\nDay of year (doy)\nThe Dec calendar (Decalendar) starts on Day 0 instead of Day 306 and uses a single number called the day-of-year (doy), which is the day in year+day, to serve the same purpose as months and weeks in the Gregorian calendar. The current doy and the doy selected by the Observable rangeüéöÔ∏èinputs below to be highlighted in the calendarüóìÔ∏èplots are  and , respectively.\n\n\ndecPlot = Plot.plot({\n  padding: 0,\n  width: 1080,\n  height: 240,\n  className: \"calplot\",\n  marginTop: -3,\n  marginLeft: 31,\n  marginBottom: 35,\n  y: {tickSize: 0,\n      label: \"Day of dek    \",\n      domain: [-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9],\n      ticks: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],\n      tickPadding: -12,\n      labelOffset: 22,\n  },\n  x: {interval: 1, ticks: 18, label: \"Dek\", type: \"band\", tickSize: 0, tickPadding: -2, labelOffset: 32},\n  //fx: {tickFormat: \"\"},\n  style: { fontSize: \"21px\" },\n  color: {\n    range: d3.schemePastel1.concat(d3.schemePastel2.slice(4, 7)).concat(d3.schemeSet1[0]),\n    domain: months.concat(\"selected\"),\n    className: \"cal\",\n  },\n  marks: [\n    Plot.cell(dates, {\n      x: (d, i) =&gt; Math.floor(i / 10),\n      y: (d, i) =&gt; i % 10,\n      //fx: d =&gt; d.getUTCFullYear(),\n      fill: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"selected\" : months[d.getUTCMonth()],\n      stroke: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"darkorange\" : \"none\",\n      strokeWidth: 3,\n      inset: 0.5,\n    }),\n    Plot.text(dates, {\n      x: (d, i) =&gt; Math.floor(i / 10),\n      y: (d, i) =&gt; i % 10,\n      //fx: d =&gt; d.getUTCFullYear(),\n      text: d =&gt; d.getUTCDate() === 7 ? months[d.getUTCMonth()].slice(0, 3) : \"\",\n      y: -1,\n      frameAnchor: \"left\",\n      dy: -1,\n      monospace: true,\n      fontSize: \"18px\"}),\n    Plot.text(dates, {\n      x: (d, i) =&gt; Math.floor(i / 10),\n      y: (d, i) =&gt; i % 10,\n      //fx: d =&gt; d.getUTCFullYear(),\n      fill: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"white\" : \"black\",\n      //stroke: \"white\",\n      text: (d, i) =&gt; String(i),//.padStart(3, \"0\").slice(1),\n      monospace: true,\n      fontSize: \"13px\"})\n  ]\n})\n\n\n\n\n\n\n\ncalPlot = Plot.plot({\n  padding: 0,\n  width: 1000,\n  height: 200,\n  className: \"calplot\",\n  marginTop: 0,\n  marginBottom: 40,\n  marginLeft: 42,\n  y: {tickFormat: Plot.formatWeekday(\"en\", \"short\"), tickSize: 0,\n      domain: [-1, 0, 1, 2, 3, 4, 5, 6],\n      ticks: [0, 1, 2, 3, 4, 5, 6],\n      tickPadding: 2,\n  },\n  x: {interval: 1, ticks: 26, label: \"Week\", type: \"band\", tickSize: 0, tickPadding: 2, labelOffset: 36},\n  //fx: {tickFormat: \"\"},\n  style: { fontSize: \"20px\" },\n  color: {\n    range: d3.schemePastel1.concat(d3.schemePastel2.slice(4, 7)).concat(d3.schemeSet1[0]),\n    domain: months.concat(\"selected\"),\n    className: \"cal\",\n  },\n  marks: [\n    Plot.cell(datesCal, {\n      x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n      y: d =&gt; d.getUTCDay(),\n      //fx: d =&gt; d.getUTCFullYear(),\n      fill: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"selected\" : months[d.getUTCMonth()],\n      stroke: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"darkorange\" : \"none\",\n      strokeWidth: 3,\n      inset: .5,\n    }),\n    Plot.text(datesCal, {\n      x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n      y: d =&gt; d.getUTCDay(),\n      //fx: d =&gt; d.getUTCFullYear(),\n      text: d =&gt; d.getUTCDate() === 7 ? months[d.getUTCMonth()].slice(0, 3) : \"\",\n      y: -1,\n      frameAnchor: \"left\",\n      dy: -1,\n      monospace: true,\n      fontSize: \"18px\"}),\n    Plot.text(datesCal, {\n      x: d =&gt; d3.utcWeek.count(d3.utcYear(d), d),\n      y: d =&gt; d.getUTCDay(),\n      //fx: d =&gt; d.getUTCFullYear(),\n      fill: d =&gt; Math.floor(unix2doty(d.getTime())) === dotyInput ? \"white\" : \"black\",\n      //stroke: \"white\",\n      text: d =&gt; d.getUTCDate(), //Math.floor(unix2doty(d.getTime())).toString().padStart(3, \"0\"),\n      monospace: true,\n      fontSize: \"13px\"})\n  ]\n})\n\n\n\n\n\n\n\n\nviewof dotyInput = Inputs.range([0, 364 + leapInput], {value: 306, step: 1, label: \"Day of year\"});\nviewof monthInput = transformInput(\n  Inputs.range([1, 12], {step: 1, label: \"Month\"}),\n  {bind: viewof dotyInput, transform: doty2month, invert: month2doty}\n);\nviewof dotyInput1 = transformInput(\n  Inputs.range([-365 - leapInput, -1], {step: 1, label: \"Day of year\"}),\n  {bind: viewof dotyInput, transform: subN, invert: addN}\n);\nviewof dotmInput = transformInput(\n  Inputs.range([1, 31], {step: 1, label: \"Day of month\"}),\n  {bind: viewof dotyInput, transform: doty2dotm, invert: (x =&gt; Math.floor(( 153 * (\n    viewof monthInput.value &gt; 2\n    ? viewof monthInput.value - 3\n    : viewof monthInput.value + 9) + 2\n  ) / 5 + x - 1\n))});\nviewof leapscrub = Inputs.form([\n  Scrubber(numbers, {autoplay: false, alternate: true, delay: 86.4, loopDelay: 864, format: y =&gt; \"\", inputStyle: \"display:none;\"}),\n  Inputs.toggle({label: \"Leap year\", value: false}),\n])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFirst day of the Gregorian calendar year\n\nviewof dotwInput = Inputs.radio([\n  \"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\",\n  ], {value: \"Sunday\"})\n\n\n\n\n\n\nThere are two rangeüéöÔ∏èinputs labeled as ‚Äúday of year‚Äù because every doy can be expressed as both a positive and a negative number. The typical range for doys is 0 to n-1, but negative doys typically range from -n to -1, where n is the number of days in the year. A doy outside these bounds represents a day in a previous or subsequent year.\nThe Play‚ñ∂Ô∏èbutton above cyclesüîÑthrough every doy, month, and day-of-month (dom) so that each day gets its turn to be highlighted with a redüü•background. Both calendarüóìÔ∏èplots are affected by the toggle‚úÖinput, which determines whether n is 365 or 366, but only the bottom plot reacts to the radioüîòinput, which sets the first day-of-week (dow) of the Gregorian calendar year.\nThe toggle‚úÖinput shifts 306 dates, Day 0 to Day 305, in the Gregorian calendar by one day, but does not change the order of any Dec dates, because leap day (Day 365) is the last day of Dec leap years and the doy resets to zero at the start of every year. The radioüîòinput shifts every Gregorian calendar date by 1 to 6 days, but has no effect on Decalendar whatsoever.\nThe current doy, , consists of the current dek, , and day-of-dek (dod), . Deks are groups of 10 days that are well-aligned with the Dec year. Every Dec year starts on Day 0, the first day of the first dek of the year, Dek 0. Common years end on Day 364, exactly halfway through Dek 36, whereas leap years end on the sixth dod, Dod 5, of Dek 36: Day 365.\n\n\nDay of era (doe)\nIn contrast to weeks in the Gregorian calendar, doys and deks do not need to continue in an unbroken sequence. The last day of the year, Day -1, is always followed by Day 0, regardless of the last 4 or 5 days of Dek 36 that extend past the end of the year. If we want to track days seamlessly across years, we can use a continuous count of days called the day-of-era (doe).\nA doe is essentially a Julian day with a different epoch. We can convert a Julian day in a doe by subtracting 1721119.5 days to shift the epoch from -4713+268.5 to 0000+000.0. To turn a UNIX timestamp into a doe, we divide by 86400 to convert seconds to days and then add 719468.0 to account for the fact that the UNIX epoch is 1969+306.0.\nDec uses does for calculations, such as finding the POSIX Sunday-based dow of a given date. This year, the dow of ChristmasüéÑis , according to the Dec dow equation: ( + 3) mod 7 = . In contrast to the dow, finding the dod of a given Dec date does not require any calculations because the dod is simply the last digit of the integer part of the doy.\n\n\n\n\n\n\nBad Pun Alert\n\n\n\nDek the halls with dows of holly! Fa + la √ó 8!\n\n\nChristmasüéÑis a fixed holiday because it occurs on the same doy, Day 299, every year. Unlike fixed holidays, Gregorian calendar floating holidays happen on a different doy every year so that their dow can remain constant. Dec uses the dow delta equation, wŒî = (wM - wS + 7) mod 7, to determine which of the seven possible floating holiday dates corresponds to the given year.\nIn the dow delta equation, wM is the minuend dow at which we want to arrive and wS is subtrahend dow from which we start. To get the doy of Thanksgivingü¶Éin the United States and Brazil, we plug 4 as wM and , the dow of Day 266 this year, as wS into the dow delta equation,  = (4 -  + 7) mod 7, and then add the resulting wŒî to 266:  =  + 266.\nApart from the dow and dow delta equations, the Thanksgivingü¶Écalculation above relies on the Dec doe equation, which is based on the days_from_civil algorithm created by Howard Hinnant and described in his manuscript entitled chrono-Compatible Low-Level Date Algorithms, to convert the cycle-of-era (coe), year-of-cycle (yoc), and doy of Day 266 into its doe:\n\\[\\text{coe} = \\Biggl \\lfloor \\frac{\\begin{cases}\\text{year}&{\\text{if } \\text{year} \\geq 0;}\\\\\\text{year}-399&{\\text{otherwise.}}\\end{cases}}{400} \\Biggr \\rfloor\\]\n\\[\\text{yoc} = \\text{year} - \\text{coe} \\times 400\\]\n\n\\[\\text{doe} = \\text{coe}\\times146097 + \\text{yoc}\\times365 + \\lfloor\\frac{\\text{yoc}}{4}\\rfloor - \\lfloor\\frac{\\text{yoc}}{100}\\rfloor + \\text{doy}\\]\n\nThe Dec date equations, the inverseüîÅof the Dec doe equation above, are based on Howard Hinnant‚Äôs days_from_civil algorithm and is useful for obtaining Dec dates from does and doe analogs like Unix timestamps and Julian days. Apart from coe and yoc, the Dec date equations use the day-of-cycle (doc) of a doe to produce the doe‚Äôs corresponding year and doy:\n\\[\\text{coe} = \\Biggl \\lfloor \\frac{\\begin{cases}\\text{doe}&{\\text{if } \\text{doe} \\geq 0;}\\\\\\text{doe}-146096&{\\text{otherwise.}}\\end{cases}}{146097} \\Biggr \\rfloor\\]\n\\[\\text{doc} = \\text{doe} - \\text{coe} \\times 146097\\]\n\\[\\text{yoc} = \\biggl \\lfloor \\frac{\\text{doc} - \\lfloor \\frac{\\text{doc}}{1460} \\rfloor + \\lfloor \\frac{\\text{doc}}{36524} \\rfloor - \\lfloor \\frac{\\text{doc}}{146096} \\rfloor}{365} \\biggr \\rfloor\\]\n\\[\\text{year} = \\text{yoc} + \\text{coe} \\times 400\\]\n\\[\\text{doy} = \\text{doc} - \\text{yoc} \\times 365 - \\lfloor \\frac{\\text{yoc}}{4} \\rfloor + \\lfloor \\frac{\\text{yoc}}{100} \\rfloor\\]\nDates generated by the Dec date equations are guaranteed to be in the standard year+day format. Therefore, we can standardize Dec dates by performing a round-trip date-to-doe-to-date conversion using the Dec doe and date equations consecutively. This allows Dec to handle Dec dates with a non-integer year and a day outside the typical range of 0 ‚â§ day ‚â§ 365.\n\n\nYear of era (yoe)\nA doe is essentially a Dec date with a year that is always equal to 0 and a day that is unbounded. Similarly, a Dec year-of-era (yoe) is basically a Dec with a non-integer year and a day permanently set to 0. Both does and yoes allow us to represent a date as a single number and obtain the difference between two dates, either in days (dM - dS) or years (yM - yS).\nCompared to does, yoes are easier to turn into Dec dates. We can convert dates to yoes and vice versa with the Dec yoe equation: y = ‚åäy‚åã + d √∑ n. In the Dec yoe equation, y is the yoe, ‚åäy‚åã + d is the Dec date, ‚åäy‚åã is the year, d is the doy, and n is the number of days in Year ‚åäy‚åã. The current yoe equation values are  =  +  √∑ .\nDec dates do not include n, because it is not needed to specify a date, remains constant for 366, 1095, or 2920 days, has only 2 possible values: 366 if ‚åäy‚åã+1 is a Gregorian calendar leap year and 365 if ‚åäy‚åã+1 is a Gregorian calendar common year, and can be determined by applying the Gregorian calendar leap year rule to ‚åäy‚åã+1, as shown in the Dec year length equation:\n\\[\\text{n}=\\begin{cases}\n  366&{\\begin{align}\\text{if } (\\lfloor \\text{y}\\rfloor+1)\\text{ mod }\\ \\ \\ \\ 4=0\\\\\n  \\href{https://en.wikipedia.org/wiki/Logical_conjunction}{\\land}(\\lfloor \\text{y}\\rfloor+1)\\text{ mod }100\\neq0\\\\\n  \\href{https://en.wikipedia.org/wiki/Logical_disjunction}{\\lor}(\\lfloor \\text{y}\\rfloor+1)\\text{ mod }400=0\\end{align}}\\\\\\\\\n  365&{\\text{otherwise.}}\\end{cases}\\]\nApart from its role in the Dec date and doy equations, n is needed to convert between year+day and year-day Dec dates. The year-day version of the Dec yoe equation is ‚åäy‚åã+1+(d-n)√∑n=y. In essence, d-n is a ‚ÄúT-minus‚Äù countdown of the days until the start of Year ‚åäy‚åã+1. The current year-day date, -, tells us that Year  will begin in  days.\nThe distinction between d and d-n can also be explained in terms of computer programming. If we think of years as arrays, d and d-n are like array indexes that can be used to identify array elements or combine them into groups via slicing. In this analogy, n is the number of elements in the array, d is a positive index, and d-n is a negative index.\nThe yoe equation can be rearranged into the Dec doy equation, d = ‚åäy mod 1 √ó n‚åã, where y mod 1 is the decimal part of y. The current doy equation values are  = ‚åä √ó ‚åã. We can refer to a doy without a year as a floating date and a year+day date as a fixed date. Unlike other types of dates, floating dates do not specify the year and thus can apply to any year.\nFixed dates are essentially unsimplified math expressions. Dec uses unsimplified math expressions to display information about a date, such as its doy d or POSIX dow w. Essentially, you can modify a Dec date to show whatever numbersüî¢you want. All it takes is a little bit of arithmetic! This incredible versatility is possible thanks to the mathematical basis of Dec date notation.\n\n\nDay of week (dow)\nEven though Dec uses deks instead of weeks, Dec dates can be modified to include POSIX Sunday-based dows. Instead of the current Dec date, +, the navigation bar (navbar) of my site displays the current Dec dow date, +, by splitting the current doy, , into the doy of the first day of the current week (Dow 0 doy), , and the current POSIX dow: .\nInstead of the doy d, Dec dow dates display d-w+w, where d-w is the dow 0 doy and w is the dow associated with d. We evaluate the subtraction, d-w, to obtain the Dow 0 doy, but leave the addition unsimplified so we can see w. Dec dow dates supply all of the information needed to identify specific dates and coordinate schedules based on deks or weeks.\nDec dates can be further modified to include POSIX week numbers: +7√ó+. The current week number, , is the sum of the Dow 0 doy, , and the first dow of the year (Day 0 dow), , divided by 7:  = ( + ) √∑ 7. The current Dec floating week date, 7√ó+, is therefore equal to the sum of the current doy and the Day 0 dow: 7 √ó  +  =  + .\nDec week dates turn d-w into 7√óW-w0, where W is the week number and w0 is the Day 0 dow. In this case, the subtraction is omitted, because w0 is not necessary to identify a date and can be calculated from a given y by flooring it, turning it into a doe, and passing it into the dow equation. POSIX week numbers may be useful for week-based accountingüßæ.\nFollowing the Dec week date pattern described above, we can base Dec dates on any fixed-length calendar unit, including the 20-day dudek, 30-day tridek, 40-day kvardek, or 73-day sepdektri. No other calendar unit can be as convenient as the 10-day dek, because our decimal numeral system allows us to naturally combine a dek, , and dod, , into a doy: .\n\n\nDay of month (dom)\nDec dates can also be modified to display Dec month and POSIX dom numbers. The current Dec dom date is ++. Dec dom dates represent each month with the last doy of the previous month because POSIX doms start from one instead of zero. For zero-based doms, we represent each month with its first doy: ++.\nDec dom dates replace the doy d from Dec dates with d-m+m. We evaluate the subtraction to get d-m, the Dec month number, but not the addition, so we can see m, the dom. If we combine the dom and dow patterns above, we can create hybrid Dec dates: +++, where  is d-m-w, the doy of the last Dow 0 before the beginning of the month.\nWe can obtain Dec month numbers using only a pair of handsü§≤by counting index‚òùÔ∏èand ringüíçfingers as 30 days and other fingers as 31 days. For zero-based doms, we start counting from 0. For one-based doms, we start counting from -1, as shown in the image below. To spread 12 months across 10 fingers, the first and last fingers each represent 2 months.\n\n\n    \n        \n            \n            \n        \n        \n            \n                \n                \n            \n        \n\n\n\n \n  Adobe PDF library 6.66\n \n\n \n \n\n \n \n\n \n  2010-03-06T19:45:34Z\n  2008-03-27T12:07:11+01:00\n  Illustrator\n  2008-03-27T16:40:58+01:00\n  \n   \n    \n     JPEG\n     256\n     160\n     /9j/4AAQSkZJRgABAgEASABIAAD/7QAsUGhvdG9zaG9wIDMuMAA4QklNA+0AAAAAABAASAAAAAEA\nAQBIAAAAAQAB/+4ADkFkb2JlAGTAAAAAAf/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAoKCwoK\nDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwbGxscHx8fHx8fHx8fHwEHBwcNDA0YEBAYGhURFRofHx8f\nHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8f/8AAEQgAoAEAAwER\nAAIRAQMRAf/EAaIAAAAHAQEBAQEAAAAAAAAAAAQFAwIGAQAHCAkKCwEAAgIDAQEBAQEAAAAAAAAA\nAQACAwQFBgcICQoLEAACAQMDAgQCBgcDBAIGAnMBAgMRBAAFIRIxQVEGE2EicYEUMpGhBxWxQiPB\nUtHhMxZi8CRygvElQzRTkqKyY3PCNUQnk6OzNhdUZHTD0uIIJoMJChgZhJRFRqS0VtNVKBry4/PE\n1OT0ZXWFlaW1xdXl9WZ2hpamtsbW5vY3R1dnd4eXp7fH1+f3OEhYaHiImKi4yNjo+Ck5SVlpeYmZ\nqbnJ2en5KjpKWmp6ipqqusra6voRAAICAQIDBQUEBQYECAMDbQEAAhEDBCESMUEFURNhIgZxgZEy\nobHwFMHR4SNCFVJicvEzJDRDghaSUyWiY7LCB3PSNeJEgxdUkwgJChgZJjZFGidkdFU38qOzwygp\n0+PzhJSktMTU5PRldYWVpbXF1eX1RlZmdoaWprbG1ub2R1dnd4eXp7fH1+f3OEhYaHiImKi4yNjo\n+DlJWWl5iZmpucnZ6fkqOkpaanqKmqq6ytrq+v/aAAwDAQACEQMRAD8A9KaVpWlnS7MmzgJMEdT6\nafyD2xVFfonSv+WKD/kUn9MVd+idK/5YoP8AkUn9MVd+idK/5YoP+RSf0xV36J0r/lig/wCRSf0x\nV36J0r/lig/5FJ/TFXfonSv+WKD/AJFJ/TFXfonSv+WKD/kUn9MVd+idK/5YoP8AkUn9MVd+idK/\n5YoP+RSf0xV5L/zjFaWl1+Wjy3MMc8v6Uvl5yqHagl2FWB6Yq9a/ROlf8sUH/IpP6Yq79E6V/wAs\nUH/IpP6Yq79E6V/yxQf8ik/pirv0TpX/ACxQf8ik/pirv0TpX/LFB/yKT+mKu/ROlf8ALFB/yKT+\n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\n    \n   \n  \n \n\n \n  uuid:db0c57f4-dad3-11dc-b3c0-003065732f80\n \n\n \n  image/svg+xml\n  \n   \n    keyboard.ai\n   \n  \n \n\n\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \n            \n        \n        \n    May60June91July121August152September183October213November244December274January305February336March-1April30\nThe fingerüñêmnemonic described above is similar to the knuckleüëäand musical keyboardüéπmnemonics. These mnemonics attempt to make sense of the irregular pattern of month lengths in the Gregorian calendar. As opposed to months, we do not need mnemonics, tables, or mental calculations to use deks, because all of the required information is plainly visible in the doy.\n\n\nTime of day (tod)\nIn addition to the dek and dod, doys can also provide the time-of-day (tod). The dek, dod, and tod are all just different parts of the doy. If we floor a doy, ‚åäd‚åã, we get its integer part, which is a floating date that provides the dek and dod, and if we obtain the remainder after dividing a doy or a doe by 1, d mod 1, we get its decimal part, which is a tod.\nThe combination of a tod and a Dec time zone z is called a Dec time: .tod-z. Dec times can be appended to Dec dates to form timestamps called Dec snaps: year+day.tod-z. The Dec timestamp on the left side of the navbar of my site multiplies the tod by 10 so it is in the same deciday units as the time zone: .\nAfter reading this article, you should be able to understand the examples in the filter, script, and include articles in the Quarto section of my site. To see the full extent of the benefits that Decalendar can provide, you should continue on through the Dec section of my site to the time, ISO 8601, snap, and span articles.\n\n\nCite\nThank you for your interest in Dec.¬†You will find citation information for this article below. Please note that the original source of the algorithms underlying the conversion of Dec year+day dates and does is Hinnant, Howard. 2021+184. ‚Äúchrono-Compatible Low-Level Date Algorithms.‚Äù +. https://howardhinnant.github.io/date_algorithms.html.\n\nunix = {\n  while(true) {\n    yield Date.now();\n  }\n}\n// http://howardhinnant.github.io/date_algorithms.html#civil_from_days\nfunction unix2dote(unix, zone, offset = 719468) {\n  return [(unix ?? Date.now()) / 86400000 + (\n    zone = zone ?? -Math.round(\n      (new Date).getTimezoneOffset() / 144)\n    ) / 10 + offset, zone]\n}\nfunction dote2date(dote, zone = 0) {\n  const cote = Math.floor((\n      dote &gt;= 0 ? dote\n      : dote - 146096\n    ) / 146097),\n  dotc = dote - cote * 146097,\n  yotc = Math.floor((dotc\n    - Math.floor(dotc / 1460)\n    + Math.floor(dotc / 36524)\n    - Math.floor(dotc / 146096)\n  ) / 365);\n  return [\n    yotc + cote * 400,\n    dotc - (yotc * 365\n      + Math.floor(yotc / 4)\n      - Math.floor(yotc / 100)\n  ), zone]}\nfunction doty2deco0(year = 1969, doty = 306, zone = 0) {\n  return `${year.toString().padStart(4, \"0\")}+${Math.floor(doty).toString().padStart(3, \"0\")}${String(doty % 1 * 10).slice(0, 6)}-${zone}`\n}\nfunction dotw2diff(x, y) {\n  return (x - y + 7) % 7;\n}\ndz = unix2dote(unix)\nydz = dote2date(...dz)\ndeco = doty2deco0(...ydz)\nfunction year2leap(year = 1970) {\n  return year % 4 == 0 && year % 100 != 0 || year % 400 == 0;\n}\nfunction dote2dotw(d = 719468) {\n  return d &gt;= -3 ? (d + 3) % 7 : (d + 4) % 7 + 6\n}\ndecoYear = deco.slice(0, 4)\nnextYear = parseInt(decoYear) + 1\ndecoDoty = deco.slice(5, 8)\nxmasDote = date2dote(ydz[0], 299)[0]\nxmasDotw = dote2dotw(xmasDote)\ndotw = Math.floor(dote2dotw(dz[0]))\nday266dotw = dote2dotw(date2dote(ydz[0], 266)[0])\nday266dotwDiff = dotw2diff(4, day266dotw)\nweek = Math.floor((ydz[1] + doty0dotw) / 7)\ndotm = doty2dotm(Math.floor(ydz[1]))\ndotm0 = String(dotm - 1).padStart(2, \"0\")\ndotm1 = dotm.toString().padStart(2, \"0\")\nmonthNumber = Math.floor(ydz[1] - dotm)\nmonthNumber0 = String(monthNumber + 1).padStart(3, \"0\")\nmonthNumber1 = monthNumber.toString().padStart(3, \"0\")\ndotw0doty = Math.floor(ydz[1]) - dotw\ndoty0dote = date2dote(ydz[0], 0, ydz[2])\ndoty0dotw = dote2dotw(...doty0dote)\ndotw0sign = dotw0doty &lt; 0 ? \"-\" : \"+\"\ndecidayTime = (dz[0] % 1 * 10).toFixed(4)\nzone = dz[1]\nzoneSign = zone &lt; 0 ? \"+\" : \"-\"\nnDaysInYear = 365 + year2leap(ydz[0] + 1)\nTminus = nDaysInYear - decoDoty\nfracYear = ydz[0] + ydz[1] / nDaysInYear\nfullfracYear = (fracYear).toFixed(4)\nmod1FracYear = (fracYear % 1).toFixed(4)\nmonths = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\nmonthNums = [\"305\", \"336\", \"\", \"31\", \"61\", \"92\", \"122\", \"153\", \"184\", \"214\", \"245\", \"275\"];\ntoday = new Date()\nmonthName = today.toLocaleString('default', { month: 'long' });\nmonthNumJS = today.getMonth();\ncurrMonth = monthNums[monthNumJS]\nnextMonth = monthNums[(monthNumJS + 1) % 12]\ndekStart = Math.floor(decoDoty / 10) * 10\ndiff = parseInt(currMonth || 0) - parseInt(nextMonth || nDaysInYear)\n  //currMonth === \"\" ? 0 : parseInt(currMonth) - nextMonth === \"\" ? nDaysInYear : parseInt(nextMonth)\n// https://observablehq.com/@juang1744/transform-input/1\ntransformInput = function(target, {bind: source, transform = identity, involutory = false, invert = involutory ? transform : inverse(transform)} = {}){\n  if (source === undefined) {\n    source = target;\n    target = html`&lt;div&gt;${source}&lt;/div&gt;`;\n  }\n  function sourceInputHandler() {\n    target.removeEventListener(\"input\", targetInputHandler);\n    setTransform(target).to(transform(source.value)).andDispatchEvent();\n    target.addEventListener(\"input\", targetInputHandler);\n  }\n  function targetInputHandler() {\n    source.removeEventListener(\"input\", sourceInputHandler);\n    setTransform(source).to(invert(target.value)).andDispatchEvent();\n    source.addEventListener(\"input\", sourceInputHandler);\n  }\n  source.addEventListener(\"input\", sourceInputHandler);\n  target.addEventListener(\"input\", targetInputHandler);\n  invalidation.then(() =&gt; {\n    source.removeEventListener(\"input\", sourceInputHandler);\n    target.removeEventListener(\"input\", targetInputHandler);\n  });\n  sourceInputHandler();\n  return target;\n}\nsetTransform = (input) =&gt; ({to: (value) =&gt; (input.value = value, {andDispatchEvent: (event = new Event(\"input\")) =&gt; input.dispatchEvent(event)})});\nfunction inverse(f) {\n  switch (f) {\n    case identity:  return identity;\n    case Math.sqrt: return square;\n    case Math.log:  return Math.exp;\n    case Math.exp:  return Math.log;\n    default:        return (x =&gt; solve(f, x, x));\n  }\n  function solve(f, y, x = 0) {\n    const dx = 1e-6;\n    let steps = 100, deltax, fx, dfx;\n    do {\n      fx = f(x)\n      dfx = (f(x + dx) - fx) || dx;\n      deltax = dx * (fx - y)/dfx\n      x -= deltax;\n    } while (Math.abs(deltax) &gt; dx && --steps &gt; 0);\n    return steps === 0 ? NaN : x;\n  }\nfunction square(x) {\n    return x * x;\n  }\n}\nfunction identity(x) {\n  return x;\n}\nfunction doty2month(doty = 0) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return Math.floor(m &lt; 10 ? m + 3 : m - 9);\n}\nfunction month2doty(month = 1) {\n    return Math.floor(\n        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5\n)}\nfunction doty2dotm(doty = 0) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return doty - Math.floor((153 * m + 2) / 5) + 1;\n}\nnumbers = Array.from({length: 366}, (_, i) =&gt; i)\nset(viewof dotyInput, leapscrub[0])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction set(input, value) {\n  input.value = value;\n  input.dispatchEvent(new Event(\"input\", {bubbles: true}));\n}\n// https://observablehq.com/@mbostock/scrubber\nfunction Scrubber(values, {\n  format = value =&gt; value,\n  initial = 0,\n  direction = 1,\n  delay = null,\n  autoplay = true,\n  loop = true,\n  loopDelay = null,\n  alternate = false,\n  inputStyle = \"\"\n} = {}) {\n  values = Array.from(values);\n  const form = html`&lt;form style=\"font: 18px var(--monospace); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;\"&gt;\n  &lt;button name=b type=button style=\"margin-right: 0.4em; width: 5em;\"&gt;&lt;/button&gt;\n  &lt;label style=\"display: flex; align-items: center;\"&gt;\n    &lt;input name=i type=range min=0 max=${values.length - 1} value=${initial} step=1 style=${inputStyle}&gt;\n    &lt;output name=o style=\"margin-left: 0.4em;\"&gt;&lt;/output&gt;\n  &lt;/label&gt;\n&lt;/form&gt;`;\n  let frame = null;\n  let timer = null;\n  let interval = null;\n  function start() {\n    form.b.textContent = \"Stop\";\n    if (delay === null) frame = requestAnimationFrame(tick);\n    else interval = setInterval(tick, delay);\n  }\n  function stop() {\n    form.b.textContent = \"Play\";\n    if (frame !== null) cancelAnimationFrame(frame), frame = null;\n    if (timer !== null) clearTimeout(timer), timer = null;\n    if (interval !== null) clearInterval(interval), interval = null;\n  }\n  function running() {\n    return frame !== null || timer !== null || interval !== null;\n  }\n  function tick() {\n    if (form.i.valueAsNumber === (direction &gt; 0 ? values.length - 1 : direction &lt; 0 ? 0 : NaN)) {\n      if (!loop) return stop();\n      if (alternate) direction = -direction;\n      if (loopDelay !== null) {\n        if (frame !== null) cancelAnimationFrame(frame), frame = null;\n        if (interval !== null) clearInterval(interval), interval = null;\n        timer = setTimeout(() =&gt; (step(), start()), loopDelay);\n        return;\n      }\n    }\n    if (delay === null) frame = requestAnimationFrame(tick);\n    step();\n  }\n  function step() {\n    form.i.valueAsNumber = (form.i.valueAsNumber + direction + values.length) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", {bubbles: true}));\n  }\n  form.i.oninput = event =&gt; {\n    if (event && event.isTrusted && running()) stop();\n    form.value = values[form.i.valueAsNumber];\n    form.o.value = format(form.value, form.i.valueAsNumber, values);\n  };\n  form.b.onclick = () =&gt; {\n    if (running()) return stop();\n    direction = alternate && form.i.valueAsNumber === values.length - 1 ? -1 : 1;\n    form.i.valueAsNumber = (form.i.valueAsNumber + direction) % values.length;\n    form.i.dispatchEvent(new CustomEvent(\"input\", {bubbles: true}));\n    start();\n  };\n  form.i.oninput();\n  if (autoplay) start();\n  else stop();\n  Inputs.disposal(form).then(stop);\n  return form;\n}\ncalYear = !leapInput && dotwInput == \"Monday\" ? 6 : !leapInput && dotwInput == \"Tuesday\" ? 7 : !leapInput && dotwInput == \"Wednesday\" ? 2 : !leapInput && dotwInput == \"Thursday\" ? 3 : !leapInput && dotwInput == \"Friday\" ? 9 : !leapInput && dotwInput == \"Saturday\" ? 10 : !leapInput && dotwInput == \"Sunday\" ? 11 : leapInput && dotwInput == \"Monday\" ? 12 : leapInput && dotwInput == \"Tuesday\" ? 24 : leapInput && dotwInput == \"Wednesday\" ? 8 : leapInput && dotwInput == \"Thursday\" ? 20 : leapInput && dotwInput == \"Friday\" ? 4 : leapInput && dotwInput == \"Saturday\" ? 16 : leapInput && dotwInput == \"Sunday\" ? 28 : 0;\ndatesCal = d3.utcDays(new Date(calYear, 0, 0), new Date(calYear, 12, 0));\nfunction unix2doty(unix) {\n  const dote = (\n    unix ?? Date.now()\n  ) / 86400000 + 719468,\n    cote = Math.floor((\n      dote &gt;= 0 ? dote\n      : dote - 146096\n    ) / 146097),\n  dotc = dote - cote * 146097,\n  yotc = Math.floor((dotc\n    - Math.floor(dotc / 1460)\n    + Math.floor(dotc / 36524)\n    - Math.floor(dotc / 146096)\n  ) / 365);\n  return dotc - (yotc * 365\n      + Math.floor(yotc / 4)\n      - Math.floor(yotc / 100)\n  )}\nfunction date2dote(year = 1969, doty = 306, zone = 0) {\n    const cote = Math.floor((year &gt;= 0 ? year : year - 399) / 400),\n      yote = year - cote * 400;\n    return [cote * 146097 + yote * 365 + Math.floor(yote / 4) - Math.floor(yote / 100) + doty, zone]\n}\nfunction doty2deco(yearDoty = [1969, 306], zone = 0) {\n    const yd = dote2date(...date2dote(yearDoty[0], Math.floor(yearDoty[1]), zone));\n    return `${yd[0].toString().padStart(4, \"0\")}+${yd[1].toString().padStart(3, \"0\")}${\n        yearDoty[1].toString().includes(\".\") ? \".\" + (\n            (yearDoty[1] &gt; 0) ? (yearDoty[1] - zone).toString().split(\".\").pop()\n            : [...(yearDoty[1] - zone).toString().split(\".\").pop()].map(\n                (e, i, a) =&gt; (i + 1 === a.length) ? 10 - e : 9 - e\n            ).join(\"\")\n        ) : \"\"\n    }`\n}\nfunction deco2doty(timestamp = \"1969+306.00000Z\") {\n    const arr = timestamp.toString().split(/(?=[+-]|[a-zA-Z])/, 3);\n    switch (arr.length) {\n        case 1: return [unix2doty(Date.now())[0], parseFloat(arr[0]), 0];\n        case 2: return (/^[a-zA-Z]+$/.test(arr[1]))\n            ? [unix2doty(Date.now())[0], parseFloat(arr[0]), zone2hour(arr[1]) / 24]\n            : [parseFloat(arr[0]), parseFloat(arr[1]), 0];\n    };\n    return [parseFloat(arr[0]), parseFloat(arr[1]), /^[a-zA-Z]+$/.test(arr[2])\n        ? zone2hour(arr[2]) / 24\n        : parseFloat(arr[2].replace(/([+-])/, \"$1\\.\"))];\n}\nfunction zone2hour(zone = \"Z\") {\n    return (zone = zone.toUpperCase()) == \"Z\" ? 0\n        : zone &gt; \"@\" && zone &lt; \"J\" ? zone.charCodeAt() - 64\n        : zone &gt; \"J\" && zone &lt; \"N\" ? zone.charCodeAt() - 65\n        : zone &lt; \"Z\" && zone &gt; \"M\" ? -(zone.charCodeAt() - 77)\n        : zone;\n}\nfunction doty2unix(year = 1969, doty = 306, zone = 0) {\n    return (date2dote(year, doty, zone) - 719468) * 86400000;\n}\nfunction doty2isoc(yd) {\n    return new Date(doty2unix(...yd))\n}\nfunction doty2greg(doty = 306) {\n    const m = Math.floor((5 * doty + 2) / 153);\n    return [\n      Math.floor(m &lt; 10 ? m + 3 : m - 9),\n      Math.floor(doty - (153 * m + 2) / 5 + 2)\n    ];\n}\nfunction greg2doty(month = 1, day = 1) {\n    return Math.floor(\n        (153 * (month &gt; 2 ? month - 3 : month + 9) + 2) / 5 + day - 1\n)}\nfunction greg2year(year = 1970, month = 1) { return year - (month &lt; 3) }\nfunction isoc2doty(isoc) {\n  return [greg2year(isoc.getFullYear(), isoc.getUTCMonth() + 1), greg2doty(isoc.getUTCMonth() + 1, isoc.getUTCDate())];\n}\nleapInput = leapscrub[1]\nfunction addN(d) { return d + 365 + leapInput }\nfunction subN(d) { return d - 365 - leapInput }\ndates = d3.utcDays(new Date(1999, 2, 0), new Date(2000, 1, 28 + leapInput));\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n Back to topReuseCC BY-SA 4.0CitationBibTeX citation:@online{laptev2024,\n  author = {Laptev, Martin},\n  title = {Dec {Date}},\n  date = {2024},\n  urldate = {2024},\n  url = {https://maptv.github.io/dec/date},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nLaptev, Martin. 2024. ‚ÄúDec Date.‚Äù 2024. https://maptv.github.io/dec/date.",
    "crumbs": [
      "Dec",
      "Date"
    ]
  },
  {
    "objectID": "ml/prob/index.html",
    "href": "ml/prob/index.html",
    "title": "Probability",
    "section": "",
    "text": "In this blog post I will discuss a few examples of probability in machine learning. If you are new to probability, I recommend one of great textbooks that cover the topic and are available for free online, such as Think Bayes by Allen Downey and Bayes Rules! by Alicia A. Johnson, Miles Q. Ott, and Mine Dogucu.\nClassification algorithms algorithms can estimate \\(n \\times k\\) class membership probabilities for each dataset, where n is the number of data points in the dataset and k is the number of classes in the training dataset. Similarly, the Gaussian Mixtures clustering algorithm can generate \\(n \\times k\\) cluster label probabilities.\nBesides a data point and the Gaussian Mixtures models can estimate cluster membership probability. point , especially Logistic Regression and Naive Bayes. Every classification algorithm can estimate probabilities of belonging to each class.\n\\(\\Huge P(A\\vert B)={\\frac {P(B\\vert A)P(A)}{P(B)}}\\)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nimport pandas as pd\nfrom sklearn.decomposition import PCA\nfrom sklearn.impute import KNNImputer\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.metrics import ConfusionMatrixDisplay\nfrom sklearn.model_selection import train_test_split\ndf = sns.load_dataset(\"penguins\")\ndf.head()\n\n\n\n\n\n\n\n\nspecies\nisland\nbill_length_mm\nbill_depth_mm\nflipper_length_mm\nbody_mass_g\nsex\n\n\n\n\n0\nAdelie\nTorgersen\n39.1\n18.7\n181.0\n3750.0\nMale\n\n\n1\nAdelie\nTorgersen\n39.5\n17.4\n186.0\n3800.0\nFemale\n\n\n2\nAdelie\nTorgersen\n40.3\n18.0\n195.0\n3250.0\nFemale\n\n\n3\nAdelie\nTorgersen\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n4\nAdelie\nTorgersen\n36.7\n19.3\n193.0\n3450.0\nFemale\ny = df[\"species\"]\nX = df.drop(\"species\", axis=1)\nX = pd.get_dummies(X, columns=[\"island\", \"sex\"])\nknni = KNNImputer()\ncolnames = X.columns\nX = knni.fit_transform(X)\nX = pd.DataFrame(X, columns=colnames)\n# https://blog.4dcu.be/programming/2021/03/19/Code-Nugget-PCA-with-loadings.html\npipeline = Pipeline([\n    (\"scaler\", StandardScaler()),\n    (\"pca\", PCA(n_components=2)),\n])\n\npca_data = pd.DataFrame(\n    pipeline.fit_transform(X),\n    columns=[\"PC1\", \"PC2\"],\n    index=df.index,\n)\npca_data[\"species\"] = df[\"species\"]\n\npca_step = pipeline.steps[1][1]\nloadings = pd.DataFrame(\n    pca_step.components_.T,\n    columns=[\"PC1\", \"PC2\"],\n    index=X.columns,\n)\n\ndef loading_plot(\n    coeff, labels, scale=1, text_x=None, text_y=None, colors=None, visible=None, ax=plt, arrow_size=0.5\n):\n    for i, label in enumerate(labels):\n        if visible is None or visible[i]:\n            ax.arrow(\n                0,\n                0,\n                coeff[i, 0] * scale,\n                coeff[i, 1] * scale,\n                head_width=arrow_size * scale,\n                head_length=arrow_size * scale,\n                color=\"#000\" if colors is None else colors[i],\n            )\n            ax.text(\n                text_x[i] if text_x.all() else coeff[i, 0] * 1.2 * scale,\n                text_y[i] if text_y.all() else coeff[i, 1] * 1.2 * scale,\n                label,\n                color=\"#000\" if colors is None else colors[i],\n                ha=\"center\",\n                va=\"center\",\n            )\n\nloadings = loadings * 3.2\n\ntext_x = loadings[\"PC1\"] * 2.4\ntext_y = loadings[\"PC2\"] * 2.4\n\ntext_y[\"sex_Male\"] -= .5\ntext_y[\"bill_depth_mm\"] -= .4\ntext_x[\"bill_depth_mm\"] -= .4\ntext_y[\"sex_Female\"] += .5\ntext_y[\"island_Torgersen\"] += .1\ntext_x[\"island_Dream\"] -= .5\ntext_y[\"island_Dream\"] -= .3\ntext_y[\"island_Biscoe\"] += .3\ntext_x[\"island_Biscoe\"] += .3\ntext_x[\"flipper_length_mm\"] += .55\ntext_x[\"body_mass_g\"] += .95\ntext_y[\"body_mass_g\"] -= .05\n\n# https://seaborn.pydata.org/generated/seaborn.jointplot.html\ng = sns.jointplot(data=pca_data, x=\"PC1\", y=\"PC2\", hue=\"species\", ratio=4, marginal_ticks=True, height=8)\ng.plot_joint(sns.kdeplot, zorder=0, levels=6)\ng.plot_marginals(sns.rugplot, height=-.025, clip_on=False)\n# Add loadings\nloading_plot(loadings[[\"PC1\", \"PC2\"]].values, loadings.index, text_x=text_x, text_y=text_y, scale=2, arrow_size=0.02)\n\n# Add variance explained by the\nplt.xlabel(f\"PC1 ({pca_step.explained_variance_ratio_[0]*100:.2f} %)\")\nplt.ylabel(f\"PC2 ({pca_step.explained_variance_ratio_[1]*100:.2f} %)\")\n\nplt.tight_layout()\nplt.savefig(\"PCA_with_loadings.png\", dpi=300)\nplt.show()\n\n/var/folders/mn/wpqfzxsn0z10p73_8jr0v2180000gn/T/ipykernel_7153/3221505183.py:36: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`\n  text_x[i] if text_x.all() else coeff[i, 0] * 1.2 * scale,\n/var/folders/mn/wpqfzxsn0z10p73_8jr0v2180000gn/T/ipykernel_7153/3221505183.py:37: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`\n  text_y[i] if text_y.all() else coeff[i, 1] * 1.2 * scale,\nsns.displot(df, x=\"bill_length_mm\", kde=True, hue=\"species\", stat=\"count\");\nsns.displot(df, x=\"bill_length_mm\", kde=True, hue=\"species\", stat=\"density\");\nplt.show()\nsns.displot(df, x=\"bill_length_mm\", kde=True, rug=True, hue=\"species\", stat=\"proportion\");\nplt.show()\nfig, axes = plt.subplots(1, 2, sharey=True)\nfig.suptitle('PDF and CDF comparision')\nsns.histplot(df[[\"bill_length_mm\", \"flipper_length_mm\"]], kde=True, ax=axes[0]);\nsns.ecdfplot(df[[\"bill_length_mm\", \"flipper_length_mm\"]], stat=\"count\", ax=axes[1], legend=False)\nplt.ylim((0, 375));\nplt.show()\nimport pathlib\nlr = LogisticRegression(max_iter=10000)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)\nlr.fit(X_train, y_train)\ncmd = ConfusionMatrixDisplay.from_estimator(lr, X_test, y_test)\nplt.show()",
    "crumbs": [
      "Machine Learning",
      "Probablity"
    ]
  },
  {
    "objectID": "ml/prob/index.html#step-1.-write-out-the-linear-regression-equation",
    "href": "ml/prob/index.html#step-1.-write-out-the-linear-regression-equation",
    "title": "Probability",
    "section": "Step 1. Write out the linear regression equation",
    "text": "Step 1. Write out the linear regression equation\n\\(\\Huge y=\\beta_0+\\beta_1 x_1+...+\\beta_n x_n\\) ## Step 2. The logistic regression equation is the same as above except output is log odds \\(\\Huge log(odds)=\\beta_0+\\beta_1 x_1+...+\\beta_n x_n\\) ## Step 3. Exponentiate both sides of the logistic regression equation to get odds \\(\\Huge odds=e^{\\beta_0+\\beta_1 x_1+...+\\beta_n x_n}\\) ## Step 4. Write out the probability equation \\(\\Huge p=\\frac{odds}{1+odds}\\) ## Step 5. Plug odds (from step 3) into the probability equation \\(\\Huge p=\\frac{e^{\\beta_0+\\beta_1 x_1+...+\\beta_n x_n}}{1+e^{\\beta_0+\\beta_1 x_1+...+\\beta_n x_n}}\\) ## Step 6. Divide the numerator and denominator by the odds (from step 3) \\(\\Huge p=\\frac{1}{1+e^{-(\\beta_0+\\beta_1 x_1+...+\\beta_n x_n)}}\\)\n\ngnb = GaussianNB()\ngnb.fit(X_train, y_train)\ncmd = ConfusionMatrixDisplay.from_estimator(gnb, X_test, y_test)\nplt.show()\n\n\n\n\n\n\n\n\n\nct = pd.crosstab(df[\"species\"], df[\"body_mass_g\"] &gt; df[\"body_mass_g\"].mean(), margins=True)\n\n\nct\n\n\n\n\n\n\n\nbody_mass_g\nFalse\nTrue\nAll\n\n\nspecies\n\n\n\n\n\n\n\nAdelie\n127\n25\n152\n\n\nChinstrap\n61\n7\n68\n\n\nGentoo\n7\n117\n124\n\n\nAll\n195\n149\n344\n\n\n\n\n\n\n\n\nlikelihood = ct.iloc[0, 0] / ct.iloc[0, 2]\nlikelihood\n\n0.8355263157894737\n\n\n\nprior = ct.iloc[0, 2] / ct.iloc[3, 2]\nprior\n\n0.4418604651162791\n\n\n\nnorm =  ct.iloc[3, 0] / ct.iloc[3, 2]\nnorm\n\n0.5668604651162791\n\n\n\nposterior = ct.iloc[0, 0] / ct.iloc[3, 0]\nposterior\n\n0.6512820512820513\n\n\n\\(\\Huge P(A\\vert B)={\\frac {P(B\\vert A)P(A)}{P(B)}}\\)\n\nresult = likelihood * prior / norm\n\n\ndf[\"body_mass_g\"] &gt; df[\"body_mass_g\"].mean()\n\n0      False\n1      False\n2      False\n3      False\n4      False\n       ...  \n339    False\n340     True\n341     True\n342     True\n343     True\nName: body_mass_g, Length: 344, dtype: bool\n\n\n\n# gnb.fit([df[\"body_mass_g\"] &gt; df[\"body_mass_g\"].mean()], y)",
    "crumbs": [
      "Machine Learning",
      "Probablity"
    ]
  }
]