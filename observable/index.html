<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.13">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Laptev">

<title>Martin Laptev</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../positron/index.html" rel="next">
<link href="../jupyter/index.html" rel="prev">
<link href="../asset/deidec.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2adc583dd4970bf956aa8f8d8cba74a4.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-fbcdefa0ccbc72d004c4082f96ee72e6.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-66fdb40db1b837e235c81d9e4857afea.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-127fe81d6141d4030fc4215ec7c21cb4.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<meta name="mermaid-theme" content="default">
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<meta name="quarto:status" content="draft">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../asset/style.css">
<meta name="twitter:title" content="Martin Laptev">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://maptv.github.io/observable/horst_many-lang-qmd-to-output.png">
<meta name="twitter:image-height" content="741">
<meta name="twitter:image-width" content="941">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><div id="quarto-draft-alert" class="alert alert-warning"><i class="bi bi-pencil-square"></i>Draft</div>
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../asset/deidec.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Martin Laptev</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../git/index.html">Software</a></li><li class="breadcrumb-item"><a href="../observable/index.html">Observable</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="sidebar-tools-main tools-wide">
    <a href="https://www.github.com/maptv" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/maptv" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-linkedin"></i></a>
    <a href="mailto:maptv@engineer.com" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope-at"></i></a>
    <div id="quarto-search" class="quarto-navigation-tool px-1" title="Search"></div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-house-door" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-info-circle" role="img">
</i> 
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cv/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-person" role="img">
</i> 
 <span class="menu-text">CV/Résumé</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../list/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-grid-3x3-gap" role="img">
</i> 
 <span class="menu-text">Article List</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../dec/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-arrow-repeat" role="img">
</i> 
 <span class="menu-text">Dec</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dec/date/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-date" role="img">
</i> 
 <span class="menu-text">Date</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dec/time/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-clock" role="img">
</i> 
 <span class="menu-text">Time</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dec/snap/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-postage" role="img">
</i> 
 <span class="menu-text">Snap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dec/span/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar-range" role="img">
</i> 
 <span class="menu-text">Span</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true"><i class="bi bi-hourglass-split" role="img">
</i> 
 <span class="menu-text">History</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../history/ww2/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-2-square" role="img">
</i> 
 <span class="menu-text">World War 2</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true"><i class="bi bi-robot" role="img">
</i> 
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ml/prob/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-dice-5" role="img">
</i> 
 <span class="menu-text">Probablity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../ml/llm/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-translate" role="img">
</i> 
 <span class="menu-text">Language Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true"><i class="bi bi-laptop" role="img">
</i> 
 <span class="menu-text">Software</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../git/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-git" role="img">
</i> 
 <span class="menu-text">Git</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../jupyter/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-journal-richtext" role="img">
</i> 
 <span class="menu-text">Jupyter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../observable/index.html" class="sidebar-item-text sidebar-link active"><i class="bi bi-0-circle" role="img">
</i> 
 <span class="menu-text">Observable</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../positron/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-p-square" role="img">
</i> 
 <span class="menu-text">Positron</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../quarto/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-markdown" role="img">
</i> 
 <span class="menu-text">Quarto</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/filter/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-funnel" role="img">
</i> 
 <span class="menu-text">Filter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/include/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-plus" role="img">
</i> 
 <span class="menu-text">Include</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/script/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-code" role="img">
</i> 
 <span class="menu-text">Script</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reveal/index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-slides" role="img">
</i> 
 <span class="menu-text">Reveal</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tldr" id="toc-tldr" class="nav-link active" data-scroll-target="#tldr"><span class="blue" data-bs-toggle="tooltip" data-bs-title="too long; didn't read"><u>TL;DR</u></span></a></li>
  <li><a href="#sec-intro" id="toc-sec-intro" class="nav-link" data-scroll-target="#sec-intro">Introduction</a></li>
  <li><a href="#sec-intro-doty" id="toc-sec-intro-doty" class="nav-link" data-scroll-target="#sec-intro-doty">Day-of-the-year</a></li>
  <li><a href="#sec-intro-year" id="toc-sec-intro-year" class="nav-link" data-scroll-target="#sec-intro-year">Year</a></li>
  <li><a href="#sec-intro-dek" id="toc-sec-intro-dek" class="nav-link" data-scroll-target="#sec-intro-dek">Dek</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/maptv/maptv.github.io/blob/main/observable/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../git/index.html">Software</a></li><li class="breadcrumb-item"><a href="../observable/index.html">Observable</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Observable</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">tool</div>
    <div class="quarto-category">observable</div>
    <div class="quarto-category">quarto</div>
  </div>
  </div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://maptv.github.io">Martin Laptev</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024+340</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="tldr" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="tldr"><span class="blue" data-bs-toggle="tooltip" data-bs-title="too long; didn't read"><u>TL;DR</u></span></h2>
<p>The goal of this blog post, the fourth in my <a href="..#category=tool">Tools</a> blog post series, is to set up the <a href="https://code.visualstudio.com">Visual Studio Code</a> (VSCode) <a href="https://en.wikipedia.org/wiki/Source-code_editor#:~:text=A%20source%2Dcode%20editor%20is%20a%20text%20editor%20program%20designed%20specifically%20for%20editing%20source%20code%20of%20computer%20programs.">source-code editor</a> to run in the remote development environments provided by the <a href="https://github.com/features/codespaces">Codespaces</a> and <a href="https://www.gitpod.io">GitPod</a> <a href="https://en.wikipedia.org/wiki/Computing_platform#:~:text=A%20computing%20platform%2C%20digital%20platform%2C%5B1%5D%20or%20software%20platform%20is%20an%20environment%20in%20which%20software%20is%20executed.">computing platforms</a>. To accomplish this goal, we will use VSCode to edit a setup <a href="https://en.wikipedia.org/wiki/Shell_script#:~:text=A%20shell%20script%20is%20a%20computer%20program%20designed%20to%20be%20run%20by%20a%20Unix%20shell%2C%20a%20command%2Dline%20interpreter.%5B">script</a> and configuration files in a Git <a href="https://en.wikipedia.org/wiki/Repository_(version_control)#:~:text=In%20version%20control%20systems%2C%20a%20repository%20is%20a%20data%20structure%20that%20stores%20metadata%20for%20a%20set%20of%20files%20or%20directory%20structure.">repository</a> (repo) named <code>dotfiles</code>.</p>
<div class="cell page-columns page-full" data-layout-align="default">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div id="fig-navchart" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-navchart-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-navchart">flowchart TB
   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]
   C--&gt;D[Observable]
   C--&gt;E[Jupyter]
   C--&gt;F[Knitr]
   click A "../git"
   click B "../vscode"
   click C "../quarto"
   click D "../observable"
   click E "../jupyter"
   click F "../knitr"
   style D stroke:#99f,stroke-width:5px
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-navchart-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Tools series navigation chart
</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section id="sec-intro" class="level2">
<h2 class="anchored" data-anchor-id="sec-intro">Introduction</h2>
<p>If you do not have such a repo, you can create one by following along with the <a href="../git">previous post</a> in my <a href="..#category=tool">tools</a> blog post series, which is shown in <a href="#fig-navchart" class="quarto-xref">Figure&nbsp;1</a>.</p>
</section>
<section id="sec-intro-doty" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-intro-doty">Day-of-the-year</h2>
<p><code>Decalendar</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> is a <a href="https://en.wikipedia.org/wiki/Decimal">decimal</a> calendar🗓️system and <code>Declock</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> is a decimal timekeeping⏳system. Instead of months, weeks, hours, minutes, and seconds, <code>Decalendar</code> and <code>Declock</code> use a number called the day-of-the-year (<code>doty</code>)<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. <a href="#fig-bar-doty" class="quarto-xref">Figure&nbsp;2</a> displays the current <code>doty</code> <span>(<span id="ojs-element-id-1"></span>)</span> as a bar chart. The <a href="https://en.wikipedia.org/wiki/Decimal#:~:text=The%20integer%20part%20or%20integral%20part%20of%20a%20decimal%20numeral%20is%20the%20integer%20written%20to%20the%20left%20of%20the%20decimal%20separator">integer part</a> of the <code>doty</code> is the <code>Decalendar</code> date<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <span>(<span id="ojs-element-id-16"></span>)</span> and the <a href="https://en.wikipedia.org/wiki/Decimal#:~:text=The%20part%20from%20the%20decimal%20separator%20to%20the%20right%20is%20the%20fractional%20part%2C%20which%20equals%20the%20difference%20between%20the%20numeral%20and%20its%20integer%20part.">fractional part</a> is the <code>Declock</code> time<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> <span>(<span id="ojs-element-id-17"></span>).</span></p>
<p>The top two bars in <a href="#fig-bar-doty" class="quarto-xref">Figure&nbsp;2</a> (旬 and 日) show the two components of the <code>Decalendar</code> date <span>(<span id="ojs-element-id-18"></span>):</span> the <code>dek</code><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> <span>(<span id="ojs-element-id-2"></span>)</span> and the day-of-the-<code>dek</code><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> <span>(<span id="ojs-element-id-3"></span>).</span> A <code>dek</code> is a group of 10 days that fulfills the role of months and weeks in <code>Decalendar</code>. Therefore, the <code>dek</code> and the day-of-the-<code>dek</code> (<code>dotd</code>) in <code>Decalendar</code> dates are analogous to the month and day-of-the-month (<code>dotm</code>) in <a href="https://en.wikipedia.org/wiki/ISO_8601#Calendar_dates">calendar dates</a> (<code>mm-dd</code>) and the week and day-of-the-week (<code>dotw</code>) in <a href="https://en.wikipedia.org/wiki/ISO_8601#Week_dates">week dates</a> (<code>Www-d</code>).</p>
<p>The bottom three bars in <a href="#fig-bar-doty" class="quarto-xref">Figure&nbsp;2</a> (%, ‰, and ♫) show components of the <code>Declock</code> time <span>(<span id="ojs-element-id-19"></span>):</span> <code>cents</code><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> <span>(<span id="ojs-element-id-4"></span>),</span> <code>mils</code><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> <span>(<span id="ojs-element-id-5"></span>),</span> and <code>beats</code><a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> <span>(<span id="ojs-element-id-6"></span>).</span> A <code>cent</code> is 1% of the day, which is a little less than a quarter hour. A <code>mil</code> (<code>‰</code>) is a tenth of a <code>cent</code>, which is close to a minute and a half. A <code>beat</code> is 1% of a <code>mil</code>, which is almost as long as a second, and can be thought of as a heart❤️beat or musical🎵<a href="https://en.wikipedia.org/wiki/Beat_(music)#:~:text=the%20beat%20is%20the%20basic%20unit%20of%20time">beat</a> with a constant <a href="https://en.wikipedia.org/wiki/Heart_rate#:~:text=The%20American%20Heart%20Association%20states%20the%20normal%20resting%20adult%20human%20heart%20rate%20is%2060%2D100%20bpm.">rate</a> or <a href="https://en.wikipedia.org/wiki/Tempo#Basic_tempo_markings:~:text=Adagietto%20%E2%80%93%20slower%20than,56%E2%80%93108%C2%A0bpm">tempo</a> of 69.4̅ beats per minute. In addition to displaying time on clocks🕰️and⌚️watches, <code>beats</code> can be used to measure durations, such as the time since this webpage was loaded: <span><span id="ojs-element-id-7"></span>.</span></p>
<div class="cell column-body" data-layout-align="center">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="84" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 83;"><span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@fheyen/barchart-clock</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> W <span class="op">=</span> width <span class="op">&gt;</span> <span class="dv">1250</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">2</span> <span class="op">/</span> <span class="dv">3</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">1150</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">3</span> <span class="op">/</span> <span class="dv">4</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">1050</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">5</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">950</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">5</span> <span class="op">/</span> <span class="dv">6</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">850</span> <span class="op">?</span> width <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">750</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.02</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">650</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.06</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">550</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">450</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.14</span> <span class="op">:</span> width <span class="op">*</span> <span class="fl">1.18</span><span class="op">;</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">156</span><span class="op">;</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W<span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleM <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleCandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDek <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">37</span>])</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="st">'dek'</span><span class="op">,</span> <span class="st">'dotd'</span><span class="op">,</span> <span class="st">'cents'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Dek/Dotd</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDek</span>(<span class="bu">Number</span>(dotyDek)<span class="op">+</span><span class="bu">Number</span>(dotyDotd)<span class="op">/</span><span class="dv">10</span><span class="op">+</span><span class="bu">Number</span>(barCents)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDek</span>(dotyDek))</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(<span class="bu">Number</span>(dotyDotd)<span class="op">+</span><span class="bu">Number</span>(barCents)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(dotyDotd))</span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickDek'</span>)</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">37</span>))</span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickDek'</span>)</span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDek</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">2</span> <span class="op">:</span> <span class="dv">3</span>)<span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">6</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickDotd'</span>)</span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickDotd'</span>)</span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">49</span>)</span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel'</span>)</span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span> width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">37</span><span class="op">:</span> <span class="dv">35</span><span class="op">,</span> width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">2</span><span class="op">:</span> <span class="dv">3</span>))</span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel'</span>)</span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDek</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">22</span>)</span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(<span class="bu">Number</span>(barCents)<span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">10</span><span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(barCents))</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(<span class="bu">Number</span>(barMils)<span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barMb)<span class="op">/</span><span class="dv">100000</span>))</span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(barMils))</span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM1'</span>)</span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM1'</span>)</span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="fl">92.5</span>)</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="fl">2.5</span>)</span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">47</span>)</span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel2'</span>)</span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel2'</span>)</span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">112</span>)</span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(<span class="bu">Number</span>(barBeats)<span class="op">+</span><span class="bu">Number</span>(barMb)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(barBeats))</span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`</span><span class="sc">${</span>dotyDek<span class="sc">}</span><span class="vs">旬`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>dotyDotd<span class="sc">}</span><span class="vs">日`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barCents<span class="sc">}</span><span class="vs">%`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMils<span class="sc">}</span><span class="vs">‰`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeats<span class="sc">}</span><span class="vs">♫`</span>])</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-bar-doty" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bar-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bar-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Doty bar chart
</figcaption>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="264" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 263;"><span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a><span class="vs">  .tickLabel, .tickLabel1, .tickLabel2, .timeLabel {</span></span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #000;</span></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-family: sans-serif;</span></span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 20px;</span></span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a><span class="vs">    text-anchor: middle;</span></span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeLabel {</span></span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a><span class="vs">    text-anchor: start;</span></span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBar, .timeBarFull {</span></span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a><span class="vs">    x: 1px;</span></span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a><span class="vs">    height: 25px;</span></span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a><span class="vs">    rx: 5px;</span></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a><span class="vs">    stroke: #aaa;</span></span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBar {</span></span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #e8e8e8;</span></span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBarFull {</span></span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #ccffff;</span></span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a><span class="vs">  .background {</span></span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: white;</span></span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a><span class="vs">  .tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB {</span></span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a><span class="vs">    stroke: none;</span></span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #666;</span></span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 1px;</span></span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<p>As an alternative to <code>doty</code> dates, <code>Decalendar</code> can express dates in fractional years, which are similar to the <a href="https://en.wikipedia.org/wiki/Decimal_time#Fractional_days">fractional days</a> used in <code>doty</code> times. Fractional year dates<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> can be combined with years into one number and are useful for marking periods of 73 days in the <code>Decalendar</code> year. Every 73 days, the <code>Decalendar</code> fractional year date increases by .2 (⅕). The current <code>Decalendar</code> fractional year date is <span><span id="ojs-element-id-20"></span>.</span></p>
<p>Now it’s your turn! Move the sliders🎚️in <a href="#exm-intro-doty" class="quarto-xref">Example&nbsp;1</a> to adjust the <code>doty</code>, fractional year, month, and <code>dotm</code> values and see the corresponding 1) Northern Hemisphere season, 2) Southern Hemisphere season, and 3) Zodiac sign in <a href="#lst-intro-doty" class="quarto-xref">../List&nbsp;1</a>. Try selecting a special date, like your birthday🎂! You can also press the Play▶️button and then sit back and watch the sliders cycle🔄back and forth from the start to the end of the <code>Decalendar</code> year. The sliders cycle through an entire year in 36.5 <code>beats</code>, a million times faster🏎️than the actual speed of time!</p>
<div id="exm-intro-doty" class="theorem example page-columns page-full">
<p><span class="theorem-title"><strong>Example 1</strong></span> &nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="310" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 309;"><span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>viewof inputDoty <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">365</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">306</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"doty"</span>})<span class="op">;</span></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>viewof year <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="op">.</span><span class="dv">999</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"year"</span>})<span class="op">,</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> (x <span class="kw">=&gt;</span> x <span class="op">/</span> <span class="dv">365</span>)<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> (x <span class="kw">=&gt;</span> x <span class="op">*</span> <span class="dv">365</span>)}</span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>viewof monthInput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"month"</span>})<span class="op">,</span></span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2month<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> month2doty}</span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>viewof dotmInput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">31</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"dotm"</span>})<span class="op">,</span></span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2dotm<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> (x <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(( <span class="dv">153</span> <span class="op">*</span> (</span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>        viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">&gt;</span> <span class="dv">2</span></span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">-</span> <span class="dv">3</span></span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> x <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>))})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<div class="g-col-5">
<ol type="1">
<li><span><span id="ojs-element-id-8"></span></span></li>
<li><span><span id="ojs-element-id-9"></span></span></li>
<li><span><span id="ojs-element-id-10"></span></span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="339" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 338;"><span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a>viewof scrubberDoty <span class="op">=</span> <span class="fu">Scrubber</span>(numbers<span class="op">,</span> {<span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">alternate</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">delay</span><span class="op">:</span> <span class="fl">86.4</span><span class="op">,</span> <span class="dt">loopDelay</span><span class="op">:</span> <span class="dv">864</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="lst-intro-doty" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-intro-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
../List&nbsp;1: Date to season conversion
</figcaption>
<div aria-describedby="lst-intro-doty-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre id="lst-intro-doty"><code></code></pre>
</div>
</figure>
</div>
</div></div></div>

</section>
<section id="sec-intro-year" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-intro-year">Year</h2>
<p><code>Doty</code> dates (<code>day</code>) and <a href="https://en.wikipedia.org/wiki/Timestamp#:~:text=A%20timestamp%20is%20a%20sequence%20of%20characters%20or%20encoded%20information%20identifying%20when%20a%20certain%20event%20occurred%2C%20usually%20giving%20date%20and%20time%20of%20day%2C%20sometimes%20accurate%20to%20a%20small%20fraction%20of%20a%20second.">timestamps</a> (<code>day.stamp</code>) do not include years and thus can be reused from year to year. When a <code>doty</code> is combined with a year, it forms a <code>Decalendar</code> <code>ordinal</code><a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> (<code>deco</code>) and represents a specific date (<code>year+day</code>) or time (<code>year+day.stamp</code>) in a specific year, instead of a date (<code>day</code>) or time (<code>day.stamp</code>) that occurs every year or every leap year. Using the <a href="https://observablehq.com/about">Observable</a> <a href="https://observablehq.com/@observablehq/input-date#cell-111">datetime input</a> in <a href="#exm-intro-date" class="quarto-xref">Example&nbsp;2</a>, you can select a year, month, <code>dotm</code>, hour, and minute to see the equivalent 1) <code>deco</code> timestamp (<code>year+day.clock</code>) and 2) year date (<code>year.yyy</code>) in <a href="#lst-intro-date" class="quarto-xref">../List&nbsp;2</a>. For comparison, the current <code>deco</code> timestamp is <span><span id="ojs-element-id-11"></span>.</span></p>
<div id="exm-intro-date" class="theorem example page-columns page-full">
<p><span class="theorem-title"><strong>Example 2</strong></span> &nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="669" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 668;"><span id="cb11-669"><a href="#cb11-669" aria-hidden="true" tabindex="-1"></a>viewof inputDatetime <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">datetime</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1970-01-01T00:00"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-10" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="g-col-5">
<ol type="1">
<li><span><span id="ojs-element-id-12"></span></span></li>
<li><span><span id="ojs-element-id-13"></span></span></li>
</ol>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="lst-intro-date" class="listing quarto-float quarto-figure quarto-figure-left anchored" data-cap-location="margin">
<figure class="quarto-float quarto-float-lst figure">
<div aria-describedby="lst-intro-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre id="lst-intro-date" class="" data-cap-location="margin"><code></code></pre>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-lst" id="lst-intro-date-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
../List&nbsp;2: Date and time conversion
</figcaption>
</figure>
</div>
</div></div></div>
<p>In <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a>, you can enter numeric year and <code>doty</code> values or type in a free-form <code>deco</code> to see the resulting 1) <a href="https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations">ISO 8601 timestamp</a> (<code>year-mm-ddThh:mm:ss</code>) and 2) year date in <a href="#lst-intro-deco" class="quarto-xref">../List&nbsp;3</a>. <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a> also has a Play▶️button in that cycles from <code>Day</code> <code>0</code> to <code>Day</code> <code>365</code> of <code>Year</code> <code>1969</code>. The cycle goes up to <code>Day</code> <code>0</code> of <code>Year</code> <code>1970</code>, because <code>Year</code> <code>1969</code> is a common year and does not have a <code>Day</code> <code>365</code>.</p>
<p>Interacting with the <a href="https://observablehq.com/@observablehq/input-range#m">number</a> inputs in <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a>, standardizes the <code>deco</code> in the <a href="https://observablehq.com/@observablehq/input-text">text</a> input to ensure years are integers and <code>doty</code> values are positive numbers below 366. Nevertheless, all of the inputs in <a href="#exm-intro-deco" class="quarto-xref">Example&nbsp;3</a> support negative and fractional year and <code>doty</code> values. Negative <code>doty</code> values <a href="https://en.wikipedia.org/wiki/Shift_operator">shift</a> dates backward in time from the start of a given year into a previous year. Similarly, negative years shift dates backward starting from <code>Year</code> <code>0</code>, which is 1 BCE (Before the <a href="https://en.wikipedia.org/wiki/Common_Era">Common Era</a>).</p>
<div id="exm-intro-deco" class="theorem example page-columns page-full">
<p><span class="theorem-title"><strong>Example 3</strong></span> &nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="696" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 695;"><span id="cb12-696"><a href="#cb12-696" aria-hidden="true" tabindex="-1"></a>viewof yd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb12-697"><a href="#cb12-697" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">number</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1969"</span>})<span class="op">,</span></span>
<span id="cb12-698"><a href="#cb12-698" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">number</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"doty"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"306"</span>})</span>
<span id="cb12-699"><a href="#cb12-699" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="704" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 703;"><span id="cb13-704"><a href="#cb13-704" aria-hidden="true" tabindex="-1"></a>viewof decoOutput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb13-705"><a href="#cb13-705" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"deco"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"year+day.ddd"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1969+306"</span>})<span class="op">,</span></span>
<span id="cb13-706"><a href="#cb13-706" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">bind</span><span class="op">:</span> viewof yd<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2deco<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> deco2doty})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-12" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="g-col-5">
<ol type="1">
<li><span><span id="ojs-element-id-14"></span></span></li>
<li><span><span id="ojs-element-id-15"></span></span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="716" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 715;"><span id="cb14-716"><a href="#cb14-716" aria-hidden="true" tabindex="-1"></a>viewof scrubberDeco <span class="op">=</span> <span class="fu">Scrubber</span>(numbers<span class="op">,</span> {<span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">alternate</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">delay</span><span class="op">:</span> <span class="fl">86.4</span><span class="op">,</span> <span class="dt">loopDelay</span><span class="op">:</span> <span class="dv">864</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-13" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<div id="lst-intro-deco" class="listing quarto-float quarto-figure quarto-figure-left anchored" data-cap-location="margin">
<figure class="quarto-float quarto-float-lst figure">
<div aria-describedby="lst-intro-deco-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre id="lst-intro-deco" class="" data-cap-location="margin"><code></code></pre>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-lst" id="lst-intro-deco-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
../List&nbsp;3: Deco timestamp conversion
</figcaption>
</figure>
</div>
</div></div></div>

</section>
<section id="sec-intro-dek" class="level2">
<h2 class="anchored" data-anchor-id="sec-intro-dek">Dek</h2>
<p>As mentioned in <a href="#sec-intro-doty" class="quarto-xref">Section&nbsp;0.3</a>, <code>deks</code> function as both months and weeks in <code>Decalendar</code>. A <code>dek</code> consists of 2 groups of 5 days called <code>pents</code><a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>. Each <code>pent</code> can follow a sequence of workdays and restdays called a <code>pently</code> schedule<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>. fig-schedules compares the typical weekly schedule and the <code>Schedule</code> <code>3</code> <code>pently</code> schedule. Like other <code>pently</code> schedules, <code>Schedule</code> <code>3</code> is named after the number of workdays it contains. The 3 workdays in <code>Schedule</code> <code>3</code> are followed by a 2-day <code>pentend</code>, the <code>Decalender</code> equivalent of a weekend.</p>
<p>Unlike <code>Schedule</code> <code>3</code> and the other <code>pently</code> schedules, the weekly schedule is asymmetric and divides up workdays into proportions that are easier to express as fractions: 3/8 (.375), 1/3 (.3̅), and 7/24 (0.2916̅). In contrast, <code>pently</code> schedules divides each workday into simple, symmetrical proportions that are never <a href="https://en.wikipedia.org/wiki/Repeating_decimal">repeating decimal</a> numbers. The <code>Schedule</code> <code>3</code> workday is longer the typical 9-to-5, but the longer workday is compensated by more frequent restdays.</p>
<p><a href="#exm-intro-pent" class="quarto-xref">Example&nbsp;4</a> provides the opportunity to explore all four of the <code>pently</code> schedules. <code>Schedule</code> <code>3</code> is the default <code>pently</code> schedule, and should be followed unless there is a compelling reason to do otherwise. Despite having different numbers of workdays, all <code>pently</code> schedules keep the amount of spent at work constant at 1.2 days (120 <code>cents</code>) per <code>pent</code>. Every <code>pently</code> schedule also splits up workdays symmetrically so that the time before work is equal to the time after work. You can select which schedule to view in <a href="#exm-intro-pent" class="quarto-xref">Example&nbsp;4</a> using the <a href="https://observablehq.com/about">Observable</a> <a href="https://observablehq.com/@observablehq/input-radio">radio inputs</a>.</p>
<p>You can also use the <a href="https://observablehq.com/@mootari/range-slider">interval sliders</a> to create a custom schedule and the Download⬇️button to obtain the schedule data. Each interval is summarized by a <code>Declock</code> <code>slice</code> shown next to its slider. <code>Decalendar</code> and <code>Declock</code> <code>slices</code> are inspired by <a href="https://en.wikipedia.org/wiki/Array_slicing#:~:text=In%20computer%20programming%2C%20array%20slicing%20is%20an%20operation%20that%20extracts%20a%20subset%20of%20elements%20from%20an%20array%20and%20packages%20them%20as%20another%20array">array slicing</a> in computer programming and are used to represent date and time intervals. The <code>slice</code> that summarizes the <code>Schedule</code> <code>3</code> workday is <code>.3:.7</code>, where .3 (7.2 hours) is the <code>start</code> and .7 (16.8 hours) is the <code>stop</code>.</p>
<div id="exm-intro-pent" class="theorem example">
<p><span class="theorem-title"><strong>Example 4</strong></span> &nbsp;</p>
<div class="grid">
<div class="g-col-7">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="851" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 850;"><span id="cb19-851"><a href="#cb19-851" aria-hidden="true" tabindex="-1"></a>viewof intervals <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb19-852"><a href="#cb19-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'0 or 5'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-853"><a href="#cb19-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'1 or 6'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-854"><a href="#cb19-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'2 or 7'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-855"><a href="#cb19-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'3 or 8'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-856"><a href="#cb19-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">01</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'4 or 9'</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatDecimal</span>(start)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span><span class="fu">formatDecimal</span>(end)<span class="sc">}</span><span class="vs">`</span>})<span class="op">,</span></span>
<span id="cb19-857"><a href="#cb19-857" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-17" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="g-col-5">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="865" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 864;"><span id="cb20-865"><a href="#cb20-865" aria-hidden="true" tabindex="-1"></a>viewof schedule <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"sched."</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span>})</span>
<span id="cb20-866"><a href="#cb20-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-867"><a href="#cb20-867" aria-hidden="true" tabindex="-1"></a>viewof filename <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"name"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter the filename"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="vs">`schedule</span><span class="sc">${</span>schedule<span class="sc">}</span><span class="vs">.csv`</span>})</span>
<span id="cb20-868"><a href="#cb20-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-869"><a href="#cb20-869" aria-hidden="true" tabindex="-1"></a><span class="fu">button</span>(durations<span class="op">,</span> filename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-18-3" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="879" data-source-offset="0" data-cap-location="margin"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 878;"><span id="cb21-879"><a href="#cb21-879" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dec/pent</span></span>
<span id="cb21-880"><a href="#cb21-880" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb21-881"><a href="#cb21-881" aria-hidden="true" tabindex="-1"></a>  <span class="dt">className</span><span class="op">:</span> <span class="st">"schedule-explorer"</span><span class="op">,</span></span>
<span id="cb21-882"><a href="#cb21-882" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span>}<span class="op">,</span></span>
<span id="cb21-883"><a href="#cb21-883" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> {<span class="dt">scheme</span><span class="op">:</span> <span class="st">"Set1"</span><span class="op">,</span> <span class="dt">legend</span><span class="op">:</span> <span class="st">"swatches"</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb21-884"><a href="#cb21-884" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>]}<span class="op">,</span></span>
<span id="cb21-885"><a href="#cb21-885" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb21-886"><a href="#cb21-886" aria-hidden="true" tabindex="-1"></a>  Plot<span class="op">.</span><span class="fu">barY</span>(durations<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> <span class="st">"label"</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"group"</span>})<span class="op">,</span></span>
<span id="cb21-887"><a href="#cb21-887" aria-hidden="true" tabindex="-1"></a>  Plot<span class="op">.</span><span class="fu">textY</span>(</span>
<span id="cb21-888"><a href="#cb21-888" aria-hidden="true" tabindex="-1"></a>      durations<span class="op">,</span></span>
<span id="cb21-889"><a href="#cb21-889" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">stackY</span>(</span>
<span id="cb21-890"><a href="#cb21-890" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">groupX</span>(</span>
<span id="cb21-891"><a href="#cb21-891" aria-hidden="true" tabindex="-1"></a>          { <span class="dt">y</span><span class="op">:</span> <span class="st">"first"</span><span class="op">,</span> <span class="dt">text</span><span class="op">:</span> <span class="st">"first"</span> }<span class="op">,</span></span>
<span id="cb21-892"><a href="#cb21-892" aria-hidden="true" tabindex="-1"></a>          {</span>
<span id="cb21-893"><a href="#cb21-893" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="st">"label"</span><span class="op">,</span></span>
<span id="cb21-894"><a href="#cb21-894" aria-hidden="true" tabindex="-1"></a>            <span class="dt">z</span><span class="op">:</span> <span class="st">"group"</span><span class="op">,</span></span>
<span id="cb21-895"><a href="#cb21-895" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span></span>
<span id="cb21-896"><a href="#cb21-896" aria-hidden="true" tabindex="-1"></a>            <span class="dt">text</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">duration</span> <span class="op">&lt;</span> <span class="op">.</span><span class="bn">0001</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="fu">formatDecimal</span>(d<span class="op">.</span><span class="at">duration</span>))<span class="op">,</span></span>
<span id="cb21-897"><a href="#cb21-897" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb21-898"><a href="#cb21-898" aria-hidden="true" tabindex="-1"></a>            <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb21-899"><a href="#cb21-899" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">36</span><span class="op">,</span></span>
<span id="cb21-900"><a href="#cb21-900" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb21-901"><a href="#cb21-901" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-902"><a href="#cb21-902" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb21-903"><a href="#cb21-903" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb21-904"><a href="#cb21-904" aria-hidden="true" tabindex="-1"></a>  ]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-intro-dek" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-dek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-19" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-dek-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Pently schedule explorer
</figcaption>
</figure>
</div>
</div>
</div>
<p><code>Slices</code> can be used to select <code>Declock</code> time intervals, as in <a href="#exm-intro-pent" class="quarto-xref">Example&nbsp;4</a> above, or <code>Decalendar</code> date intervals, as in <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> below. <code>Decalendar</code> date intervals can represent events take place over multiple days. In addition to <code>slices</code>, <code>Decalendar</code> and <code>Declock</code> intervals can also be chosen using <code>spreads</code>. Use the <a href="https://observablehq.com/about">Observable</a> <a href="https://observablehq.com/@observablehq/input-button">button</a> and <a href="https://observablehq.com/@observablehq/input-checkbox">checkbox</a> inputs in <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> to display different <code>dotd</code> combinations in <a href="#fig-intro-dotd" class="quarto-xref">Figure&nbsp;4</a>. <a href="#fig-intro-dotd" class="quarto-xref">Figure&nbsp;4</a> shows dates selected by a <code>slice</code> in <span class="blue">blue</span>, dates selected by a <code>spread</code> in <span class="orange">orange</span>, dates selected by both in <span class="green">green</span>, and dates selected by neither in <span class="gray">gray</span>.</p>
<p>The <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> button and checkbox inputs will modify the associated <code>slice</code> and <code>spread</code> text and numeric inputs as needed to select the desired days-of-the-<code>dek</code>. The numeric inputs for <code>slices</code> are the <code>start</code>🎬index, the <code>stop</code>🛑index, and the <code>step</code>👣size, which are separated by colons (<code>start:stop:step</code>) when combined into a <code>slice</code>. Similarly, the numeric inputs for <code>spreads</code> are the <code>start</code>🎬or🛑<code>stop</code> index, the <code>span</code>🪽size, the <code>split</code> size, and the <code>space</code> size, which are typically delimited by greater-than signs (<code>start&gt;span&gt;split&gt;space</code>) or a mix of greater-than and less-than signs (<code>stop&lt;span&gt;split&gt;space</code>).</p>
<p>The numeric inputs in <a href="#exm-intro-dotd" class="quarto-xref">Example&nbsp;5</a> cannot capture the full power of <code>spreads</code> and <code>slices</code>, because <code>slices</code> can have any number of <code>steps</code> and, likewise, <code>spreads</code> can have any number of alternating <code>split</code> and <code>space</code> sizes. We can select all even or odd days-of-the-<code>dek</code> using a <code>slice</code> with a single <code>step</code> (<code>::2</code> or <code>1::2</code>) or a <code>spread</code> with one <code>split</code>-<code>space</code> pair (<code>&gt;&gt;&gt;1</code> or <code>1&gt;&gt;&gt;1</code>). More complex patterns, such as prime or composite days-of-the-<code>dek</code>, require multiple <code>step</code> sizes for <code>slices</code> (<code>2:::2:2:5</code> or <code>4::2:2::5</code>) or multiple <code>split</code>-<code>space</code> pairs (<code>2&gt;&gt;2&gt;1&gt;&gt;1&gt;&gt;4</code> or <code>4&gt;&gt;&gt;1&gt;&gt;1&gt;2&gt;4</code>).</p>
<div id="exm-intro-dotd" class="theorem example">
<p><span class="theorem-title"><strong>Example 5</strong></span> &nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="920" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 919;"><span id="cb22-920"><a href="#cb22-920" aria-hidden="true" tabindex="-1"></a>viewof sliceDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"slice"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">6</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="925" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 924;"><span id="cb23-925"><a href="#cb23-925" aria-hidden="true" tabindex="-1"></a>viewof spreadDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"spread"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">6</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="930" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 929;"><span id="cb24-930"><a href="#cb24-930" aria-hidden="true" tabindex="-1"></a>viewof togglePlot <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">button</span>([</span>
<span id="cb24-931"><a href="#cb24-931" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="st">"None"</span> <span class="op">:</span> <span class="st">"All"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]]<span class="op">,</span></span>
<span id="cb24-932"><a href="#cb24-932" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="st">"Even"</span> <span class="op">:</span> <span class="st">"Odd"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">9</span>]]<span class="op">,</span></span>
<span id="cb24-933"><a href="#cb24-933" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Prime&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Prime"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span>]]<span class="op">,</span></span>
<span id="cb24-934"><a href="#cb24-934" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Composite&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Composite"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span>]]<span class="op">,</span></span>
<span id="cb24-935"><a href="#cb24-935" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Schedule2&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Schedule2"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span>]]<span class="op">,</span></span>
<span id="cb24-936"><a href="#cb24-936" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Schedule3&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Schedule3"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span>]]<span class="op">,</span></span>
<span id="cb24-937"><a href="#cb24-937" aria-hidden="true" tabindex="-1"></a>  [invertDotd <span class="op">?</span> <span class="fu">html</span><span class="vs">`&lt;s&gt;Schedule4&lt;/s&gt;`</span> <span class="op">:</span> <span class="st">"Schedule4"</span><span class="op">,</span> value <span class="kw">=&gt;</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span>]]<span class="op">,</span></span>
<span id="cb24-938"><a href="#cb24-938" aria-hidden="true" tabindex="-1"></a>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> []<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"select"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="grid">
<div class="g-col-6">
<div class="cell btn-row">
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="947" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 946;"><span id="cb25-947"><a href="#cb25-947" aria-hidden="true" tabindex="-1"></a>viewof invertDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"invert"</span>})</span>
<span id="cb25-948"><a href="#cb25-948" aria-hidden="true" tabindex="-1"></a>viewof sliceOrSpread <span class="op">=</span> <span class="fu">toggleSwitch</span>({<span class="dt">textOn</span><span class="op">:</span> invertDotd <span class="op">?</span> <span class="st">"Spread"</span> <span class="op">:</span> <span class="st">'Slice'</span> <span class="op">,</span> <span class="dt">textOff</span><span class="op">:</span> invertDotd <span class="op">?</span> <span class="st">"Slice"</span> <span class="op">:</span> <span class="st">'Spread'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-23-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="953" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 952;"><span id="cb26-953"><a href="#cb26-953" aria-hidden="true" tabindex="-1"></a>viewof sliceInputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb26-954"><a href="#cb26-954" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter start index"</span>})<span class="op">,</span></span>
<span id="cb26-955"><a href="#cb26-955" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"stop"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">366</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter stop index"</span>})<span class="op">,</span></span>
<span id="cb26-956"><a href="#cb26-956" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">5</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter step size"</span>})<span class="op">,</span></span>
<span id="cb26-957"><a href="#cb26-957" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb26-958"><a href="#cb26-958" aria-hidden="true" tabindex="-1"></a>viewof sliceString <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb26-959"><a href="#cb26-959" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"slice"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter slice string"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"0:366"</span>})<span class="op">,</span></span>
<span id="cb26-960"><a href="#cb26-960" aria-hidden="true" tabindex="-1"></a>{<span class="dt">bind</span><span class="op">:</span> viewof sliceInputs<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> encodeSlice<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> decodeSlice})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-24-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
<div class="g-col-6">
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="967" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 966;"><span id="cb27-967"><a href="#cb27-967" aria-hidden="true" tabindex="-1"></a>viewof spreadInputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb27-968"><a href="#cb27-968" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter start index"</span>})<span class="op">,</span></span>
<span id="cb27-969"><a href="#cb27-969" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"span"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">366</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter span size"</span>})<span class="op">,</span></span>
<span id="cb27-970"><a href="#cb27-970" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"split"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter split size"</span>})<span class="op">,</span></span>
<span id="cb27-971"><a href="#cb27-971" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span>([<span class="op">-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"space"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter space size"</span>})<span class="op">,</span></span>
<span id="cb27-972"><a href="#cb27-972" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb27-973"><a href="#cb27-973" aria-hidden="true" tabindex="-1"></a>viewof spreadString <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb27-974"><a href="#cb27-974" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"spread"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"Enter spread string"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"0&gt;366&gt;3&gt;2"</span>})<span class="op">,</span></span>
<span id="cb27-975"><a href="#cb27-975" aria-hidden="true" tabindex="-1"></a>{<span class="dt">bind</span><span class="op">:</span> viewof spreadInputs<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> encodeSpread<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> decodeSpread})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-25-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-25-2" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell fig-cap-location-margin" data-layout-align="center">
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="985" data-source-offset="0" data-cap-location="margin"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 984;"><span id="cb28-985"><a href="#cb28-985" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dec/dotd</span></span>
<span id="cb28-986"><a href="#cb28-986" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb28-987"><a href="#cb28-987" aria-hidden="true" tabindex="-1"></a>  <span class="dt">className</span><span class="op">:</span> <span class="st">"date-selector"</span><span class="op">,</span></span>
<span id="cb28-988"><a href="#cb28-988" aria-hidden="true" tabindex="-1"></a>  <span class="dt">padding</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb28-989"><a href="#cb28-989" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> {<span class="dt">axis</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"band"</span>}<span class="op">,</span></span>
<span id="cb28-990"><a href="#cb28-990" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"band"</span>}<span class="op">,</span></span>
<span id="cb28-991"><a href="#cb28-991" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb28-992"><a href="#cb28-992" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">cell</span>(dates<span class="op">,</span> {<span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> d <span class="kw">=&gt;</span></span>
<span id="cb28-993"><a href="#cb28-993" aria-hidden="true" tabindex="-1"></a>      sliceArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">&amp;&amp;</span> spreadArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">?</span> <span class="st">"green"</span> <span class="op">:</span></span>
<span id="cb28-994"><a href="#cb28-994" aria-hidden="true" tabindex="-1"></a>      sliceArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">&amp;&amp;</span> <span class="op">!</span>spreadArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">?</span> <span class="st">"blue"</span> <span class="op">:</span></span>
<span id="cb28-995"><a href="#cb28-995" aria-hidden="true" tabindex="-1"></a>      <span class="op">!</span>sliceArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">&amp;&amp;</span> spreadArray<span class="op">.</span><span class="fu">includes</span>(d) <span class="op">?</span> <span class="st">"orange"</span> <span class="op">:</span> <span class="st">"grey"</span><span class="op">,</span></span>
<span id="cb28-996"><a href="#cb28-996" aria-hidden="true" tabindex="-1"></a>      <span class="dt">inset</span><span class="op">:</span> <span class="fl">0.5</span>})<span class="op">,</span></span>
<span id="cb28-997"><a href="#cb28-997" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span>(dates<span class="op">,</span> {</span>
<span id="cb28-998"><a href="#cb28-998" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> d <span class="kw">=&gt;</span> d[<span class="dv">2</span>]<span class="op">,</span></span>
<span id="cb28-999"><a href="#cb28-999" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span></span>
<span id="cb28-1000"><a href="#cb28-1000" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb28-1001"><a href="#cb28-1001" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stroke</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb28-1002"><a href="#cb28-1002" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span>})</span>
<span id="cb28-1003"><a href="#cb28-1003" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb28-1004"><a href="#cb28-1004" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-intro-dotd" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intro-dotd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="ojs-cell-26" data-nodetype="expression">

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intro-dotd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Decalendar date selector
</figcaption>
</figure>
</div>
</div>
</div>

</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>


<!-- -->

<div class="ojs-auto-generated hidden">
<script type="ojs-module-contents">
eyJjb250ZW50cyI6WyAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c3R5bGVkRG90eURhdGV9LiR7c3R5bGVkRG90eVRpbWV9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzdHlsZWREZWt9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0yIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzdHlsZWREb3RkfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c3R5bGVkQ2VudH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTQifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3N0eWxlZE1pbH08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTUifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3N0eWxlZEJlYXR9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC02In0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzdHlsZWRUaWNrVGltZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTcifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2lucHV0RG90eVNlYXNvblswXX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTgifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2lucHV0RG90eVNlYXNvblsxXX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTkifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke2lucHV0RG90eVpvZGlhY308L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTEwIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzdHlsZWRZZWFyfSske3N0eWxlZERvdHlEYXRlMX0uJHtzdHlsZWREb3R5VGltZTF9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xMSJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7ZHRZZWFyfSske2R0RG90eURhdGV9JHtkdERvdHlUaW1lRGVsaW1pdGVyfSR7ZHREb3R5VGltZX08L3NwYW4+YCIsICJjZWxsTmFtZSI6Im9qcy1lbGVtZW50LWlkLTEyIn0sICB7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJpbmxpbmUiOiJ0cnVlIiwic291cmNlIjoiaHRsLmh0bWxgPHNwYW4+JHtzdHlsZWRPdXRwdXREYXRldGltZVllYXJ9PC9zcGFuPmAiLCAiY2VsbE5hbWUiOiJvanMtZWxlbWVudC1pZC0xMyJ9LCAgeyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiaW5saW5lIjoidHJ1ZSIsInNvdXJjZSI6Imh0bC5odG1sYDxzcGFuPiR7c3R5bGVkSXNvY1llYXJ9LSR7c3R5bGVkSXNvY01kfVQke3N0eWxlZElzb2NUaW1lfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTQifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3N0eWxlZE91dHB1dERlY29ZZWFyfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTUifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NldFN0eWxlKGRvdHlEYXRlLCBkMy5zY2hlbWVQYWlyZWRbMV0pfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTYifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NldFN0eWxlKGRvdHlUaW1lLCBkMy5zY2hlbWVQYWlyZWRbMl0pfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTcifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NldFN0eWxlKGRvdHlEYXRlLCBkMy5zY2hlbWVQYWlyZWRbMV0pfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTgifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NldFN0eWxlKGRvdHlUaW1lLCBkMy5zY2hlbWVQYWlyZWRbMl0pfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMTkifSwgIHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImlubGluZSI6InRydWUiLCJzb3VyY2UiOiJodGwuaHRtbGA8c3Bhbj4ke3NldFN0eWxlKHllYXJEYXRlLnRvU3RyaW5nKCkuc2xpY2UoNCksIGQzLnNjaGVtZVBhaXJlZFsxMF0pfTwvc3Bhbj5gIiwgImNlbGxOYW1lIjoib2pzLWVsZW1lbnQtaWQtMjAifV19
</script>
</div>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="sec-ojs-code-doty" class="level4 appendix"><h2 class="anchored quarto-appendix-heading"><code>Doty</code> Observable code</h2><div class="quarto-appendix-contents">




</div></section><section id="functions" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Functions</h2><div class="quarto-appendix-contents">

<div class="cell">
<div class="sourceCode cell-code" id="cb5" data-startfrom="358" data-source-offset="-62"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 357;"><span id="cb5-358"><a href="#cb5-358" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">set</span>(input<span class="op">,</span> value) {</span>
<span id="cb5-359"><a href="#cb5-359" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb5-360"><a href="#cb5-360" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb5-361"><a href="#cb5-361" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-362"><a href="#cb5-362" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mbostock/scrubber</span></span>
<span id="cb5-363"><a href="#cb5-363" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Scrubber</span>(values<span class="op">,</span> {</span>
<span id="cb5-364"><a href="#cb5-364" aria-hidden="true" tabindex="-1"></a>  format <span class="op">=</span> value <span class="kw">=&gt;</span> value<span class="op">,</span></span>
<span id="cb5-365"><a href="#cb5-365" aria-hidden="true" tabindex="-1"></a>  initial <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb5-366"><a href="#cb5-366" aria-hidden="true" tabindex="-1"></a>  direction <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb5-367"><a href="#cb5-367" aria-hidden="true" tabindex="-1"></a>  delay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb5-368"><a href="#cb5-368" aria-hidden="true" tabindex="-1"></a>  autoplay <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-369"><a href="#cb5-369" aria-hidden="true" tabindex="-1"></a>  loop <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-370"><a href="#cb5-370" aria-hidden="true" tabindex="-1"></a>  loopDelay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb5-371"><a href="#cb5-371" aria-hidden="true" tabindex="-1"></a>  alternate <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb5-372"><a href="#cb5-372" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb5-373"><a href="#cb5-373" aria-hidden="true" tabindex="-1"></a>  values <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(values)<span class="op">;</span></span>
<span id="cb5-374"><a href="#cb5-374" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;"&gt;</span></span>
<span id="cb5-375"><a href="#cb5-375" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;button name=b type=button style="background-color:#002ead;color:#fff;border-radius:10px;margin-left:.4em;width: 5em;"&gt;&lt;/button&gt;</span></span>
<span id="cb5-376"><a href="#cb5-376" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;label style="display: flex; align-items: center;"&gt;</span></span>
<span id="cb5-377"><a href="#cb5-377" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;input name=i type=range min=0 max=</span><span class="sc">${</span>values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="sc">}</span><span class="vs"> value=</span><span class="sc">${</span>initial<span class="sc">}</span><span class="vs"> step=1 style="display: none;"&gt;</span></span>
<span id="cb5-378"><a href="#cb5-378" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;output name=o style="display: none;"&gt;&lt;/output&gt;</span></span>
<span id="cb5-379"><a href="#cb5-379" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/label&gt;</span></span>
<span id="cb5-380"><a href="#cb5-380" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb5-381"><a href="#cb5-381" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-382"><a href="#cb5-382" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-383"><a href="#cb5-383" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-384"><a href="#cb5-384" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">start</span>() {</span>
<span id="cb5-385"><a href="#cb5-385" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Pause"</span><span class="op">;</span></span>
<span id="cb5-386"><a href="#cb5-386" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb5-387"><a href="#cb5-387" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> delay)<span class="op">;</span></span>
<span id="cb5-388"><a href="#cb5-388" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-389"><a href="#cb5-389" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">stop</span>() {</span>
<span id="cb5-390"><a href="#cb5-390" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Play"</span><span class="op">;</span></span>
<span id="cb5-391"><a href="#cb5-391" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-392"><a href="#cb5-392" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (timer <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearTimeout</span>(timer)<span class="op">,</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-393"><a href="#cb5-393" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-394"><a href="#cb5-394" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-395"><a href="#cb5-395" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">running</span>() {</span>
<span id="cb5-396"><a href="#cb5-396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> frame <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> timer <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> interval <span class="op">!==</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-397"><a href="#cb5-397" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-398"><a href="#cb5-398" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="cb5-399"><a href="#cb5-399" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> (direction <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span> direction <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="kw">NaN</span>)) {</span>
<span id="cb5-400"><a href="#cb5-400" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>loop) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-401"><a href="#cb5-401" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (alternate) direction <span class="op">=</span> <span class="op">-</span>direction<span class="op">;</span></span>
<span id="cb5-402"><a href="#cb5-402" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (loopDelay <span class="op">!==</span> <span class="kw">null</span>) {</span>
<span id="cb5-403"><a href="#cb5-403" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-404"><a href="#cb5-404" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb5-405"><a href="#cb5-405" aria-hidden="true" tabindex="-1"></a>        timer <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> (<span class="fu">step</span>()<span class="op">,</span> <span class="fu">start</span>())<span class="op">,</span> loopDelay)<span class="op">;</span></span>
<span id="cb5-406"><a href="#cb5-406" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb5-407"><a href="#cb5-407" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb5-408"><a href="#cb5-408" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-409"><a href="#cb5-409" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb5-410"><a href="#cb5-410" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step</span>()<span class="op">;</span></span>
<span id="cb5-411"><a href="#cb5-411" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-412"><a href="#cb5-412" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">step</span>() {</span>
<span id="cb5-413"><a href="#cb5-413" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction <span class="op">+</span> values<span class="op">.</span><span class="at">length</span>) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb5-414"><a href="#cb5-414" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb5-415"><a href="#cb5-415" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-416"><a href="#cb5-416" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> <span class="bu">event</span> <span class="kw">=&gt;</span> {</span>
<span id="cb5-417"><a href="#cb5-417" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">event</span> <span class="op">&amp;&amp;</span> <span class="bu">event</span><span class="op">.</span><span class="at">isTrusted</span> <span class="op">&amp;&amp;</span> <span class="fu">running</span>()) <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-418"><a href="#cb5-418" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> values[form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span>]<span class="op">;</span></span>
<span id="cb5-419"><a href="#cb5-419" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">o</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="fu">format</span>(form<span class="op">.</span><span class="at">value</span><span class="op">,</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span><span class="op">,</span> values)<span class="op">;</span></span>
<span id="cb5-420"><a href="#cb5-420" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb5-421"><a href="#cb5-421" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb5-422"><a href="#cb5-422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">running</span>()) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-423"><a href="#cb5-423" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> alternate <span class="op">&amp;&amp;</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-424"><a href="#cb5-424" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb5-425"><a href="#cb5-425" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb5-426"><a href="#cb5-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb5-427"><a href="#cb5-427" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb5-428"><a href="#cb5-428" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">oninput</span>()<span class="op">;</span></span>
<span id="cb5-429"><a href="#cb5-429" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (autoplay) <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb5-430"><a href="#cb5-430" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb5-431"><a href="#cb5-431" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">disposal</span>(form)<span class="op">.</span><span class="fu">then</span>(stop)<span class="op">;</span></span>
<span id="cb5-432"><a href="#cb5-432" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb5-433"><a href="#cb5-433" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-434"><a href="#cb5-434" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@juang1744/transform-input/1</span></span>
<span id="cb5-435"><a href="#cb5-435" aria-hidden="true" tabindex="-1"></a>transformInput <span class="op">=</span> <span class="kw">function</span>(target<span class="op">,</span> {<span class="dt">bind</span><span class="op">:</span> source<span class="op">,</span> transform <span class="op">=</span> identity<span class="op">,</span> involutory <span class="op">=</span> <span class="kw">false</span><span class="op">,</span> invert <span class="op">=</span> involutory <span class="op">?</span> transform <span class="op">:</span> <span class="fu">inverse</span>(transform)} <span class="op">=</span> {}){</span>
<span id="cb5-436"><a href="#cb5-436" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (source <span class="op">===</span> <span class="kw">undefined</span>) {</span>
<span id="cb5-437"><a href="#cb5-437" aria-hidden="true" tabindex="-1"></a>    source <span class="op">=</span> target<span class="op">;</span></span>
<span id="cb5-438"><a href="#cb5-438" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>source<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb5-439"><a href="#cb5-439" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-440"><a href="#cb5-440" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">sourceInputHandler</span>() {</span>
<span id="cb5-441"><a href="#cb5-441" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-442"><a href="#cb5-442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTransform</span>(target)<span class="op">.</span><span class="fu">to</span>(<span class="fu">transform</span>(source<span class="op">.</span><span class="at">value</span>))<span class="op">.</span><span class="fu">andDispatchEvent</span>()<span class="op">;</span></span>
<span id="cb5-443"><a href="#cb5-443" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-444"><a href="#cb5-444" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-445"><a href="#cb5-445" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">targetInputHandler</span>() {</span>
<span id="cb5-446"><a href="#cb5-446" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-447"><a href="#cb5-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTransform</span>(source)<span class="op">.</span><span class="fu">to</span>(<span class="fu">invert</span>(target<span class="op">.</span><span class="at">value</span>))<span class="op">.</span><span class="fu">andDispatchEvent</span>()<span class="op">;</span></span>
<span id="cb5-448"><a href="#cb5-448" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-449"><a href="#cb5-449" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-450"><a href="#cb5-450" aria-hidden="true" tabindex="-1"></a>  source<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-451"><a href="#cb5-451" aria-hidden="true" tabindex="-1"></a>  target<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-452"><a href="#cb5-452" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb5-453"><a href="#cb5-453" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb5-454"><a href="#cb5-454" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb5-455"><a href="#cb5-455" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-456"><a href="#cb5-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-457"><a href="#cb5-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sourceInputHandler</span>()<span class="op">;</span></span>
<span id="cb5-458"><a href="#cb5-458" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> target<span class="op">;</span></span>
<span id="cb5-459"><a href="#cb5-459" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-460"><a href="#cb5-460" aria-hidden="true" tabindex="-1"></a>setTransform <span class="op">=</span> (input) <span class="kw">=&gt;</span> ({<span class="dt">to</span><span class="op">:</span> (value) <span class="kw">=&gt;</span> (input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">,</span> {<span class="dt">andDispatchEvent</span><span class="op">:</span> (<span class="bu">event</span> <span class="op">=</span> <span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span>)) <span class="kw">=&gt;</span> input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="bu">event</span>)})})<span class="op">;</span></span>
<span id="cb5-461"><a href="#cb5-461" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">inverse</span>(f) {</span>
<span id="cb5-462"><a href="#cb5-462" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span> (f) {</span>
<span id="cb5-463"><a href="#cb5-463" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="dt">identity</span><span class="op">:</span>  <span class="cf">return</span> identity<span class="op">;</span></span>
<span id="cb5-464"><a href="#cb5-464" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span><span class="op">:</span> <span class="cf">return</span> square<span class="op">;</span></span>
<span id="cb5-465"><a href="#cb5-465" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span><span class="op">:</span>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span><span class="op">;</span></span>
<span id="cb5-466"><a href="#cb5-466" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span><span class="op">:</span>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span><span class="op">;</span></span>
<span id="cb5-467"><a href="#cb5-467" aria-hidden="true" tabindex="-1"></a>    <span class="cf">default</span><span class="op">:</span>        <span class="cf">return</span> (x <span class="kw">=&gt;</span> <span class="fu">solve</span>(f<span class="op">,</span> x<span class="op">,</span> x))<span class="op">;</span></span>
<span id="cb5-468"><a href="#cb5-468" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-469"><a href="#cb5-469" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">solve</span>(f<span class="op">,</span> y<span class="op">,</span> x <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-470"><a href="#cb5-470" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dx <span class="op">=</span> <span class="fl">1e-6</span><span class="op">;</span></span>
<span id="cb5-471"><a href="#cb5-471" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> steps <span class="op">=</span> <span class="dv">100</span><span class="op">,</span> deltax<span class="op">,</span> fx<span class="op">,</span> dfx<span class="op">;</span></span>
<span id="cb5-472"><a href="#cb5-472" aria-hidden="true" tabindex="-1"></a>    <span class="cf">do</span> {</span>
<span id="cb5-473"><a href="#cb5-473" aria-hidden="true" tabindex="-1"></a>      fx <span class="op">=</span> <span class="fu">f</span>(x)</span>
<span id="cb5-474"><a href="#cb5-474" aria-hidden="true" tabindex="-1"></a>      dfx <span class="op">=</span> (<span class="fu">f</span>(x <span class="op">+</span> dx) <span class="op">-</span> fx) <span class="op">||</span> dx<span class="op">;</span></span>
<span id="cb5-475"><a href="#cb5-475" aria-hidden="true" tabindex="-1"></a>      deltax <span class="op">=</span> dx <span class="op">*</span> (fx <span class="op">-</span> y)<span class="op">/</span>dfx</span>
<span id="cb5-476"><a href="#cb5-476" aria-hidden="true" tabindex="-1"></a>      x <span class="op">-=</span> deltax<span class="op">;</span></span>
<span id="cb5-477"><a href="#cb5-477" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">while</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(deltax) <span class="op">&gt;</span> dx <span class="op">&amp;&amp;</span> <span class="op">--</span>steps <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb5-478"><a href="#cb5-478" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> steps <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="kw">NaN</span> <span class="op">:</span> x<span class="op">;</span></span>
<span id="cb5-479"><a href="#cb5-479" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-480"><a href="#cb5-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-481"><a href="#cb5-481" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">square</span>(x) {</span>
<span id="cb5-482"><a href="#cb5-482" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> x<span class="op">;</span></span>
<span id="cb5-483"><a href="#cb5-483" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-484"><a href="#cb5-484" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-485"><a href="#cb5-485" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">identity</span>(x) {</span>
<span id="cb5-486"><a href="#cb5-486" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb5-487"><a href="#cb5-487" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-488"><a href="#cb5-488" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor</span></span>
<span id="cb5-489"><a href="#cb5-489" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setStyle</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb5-490"><a href="#cb5-490" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb5-491"><a href="#cb5-491" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb5-492"><a href="#cb5-492" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb5-493"><a href="#cb5-493" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-494"><a href="#cb5-494" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb5-495"><a href="#cb5-495" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb5-496"><a href="#cb5-496" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;=</span> <span class="fl">0.6</span> <span class="op">?</span> <span class="st">"#111"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-497"><a href="#cb5-497" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 1px"</span><span class="op">,</span></span>
<span id="cb5-498"><a href="#cb5-498" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb5-499"><a href="#cb5-499" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb5-500"><a href="#cb5-500" aria-hidden="true" tabindex="-1"></a>    fontSize <span class="op">=</span> <span class="st">"1em"</span><span class="op">,</span></span>
<span id="cb5-501"><a href="#cb5-501" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb5-502"><a href="#cb5-502" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb5-503"><a href="#cb5-503" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb5-504"><a href="#cb5-504" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb5-505"><a href="#cb5-505" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb5-506"><a href="#cb5-506" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb5-507"><a href="#cb5-507" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb5-508"><a href="#cb5-508" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb5-509"><a href="#cb5-509" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb5-510"><a href="#cb5-510" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb5-511"><a href="#cb5-511" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-512"><a href="#cb5-512" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb5-513"><a href="#cb5-513" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2doty</span>(days <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb5-514"><a href="#cb5-514" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb5-515"><a href="#cb5-515" aria-hidden="true" tabindex="-1"></a>        dotc <span class="op">=</span> days <span class="op">-</span> era <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb5-516"><a href="#cb5-516" aria-hidden="true" tabindex="-1"></a>        yotc <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dotc <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)) <span class="op">/</span> <span class="dv">365</span>)<span class="op">;</span></span>
<span id="cb5-517"><a href="#cb5-517" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [yotc <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">,</span> dotc <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">100</span>) <span class="op">-</span> yotc <span class="op">*</span> <span class="dv">365</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">4</span>)]<span class="op">;</span></span>
<span id="cb5-518"><a href="#cb5-518" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-519"><a href="#cb5-519" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2doty</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-520"><a href="#cb5-520" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">dote2doty</span>(ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span>)</span>
<span id="cb5-521"><a href="#cb5-521" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-522"><a href="#cb5-522" aria-hidden="true" tabindex="-1"></a><span class="co">// https://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb5-523"><a href="#cb5-523" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2dote</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-524"><a href="#cb5-524" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cycle <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((year <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> year <span class="op">:</span> year <span class="op">-</span> <span class="dv">399</span>) <span class="op">/</span> <span class="dv">400</span>)<span class="op">,</span></span>
<span id="cb5-525"><a href="#cb5-525" aria-hidden="true" tabindex="-1"></a>    yote <span class="op">=</span> year <span class="op">-</span> cycle <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb5-526"><a href="#cb5-526" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle <span class="op">*</span> <span class="dv">146097</span> <span class="op">+</span> yote <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">4</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">100</span>) <span class="op">+</span> doty <span class="op">-</span> zone</span>
<span id="cb5-527"><a href="#cb5-527" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-528"><a href="#cb5-528" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2deco</span>(yearDoty <span class="op">=</span> [<span class="dv">1969</span><span class="op">,</span> <span class="dv">306</span>]<span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-529"><a href="#cb5-529" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yd <span class="op">=</span> <span class="fu">dote2doty</span>(<span class="fu">doty2dote</span>(yearDoty[<span class="dv">0</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yearDoty[<span class="dv">1</span>])))<span class="op">;</span></span>
<span id="cb5-530"><a href="#cb5-530" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>yd[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span>(yd[<span class="dv">1</span>])<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}${</span></span>
<span id="cb5-531"><a href="#cb5-531" aria-hidden="true" tabindex="-1"></a>        yearDoty[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">includes</span>(<span class="st">"."</span>) <span class="op">?</span> <span class="st">"."</span> <span class="op">+</span> (</span>
<span id="cb5-532"><a href="#cb5-532" aria-hidden="true" tabindex="-1"></a>            (yearDoty[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">?</span> (yearDoty[<span class="dv">1</span>] <span class="op">-</span> zone)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)<span class="op">.</span><span class="fu">pop</span>()</span>
<span id="cb5-533"><a href="#cb5-533" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> [<span class="op">...</span>(yearDoty[<span class="dv">1</span>] <span class="op">-</span> zone)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)<span class="op">.</span><span class="fu">pop</span>()]<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb5-534"><a href="#cb5-534" aria-hidden="true" tabindex="-1"></a>                (e<span class="op">,</span> i<span class="op">,</span> a) <span class="kw">=&gt;</span> (i <span class="op">+</span> <span class="dv">1</span> <span class="op">===</span> a<span class="op">.</span><span class="at">length</span>) <span class="op">?</span> <span class="dv">10</span> <span class="op">-</span> e <span class="op">:</span> <span class="dv">9</span> <span class="op">-</span> e</span>
<span id="cb5-535"><a href="#cb5-535" aria-hidden="true" tabindex="-1"></a>            )<span class="op">.</span><span class="fu">join</span>(<span class="st">""</span>)</span>
<span id="cb5-536"><a href="#cb5-536" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">:</span> <span class="st">""</span></span>
<span id="cb5-537"><a href="#cb5-537" aria-hidden="true" tabindex="-1"></a>    <span class="sc">}</span><span class="vs">`</span></span>
<span id="cb5-538"><a href="#cb5-538" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-539"><a href="#cb5-539" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2deco</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-540"><a href="#cb5-540" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2deco</span>(<span class="fu">unix2doty</span>(ms))<span class="op">;</span></span>
<span id="cb5-541"><a href="#cb5-541" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb5-542"><a href="#cb5-542" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb5-543"><a href="#cb5-543" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greg2doty</span>(month <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> day <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb5-544"><a href="#cb5-544" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb5-545"><a href="#cb5-545" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> day <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb5-546"><a href="#cb5-546" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb5-547"><a href="#cb5-547" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb5-548"><a href="#cb5-548" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2greg</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-549"><a href="#cb5-549" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb5-550"><a href="#cb5-550" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(m <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> m <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> m <span class="op">-</span> <span class="dv">9</span>)<span class="op">,</span> doty <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">153</span> <span class="op">*</span> m <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb5-551"><a href="#cb5-551" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-552"><a href="#cb5-552" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2toty</span>(doty <span class="op">=</span> <span class="dv">306</span>) {</span>
<span id="cb5-553"><a href="#cb5-553" aria-hidden="true" tabindex="-1"></a>    doty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty)</span>
<span id="cb5-554"><a href="#cb5-554" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">205</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">295</span>) <span class="op">?</span> [<span class="st">"Fall🍁"</span><span class="op">,</span> <span class="st">"Spring🌼"</span>] <span class="op">:</span></span>
<span id="cb5-555"><a href="#cb5-555" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">110</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">205</span>) <span class="op">?</span> [<span class="st">"Summer☀️"</span><span class="op">,</span> <span class="st">"Winter❄️"</span>] <span class="op">:</span></span>
<span id="cb5-556"><a href="#cb5-556" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">20</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">110</span>) <span class="op">?</span> [<span class="st">"Spring🌼"</span><span class="op">,</span> <span class="st">"Fall🍁"</span>] <span class="op">:</span></span>
<span id="cb5-557"><a href="#cb5-557" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">0</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">20</span>) <span class="op">||</span> (<span class="dv">295</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;=</span> <span class="dv">365</span>)</span>
<span id="cb5-558"><a href="#cb5-558" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> [<span class="st">"Winter❄️"</span><span class="op">,</span> <span class="st">"Summer☀️"</span>] <span class="op">:</span> <span class="st">"Unknown"</span></span>
<span id="cb5-559"><a href="#cb5-559" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-560"><a href="#cb5-560" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2zodi</span>(doty <span class="op">=</span> <span class="dv">306</span>) {</span>
<span id="cb5-561"><a href="#cb5-561" aria-hidden="true" tabindex="-1"></a>    doty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty)</span>
<span id="cb5-562"><a href="#cb5-562" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">20</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">50</span>) <span class="op">?</span> <span class="st">"Aries♈️"</span> <span class="op">:</span></span>
<span id="cb5-563"><a href="#cb5-563" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">50</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">81</span>) <span class="op">?</span> <span class="st">"Taurus♉️"</span> <span class="op">:</span></span>
<span id="cb5-564"><a href="#cb5-564" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">81</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">112</span>) <span class="op">?</span> <span class="st">"Gemini♊️"</span> <span class="op">:</span></span>
<span id="cb5-565"><a href="#cb5-565" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">112</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">144</span>) <span class="op">?</span> <span class="st">"Cancer♋️"</span> <span class="op">:</span></span>
<span id="cb5-566"><a href="#cb5-566" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">144</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">175</span>) <span class="op">?</span> <span class="st">"Leo♌️"</span> <span class="op">:</span></span>
<span id="cb5-567"><a href="#cb5-567" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">175</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">206</span>) <span class="op">?</span> <span class="st">"Virgo♍️"</span> <span class="op">:</span></span>
<span id="cb5-568"><a href="#cb5-568" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">206</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">236</span>) <span class="op">?</span> <span class="st">"Libra♎️"</span> <span class="op">:</span></span>
<span id="cb5-569"><a href="#cb5-569" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">236</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">266</span>) <span class="op">?</span> <span class="st">"Scorpio♏️"</span> <span class="op">:</span></span>
<span id="cb5-570"><a href="#cb5-570" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">266</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">296</span>) <span class="op">?</span> <span class="st">"Sagittarius♐️"</span> <span class="op">:</span></span>
<span id="cb5-571"><a href="#cb5-571" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">296</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">325</span>) <span class="op">?</span> <span class="st">"Capricorn♑️"</span> <span class="op">:</span></span>
<span id="cb5-572"><a href="#cb5-572" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">325</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">355</span>) <span class="op">?</span> <span class="st">"Aquarius♒️"</span> <span class="op">:</span></span>
<span id="cb5-573"><a href="#cb5-573" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">355</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;=</span> <span class="dv">365</span>) <span class="op">||</span> (<span class="dv">0</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">20</span>)</span>
<span id="cb5-574"><a href="#cb5-574" aria-hidden="true" tabindex="-1"></a>     <span class="op">?</span> <span class="st">"Pisces♓️"</span> <span class="op">:</span> <span class="st">"Unknown"</span></span>
<span id="cb5-575"><a href="#cb5-575" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-576"><a href="#cb5-576" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2month</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-577"><a href="#cb5-577" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb5-578"><a href="#cb5-578" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(m <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> m <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> m <span class="op">-</span> <span class="dv">9</span>)<span class="op">;</span></span>
<span id="cb5-579"><a href="#cb5-579" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-580"><a href="#cb5-580" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">month2doty</span>(month <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb5-581"><a href="#cb5-581" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb5-582"><a href="#cb5-582" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span></span>
<span id="cb5-583"><a href="#cb5-583" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb5-584"><a href="#cb5-584" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2dotm</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb5-585"><a href="#cb5-585" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb5-586"><a href="#cb5-586" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> doty <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">153</span> <span class="op">*</span> m <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-587"><a href="#cb5-587" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-5-19" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="variables" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Variables</h2><div class="quarto-appendix-contents">

<div class="cell" data-output="all">
<div class="sourceCode cell-code" id="cb6" data-startfrom="594" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 593;"><span id="cb6-594"><a href="#cb6-594" aria-hidden="true" tabindex="-1"></a>width</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb7" data-startfrom="595" data-source-offset="-6"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 594;"><span id="cb7-595"><a href="#cb7-595" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> {</span>
<span id="cb7-596"><a href="#cb7-596" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="kw">true</span>) {</span>
<span id="cb7-597"><a href="#cb7-597" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()<span class="op">;</span></span>
<span id="cb7-598"><a href="#cb7-598" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-599"><a href="#cb7-599" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-600"><a href="#cb7-600" aria-hidden="true" tabindex="-1"></a>tick <span class="op">=</span> {</span>
<span id="cb7-601"><a href="#cb7-601" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-602"><a href="#cb7-602" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb7-603"><a href="#cb7-603" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> Promises<span class="op">.</span><span class="fu">tick</span>(<span class="dv">864</span><span class="op">,</span> <span class="op">++</span>i)<span class="op">;</span></span>
<span id="cb7-604"><a href="#cb7-604" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-605"><a href="#cb7-605" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-606"><a href="#cb7-606" aria-hidden="true" tabindex="-1"></a>tickTime <span class="op">=</span> tick <span class="op">%</span> <span class="fl">1e5</span></span>
<span id="cb7-607"><a href="#cb7-607" aria-hidden="true" tabindex="-1"></a>barTime <span class="op">=</span> <span class="fu">unix2dote</span>(unix)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">1</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb7-608"><a href="#cb7-608" aria-hidden="true" tabindex="-1"></a>barCents <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb7-609"><a href="#cb7-609" aria-hidden="true" tabindex="-1"></a>barMils <span class="op">=</span> barTime[<span class="dv">2</span>]</span>
<span id="cb7-610"><a href="#cb7-610" aria-hidden="true" tabindex="-1"></a>barBeats <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb7-611"><a href="#cb7-611" aria-hidden="true" tabindex="-1"></a>barMb <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span>)</span>
<span id="cb7-612"><a href="#cb7-612" aria-hidden="true" tabindex="-1"></a>deco <span class="op">=</span> <span class="fu">unix2deco</span>(unix)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">14</span>)</span>
<span id="cb7-613"><a href="#cb7-613" aria-hidden="true" tabindex="-1"></a>doty <span class="op">=</span> deco<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span>)</span>
<span id="cb7-614"><a href="#cb7-614" aria-hidden="true" tabindex="-1"></a>dotyDate <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>)</span>
<span id="cb7-615"><a href="#cb7-615" aria-hidden="true" tabindex="-1"></a>dotyTime <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span>)</span>
<span id="cb7-616"><a href="#cb7-616" aria-hidden="true" tabindex="-1"></a>dotyDek <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb7-617"><a href="#cb7-617" aria-hidden="true" tabindex="-1"></a>dotyDotd <span class="op">=</span> doty[<span class="dv">2</span>]</span>
<span id="cb7-618"><a href="#cb7-618" aria-hidden="true" tabindex="-1"></a>iso <span class="op">=</span> {</span>
<span id="cb7-619"><a href="#cb7-619" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="kw">true</span>) {</span>
<span id="cb7-620"><a href="#cb7-620" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">toISOString</span>()</span>
<span id="cb7-621"><a href="#cb7-621" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-622"><a href="#cb7-622" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-623"><a href="#cb7-623" aria-hidden="true" tabindex="-1"></a>isoDate <span class="op">=</span> iso<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb7-624"><a href="#cb7-624" aria-hidden="true" tabindex="-1"></a>isoTime <span class="op">=</span> iso<span class="op">.</span><span class="fu">slice</span>(<span class="dv">11</span><span class="op">,</span> <span class="dv">19</span>)</span>
<span id="cb7-625"><a href="#cb7-625" aria-hidden="true" tabindex="-1"></a>season <span class="op">=</span> <span class="fu">doty2toty</span>(dotyDate)</span>
<span id="cb7-626"><a href="#cb7-626" aria-hidden="true" tabindex="-1"></a>zodiac <span class="op">=</span> <span class="fu">doty2zodi</span>(dotyDate)</span>
<span id="cb7-627"><a href="#cb7-627" aria-hidden="true" tabindex="-1"></a>inputDotySeason <span class="op">=</span> <span class="fu">doty2toty</span>(inputDoty)</span>
<span id="cb7-628"><a href="#cb7-628" aria-hidden="true" tabindex="-1"></a>inputDotyZodiac <span class="op">=</span> <span class="fu">doty2zodi</span>(inputDoty)</span>
<span id="cb7-629"><a href="#cb7-629" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">366</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-6-23" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-startfrom="633" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 632;"><span id="cb8-633"><a href="#cb8-633" aria-hidden="true" tabindex="-1"></a>styledYear <span class="op">=</span> <span class="fu">setStyle</span>(deco<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb8-634"><a href="#cb8-634" aria-hidden="true" tabindex="-1"></a>styledDotyDate <span class="op">=</span> <span class="fu">setStyle</span>(dotyDate<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb8-635"><a href="#cb8-635" aria-hidden="true" tabindex="-1"></a>styledDotyTime <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb8-636"><a href="#cb8-636" aria-hidden="true" tabindex="-1"></a>styledDotyDate1 <span class="op">=</span> <span class="fu">setStyle</span>(dotyDate<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb8-637"><a href="#cb8-637" aria-hidden="true" tabindex="-1"></a>styledDotyTime1 <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb8-638"><a href="#cb8-638" aria-hidden="true" tabindex="-1"></a>styledTickTime <span class="op">=</span> <span class="fu">setStyle</span>(tickTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb8-639"><a href="#cb8-639" aria-hidden="true" tabindex="-1"></a>styledDek <span class="op">=</span> <span class="fu">setStyle</span>(dotyDek<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">0</span>])</span>
<span id="cb8-640"><a href="#cb8-640" aria-hidden="true" tabindex="-1"></a>styledDotd <span class="op">=</span> <span class="fu">setStyle</span>(dotyDotd<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">9</span>])</span>
<span id="cb8-641"><a href="#cb8-641" aria-hidden="true" tabindex="-1"></a>styledCent <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">7</span>])</span>
<span id="cb8-642"><a href="#cb8-642" aria-hidden="true" tabindex="-1"></a>styledMil <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime[<span class="dv">2</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">6</span>])</span>
<span id="cb8-643"><a href="#cb8-643" aria-hidden="true" tabindex="-1"></a>styledBeat <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">5</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">11</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-7-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="set-values" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Set values</h2><div class="quarto-appendix-contents">

<div class="cell">
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="649" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 648;"><span id="cb9-649"><a href="#cb9-649" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof inputDoty<span class="op">,</span> scrubberDoty)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="654" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 653;"><span id="cb10-654"><a href="#cb10-654" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof decoOutput<span class="op">,</span> <span class="vs">`1969+</span><span class="sc">${</span>scrubberDeco<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="expression">

</div>
</div>
</div>
</div></section><section id="sec-ojs-code-deco" class="level4 appendix"><h2 class="anchored quarto-appendix-heading"><code>Deco</code> Observable code</h2><div class="quarto-appendix-contents">



</div></section><section id="functions-1" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Functions</h2><div class="quarto-appendix-contents">

<div class="sourceCode" id="cb15"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>copyq<span class="op">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2doty</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> days <span class="op">=</span> ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span><span class="op">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        dote <span class="op">=</span> days <span class="op">-</span> (era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)) <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        year <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dote <span class="op">-</span> dote <span class="op">/</span> <span class="dv">1460</span> <span class="op">+</span> dote <span class="op">/</span> <span class="dv">36524</span> <span class="op">-</span> dote <span class="op">/</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">365</span>) <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [year<span class="op">,</span> days <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(year <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">4</span> <span class="op">-</span> year <span class="op">/</span> <span class="dv">100</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">400</span>)]<span class="op">;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> [year<span class="op">,</span> doty] <span class="op">=</span> <span class="fu">unix2doty</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())<span class="op">,</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    datetime <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>year<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    (day <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty))<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">.</span><span class="sc">${</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    (<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>((doty <span class="op">-</span> day) <span class="op">*</span> <span class="fl">1e5</span>))<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">5</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">+0`</span><span class="op">;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">copy</span>(datetime)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">copySelection</span>(datetime)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" data-startfrom="753" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 752;"><span id="cb16-753"><a href="#cb16-753" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">zone2hour</span>(zone <span class="op">=</span> <span class="st">"Z"</span>) {</span>
<span id="cb16-754"><a href="#cb16-754" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (zone <span class="op">=</span> zone<span class="op">.</span><span class="fu">toUpperCase</span>()) <span class="op">==</span> <span class="st">"Z"</span> <span class="op">?</span> <span class="dv">0</span></span>
<span id="cb16-755"><a href="#cb16-755" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&gt;</span> <span class="st">"@"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&lt;</span> <span class="st">"J"</span> <span class="op">?</span> zone<span class="op">.</span><span class="fu">charCodeAt</span>() <span class="op">-</span> <span class="dv">64</span></span>
<span id="cb16-756"><a href="#cb16-756" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&gt;</span> <span class="st">"J"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&lt;</span> <span class="st">"N"</span> <span class="op">?</span> zone<span class="op">.</span><span class="fu">charCodeAt</span>() <span class="op">-</span> <span class="dv">65</span></span>
<span id="cb16-757"><a href="#cb16-757" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&lt;</span> <span class="st">"Z"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&gt;</span> <span class="st">"M"</span> <span class="op">?</span> <span class="op">-</span>(zone<span class="op">.</span><span class="fu">charCodeAt</span>() <span class="op">-</span> <span class="dv">77</span>)</span>
<span id="cb16-758"><a href="#cb16-758" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone<span class="op">;</span></span>
<span id="cb16-759"><a href="#cb16-759" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-760"><a href="#cb16-760" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">deco2doty</span>(timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span>) {</span>
<span id="cb16-761"><a href="#cb16-761" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> arr <span class="op">=</span> timestamp<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=</span><span class="sc">[+-]|[a-zA-Z])</span><span class="ss">/</span><span class="op">,</span> <span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb16-762"><a href="#cb16-762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span> (arr<span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb16-763"><a href="#cb16-763" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span> <span class="cf">return</span> [<span class="fu">unix2doty</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())[<span class="dv">0</span>]<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb16-764"><a href="#cb16-764" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span> <span class="cf">return</span> (<span class="ss">/</span><span class="sc">^[a-zA-Z]+$</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(arr[<span class="dv">1</span>]))</span>
<span id="cb16-765"><a href="#cb16-765" aria-hidden="true" tabindex="-1"></a>            <span class="op">?</span> [<span class="fu">unix2doty</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>())[<span class="dv">0</span>]<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="fu">zone2hour</span>(arr[<span class="dv">1</span>]) <span class="op">/</span> <span class="dv">24</span>]</span>
<span id="cb16-766"><a href="#cb16-766" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> [<span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">1</span>])<span class="op">,</span> <span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb16-767"><a href="#cb16-767" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb16-768"><a href="#cb16-768" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="pp">parseFloat</span>(arr[<span class="dv">0</span>])<span class="op">,</span> <span class="pp">parseFloat</span>(arr[<span class="dv">1</span>])<span class="op">,</span> <span class="ss">/</span><span class="sc">^[a-zA-Z]+$</span><span class="ss">/</span><span class="op">.</span><span class="fu">test</span>(arr[<span class="dv">2</span>])</span>
<span id="cb16-769"><a href="#cb16-769" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> <span class="fu">zone2hour</span>(arr[<span class="dv">2</span>]) <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb16-770"><a href="#cb16-770" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="pp">parseFloat</span>(arr[<span class="dv">2</span>]<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">([+-])</span><span class="ss">/</span><span class="op">,</span> <span class="st">"$1</span><span class="sc">\.</span><span class="st">"</span>))]<span class="op">;</span></span>
<span id="cb16-771"><a href="#cb16-771" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-772"><a href="#cb16-772" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">deco2deco</span>(timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span>) {</span>
<span id="cb16-773"><a href="#cb16-773" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2deco</span>(<span class="fu">deco2doty</span>(timestamp))</span>
<span id="cb16-774"><a href="#cb16-774" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-775"><a href="#cb16-775" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2doty</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-776"><a href="#cb16-776" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2doty</span>(<span class="fu">doty2dote</span>(year<span class="op">,</span> doty<span class="op">,</span> zone))<span class="op">;</span></span>
<span id="cb16-777"><a href="#cb16-777" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-778"><a href="#cb16-778" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2unix</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-779"><a href="#cb16-779" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="fu">doty2dote</span>(year<span class="op">,</span> doty<span class="op">,</span> zone) <span class="op">-</span> <span class="dv">719468</span>) <span class="op">*</span> <span class="dv">86400000</span><span class="op">;</span></span>
<span id="cb16-780"><a href="#cb16-780" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-781"><a href="#cb16-781" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2isoc</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-782"><a href="#cb16-782" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="fu">doty2unix</span>(year<span class="op">,</span> doty<span class="op">,</span> zone))<span class="op">.</span><span class="fu">toISOString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">0</span>]</span>
<span id="cb16-783"><a href="#cb16-783" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-784"><a href="#cb16-784" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">deco2isoc</span>(timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span>) {</span>
<span id="cb16-785"><a href="#cb16-785" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2isoc</span>(<span class="op">...</span><span class="fu">deco2doty</span>(timestamp))</span>
<span id="cb16-786"><a href="#cb16-786" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-787"><a href="#cb16-787" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2dote</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-788"><a href="#cb16-788" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span><span class="op">;</span></span>
<span id="cb16-789"><a href="#cb16-789" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-790"><a href="#cb16-790" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2year</span>(days <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb16-791"><a href="#cb16-791" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb16-792"><a href="#cb16-792" aria-hidden="true" tabindex="-1"></a>        dotc <span class="op">=</span> days <span class="op">-</span> era <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb16-793"><a href="#cb16-793" aria-hidden="true" tabindex="-1"></a>        yotc <span class="op">=</span> (dotc <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)) <span class="op">/</span> <span class="dv">365</span><span class="op">;</span></span>
<span id="cb16-794"><a href="#cb16-794" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> yotc <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb16-795"><a href="#cb16-795" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-796"><a href="#cb16-796" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2year</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-797"><a href="#cb16-797" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2year</span>(<span class="fu">doty2dote</span>(year<span class="op">,</span> doty<span class="op">,</span> zone))<span class="op">;</span></span>
<span id="cb16-798"><a href="#cb16-798" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-799"><a href="#cb16-799" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2year</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb16-800"><a href="#cb16-800" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2year</span>(<span class="fu">unix2dote</span>(ms))<span class="op">;</span></span>
<span id="cb16-801"><a href="#cb16-801" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-14-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="variables-1" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Variables</h2><div class="quarto-appendix-contents">

<div class="cell" data-output="all">
<div class="sourceCode cell-code" id="cb17" data-startfrom="808" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 807;"><span id="cb17-808"><a href="#cb17-808" aria-hidden="true" tabindex="-1"></a>tzOffsetInMs <span class="op">=</span> inputDatetime<span class="op">.</span><span class="fu">getTimezoneOffset</span>() <span class="op">*</span> <span class="dv">60000</span></span>
<span id="cb17-809"><a href="#cb17-809" aria-hidden="true" tabindex="-1"></a>utcDatetime <span class="op">=</span> inputDatetime <span class="op">-</span> tzOffsetInMs</span>
<span id="cb17-810"><a href="#cb17-810" aria-hidden="true" tabindex="-1"></a>outputDatetimeDeco <span class="op">=</span> <span class="fu">unix2deco</span>(utcDatetime)</span>
<span id="cb17-811"><a href="#cb17-811" aria-hidden="true" tabindex="-1"></a>dtDoty <span class="op">=</span> outputDatetimeDeco<span class="op">.</span><span class="fu">split</span>(<span class="st">"+"</span>)[<span class="dv">1</span>]</span>
<span id="cb17-812"><a href="#cb17-812" aria-hidden="true" tabindex="-1"></a>dtDotyDateRaw <span class="op">=</span> dtDoty<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">0</span>]</span>
<span id="cb17-813"><a href="#cb17-813" aria-hidden="true" tabindex="-1"></a>dtDotyTimeRaw <span class="op">=</span> dtDoty<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">1</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb17-814"><a href="#cb17-814" aria-hidden="true" tabindex="-1"></a>outputDatetimeYear <span class="op">=</span> <span class="fu">unix2year</span>(utcDatetime)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb17-815"><a href="#cb17-815" aria-hidden="true" tabindex="-1"></a>dtDotyTimeDelimiter <span class="op">=</span> dtDotyTimeRaw <span class="op">?</span> <span class="st">"."</span> <span class="op">:</span> <span class="st">""</span></span>
<span id="cb17-816"><a href="#cb17-816" aria-hidden="true" tabindex="-1"></a>outputDecoYear <span class="op">=</span> <span class="fu">doty2year</span>(<span class="op">...</span>yd)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb17-817"><a href="#cb17-817" aria-hidden="true" tabindex="-1"></a>outputIsoc <span class="op">=</span> <span class="fu">doty2isoc</span>(<span class="op">...</span>yd)</span>
<span id="cb17-818"><a href="#cb17-818" aria-hidden="true" tabindex="-1"></a>yearDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(<span class="fu">unix2year</span>(unix) <span class="op">*</span> <span class="fl">1e3</span>) <span class="op">/</span> <span class="fl">1e3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-15-11" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" data-startfrom="822" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 821;"><span id="cb18-822"><a href="#cb18-822" aria-hidden="true" tabindex="-1"></a>dtYear <span class="op">=</span> <span class="fu">setStyle</span>(outputDatetimeDeco<span class="op">.</span><span class="fu">split</span>(<span class="st">"+"</span>)[<span class="dv">0</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb18-823"><a href="#cb18-823" aria-hidden="true" tabindex="-1"></a>dtDotyDate <span class="op">=</span> <span class="fu">setStyle</span>(dtDotyDateRaw<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb18-824"><a href="#cb18-824" aria-hidden="true" tabindex="-1"></a>dtDotyTime <span class="op">=</span> dtDotyTimeRaw <span class="op">?</span> <span class="fu">setStyle</span>(dtDotyTimeRaw<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>]) <span class="op">:</span> <span class="st">""</span></span>
<span id="cb18-825"><a href="#cb18-825" aria-hidden="true" tabindex="-1"></a>styledIsocYear <span class="op">=</span> <span class="fu">setStyle</span>(outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb18-826"><a href="#cb18-826" aria-hidden="true" tabindex="-1"></a>styledIsocMd <span class="op">=</span> <span class="fu">setStyle</span>(outputIsoc<span class="op">.</span><span class="fu">slice</span>(outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span><span class="op">+</span><span class="dv">1</span><span class="op">,</span>outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span><span class="op">+</span><span class="dv">6</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">5</span>])</span>
<span id="cb18-827"><a href="#cb18-827" aria-hidden="true" tabindex="-1"></a>styledIsocTime <span class="op">=</span> <span class="fu">setStyle</span>(outputIsoc<span class="op">.</span><span class="fu">slice</span>(outputIsoc<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=-</span><span class="sc">)</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span><span class="op">+</span><span class="dv">7</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">4</span>])</span>
<span id="cb18-828"><a href="#cb18-828" aria-hidden="true" tabindex="-1"></a>styledOutputDatetimeYear <span class="op">=</span> <span class="fu">setStyle</span>(outputDatetimeYear<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb18-829"><a href="#cb18-829" aria-hidden="true" tabindex="-1"></a>styledOutputDecoYear <span class="op">=</span> <span class="fu">setStyle</span>(outputDecoYear<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-16-8" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="sec-ojs-code-dek" class="level4 appendix"><h2 class="anchored quarto-appendix-heading"><code>Dek</code> Observable code</h2><div class="quarto-appendix-contents">




</div></section><section id="functions-2" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Functions</h2><div class="quarto-appendix-contents">

<div class="cell">
<div class="sourceCode cell-code" id="cb29" data-startfrom="1016" data-source-offset="-50"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1015;"><span id="cb29-1016"><a href="#cb29-1016" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">interval</span>(range <span class="op">=</span> []<span class="op">,</span> options <span class="op">=</span> {}) {</span>
<span id="cb29-1017"><a href="#cb29-1017" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> [min <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> max <span class="op">=</span> <span class="dv">1</span>] <span class="op">=</span> range<span class="op">;</span></span>
<span id="cb29-1018"><a href="#cb29-1018" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb29-1019"><a href="#cb29-1019" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="op">.</span><span class="bn">001</span><span class="op">,</span></span>
<span id="cb29-1020"><a href="#cb29-1020" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb29-1021"><a href="#cb29-1021" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> [min<span class="op">,</span> max]<span class="op">,</span></span>
<span id="cb29-1022"><a href="#cb29-1022" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> ([start<span class="op">,</span> end]) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>start<span class="sc">}</span><span class="vs"> … </span><span class="sc">${</span>end<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb29-1023"><a href="#cb29-1023" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb29-1024"><a href="#cb29-1024" aria-hidden="true" tabindex="-1"></a>    width<span class="op">,</span></span>
<span id="cb29-1025"><a href="#cb29-1025" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">,</span></span>
<span id="cb29-1026"><a href="#cb29-1026" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> options<span class="op">;</span></span>
<span id="cb29-1027"><a href="#cb29-1027" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> __ns__ <span class="op">=</span> DOM<span class="op">.</span><span class="fu">uid</span>(<span class="st">'scope'</span>)<span class="op">.</span><span class="at">id</span><span class="op">;</span></span>
<span id="cb29-1028"><a href="#cb29-1028" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> css <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb29-1029"><a href="#cb29-1029" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb29-1030"><a href="#cb29-1030" aria-hidden="true" tabindex="-1"></a><span class="vs">  font: 13px/1.2 var(--sans-serif);</span></span>
<span id="cb29-1031"><a href="#cb29-1031" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: flex;</span></span>
<span id="cb29-1032"><a href="#cb29-1032" aria-hidden="true" tabindex="-1"></a><span class="vs">  align-items: baseline;</span></span>
<span id="cb29-1033"><a href="#cb29-1033" aria-hidden="true" tabindex="-1"></a><span class="vs">  flex-wrap: wrap;</span></span>
<span id="cb29-1034"><a href="#cb29-1034" aria-hidden="true" tabindex="-1"></a><span class="vs">  max-width: 100%;</span></span>
<span id="cb29-1035"><a href="#cb29-1035" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: auto;</span></span>
<span id="cb29-1036"><a href="#cb29-1036" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1037"><a href="#cb29-1037" aria-hidden="true" tabindex="-1"></a><span class="vs">@media only screen and (min-width: 30em) {</span></span>
<span id="cb29-1038"><a href="#cb29-1038" aria-hidden="true" tabindex="-1"></a><span class="vs">  #</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb29-1039"><a href="#cb29-1039" aria-hidden="true" tabindex="-1"></a><span class="vs">    flex-wrap: nowrap;</span></span>
<span id="cb29-1040"><a href="#cb29-1040" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 360px;</span></span>
<span id="cb29-1041"><a href="#cb29-1041" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb29-1042"><a href="#cb29-1042" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1043"><a href="#cb29-1043" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .label {</span></span>
<span id="cb29-1044"><a href="#cb29-1044" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 50px;</span></span>
<span id="cb29-1045"><a href="#cb29-1045" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 5px 0 4px 0;</span></span>
<span id="cb29-1046"><a href="#cb29-1046" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-right: .5px;</span></span>
<span id="cb29-1047"><a href="#cb29-1047" aria-hidden="true" tabindex="-1"></a><span class="vs">  flex-shrink: 0;</span></span>
<span id="cb29-1048"><a href="#cb29-1048" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1049"><a href="#cb29-1049" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .form {</span></span>
<span id="cb29-1050"><a href="#cb29-1050" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: flex;</span></span>
<span id="cb29-1051"><a href="#cb29-1051" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb29-1052"><a href="#cb29-1052" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1053"><a href="#cb29-1053" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .range {</span></span>
<span id="cb29-1054"><a href="#cb29-1054" aria-hidden="true" tabindex="-1"></a><span class="vs">  flex-shrink: 1;</span></span>
<span id="cb29-1055"><a href="#cb29-1055" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb29-1056"><a href="#cb29-1056" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1057"><a href="#cb29-1057" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs"> .range-slider {</span></span>
<span id="cb29-1058"><a href="#cb29-1058" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb29-1059"><a href="#cb29-1059" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb29-1060"><a href="#cb29-1060" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb29-1061"><a href="#cb29-1061" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> $range <span class="op">=</span> <span class="fu">rangeInput</span>({min<span class="op">,</span> max<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [value[<span class="dv">0</span>]<span class="op">,</span> value[<span class="dv">1</span>]]<span class="op">,</span> step<span class="op">,</span> color<span class="op">,</span> width<span class="op">,</span> theme})<span class="op">;</span></span>
<span id="cb29-1062"><a href="#cb29-1062" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> $output <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;output&gt;`</span><span class="op">;</span></span>
<span id="cb29-1063"><a href="#cb29-1063" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> $view <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div id=</span><span class="sc">${</span>__ns__<span class="sc">}</span><span class="vs">&gt;</span></span>
<span id="cb29-1064"><a href="#cb29-1064" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>label <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="st">''</span> <span class="op">:</span> <span class="fu">html</span><span class="vs">`&lt;div class="label"&gt;</span><span class="sc">${</span>label<span class="sc">}</span><span class="vs">`</span><span class="sc">}</span></span>
<span id="cb29-1065"><a href="#cb29-1065" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div class=form&gt;</span></span>
<span id="cb29-1066"><a href="#cb29-1066" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div class=range&gt;</span></span>
<span id="cb29-1067"><a href="#cb29-1067" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>$range<span class="sc">}</span><span class="vs">&lt;div class=range-output style="display: inline-block;"&gt;</span><span class="sc">${</span>$output<span class="sc">}</span><span class="vs">&lt;/div&gt;</span></span>
<span id="cb29-1068"><a href="#cb29-1068" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;</span></span>
<span id="cb29-1069"><a href="#cb29-1069" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;</span></span>
<span id="cb29-1070"><a href="#cb29-1070" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">html</span><span class="vs">`&lt;style&gt;</span><span class="sc">${</span>css<span class="sc">}</span><span class="vs">`</span><span class="sc">}</span></span>
<span id="cb29-1071"><a href="#cb29-1071" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb29-1072"><a href="#cb29-1072" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> update <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb29-1073"><a href="#cb29-1073" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> content <span class="op">=</span> <span class="fu">format</span>([$range<span class="op">.</span><span class="at">value</span>[<span class="dv">0</span>]<span class="op">,</span> $range<span class="op">.</span><span class="at">value</span>[<span class="dv">1</span>]])<span class="op">;</span></span>
<span id="cb29-1074"><a href="#cb29-1074" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="kw">typeof</span> content <span class="op">===</span> <span class="st">'string'</span>) $output<span class="op">.</span><span class="at">value</span> <span class="op">=</span> content<span class="op">;</span></span>
<span id="cb29-1075"><a href="#cb29-1075" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb29-1076"><a href="#cb29-1076" aria-hidden="true" tabindex="-1"></a>      <span class="cf">while</span>($output<span class="op">.</span><span class="at">lastChild</span>) $output<span class="op">.</span><span class="at">lastChild</span><span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb29-1077"><a href="#cb29-1077" aria-hidden="true" tabindex="-1"></a>      $output<span class="op">.</span><span class="fu">appendChild</span>(content)<span class="op">;</span></span>
<span id="cb29-1078"><a href="#cb29-1078" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1079"><a href="#cb29-1079" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1080"><a href="#cb29-1080" aria-hidden="true" tabindex="-1"></a>  $range<span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> update<span class="op">;</span></span>
<span id="cb29-1081"><a href="#cb29-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>()<span class="op">;</span></span>
<span id="cb29-1082"><a href="#cb29-1082" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">defineProperty</span>($view<span class="op">,</span> <span class="st">'value'</span><span class="op">,</span> {</span>
<span id="cb29-1083"><a href="#cb29-1083" aria-hidden="true" tabindex="-1"></a>    <span class="kw">get</span><span class="op">:</span> () <span class="kw">=&gt;</span> $range<span class="op">.</span><span class="at">value</span><span class="op">,</span></span>
<span id="cb29-1084"><a href="#cb29-1084" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span><span class="op">:</span> ([a<span class="op">,</span> b]) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1085"><a href="#cb29-1085" aria-hidden="true" tabindex="-1"></a>      $range<span class="op">.</span><span class="at">value</span> <span class="op">=</span> [a<span class="op">,</span> b]<span class="op">;</span></span>
<span id="cb29-1086"><a href="#cb29-1086" aria-hidden="true" tabindex="-1"></a>      <span class="fu">update</span>()<span class="op">;</span></span>
<span id="cb29-1087"><a href="#cb29-1087" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-1088"><a href="#cb29-1088" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb29-1089"><a href="#cb29-1089" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1090"><a href="#cb29-1090" aria-hidden="true" tabindex="-1"></a>cssLength <span class="op">=</span> v <span class="kw">=&gt;</span> v <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="kw">typeof</span> v <span class="op">===</span> <span class="st">'number'</span> <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>v<span class="sc">}</span><span class="vs">px`</span> <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>v<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb29-1091"><a href="#cb29-1091" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">randomScope</span>(prefix <span class="op">=</span> <span class="st">'scope-'</span>) {</span>
<span id="cb29-1092"><a href="#cb29-1092" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> prefix <span class="op">+</span> (<span class="bu">performance</span><span class="op">.</span><span class="fu">now</span>() <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>())<span class="op">.</span><span class="fu">toString</span>(<span class="dv">32</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="st">'.'</span><span class="op">,</span> <span class="st">'-'</span>)<span class="op">;</span></span>
<span id="cb29-1093"><a href="#cb29-1093" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1094"><a href="#cb29-1094" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">rangeInput</span>(options <span class="op">=</span> {}) {</span>
<span id="cb29-1095"><a href="#cb29-1095" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb29-1096"><a href="#cb29-1096" aria-hidden="true" tabindex="-1"></a>    min <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb29-1097"><a href="#cb29-1097" aria-hidden="true" tabindex="-1"></a>    max <span class="op">=</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb29-1098"><a href="#cb29-1098" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="st">'any'</span><span class="op">,</span></span>
<span id="cb29-1099"><a href="#cb29-1099" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> defaultValue <span class="op">=</span> [min<span class="op">,</span> max]<span class="op">,</span></span>
<span id="cb29-1100"><a href="#cb29-1100" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb29-1101"><a href="#cb29-1101" aria-hidden="true" tabindex="-1"></a>    width<span class="op">,</span></span>
<span id="cb29-1102"><a href="#cb29-1102" aria-hidden="true" tabindex="-1"></a>    theme <span class="op">=</span> theme_Flat<span class="op">,</span></span>
<span id="cb29-1103"><a href="#cb29-1103" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> options<span class="op">;</span></span>
<span id="cb29-1104"><a href="#cb29-1104" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> controls <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb29-1105"><a href="#cb29-1105" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scope <span class="op">=</span> <span class="fu">randomScope</span>()<span class="op">;</span></span>
<span id="cb29-1106"><a href="#cb29-1106" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> clamp <span class="op">=</span> (a<span class="op">,</span> b<span class="op">,</span> v) <span class="kw">=&gt;</span> v <span class="op">&lt;</span> a <span class="op">?</span> a <span class="op">:</span> v <span class="op">&gt;</span> b <span class="op">?</span> b <span class="op">:</span> v<span class="op">;</span></span>
<span id="cb29-1107"><a href="#cb29-1107" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> html <span class="op">=</span> htl<span class="op">.</span><span class="at">html</span><span class="op">;</span></span>
<span id="cb29-1108"><a href="#cb29-1108" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Will be used to sanitize values while avoiding floating point issues.</span></span>
<span id="cb29-1109"><a href="#cb29-1109" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> input <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;input type=range </span><span class="sc">${</span>{min<span class="op">,</span> max<span class="op">,</span> step}<span class="sc">}</span><span class="vs">&gt;`</span><span class="op">;</span></span>
<span id="cb29-1110"><a href="#cb29-1110" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dom <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class=</span><span class="sc">${</span><span class="vs">`</span><span class="sc">${</span>scope<span class="sc">}</span><span class="vs"> range-slider`</span><span class="sc">}</span><span class="vs"> style=</span><span class="sc">${</span>{</span>
<span id="cb29-1111"><a href="#cb29-1111" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb29-1112"><a href="#cb29-1112" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="fu">cssLength</span>(width)<span class="op">,</span></span>
<span id="cb29-1113"><a href="#cb29-1113" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span></span>
<span id="cb29-1114"><a href="#cb29-1114" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">track</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="range-track"&gt;</span></span>
<span id="cb29-1115"><a href="#cb29-1115" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">zone</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="range-track-zone"&gt;</span></span>
<span id="cb29-1116"><a href="#cb29-1116" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">range</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="range-select" tabindex=0&gt;</span></span>
<span id="cb29-1117"><a href="#cb29-1117" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">min</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="thumb thumb-min" tabindex=0&gt;`</span><span class="sc">}</span></span>
<span id="cb29-1118"><a href="#cb29-1118" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>controls<span class="op">.</span><span class="at">max</span> <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="thumb thumb-max" tabindex=0&gt;`</span><span class="sc">}</span></span>
<span id="cb29-1119"><a href="#cb29-1119" aria-hidden="true" tabindex="-1"></a><span class="vs">      `</span><span class="sc">}</span></span>
<span id="cb29-1120"><a href="#cb29-1120" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span><span class="sc">}</span></span>
<span id="cb29-1121"><a href="#cb29-1121" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="sc">}</span></span>
<span id="cb29-1122"><a href="#cb29-1122" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span><span class="fu">html</span><span class="vs">`&lt;style&gt;</span><span class="sc">${</span>theme<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/:scope</span><span class="sc">\b</span><span class="ss">/g</span><span class="op">,</span> <span class="st">'.'</span><span class="op">+</span>scope)<span class="sc">}</span><span class="vs">`</span><span class="sc">}</span></span>
<span id="cb29-1123"><a href="#cb29-1123" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb29-1124"><a href="#cb29-1124" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> value <span class="op">=</span> []<span class="op">,</span> changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1125"><a href="#cb29-1125" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">defineProperty</span>(dom<span class="op">,</span> <span class="st">'value'</span><span class="op">,</span> {</span>
<span id="cb29-1126"><a href="#cb29-1126" aria-hidden="true" tabindex="-1"></a>    <span class="kw">get</span><span class="op">:</span> () <span class="kw">=&gt;</span> [<span class="op">...</span>value]<span class="op">,</span></span>
<span id="cb29-1127"><a href="#cb29-1127" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span><span class="op">:</span> ([a<span class="op">,</span> b]) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1128"><a href="#cb29-1128" aria-hidden="true" tabindex="-1"></a>      value <span class="op">=</span> <span class="fu">sanitize</span>(a<span class="op">,</span> b)<span class="op">;</span></span>
<span id="cb29-1129"><a href="#cb29-1129" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateRange</span>()<span class="op">;</span></span>
<span id="cb29-1130"><a href="#cb29-1130" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb29-1131"><a href="#cb29-1131" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb29-1132"><a href="#cb29-1132" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sanitize <span class="op">=</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1133"><a href="#cb29-1133" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="pp">isNaN</span>(a) <span class="op">?</span> min <span class="op">:</span> ((input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> a)<span class="op">,</span> input<span class="op">.</span><span class="at">valueAsNumber</span>)<span class="op">;</span></span>
<span id="cb29-1134"><a href="#cb29-1134" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="pp">isNaN</span>(b) <span class="op">?</span> max <span class="op">:</span> ((input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> b)<span class="op">,</span> input<span class="op">.</span><span class="at">valueAsNumber</span>)<span class="op">;</span></span>
<span id="cb29-1135"><a href="#cb29-1135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(a<span class="op">,</span> b)<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(a<span class="op">,</span> b)]<span class="op">;</span></span>
<span id="cb29-1136"><a href="#cb29-1136" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1137"><a href="#cb29-1137" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> updateRange <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb29-1138"><a href="#cb29-1138" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> ratio <span class="op">=</span> v <span class="kw">=&gt;</span> (v <span class="op">-</span> min) <span class="op">/</span> (max <span class="op">-</span> min)<span class="op">;</span></span>
<span id="cb29-1139"><a href="#cb29-1139" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="fu">setProperty</span>(<span class="st">'--range-min'</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">ratio</span>(value[<span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span><span class="sc">}</span><span class="vs">%`</span>)<span class="op">;</span></span>
<span id="cb29-1140"><a href="#cb29-1140" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="fu">setProperty</span>(<span class="st">'--range-max'</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">ratio</span>(value[<span class="dv">1</span>]) <span class="op">*</span> <span class="dv">100</span><span class="sc">}</span><span class="vs">%`</span>)<span class="op">;</span></span>
<span id="cb29-1141"><a href="#cb29-1141" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1142"><a href="#cb29-1142" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dispatch <span class="op">=</span> name <span class="kw">=&gt;</span> {</span>
<span id="cb29-1143"><a href="#cb29-1143" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(name<span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb29-1144"><a href="#cb29-1144" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1145"><a href="#cb29-1145" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> setValue <span class="op">=</span> (vmin<span class="op">,</span> vmax) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1146"><a href="#cb29-1146" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [pmin<span class="op">,</span> pmax] <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb29-1147"><a href="#cb29-1147" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> <span class="fu">sanitize</span>(vmin<span class="op">,</span> vmax)<span class="op">;</span></span>
<span id="cb29-1148"><a href="#cb29-1148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateRange</span>()<span class="op">;</span></span>
<span id="cb29-1149"><a href="#cb29-1149" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Only dispatch if values have changed.</span></span>
<span id="cb29-1150"><a href="#cb29-1150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(pmin <span class="op">===</span> value[<span class="dv">0</span>] <span class="op">&amp;&amp;</span> pmax <span class="op">===</span> value[<span class="dv">1</span>]) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1151"><a href="#cb29-1151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatch</span>(<span class="st">'input'</span>)<span class="op">;</span></span>
<span id="cb29-1152"><a href="#cb29-1152" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-1153"><a href="#cb29-1153" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1154"><a href="#cb29-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setValue</span>(<span class="op">...</span>defaultValue)<span class="op">;</span></span>
<span id="cb29-1155"><a href="#cb29-1155" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mousemove handlers.</span></span>
<span id="cb29-1156"><a href="#cb29-1156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> handlers <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb29-1157"><a href="#cb29-1157" aria-hidden="true" tabindex="-1"></a>    [controls<span class="op">.</span><span class="at">min</span><span class="op">,</span> (dt<span class="op">,</span> ov) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1158"><a href="#cb29-1158" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> v <span class="op">=</span> <span class="fu">clamp</span>(min<span class="op">,</span> ov[<span class="dv">1</span>]<span class="op">,</span> ov[<span class="dv">0</span>] <span class="op">+</span> dt <span class="op">*</span> (max <span class="op">-</span> min))<span class="op">;</span></span>
<span id="cb29-1159"><a href="#cb29-1159" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span>(v<span class="op">,</span> ov[<span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb29-1160"><a href="#cb29-1160" aria-hidden="true" tabindex="-1"></a>    }]<span class="op">,</span></span>
<span id="cb29-1161"><a href="#cb29-1161" aria-hidden="true" tabindex="-1"></a>    [controls<span class="op">.</span><span class="at">max</span><span class="op">,</span> (dt<span class="op">,</span> ov) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1162"><a href="#cb29-1162" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> v <span class="op">=</span> <span class="fu">clamp</span>(ov[<span class="dv">0</span>]<span class="op">,</span> max<span class="op">,</span> ov[<span class="dv">1</span>] <span class="op">+</span> dt <span class="op">*</span> (max <span class="op">-</span> min))<span class="op">;</span></span>
<span id="cb29-1163"><a href="#cb29-1163" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span>(ov[<span class="dv">0</span>]<span class="op">,</span> v)<span class="op">;</span></span>
<span id="cb29-1164"><a href="#cb29-1164" aria-hidden="true" tabindex="-1"></a>    }]<span class="op">,</span></span>
<span id="cb29-1165"><a href="#cb29-1165" aria-hidden="true" tabindex="-1"></a>    [controls<span class="op">.</span><span class="at">range</span><span class="op">,</span> (dt<span class="op">,</span> ov) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1166"><a href="#cb29-1166" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> d <span class="op">=</span> ov[<span class="dv">1</span>] <span class="op">-</span> ov[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb29-1167"><a href="#cb29-1167" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> v <span class="op">=</span> <span class="fu">clamp</span>(min<span class="op">,</span> max <span class="op">-</span> d<span class="op">,</span> ov[<span class="dv">0</span>] <span class="op">+</span> dt <span class="op">*</span> (max <span class="op">-</span> min))<span class="op">;</span></span>
<span id="cb29-1168"><a href="#cb29-1168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span>(v<span class="op">,</span> v <span class="op">+</span> d)<span class="op">;</span></span>
<span id="cb29-1169"><a href="#cb29-1169" aria-hidden="true" tabindex="-1"></a>    }]<span class="op">,</span></span>
<span id="cb29-1170"><a href="#cb29-1170" aria-hidden="true" tabindex="-1"></a>  ])<span class="op">;</span></span>
<span id="cb29-1171"><a href="#cb29-1171" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Returns client offset object.</span></span>
<span id="cb29-1172"><a href="#cb29-1172" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pointer <span class="op">=</span> e <span class="kw">=&gt;</span> e<span class="op">.</span><span class="at">touches</span> <span class="op">?</span> e<span class="op">.</span><span class="at">touches</span>[<span class="dv">0</span>] <span class="op">:</span> e<span class="op">;</span></span>
<span id="cb29-1173"><a href="#cb29-1173" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Note: Chrome defaults "passive" for touch events to true.</span></span>
<span id="cb29-1174"><a href="#cb29-1174" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> on  <span class="op">=</span> (e<span class="op">,</span> fn) <span class="kw">=&gt;</span> e<span class="op">.</span><span class="fu">split</span>(<span class="st">' '</span>)<span class="op">.</span><span class="fu">map</span>(e <span class="kw">=&gt;</span> <span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(e<span class="op">,</span> fn<span class="op">,</span> {<span class="dt">passive</span><span class="op">:</span> <span class="kw">false</span>}))<span class="op">;</span></span>
<span id="cb29-1175"><a href="#cb29-1175" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> off <span class="op">=</span> (e<span class="op">,</span> fn) <span class="kw">=&gt;</span> e<span class="op">.</span><span class="fu">split</span>(<span class="st">' '</span>)<span class="op">.</span><span class="fu">map</span>(e <span class="kw">=&gt;</span> <span class="bu">document</span><span class="op">.</span><span class="fu">removeEventListener</span>(e<span class="op">,</span> fn<span class="op">,</span> {<span class="dt">passive</span><span class="op">:</span> <span class="kw">false</span>}))<span class="op">;</span></span>
<span id="cb29-1176"><a href="#cb29-1176" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> initialX<span class="op">,</span> initialV<span class="op">,</span> target<span class="op">,</span> dragging <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1177"><a href="#cb29-1177" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">handleDrag</span>(e) {</span>
<span id="cb29-1178"><a href="#cb29-1178" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Gracefully handle exit and reentry of the viewport.</span></span>
<span id="cb29-1179"><a href="#cb29-1179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>e<span class="op">.</span><span class="at">buttons</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>e<span class="op">.</span><span class="at">touches</span>) {</span>
<span id="cb29-1180"><a href="#cb29-1180" aria-hidden="true" tabindex="-1"></a>      <span class="fu">handleDragStop</span>()<span class="op">;</span></span>
<span id="cb29-1181"><a href="#cb29-1181" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1182"><a href="#cb29-1182" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1183"><a href="#cb29-1183" aria-hidden="true" tabindex="-1"></a>    dragging <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-1184"><a href="#cb29-1184" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> w <span class="op">=</span> controls<span class="op">.</span><span class="at">zone</span><span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb29-1185"><a href="#cb29-1185" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb29-1186"><a href="#cb29-1186" aria-hidden="true" tabindex="-1"></a>    handlers<span class="op">.</span><span class="fu">get</span>(target)((<span class="fu">pointer</span>(e)<span class="op">.</span><span class="at">clientX</span> <span class="op">-</span> initialX) <span class="op">/</span> w<span class="op">,</span> initialV)<span class="op">;</span></span>
<span id="cb29-1187"><a href="#cb29-1187" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1188"><a href="#cb29-1188" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">handleDragStop</span>(e) {</span>
<span id="cb29-1189"><a href="#cb29-1189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">off</span>(<span class="st">'mousemove touchmove'</span><span class="op">,</span> handleDrag)<span class="op">;</span></span>
<span id="cb29-1190"><a href="#cb29-1190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">off</span>(<span class="st">'mouseup touchend'</span><span class="op">,</span> handleDragStop)<span class="op">;</span></span>
<span id="cb29-1191"><a href="#cb29-1191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(changed) <span class="fu">dispatch</span>(<span class="st">'change'</span>)<span class="op">;</span></span>
<span id="cb29-1192"><a href="#cb29-1192" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1193"><a href="#cb29-1193" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(handleDragStop)<span class="op">;</span></span>
<span id="cb29-1194"><a href="#cb29-1194" aria-hidden="true" tabindex="-1"></a>  dom<span class="op">.</span><span class="at">ontouchstart</span> <span class="op">=</span> dom<span class="op">.</span><span class="at">onmousedown</span> <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb29-1195"><a href="#cb29-1195" aria-hidden="true" tabindex="-1"></a>    dragging <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1196"><a href="#cb29-1196" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1197"><a href="#cb29-1197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="op">!</span>handlers<span class="op">.</span><span class="fu">has</span>(e<span class="op">.</span><span class="at">target</span>)) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1198"><a href="#cb29-1198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on</span>(<span class="st">'mousemove touchmove'</span><span class="op">,</span> handleDrag)<span class="op">;</span></span>
<span id="cb29-1199"><a href="#cb29-1199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on</span>(<span class="st">'mouseup touchend'</span><span class="op">,</span> handleDragStop)<span class="op">;</span></span>
<span id="cb29-1200"><a href="#cb29-1200" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb29-1201"><a href="#cb29-1201" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">stopPropagation</span>()<span class="op">;</span></span>
<span id="cb29-1202"><a href="#cb29-1202" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> e<span class="op">.</span><span class="at">target</span><span class="op">;</span></span>
<span id="cb29-1203"><a href="#cb29-1203" aria-hidden="true" tabindex="-1"></a>    initialX <span class="op">=</span> <span class="fu">pointer</span>(e)<span class="op">.</span><span class="at">clientX</span><span class="op">;</span></span>
<span id="cb29-1204"><a href="#cb29-1204" aria-hidden="true" tabindex="-1"></a>    initialV <span class="op">=</span> value<span class="op">.</span><span class="fu">slice</span>()<span class="op">;</span></span>
<span id="cb29-1205"><a href="#cb29-1205" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1206"><a href="#cb29-1206" aria-hidden="true" tabindex="-1"></a>  controls<span class="op">.</span><span class="at">track</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb29-1207"><a href="#cb29-1207" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(dragging) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb29-1208"><a href="#cb29-1208" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb29-1209"><a href="#cb29-1209" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> r <span class="op">=</span> controls<span class="op">.</span><span class="at">zone</span><span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">;</span></span>
<span id="cb29-1210"><a href="#cb29-1210" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> t <span class="op">=</span> <span class="fu">clamp</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> (<span class="fu">pointer</span>(e)<span class="op">.</span><span class="at">clientX</span> <span class="op">-</span> r<span class="op">.</span><span class="at">left</span>) <span class="op">/</span> r<span class="op">.</span><span class="at">width</span>)<span class="op">;</span></span>
<span id="cb29-1211"><a href="#cb29-1211" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> v <span class="op">=</span> min <span class="op">+</span> t <span class="op">*</span> (max <span class="op">-</span> min)<span class="op">;</span></span>
<span id="cb29-1212"><a href="#cb29-1212" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [vmin<span class="op">,</span> vmax] <span class="op">=</span> value<span class="op">,</span> d <span class="op">=</span> vmax <span class="op">-</span> vmin<span class="op">;</span></span>
<span id="cb29-1213"><a href="#cb29-1213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(v <span class="op">&lt;</span> vmin) <span class="fu">setValue</span>(v<span class="op">,</span> v <span class="op">+</span> d)<span class="op">;</span></span>
<span id="cb29-1214"><a href="#cb29-1214" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(v <span class="op">&gt;</span> vmax) <span class="fu">setValue</span>(v <span class="op">-</span> d<span class="op">,</span> v)<span class="op">;</span></span>
<span id="cb29-1215"><a href="#cb29-1215" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(changed) <span class="fu">dispatch</span>(<span class="st">'change'</span>)<span class="op">;</span></span>
<span id="cb29-1216"><a href="#cb29-1216" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1217"><a href="#cb29-1217" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dom<span class="op">;</span></span>
<span id="cb29-1218"><a href="#cb29-1218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1219"><a href="#cb29-1219" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">formatDecimal</span>(number) {</span>
<span id="cb29-1220"><a href="#cb29-1220" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> number <span class="op">==</span> <span class="dv">1</span> <span class="op">?</span> number <span class="op">:</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(number <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> <span class="dv">100</span>)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb29-1221"><a href="#cb29-1221" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1222"><a href="#cb29-1222" aria-hidden="true" tabindex="-1"></a>button <span class="op">=</span> (data<span class="op">,</span> filename <span class="op">=</span> <span class="st">'data.csv'</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb29-1223"><a href="#cb29-1223" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>data) <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="st">'Array of data required as first argument'</span>)<span class="op">;</span></span>
<span id="cb29-1224"><a href="#cb29-1224" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> downloadData<span class="op">;</span></span>
<span id="cb29-1225"><a href="#cb29-1225" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (filename<span class="op">.</span><span class="fu">includes</span>(<span class="st">'.csv'</span>)) {</span>
<span id="cb29-1226"><a href="#cb29-1226" aria-hidden="true" tabindex="-1"></a>    downloadData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([d3<span class="op">.</span><span class="fu">csvFormat</span>(data)]<span class="op">,</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"text/csv"</span> })<span class="op">;</span></span>
<span id="cb29-1227"><a href="#cb29-1227" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb29-1228"><a href="#cb29-1228" aria-hidden="true" tabindex="-1"></a>    downloadData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(data<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span>)]<span class="op">,</span> {</span>
<span id="cb29-1229"><a href="#cb29-1229" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"application/json"</span></span>
<span id="cb29-1230"><a href="#cb29-1230" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb29-1231"><a href="#cb29-1231" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1232"><a href="#cb29-1232" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> DOM<span class="op">.</span><span class="fu">download</span>(</span>
<span id="cb29-1233"><a href="#cb29-1233" aria-hidden="true" tabindex="-1"></a>    downloadData<span class="op">,</span></span>
<span id="cb29-1234"><a href="#cb29-1234" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">,</span></span>
<span id="cb29-1235"><a href="#cb29-1235" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Download"</span></span>
<span id="cb29-1236"><a href="#cb29-1236" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1237"><a href="#cb29-1237" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1238"><a href="#cb29-1238" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">invert</span>(arr) {</span>
<span id="cb29-1239"><a href="#cb29-1239" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> invertDotd <span class="op">?</span> [<span class="op">...</span><span class="bu">Array</span>(<span class="dv">10</span>)<span class="op">.</span><span class="fu">keys</span>()]<span class="op">.</span><span class="fu">map</span>(n <span class="kw">=&gt;</span> <span class="op">!</span>arr<span class="op">.</span><span class="fu">includes</span>(n))<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> x <span class="op">?</span> i <span class="op">:</span> <span class="kw">null</span>)<span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> i <span class="op">!==</span> <span class="kw">null</span>) <span class="op">:</span> arr</span>
<span id="cb29-1240"><a href="#cb29-1240" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1241"><a href="#cb29-1241" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb29-1242"><a href="#cb29-1242" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">toggleSwitch</span>(options <span class="op">=</span> { <span class="dt">textOn</span><span class="op">:</span> <span class="st">'True'</span><span class="op">,</span> <span class="dt">textOff</span><span class="op">:</span> <span class="st">'False'</span> }) {</span>
<span id="cb29-1243"><a href="#cb29-1243" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> button <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class="button-switch""&gt;&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb29-1244"><a href="#cb29-1244" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> options<span class="op">.</span><span class="at">textOn</span><span class="op">;</span></span>
<span id="cb29-1245"><a href="#cb29-1245" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb29-1246"><a href="#cb29-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1247"><a href="#cb29-1247" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb29-1248"><a href="#cb29-1248" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="op">!</span>button<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb29-1249"><a href="#cb29-1249" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> button<span class="op">.</span><span class="at">value</span> <span class="op">?</span> options<span class="op">.</span><span class="at">textOn</span> <span class="op">:</span> options<span class="op">.</span><span class="at">textOff</span><span class="op">;</span></span>
<span id="cb29-1250"><a href="#cb29-1250" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span>))<span class="op">;</span></span>
<span id="cb29-1251"><a href="#cb29-1251" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1252"><a href="#cb29-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1253"><a href="#cb29-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addButtonStyle</span>()</span>
<span id="cb29-1254"><a href="#cb29-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1255"><a href="#cb29-1255" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> button<span class="op">;</span></span>
<span id="cb29-1256"><a href="#cb29-1256" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1257"><a href="#cb29-1257" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb29-1258"><a href="#cb29-1258" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">addButtonStyle</span>() {</span>
<span id="cb29-1259"><a href="#cb29-1259" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> el <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">'style'</span>)<span class="op">;</span></span>
<span id="cb29-1260"><a href="#cb29-1260" aria-hidden="true" tabindex="-1"></a>  el<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">'type'</span><span class="op">,</span> <span class="st">'text/css'</span>)<span class="op">;</span></span>
<span id="cb29-1261"><a href="#cb29-1261" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="at">head</span><span class="op">.</span><span class="fu">appendChild</span>(el)<span class="op">;</span></span>
<span id="cb29-1262"><a href="#cb29-1262" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> el<span class="op">.</span><span class="at">sheet</span><span class="op">;</span></span>
<span id="cb29-1263"><a href="#cb29-1263" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">addRule</span>(rule) {</span>
<span id="cb29-1264"><a href="#cb29-1264" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> {</span>
<span id="cb29-1265"><a href="#cb29-1265" aria-hidden="true" tabindex="-1"></a>      sheet<span class="op">.</span><span class="fu">insertRule</span>(rule<span class="op">,</span> sheet<span class="op">.</span><span class="at">cssRules</span><span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb29-1266"><a href="#cb29-1266" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">catch</span> (e) {</span>
<span id="cb29-1267"><a href="#cb29-1267" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">warn</span>(<span class="st">'Error inserting rule'</span><span class="op">,</span> rule<span class="op">,</span> e)<span class="op">;</span></span>
<span id="cb29-1268"><a href="#cb29-1268" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1269"><a href="#cb29-1269" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1270"><a href="#cb29-1270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span>(</span>
<span id="cb29-1271"><a href="#cb29-1271" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.button-switch { -webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;display: inline-block;-webkit-border-radius: 2px;-moz-border-radius: 2px;border-radius: 2px;background-color: #EFEFEF;padding: 0px 7px 0px 7px;text-align: center;border: 1px solid grey;width: auto;color: #1c1c1c;font-size: 14px;font-family: sans-serif;text-decoration: none; }'</span></span>
<span id="cb29-1272"><a href="#cb29-1272" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1273"><a href="#cb29-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span>(</span>
<span id="cb29-1274"><a href="#cb29-1274" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.button-switch:hover { background-color: #E5E5E5;border: 1px solid #454545; }'</span></span>
<span id="cb29-1275"><a href="#cb29-1275" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1276"><a href="#cb29-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span>(</span>
<span id="cb29-1277"><a href="#cb29-1277" aria-hidden="true" tabindex="-1"></a>    <span class="st">'.button-switch:active { background-color: #f5f5f5;border: 1px solid grey; }'</span></span>
<span id="cb29-1278"><a href="#cb29-1278" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb29-1279"><a href="#cb29-1279" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1280"><a href="#cb29-1280" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setSpreadDotd</span>(dotd) {</span>
<span id="cb29-1281"><a href="#cb29-1281" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dotdLength <span class="op">=</span> dotd<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb29-1282"><a href="#cb29-1282" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">10</span>) {<span class="cf">return</span> <span class="st">"&gt;"</span>}</span>
<span id="cb29-1283"><a href="#cb29-1283" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">0</span>) {<span class="cf">return</span> <span class="st">"&gt;0"</span>}</span>
<span id="cb29-1284"><a href="#cb29-1284" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">1</span>) {<span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>dotd[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">&gt;&gt;1&gt;9`</span>}</span>
<span id="cb29-1285"><a href="#cb29-1285" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> steps <span class="op">=</span> dotd<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> dotd[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> x)</span>
<span id="cb29-1286"><a href="#cb29-1286" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(i))<span class="op">,</span></span>
<span id="cb29-1287"><a href="#cb29-1287" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb29-1288"><a href="#cb29-1288" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> split <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-1289"><a href="#cb29-1289" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> step <span class="kw">of</span> steps) {</span>
<span id="cb29-1290"><a href="#cb29-1290" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (step <span class="op">!==</span> <span class="dv">1</span>) {</span>
<span id="cb29-1291"><a href="#cb29-1291" aria-hidden="true" tabindex="-1"></a>       result<span class="op">.</span><span class="fu">push</span>([split<span class="op">,</span> step <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb29-1292"><a href="#cb29-1292" aria-hidden="true" tabindex="-1"></a>       split <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb29-1293"><a href="#cb29-1293" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb29-1294"><a href="#cb29-1294" aria-hidden="true" tabindex="-1"></a>      split <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb29-1295"><a href="#cb29-1295" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1296"><a href="#cb29-1296" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-1297"><a href="#cb29-1297" aria-hidden="true" tabindex="-1"></a>  result<span class="op">.</span><span class="fu">push</span>(split)</span>
<span id="cb29-1298"><a href="#cb29-1298" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> flat <span class="op">=</span> []<span class="op">.</span><span class="fu">concat</span>(<span class="op">...</span>result)<span class="op">,</span></span>
<span id="cb29-1299"><a href="#cb29-1299" aria-hidden="true" tabindex="-1"></a>    resultSum <span class="op">=</span> flat<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb29-1300"><a href="#cb29-1300" aria-hidden="true" tabindex="-1"></a>    uniq <span class="op">=</span> [<span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(flat)]<span class="op">;</span></span>
<span id="cb29-1301"><a href="#cb29-1301" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [dotd[<span class="dv">0</span>] <span class="op">?</span> dotd[<span class="dv">0</span>] <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">null</span>]<span class="op">.</span><span class="fu">concat</span>(<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(uniq) <span class="op">===</span> <span class="st">"[1]"</span> <span class="op">?</span> [<span class="kw">null</span><span class="op">,</span> <span class="dv">1</span>] <span class="op">:</span> uniq<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> uniq<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>) <span class="op">===</span> <span class="dv">5</span> <span class="op">?</span> uniq <span class="op">:</span> flat<span class="op">.</span><span class="fu">concat</span>(<span class="dv">10</span> <span class="op">-</span> resultSum)<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> i <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> x <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> x))<span class="op">.</span><span class="fu">join</span>(<span class="st">"&gt;"</span>)</span>
<span id="cb29-1302"><a href="#cb29-1302" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1303"><a href="#cb29-1303" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setSliceDotd</span>(dotd) {</span>
<span id="cb29-1304"><a href="#cb29-1304" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dotdLength <span class="op">=</span> dotd<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb29-1305"><a href="#cb29-1305" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">10</span>) {<span class="cf">return</span> <span class="st">":"</span>}</span>
<span id="cb29-1306"><a href="#cb29-1306" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (dotdLength <span class="op">===</span> <span class="dv">0</span>) {<span class="cf">return</span> <span class="st">":0"</span>}</span>
<span id="cb29-1307"><a href="#cb29-1307" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> steps <span class="op">=</span> dotd<span class="op">.</span><span class="fu">map</span>((x<span class="op">,</span> i) <span class="kw">=&gt;</span> dotd[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> x)</span>
<span id="cb29-1308"><a href="#cb29-1308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(i <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(i))<span class="op">,</span></span>
<span id="cb29-1309"><a href="#cb29-1309" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">=</span> steps<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">,</span></span>
<span id="cb29-1310"><a href="#cb29-1310" aria-hidden="true" tabindex="-1"></a>    uniq <span class="op">=</span> [<span class="op">...</span><span class="kw">new</span> <span class="bu">Set</span>(steps<span class="op">.</span><span class="fu">concat</span>(<span class="dv">10</span> <span class="op">-</span> stepSum))]<span class="op">;</span></span>
<span id="cb29-1311"><a href="#cb29-1311" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [dotd[<span class="dv">0</span>] <span class="op">?</span> dotd[<span class="dv">0</span>] <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">null</span>]<span class="op">.</span><span class="fu">concat</span>(uniq<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> uniq <span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(steps) <span class="op">===</span> <span class="st">"[1,4,1]"</span> <span class="op">?</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">4</span>] <span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(steps) <span class="op">===</span> <span class="st">"[1,1,3,1,1]"</span> <span class="op">?</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">3</span>] <span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(steps) <span class="op">===</span> <span class="st">"[1,1,1,2,1,1,1]"</span> <span class="op">?</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span>] <span class="op">:</span> steps<span class="op">.</span><span class="fu">concat</span>(<span class="dv">10</span> <span class="op">-</span> stepSum)<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> x <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> x))<span class="op">.</span><span class="fu">join</span>(<span class="st">":"</span>)<span class="op">;</span></span>
<span id="cb29-1312"><a href="#cb29-1312" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1313"><a href="#cb29-1313" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">encodeSlice</span>(<span class="op">...</span>args) {</span>
<span id="cb29-1314"><a href="#cb29-1314" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> args<span class="op">.</span><span class="fu">join</span>()<span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">","</span><span class="op">,</span> <span class="st">":"</span>)</span>
<span id="cb29-1315"><a href="#cb29-1315" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1316"><a href="#cb29-1316" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">decodeSlice</span>(s) {</span>
<span id="cb29-1317"><a href="#cb29-1317" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> [start<span class="op">,</span> stop<span class="op">,</span> <span class="op">...</span>steps] <span class="op">=</span> s<span class="op">.</span><span class="fu">split</span>(<span class="st">":"</span>)<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">===</span> <span class="st">""</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span>(i))</span>
<span id="cb29-1318"><a href="#cb29-1318" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> step <span class="op">=</span> steps[<span class="dv">0</span>] <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span><span class="op">:</span> steps[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb29-1319"><a href="#cb29-1319" aria-hidden="true" tabindex="-1"></a>  start <span class="op">=</span> start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">365</span> <span class="op">:</span> start<span class="op">;</span></span>
<span id="cb29-1320"><a href="#cb29-1320" aria-hidden="true" tabindex="-1"></a>  stop <span class="op">=</span> stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">366</span> <span class="op">:</span> stop<span class="op">;</span></span>
<span id="cb29-1321"><a href="#cb29-1321" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [start<span class="op">,</span> stop<span class="op">,</span> step]</span>
<span id="cb29-1322"><a href="#cb29-1322" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1323"><a href="#cb29-1323" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">decodeSpread</span>(spread) {</span>
<span id="cb29-1324"><a href="#cb29-1324" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> spread<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^</span><span class="ss">&lt;/</span><span class="op">,</span> <span class="st">"366&lt;"</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">^</span><span class="ss">&gt;/</span><span class="op">,</span> <span class="st">"0&gt;"</span>)</span>
<span id="cb29-1325"><a href="#cb29-1325" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=^</span><span class="sc">\d|</span><span class="ss">&lt;</span><span class="sc">|</span><span class="ss">&gt;</span><span class="sc">)</span><span class="ss">/</span>)<span class="op">.</span><span class="fu">map</span>(s <span class="kw">=&gt;</span> s<span class="op">.</span><span class="fu">replace</span>(<span class="st">"&lt;"</span><span class="op">,</span> <span class="st">"-"</span>)</span>
<span id="cb29-1326"><a href="#cb29-1326" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">replace</span>(<span class="st">"&gt;"</span><span class="op">,</span> <span class="st">""</span>))<span class="op">.</span><span class="fu">map</span>(s <span class="kw">=&gt;</span> s <span class="op">===</span> <span class="st">""</span> <span class="op">||</span> <span class="pp">isNaN</span>(s) <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span>(s))</span>
<span id="cb29-1327"><a href="#cb29-1327" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1328"><a href="#cb29-1328" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">encodeSpread</span>(args) {</span>
<span id="cb29-1329"><a href="#cb29-1329" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> args<span class="op">.</span><span class="fu">map</span>(a <span class="kw">=&gt;</span> <span class="pp">isNaN</span>(a) <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> a)<span class="op">.</span><span class="fu">join</span>(<span class="st">"&gt;"</span>)<span class="op">.</span><span class="fu">replace</span>(<span class="st">"&gt;-"</span><span class="op">,</span> <span class="st">"&lt;"</span>)</span>
<span id="cb29-1330"><a href="#cb29-1330" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1331"><a href="#cb29-1331" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">slice</span>(self<span class="op">,</span> start<span class="op">,</span> stop<span class="op">,</span> steps<span class="op">,</span> <span class="op">...</span>args) {</span>
<span id="cb29-1332"><a href="#cb29-1332" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> len <span class="op">=</span> self<span class="op">.</span><span class="at">length</span><span class="op">,</span> result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb29-1333"><a href="#cb29-1333" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (steps <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> len <span class="op">===</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1334"><a href="#cb29-1334" aria-hidden="true" tabindex="-1"></a>  steps <span class="op">=</span> (<span class="op">!</span>steps <span class="op">||</span> steps<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> [<span class="dv">1</span>] <span class="op">:</span></span>
<span id="cb29-1335"><a href="#cb29-1335" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> steps <span class="op">===</span> <span class="st">"number"</span> <span class="op">?</span> [steps] <span class="op">:</span></span>
<span id="cb29-1336"><a href="#cb29-1336" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> steps <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(steps<span class="op">,</span> <span class="bu">Number</span>) <span class="op">:</span></span>
<span id="cb29-1337"><a href="#cb29-1337" aria-hidden="true" tabindex="-1"></a>    steps)<span class="op">.</span><span class="fu">concat</span>(args<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> i))<span class="op">;</span></span>
<span id="cb29-1338"><a href="#cb29-1338" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stepCount <span class="op">=</span> steps<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb29-1339"><a href="#cb29-1339" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">=</span> steps<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1340"><a href="#cb29-1340" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (stepSum <span class="op">===</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1341"><a href="#cb29-1341" aria-hidden="true" tabindex="-1"></a>  start <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb29-1342"><a href="#cb29-1342" aria-hidden="true" tabindex="-1"></a>    start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span></span>
<span id="cb29-1343"><a href="#cb29-1343" aria-hidden="true" tabindex="-1"></a>    start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span></span>
<span id="cb29-1344"><a href="#cb29-1344" aria-hidden="true" tabindex="-1"></a>    start <span class="op">&gt;=</span> len <span class="op">?</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span></span>
<span id="cb29-1345"><a href="#cb29-1345" aria-hidden="true" tabindex="-1"></a>    start <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> start <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb29-1346"><a href="#cb29-1346" aria-hidden="true" tabindex="-1"></a>    start<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1347"><a href="#cb29-1347" aria-hidden="true" tabindex="-1"></a>  stop <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb29-1348"><a href="#cb29-1348" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb29-1349"><a href="#cb29-1349" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span></span>
<span id="cb29-1350"><a href="#cb29-1350" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">&gt;=</span> len <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb29-1351"><a href="#cb29-1351" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> stop <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb29-1352"><a href="#cb29-1352" aria-hidden="true" tabindex="-1"></a>    stop<span class="op">,</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb29-1353"><a href="#cb29-1353" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (</span>
<span id="cb29-1354"><a href="#cb29-1354" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> i <span class="op">=</span> start<span class="op">,</span> counter <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb29-1355"><a href="#cb29-1355" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> i <span class="op">&lt;</span> stop <span class="op">:</span> i <span class="op">&gt;</span> stop<span class="op">;</span></span>
<span id="cb29-1356"><a href="#cb29-1356" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> steps[counter]</span>
<span id="cb29-1357"><a href="#cb29-1357" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb29-1358"><a href="#cb29-1358" aria-hidden="true" tabindex="-1"></a>    result<span class="op">.</span><span class="fu">push</span>(self[i])<span class="op">;</span></span>
<span id="cb29-1359"><a href="#cb29-1359" aria-hidden="true" tabindex="-1"></a>    counter <span class="op">=</span> (counter <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> stepCount<span class="op">;</span></span>
<span id="cb29-1360"><a href="#cb29-1360" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1361"><a href="#cb29-1361" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb29-1362"><a href="#cb29-1362" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-1363"><a href="#cb29-1363" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">spread</span>(self<span class="op">,</span> startOrStop<span class="op">,</span> span<span class="op">,</span> splitsAndSpaces<span class="op">,</span> <span class="op">...</span>args) {</span>
<span id="cb29-1364"><a href="#cb29-1364" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> len <span class="op">=</span> self<span class="op">.</span><span class="at">length</span><span class="op">,</span> result <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb29-1365"><a href="#cb29-1365" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (span <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> len <span class="op">===</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1366"><a href="#cb29-1366" aria-hidden="true" tabindex="-1"></a>  splitsAndSpaces <span class="op">=</span> (<span class="op">!</span>splitsAndSpaces <span class="op">||</span> splitsAndSpaces<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> [<span class="dv">1</span>] <span class="op">:</span></span>
<span id="cb29-1367"><a href="#cb29-1367" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> splitsAndSpaces <span class="op">===</span> <span class="st">"number"</span> <span class="op">?</span> [splitsAndSpaces] <span class="op">:</span></span>
<span id="cb29-1368"><a href="#cb29-1368" aria-hidden="true" tabindex="-1"></a>    <span class="kw">typeof</span> splitsAndSpaces <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(splitsAndSpaces<span class="op">,</span> <span class="bu">Number</span>) <span class="op">:</span></span>
<span id="cb29-1369"><a href="#cb29-1369" aria-hidden="true" tabindex="-1"></a>    splitsAndSpaces)<span class="op">.</span><span class="fu">concat</span>(args<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> i))<span class="op">;</span></span>
<span id="cb29-1370"><a href="#cb29-1370" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> splitCount <span class="op">=</span> splitsAndSpaces<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb29-1371"><a href="#cb29-1371" aria-hidden="true" tabindex="-1"></a>    splitSpaceSum <span class="op">=</span> splitsAndSpaces<span class="op">.</span><span class="fu">reduce</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1372"><a href="#cb29-1372" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (splitSpaceSum <span class="op">&lt;=</span> <span class="dv">0</span>) { <span class="cf">return</span> result }<span class="op">;</span></span>
<span id="cb29-1373"><a href="#cb29-1373" aria-hidden="true" tabindex="-1"></a>  startOrStop <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb29-1374"><a href="#cb29-1374" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">||</span> startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> span <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span></span>
<span id="cb29-1375"><a href="#cb29-1375" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> startOrStop <span class="op">&gt;</span> len <span class="op">&amp;&amp;</span> span <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb29-1376"><a href="#cb29-1376" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb29-1377"><a href="#cb29-1377" aria-hidden="true" tabindex="-1"></a>    startOrStop<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb29-1378"><a href="#cb29-1378" aria-hidden="true" tabindex="-1"></a>  span <span class="op">=</span> span <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> startOrStop <span class="op">+</span> span <span class="op">&gt;</span> len <span class="op">?</span> len <span class="op">-</span> startOrStop <span class="op">:</span></span>
<span id="cb29-1379"><a href="#cb29-1379" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">+</span> span <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span>startOrStop<span class="op">:</span> span<span class="op">;</span></span>
<span id="cb29-1380"><a href="#cb29-1380" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> start <span class="op">=</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">:</span> startOrStop <span class="op">+</span> span<span class="op">,</span></span>
<span id="cb29-1381"><a href="#cb29-1381" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">=</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">+</span> span <span class="op">:</span> startOrStop<span class="op">;</span></span>
<span id="cb29-1382"><a href="#cb29-1382" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> start<span class="op">,</span> c <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> arr <span class="op">=</span> []<span class="op">;</span> i <span class="op">&lt;</span> stop<span class="op">;</span> i <span class="op">+=</span> splitsAndSpaces[c]) {</span>
<span id="cb29-1383"><a href="#cb29-1383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ((c <span class="op">=</span> (c <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> splitCount) <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> i <span class="op">+</span> splitsAndSpaces[c] <span class="op">&lt;=</span> stop) {</span>
<span id="cb29-1384"><a href="#cb29-1384" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> ((arr <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> splitsAndSpaces[c]}<span class="op">,</span> (_<span class="op">,</span> j) <span class="kw">=&gt;</span> j <span class="op">+</span> i)<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb29-1385"><a href="#cb29-1385" aria-hidden="true" tabindex="-1"></a>        index <span class="kw">=&gt;</span> self[index])<span class="op">.</span><span class="fu">filter</span>(item <span class="kw">=&gt;</span> item <span class="op">!==</span> <span class="kw">undefined</span>)</span>
<span id="cb29-1386"><a href="#cb29-1386" aria-hidden="true" tabindex="-1"></a>          )<span class="op">.</span><span class="at">length</span> <span class="op">==</span> splitsAndSpaces[c]) { result<span class="op">.</span><span class="fu">push</span>(arr) }</span>
<span id="cb29-1387"><a href="#cb29-1387" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-1388"><a href="#cb29-1388" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb29-1389"><a href="#cb29-1389" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb29-1390"><a href="#cb29-1390" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-27-17" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="variables-2" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Variables</h2><div class="quarto-appendix-contents">

<div class="cell" data-output="all">
<div class="sourceCode cell-code" id="cb30" data-startfrom="1397" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1396;"><span id="cb30-1397"><a href="#cb30-1397" aria-hidden="true" tabindex="-1"></a>nested <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> intervals<span class="op">.</span><span class="at">length</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> ([</span>
<span id="cb30-1398"><a href="#cb30-1398" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb30-1399"><a href="#cb30-1399" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>i<span class="sc">}</span><span class="vs"> or </span><span class="sc">${</span>i<span class="op">+</span><span class="dv">5</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb30-1400"><a href="#cb30-1400" aria-hidden="true" tabindex="-1"></a>  <span class="dt">duration</span><span class="op">:</span> intervals[i][<span class="dv">1</span>] <span class="op">!==</span> intervals[i][<span class="dv">0</span>] <span class="op">?</span> intervals[i][<span class="dv">0</span>] <span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb30-1401"><a href="#cb30-1401" aria-hidden="true" tabindex="-1"></a>  <span class="dt">group</span><span class="op">:</span> <span class="st">"Rest"</span></span>
<span id="cb30-1402"><a href="#cb30-1402" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb30-1403"><a href="#cb30-1403" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb30-1404"><a href="#cb30-1404" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>i<span class="sc">}</span><span class="vs"> or </span><span class="sc">${</span>i<span class="op">+</span><span class="dv">5</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb30-1405"><a href="#cb30-1405" aria-hidden="true" tabindex="-1"></a>  <span class="dt">duration</span><span class="op">:</span> intervals[i][<span class="dv">1</span>]<span class="op">-</span>intervals[i][<span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb30-1406"><a href="#cb30-1406" aria-hidden="true" tabindex="-1"></a>  <span class="dt">group</span><span class="op">:</span> <span class="st">"Work"</span></span>
<span id="cb30-1407"><a href="#cb30-1407" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb30-1408"><a href="#cb30-1408" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb30-1409"><a href="#cb30-1409" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>i<span class="sc">}</span><span class="vs"> or </span><span class="sc">${</span>i<span class="op">+</span><span class="dv">5</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb30-1410"><a href="#cb30-1410" aria-hidden="true" tabindex="-1"></a>  <span class="dt">duration</span><span class="op">:</span> intervals[i][<span class="dv">1</span>] <span class="op">!==</span> intervals[i][<span class="dv">0</span>] <span class="op">?</span> <span class="dv">1</span><span class="op">-</span>intervals[i][<span class="dv">1</span>] <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb30-1411"><a href="#cb30-1411" aria-hidden="true" tabindex="-1"></a>  <span class="dt">group</span><span class="op">:</span> <span class="st">"Rest"</span></span>
<span id="cb30-1412"><a href="#cb30-1412" aria-hidden="true" tabindex="-1"></a>  }]))</span>
<span id="cb30-1413"><a href="#cb30-1413" aria-hidden="true" tabindex="-1"></a>durations <span class="op">=</span> []<span class="op">.</span><span class="fu">concat</span>(<span class="op">...</span>nested)</span>
<span id="cb30-1414"><a href="#cb30-1414" aria-hidden="true" tabindex="-1"></a>theme_Flat <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb30-1415"><a href="#cb30-1415" aria-hidden="true" tabindex="-1"></a><span class="vs">/* Options */</span></span>
<span id="cb30-1416"><a href="#cb30-1416" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope {</span></span>
<span id="cb30-1417"><a href="#cb30-1417" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: #3b99fc;</span></span>
<span id="cb30-1418"><a href="#cb30-1418" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 240px;</span></span>
<span id="cb30-1419"><a href="#cb30-1419" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1420"><a href="#cb30-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1421"><a href="#cb30-1421" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope {</span></span>
<span id="cb30-1422"><a href="#cb30-1422" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1423"><a href="#cb30-1423" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: inline-block;</span></span>
<span id="cb30-1424"><a href="#cb30-1424" aria-hidden="true" tabindex="-1"></a><span class="vs">  --thumb-size: 15px;</span></span>
<span id="cb30-1425"><a href="#cb30-1425" aria-hidden="true" tabindex="-1"></a><span class="vs">  --thumb-radius: calc(var(--thumb-size) / 2);</span></span>
<span id="cb30-1426"><a href="#cb30-1426" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: var(--thumb-radius) 0;</span></span>
<span id="cb30-1427"><a href="#cb30-1427" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin: 2px;</span></span>
<span id="cb30-1428"><a href="#cb30-1428" aria-hidden="true" tabindex="-1"></a><span class="vs">  vertical-align: middle;</span></span>
<span id="cb30-1429"><a href="#cb30-1429" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1430"><a href="#cb30-1430" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-track {</span></span>
<span id="cb30-1431"><a href="#cb30-1431" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1432"><a href="#cb30-1432" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1433"><a href="#cb30-1433" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 7px;</span></span>
<span id="cb30-1434"><a href="#cb30-1434" aria-hidden="true" tabindex="-1"></a><span class="vs">  background-color: hsl(0, 0%, 80%);</span></span>
<span id="cb30-1435"><a href="#cb30-1435" aria-hidden="true" tabindex="-1"></a><span class="vs">  overflow: visible;</span></span>
<span id="cb30-1436"><a href="#cb30-1436" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb30-1437"><a href="#cb30-1437" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 0 var(--thumb-radius);</span></span>
<span id="cb30-1438"><a href="#cb30-1438" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1439"><a href="#cb30-1439" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-track-zone {</span></span>
<span id="cb30-1440"><a href="#cb30-1440" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1441"><a href="#cb30-1441" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1442"><a href="#cb30-1442" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1443"><a href="#cb30-1443" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-select {</span></span>
<span id="cb30-1444"><a href="#cb30-1444" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1445"><a href="#cb30-1445" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb30-1446"><a href="#cb30-1446" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: var(--range-min);</span></span>
<span id="cb30-1447"><a href="#cb30-1447" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: calc(var(--range-max) - var(--range-min));</span></span>
<span id="cb30-1448"><a href="#cb30-1448" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: ew-resize;</span></span>
<span id="cb30-1449"><a href="#cb30-1449" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: currentColor;</span></span>
<span id="cb30-1450"><a href="#cb30-1450" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 7px;</span></span>
<span id="cb30-1451"><a href="#cb30-1451" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: inherit;</span></span>
<span id="cb30-1452"><a href="#cb30-1452" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1453"><a href="#cb30-1453" aria-hidden="true" tabindex="-1"></a><span class="vs">/* Expands the hotspot area. */</span></span>
<span id="cb30-1454"><a href="#cb30-1454" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-select:before {</span></span>
<span id="cb30-1455"><a href="#cb30-1455" aria-hidden="true" tabindex="-1"></a><span class="vs">  content: "";</span></span>
<span id="cb30-1456"><a href="#cb30-1456" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb30-1457"><a href="#cb30-1457" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb30-1458"><a href="#cb30-1458" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: var(--thumb-size);</span></span>
<span id="cb30-1459"><a href="#cb30-1459" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: 0;</span></span>
<span id="cb30-1460"><a href="#cb30-1460" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: calc(2px - var(--thumb-radius));</span></span>
<span id="cb30-1461"><a href="#cb30-1461" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1462"><a href="#cb30-1462" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .range-select:focus,</span></span>
<span id="cb30-1463"><a href="#cb30-1463" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb:focus {</span></span>
<span id="cb30-1464"><a href="#cb30-1464" aria-hidden="true" tabindex="-1"></a><span class="vs">  outline: none;</span></span>
<span id="cb30-1465"><a href="#cb30-1465" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1466"><a href="#cb30-1466" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb {</span></span>
<span id="cb30-1467"><a href="#cb30-1467" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-sizing: border-box;</span></span>
<span id="cb30-1468"><a href="#cb30-1468" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb30-1469"><a href="#cb30-1469" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: var(--thumb-size);</span></span>
<span id="cb30-1470"><a href="#cb30-1470" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: var(--thumb-size);</span></span>
<span id="cb30-1471"><a href="#cb30-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1472"><a href="#cb30-1472" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #fcfcfc;</span></span>
<span id="cb30-1473"><a href="#cb30-1473" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: -4px;</span></span>
<span id="cb30-1474"><a href="#cb30-1474" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 100%;</span></span>
<span id="cb30-1475"><a href="#cb30-1475" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: 1px solid hsl(0,0%,55%);</span></span>
<span id="cb30-1476"><a href="#cb30-1476" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: default;</span></span>
<span id="cb30-1477"><a href="#cb30-1477" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin: 0;</span></span>
<span id="cb30-1478"><a href="#cb30-1478" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1479"><a href="#cb30-1479" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb:active {</span></span>
<span id="cb30-1480"><a href="#cb30-1480" aria-hidden="true" tabindex="-1"></a><span class="vs">  box-shadow: inset 0 var(--thumb-size) #0002;</span></span>
<span id="cb30-1481"><a href="#cb30-1481" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1482"><a href="#cb30-1482" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb-min {</span></span>
<span id="cb30-1483"><a href="#cb30-1483" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: calc(-1px - var(--thumb-radius));</span></span>
<span id="cb30-1484"><a href="#cb30-1484" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1485"><a href="#cb30-1485" aria-hidden="true" tabindex="-1"></a><span class="vs">:scope .thumb-max {</span></span>
<span id="cb30-1486"><a href="#cb30-1486" aria-hidden="true" tabindex="-1"></a><span class="vs">  right: calc(-1px - var(--thumb-radius));</span></span>
<span id="cb30-1487"><a href="#cb30-1487" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb30-1488"><a href="#cb30-1488" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb30-1489"><a href="#cb30-1489" aria-hidden="true" tabindex="-1"></a>schedules <span class="op">=</span> [</span>
<span id="cb30-1490"><a href="#cb30-1490" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">2</span><span class="op">,</span> <span class="op">.</span><span class="dv">8</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">2</span><span class="op">,</span> <span class="op">.</span><span class="dv">8</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span></span>
<span id="cb30-1491"><a href="#cb30-1491" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">3</span><span class="op">,</span> <span class="op">.</span><span class="dv">7</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span></span>
<span id="cb30-1492"><a href="#cb30-1492" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">35</span><span class="op">,</span> <span class="op">.</span><span class="dv">65</span>]<span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]]<span class="op">,</span></span>
<span id="cb30-1493"><a href="#cb30-1493" aria-hidden="true" tabindex="-1"></a>  [[<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]<span class="op">,</span> [<span class="op">.</span><span class="dv">38</span><span class="op">,</span> <span class="op">.</span><span class="dv">62</span>]]<span class="op">,</span></span>
<span id="cb30-1494"><a href="#cb30-1494" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb30-1495"><a href="#cb30-1495" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">366</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> i<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>))</span>
<span id="cb30-1496"><a href="#cb30-1496" aria-hidden="true" tabindex="-1"></a>sliceArray <span class="op">=</span> <span class="fu">slice</span>(dates<span class="op">,</span> <span class="op">...</span>sliceString<span class="op">.</span><span class="fu">split</span>(<span class="st">":"</span>)<span class="op">.</span><span class="fu">map</span>(i <span class="kw">=&gt;</span> i <span class="op">===</span> <span class="st">""</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span>(i)))</span>
<span id="cb30-1497"><a href="#cb30-1497" aria-hidden="true" tabindex="-1"></a>spreadArray <span class="op">=</span> []<span class="op">.</span><span class="fu">concat</span>(<span class="op">...</span><span class="fu">spread</span>(dates<span class="op">,</span> <span class="op">...</span><span class="fu">decodeSpread</span>(spreadString)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-28-7" data-nodetype="declaration">

</div>
</div>
</div>
</div>
</div></section><section id="set-values-1" class="level5 appendix"><h2 class="anchored quarto-appendix-heading">Set values</h2><div class="quarto-appendix-contents">

<div class="cell hidden">
<div class="sourceCode cell-code" id="cb31" data-startfrom="1504" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1503;"><span id="cb31-1504"><a href="#cb31-1504" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof intervals<span class="op">,</span> schedules[schedule<span class="op">-</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-1" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb32" data-startfrom="1505" data-source-offset="-45"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1504;"><span id="cb32-1505"><a href="#cb32-1505" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof spreadString<span class="op">,</span> <span class="fu">setSpreadDotd</span>(spreadDotd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb33" data-startfrom="1506" data-source-offset="-97"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1505;"><span id="cb33-1506"><a href="#cb33-1506" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof sliceString<span class="op">,</span> <span class="fu">setSliceDotd</span>(sliceDotd))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-3" data-nodetype="expression">

</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb34" data-startfrom="1507" data-source-offset="-146"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1506;"><span id="cb34-1507"><a href="#cb34-1507" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb34-1508"><a href="#cb34-1508" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (invertDotd <span class="op">?</span> <span class="op">!</span>sliceOrSpread <span class="op">:</span> sliceOrSpread) {</span>
<span id="cb34-1509"><a href="#cb34-1509" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof sliceDotd<span class="op">,</span> <span class="fu">invert</span>(togglePlot))</span>
<span id="cb34-1510"><a href="#cb34-1510" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb34-1511"><a href="#cb34-1511" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof spreadDotd<span class="op">,</span> <span class="fu">invert</span>(togglePlot))</span>
<span id="cb34-1512"><a href="#cb34-1512" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-1513"><a href="#cb34-1513" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-29-4" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><code>Decalendar</code>: a calendar system that uses <code>deks</code> instead of months and weeks<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><code>Declock</code>: a timekeeping system that uses fractional days instead of hours, minutes, and seconds<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><code>doty</code>: day-of-the-year; an alternative to months, weeks, hours, minutes, and seconds<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><code>doty</code> date: the integer part of the <code>doty</code>; an alternate to calendar dates and week dates<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><code>doty</code> time: the fractional part of the <code>doty</code>; an alternate to hours, minutes and seconds<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><code>dek</code>: a group of 10 days; the first two digits of the <code>Decalendar</code> date; an alternate to month and weeks<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><code>dotd</code>: one of the 10 days in a <code>dek</code>; the last digit of the <code>Decalendar</code> date; an alternate to the day-of-the-month and day-of-the-week<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p><code>cent</code>: a hundredth (<span class="math inline">\(10^{-2}\)</span>) of a day; the first 2 digits of the <code>doty</code> time; an alternate to quarter hours<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><code>mil</code>: a thousandth (<span class="math inline">\(10^{-3}\)</span>) of a day; the first 3 digits of the <code>doty</code> time; an alternate to minutes<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><code>beat</code>: a hundred thousandth (<span class="math inline">\(10^{-5}\)</span>) of a day; the first 5 digits of the <code>doty</code> time; an alternate to seconds<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>fractional year date: a year and the proportion of that year that has passed; an alternative to <code>Decalendar</code> dates<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p><code>deco</code>: a date and time format consisting of a year and a <code>doty</code>; analogous to ISO 8601 dates<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p><code>pent</code>: a group of 5 days; half of a <code>dek</code><a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p><code>pently</code> schedule: one of a set of workday and restday schedules for the 5 days of the <code>pent</code><a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{laptev2024,
  author = {Laptev, Martin},
  title = {Observable},
  date = {2024},
  urldate = {2024},
  url = {https://maptv.github.io/observable/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-laptev2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Laptev, Martin. 2024. <span>“Observable.”</span> 2024. <a href="https://maptv.github.io/observable/">https://maptv.github.io/observable/</a>.
</div></div></section></div></main> <!-- /main -->
<script src="../asset/stamp.js"></script>
<style>
#title-block-header > div.quarto-title-banner.page-columns.page-full { margin: 0px; padding: 0px; }
#title-block-header { margin: 0px; }
main#quarto-document-content { margin: 0px; padding: 0px; }
ul.navbar-nav.navbar-nav-scroll { -webkit-flex-direction: row; }
#quarto-sidebar { padding: 0px; overflow-x: hidden !important; }
#quarto-sidebar > * { padding: 0px; }
div.quarto-title-meta { padding-bottom: 8px; }
h2, h3 { margin: 0px; }
h3 { margin-top: 17px !important; }
div.cell.page-columns.page-full { height: 0px !important; }
@media only screen and (max-width: 991px) { #quarto-search { display: none !important; } #quarto-sidebar { padding: 0px 9px 0px 9px !important; } }
@media only screen and (max-width: 767px) { div.cell.page-columns.page-full { display: none !important; } }
nav.quarto-secondary-nav { padding: 0px !important; }
nav.quarto-secondary-nav > div.container-fluid.d-flex { margin-top: -12px !important; margin-bottom: -14px !important; }
.quarto-secondary-nav-title { margin-top: 10px !important; }
</style>
<script>
const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZmhleWVuL2JhcmNoYXJ0LWNsb2NrXG57XG5jb25zdCBXID0gd2lkdGggPiAxMjUwID8gd2lkdGggKiAyIC8gMyA6IHdpZHRoID4gMTE1MCA/IHdpZHRoICogMyAvIDQgOiB3aWR0aCA+IDEwNTAgPyB3aWR0aCAqIDQgLyA1IDogd2lkdGggPiA5NTAgPyB3aWR0aCAqIDUgLyA2IDogd2lkdGggPiA4NTAgPyB3aWR0aCA6IHdpZHRoID4gNzUwID8gd2lkdGggKiAxLjAyIDogd2lkdGggPiA2NTAgPyB3aWR0aCAqIDEuMDYgOiB3aWR0aCA+IDU1MCA/IHdpZHRoICogMS4xIDogd2lkdGggPiA0NTAgPyB3aWR0aCAqIDEuMTQgOiB3aWR0aCAqIDEuMTg7XG4gIGNvbnN0IEggPSAxNTY7XG4gIGNvbnN0IGJhclggPSAxO1xuICBjb25zdCBmaXJzdEJhclkgPSAxO1xuICBjb25zdCBzdmcgPSBkM1xuICAgIC5jcmVhdGUoXCJzdmdcIilcbiAgICAuYXR0cihcIndpZHRoXCIsIFcpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCBXLCBIXSk7XG4gIGNvbnN0IHhSYW5nZSA9IFswLCBXIC0gMTAwXTtcbiAgY29uc3Qgc2NhbGVNID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzAsIDEwXSlcbiAgICAucmFuZ2UoeFJhbmdlKTtcbiAgY29uc3Qgc2NhbGVDYW5kQiA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFswLCAxMDBdKVxuICAgIC5yYW5nZSh4UmFuZ2UpO1xuICBjb25zdCBzY2FsZURlayA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFswLCAzN10pXG4gICAgLnJhbmdlKHhSYW5nZSk7XG4gIC8vIEJhY2tncm91bmQgYmFycyB0byBzaG93IHdoZXJlIDEwMCUgbGllc1xuICBzdmcuc2VsZWN0QWxsKCcuYmFja2dyb3VuZCcpXG4gICAgLmRhdGEoWydkZWsnLCAnZG90ZCcsICdjZW50cycsIFwibWlsc1wiLCAnYmVhdHMnXSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICdiYWNrZ3JvdW5kIHRpbWVCYXInKVxuICAgIC5hdHRyKCd3aWR0aCcsIFctMTAwKVxuICAgIC5hdHRyKCd5JywgKGQsaSk9PmkqMzArZmlyc3RCYXJZKVxuICAvLyBEZWsvRG90ZFxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkpXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZURlayhOdW1iZXIoZG90eURlaykrTnVtYmVyKGRvdHlEb3RkKS8xMCtOdW1iZXIoYmFyQ2VudHMpLzEwMDApKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhckZ1bGwnKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVEZWsoZG90eURlaykpXG4gIHN2Z1xuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lQmFyJylcbiAgICAuYXR0cigneScsIGZpcnN0QmFyWSszMClcbiAgICAuYXR0cignd2lkdGgnLCBkID0+IHNjYWxlTShOdW1iZXIoZG90eURvdGQpK051bWJlcihiYXJDZW50cykvMTAwK051bWJlcihiYXJNaWxzKS8xMDAwKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXJGdWxsJylcbiAgICAuYXR0cigneScsIGZpcnN0QmFyWSszMClcbiAgICAuYXR0cignd2lkdGgnLCBkID0+IHNjYWxlTShkb3R5RG90ZCkpXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrRGVrJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDQ6IDYsIDM3KSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrRGVrJylcbiAgICAuYXR0cigneCcsIGQ9PnNjYWxlRGVrKGQpK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkpXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlKHdpZHRoID4gNTAwID8gMiA6IDMpPT09MD8gNjo0KVxuICAvLyBDZW50IHRpY2tzXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrRG90ZCcpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxOiAyLCAxMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja0RvdGQnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVNKGQpK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNDkpXG4gICAgLmF0dHIoJ2hlaWdodCcsIDYpXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrTGFiZWwnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gNDogNiwgd2lkdGggPiA1MDAgPyAzNzogMzUsIHdpZHRoID4gNTAwID8gMjogMykpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja0xhYmVsJylcbiAgICAuYXR0cigneCcsIGQ9PnNjYWxlRGVrKGQpK2JhclgrLjUpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrMjIpXG4gICAgLnRleHQoZD0+ZClcbiAgLy8gQ2VudHMvTWlsc1xuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhcicpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZUNhbmRCKE51bWJlcihiYXJDZW50cykrTnVtYmVyKGJhck1pbHMpLzEwK051bWJlcihiYXJCZWF0cykvMTAwMCkpXG4gIHN2Z1xuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lQmFyRnVsbCcpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZUNhbmRCKGJhckNlbnRzKSlcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzkwKVxuICAgIC5hdHRyKCd3aWR0aCcsIGQgPT4gc2NhbGVNKE51bWJlcihiYXJNaWxzKStOdW1iZXIoYmFyQmVhdHMpLzEwMCtOdW1iZXIoYmFyTWIpLzEwMDAwMCkpXG4gIHN2Z1xuICAgIC5hcHBlbmQoJ3JlY3QnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aW1lQmFyRnVsbCcpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrOTApXG4gICAgLmF0dHIoJ3dpZHRoJywgZCA9PiBzY2FsZU0oYmFyTWlscykpXG4gIC8vIENlbnQgdGlja3NcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tDJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDEwIDogMjAsIDEwMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja0MnKVxuICAgIC5hdHRyKCd4JywgZD0+c2NhbGVNKGQvMTApK2JhclgpXG4gICAgLmF0dHIoJ3knLCBmaXJzdEJhclkrNjApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDg6NSlcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tDMScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDIwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tDMScpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZU0oZC8xMCkrYmFyWClcbiAgICAuYXR0cigneScsIGQ9PmQlMj09PTA/IGZpcnN0QmFyWSs3NzpmaXJzdEJhclkrODApXG4gICAgLmF0dHIoJ2hlaWdodCcsIGQ9PmQlMj09PTA/IDg6NSlcbiAgLy8gTWlsIHRpY2tzXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrTScpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxIDogMiwgMTApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tNJylcbiAgICAuYXR0cigneCcsIGQ9PnNjYWxlTShkKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzkwKVxuICAgIC5hdHRyKCdoZWlnaHQnLCA2KVxuICBzdmcuc2VsZWN0QWxsKCcudGlja00xJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDEgOiAyLCAxMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja00xJylcbiAgICAuYXR0cigneCcsIGQ9PnNjYWxlTShkKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzkyLjUpXG4gICAgLmF0dHIoJ2hlaWdodCcsIDIuNSlcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpY2tMYWJlbDEnKVxuICAgIC5kYXRhKGQzLnJhbmdlKHdpZHRoID4gNTAwID8gMSA6IDIsIDEwKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aWNrTGFiZWwxJylcbiAgICAuYXR0cigneCcsIGQ9PnNjYWxlTShkKStiYXJYKy41KVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzQ3KVxuICAgIC50ZXh0KGQ9PmQpXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrTGFiZWwyJylcbiAgICAuZGF0YShkMy5yYW5nZSh3aWR0aCA+IDUwMCA/IDEgOiAyLCAxMCkpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGlja0xhYmVsMicpXG4gICAgLmF0dHIoJ3gnLCBkPT5zY2FsZU0oZCkrYmFyWCsuNSlcbiAgICAuYXR0cigneScsIGZpcnN0QmFyWSsxMTIpXG4gICAgLnRleHQoZD0+ZClcbiAgLy8gQmVhdHNcbiAgc3ZnXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpbWVCYXInKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzEyMClcbiAgICAuYXR0cignd2lkdGgnLCBkID0+IHNjYWxlQ2FuZEIoTnVtYmVyKGJhckJlYXRzKStOdW1iZXIoYmFyTWIpLzEwMDApKVxuICBzdmdcbiAgICAuYXBwZW5kKCdyZWN0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUJhckZ1bGwnKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzEyMClcbiAgICAuYXR0cignd2lkdGgnLCBkID0+IHNjYWxlQ2FuZEIoYmFyQmVhdHMpKVxuICAvLyBCZWF0IHRpY2tzXG4gIHN2Zy5zZWxlY3RBbGwoJy50aWNrQicpXG4gICAgLmRhdGEoZDMucmFuZ2Uod2lkdGggPiA1MDAgPyAxMCA6IDIwLCAxMDApKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZCgncmVjdCcpXG4gICAgLmF0dHIoJ2NsYXNzJywgJ3RpY2tCJylcbiAgICAuYXR0cigneCcsIGQ9PnNjYWxlTShkLzEwKStiYXJYKVxuICAgIC5hdHRyKCd5JywgZmlyc3RCYXJZKzEyMClcbiAgICAuYXR0cignaGVpZ2h0JywgZD0+ZCUyPT09MD8gOTo2KVxuICAvLyBMYWJlbHNcbiAgc3ZnLnNlbGVjdEFsbCgnLnRpbWVMYWJlbCcpXG4gICAgLmRhdGEoW2Ake2RvdHlEZWt95pesYCwgYCR7ZG90eURvdGR95pelYCwgYCR7YmFyQ2VudHN9JWAsIGAke2Jhck1pbHN94oCwYCwgYCR7YmFyQmVhdHN94pmrYF0pXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKCd0ZXh0JylcbiAgICAuYXR0cignY2xhc3MnLCAndGltZUxhYmVsJylcbiAgICAuYXR0cigneCcsIGJhclgrMilcbiAgICAuYXR0cigneScsIChkLGkpPT5pKjMwK2ZpcnN0QmFyWSsyMClcbiAgICAudGV4dChkPT5kKVxuICByZXR1cm4gc3ZnLm5vZGUoKTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh0bWxgPHN0eWxlPlxuICAudGlja0xhYmVsLCAudGlja0xhYmVsMSwgLnRpY2tMYWJlbDIsIC50aW1lTGFiZWwge1xuICAgIGZpbGw6ICMwMDA7XG4gICAgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7XG4gICAgZm9udC1zaXplOiAyMHB4O1xuICAgIHRleHQtYW5jaG9yOiBtaWRkbGU7XG4gIH1cbiAgLnRpbWVMYWJlbCB7XG4gICAgdGV4dC1hbmNob3I6IHN0YXJ0O1xuICB9XG4gIC50aW1lQmFyLCAudGltZUJhckZ1bGwge1xuICAgIHg6IDFweDtcbiAgICBoZWlnaHQ6IDI1cHg7XG4gICAgcng6IDVweDtcbiAgICBzdHJva2U6ICNhYWE7XG4gIH1cbiAgLnRpbWVCYXIge1xuICAgIGZpbGw6ICNlOGU4ZTg7XG4gIH1cbiAgLnRpbWVCYXJGdWxsIHtcbiAgICBmaWxsOiAjY2NmZmZmO1xuICB9XG4gIC5iYWNrZ3JvdW5kIHtcbiAgICBmaWxsOiB3aGl0ZTtcbiAgfVxuICAudGlja0RlaywgLnRpY2tEb3RkLCAudGlja0RvdGQxLCAudGlja0MsIC50aWNrQzEsIC50aWNrTSwgLnRpY2tNMSwgLnRpY2tCIHtcbiAgICBzdHJva2U6IG5vbmU7XG4gICAgZmlsbDogIzY2NjtcbiAgICB3aWR0aDogMXB4O1xuICB9XG48L3N0eWxlPmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBpbnB1dERvdHkgPSBJbnB1dHMucmFuZ2UoWzAsIDM2NV0sIHt2YWx1ZTogMzA2LCBzdGVwOiAxLCBsYWJlbDogXCJkb3R5XCJ9KTtcblxudmlld29mIHllYXIgPSB0cmFuc2Zvcm1JbnB1dChcbiAgICBJbnB1dHMucmFuZ2UoWzAsIC45OTldLCB7c3RlcDogLjAwMSwgbGFiZWw6IFwieWVhclwifSksXG4gICAge2JpbmQ6IHZpZXdvZiBpbnB1dERvdHksIHRyYW5zZm9ybTogKHggPT4geCAvIDM2NSksIGludmVydDogKHggPT4geCAqIDM2NSl9XG4pO1xuXG52aWV3b2YgbW9udGhJbnB1dCA9IHRyYW5zZm9ybUlucHV0KFxuICAgIElucHV0cy5yYW5nZShbMSwgMTJdLCB7c3RlcDogMSwgbGFiZWw6IFwibW9udGhcIn0pLFxuICAgIHtiaW5kOiB2aWV3b2YgaW5wdXREb3R5LCB0cmFuc2Zvcm06IGRvdHkybW9udGgsIGludmVydDogbW9udGgyZG90eX1cbik7XG5cbnZpZXdvZiBkb3RtSW5wdXQgPSB0cmFuc2Zvcm1JbnB1dChcbiAgICBJbnB1dHMucmFuZ2UoWzEsIDMxXSwge3N0ZXA6IDEsIGxhYmVsOiBcImRvdG1cIn0pLFxuICAgIHtiaW5kOiB2aWV3b2YgaW5wdXREb3R5LCB0cmFuc2Zvcm06IGRvdHkyZG90bSwgaW52ZXJ0OiAoeCA9PiBNYXRoLmZsb29yKCggMTUzICogKFxuICAgICAgICB2aWV3b2YgbW9udGhJbnB1dC52YWx1ZSA+IDJcbiAgICAgICAgPyB2aWV3b2YgbW9udGhJbnB1dC52YWx1ZSAtIDNcbiAgICAgICAgOiB2aWV3b2YgbW9udGhJbnB1dC52YWx1ZSArIDkpICsgMlxuICAgICkgLyA1ICsgeCAtIDFcbikpfSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc2NydWJiZXJEb3R5ID0gU2NydWJiZXIobnVtYmVycywge2F1dG9wbGF5OiBmYWxzZSwgYWx0ZXJuYXRlOiB0cnVlLCBkZWxheTogODYuNCwgbG9vcERlbGF5OiA4NjR9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BvYnNlcnZhYmxlaHEvc3luY2hyb25pemVkLWlucHV0c1xuZnVuY3Rpb24gc2V0KGlucHV0LCB2YWx1ZSkge1xuICBpbnB1dC52YWx1ZSA9IHZhbHVlO1xuICBpbnB1dC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImlucHV0XCIsIHtidWJibGVzOiB0cnVlfSkpO1xufVxuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BtYm9zdG9jay9zY3J1YmJlclxuZnVuY3Rpb24gU2NydWJiZXIodmFsdWVzLCB7XG4gIGZvcm1hdCA9IHZhbHVlID0+IHZhbHVlLFxuICBpbml0aWFsID0gMCxcbiAgZGlyZWN0aW9uID0gMSxcbiAgZGVsYXkgPSBudWxsLFxuICBhdXRvcGxheSA9IHRydWUsXG4gIGxvb3AgPSB0cnVlLFxuICBsb29wRGVsYXkgPSBudWxsLFxuICBhbHRlcm5hdGUgPSBmYWxzZVxufSA9IHt9KSB7XG4gIHZhbHVlcyA9IEFycmF5LmZyb20odmFsdWVzKTtcbiAgY29uc3QgZm9ybSA9IGh0bWxgPGZvcm0gc3R5bGU9XCJmb250OiAxMnB4IHZhcigtLXNhbnMtc2VyaWYpOyBmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOyBkaXNwbGF5OiBmbGV4OyBoZWlnaHQ6IDMzcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+XG4gIDxidXR0b24gbmFtZT1iIHR5cGU9YnV0dG9uIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjojMDAyZWFkO2NvbG9yOiNmZmY7Ym9yZGVyLXJhZGl1czoxMHB4O21hcmdpbi1sZWZ0Oi40ZW07d2lkdGg6IDVlbTtcIj48L2J1dHRvbj5cbiAgPGxhYmVsIHN0eWxlPVwiZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjtcIj5cbiAgICA8aW5wdXQgbmFtZT1pIHR5cGU9cmFuZ2UgbWluPTAgbWF4PSR7dmFsdWVzLmxlbmd0aCAtIDF9IHZhbHVlPSR7aW5pdGlhbH0gc3RlcD0xIHN0eWxlPVwiZGlzcGxheTogbm9uZTtcIj5cbiAgICA8b3V0cHV0IG5hbWU9byBzdHlsZT1cImRpc3BsYXk6IG5vbmU7XCI+PC9vdXRwdXQ+XG4gIDwvbGFiZWw+XG48L2Zvcm0+YDtcbiAgbGV0IGZyYW1lID0gbnVsbDtcbiAgbGV0IHRpbWVyID0gbnVsbDtcbiAgbGV0IGludGVydmFsID0gbnVsbDtcbiAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgZm9ybS5iLnRleHRDb250ZW50ID0gXCJQYXVzZVwiO1xuICAgIGlmIChkZWxheSA9PT0gbnVsbCkgZnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGljayk7XG4gICAgZWxzZSBpbnRlcnZhbCA9IHNldEludGVydmFsKHRpY2ssIGRlbGF5KTtcbiAgfVxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIGZvcm0uYi50ZXh0Q29udGVudCA9IFwiUGxheVwiO1xuICAgIGlmIChmcmFtZSAhPT0gbnVsbCkgY2FuY2VsQW5pbWF0aW9uRnJhbWUoZnJhbWUpLCBmcmFtZSA9IG51bGw7XG4gICAgaWYgKHRpbWVyICE9PSBudWxsKSBjbGVhclRpbWVvdXQodGltZXIpLCB0aW1lciA9IG51bGw7XG4gICAgaWYgKGludGVydmFsICE9PSBudWxsKSBjbGVhckludGVydmFsKGludGVydmFsKSwgaW50ZXJ2YWwgPSBudWxsO1xuICB9XG4gIGZ1bmN0aW9uIHJ1bm5pbmcoKSB7XG4gICAgcmV0dXJuIGZyYW1lICE9PSBudWxsIHx8IHRpbWVyICE9PSBudWxsIHx8IGludGVydmFsICE9PSBudWxsO1xuICB9XG4gIGZ1bmN0aW9uIHRpY2soKSB7XG4gICAgaWYgKGZvcm0uaS52YWx1ZUFzTnVtYmVyID09PSAoZGlyZWN0aW9uID4gMCA/IHZhbHVlcy5sZW5ndGggLSAxIDogZGlyZWN0aW9uIDwgMCA/IDAgOiBOYU4pKSB7XG4gICAgICBpZiAoIWxvb3ApIHJldHVybiBzdG9wKCk7XG4gICAgICBpZiAoYWx0ZXJuYXRlKSBkaXJlY3Rpb24gPSAtZGlyZWN0aW9uO1xuICAgICAgaWYgKGxvb3BEZWxheSAhPT0gbnVsbCkge1xuICAgICAgICBpZiAoZnJhbWUgIT09IG51bGwpIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGZyYW1lKSwgZnJhbWUgPSBudWxsO1xuICAgICAgICBpZiAoaW50ZXJ2YWwgIT09IG51bGwpIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpLCBpbnRlcnZhbCA9IG51bGw7XG4gICAgICAgIHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiAoc3RlcCgpLCBzdGFydCgpKSwgbG9vcERlbGF5KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZGVsYXkgPT09IG51bGwpIGZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spO1xuICAgIHN0ZXAoKTtcbiAgfVxuICBmdW5jdGlvbiBzdGVwKCkge1xuICAgIGZvcm0uaS52YWx1ZUFzTnVtYmVyID0gKGZvcm0uaS52YWx1ZUFzTnVtYmVyICsgZGlyZWN0aW9uICsgdmFsdWVzLmxlbmd0aCkgJSB2YWx1ZXMubGVuZ3RoO1xuICAgIGZvcm0uaS5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImlucHV0XCIsIHtidWJibGVzOiB0cnVlfSkpO1xuICB9XG4gIGZvcm0uaS5vbmlucHV0ID0gZXZlbnQgPT4ge1xuICAgIGlmIChldmVudCAmJiBldmVudC5pc1RydXN0ZWQgJiYgcnVubmluZygpKSBzdG9wKCk7XG4gICAgZm9ybS52YWx1ZSA9IHZhbHVlc1tmb3JtLmkudmFsdWVBc051bWJlcl07XG4gICAgZm9ybS5vLnZhbHVlID0gZm9ybWF0KGZvcm0udmFsdWUsIGZvcm0uaS52YWx1ZUFzTnVtYmVyLCB2YWx1ZXMpO1xuICB9O1xuICBmb3JtLmIub25jbGljayA9ICgpID0+IHtcbiAgICBpZiAocnVubmluZygpKSByZXR1cm4gc3RvcCgpO1xuICAgIGRpcmVjdGlvbiA9IGFsdGVybmF0ZSAmJiBmb3JtLmkudmFsdWVBc051bWJlciA9PT0gdmFsdWVzLmxlbmd0aCAtIDEgPyAtMSA6IDE7XG4gICAgZm9ybS5pLnZhbHVlQXNOdW1iZXIgPSAoZm9ybS5pLnZhbHVlQXNOdW1iZXIgKyBkaXJlY3Rpb24pICUgdmFsdWVzLmxlbmd0aDtcbiAgICBmb3JtLmkuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJpbnB1dFwiLCB7YnViYmxlczogdHJ1ZX0pKTtcbiAgICBzdGFydCgpO1xuICB9O1xuICBmb3JtLmkub25pbnB1dCgpO1xuICBpZiAoYXV0b3BsYXkpIHN0YXJ0KCk7XG4gIGVsc2Ugc3RvcCgpO1xuICBJbnB1dHMuZGlzcG9zYWwoZm9ybSkudGhlbihzdG9wKTtcbiAgcmV0dXJuIGZvcm07XG59XG4vLyBodHRwczovL29ic2VydmFibGVocS5jb20vQGp1YW5nMTc0NC90cmFuc2Zvcm0taW5wdXQvMVxudHJhbnNmb3JtSW5wdXQgPSBmdW5jdGlvbih0YXJnZXQsIHtiaW5kOiBzb3VyY2UsIHRyYW5zZm9ybSA9IGlkZW50aXR5LCBpbnZvbHV0b3J5ID0gZmFsc2UsIGludmVydCA9IGludm9sdXRvcnkgPyB0cmFuc2Zvcm0gOiBpbnZlcnNlKHRyYW5zZm9ybSl9ID0ge30pe1xuICBpZiAoc291cmNlID09PSB1bmRlZmluZWQpIHtcbiAgICBzb3VyY2UgPSB0YXJnZXQ7XG4gICAgdGFyZ2V0ID0gaHRtbGA8ZGl2PiR7c291cmNlfTwvZGl2PmA7XG4gIH1cbiAgZnVuY3Rpb24gc291cmNlSW5wdXRIYW5kbGVyKCkge1xuICAgIHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgdGFyZ2V0SW5wdXRIYW5kbGVyKTtcbiAgICBzZXRUcmFuc2Zvcm0odGFyZ2V0KS50byh0cmFuc2Zvcm0oc291cmNlLnZhbHVlKSkuYW5kRGlzcGF0Y2hFdmVudCgpO1xuICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgdGFyZ2V0SW5wdXRIYW5kbGVyKTtcbiAgfVxuICBmdW5jdGlvbiB0YXJnZXRJbnB1dEhhbmRsZXIoKSB7XG4gICAgc291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBzb3VyY2VJbnB1dEhhbmRsZXIpO1xuICAgIHNldFRyYW5zZm9ybShzb3VyY2UpLnRvKGludmVydCh0YXJnZXQudmFsdWUpKS5hbmREaXNwYXRjaEV2ZW50KCk7XG4gICAgc291cmNlLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBzb3VyY2VJbnB1dEhhbmRsZXIpO1xuICB9XG4gIHNvdXJjZS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgc291cmNlSW5wdXRIYW5kbGVyKTtcbiAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCB0YXJnZXRJbnB1dEhhbmRsZXIpO1xuICBpbnZhbGlkYXRpb24udGhlbigoKSA9PiB7XG4gICAgc291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBzb3VyY2VJbnB1dEhhbmRsZXIpO1xuICAgIHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgdGFyZ2V0SW5wdXRIYW5kbGVyKTtcbiAgfSk7XG5cbiAgc291cmNlSW5wdXRIYW5kbGVyKCk7XG4gIHJldHVybiB0YXJnZXQ7XG59XG5zZXRUcmFuc2Zvcm0gPSAoaW5wdXQpID0+ICh7dG86ICh2YWx1ZSkgPT4gKGlucHV0LnZhbHVlID0gdmFsdWUsIHthbmREaXNwYXRjaEV2ZW50OiAoZXZlbnQgPSBuZXcgRXZlbnQoXCJpbnB1dFwiKSkgPT4gaW5wdXQuZGlzcGF0Y2hFdmVudChldmVudCl9KX0pO1xuZnVuY3Rpb24gaW52ZXJzZShmKSB7XG4gIHN3aXRjaCAoZikge1xuICAgIGNhc2UgaWRlbnRpdHk6ICByZXR1cm4gaWRlbnRpdHk7XG4gICAgY2FzZSBNYXRoLnNxcnQ6IHJldHVybiBzcXVhcmU7XG4gICAgY2FzZSBNYXRoLmxvZzogIHJldHVybiBNYXRoLmV4cDtcbiAgICBjYXNlIE1hdGguZXhwOiAgcmV0dXJuIE1hdGgubG9nO1xuICAgIGRlZmF1bHQ6ICAgICAgICByZXR1cm4gKHggPT4gc29sdmUoZiwgeCwgeCkpO1xuICB9XG4gIGZ1bmN0aW9uIHNvbHZlKGYsIHksIHggPSAwKSB7XG4gICAgY29uc3QgZHggPSAxZS02O1xuICAgIGxldCBzdGVwcyA9IDEwMCwgZGVsdGF4LCBmeCwgZGZ4O1xuICAgIGRvIHtcbiAgICAgIGZ4ID0gZih4KVxuICAgICAgZGZ4ID0gKGYoeCArIGR4KSAtIGZ4KSB8fCBkeDtcbiAgICAgIGRlbHRheCA9IGR4ICogKGZ4IC0geSkvZGZ4XG4gICAgICB4IC09IGRlbHRheDtcbiAgICB9IHdoaWxlIChNYXRoLmFicyhkZWx0YXgpID4gZHggJiYgLS1zdGVwcyA+IDApO1xuICAgIHJldHVybiBzdGVwcyA9PT0gMCA/IE5hTiA6IHg7XG4gIH1cblxuICBmdW5jdGlvbiBzcXVhcmUoeCkge1xuICAgIHJldHVybiB4ICogeDtcbiAgfVxufVxuZnVuY3Rpb24gaWRlbnRpdHkoeCkge1xuICByZXR1cm4geDtcbn1cbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9Ab2JzZXJ2YWJsZWhxL3RleHQtY29sb3ItYW5ub3RhdGlvbnMtaW4tbWFya2Rvd24jdGV4dGNvbG9yXG5mdW5jdGlvbiBzZXRTdHlsZShjb250ZW50LCBzdHlsZSA9IHt9KSB7XG4gIGZ1bmN0aW9uIHlpcShjb2xvcikge1xuICAgIGNvbnN0IHtyLCBnLCBifSA9IGQzLnJnYihjb2xvcik7XG4gICAgcmV0dXJuIChyICogMjk5ICsgZyAqIDU4NyArIGIgKiAxMTQpIC8gMTAwMCAvIDI1NTsgLy8gcmV0dXJucyB2YWx1ZXMgYmV0d2VlbiAwIGFuZCAxXG4gIH1cbiAgY29uc3Qge1xuICAgIGJhY2tncm91bmQsXG4gICAgY29sb3IgPSB5aXEoYmFja2dyb3VuZCkgPj0gMC42ID8gXCIjMTExXCIgOiBcIndoaXRlXCIsXG4gICAgcGFkZGluZyA9IFwiMCAxcHhcIixcbiAgICBib3JkZXJSYWRpdXMgPSBcIjRweFwiLFxuICAgIGZvbnRXZWlnaHQgPSA5MDAsXG4gICAgZm9udFNpemUgPSBcIjFlbVwiLFxuICAgIC4uLnJlc3RcbiAgfSA9IHR5cGVvZiBzdHlsZSA9PT0gXCJzdHJpbmdcIiA/IHtiYWNrZ3JvdW5kOiBzdHlsZX0gOiBzdHlsZTtcbiAgcmV0dXJuIGh0bC5odG1sYDxzcGFuIHN0eWxlPSR7e1xuICAgIGJhY2tncm91bmQsXG4gICAgY29sb3IsXG4gICAgcGFkZGluZyxcbiAgICBib3JkZXJSYWRpdXMsXG4gICAgZm9udFdlaWdodCxcbiAgICAuLi5yZXN0XG4gIH19PiR7Y29udGVudH08L3NwYW4+YDtcbn1cbi8vIGh0dHA6Ly9ob3dhcmRoaW5uYW50LmdpdGh1Yi5pby9kYXRlX2FsZ29yaXRobXMuaHRtbCNjaXZpbF9mcm9tX2RheXNcbmZ1bmN0aW9uIGRvdGUyZG90eShkYXlzID0gNzE5NDY4KSB7XG4gICAgY29uc3QgZXJhID0gTWF0aC5mbG9vcigoZGF5cyA+PSAwID8gZGF5cyA6IGRheXMgLSAxNDYwOTYpIC8gMTQ2MDk3KSxcbiAgICAgICAgZG90YyA9IGRheXMgLSBlcmEgKiAxNDYwOTcsXG4gICAgICAgIHlvdGMgPSBNYXRoLmZsb29yKChkb3RjIC0gTWF0aC5mbG9vcihkb3RjIC8gMTQ2MCkgKyBNYXRoLmZsb29yKGRvdGMgLyAzNjUyNCkgLSBNYXRoLmZsb29yKGRvdGMgLyAxNDYwOTYpKSAvIDM2NSk7XG4gICAgcmV0dXJuIFt5b3RjICsgZXJhICogNDAwLCBkb3RjICsgTWF0aC5mbG9vcih5b3RjIC8gMTAwKSAtIHlvdGMgKiAzNjUgLSBNYXRoLmZsb29yKHlvdGMgLyA0KV07XG59XG5mdW5jdGlvbiB1bml4MmRvdHkobXMgPSAwKSB7XG4gIHJldHVybiBkb3RlMmRvdHkobXMgLyA4NjQwMDAwMCArIDcxOTQ2OClcbn1cbi8vIGh0dHBzOi8vaG93YXJkaGlubmFudC5naXRodWIuaW8vZGF0ZV9hbGdvcml0aG1zLmh0bWwjZGF5c19mcm9tX2NpdmlsXG5mdW5jdGlvbiBkb3R5MmRvdGUoeWVhciA9IDE5NjksIGRvdHkgPSAwLCB6b25lID0gMCkge1xuICAgIGNvbnN0IGN5Y2xlID0gTWF0aC5mbG9vcigoeWVhciA+PSAwID8geWVhciA6IHllYXIgLSAzOTkpIC8gNDAwKSxcbiAgICB5b3RlID0geWVhciAtIGN5Y2xlICogNDAwO1xuICAgIHJldHVybiBjeWNsZSAqIDE0NjA5NyArIHlvdGUgKiAzNjUgKyBNYXRoLmZsb29yKHlvdGUgLyA0KSAtIE1hdGguZmxvb3IoeW90ZSAvIDEwMCkgKyBkb3R5IC0gem9uZVxufVxuZnVuY3Rpb24gZG90eTJkZWNvKHllYXJEb3R5ID0gWzE5NjksIDMwNl0sIHpvbmUgPSAwKSB7XG4gICAgY29uc3QgeWQgPSBkb3RlMmRvdHkoZG90eTJkb3RlKHllYXJEb3R5WzBdLCBNYXRoLmZsb29yKHllYXJEb3R5WzFdKSkpO1xuICAgIHJldHVybiBgJHt5ZFswXX0rJHsoeWRbMV0pLnRvU3RyaW5nKCkucGFkU3RhcnQoMywgXCIwXCIpfSR7XG4gICAgICAgIHllYXJEb3R5WzFdLnRvU3RyaW5nKCkuaW5jbHVkZXMoXCIuXCIpID8gXCIuXCIgKyAoXG4gICAgICAgICAgICAoeWVhckRvdHlbMV0gPiAwKSA/ICh5ZWFyRG90eVsxXSAtIHpvbmUpLnRvU3RyaW5nKCkuc3BsaXQoXCIuXCIpLnBvcCgpXG4gICAgICAgICAgICA6IFsuLi4oeWVhckRvdHlbMV0gLSB6b25lKS50b1N0cmluZygpLnNwbGl0KFwiLlwiKS5wb3AoKV0ubWFwKFxuICAgICAgICAgICAgICAgIChlLCBpLCBhKSA9PiAoaSArIDEgPT09IGEubGVuZ3RoKSA/IDEwIC0gZSA6IDkgLSBlXG4gICAgICAgICAgICApLmpvaW4oXCJcIilcbiAgICAgICAgKSA6IFwiXCJcbiAgICB9YFxufVxuZnVuY3Rpb24gdW5peDJkZWNvKG1zID0gMCkge1xuICAgIHJldHVybiBkb3R5MmRlY28odW5peDJkb3R5KG1zKSk7XG59O1xuLy8gaHR0cDovL2hvd2FyZGhpbm5hbnQuZ2l0aHViLmlvL2RhdGVfYWxnb3JpdGhtcy5odG1sI2RheXNfZnJvbV9jaXZpbFxuZnVuY3Rpb24gZ3JlZzJkb3R5KG1vbnRoID0gMSwgZGF5ID0gMSkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKFxuICAgICAgICAoMTUzICogKG1vbnRoID4gMiA/IG1vbnRoIC0gMyA6IG1vbnRoICsgOSkgKyAyKSAvIDUgKyBkYXkgLSAxXG4pfVxuLy8gaHR0cDovL2hvd2FyZGhpbm5hbnQuZ2l0aHViLmlvL2RhdGVfYWxnb3JpdGhtcy5odG1sI2NpdmlsX2Zyb21fZGF5c1xuZnVuY3Rpb24gZG90eTJncmVnKGRvdHkgPSAwKSB7XG4gICAgY29uc3QgbSA9IE1hdGguZmxvb3IoKDUgKiBkb3R5ICsgMikgLyAxNTMpO1xuICAgIHJldHVybiBbTWF0aC5mbG9vcihtIDwgMTAgPyBtICsgMyA6IG0gLSA5KSwgZG90eSAtIE1hdGguZmxvb3IoKDE1MyAqIG0gKyAyKSAvIDUpICsgMV07XG59XG5mdW5jdGlvbiBkb3R5MnRvdHkoZG90eSA9IDMwNikge1xuICAgIGRvdHkgPSBNYXRoLmZsb29yKGRvdHkpXG4gICAgcmV0dXJuICgyMDUgPD0gZG90eSAmJiBkb3R5IDwgMjk1KSA/IFtcIkZhbGzwn42BXCIsIFwiU3ByaW5n8J+MvFwiXSA6XG4gICAgICAgICgxMTAgPD0gZG90eSAmJiBkb3R5IDwgMjA1KSA/IFtcIlN1bW1lcuKYgO+4j1wiLCBcIldpbnRlcuKdhO+4j1wiXSA6XG4gICAgICAgICgyMCA8PSBkb3R5ICYmIGRvdHkgPCAxMTApID8gW1wiU3ByaW5n8J+MvFwiLCBcIkZhbGzwn42BXCJdIDpcbiAgICAgICAgKDAgPD0gZG90eSAmJiBkb3R5IDwgMjApIHx8ICgyOTUgPD0gZG90eSAmJiBkb3R5IDw9IDM2NSlcbiAgICAgICAgPyBbXCJXaW50ZXLinYTvuI9cIiwgXCJTdW1tZXLimIDvuI9cIl0gOiBcIlVua25vd25cIlxufVxuZnVuY3Rpb24gZG90eTJ6b2RpKGRvdHkgPSAzMDYpIHtcbiAgICBkb3R5ID0gTWF0aC5mbG9vcihkb3R5KVxuICAgIHJldHVybiAoMjAgPD0gZG90eSAmJiBkb3R5IDwgNTApID8gXCJBcmllc+KZiO+4j1wiIDpcbiAgICAgKDUwIDw9IGRvdHkgJiYgZG90eSA8IDgxKSA/IFwiVGF1cnVz4pmJ77iPXCIgOlxuICAgICAoODEgPD0gZG90eSAmJiBkb3R5IDwgMTEyKSA/IFwiR2VtaW5p4pmK77iPXCIgOlxuICAgICAoMTEyIDw9IGRvdHkgJiYgZG90eSA8IDE0NCkgPyBcIkNhbmNlcuKZi++4j1wiIDpcbiAgICAgKDE0NCA8PSBkb3R5ICYmIGRvdHkgPCAxNzUpID8gXCJMZW/imYzvuI9cIiA6XG4gICAgICgxNzUgPD0gZG90eSAmJiBkb3R5IDwgMjA2KSA/IFwiVmlyZ2/imY3vuI9cIiA6XG4gICAgICgyMDYgPD0gZG90eSAmJiBkb3R5IDwgMjM2KSA/IFwiTGlicmHimY7vuI9cIiA6XG4gICAgICgyMzYgPD0gZG90eSAmJiBkb3R5IDwgMjY2KSA/IFwiU2NvcnBpb+KZj++4j1wiIDpcbiAgICAgKDI2NiA8PSBkb3R5ICYmIGRvdHkgPCAyOTYpID8gXCJTYWdpdHRhcml1c+KZkO+4j1wiIDpcbiAgICAgKDI5NiA8PSBkb3R5ICYmIGRvdHkgPCAzMjUpID8gXCJDYXByaWNvcm7imZHvuI9cIiA6XG4gICAgICgzMjUgPD0gZG90eSAmJiBkb3R5IDwgMzU1KSA/IFwiQXF1YXJpdXPimZLvuI9cIiA6XG4gICAgICgzNTUgPD0gZG90eSAmJiBkb3R5IDw9IDM2NSkgfHwgKDAgPD0gZG90eSAmJiBkb3R5IDwgMjApXG4gICAgID8gXCJQaXNjZXPimZPvuI9cIiA6IFwiVW5rbm93blwiXG59XG5mdW5jdGlvbiBkb3R5Mm1vbnRoKGRvdHkgPSAwKSB7XG4gICAgY29uc3QgbSA9IE1hdGguZmxvb3IoKDUgKiBkb3R5ICsgMikgLyAxNTMpO1xuICAgIHJldHVybiBNYXRoLmZsb29yKG0gPCAxMCA/IG0gKyAzIDogbSAtIDkpO1xufVxuZnVuY3Rpb24gbW9udGgyZG90eShtb250aCA9IDEpIHtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihcbiAgICAgICAgKDE1MyAqIChtb250aCA+IDIgPyBtb250aCAtIDMgOiBtb250aCArIDkpICsgMikgLyA1XG4pfVxuZnVuY3Rpb24gZG90eTJkb3RtKGRvdHkgPSAwKSB7XG4gICAgY29uc3QgbSA9IE1hdGguZmxvb3IoKDUgKiBkb3R5ICsgMikgLyAxNTMpO1xuICAgIHJldHVybiBkb3R5IC0gTWF0aC5mbG9vcigoMTUzICogbSArIDIpIC8gNSkgKyAxO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoid2lkdGhcbnVuaXggPSB7XG4gIHdoaWxlKHRydWUpIHtcbiAgICB5aWVsZCBEYXRlLm5vdygpO1xuICB9XG59XG50aWNrID0ge1xuICBsZXQgaSA9IDA7XG4gIHdoaWxlICh0cnVlKSB7XG4gICAgeWllbGQgUHJvbWlzZXMudGljayg4NjQsICsraSk7XG4gIH1cbn1cbnRpY2tUaW1lID0gdGljayAlIDFlNVxuYmFyVGltZSA9IHVuaXgyZG90ZSh1bml4KS50b1N0cmluZygpLnNwbGl0KFwiLlwiKVsxXS5zbGljZSgwLCA4KVxuYmFyQ2VudHMgPSBiYXJUaW1lLnNsaWNlKDAsIDIpXG5iYXJNaWxzID0gYmFyVGltZVsyXVxuYmFyQmVhdHMgPSBiYXJUaW1lLnNsaWNlKDMsIDUpXG5iYXJNYiA9IGJhclRpbWUuc2xpY2UoNSlcbmRlY28gPSB1bml4MmRlY28odW5peCkuc2xpY2UoMCwgMTQpXG5kb3R5ID0gZGVjby5zbGljZSg1KVxuZG90eURhdGUgPSBkb3R5LnNsaWNlKDAsIDMpXG5kb3R5VGltZSA9IGRvdHkuc2xpY2UoNClcbmRvdHlEZWsgPSBkb3R5LnNsaWNlKDAsIDIpXG5kb3R5RG90ZCA9IGRvdHlbMl1cbmlzbyA9IHtcbiAgd2hpbGUodHJ1ZSkge1xuICAgIHlpZWxkIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICB9XG59XG5pc29EYXRlID0gaXNvLnNsaWNlKDUsIDEwKVxuaXNvVGltZSA9IGlzby5zbGljZSgxMSwgMTkpXG5zZWFzb24gPSBkb3R5MnRvdHkoZG90eURhdGUpXG56b2RpYWMgPSBkb3R5MnpvZGkoZG90eURhdGUpXG5pbnB1dERvdHlTZWFzb24gPSBkb3R5MnRvdHkoaW5wdXREb3R5KVxuaW5wdXREb3R5Wm9kaWFjID0gZG90eTJ6b2RpKGlucHV0RG90eSlcbm51bWJlcnMgPSBBcnJheS5mcm9tKHtsZW5ndGg6IDM2Nn0sIChfLCBpKSA9PiBpKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoic3R5bGVkWWVhciA9IHNldFN0eWxlKGRlY28uc2xpY2UoMCwgNCksIGQzLnNjaGVtZVBhaXJlZFsxMF0pXG5zdHlsZWREb3R5RGF0ZSA9IHNldFN0eWxlKGRvdHlEYXRlLCBkMy5zY2hlbWVQYWlyZWRbMV0pXG5zdHlsZWREb3R5VGltZSA9IHNldFN0eWxlKGRvdHlUaW1lLCBkMy5zY2hlbWVQYWlyZWRbMl0pXG5zdHlsZWREb3R5RGF0ZTEgPSBzZXRTdHlsZShkb3R5RGF0ZSwgZDMuc2NoZW1lUGFpcmVkWzFdKVxuc3R5bGVkRG90eVRpbWUxID0gc2V0U3R5bGUoZG90eVRpbWUsIGQzLnNjaGVtZVBhaXJlZFsyXSlcbnN0eWxlZFRpY2tUaW1lID0gc2V0U3R5bGUodGlja1RpbWUsIGQzLnNjaGVtZVBhaXJlZFsyXSlcbnN0eWxlZERlayA9IHNldFN0eWxlKGRvdHlEZWssIGQzLnNjaGVtZVBhaXJlZFswXSlcbnN0eWxlZERvdGQgPSBzZXRTdHlsZShkb3R5RG90ZCwgZDMuc2NoZW1lUGFpcmVkWzldKVxuc3R5bGVkQ2VudCA9IHNldFN0eWxlKGRvdHlUaW1lLnNsaWNlKDAsIDIpLCBkMy5zY2hlbWVQYWlyZWRbN10pXG5zdHlsZWRNaWwgPSBzZXRTdHlsZShkb3R5VGltZVsyXSwgZDMuc2NoZW1lUGFpcmVkWzZdKVxuc3R5bGVkQmVhdCA9IHNldFN0eWxlKGRvdHlUaW1lLnNsaWNlKDMsIDUpLCBkMy5zY2hlbWVQYWlyZWRbMTFdKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoic2V0KHZpZXdvZiBpbnB1dERvdHksIHNjcnViYmVyRG90eSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InNldCh2aWV3b2YgZGVjb091dHB1dCwgYDE5NjkrJHtzY3J1YmJlckRlY28udG9TdHJpbmcoKS5wYWRTdGFydCgzLCBcIjBcIil9YClcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgaW5wdXREYXRldGltZSA9IElucHV0cy5kYXRldGltZSh7bGFiZWw6IFwiZGF0ZVwiLCB2YWx1ZTogXCIxOTcwLTAxLTAxVDAwOjAwXCJ9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiB5ZCA9IElucHV0cy5mb3JtKFtcbiAgSW5wdXRzLm51bWJlcih7bGFiZWw6IFwieWVhclwiLCB2YWx1ZTogXCIxOTY5XCJ9KSxcbiAgSW5wdXRzLm51bWJlcih7bGFiZWw6IFwiZG90eVwiLCB2YWx1ZTogXCIzMDZcIn0pXG5dKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBkZWNvT3V0cHV0ID0gdHJhbnNmb3JtSW5wdXQoXG4gIElucHV0cy50ZXh0KHtsYWJlbDogXCJkZWNvXCIsIHBsYWNlaG9sZGVyOiBcInllYXIrZGF5LmRkZFwiLCB2YWx1ZTogXCIxOTY5KzMwNlwifSksXG4gIHtiaW5kOiB2aWV3b2YgeWQsIHRyYW5zZm9ybTogZG90eTJkZWNvLCBpbnZlcnQ6IGRlY28yZG90eX0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzY3J1YmJlckRlY28gPSBTY3J1YmJlcihudW1iZXJzLCB7YXV0b3BsYXk6IGZhbHNlLCBhbHRlcm5hdGU6IHRydWUsIGRlbGF5OiA4Ni40LCBsb29wRGVsYXk6IDg2NH0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gem9uZTJob3VyKHpvbmUgPSBcIlpcIikge1xuICAgIHJldHVybiAoem9uZSA9IHpvbmUudG9VcHBlckNhc2UoKSkgPT0gXCJaXCIgPyAwXG4gICAgICAgIDogem9uZSA+IFwiQFwiICYmIHpvbmUgPCBcIkpcIiA/IHpvbmUuY2hhckNvZGVBdCgpIC0gNjRcbiAgICAgICAgOiB6b25lID4gXCJKXCIgJiYgem9uZSA8IFwiTlwiID8gem9uZS5jaGFyQ29kZUF0KCkgLSA2NVxuICAgICAgICA6IHpvbmUgPCBcIlpcIiAmJiB6b25lID4gXCJNXCIgPyAtKHpvbmUuY2hhckNvZGVBdCgpIC0gNzcpXG4gICAgICAgIDogem9uZTtcbn1cbmZ1bmN0aW9uIGRlY28yZG90eSh0aW1lc3RhbXAgPSBcIjE5NjkrMzA2LjAwMDAwWlwiKSB7XG4gICAgY29uc3QgYXJyID0gdGltZXN0YW1wLnRvU3RyaW5nKCkuc3BsaXQoLyg/PVsrLV18W2EtekEtWl0pLywgMyk7XG4gICAgc3dpdGNoIChhcnIubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMTogcmV0dXJuIFt1bml4MmRvdHkoRGF0ZS5ub3coKSlbMF0sIHBhcnNlRmxvYXQoYXJyWzBdKSwgMF07XG4gICAgICAgIGNhc2UgMjogcmV0dXJuICgvXlthLXpBLVpdKyQvLnRlc3QoYXJyWzFdKSlcbiAgICAgICAgICAgID8gW3VuaXgyZG90eShEYXRlLm5vdygpKVswXSwgcGFyc2VGbG9hdChhcnJbMF0pLCB6b25lMmhvdXIoYXJyWzFdKSAvIDI0XVxuICAgICAgICAgICAgOiBbcGFyc2VGbG9hdChhcnJbMF0pLCBwYXJzZUZsb2F0KGFyclsxXSksIDBdO1xuICAgIH07XG4gICAgcmV0dXJuIFtwYXJzZUZsb2F0KGFyclswXSksIHBhcnNlRmxvYXQoYXJyWzFdKSwgL15bYS16QS1aXSskLy50ZXN0KGFyclsyXSlcbiAgICAgICAgPyB6b25lMmhvdXIoYXJyWzJdKSAvIDI0XG4gICAgICAgIDogcGFyc2VGbG9hdChhcnJbMl0ucmVwbGFjZSgvKFsrLV0pLywgXCIkMVxcLlwiKSldO1xufVxuZnVuY3Rpb24gZGVjbzJkZWNvKHRpbWVzdGFtcCA9IFwiMTk2OSszMDYuMDAwMDBaXCIpIHtcbiAgICByZXR1cm4gZG90eTJkZWNvKGRlY28yZG90eSh0aW1lc3RhbXApKVxufVxuZnVuY3Rpb24gZG90eTJkb3R5KHllYXIgPSAxOTY5LCBkb3R5ID0gMCwgem9uZSA9IDApIHtcbiAgICByZXR1cm4gZG90ZTJkb3R5KGRvdHkyZG90ZSh5ZWFyLCBkb3R5LCB6b25lKSk7XG59XG5mdW5jdGlvbiBkb3R5MnVuaXgoeWVhciA9IDE5NjksIGRvdHkgPSAzMDYsIHpvbmUgPSAwKSB7XG4gICAgcmV0dXJuIChkb3R5MmRvdGUoeWVhciwgZG90eSwgem9uZSkgLSA3MTk0NjgpICogODY0MDAwMDA7XG59XG5mdW5jdGlvbiBkb3R5Mmlzb2MoeWVhciA9IDE5NjksIGRvdHkgPSAzMDYsIHpvbmUgPSAwKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKGRvdHkydW5peCh5ZWFyLCBkb3R5LCB6b25lKSkudG9JU09TdHJpbmcoKS5zcGxpdChcIi5cIilbMF1cbn1cbmZ1bmN0aW9uIGRlY28yaXNvYyh0aW1lc3RhbXAgPSBcIjE5NjkrMzA2LjAwMDAwWlwiKSB7XG4gICAgcmV0dXJuIGRvdHkyaXNvYyguLi5kZWNvMmRvdHkodGltZXN0YW1wKSlcbn1cbmZ1bmN0aW9uIHVuaXgyZG90ZShtcyA9IDApIHtcbiAgcmV0dXJuIG1zIC8gODY0MDAwMDAgKyA3MTk0Njg7XG59XG5mdW5jdGlvbiBkb3RlMnllYXIoZGF5cyA9IDcxOTQ2OCkge1xuICAgIGNvbnN0IGVyYSA9IE1hdGguZmxvb3IoKGRheXMgPj0gMCA/IGRheXMgOiBkYXlzIC0gMTQ2MDk2KSAvIDE0NjA5NyksXG4gICAgICAgIGRvdGMgPSBkYXlzIC0gZXJhICogMTQ2MDk3LFxuICAgICAgICB5b3RjID0gKGRvdGMgLSBNYXRoLmZsb29yKGRvdGMgLyAxNDYwKSArIE1hdGguZmxvb3IoZG90YyAvIDM2NTI0KSAtIE1hdGguZmxvb3IoZG90YyAvIDE0NjA5NikpIC8gMzY1O1xuICAgIHJldHVybiB5b3RjICsgZXJhICogNDAwO1xufVxuZnVuY3Rpb24gZG90eTJ5ZWFyKHllYXIgPSAxOTY5LCBkb3R5ID0gMzA2LCB6b25lID0gMCkge1xuICAgIHJldHVybiBkb3RlMnllYXIoZG90eTJkb3RlKHllYXIsIGRvdHksIHpvbmUpKTtcbn1cbmZ1bmN0aW9uIHVuaXgyeWVhcihtcyA9IDApIHtcbiAgICByZXR1cm4gZG90ZTJ5ZWFyKHVuaXgyZG90ZShtcykpO1xufTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0ek9mZnNldEluTXMgPSBpbnB1dERhdGV0aW1lLmdldFRpbWV6b25lT2Zmc2V0KCkgKiA2MDAwMFxudXRjRGF0ZXRpbWUgPSBpbnB1dERhdGV0aW1lIC0gdHpPZmZzZXRJbk1zXG5vdXRwdXREYXRldGltZURlY28gPSB1bml4MmRlY28odXRjRGF0ZXRpbWUpXG5kdERvdHkgPSBvdXRwdXREYXRldGltZURlY28uc3BsaXQoXCIrXCIpWzFdXG5kdERvdHlEYXRlUmF3ID0gZHREb3R5LnNwbGl0KFwiLlwiKVswXVxuZHREb3R5VGltZVJhdyA9IGR0RG90eS5zcGxpdChcIi5cIilbMV0uc2xpY2UoMCwgNSlcbm91dHB1dERhdGV0aW1lWWVhciA9IHVuaXgyeWVhcih1dGNEYXRldGltZSkudG9TdHJpbmcoKS5zbGljZSgwLCA4KVxuZHREb3R5VGltZURlbGltaXRlciA9IGR0RG90eVRpbWVSYXcgPyBcIi5cIiA6IFwiXCJcbm91dHB1dERlY29ZZWFyID0gZG90eTJ5ZWFyKC4uLnlkKS50b1N0cmluZygpLnNsaWNlKDAsIDgpXG5vdXRwdXRJc29jID0gZG90eTJpc29jKC4uLnlkKVxueWVhckRhdGUgPSBNYXRoLmNlaWwodW5peDJ5ZWFyKHVuaXgpICogMWUzKSAvIDFlM1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImR0WWVhciA9IHNldFN0eWxlKG91dHB1dERhdGV0aW1lRGVjby5zcGxpdChcIitcIilbMF0sIGQzLnNjaGVtZVBhaXJlZFsxMF0pXG5kdERvdHlEYXRlID0gc2V0U3R5bGUoZHREb3R5RGF0ZVJhdywgZDMuc2NoZW1lUGFpcmVkWzFdKVxuZHREb3R5VGltZSA9IGR0RG90eVRpbWVSYXcgPyBzZXRTdHlsZShkdERvdHlUaW1lUmF3LCBkMy5zY2hlbWVQYWlyZWRbMl0pIDogXCJcIlxuc3R5bGVkSXNvY1llYXIgPSBzZXRTdHlsZShvdXRwdXRJc29jLnNwbGl0KC8oPz0tKS8pWzBdLCBkMy5zY2hlbWVQYWlyZWRbMTBdKVxuc3R5bGVkSXNvY01kID0gc2V0U3R5bGUob3V0cHV0SXNvYy5zbGljZShvdXRwdXRJc29jLnNwbGl0KC8oPz0tKS8pWzBdLmxlbmd0aCsxLG91dHB1dElzb2Muc3BsaXQoLyg/PS0pLylbMF0ubGVuZ3RoKzYpLCBkMy5zY2hlbWVQYWlyZWRbNV0pXG5zdHlsZWRJc29jVGltZSA9IHNldFN0eWxlKG91dHB1dElzb2Muc2xpY2Uob3V0cHV0SXNvYy5zcGxpdCgvKD89LSkvKVswXS5sZW5ndGgrNyksIGQzLnNjaGVtZVBhaXJlZFs0XSlcbnN0eWxlZE91dHB1dERhdGV0aW1lWWVhciA9IHNldFN0eWxlKG91dHB1dERhdGV0aW1lWWVhciwgZDMuc2NoZW1lUGFpcmVkWzEwXSlcbnN0eWxlZE91dHB1dERlY29ZZWFyID0gc2V0U3R5bGUob3V0cHV0RGVjb1llYXIsIGQzLnNjaGVtZVBhaXJlZFsxMF0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE3IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGludGVydmFscyA9IElucHV0cy5mb3JtKFtcbiAgaW50ZXJ2YWwoWzAsIDFdLCB7c3RlcDogLjAxLCB2YWx1ZTogWy4zLCAuN10sIGxhYmVsOiAnMCBvciA1Jywgd2lkdGg6IDI1MCwgZm9ybWF0OiAoW3N0YXJ0LCBlbmRdKSA9PiBzdGFydCA9PT0gZW5kID8gXCJcIiA6IGAke2Zvcm1hdERlY2ltYWwoc3RhcnQpfToke2Zvcm1hdERlY2ltYWwoZW5kKX1gfSksXG4gIGludGVydmFsKFswLCAxXSwge3N0ZXA6IC4wMSwgdmFsdWU6IFsuMywgLjddLCBsYWJlbDogJzEgb3IgNicsIHdpZHRoOiAyNTAsIGZvcm1hdDogKFtzdGFydCwgZW5kXSkgPT4gc3RhcnQgPT09IGVuZCA/IFwiXCIgOiBgJHtmb3JtYXREZWNpbWFsKHN0YXJ0KX06JHtmb3JtYXREZWNpbWFsKGVuZCl9YH0pLFxuICBpbnRlcnZhbChbMCwgMV0sIHtzdGVwOiAuMDEsIHZhbHVlOiBbLjMsIC43XSwgbGFiZWw6ICcyIG9yIDcnLCB3aWR0aDogMjUwLCBmb3JtYXQ6IChbc3RhcnQsIGVuZF0pID0+IHN0YXJ0ID09PSBlbmQgPyBcIlwiIDogYCR7Zm9ybWF0RGVjaW1hbChzdGFydCl9OiR7Zm9ybWF0RGVjaW1hbChlbmQpfWB9KSxcbiAgaW50ZXJ2YWwoWzAsIDFdLCB7c3RlcDogLjAxLCB2YWx1ZTogWzAsIDBdLCBsYWJlbDogJzMgb3IgOCcsIHdpZHRoOiAyNTAsIGZvcm1hdDogKFtzdGFydCwgZW5kXSkgPT4gc3RhcnQgPT09IGVuZCA/IFwiXCIgOiBgJHtmb3JtYXREZWNpbWFsKHN0YXJ0KX06JHtmb3JtYXREZWNpbWFsKGVuZCl9YH0pLFxuICBpbnRlcnZhbChbMCwgMV0sIHtzdGVwOiAuMDEsIHZhbHVlOiBbMCwgMF0sIGxhYmVsOiAnNCBvciA5Jywgd2lkdGg6IDI1MCwgZm9ybWF0OiAoW3N0YXJ0LCBlbmRdKSA9PiBzdGFydCA9PT0gZW5kID8gXCJcIiA6IGAke2Zvcm1hdERlY2ltYWwoc3RhcnQpfToke2Zvcm1hdERlY2ltYWwoZW5kKX1gfSksXG5dKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzY2hlZHVsZSA9IElucHV0cy5yYWRpbyhbMiwgMywgNCwgNV0sIHtsYWJlbDogXCJzY2hlZC5cIiwgdmFsdWU6IDN9KVxuXG52aWV3b2YgZmlsZW5hbWUgPSBJbnB1dHMudGV4dCh7bGFiZWw6IFwibmFtZVwiLCBwbGFjZWhvbGRlcjogXCJFbnRlciB0aGUgZmlsZW5hbWVcIiwgdmFsdWU6IGBzY2hlZHVsZSR7c2NoZWR1bGV9LmNzdmB9KVxuXG5idXR0b24oZHVyYXRpb25zLCBmaWxlbmFtZSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AZGVjL3BlbnRcblBsb3QucGxvdCh7XG4gIGNsYXNzTmFtZTogXCJzY2hlZHVsZS1leHBsb3JlclwiLFxuICB4OiB7bGFiZWw6IG51bGx9LFxuICBjb2xvcjoge3NjaGVtZTogXCJTZXQxXCIsIGxlZ2VuZDogXCJzd2F0Y2hlc1wiLCByZXZlcnNlOiB0cnVlfSxcbiAgeToge2xhYmVsOiBudWxsLCBkb21haW46IFsxLCAwXX0sXG4gIG1hcmtzOiBbXG4gIFBsb3QuYmFyWShkdXJhdGlvbnMsIHt4OiBcImxhYmVsXCIsIHk6IFwiZHVyYXRpb25cIiwgZmlsbDogXCJncm91cFwifSksXG4gIFBsb3QudGV4dFkoXG4gICAgICBkdXJhdGlvbnMsXG4gICAgICBQbG90LnN0YWNrWShcbiAgICAgICAgUGxvdC5ncm91cFgoXG4gICAgICAgICAgeyB5OiBcImZpcnN0XCIsIHRleHQ6IFwiZmlyc3RcIiB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHg6IFwibGFiZWxcIixcbiAgICAgICAgICAgIHo6IFwiZ3JvdXBcIixcbiAgICAgICAgICAgIHk6IFwiZHVyYXRpb25cIixcbiAgICAgICAgICAgIHRleHQ6IChkKSA9PiAoZC5kdXJhdGlvbiA8IC4wMDAxID8gbnVsbCA6IGZvcm1hdERlY2ltYWwoZC5kdXJhdGlvbikpLFxuICAgICAgICAgICAgZmlsbDogXCJ3aGl0ZVwiLFxuICAgICAgICAgICAgc3Ryb2tlOiBcImJsYWNrXCIsXG4gICAgICAgICAgICBmb250U2l6ZTogMzYsXG4gICAgICAgICAgfVxuICAgICAgICApXG4gICAgICApXG4gICAgKSxcbiAgXX0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNsaWNlRG90ZCA9IElucHV0cy5jaGVja2JveChbLi4uQXJyYXkoMTApLmtleXMoKV0sIHtsYWJlbDogXCJzbGljZVwiLCB2YWx1ZTogWzEsIDZdfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc3ByZWFkRG90ZCA9IElucHV0cy5jaGVja2JveChbLi4uQXJyYXkoMTApLmtleXMoKV0sIHtsYWJlbDogXCJzcHJlYWRcIiwgdmFsdWU6IFsxLCA2XX0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHRvZ2dsZVBsb3QgPSBJbnB1dHMuYnV0dG9uKFtcbiAgW2ludmVydERvdGQgPyBcIk5vbmVcIiA6IFwiQWxsXCIsIHZhbHVlID0+IFsuLi5BcnJheSgxMCkua2V5cygpXV0sXG4gIFtpbnZlcnREb3RkID8gXCJFdmVuXCIgOiBcIk9kZFwiLCB2YWx1ZSA9PiBbMSwgMywgNSwgNywgOV1dLFxuICBbaW52ZXJ0RG90ZCA/IGh0bWxgPHM+UHJpbWU8L3M+YCA6IFwiUHJpbWVcIiwgdmFsdWUgPT4gWzIsIDMsIDUsIDddXSxcbiAgW2ludmVydERvdGQgPyBodG1sYDxzPkNvbXBvc2l0ZTwvcz5gIDogXCJDb21wb3NpdGVcIiwgdmFsdWUgPT4gWzQsIDYsIDgsIDldXSxcbiAgW2ludmVydERvdGQgPyBodG1sYDxzPlNjaGVkdWxlMjwvcz5gIDogXCJTY2hlZHVsZTJcIiwgdmFsdWUgPT4gWzAsIDEsIDUsIDZdXSxcbiAgW2ludmVydERvdGQgPyBodG1sYDxzPlNjaGVkdWxlMzwvcz5gIDogXCJTY2hlZHVsZTNcIiwgdmFsdWUgPT4gWzAsIDEsIDIsIDUsIDYsIDddXSxcbiAgW2ludmVydERvdGQgPyBodG1sYDxzPlNjaGVkdWxlNDwvcz5gIDogXCJTY2hlZHVsZTRcIiwgdmFsdWUgPT4gWzAsIDEsIDIsIDMsIDUsIDYsIDcsIDhdXSxcbl0sIHt2YWx1ZTogW10sIGxhYmVsOiBcInNlbGVjdFwifSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgaW52ZXJ0RG90ZCA9IElucHV0cy50b2dnbGUoe2xhYmVsOiBcImludmVydFwifSlcbnZpZXdvZiBzbGljZU9yU3ByZWFkID0gdG9nZ2xlU3dpdGNoKHt0ZXh0T246IGludmVydERvdGQgPyBcIlNwcmVhZFwiIDogJ1NsaWNlJyAsIHRleHRPZmY6IGludmVydERvdGQgPyBcIlNsaWNlXCIgOiAnU3ByZWFkJ30pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNsaWNlSW5wdXRzID0gSW5wdXRzLmZvcm0oW1xuICAgIElucHV0cy5udW1iZXIoWy0zNjYsIDM2Nl0sIHtzdGVwOiAxLCBsYWJlbDogXCJzdGFydFwiLCB2YWx1ZTogMSwgcGxhY2Vob2xkZXI6IFwiRW50ZXIgc3RhcnQgaW5kZXhcIn0pLFxuICAgIElucHV0cy5udW1iZXIoWy0zNjYsIDM2Nl0sIHtzdGVwOiAxLCBsYWJlbDogXCJzdG9wXCIsIHZhbHVlOiAzNjYsIHBsYWNlaG9sZGVyOiBcIkVudGVyIHN0b3AgaW5kZXhcIn0pLFxuICAgIElucHV0cy5udW1iZXIoWy0zNjYsIDM2Nl0sIHtzdGVwOiAxLCBsYWJlbDogXCJzdGVwXCIsIHZhbHVlOiA1LCBwbGFjZWhvbGRlcjogXCJFbnRlciBzdGVwIHNpemVcIn0pLFxuXSlcbnZpZXdvZiBzbGljZVN0cmluZyA9IHRyYW5zZm9ybUlucHV0KFxuICBJbnB1dHMudGV4dCh7bGFiZWw6IFwic2xpY2VcIiwgcGxhY2Vob2xkZXI6IFwiRW50ZXIgc2xpY2Ugc3RyaW5nXCIsIHZhbHVlOiBcIjA6MzY2XCJ9KSxcbntiaW5kOiB2aWV3b2Ygc2xpY2VJbnB1dHMsIHRyYW5zZm9ybTogZW5jb2RlU2xpY2UsIGludmVydDogZGVjb2RlU2xpY2V9KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc3ByZWFkSW5wdXRzID0gSW5wdXRzLmZvcm0oW1xuICAgIElucHV0cy5udW1iZXIoWy0zNjYsIDM2Nl0sIHtzdGVwOiAxLCBsYWJlbDogXCJzdGFydFwiLCB2YWx1ZTogMCwgcGxhY2Vob2xkZXI6IFwiRW50ZXIgc3RhcnQgaW5kZXhcIn0pLFxuICAgIElucHV0cy5udW1iZXIoWy0zNjYsIDM2Nl0sIHtzdGVwOiAxLCBsYWJlbDogXCJzcGFuXCIsIHZhbHVlOiAzNjYsIHBsYWNlaG9sZGVyOiBcIkVudGVyIHNwYW4gc2l6ZVwifSksXG4gICAgSW5wdXRzLm51bWJlcihbLTM2NiwgMzY2XSwge3N0ZXA6IDEsIGxhYmVsOiBcInNwbGl0XCIsIHZhbHVlOiAzLCBwbGFjZWhvbGRlcjogXCJFbnRlciBzcGxpdCBzaXplXCJ9KSxcbiAgICBJbnB1dHMubnVtYmVyKFstMzY2LCAzNjZdLCB7c3RlcDogMSwgbGFiZWw6IFwic3BhY2VcIiwgdmFsdWU6IDIsIHBsYWNlaG9sZGVyOiBcIkVudGVyIHNwYWNlIHNpemVcIn0pLFxuXSlcbnZpZXdvZiBzcHJlYWRTdHJpbmcgPSB0cmFuc2Zvcm1JbnB1dChcbiAgSW5wdXRzLnRleHQoe2xhYmVsOiBcInNwcmVhZFwiLCBwbGFjZWhvbGRlcjogXCJFbnRlciBzcHJlYWQgc3RyaW5nXCIsIHZhbHVlOiBcIjA+MzY2PjM+MlwifSksXG57YmluZDogdmlld29mIHNwcmVhZElucHV0cywgdHJhbnNmb3JtOiBlbmNvZGVTcHJlYWQsIGludmVydDogZGVjb2RlU3ByZWFkfSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BkZWMvZG90ZFxuUGxvdC5wbG90KHtcbiAgY2xhc3NOYW1lOiBcImRhdGUtc2VsZWN0b3JcIixcbiAgcGFkZGluZzogMCxcbiAgeDoge2F4aXM6IFwidG9wXCIsIGxhYmVsOiBudWxsLCB0eXBlOiBcImJhbmRcIn0sXG4gIHk6IHtsYWJlbDogbnVsbCwgdHlwZTogXCJiYW5kXCJ9LFxuICBtYXJrczogW1xuICAgIFBsb3QuY2VsbChkYXRlcywge3g6IGQgPT4gZFsyXSwgeTogZCA9PiBkLnNsaWNlKDAsIDIpLCBmaWxsOiBkID0+XG4gICAgICBzbGljZUFycmF5LmluY2x1ZGVzKGQpICYmIHNwcmVhZEFycmF5LmluY2x1ZGVzKGQpID8gXCJncmVlblwiIDpcbiAgICAgIHNsaWNlQXJyYXkuaW5jbHVkZXMoZCkgJiYgIXNwcmVhZEFycmF5LmluY2x1ZGVzKGQpID8gXCJibHVlXCIgOlxuICAgICAgIXNsaWNlQXJyYXkuaW5jbHVkZXMoZCkgJiYgc3ByZWFkQXJyYXkuaW5jbHVkZXMoZCkgPyBcIm9yYW5nZVwiIDogXCJncmV5XCIsXG4gICAgICBpbnNldDogMC41fSksXG4gICAgUGxvdC50ZXh0KGRhdGVzLCB7XG4gICAgeDogZCA9PiBkWzJdLFxuICAgIHk6IGQgPT4gZC5zbGljZSgwLCAyKSxcbiAgICBmaWxsOiBcIndoaXRlXCIsXG4gICAgc3Ryb2tlOiBcImJsYWNrXCIsXG4gICAgZm9udFNpemU6IDIwfSlcbiAgXVxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBodHRwczovL29ic2VydmFibGVocS5jb20vQG1vb3RhcmkvcmFuZ2Utc2xpZGVyXG5mdW5jdGlvbiBpbnRlcnZhbChyYW5nZSA9IFtdLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3QgW21pbiA9IDAsIG1heCA9IDFdID0gcmFuZ2U7XG4gIGNvbnN0IHtcbiAgICBzdGVwID0gLjAwMSxcbiAgICBsYWJlbCA9IG51bGwsXG4gICAgdmFsdWUgPSBbbWluLCBtYXhdLFxuICAgIGZvcm1hdCA9IChbc3RhcnQsIGVuZF0pID0+IGAke3N0YXJ0fSDigKYgJHtlbmR9YCxcbiAgICBjb2xvcixcbiAgICB3aWR0aCxcbiAgICB0aGVtZSxcbiAgfSA9IG9wdGlvbnM7XG4gIGNvbnN0IF9fbnNfXyA9IERPTS51aWQoJ3Njb3BlJykuaWQ7XG4gIGNvbnN0IGNzcyA9IGBcbiMke19fbnNfX30ge1xuICBmb250OiAxM3B4LzEuMiB2YXIoLS1zYW5zLXNlcmlmKTtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGJhc2VsaW5lO1xuICBmbGV4LXdyYXA6IHdyYXA7XG4gIG1heC13aWR0aDogMTAwJTtcbiAgd2lkdGg6IGF1dG87XG59XG5AbWVkaWEgb25seSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDMwZW0pIHtcbiAgIyR7X19uc19ffSB7XG4gICAgZmxleC13cmFwOiBub3dyYXA7XG4gICAgd2lkdGg6IDM2MHB4O1xuICB9XG59XG4jJHtfX25zX199IC5sYWJlbCB7XG4gIHdpZHRoOiA1MHB4O1xuICBwYWRkaW5nOiA1cHggMCA0cHggMDtcbiAgbWFyZ2luLXJpZ2h0OiAuNXB4O1xuICBmbGV4LXNocmluazogMDtcbn1cbiMke19fbnNfX30gLmZvcm0ge1xuICBkaXNwbGF5OiBmbGV4O1xuICB3aWR0aDogMTAwJTtcbn1cbiMke19fbnNfX30gLnJhbmdlIHtcbiAgZmxleC1zaHJpbms6IDE7XG4gIHdpZHRoOiAxMDAlO1xufVxuIyR7X19uc19ffSAucmFuZ2Utc2xpZGVyIHtcbiAgd2lkdGg6IDEwMCU7XG59XG4gIGA7XG4gIGNvbnN0ICRyYW5nZSA9IHJhbmdlSW5wdXQoe21pbiwgbWF4LCB2YWx1ZTogW3ZhbHVlWzBdLCB2YWx1ZVsxXV0sIHN0ZXAsIGNvbG9yLCB3aWR0aCwgdGhlbWV9KTtcbiAgY29uc3QgJG91dHB1dCA9IGh0bWxgPG91dHB1dD5gO1xuICBjb25zdCAkdmlldyA9IGh0bWxgPGRpdiBpZD0ke19fbnNfX30+XG4ke2xhYmVsID09IG51bGwgPyAnJyA6IGh0bWxgPGRpdiBjbGFzcz1cImxhYmVsXCI+JHtsYWJlbH1gfVxuPGRpdiBjbGFzcz1mb3JtPlxuICA8ZGl2IGNsYXNzPXJhbmdlPlxuICAgICR7JHJhbmdlfTxkaXYgY2xhc3M9cmFuZ2Utb3V0cHV0IHN0eWxlPVwiZGlzcGxheTogaW5saW5lLWJsb2NrO1wiPiR7JG91dHB1dH08L2Rpdj5cbiAgPC9kaXY+XG48L2Rpdj5cbiR7aHRtbGA8c3R5bGU+JHtjc3N9YH1cbiAgYDtcbiAgY29uc3QgdXBkYXRlID0gKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBmb3JtYXQoWyRyYW5nZS52YWx1ZVswXSwgJHJhbmdlLnZhbHVlWzFdXSk7XG4gICAgaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSAkb3V0cHV0LnZhbHVlID0gY29udGVudDtcbiAgICBlbHNlIHtcbiAgICAgIHdoaWxlKCRvdXRwdXQubGFzdENoaWxkKSAkb3V0cHV0Lmxhc3RDaGlsZC5yZW1vdmUoKTtcbiAgICAgICRvdXRwdXQuYXBwZW5kQ2hpbGQoY29udGVudCk7XG4gICAgfVxuICB9O1xuICAkcmFuZ2Uub25pbnB1dCA9IHVwZGF0ZTtcbiAgdXBkYXRlKCk7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoJHZpZXcsICd2YWx1ZScsIHtcbiAgICBnZXQ6ICgpID0+ICRyYW5nZS52YWx1ZSxcbiAgICBzZXQ6IChbYSwgYl0pID0+IHtcbiAgICAgICRyYW5nZS52YWx1ZSA9IFthLCBiXTtcbiAgICAgIHVwZGF0ZSgpO1xuICAgIH0sXG4gIH0pO1xufVxuY3NzTGVuZ3RoID0gdiA9PiB2ID09IG51bGwgPyBudWxsIDogdHlwZW9mIHYgPT09ICdudW1iZXInID8gYCR7dn1weGAgOiBgJHt2fWBcbmZ1bmN0aW9uIHJhbmRvbVNjb3BlKHByZWZpeCA9ICdzY29wZS0nKSB7XG4gIHJldHVybiBwcmVmaXggKyAocGVyZm9ybWFuY2Uubm93KCkgKyBNYXRoLnJhbmRvbSgpKS50b1N0cmluZygzMikucmVwbGFjZSgnLicsICctJyk7XG59XG5mdW5jdGlvbiByYW5nZUlucHV0KG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgbWluID0gMCxcbiAgICBtYXggPSAxMDAsXG4gICAgc3RlcCA9ICdhbnknLFxuICAgIHZhbHVlOiBkZWZhdWx0VmFsdWUgPSBbbWluLCBtYXhdLFxuICAgIGNvbG9yLFxuICAgIHdpZHRoLFxuICAgIHRoZW1lID0gdGhlbWVfRmxhdCxcbiAgfSA9IG9wdGlvbnM7XG4gIGNvbnN0IGNvbnRyb2xzID0ge307XG4gIGNvbnN0IHNjb3BlID0gcmFuZG9tU2NvcGUoKTtcbiAgY29uc3QgY2xhbXAgPSAoYSwgYiwgdikgPT4gdiA8IGEgPyBhIDogdiA+IGIgPyBiIDogdjtcbiAgY29uc3QgaHRtbCA9IGh0bC5odG1sO1xuICAvLyBXaWxsIGJlIHVzZWQgdG8gc2FuaXRpemUgdmFsdWVzIHdoaWxlIGF2b2lkaW5nIGZsb2F0aW5nIHBvaW50IGlzc3Vlcy5cbiAgY29uc3QgaW5wdXQgPSBodG1sYDxpbnB1dCB0eXBlPXJhbmdlICR7e21pbiwgbWF4LCBzdGVwfX0+YDtcbiAgY29uc3QgZG9tID0gaHRtbGA8ZGl2IGNsYXNzPSR7YCR7c2NvcGV9IHJhbmdlLXNsaWRlcmB9IHN0eWxlPSR7e1xuICAgIGNvbG9yLFxuICAgIHdpZHRoOiBjc3NMZW5ndGgod2lkdGgpLFxuICB9fT5cbiAgJHtjb250cm9scy50cmFjayA9IGh0bWxgPGRpdiBjbGFzcz1cInJhbmdlLXRyYWNrXCI+XG4gICAgJHtjb250cm9scy56b25lID0gaHRtbGA8ZGl2IGNsYXNzPVwicmFuZ2UtdHJhY2stem9uZVwiPlxuICAgICAgJHtjb250cm9scy5yYW5nZSA9IGh0bWxgPGRpdiBjbGFzcz1cInJhbmdlLXNlbGVjdFwiIHRhYmluZGV4PTA+XG4gICAgICAgICR7Y29udHJvbHMubWluID0gaHRtbGA8ZGl2IGNsYXNzPVwidGh1bWIgdGh1bWItbWluXCIgdGFiaW5kZXg9MD5gfVxuICAgICAgICAke2NvbnRyb2xzLm1heCA9IGh0bWxgPGRpdiBjbGFzcz1cInRodW1iIHRodW1iLW1heFwiIHRhYmluZGV4PTA+YH1cbiAgICAgIGB9XG4gICAgYH1cbiAgYH1cbiAgJHtodG1sYDxzdHlsZT4ke3RoZW1lLnJlcGxhY2UoLzpzY29wZVxcYi9nLCAnLicrc2NvcGUpfWB9XG48L2Rpdj5gO1xuICBsZXQgdmFsdWUgPSBbXSwgY2hhbmdlZCA9IGZhbHNlO1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZG9tLCAndmFsdWUnLCB7XG4gICAgZ2V0OiAoKSA9PiBbLi4udmFsdWVdLFxuICAgIHNldDogKFthLCBiXSkgPT4ge1xuICAgICAgdmFsdWUgPSBzYW5pdGl6ZShhLCBiKTtcbiAgICAgIHVwZGF0ZVJhbmdlKCk7XG4gICAgfSxcbiAgfSk7XG4gIGNvbnN0IHNhbml0aXplID0gKGEsIGIpID0+IHtcbiAgICBhID0gaXNOYU4oYSkgPyBtaW4gOiAoKGlucHV0LnZhbHVlID0gYSksIGlucHV0LnZhbHVlQXNOdW1iZXIpO1xuICAgIGIgPSBpc05hTihiKSA/IG1heCA6ICgoaW5wdXQudmFsdWUgPSBiKSwgaW5wdXQudmFsdWVBc051bWJlcik7XG4gICAgcmV0dXJuIFtNYXRoLm1pbihhLCBiKSwgTWF0aC5tYXgoYSwgYildO1xuICB9XG4gIGNvbnN0IHVwZGF0ZVJhbmdlID0gKCkgPT4ge1xuICAgIGNvbnN0IHJhdGlvID0gdiA9PiAodiAtIG1pbikgLyAobWF4IC0gbWluKTtcbiAgICBkb20uc3R5bGUuc2V0UHJvcGVydHkoJy0tcmFuZ2UtbWluJywgYCR7cmF0aW8odmFsdWVbMF0pICogMTAwfSVgKTtcbiAgICBkb20uc3R5bGUuc2V0UHJvcGVydHkoJy0tcmFuZ2UtbWF4JywgYCR7cmF0aW8odmFsdWVbMV0pICogMTAwfSVgKTtcbiAgfTtcbiAgY29uc3QgZGlzcGF0Y2ggPSBuYW1lID0+IHtcbiAgICBkb20uZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQobmFtZSwge2J1YmJsZXM6IHRydWV9KSk7XG4gIH07XG4gIGNvbnN0IHNldFZhbHVlID0gKHZtaW4sIHZtYXgpID0+IHtcbiAgICBjb25zdCBbcG1pbiwgcG1heF0gPSB2YWx1ZTtcbiAgICB2YWx1ZSA9IHNhbml0aXplKHZtaW4sIHZtYXgpO1xuICAgIHVwZGF0ZVJhbmdlKCk7XG4gICAgLy8gT25seSBkaXNwYXRjaCBpZiB2YWx1ZXMgaGF2ZSBjaGFuZ2VkLlxuICAgIGlmKHBtaW4gPT09IHZhbHVlWzBdICYmIHBtYXggPT09IHZhbHVlWzFdKSByZXR1cm47XG4gICAgZGlzcGF0Y2goJ2lucHV0Jyk7XG4gICAgY2hhbmdlZCA9IHRydWU7XG4gIH07XG4gIHNldFZhbHVlKC4uLmRlZmF1bHRWYWx1ZSk7XG4gIC8vIE1vdXNlbW92ZSBoYW5kbGVycy5cbiAgY29uc3QgaGFuZGxlcnMgPSBuZXcgTWFwKFtcbiAgICBbY29udHJvbHMubWluLCAoZHQsIG92KSA9PiB7XG4gICAgICBjb25zdCB2ID0gY2xhbXAobWluLCBvdlsxXSwgb3ZbMF0gKyBkdCAqIChtYXggLSBtaW4pKTtcbiAgICAgIHNldFZhbHVlKHYsIG92WzFdKTtcbiAgICB9XSxcbiAgICBbY29udHJvbHMubWF4LCAoZHQsIG92KSA9PiB7XG4gICAgICBjb25zdCB2ID0gY2xhbXAob3ZbMF0sIG1heCwgb3ZbMV0gKyBkdCAqIChtYXggLSBtaW4pKTtcbiAgICAgIHNldFZhbHVlKG92WzBdLCB2KTtcbiAgICB9XSxcbiAgICBbY29udHJvbHMucmFuZ2UsIChkdCwgb3YpID0+IHtcbiAgICAgIGNvbnN0IGQgPSBvdlsxXSAtIG92WzBdO1xuICAgICAgY29uc3QgdiA9IGNsYW1wKG1pbiwgbWF4IC0gZCwgb3ZbMF0gKyBkdCAqIChtYXggLSBtaW4pKTtcbiAgICAgIHNldFZhbHVlKHYsIHYgKyBkKTtcbiAgICB9XSxcbiAgXSk7XG4gIC8vIFJldHVybnMgY2xpZW50IG9mZnNldCBvYmplY3QuXG4gIGNvbnN0IHBvaW50ZXIgPSBlID0+IGUudG91Y2hlcyA/IGUudG91Y2hlc1swXSA6IGU7XG4gIC8vIE5vdGU6IENocm9tZSBkZWZhdWx0cyBcInBhc3NpdmVcIiBmb3IgdG91Y2ggZXZlbnRzIHRvIHRydWUuXG4gIGNvbnN0IG9uICA9IChlLCBmbikgPT4gZS5zcGxpdCgnICcpLm1hcChlID0+IGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoZSwgZm4sIHtwYXNzaXZlOiBmYWxzZX0pKTtcbiAgY29uc3Qgb2ZmID0gKGUsIGZuKSA9PiBlLnNwbGl0KCcgJykubWFwKGUgPT4gZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLCBmbiwge3Bhc3NpdmU6IGZhbHNlfSkpO1xuICBsZXQgaW5pdGlhbFgsIGluaXRpYWxWLCB0YXJnZXQsIGRyYWdnaW5nID0gZmFsc2U7XG4gIGZ1bmN0aW9uIGhhbmRsZURyYWcoZSkge1xuICAgIC8vIEdyYWNlZnVsbHkgaGFuZGxlIGV4aXQgYW5kIHJlZW50cnkgb2YgdGhlIHZpZXdwb3J0LlxuICAgIGlmKCFlLmJ1dHRvbnMgJiYgIWUudG91Y2hlcykge1xuICAgICAgaGFuZGxlRHJhZ1N0b3AoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhZ2dpbmcgPSB0cnVlO1xuICAgIGNvbnN0IHcgPSBjb250cm9scy56b25lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBoYW5kbGVycy5nZXQodGFyZ2V0KSgocG9pbnRlcihlKS5jbGllbnRYIC0gaW5pdGlhbFgpIC8gdywgaW5pdGlhbFYpO1xuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZURyYWdTdG9wKGUpIHtcbiAgICBvZmYoJ21vdXNlbW92ZSB0b3VjaG1vdmUnLCBoYW5kbGVEcmFnKTtcbiAgICBvZmYoJ21vdXNldXAgdG91Y2hlbmQnLCBoYW5kbGVEcmFnU3RvcCk7XG4gICAgaWYoY2hhbmdlZCkgZGlzcGF0Y2goJ2NoYW5nZScpO1xuICB9XG4gIGludmFsaWRhdGlvbi50aGVuKGhhbmRsZURyYWdTdG9wKTtcbiAgZG9tLm9udG91Y2hzdGFydCA9IGRvbS5vbm1vdXNlZG93biA9IGUgPT4ge1xuICAgIGRyYWdnaW5nID0gZmFsc2U7XG4gICAgY2hhbmdlZCA9IGZhbHNlO1xuICAgIGlmKCFoYW5kbGVycy5oYXMoZS50YXJnZXQpKSByZXR1cm47XG4gICAgb24oJ21vdXNlbW92ZSB0b3VjaG1vdmUnLCBoYW5kbGVEcmFnKTtcbiAgICBvbignbW91c2V1cCB0b3VjaGVuZCcsIGhhbmRsZURyYWdTdG9wKTtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICBpbml0aWFsWCA9IHBvaW50ZXIoZSkuY2xpZW50WDtcbiAgICBpbml0aWFsViA9IHZhbHVlLnNsaWNlKCk7XG4gIH07XG4gIGNvbnRyb2xzLnRyYWNrLm9uY2xpY2sgPSBlID0+IHtcbiAgICBpZihkcmFnZ2luZykgcmV0dXJuO1xuICAgIGNoYW5nZWQgPSBmYWxzZTtcbiAgICBjb25zdCByID0gY29udHJvbHMuem9uZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCB0ID0gY2xhbXAoMCwgMSwgKHBvaW50ZXIoZSkuY2xpZW50WCAtIHIubGVmdCkgLyByLndpZHRoKTtcbiAgICBjb25zdCB2ID0gbWluICsgdCAqIChtYXggLSBtaW4pO1xuICAgIGNvbnN0IFt2bWluLCB2bWF4XSA9IHZhbHVlLCBkID0gdm1heCAtIHZtaW47XG4gICAgaWYodiA8IHZtaW4pIHNldFZhbHVlKHYsIHYgKyBkKTtcbiAgICBlbHNlIGlmKHYgPiB2bWF4KSBzZXRWYWx1ZSh2IC0gZCwgdik7XG4gICAgaWYoY2hhbmdlZCkgZGlzcGF0Y2goJ2NoYW5nZScpO1xuICB9O1xuICByZXR1cm4gZG9tO1xufVxuZnVuY3Rpb24gZm9ybWF0RGVjaW1hbChudW1iZXIpIHtcbiAgcmV0dXJuIG51bWJlciA9PSAxID8gbnVtYmVyIDogKE1hdGgucm91bmQobnVtYmVyICogMTAwKSAvIDEwMCkudG9TdHJpbmcoKS5zbGljZSgxKVxufVxuYnV0dG9uID0gKGRhdGEsIGZpbGVuYW1lID0gJ2RhdGEuY3N2JykgPT4ge1xuICBpZiAoIWRhdGEpIHRocm93IG5ldyBFcnJvcignQXJyYXkgb2YgZGF0YSByZXF1aXJlZCBhcyBmaXJzdCBhcmd1bWVudCcpO1xuICBsZXQgZG93bmxvYWREYXRhO1xuICBpZiAoZmlsZW5hbWUuaW5jbHVkZXMoJy5jc3YnKSkge1xuICAgIGRvd25sb2FkRGF0YSA9IG5ldyBCbG9iKFtkMy5jc3ZGb3JtYXQoZGF0YSldLCB7IHR5cGU6IFwidGV4dC9jc3ZcIiB9KTtcbiAgfSBlbHNlIHtcbiAgICBkb3dubG9hZERhdGEgPSBuZXcgQmxvYihbSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMildLCB7XG4gICAgICB0eXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgIH0pO1xuICB9XG4gIHJldHVybiBET00uZG93bmxvYWQoXG4gICAgZG93bmxvYWREYXRhLFxuICAgIGZpbGVuYW1lLFxuICAgIFwiRG93bmxvYWRcIlxuICApO1xufVxuZnVuY3Rpb24gaW52ZXJ0KGFycikge1xuICByZXR1cm4gaW52ZXJ0RG90ZCA/IFsuLi5BcnJheSgxMCkua2V5cygpXS5tYXAobiA9PiAhYXJyLmluY2x1ZGVzKG4pKS5tYXAoKHgsIGkpID0+IHggPyBpIDogbnVsbCkuZmlsdGVyKGkgPT4gaSAhPT0gbnVsbCkgOiBhcnJcbn1cbi8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AY2hyaXNwYWhtL3RvZ2dsZS1zd2l0Y2gtaW5wdXQtYnV0dG9uXG5mdW5jdGlvbiB0b2dnbGVTd2l0Y2gob3B0aW9ucyA9IHsgdGV4dE9uOiAnVHJ1ZScsIHRleHRPZmY6ICdGYWxzZScgfSkge1xuICBjb25zdCBidXR0b24gPSBodG1sYDxkaXYgY2xhc3M9XCJidXR0b24tc3dpdGNoXCJcIj48L2Rpdj5gO1xuICBidXR0b24uaW5uZXJUZXh0ID0gb3B0aW9ucy50ZXh0T247XG4gIGJ1dHRvbi52YWx1ZSA9IHRydWU7XG5cbiAgYnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgYnV0dG9uLnZhbHVlID0gIWJ1dHRvbi52YWx1ZTtcbiAgICBidXR0b24uaW5uZXJUZXh0ID0gYnV0dG9uLnZhbHVlID8gb3B0aW9ucy50ZXh0T24gOiBvcHRpb25zLnRleHRPZmY7XG4gICAgYnV0dG9uLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIikpO1xuICB9O1xuXG4gIGFkZEJ1dHRvblN0eWxlKClcblxuICByZXR1cm4gYnV0dG9uO1xufVxuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BjaHJpc3BhaG0vdG9nZ2xlLXN3aXRjaC1pbnB1dC1idXR0b25cbmZ1bmN0aW9uIGFkZEJ1dHRvblN0eWxlKCkge1xuICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICBlbC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dC9jc3MnKTtcbiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChlbCk7XG4gIHZhciBzaGVldCA9IGVsLnNoZWV0O1xuICBmdW5jdGlvbiBhZGRSdWxlKHJ1bGUpIHtcbiAgICB0cnkge1xuICAgICAgc2hlZXQuaW5zZXJ0UnVsZShydWxlLCBzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUud2FybignRXJyb3IgaW5zZXJ0aW5nIHJ1bGUnLCBydWxlLCBlKTtcbiAgICB9XG4gIH1cbiAgYWRkUnVsZShcbiAgICAnLmJ1dHRvbi1zd2l0Y2ggeyAtd2Via2l0LXRvdWNoLWNhbGxvdXQ6IG5vbmU7LXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsta2h0bWwtdXNlci1zZWxlY3Q6IG5vbmU7LW1vei11c2VyLXNlbGVjdDogbm9uZTstbXMtdXNlci1zZWxlY3Q6IG5vbmU7dXNlci1zZWxlY3Q6IG5vbmU7ZGlzcGxheTogaW5saW5lLWJsb2NrOy13ZWJraXQtYm9yZGVyLXJhZGl1czogMnB4Oy1tb3otYm9yZGVyLXJhZGl1czogMnB4O2JvcmRlci1yYWRpdXM6IDJweDtiYWNrZ3JvdW5kLWNvbG9yOiAjRUZFRkVGO3BhZGRpbmc6IDBweCA3cHggMHB4IDdweDt0ZXh0LWFsaWduOiBjZW50ZXI7Ym9yZGVyOiAxcHggc29saWQgZ3JleTt3aWR0aDogYXV0bztjb2xvcjogIzFjMWMxYztmb250LXNpemU6IDE0cHg7Zm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7dGV4dC1kZWNvcmF0aW9uOiBub25lOyB9J1xuICApO1xuICBhZGRSdWxlKFxuICAgICcuYnV0dG9uLXN3aXRjaDpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ICNFNUU1RTU7Ym9yZGVyOiAxcHggc29saWQgIzQ1NDU0NTsgfSdcbiAgKTtcbiAgYWRkUnVsZShcbiAgICAnLmJ1dHRvbi1zd2l0Y2g6YWN0aXZlIHsgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTtib3JkZXI6IDFweCBzb2xpZCBncmV5OyB9J1xuICApO1xufVxuZnVuY3Rpb24gc2V0U3ByZWFkRG90ZChkb3RkKSB7XG4gIGNvbnN0IGRvdGRMZW5ndGggPSBkb3RkLmxlbmd0aDtcbiAgaWYgKGRvdGRMZW5ndGggPT09IDEwKSB7cmV0dXJuIFwiPlwifVxuICBpZiAoZG90ZExlbmd0aCA9PT0gMCkge3JldHVybiBcIj4wXCJ9XG4gIGlmIChkb3RkTGVuZ3RoID09PSAxKSB7cmV0dXJuIGAke2RvdGRbMF19Pj4xPjlgfVxuICBjb25zdCBzdGVwcyA9IGRvdGQubWFwKCh4LCBpKSA9PiBkb3RkW2kgKyAxXSAtIHgpXG4gICAgLmZpbHRlcihpID0+ICFpc05hTihpKSksXG4gICAgcmVzdWx0ID0gW107XG4gIGxldCBzcGxpdCA9IDE7XG4gIGZvciAoY29uc3Qgc3RlcCBvZiBzdGVwcykge1xuICAgIGlmIChzdGVwICE9PSAxKSB7XG4gICAgICAgcmVzdWx0LnB1c2goW3NwbGl0LCBzdGVwIC0gMV0pXG4gICAgICAgc3BsaXQgPSAxXG4gICAgfSBlbHNlIHtcbiAgICAgIHNwbGl0ICs9IDFcbiAgICB9XG4gIH1cbiAgcmVzdWx0LnB1c2goc3BsaXQpXG4gIGNvbnN0IGZsYXQgPSBbXS5jb25jYXQoLi4ucmVzdWx0KSxcbiAgICByZXN1bHRTdW0gPSBmbGF0LnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApLFxuICAgIHVuaXEgPSBbLi4ubmV3IFNldChmbGF0KV07XG4gIHJldHVybiBbZG90ZFswXSA/IGRvdGRbMF0gOiBudWxsLCBudWxsXS5jb25jYXQoSlNPTi5zdHJpbmdpZnkodW5pcSkgPT09IFwiWzFdXCIgPyBbbnVsbCwgMV0gOiB1bmlxLmxlbmd0aCA9PT0gMiAmJiB1bmlxLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApID09PSA1ID8gdW5pcSA6IGZsYXQuY29uY2F0KDEwIC0gcmVzdWx0U3VtKS5tYXAoKHgsIGkpID0+IGkgJSAyID09PSAwICYmIHggPT09IDEgPyBudWxsIDogeCkpLmpvaW4oXCI+XCIpXG59XG5mdW5jdGlvbiBzZXRTbGljZURvdGQoZG90ZCkge1xuICBjb25zdCBkb3RkTGVuZ3RoID0gZG90ZC5sZW5ndGg7XG4gIGlmIChkb3RkTGVuZ3RoID09PSAxMCkge3JldHVybiBcIjpcIn1cbiAgaWYgKGRvdGRMZW5ndGggPT09IDApIHtyZXR1cm4gXCI6MFwifVxuICBjb25zdCBzdGVwcyA9IGRvdGQubWFwKCh4LCBpKSA9PiBkb3RkW2kgKyAxXSAtIHgpXG4gICAgLmZpbHRlcihpID0+ICFpc05hTihpKSksXG4gICAgc3RlcFN1bSA9IHN0ZXBzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApLFxuICAgIHVuaXEgPSBbLi4ubmV3IFNldChzdGVwcy5jb25jYXQoMTAgLSBzdGVwU3VtKSldO1xuICByZXR1cm4gW2RvdGRbMF0gPyBkb3RkWzBdIDogbnVsbCwgbnVsbF0uY29uY2F0KHVuaXEubGVuZ3RoID09PSAxID8gdW5pcSA6IEpTT04uc3RyaW5naWZ5KHN0ZXBzKSA9PT0gXCJbMSw0LDFdXCIgPyBbMSwgNF0gOiBKU09OLnN0cmluZ2lmeShzdGVwcykgPT09IFwiWzEsMSwzLDEsMV1cIiA/IFsxLCAxLCAzXSA6IEpTT04uc3RyaW5naWZ5KHN0ZXBzKSA9PT0gXCJbMSwxLDEsMiwxLDEsMV1cIiA/IFsxLCAxLCAxLCAyXSA6IHN0ZXBzLmNvbmNhdCgxMCAtIHN0ZXBTdW0pLm1hcCh4ID0+IHggPT09IDEgPyBudWxsIDogeCkpLmpvaW4oXCI6XCIpO1xufVxuZnVuY3Rpb24gZW5jb2RlU2xpY2UoLi4uYXJncykge1xuICByZXR1cm4gYXJncy5qb2luKCkucmVwbGFjZUFsbChcIixcIiwgXCI6XCIpXG59XG5mdW5jdGlvbiBkZWNvZGVTbGljZShzKSB7XG4gIGxldCBbc3RhcnQsIHN0b3AsIC4uLnN0ZXBzXSA9IHMuc3BsaXQoXCI6XCIpLm1hcChpID0+IGkgPT09IFwiXCIgPyBudWxsIDogTnVtYmVyKGkpKVxuICBjb25zdCBzdGVwID0gc3RlcHNbMF0gPT0gbnVsbCA/IDE6IHN0ZXBzWzBdO1xuICBzdGFydCA9IHN0YXJ0ID09IG51bGwgJiYgc3RlcCA+PSAwID8gMCA6IHN0YXJ0ID09IG51bGwgJiYgc3RlcCA8IDAgPyAzNjUgOiBzdGFydDtcbiAgc3RvcCA9IHN0b3AgPT0gbnVsbCAmJiBzdGVwID49IDAgPyAzNjYgOiBzdG9wO1xuICByZXR1cm4gW3N0YXJ0LCBzdG9wLCBzdGVwXVxufVxuZnVuY3Rpb24gZGVjb2RlU3ByZWFkKHNwcmVhZCkge1xuICByZXR1cm4gc3ByZWFkLnJlcGxhY2UoL148LywgXCIzNjY8XCIpLnJlcGxhY2UoL14+LywgXCIwPlwiKVxuICAgIC5zcGxpdCgvKD89XlxcZHw8fD4pLykubWFwKHMgPT4gcy5yZXBsYWNlKFwiPFwiLCBcIi1cIilcbiAgICAucmVwbGFjZShcIj5cIiwgXCJcIikpLm1hcChzID0+IHMgPT09IFwiXCIgfHwgaXNOYU4ocykgPyBudWxsIDogTnVtYmVyKHMpKVxufVxuZnVuY3Rpb24gZW5jb2RlU3ByZWFkKGFyZ3MpIHtcbiAgcmV0dXJuIGFyZ3MubWFwKGEgPT4gaXNOYU4oYSkgPyBudWxsIDogYSkuam9pbihcIj5cIikucmVwbGFjZShcIj4tXCIsIFwiPFwiKVxufVxuZnVuY3Rpb24gc2xpY2Uoc2VsZiwgc3RhcnQsIHN0b3AsIHN0ZXBzLCAuLi5hcmdzKSB7XG4gIGNvbnN0IGxlbiA9IHNlbGYubGVuZ3RoLCByZXN1bHQgPSBbXTtcbiAgaWYgKHN0ZXBzID09PSAwIHx8IGxlbiA9PT0gMCkgeyByZXR1cm4gcmVzdWx0IH07XG4gIHN0ZXBzID0gKCFzdGVwcyB8fCBzdGVwcy5sZW5ndGggPT09IDAgPyBbMV0gOlxuICAgIHR5cGVvZiBzdGVwcyA9PT0gXCJudW1iZXJcIiA/IFtzdGVwc10gOlxuICAgIHR5cGVvZiBzdGVwcyA9PT0gXCJzdHJpbmdcIiA/IEFycmF5LmZyb20oc3RlcHMsIE51bWJlcikgOlxuICAgIHN0ZXBzKS5jb25jYXQoYXJncy5tYXAoaSA9PiBpID09IG51bGwgPyAxIDogaSkpO1xuICBjb25zdCBzdGVwQ291bnQgPSBzdGVwcy5sZW5ndGgsXG4gICAgc3RlcFN1bSA9IHN0ZXBzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApO1xuICBpZiAoc3RlcFN1bSA9PT0gMCkgeyByZXR1cm4gcmVzdWx0IH07XG4gIHN0YXJ0ID0gTWF0aC5tYXgoXG4gICAgc3RhcnQgPT0gbnVsbCAmJiBzdGVwU3VtID4gMCA/IDAgOlxuICAgIHN0YXJ0ID09IG51bGwgJiYgc3RlcFN1bSA8IDAgPyBsZW4gLSAxIDpcbiAgICBzdGFydCA+PSBsZW4gPyBsZW4gLSAxIDpcbiAgICBzdGFydCA8IDAgPyBzdGFydCArIGxlbiA6XG4gICAgc3RhcnQsIDApO1xuICBzdG9wID0gTWF0aC5tYXgoXG4gICAgc3RvcCA9PSBudWxsICYmIHN0ZXBTdW0gPiAwID8gbGVuIDpcbiAgICBzdG9wID09IG51bGwgJiYgc3RlcFN1bSA8IDAgPyAtMSA6XG4gICAgc3RvcCA+PSBsZW4gPyBsZW4gOlxuICAgIHN0b3AgPCAwID8gc3RvcCArIGxlbiA6XG4gICAgc3RvcCwgLTEpO1xuICBmb3IgKFxuICAgIGxldCBpID0gc3RhcnQsIGNvdW50ZXIgPSAtMTtcbiAgICBzdGVwU3VtID4gMCA/IGkgPCBzdG9wIDogaSA+IHN0b3A7XG4gICAgaSArPSBzdGVwc1tjb3VudGVyXVxuICApIHtcbiAgICByZXN1bHQucHVzaChzZWxmW2ldKTtcbiAgICBjb3VudGVyID0gKGNvdW50ZXIgKyAxKSAlIHN0ZXBDb3VudDtcbiAgfTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIHNwcmVhZChzZWxmLCBzdGFydE9yU3RvcCwgc3Bhbiwgc3BsaXRzQW5kU3BhY2VzLCAuLi5hcmdzKSB7XG4gIGNvbnN0IGxlbiA9IHNlbGYubGVuZ3RoLCByZXN1bHQgPSBbXTtcbiAgaWYgKHNwYW4gPT09IDAgfHwgbGVuID09PSAwKSB7IHJldHVybiByZXN1bHQgfTtcbiAgc3BsaXRzQW5kU3BhY2VzID0gKCFzcGxpdHNBbmRTcGFjZXMgfHwgc3BsaXRzQW5kU3BhY2VzLmxlbmd0aCA9PT0gMCA/IFsxXSA6XG4gICAgdHlwZW9mIHNwbGl0c0FuZFNwYWNlcyA9PT0gXCJudW1iZXJcIiA/IFtzcGxpdHNBbmRTcGFjZXNdIDpcbiAgICB0eXBlb2Ygc3BsaXRzQW5kU3BhY2VzID09PSBcInN0cmluZ1wiID8gQXJyYXkuZnJvbShzcGxpdHNBbmRTcGFjZXMsIE51bWJlcikgOlxuICAgIHNwbGl0c0FuZFNwYWNlcykuY29uY2F0KGFyZ3MubWFwKGkgPT4gaSA9PSBudWxsID8gMSA6IGkpKTtcbiAgICBjb25zdCBzcGxpdENvdW50ID0gc3BsaXRzQW5kU3BhY2VzLmxlbmd0aCxcbiAgICBzcGxpdFNwYWNlU3VtID0gc3BsaXRzQW5kU3BhY2VzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApO1xuICBpZiAoc3BsaXRTcGFjZVN1bSA8PSAwKSB7IHJldHVybiByZXN1bHQgfTtcbiAgc3RhcnRPclN0b3AgPSBNYXRoLm1heChcbiAgICBzdGFydE9yU3RvcCA9PSBudWxsICYmIHNwYW4gPiAwIHx8IHN0YXJ0T3JTdG9wID09IG51bGwgJiYgc3BhbiA9PSBudWxsID8gMCA6XG4gICAgc3RhcnRPclN0b3AgPT0gbnVsbCB8fCBzdGFydE9yU3RvcCA+IGxlbiAmJiBzcGFuIDwgMCA/IGxlbiA6XG4gICAgc3RhcnRPclN0b3AgPCAwID8gc3RhcnRPclN0b3AgKyBsZW4gOlxuICAgIHN0YXJ0T3JTdG9wLCAwKTtcbiAgc3BhbiA9IHNwYW4gPT0gbnVsbCB8fCBzdGFydE9yU3RvcCArIHNwYW4gPiBsZW4gPyBsZW4gLSBzdGFydE9yU3RvcCA6XG4gICAgc3RhcnRPclN0b3AgKyBzcGFuIDwgMCA/IC1zdGFydE9yU3RvcDogc3BhbjtcbiAgY29uc3Qgc3RhcnQgPSBzcGFuID4gMCA/IHN0YXJ0T3JTdG9wIDogc3RhcnRPclN0b3AgKyBzcGFuLFxuICAgIHN0b3AgPSBzcGFuID4gMCA/IHN0YXJ0T3JTdG9wICsgc3BhbiA6IHN0YXJ0T3JTdG9wO1xuICBmb3IgKGxldCBpID0gc3RhcnQsIGMgPSAtMSwgYXJyID0gW107IGkgPCBzdG9wOyBpICs9IHNwbGl0c0FuZFNwYWNlc1tjXSkge1xuICAgIGlmICgoYyA9IChjICsgMSkgJSBzcGxpdENvdW50KSAlIDIgPT09IDAgJiYgaSArIHNwbGl0c0FuZFNwYWNlc1tjXSA8PSBzdG9wKSB7XG4gICAgICBpZiAoKGFyciA9IEFycmF5LmZyb20oe2xlbmd0aDogc3BsaXRzQW5kU3BhY2VzW2NdfSwgKF8sIGopID0+IGogKyBpKS5tYXAoXG4gICAgICAgIGluZGV4ID0+IHNlbGZbaW5kZXhdKS5maWx0ZXIoaXRlbSA9PiBpdGVtICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgKS5sZW5ndGggPT0gc3BsaXRzQW5kU3BhY2VzW2NdKSB7IHJlc3VsdC5wdXNoKGFycikgfVxuICAgIH1cbiAgfTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJuZXN0ZWQgPSBBcnJheS5mcm9tKHtsZW5ndGg6IGludGVydmFscy5sZW5ndGh9LCAoXywgaSkgPT4gKFtcbiAge1xuICBsYWJlbDogYCR7aX0gb3IgJHtpKzV9YCxcbiAgZHVyYXRpb246IGludGVydmFsc1tpXVsxXSAhPT0gaW50ZXJ2YWxzW2ldWzBdID8gaW50ZXJ2YWxzW2ldWzBdIDogMSxcbiAgZ3JvdXA6IFwiUmVzdFwiXG59LFxuICB7XG4gIGxhYmVsOiBgJHtpfSBvciAke2krNX1gLFxuICBkdXJhdGlvbjogaW50ZXJ2YWxzW2ldWzFdLWludGVydmFsc1tpXVswXSxcbiAgZ3JvdXA6IFwiV29ya1wiXG59LFxuICB7XG4gIGxhYmVsOiBgJHtpfSBvciAke2krNX1gLFxuICBkdXJhdGlvbjogaW50ZXJ2YWxzW2ldWzFdICE9PSBpbnRlcnZhbHNbaV1bMF0gPyAxLWludGVydmFsc1tpXVsxXSA6IG51bGwsXG4gIGdyb3VwOiBcIlJlc3RcIlxuICB9XSkpXG5kdXJhdGlvbnMgPSBbXS5jb25jYXQoLi4ubmVzdGVkKVxudGhlbWVfRmxhdCA9IGBcbi8qIE9wdGlvbnMgKi9cbjpzY29wZSB7XG4gIGNvbG9yOiAjM2I5OWZjO1xuICB3aWR0aDogMjQwcHg7XG59XG5cbjpzY29wZSB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAtLXRodW1iLXNpemU6IDE1cHg7XG4gIC0tdGh1bWItcmFkaXVzOiBjYWxjKHZhcigtLXRodW1iLXNpemUpIC8gMik7XG4gIHBhZGRpbmc6IHZhcigtLXRodW1iLXJhZGl1cykgMDtcbiAgbWFyZ2luOiAycHg7XG4gIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XG59XG46c2NvcGUgLnJhbmdlLXRyYWNrIHtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBoZWlnaHQ6IDdweDtcbiAgYmFja2dyb3VuZC1jb2xvcjogaHNsKDAsIDAlLCA4MCUpO1xuICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xuICBwYWRkaW5nOiAwIHZhcigtLXRodW1iLXJhZGl1cyk7XG59XG46c2NvcGUgLnJhbmdlLXRyYWNrLXpvbmUge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG59XG46c2NvcGUgLnJhbmdlLXNlbGVjdCB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgbGVmdDogdmFyKC0tcmFuZ2UtbWluKTtcbiAgd2lkdGg6IGNhbGModmFyKC0tcmFuZ2UtbWF4KSAtIHZhcigtLXJhbmdlLW1pbikpO1xuICBjdXJzb3I6IGV3LXJlc2l6ZTtcbiAgYmFja2dyb3VuZDogY3VycmVudENvbG9yO1xuICBoZWlnaHQ6IDdweDtcbiAgYm9yZGVyOiBpbmhlcml0O1xufVxuLyogRXhwYW5kcyB0aGUgaG90c3BvdCBhcmVhLiAqL1xuOnNjb3BlIC5yYW5nZS1zZWxlY3Q6YmVmb3JlIHtcbiAgY29udGVudDogXCJcIjtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiB2YXIoLS10aHVtYi1zaXplKTtcbiAgbGVmdDogMDtcbiAgdG9wOiBjYWxjKDJweCAtIHZhcigtLXRodW1iLXJhZGl1cykpO1xufVxuOnNjb3BlIC5yYW5nZS1zZWxlY3Q6Zm9jdXMsXG46c2NvcGUgLnRodW1iOmZvY3VzIHtcbiAgb3V0bGluZTogbm9uZTtcbn1cbjpzY29wZSAudGh1bWIge1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHdpZHRoOiB2YXIoLS10aHVtYi1zaXplKTtcbiAgaGVpZ2h0OiB2YXIoLS10aHVtYi1zaXplKTtcblxuICBiYWNrZ3JvdW5kOiAjZmNmY2ZjO1xuICB0b3A6IC00cHg7XG4gIGJvcmRlci1yYWRpdXM6IDEwMCU7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGhzbCgwLDAlLDU1JSk7XG4gIGN1cnNvcjogZGVmYXVsdDtcbiAgbWFyZ2luOiAwO1xufVxuOnNjb3BlIC50aHVtYjphY3RpdmUge1xuICBib3gtc2hhZG93OiBpbnNldCAwIHZhcigtLXRodW1iLXNpemUpICMwMDAyO1xufVxuOnNjb3BlIC50aHVtYi1taW4ge1xuICBsZWZ0OiBjYWxjKC0xcHggLSB2YXIoLS10aHVtYi1yYWRpdXMpKTtcbn1cbjpzY29wZSAudGh1bWItbWF4IHtcbiAgcmlnaHQ6IGNhbGMoLTFweCAtIHZhcigtLXRodW1iLXJhZGl1cykpO1xufVxuYFxuc2NoZWR1bGVzID0gW1xuICBbWy4yLCAuOF0sIFsuMiwgLjhdLCBbMCwgMF0sIFswLCAwXSwgWzAsIDBdXSxcbiAgW1suMywgLjddLCBbLjMsIC43XSwgWy4zLCAuN10sIFswLCAwXSwgWzAsIDBdXSxcbiAgW1suMzUsIC42NV0sIFsuMzUsIC42NV0sIFsuMzUsIC42NV0sIFsuMzUsIC42NV0sIFswLCAwXV0sXG4gIFtbLjM4LCAuNjJdLCBbLjM4LCAuNjJdLCBbLjM4LCAuNjJdLCBbLjM4LCAuNjJdLCBbLjM4LCAuNjJdXSxcbl1cbmRhdGVzID0gQXJyYXkuZnJvbSh7bGVuZ3RoOiAzNjZ9LCAoXywgaSkgPT4gaS50b1N0cmluZygpLnBhZFN0YXJ0KDMsIFwiMFwiKSlcbnNsaWNlQXJyYXkgPSBzbGljZShkYXRlcywgLi4uc2xpY2VTdHJpbmcuc3BsaXQoXCI6XCIpLm1hcChpID0+IGkgPT09IFwiXCIgPyBudWxsIDogTnVtYmVyKGkpKSlcbnNwcmVhZEFycmF5ID0gW10uY29uY2F0KC4uLnNwcmVhZChkYXRlcywgLi4uZGVjb2RlU3ByZWFkKHNwcmVhZFN0cmluZykpKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InNldCh2aWV3b2YgaW50ZXJ2YWxzLCBzY2hlZHVsZXNbc2NoZWR1bGUtMl0pXG5zZXQodmlld29mIHNwcmVhZFN0cmluZywgc2V0U3ByZWFkRG90ZChzcHJlYWREb3RkKSlcbnNldCh2aWV3b2Ygc2xpY2VTdHJpbmcsIHNldFNsaWNlRG90ZChzbGljZURvdGQpKVxue1xuICBpZiAoaW52ZXJ0RG90ZCA/ICFzbGljZU9yU3ByZWFkIDogc2xpY2VPclNwcmVhZCkge1xuICAgIHNldCh2aWV3b2Ygc2xpY2VEb3RkLCBpbnZlcnQodG9nZ2xlUGxvdCkpXG4gIH0gZWxzZSB7XG4gICAgc2V0KHZpZXdvZiBzcHJlYWREb3RkLCBpbnZlcnQodG9nZ2xlUGxvdCkpXG4gIH1cbn1cblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdpbnB1dERvdHknKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgneWVhcicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdtb250aElucHV0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2RvdG1JbnB1dCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzY3J1YmJlckRvdHknKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnaW5wdXREYXRldGltZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCd5ZCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdkZWNvT3V0cHV0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NjcnViYmVyRGVjbycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdpbnRlcnZhbHMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2NoZWR1bGUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZmlsZW5hbWUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2xpY2VEb3RkJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NwcmVhZERvdGQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgndG9nZ2xlUGxvdCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdpbnZlcnREb3RkJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NsaWNlT3JTcHJlYWQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2xpY2VJbnB1dHMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2xpY2VTdHJpbmcnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc3ByZWFkSW5wdXRzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NwcmVhZFN0cmluZycpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../observable";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/maptv\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../jupyter/index.html" class="pagination-link" aria-label="Jupyter">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Jupyter</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../positron/index.html" class="pagination-link" aria-label="Positron">
        <span class="nav-page-text">Positron</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Observable</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> true</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Martin Laptev</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://maptv.github.io</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="an">date-format:</span><span class="co"> x</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - ../asset/date.lua</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> horst_many-lang-qmd-to-output.png</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - tool</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - observable</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - quarto</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">    include-after-body:</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../asset/stamp.html</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../asset/style.html</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">      - ../asset/tooltip.html</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## [TL;DR]{.underline .blue data-bs-toggle="tooltip" data-bs-title="too long; didn't read"}</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>The goal of this blog post, the fourth in my <span class="co">[</span><span class="ot">Tools</span><span class="co">](..#category=tool)</span> blog post series, is to set up the <span class="co">[</span><span class="ot">Visual Studio Code</span><span class="co">](https://code.visualstudio.com)</span> (VSCode) <span class="co">[</span><span class="ot">source-code editor</span><span class="co">](https://en.wikipedia.org/wiki/Source-code_editor#:~:text=A%20source%2Dcode%20editor%20is%20a%20text%20editor%20program%20designed%20specifically%20for%20editing%20source%20code%20of%20computer%20programs.)</span> to run in the remote development environments provided by the <span class="co">[</span><span class="ot">Codespaces</span><span class="co">](https://github.com/features/codespaces)</span> and <span class="co">[</span><span class="ot">GitPod</span><span class="co">](https://www.gitpod.io)</span> <span class="co">[</span><span class="ot">computing platforms</span><span class="co">](https://en.wikipedia.org/wiki/Computing_platform#:~:text=A%20computing%20platform%2C%20digital%20platform%2C%5B1%5D%20or%20software%20platform%20is%20an%20environment%20in%20which%20software%20is%20executed.)</span>. To accomplish this goal, we will use VSCode to edit a setup <span class="co">[</span><span class="ot">script</span><span class="co">](https://en.wikipedia.org/wiki/Shell_script#:~:text=A%20shell%20script%20is%20a%20computer%20program%20designed%20to%20be%20run%20by%20a%20Unix%20shell%2C%20a%20command%2Dline%20interpreter.%5B)</span> and configuration files in a Git <span class="co">[</span><span class="ot">repository</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Repository_(version_control)#:~:text=In%20version%20control%20systems%2C%20a%20repository%20is%20a%20data%20structure%20that%20stores%20metadata%20for%20a%20set%20of%20files%20or%20directory%20structure.) (repo) named <span class="in">`dotfiles`</span>.</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>%%| column: margin</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>%%| label: fig-navchart</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>%%| fig-cap: Tools series navigation chart</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>flowchart TB</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>   A[Git]--&gt;B[VSCode]--&gt;C[Quarto]</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>   C--&gt;D[Observable]</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>   C--&gt;E[Jupyter]</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>   C--&gt;F[Knitr]</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>   click A <span class="ot">"</span><span class="st">../git</span><span class="ot">"</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>   click B <span class="ot">"</span><span class="st">../vscode</span><span class="ot">"</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>   click C <span class="ot">"</span><span class="st">../quarto</span><span class="ot">"</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>   click D <span class="ot">"</span><span class="st">../observable</span><span class="ot">"</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>   click E <span class="ot">"</span><span class="st">../jupyter</span><span class="ot">"</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>   click F <span class="ot">"</span><span class="st">../knitr</span><span class="ot">"</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>   style D stroke:<span class="co">#99f,stroke-width:5px</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction {#sec-intro}</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>If you do not have such a repo, you can create one by following along with the <span class="co">[</span><span class="ot">previous post</span><span class="co">](../git)</span> in my <span class="co">[</span><span class="ot">tools</span><span class="co">](..#category=tool)</span> blog post series, which is shown in @fig-navchart.</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Day-of-the-year {#sec-intro-doty}</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a><span class="in">`Decalendar`</span><span class="ot">[^1]</span> is a <span class="co">[</span><span class="ot">decimal</span><span class="co">](https://en.wikipedia.org/wiki/Decimal)</span> calendar🗓️system and <span class="in">`Declock`</span><span class="ot">[^2]</span> is a decimal timekeeping⏳system. Instead of months, weeks, hours, minutes, and seconds, <span class="in">`Decalendar`</span> and <span class="in">`Declock`</span> use a number called the day-of-the-year (<span class="in">`doty`</span>)<span class="ot">[^3]</span>. @fig-bar-doty displays the current <span class="in">`doty`</span> (\${styledDotyDate}.\${styledDotyTime}) as a bar chart. The <span class="co">[</span><span class="ot">integer part</span><span class="co">](https://en.wikipedia.org/wiki/Decimal#:~:text=The%20integer%20part%20or%20integral%20part%20of%20a%20decimal%20numeral%20is%20the%20integer%20written%20to%20the%20left%20of%20the%20decimal%20separator)</span> of the <span class="in">`doty`</span> is the <span class="in">`Decalendar`</span> date<span class="ot">[^4]</span> (\${setStyle(dotyDate, d3.schemePaired<span class="sc">\[</span>1<span class="sc">\]</span>)}) and the <span class="co">[</span><span class="ot">fractional part</span><span class="co">](https://en.wikipedia.org/wiki/Decimal#:~:text=The%20part%20from%20the%20decimal%20separator%20to%20the%20right%20is%20the%20fractional%20part%2C%20which%20equals%20the%20difference%20between%20the%20numeral%20and%20its%20integer%20part.)</span> is the <span class="in">`Declock`</span> time<span class="ot">[^5]</span> (\${setStyle(dotyTime, d3.schemePaired<span class="sc">\[</span>2<span class="sc">\]</span>)}).</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span><span class="in">`Decalendar`</span>: a calendar system that uses <span class="in">`deks`</span> instead of months and weeks</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a><span class="ot">[^2]: </span><span class="in">`Declock`</span>: a timekeeping system that uses fractional days instead of hours, minutes, and seconds</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="ot">[^3]: </span><span class="in">`doty`</span>: day-of-the-year; an alternative to months, weeks, hours, minutes, and seconds</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a><span class="ot">[^4]: </span><span class="in">`doty`</span> date: the integer part of the <span class="in">`doty`</span>; an alternate to calendar dates and week dates</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a><span class="ot">[^5]: </span><span class="in">`doty`</span> time: the fractional part of the <span class="in">`doty`</span>; an alternate to hours, minutes and seconds</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>The top two bars in @fig-bar-doty (旬 and 日) show the two components of the <span class="in">`Decalendar`</span> date (\${setStyle(dotyDate, d3.schemePaired<span class="sc">\[</span>1<span class="sc">\]</span>)}): the <span class="in">`dek`</span><span class="ot">[^6]</span> (\${styledDek}) and the day-of-the-<span class="in">`dek`</span><span class="ot">[^7]</span> (\${styledDotd}). A <span class="in">`dek`</span> is a group of 10 days that fulfills the role of months and weeks in <span class="in">`Decalendar`</span>. Therefore, the <span class="in">`dek`</span> and the day-of-the-<span class="in">`dek`</span> (<span class="in">`dotd`</span>) in <span class="in">`Decalendar`</span> dates are analogous to the month and day-of-the-month (<span class="in">`dotm`</span>) in <span class="co">[</span><span class="ot">calendar dates</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Calendar_dates)</span> (<span class="in">`mm-dd`</span>) and the week and day-of-the-week (<span class="in">`dotw`</span>) in <span class="co">[</span><span class="ot">week dates</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Week_dates)</span> (<span class="in">`Www-d`</span>).</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a><span class="ot">[^6]: </span><span class="in">`dek`</span>: a group of 10 days; the first two digits of the <span class="in">`Decalendar`</span> date; an alternate to month and weeks</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a><span class="ot">[^7]: </span><span class="in">`dotd`</span>: one of the 10 days in a <span class="in">`dek`</span>; the last digit of the <span class="in">`Decalendar`</span> date; an alternate to the day-of-the-month and day-of-the-week</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>The bottom three bars in @fig-bar-doty (%, ‰, and ♫) show components of the <span class="in">`Declock`</span> time (\${setStyle(dotyTime, d3.schemePaired<span class="sc">\[</span>2<span class="sc">\]</span>)}): <span class="in">`cents`</span><span class="ot">[^8]</span> (\${styledCent}), <span class="in">`mils`</span><span class="ot">[^9]</span> (\${styledMil}), and <span class="in">`beats`</span><span class="ot">[^10]</span> (\${styledBeat}). A <span class="in">`cent`</span> is 1% of the day, which is a little less than a quarter hour. A <span class="in">`mil`</span> (<span class="in">`‰`</span>) is a tenth of a <span class="in">`cent`</span>, which is close to a minute and a half. A <span class="in">`beat`</span> is 1% of a <span class="in">`mil`</span>, which is almost as long as a second, and can be thought of as a heart❤️beat or musical🎵<span class="co">[</span><span class="ot">beat</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Beat_(music)#:~:text=the%20beat%20is%20the%20basic%20unit%20of%20time) with a constant <span class="co">[</span><span class="ot">rate</span><span class="co">](https://en.wikipedia.org/wiki/Heart_rate#:~:text=The%20American%20Heart%20Association%20states%20the%20normal%20resting%20adult%20human%20heart%20rate%20is%2060%2D100%20bpm.)</span> or <span class="co">[</span><span class="ot">tempo</span><span class="co">](https://en.wikipedia.org/wiki/Tempo#Basic_tempo_markings:~:text=Adagietto%20%E2%80%93%20slower%20than,56%E2%80%93108%C2%A0bpm)</span> of 69.4̅ beats per minute. In addition to displaying time on clocks🕰️and⌚️watches, <span class="in">`beats`</span> can be used to measure durations, such as the time since this webpage was loaded: \${styledTickTime}.</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a><span class="ot">[^8]: </span><span class="in">`cent`</span>: a hundredth ($10^{-2}$) of a day; the first 2 digits of the <span class="in">`doty`</span> time; an alternate to quarter hours</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a><span class="ot">[^9]: </span><span class="in">`mil`</span>: a thousandth ($10^{-3}$) of a day; the first 3 digits of the <span class="in">`doty`</span> time; an alternate to minutes</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a><span class="ot">[^10]: </span><span class="in">`beat`</span>: a hundred thousandth ($10^{-5}$) of a day; the first 5 digits of the <span class="in">`doty`</span> time; an alternate to seconds</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: fig-bar-doty</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-cap: "Doty bar chart"</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-align: "center"</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a><span class="co">//| column: body</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@fheyen/barchart-clock</span></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> W <span class="op">=</span> width <span class="op">&gt;</span> <span class="dv">1250</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">2</span> <span class="op">/</span> <span class="dv">3</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">1150</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">3</span> <span class="op">/</span> <span class="dv">4</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">1050</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">4</span> <span class="op">/</span> <span class="dv">5</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">950</span> <span class="op">?</span> width <span class="op">*</span> <span class="dv">5</span> <span class="op">/</span> <span class="dv">6</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">850</span> <span class="op">?</span> width <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">750</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.02</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">650</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.06</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">550</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.1</span> <span class="op">:</span> width <span class="op">&gt;</span> <span class="dv">450</span> <span class="op">?</span> width <span class="op">*</span> <span class="fl">1.14</span> <span class="op">:</span> width <span class="op">*</span> <span class="fl">1.18</span><span class="op">;</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> H <span class="op">=</span> <span class="dv">156</span><span class="op">;</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barX <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> firstBarY <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> W)</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> W<span class="op">,</span> H])<span class="op">;</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xRange <span class="op">=</span> [<span class="dv">0</span><span class="op">,</span> W <span class="op">-</span> <span class="dv">100</span>]<span class="op">;</span></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleM <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>])</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleCandB <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>])</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scaleDek <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">37</span>])</span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(xRange)<span class="op">;</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Background bars to show where 100% lies</span></span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.background'</span>)</span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="st">'dek'</span><span class="op">,</span> <span class="st">'dotd'</span><span class="op">,</span> <span class="st">'cents'</span><span class="op">,</span> <span class="st">"mils"</span><span class="op">,</span> <span class="st">'beats'</span>])</span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'background timeBar'</span>)</span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> W<span class="op">-</span><span class="dv">100</span>)</span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY)</span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Dek/Dotd</span></span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDek</span>(<span class="bu">Number</span>(dotyDek)<span class="op">+</span><span class="bu">Number</span>(dotyDotd)<span class="op">/</span><span class="dv">10</span><span class="op">+</span><span class="bu">Number</span>(barCents)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleDek</span>(dotyDek))</span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(<span class="bu">Number</span>(dotyDotd)<span class="op">+</span><span class="bu">Number</span>(barCents)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">30</span>)</span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(dotyDotd))</span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickDek'</span>)</span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">37</span>))</span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickDek'</span>)</span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDek</span>(d)<span class="op">+</span>barX)</span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY)</span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">2</span> <span class="op">:</span> <span class="dv">3</span>)<span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">6</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickDotd'</span>)</span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickDotd'</span>)</span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">49</span>)</span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel'</span>)</span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">4</span><span class="op">:</span> <span class="dv">6</span><span class="op">,</span> width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">37</span><span class="op">:</span> <span class="dv">35</span><span class="op">,</span> width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">2</span><span class="op">:</span> <span class="dv">3</span>))</span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel'</span>)</span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleDek</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb35-161"><a href="#cb35-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">22</span>)</span>
<span id="cb35-162"><a href="#cb35-162" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cents/Mils</span></span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(<span class="bu">Number</span>(barCents)<span class="op">+</span><span class="bu">Number</span>(barMils)<span class="op">/</span><span class="dv">10</span><span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(barCents))</span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(<span class="bu">Number</span>(barMils)<span class="op">+</span><span class="bu">Number</span>(barBeats)<span class="op">/</span><span class="dv">100</span><span class="op">+</span><span class="bu">Number</span>(barMb)<span class="op">/</span><span class="dv">100000</span>))</span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleM</span>(barMils))</span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cent ticks</span></span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC'</span>)</span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC'</span>)</span>
<span id="cb35-190"><a href="#cb35-190" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb35-191"><a href="#cb35-191" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">60</span>)</span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickC1'</span>)</span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickC1'</span>)</span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> firstBarY<span class="op">+</span><span class="dv">77</span><span class="op">:</span>firstBarY<span class="op">+</span><span class="dv">80</span>)</span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">8</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mil ticks</span></span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM'</span>)</span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM'</span>)</span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">90</span>)</span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="dv">6</span>)</span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickM1'</span>)</span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickM1'</span>)</span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX)</span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="fl">92.5</span>)</span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> <span class="fl">2.5</span>)</span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel1'</span>)</span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel1'</span>)</span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">47</span>)</span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickLabel2'</span>)</span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">10</span>))</span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickLabel2'</span>)</span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d)<span class="op">+</span>barX<span class="op">+.</span><span class="dv">5</span>)</span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">112</span>)</span>
<span id="cb35-233"><a href="#cb35-233" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb35-234"><a href="#cb35-234" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beats</span></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBar'</span>)</span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(<span class="bu">Number</span>(barBeats)<span class="op">+</span><span class="bu">Number</span>(barMb)<span class="op">/</span><span class="dv">1000</span>))</span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeBarFull'</span>)</span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">scaleCandB</span>(barBeats))</span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Beat ticks</span></span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.tickB'</span>)</span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(d3<span class="op">.</span><span class="fu">range</span>(width <span class="op">&gt;</span> <span class="dv">500</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">100</span>))</span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'tickB'</span>)</span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> d<span class="kw">=&gt;</span><span class="fu">scaleM</span>(d<span class="op">/</span><span class="dv">10</span>)<span class="op">+</span>barX)</span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> firstBarY<span class="op">+</span><span class="dv">120</span>)</span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> d<span class="kw">=&gt;</span>d<span class="op">%</span><span class="dv">2</span><span class="op">===</span><span class="dv">0</span><span class="op">?</span> <span class="dv">9</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Labels</span></span>
<span id="cb35-255"><a href="#cb35-255" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'.timeLabel'</span>)</span>
<span id="cb35-256"><a href="#cb35-256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([<span class="vs">`</span><span class="sc">${</span>dotyDek<span class="sc">}</span><span class="vs">旬`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>dotyDotd<span class="sc">}</span><span class="vs">日`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barCents<span class="sc">}</span><span class="vs">%`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barMils<span class="sc">}</span><span class="vs">‰`</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>barBeats<span class="sc">}</span><span class="vs">♫`</span>])</span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">'text'</span>)</span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'class'</span><span class="op">,</span> <span class="st">'timeLabel'</span>)</span>
<span id="cb35-260"><a href="#cb35-260" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'x'</span><span class="op">,</span> barX<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> (d<span class="op">,</span>i)<span class="kw">=&gt;</span>i<span class="op">*</span><span class="dv">30</span><span class="op">+</span>firstBarY<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d<span class="kw">=&gt;</span>d)</span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a><span class="vs">  .tickLabel, .tickLabel1, .tickLabel2, .timeLabel {</span></span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #000;</span></span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-family: sans-serif;</span></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 20px;</span></span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a><span class="vs">    text-anchor: middle;</span></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeLabel {</span></span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a><span class="vs">    text-anchor: start;</span></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBar, .timeBarFull {</span></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a><span class="vs">    x: 1px;</span></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a><span class="vs">    height: 25px;</span></span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a><span class="vs">    rx: 5px;</span></span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a><span class="vs">    stroke: #aaa;</span></span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBar {</span></span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #e8e8e8;</span></span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a><span class="vs">  .timeBarFull {</span></span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #ccffff;</span></span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a><span class="vs">  .background {</span></span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: white;</span></span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a><span class="vs">  .tickDek, .tickDotd, .tickDotd1, .tickC, .tickC1, .tickM, .tickM1, .tickB {</span></span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a><span class="vs">    stroke: none;</span></span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a><span class="vs">    fill: #666;</span></span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a><span class="vs">    width: 1px;</span></span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb35-301"><a href="#cb35-301" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span></span>
<span id="cb35-302"><a href="#cb35-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-304"><a href="#cb35-304" aria-hidden="true" tabindex="-1"></a>As an alternative to <span class="in">`doty`</span> dates, <span class="in">`Decalendar`</span> can express dates in fractional years, which are similar to the <span class="co">[</span><span class="ot">fractional days</span><span class="co">](https://en.wikipedia.org/wiki/Decimal_time#Fractional_days)</span> used in <span class="in">`doty`</span> times. Fractional year dates<span class="ot">[^11]</span> can be combined with years into one number and are useful for marking periods of 73 days in the <span class="in">`Decalendar`</span> year. Every 73 days, the <span class="in">`Decalendar`</span> fractional year date increases by .2 (⅕). The current <span class="in">`Decalendar`</span> fractional year date is \${setStyle(yearDate.toString().slice(4), d3.schemePaired<span class="sc">\[</span>10<span class="sc">\]</span>)}.</span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a><span class="ot">[^11]: </span>fractional year date: a year and the proportion of that year that has passed; an alternative to <span class="in">`Decalendar`</span> dates</span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a>Now it's your turn! Move the sliders🎚️in @exm-intro-doty to adjust the <span class="in">`doty`</span>, fractional year, month, and <span class="in">`dotm`</span> values and see the corresponding 1) Northern Hemisphere season, 2) Southern Hemisphere season, and 3) Zodiac sign in @lst-intro-doty. Try selecting a special date, like your birthday🎂! You can also press the Play▶️button and then sit back and watch the sliders cycle🔄back and forth from the start to the end of the <span class="in">`Decalendar`</span> year. The sliders cycle through an entire year in 36.5 <span class="in">`beats`</span>, a million times faster🏎️than the actual speed of time!</span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-doty}</span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a>::: g-col-7</span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a>viewof inputDoty <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">365</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">306</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"doty"</span>})<span class="op">;</span></span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a>viewof year <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="op">.</span><span class="dv">999</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="op">.</span><span class="bn">001</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"year"</span>})<span class="op">,</span></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> (x <span class="kw">=&gt;</span> x <span class="op">/</span> <span class="dv">365</span>)<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> (x <span class="kw">=&gt;</span> x <span class="op">*</span> <span class="dv">365</span>)}</span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-325"><a href="#cb35-325" aria-hidden="true" tabindex="-1"></a>viewof monthInput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb35-326"><a href="#cb35-326" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"month"</span>})<span class="op">,</span></span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2month<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> month2doty}</span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a>viewof dotmInput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">31</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"dotm"</span>})<span class="op">,</span></span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">bind</span><span class="op">:</span> viewof inputDoty<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2dotm<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> (x <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(( <span class="dv">153</span> <span class="op">*</span> (</span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a>        viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">&gt;</span> <span class="dv">2</span></span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">-</span> <span class="dv">3</span></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> viewof monthInput<span class="op">.</span><span class="at">value</span> <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a>    ) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> x <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a>))})<span class="op">;</span></span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a>::: g-col-5</span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>\${inputDotySeason<span class="sc">\[</span>0<span class="sc">\]</span>}</span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>\${inputDotySeason<span class="sc">\[</span>1<span class="sc">\]</span>}</span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>\${inputDotyZodiac}</span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a>viewof scrubberDoty <span class="op">=</span> <span class="fu">Scrubber</span>(numbers<span class="op">,</span> {<span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">alternate</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">delay</span><span class="op">:</span> <span class="fl">86.4</span><span class="op">,</span> <span class="dt">loopDelay</span><span class="op">:</span> <span class="dv">864</span>})</span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a><span class="in">``` {#lst-intro-doty lst-cap="Date to season conversion"}</span></span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-360"><a href="#cb35-360" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-361"><a href="#cb35-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `Doty` Observable code {#sec-ojs-code-doty .appendix}</span></span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Functions {.appendix}</span></span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@observablehq/synchronized-inputs</span></span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">set</span>(input<span class="op">,</span> value) {</span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mbostock/scrubber</span></span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">Scrubber</span>(values<span class="op">,</span> {</span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a>  format <span class="op">=</span> value <span class="kw">=&gt;</span> value<span class="op">,</span></span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a>  initial <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a>  direction <span class="op">=</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a>  delay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a>  autoplay <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a>  loop <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb35-382"><a href="#cb35-382" aria-hidden="true" tabindex="-1"></a>  loopDelay <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb35-383"><a href="#cb35-383" aria-hidden="true" tabindex="-1"></a>  alternate <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a>  values <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(values)<span class="op">;</span></span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 33px; align-items: center;"&gt;</span></span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;button name=b type=button style="background-color:#002ead;color:#fff;border-radius:10px;margin-left:.4em;width: 5em;"&gt;&lt;/button&gt;</span></span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;label style="display: flex; align-items: center;"&gt;</span></span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;input name=i type=range min=0 max=</span><span class="sc">${</span>values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="sc">}</span><span class="vs"> value=</span><span class="sc">${</span>initial<span class="sc">}</span><span class="vs"> step=1 style="display: none;"&gt;</span></span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;output name=o style="display: none;"&gt;&lt;/output&gt;</span></span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/label&gt;</span></span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/form&gt;`</span><span class="op">;</span></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">start</span>() {</span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Pause"</span><span class="op">;</span></span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> interval <span class="op">=</span> <span class="pp">setInterval</span>(tick<span class="op">,</span> delay)<span class="op">;</span></span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">stop</span>() {</span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Play"</span><span class="op">;</span></span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (timer <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearTimeout</span>(timer)<span class="op">,</span> timer <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">running</span>() {</span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> frame <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> timer <span class="op">!==</span> <span class="kw">null</span> <span class="op">||</span> interval <span class="op">!==</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-409"><a href="#cb35-409" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-410"><a href="#cb35-410" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tick</span>() {</span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> (direction <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span> direction <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="kw">NaN</span>)) {</span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>loop) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (alternate) direction <span class="op">=</span> <span class="op">-</span>direction<span class="op">;</span></span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (loopDelay <span class="op">!==</span> <span class="kw">null</span>) {</span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (frame <span class="op">!==</span> <span class="kw">null</span>) <span class="fu">cancelAnimationFrame</span>(frame)<span class="op">,</span> frame <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (interval <span class="op">!==</span> <span class="kw">null</span>) <span class="pp">clearInterval</span>(interval)<span class="op">,</span> interval <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a>        timer <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> (<span class="fu">step</span>()<span class="op">,</span> <span class="fu">start</span>())<span class="op">,</span> loopDelay)<span class="op">;</span></span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (delay <span class="op">===</span> <span class="kw">null</span>) frame <span class="op">=</span> <span class="fu">requestAnimationFrame</span>(tick)<span class="op">;</span></span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step</span>()<span class="op">;</span></span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">step</span>() {</span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction <span class="op">+</span> values<span class="op">.</span><span class="at">length</span>) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">oninput</span> <span class="op">=</span> <span class="bu">event</span> <span class="kw">=&gt;</span> {</span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">event</span> <span class="op">&amp;&amp;</span> <span class="bu">event</span><span class="op">.</span><span class="at">isTrusted</span> <span class="op">&amp;&amp;</span> <span class="fu">running</span>()) <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">value</span> <span class="op">=</span> values[form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span>]<span class="op">;</span></span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">o</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="fu">format</span>(form<span class="op">.</span><span class="at">value</span><span class="op">,</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span><span class="op">,</span> values)<span class="op">;</span></span>
<span id="cb35-432"><a href="#cb35-432" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb35-433"><a href="#cb35-433" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">b</span><span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">running</span>()) <span class="cf">return</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a>    direction <span class="op">=</span> alternate <span class="op">&amp;&amp;</span> form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">===</span> values<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">=</span> (form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="at">valueAsNumber</span> <span class="op">+</span> direction) <span class="op">%</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a>    form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a>    <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a>  form<span class="op">.</span><span class="at">i</span><span class="op">.</span><span class="fu">oninput</span>()<span class="op">;</span></span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (autoplay) <span class="fu">start</span>()<span class="op">;</span></span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">disposal</span>(form)<span class="op">.</span><span class="fu">then</span>(stop)<span class="op">;</span></span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form<span class="op">;</span></span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@juang1744/transform-input/1</span></span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a>transformInput <span class="op">=</span> <span class="kw">function</span>(target<span class="op">,</span> {<span class="dt">bind</span><span class="op">:</span> source<span class="op">,</span> transform <span class="op">=</span> identity<span class="op">,</span> involutory <span class="op">=</span> <span class="kw">false</span><span class="op">,</span> invert <span class="op">=</span> involutory <span class="op">?</span> transform <span class="op">:</span> <span class="fu">inverse</span>(transform)} <span class="op">=</span> {}){</span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (source <span class="op">===</span> <span class="kw">undefined</span>) {</span>
<span id="cb35-449"><a href="#cb35-449" aria-hidden="true" tabindex="-1"></a>    source <span class="op">=</span> target<span class="op">;</span></span>
<span id="cb35-450"><a href="#cb35-450" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>source<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">sourceInputHandler</span>() {</span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTransform</span>(target)<span class="op">.</span><span class="fu">to</span>(<span class="fu">transform</span>(source<span class="op">.</span><span class="at">value</span>))<span class="op">.</span><span class="fu">andDispatchEvent</span>()<span class="op">;</span></span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">targetInputHandler</span>() {</span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">setTransform</span>(source)<span class="op">.</span><span class="fu">to</span>(<span class="fu">invert</span>(target<span class="op">.</span><span class="at">value</span>))<span class="op">.</span><span class="fu">andDispatchEvent</span>()<span class="op">;</span></span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a>  source<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a>  target<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a>    source<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> sourceInputHandler)<span class="op">;</span></span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a>    target<span class="op">.</span><span class="fu">removeEventListener</span>(<span class="st">"input"</span><span class="op">,</span> targetInputHandler)<span class="op">;</span></span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-469"><a href="#cb35-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sourceInputHandler</span>()<span class="op">;</span></span>
<span id="cb35-470"><a href="#cb35-470" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> target<span class="op">;</span></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a>setTransform <span class="op">=</span> (input) <span class="kw">=&gt;</span> ({<span class="dt">to</span><span class="op">:</span> (value) <span class="kw">=&gt;</span> (input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">,</span> {<span class="dt">andDispatchEvent</span><span class="op">:</span> (<span class="bu">event</span> <span class="op">=</span> <span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span>)) <span class="kw">=&gt;</span> input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="bu">event</span>)})})<span class="op">;</span></span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">inverse</span>(f) {</span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span> (f) {</span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="dt">identity</span><span class="op">:</span>  <span class="cf">return</span> identity<span class="op">;</span></span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span><span class="op">:</span> <span class="cf">return</span> square<span class="op">;</span></span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span><span class="op">:</span>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span><span class="op">;</span></span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span><span class="op">:</span>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">log</span><span class="op">;</span></span>
<span id="cb35-479"><a href="#cb35-479" aria-hidden="true" tabindex="-1"></a>    <span class="cf">default</span><span class="op">:</span>        <span class="cf">return</span> (x <span class="kw">=&gt;</span> <span class="fu">solve</span>(f<span class="op">,</span> x<span class="op">,</span> x))<span class="op">;</span></span>
<span id="cb35-480"><a href="#cb35-480" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">solve</span>(f<span class="op">,</span> y<span class="op">,</span> x <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dx <span class="op">=</span> <span class="fl">1e-6</span><span class="op">;</span></span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> steps <span class="op">=</span> <span class="dv">100</span><span class="op">,</span> deltax<span class="op">,</span> fx<span class="op">,</span> dfx<span class="op">;</span></span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a>    <span class="cf">do</span> {</span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a>      fx <span class="op">=</span> <span class="fu">f</span>(x)</span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a>      dfx <span class="op">=</span> (<span class="fu">f</span>(x <span class="op">+</span> dx) <span class="op">-</span> fx) <span class="op">||</span> dx<span class="op">;</span></span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a>      deltax <span class="op">=</span> dx <span class="op">*</span> (fx <span class="op">-</span> y)<span class="op">/</span>dfx</span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a>      x <span class="op">-=</span> deltax<span class="op">;</span></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">while</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(deltax) <span class="op">&gt;</span> dx <span class="op">&amp;&amp;</span> <span class="op">--</span>steps <span class="op">&gt;</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> steps <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="kw">NaN</span> <span class="op">:</span> x<span class="op">;</span></span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-493"><a href="#cb35-493" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">square</span>(x) {</span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> x<span class="op">;</span></span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">identity</span>(x) {</span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@observablehq/text-color-annotations-in-markdown#textcolor</span></span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">setStyle</span>(content<span class="op">,</span> style <span class="op">=</span> {}) {</span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">yiq</span>(color) {</span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> {r<span class="op">,</span> g<span class="op">,</span> b} <span class="op">=</span> d3<span class="op">.</span><span class="fu">rgb</span>(color)<span class="op">;</span></span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (r <span class="op">*</span> <span class="dv">299</span> <span class="op">+</span> g <span class="op">*</span> <span class="dv">587</span> <span class="op">+</span> b <span class="op">*</span> <span class="dv">114</span>) <span class="op">/</span> <span class="dv">1000</span> <span class="op">/</span> <span class="dv">255</span><span class="op">;</span> <span class="co">// returns values between 0 and 1</span></span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> {</span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb35-508"><a href="#cb35-508" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="fu">yiq</span>(background) <span class="op">&gt;=</span> <span class="fl">0.6</span> <span class="op">?</span> <span class="st">"#111"</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a>    padding <span class="op">=</span> <span class="st">"0 1px"</span><span class="op">,</span></span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a>    borderRadius <span class="op">=</span> <span class="st">"4px"</span><span class="op">,</span></span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a>    fontWeight <span class="op">=</span> <span class="dv">900</span><span class="op">,</span></span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a>    fontSize <span class="op">=</span> <span class="st">"1em"</span><span class="op">,</span></span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a>  } <span class="op">=</span> <span class="kw">typeof</span> style <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> {<span class="dt">background</span><span class="op">:</span> style} <span class="op">:</span> style<span class="op">;</span></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span style=</span><span class="sc">${</span>{</span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a>    background<span class="op">,</span></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb35-518"><a href="#cb35-518" aria-hidden="true" tabindex="-1"></a>    padding<span class="op">,</span></span>
<span id="cb35-519"><a href="#cb35-519" aria-hidden="true" tabindex="-1"></a>    borderRadius<span class="op">,</span></span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a>    fontWeight<span class="op">,</span></span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>rest</span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a>  }<span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>content<span class="sc">}</span><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dote2doty</span>(days <span class="op">=</span> <span class="dv">719468</span>) {</span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span>) <span class="op">/</span> <span class="dv">146097</span>)<span class="op">,</span></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a>        dotc <span class="op">=</span> days <span class="op">-</span> era <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a>        yotc <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dotc <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">1460</span>) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">36524</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(dotc <span class="op">/</span> <span class="dv">146096</span>)) <span class="op">/</span> <span class="dv">365</span>)<span class="op">;</span></span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [yotc <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">,</span> dotc <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">100</span>) <span class="op">-</span> yotc <span class="op">*</span> <span class="dv">365</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yotc <span class="op">/</span> <span class="dv">4</span>)]<span class="op">;</span></span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2doty</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">dote2doty</span>(ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span>)</span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a><span class="co">// https://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2dote</span>(year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cycle <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((year <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> year <span class="op">:</span> year <span class="op">-</span> <span class="dv">399</span>) <span class="op">/</span> <span class="dv">400</span>)<span class="op">,</span></span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a>    yote <span class="op">=</span> year <span class="op">-</span> cycle <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb35-538"><a href="#cb35-538" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle <span class="op">*</span> <span class="dv">146097</span> <span class="op">+</span> yote <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">4</span>) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yote <span class="op">/</span> <span class="dv">100</span>) <span class="op">+</span> doty <span class="op">-</span> zone</span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2deco</span>(yearDoty <span class="op">=</span> [<span class="dv">1969</span><span class="op">,</span> <span class="dv">306</span>]<span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yd <span class="op">=</span> <span class="fu">dote2doty</span>(<span class="fu">doty2dote</span>(yearDoty[<span class="dv">0</span>]<span class="op">,</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(yearDoty[<span class="dv">1</span>])))<span class="op">;</span></span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>yd[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">+</span><span class="sc">${</span>(yd[<span class="dv">1</span>])<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}${</span></span>
<span id="cb35-543"><a href="#cb35-543" aria-hidden="true" tabindex="-1"></a>        yearDoty[<span class="dv">1</span>]<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">includes</span>(<span class="st">"."</span>) <span class="op">?</span> <span class="st">"."</span> <span class="op">+</span> (</span>
<span id="cb35-544"><a href="#cb35-544" aria-hidden="true" tabindex="-1"></a>            (yearDoty[<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">?</span> (yearDoty[<span class="dv">1</span>] <span class="op">-</span> zone)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)<span class="op">.</span><span class="fu">pop</span>()</span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> [<span class="op">...</span>(yearDoty[<span class="dv">1</span>] <span class="op">-</span> zone)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)<span class="op">.</span><span class="fu">pop</span>()]<span class="op">.</span><span class="fu">map</span>(</span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a>                (e<span class="op">,</span> i<span class="op">,</span> a) <span class="kw">=&gt;</span> (i <span class="op">+</span> <span class="dv">1</span> <span class="op">===</span> a<span class="op">.</span><span class="at">length</span>) <span class="op">?</span> <span class="dv">10</span> <span class="op">-</span> e <span class="op">:</span> <span class="dv">9</span> <span class="op">-</span> e</span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a>            )<span class="op">.</span><span class="fu">join</span>(<span class="st">""</span>)</span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">:</span> <span class="st">""</span></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a>    <span class="sc">}</span><span class="vs">`</span></span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">unix2deco</span>(ms <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-552"><a href="#cb35-552" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2deco</span>(<span class="fu">unix2doty</span>(ms))<span class="op">;</span></span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#days_from_civil</span></span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">greg2doty</span>(month <span class="op">=</span> <span class="dv">1</span><span class="op">,</span> day <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span> <span class="op">+</span> day <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a><span class="co">// http://howardhinnant.github.io/date_algorithms.html#civil_from_days</span></span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2greg</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(m <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> m <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> m <span class="op">-</span> <span class="dv">9</span>)<span class="op">,</span> doty <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">153</span> <span class="op">*</span> m <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2toty</span>(doty <span class="op">=</span> <span class="dv">306</span>) {</span>
<span id="cb35-565"><a href="#cb35-565" aria-hidden="true" tabindex="-1"></a>    doty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty)</span>
<span id="cb35-566"><a href="#cb35-566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">205</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">295</span>) <span class="op">?</span> [<span class="st">"Fall🍁"</span><span class="op">,</span> <span class="st">"Spring🌼"</span>] <span class="op">:</span></span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">110</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">205</span>) <span class="op">?</span> [<span class="st">"Summer☀️"</span><span class="op">,</span> <span class="st">"Winter❄️"</span>] <span class="op">:</span></span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">20</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">110</span>) <span class="op">?</span> [<span class="st">"Spring🌼"</span><span class="op">,</span> <span class="st">"Fall🍁"</span>] <span class="op">:</span></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">0</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">20</span>) <span class="op">||</span> (<span class="dv">295</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;=</span> <span class="dv">365</span>)</span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> [<span class="st">"Winter❄️"</span><span class="op">,</span> <span class="st">"Summer☀️"</span>] <span class="op">:</span> <span class="st">"Unknown"</span></span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2zodi</span>(doty <span class="op">=</span> <span class="dv">306</span>) {</span>
<span id="cb35-573"><a href="#cb35-573" aria-hidden="true" tabindex="-1"></a>    doty <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(doty)</span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">20</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">50</span>) <span class="op">?</span> <span class="st">"Aries♈️"</span> <span class="op">:</span></span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">50</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">81</span>) <span class="op">?</span> <span class="st">"Taurus♉️"</span> <span class="op">:</span></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">81</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">112</span>) <span class="op">?</span> <span class="st">"Gemini♊️"</span> <span class="op">:</span></span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">112</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">144</span>) <span class="op">?</span> <span class="st">"Cancer♋️"</span> <span class="op">:</span></span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">144</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">175</span>) <span class="op">?</span> <span class="st">"Leo♌️"</span> <span class="op">:</span></span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">175</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">206</span>) <span class="op">?</span> <span class="st">"Virgo♍️"</span> <span class="op">:</span></span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">206</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">236</span>) <span class="op">?</span> <span class="st">"Libra♎️"</span> <span class="op">:</span></span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">236</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">266</span>) <span class="op">?</span> <span class="st">"Scorpio♏️"</span> <span class="op">:</span></span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">266</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">296</span>) <span class="op">?</span> <span class="st">"Sagittarius♐️"</span> <span class="op">:</span></span>
<span id="cb35-583"><a href="#cb35-583" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">296</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">325</span>) <span class="op">?</span> <span class="st">"Capricorn♑️"</span> <span class="op">:</span></span>
<span id="cb35-584"><a href="#cb35-584" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">325</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">355</span>) <span class="op">?</span> <span class="st">"Aquarius♒️"</span> <span class="op">:</span></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a>     (<span class="dv">355</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;=</span> <span class="dv">365</span>) <span class="op">||</span> (<span class="dv">0</span> <span class="op">&lt;=</span> doty <span class="op">&amp;&amp;</span> doty <span class="op">&lt;</span> <span class="dv">20</span>)</span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a>     <span class="op">?</span> <span class="st">"Pisces♓️"</span> <span class="op">:</span> <span class="st">"Unknown"</span></span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2month</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(m <span class="op">&lt;</span> <span class="dv">10</span> <span class="op">?</span> m <span class="op">+</span> <span class="dv">3</span> <span class="op">:</span> m <span class="op">-</span> <span class="dv">9</span>)<span class="op">;</span></span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">month2doty</span>(month <span class="op">=</span> <span class="dv">1</span>) {</span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(</span>
<span id="cb35-594"><a href="#cb35-594" aria-hidden="true" tabindex="-1"></a>        (<span class="dv">153</span> <span class="op">*</span> (month <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> month <span class="op">-</span> <span class="dv">3</span> <span class="op">:</span> month <span class="op">+</span> <span class="dv">9</span>) <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span></span>
<span id="cb35-595"><a href="#cb35-595" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">doty2dotm</span>(doty <span class="op">=</span> <span class="dv">0</span>) {</span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> m <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">5</span> <span class="op">*</span> doty <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">153</span>)<span class="op">;</span></span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> doty <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((<span class="dv">153</span> <span class="op">*</span> m <span class="op">+</span> <span class="dv">2</span>) <span class="op">/</span> <span class="dv">5</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-601"><a href="#cb35-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-602"><a href="#cb35-602" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Variables {.appendix}</span></span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-606"><a href="#cb35-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: all</span></span>
<span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a>width</span>
<span id="cb35-609"><a href="#cb35-609" aria-hidden="true" tabindex="-1"></a>unix <span class="op">=</span> {</span>
<span id="cb35-610"><a href="#cb35-610" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="kw">true</span>) {</span>
<span id="cb35-611"><a href="#cb35-611" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> <span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()<span class="op">;</span></span>
<span id="cb35-612"><a href="#cb35-612" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-613"><a href="#cb35-613" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-614"><a href="#cb35-614" aria-hidden="true" tabindex="-1"></a>tick <span class="op">=</span> {</span>
<span id="cb35-615"><a href="#cb35-615" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-616"><a href="#cb35-616" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb35-617"><a href="#cb35-617" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> Promises<span class="op">.</span><span class="fu">tick</span>(<span class="dv">864</span><span class="op">,</span> <span class="op">++</span>i)<span class="op">;</span></span>
<span id="cb35-618"><a href="#cb35-618" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-619"><a href="#cb35-619" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-620"><a href="#cb35-620" aria-hidden="true" tabindex="-1"></a>tickTime <span class="op">=</span> tick <span class="op">%</span> <span class="fl">1e5</span></span>
<span id="cb35-621"><a href="#cb35-621" aria-hidden="true" tabindex="-1"></a>barTime <span class="op">=</span> <span class="fu">unix2dote</span>(unix)<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">split</span>(<span class="st">"."</span>)[<span class="dv">1</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb35-622"><a href="#cb35-622" aria-hidden="true" tabindex="-1"></a>barCents <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb35-623"><a href="#cb35-623" aria-hidden="true" tabindex="-1"></a>barMils <span class="op">=</span> barTime[<span class="dv">2</span>]</span>
<span id="cb35-624"><a href="#cb35-624" aria-hidden="true" tabindex="-1"></a>barBeats <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb35-625"><a href="#cb35-625" aria-hidden="true" tabindex="-1"></a>barMb <span class="op">=</span> barTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span>)</span>
<span id="cb35-626"><a href="#cb35-626" aria-hidden="true" tabindex="-1"></a>deco <span class="op">=</span> <span class="fu">unix2deco</span>(unix)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">14</span>)</span>
<span id="cb35-627"><a href="#cb35-627" aria-hidden="true" tabindex="-1"></a>doty <span class="op">=</span> deco<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span>)</span>
<span id="cb35-628"><a href="#cb35-628" aria-hidden="true" tabindex="-1"></a>dotyDate <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>)</span>
<span id="cb35-629"><a href="#cb35-629" aria-hidden="true" tabindex="-1"></a>dotyTime <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">4</span>)</span>
<span id="cb35-630"><a href="#cb35-630" aria-hidden="true" tabindex="-1"></a>dotyDek <span class="op">=</span> doty<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb35-631"><a href="#cb35-631" aria-hidden="true" tabindex="-1"></a>dotyDotd <span class="op">=</span> doty[<span class="dv">2</span>]</span>
<span id="cb35-632"><a href="#cb35-632" aria-hidden="true" tabindex="-1"></a>iso <span class="op">=</span> {</span>
<span id="cb35-633"><a href="#cb35-633" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="kw">true</span>) {</span>
<span id="cb35-634"><a href="#cb35-634" aria-hidden="true" tabindex="-1"></a>    <span class="kw">yield</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">toISOString</span>()</span>
<span id="cb35-635"><a href="#cb35-635" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-636"><a href="#cb35-636" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-637"><a href="#cb35-637" aria-hidden="true" tabindex="-1"></a>isoDate <span class="op">=</span> iso<span class="op">.</span><span class="fu">slice</span>(<span class="dv">5</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb35-638"><a href="#cb35-638" aria-hidden="true" tabindex="-1"></a>isoTime <span class="op">=</span> iso<span class="op">.</span><span class="fu">slice</span>(<span class="dv">11</span><span class="op">,</span> <span class="dv">19</span>)</span>
<span id="cb35-639"><a href="#cb35-639" aria-hidden="true" tabindex="-1"></a>season <span class="op">=</span> <span class="fu">doty2toty</span>(dotyDate)</span>
<span id="cb35-640"><a href="#cb35-640" aria-hidden="true" tabindex="-1"></a>zodiac <span class="op">=</span> <span class="fu">doty2zodi</span>(dotyDate)</span>
<span id="cb35-641"><a href="#cb35-641" aria-hidden="true" tabindex="-1"></a>inputDotySeason <span class="op">=</span> <span class="fu">doty2toty</span>(inputDoty)</span>
<span id="cb35-642"><a href="#cb35-642" aria-hidden="true" tabindex="-1"></a>inputDotyZodiac <span class="op">=</span> <span class="fu">doty2zodi</span>(inputDoty)</span>
<span id="cb35-643"><a href="#cb35-643" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> <span class="dv">366</span>}<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> i)</span>
<span id="cb35-644"><a href="#cb35-644" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-645"><a href="#cb35-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-648"><a href="#cb35-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-649"><a href="#cb35-649" aria-hidden="true" tabindex="-1"></a>styledYear <span class="op">=</span> <span class="fu">setStyle</span>(deco<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">10</span>])</span>
<span id="cb35-650"><a href="#cb35-650" aria-hidden="true" tabindex="-1"></a>styledDotyDate <span class="op">=</span> <span class="fu">setStyle</span>(dotyDate<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb35-651"><a href="#cb35-651" aria-hidden="true" tabindex="-1"></a>styledDotyTime <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb35-652"><a href="#cb35-652" aria-hidden="true" tabindex="-1"></a>styledDotyDate1 <span class="op">=</span> <span class="fu">setStyle</span>(dotyDate<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">1</span>])</span>
<span id="cb35-653"><a href="#cb35-653" aria-hidden="true" tabindex="-1"></a>styledDotyTime1 <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb35-654"><a href="#cb35-654" aria-hidden="true" tabindex="-1"></a>styledTickTime <span class="op">=</span> <span class="fu">setStyle</span>(tickTime<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">2</span>])</span>
<span id="cb35-655"><a href="#cb35-655" aria-hidden="true" tabindex="-1"></a>styledDek <span class="op">=</span> <span class="fu">setStyle</span>(dotyDek<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">0</span>])</span>
<span id="cb35-656"><a href="#cb35-656" aria-hidden="true" tabindex="-1"></a>styledDotd <span class="op">=</span> <span class="fu">setStyle</span>(dotyDotd<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">9</span>])</span>
<span id="cb35-657"><a href="#cb35-657" aria-hidden="true" tabindex="-1"></a>styledCent <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">7</span>])</span>
<span id="cb35-658"><a href="#cb35-658" aria-hidden="true" tabindex="-1"></a>styledMil <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime[<span class="dv">2</span>]<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">6</span>])</span>
<span id="cb35-659"><a href="#cb35-659" aria-hidden="true" tabindex="-1"></a>styledBeat <span class="op">=</span> <span class="fu">setStyle</span>(dotyTime<span class="op">.</span><span class="fu">slice</span>(<span class="dv">3</span><span class="op">,</span> <span class="dv">5</span>)<span class="op">,</span> d3<span class="op">.</span><span class="at">schemePaired</span>[<span class="dv">11</span>])</span>
<span id="cb35-660"><a href="#cb35-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-661"><a href="#cb35-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-662"><a href="#cb35-662" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Set values {.appendix}</span></span>
<span id="cb35-663"><a href="#cb35-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-666"><a href="#cb35-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-667"><a href="#cb35-667" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-668"><a href="#cb35-668" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof inputDoty<span class="op">,</span> scrubberDoty)</span>
<span id="cb35-669"><a href="#cb35-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-670"><a href="#cb35-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-673"><a href="#cb35-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-674"><a href="#cb35-674" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-675"><a href="#cb35-675" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span>(viewof decoOutput<span class="op">,</span> <span class="vs">`1969+</span><span class="sc">${</span>scrubberDeco<span class="op">.</span><span class="fu">toString</span>()<span class="op">.</span><span class="fu">padStart</span>(<span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb35-676"><a href="#cb35-676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-677"><a href="#cb35-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-678"><a href="#cb35-678" aria-hidden="true" tabindex="-1"></a><span class="fu">## Year {#sec-intro-year}</span></span>
<span id="cb35-679"><a href="#cb35-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-680"><a href="#cb35-680" aria-hidden="true" tabindex="-1"></a><span class="in">`Doty`</span> dates (<span class="in">`day`</span>) and <span class="co">[</span><span class="ot">timestamps</span><span class="co">](https://en.wikipedia.org/wiki/Timestamp#:~:text=A%20timestamp%20is%20a%20sequence%20of%20characters%20or%20encoded%20information%20identifying%20when%20a%20certain%20event%20occurred%2C%20usually%20giving%20date%20and%20time%20of%20day%2C%20sometimes%20accurate%20to%20a%20small%20fraction%20of%20a%20second.)</span> (<span class="in">`day.stamp`</span>) do not include years and thus can be reused from year to year. When a <span class="in">`doty`</span> is combined with a year, it forms a <span class="in">`Decalendar`</span> <span class="in">`ordinal`</span><span class="ot">[^12]</span> (<span class="in">`deco`</span>) and represents a specific date (<span class="in">`year+day`</span>) or time (<span class="in">`year+day.stamp`</span>) in a specific year, instead of a date (<span class="in">`day`</span>) or time (<span class="in">`day.stamp`</span>) that occurs every year or every leap year. Using the <span class="co">[</span><span class="ot">Observable</span><span class="co">](https://observablehq.com/about)</span> <span class="co">[</span><span class="ot">datetime input</span><span class="co">](https://observablehq.com/@observablehq/input-date#cell-111)</span> in @exm-intro-date, you can select a year, month, <span class="in">`dotm`</span>, hour, and minute to see the equivalent 1) <span class="in">`deco`</span> timestamp (<span class="in">`year+day.clock`</span>) and 2) year date (<span class="in">`year.yyy`</span>) in @lst-intro-date. For comparison, the current <span class="in">`deco`</span> timestamp is \${styledYear}+\${styledDotyDate1}.\${styledDotyTime1}.</span>
<span id="cb35-681"><a href="#cb35-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-682"><a href="#cb35-682" aria-hidden="true" tabindex="-1"></a><span class="ot">[^12]: </span><span class="in">`deco`</span>: a date and time format consisting of a year and a <span class="in">`doty`</span>; analogous to ISO 8601 dates</span>
<span id="cb35-683"><a href="#cb35-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-684"><a href="#cb35-684" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-date}</span>
<span id="cb35-685"><a href="#cb35-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-686"><a href="#cb35-686" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-687"><a href="#cb35-687" aria-hidden="true" tabindex="-1"></a>::: g-col-7</span>
<span id="cb35-690"><a href="#cb35-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-691"><a href="#cb35-691" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-692"><a href="#cb35-692" aria-hidden="true" tabindex="-1"></a>viewof inputDatetime <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">datetime</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1970-01-01T00:00"</span>})</span>
<span id="cb35-693"><a href="#cb35-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-694"><a href="#cb35-694" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-695"><a href="#cb35-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-696"><a href="#cb35-696" aria-hidden="true" tabindex="-1"></a>::: g-col-5</span>
<span id="cb35-697"><a href="#cb35-697" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>\${dtYear}+\${dtDotyDate}\${dtDotyTimeDelimiter}\${dtDotyTime}</span>
<span id="cb35-698"><a href="#cb35-698" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>\${styledOutputDatetimeYear}</span>
<span id="cb35-699"><a href="#cb35-699" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-700"><a href="#cb35-700" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-701"><a href="#cb35-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-702"><a href="#cb35-702" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb35-703"><a href="#cb35-703" aria-hidden="true" tabindex="-1"></a><span class="in">``` {#lst-intro-date lst-cap="Date and time conversion" cap-location="margin"}</span></span>
<span id="cb35-704"><a href="#cb35-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-705"><a href="#cb35-705" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-706"><a href="#cb35-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-707"><a href="#cb35-707" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-708"><a href="#cb35-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-709"><a href="#cb35-709" aria-hidden="true" tabindex="-1"></a>In @exm-intro-deco, you can enter numeric year and <span class="in">`doty`</span> values or type in a free-form <span class="in">`deco`</span> to see the resulting 1) <span class="co">[</span><span class="ot">ISO 8601 timestamp</span><span class="co">](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations)</span> (<span class="in">`year-mm-ddThh:mm:ss`</span>) and 2) year date in @lst-intro-deco. @exm-intro-deco also has a Play▶️button in that cycles from <span class="in">`Day`</span> <span class="in">`0`</span> to <span class="in">`Day`</span> <span class="in">`365`</span> of <span class="in">`Year`</span> <span class="in">`1969`</span>. The cycle goes up to <span class="in">`Day`</span> <span class="in">`0`</span> of <span class="in">`Year`</span> <span class="in">`1970`</span>, because <span class="in">`Year`</span> <span class="in">`1969`</span> is a common year and does not have a <span class="in">`Day`</span> <span class="in">`365`</span>.</span>
<span id="cb35-710"><a href="#cb35-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-711"><a href="#cb35-711" aria-hidden="true" tabindex="-1"></a>Interacting with the <span class="co">[</span><span class="ot">number</span><span class="co">](https://observablehq.com/@observablehq/input-range#m)</span> inputs in @exm-intro-deco, standardizes the <span class="in">`deco`</span> in the <span class="co">[</span><span class="ot">text</span><span class="co">](https://observablehq.com/@observablehq/input-text)</span> input to ensure years are integers and <span class="in">`doty`</span> values are positive numbers below 366. Nevertheless, all of the inputs in @exm-intro-deco support negative and fractional year and <span class="in">`doty`</span> values. Negative <span class="in">`doty`</span> values <span class="co">[</span><span class="ot">shift</span><span class="co">](https://en.wikipedia.org/wiki/Shift_operator)</span> dates backward in time from the start of a given year into a previous year. Similarly, negative years shift dates backward starting from <span class="in">`Year`</span> <span class="in">`0`</span>, which is 1 BCE (Before the <span class="co">[</span><span class="ot">Common Era</span><span class="co">](https://en.wikipedia.org/wiki/Common_Era)</span>).</span>
<span id="cb35-712"><a href="#cb35-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-713"><a href="#cb35-713" aria-hidden="true" tabindex="-1"></a>::: {#exm-intro-deco}</span>
<span id="cb35-714"><a href="#cb35-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-715"><a href="#cb35-715" aria-hidden="true" tabindex="-1"></a>::: grid</span>
<span id="cb35-716"><a href="#cb35-716" aria-hidden="true" tabindex="-1"></a>::: g-col-7</span>
<span id="cb35-719"><a href="#cb35-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-720"><a href="#cb35-720" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-721"><a href="#cb35-721" aria-hidden="true" tabindex="-1"></a>viewof yd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb35-722"><a href="#cb35-722" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">number</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1969"</span>})<span class="op">,</span></span>
<span id="cb35-723"><a href="#cb35-723" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">number</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"doty"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"306"</span>})</span>
<span id="cb35-724"><a href="#cb35-724" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb35-725"><a href="#cb35-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-726"><a href="#cb35-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-729"><a href="#cb35-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-730"><a href="#cb35-730" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-731"><a href="#cb35-731" aria-hidden="true" tabindex="-1"></a>viewof decoOutput <span class="op">=</span> <span class="fu">transformInput</span>(</span>
<span id="cb35-732"><a href="#cb35-732" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"deco"</span><span class="op">,</span> <span class="dt">placeholder</span><span class="op">:</span> <span class="st">"year+day.ddd"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"1969+306"</span>})<span class="op">,</span></span>
<span id="cb35-733"><a href="#cb35-733" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">bind</span><span class="op">:</span> viewof yd<span class="op">,</span> <span class="dt">transform</span><span class="op">:</span> doty2deco<span class="op">,</span> <span class="dt">invert</span><span class="op">:</span> deco2doty})<span class="op">;</span></span>
<span id="cb35-734"><a href="#cb35-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-735"><a href="#cb35-735" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-736"><a href="#cb35-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-737"><a href="#cb35-737" aria-hidden="true" tabindex="-1"></a>::: g-col-5</span>
<span id="cb35-738"><a href="#cb35-738" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>\${styledIsocYear}-\${styledIsocMd}T\${styledIsocTime}</span>
<span id="cb35-739"><a href="#cb35-739" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>\${styledOutputDecoYear}</span>
<span id="cb35-740"><a href="#cb35-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-743"><a href="#cb35-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-744"><a href="#cb35-744" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-745"><a href="#cb35-745" aria-hidden="true" tabindex="-1"></a>viewof scrubberDeco <span class="op">=</span> <span class="fu">Scrubber</span>(numbers<span class="op">,</span> {<span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">alternate</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">delay</span><span class="op">:</span> <span class="fl">86.4</span><span class="op">,</span> <span class="dt">loopDelay</span><span class="op">:</span> <span class="dv">864</span>})</span>
<span id="cb35-746"><a href="#cb35-746" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-747"><a href="#cb35-747" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-748"><a href="#cb35-748" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-749"><a href="#cb35-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-750"><a href="#cb35-750" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb35-751"><a href="#cb35-751" aria-hidden="true" tabindex="-1"></a><span class="in">``` {#lst-intro-deco lst-cap="Deco timestamp conversion" cap-location="margin"}</span></span>
<span id="cb35-752"><a href="#cb35-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-753"><a href="#cb35-753" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-754"><a href="#cb35-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-755"><a href="#cb35-755" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-756"><a href="#cb35-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-757"><a href="#cb35-757" aria-hidden="true" tabindex="-1"></a><span class="fu">#### `Deco` Observable code {#sec-ojs-code-deco .appendix}</span></span>
<span id="cb35-758"><a href="#cb35-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-759"><a href="#cb35-759" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Functions {.appendix}</span></span>
<span id="cb35-760"><a href="#cb35-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-761"><a href="#cb35-761" aria-hidden="true" tabindex="-1"></a><span class="in">``` javascript</span></span>
<span id="cb35-762"><a href="#cb35-762" aria-hidden="true" tabindex="-1"></a>copyq<span class="op">:</span></span>
<span id="cb35-763"><a href="#cb35-763" aria-hidden="true" tabindex="-1"></a>function <span class="fu">unix2doty</span><span class="op">(</span>ms <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-764"><a href="#cb35-764" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> days <span class="op">=</span> ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span><span class="op">,</span></span>
<span id="cb35-765"><a href="#cb35-765" aria-hidden="true" tabindex="-1"></a>        dote <span class="op">=</span> days <span class="op">-</span> <span class="op">(</span>era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">((</span>days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span><span class="op">)</span> <span class="op">/</span> <span class="dv">146097</span><span class="op">))</span> <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb35-766"><a href="#cb35-766" aria-hidden="true" tabindex="-1"></a>        year <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">((</span>dote <span class="op">-</span> dote <span class="op">/</span> <span class="dv">1460</span> <span class="op">+</span> dote <span class="op">/</span> <span class="dv">36524</span> <span class="op">-</span> dote <span class="op">/</span> <span class="dv">146096</span><span class="op">)</span> <span class="op">/</span> <span class="dv">365</span><span class="op">)</span> <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb35-767"><a href="#cb35-767" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">[</span>year<span class="op">,</span> days <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">(</span>year <span class="op">*</span> <span class="dv">365</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">4</span> <span class="op">-</span> year <span class="op">/</span> <span class="dv">100</span> <span class="op">+</span> year <span class="op">/</span> <span class="dv">400</span><span class="op">)];</span></span>
<span id="cb35-768"><a href="#cb35-768" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-769"><a href="#cb35-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-770"><a href="#cb35-770" aria-hidden="true" tabindex="-1"></a><span class="dt">const</span> <span class="op">[</span>year<span class="op">,</span> doty<span class="op">]</span> <span class="op">=</span> <span class="fu">unix2doty</span><span class="op">(</span><span class="bu">Date</span><span class="op">.</span><span class="fu">now</span><span class="op">()),</span></span>
<span id="cb35-771"><a href="#cb35-771" aria-hidden="true" tabindex="-1"></a>    datetime <span class="op">=</span> `$<span class="op">{</span>year<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">padStart</span><span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="st">"0"</span><span class="op">)}+</span>$<span class="op">{</span></span>
<span id="cb35-772"><a href="#cb35-772" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>day <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">(</span>doty<span class="op">)).</span><span class="fu">toString</span><span class="op">().</span><span class="fu">padStart</span><span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span><span class="op">)}.</span>$<span class="op">{</span></span>
<span id="cb35-773"><a href="#cb35-773" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span><span class="op">((</span>doty <span class="op">-</span> day<span class="op">)</span> <span class="op">*</span> <span class="fl">1e5</span><span class="op">)).</span><span class="fu">toString</span><span class="op">().</span><span class="fu">padStart</span><span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="st">"0"</span><span class="op">)}+</span><span class="dv">0</span>`<span class="op">;</span></span>
<span id="cb35-774"><a href="#cb35-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-775"><a href="#cb35-775" aria-hidden="true" tabindex="-1"></a><span class="fu">copy</span><span class="op">(</span>datetime<span class="op">)</span></span>
<span id="cb35-776"><a href="#cb35-776" aria-hidden="true" tabindex="-1"></a><span class="fu">copySelection</span><span class="op">(</span>datetime<span class="op">)</span></span>
<span id="cb35-777"><a href="#cb35-777" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span><span class="op">()</span></span>
<span id="cb35-778"><a href="#cb35-778" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-779"><a href="#cb35-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-782"><a href="#cb35-782" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-783"><a href="#cb35-783" aria-hidden="true" tabindex="-1"></a>function <span class="fu">zone2hour</span><span class="op">(</span>zone <span class="op">=</span> <span class="st">"Z"</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-784"><a href="#cb35-784" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>zone <span class="op">=</span> zone<span class="op">.</span><span class="fu">toUpperCase</span><span class="op">())</span> <span class="op">==</span> <span class="st">"Z"</span> <span class="op">?</span> <span class="dv">0</span></span>
<span id="cb35-785"><a href="#cb35-785" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&gt;</span> <span class="st">"@"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&lt;</span> <span class="st">"J"</span> <span class="op">?</span> zone<span class="op">.</span><span class="fu">charCodeAt</span><span class="op">()</span> <span class="op">-</span> <span class="dv">64</span></span>
<span id="cb35-786"><a href="#cb35-786" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&gt;</span> <span class="st">"J"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&lt;</span> <span class="st">"N"</span> <span class="op">?</span> zone<span class="op">.</span><span class="fu">charCodeAt</span><span class="op">()</span> <span class="op">-</span> <span class="dv">65</span></span>
<span id="cb35-787"><a href="#cb35-787" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone <span class="op">&lt;</span> <span class="st">"Z"</span> <span class="op">&amp;&amp;</span> zone <span class="op">&gt;</span> <span class="st">"M"</span> <span class="op">?</span> <span class="op">-(</span>zone<span class="op">.</span><span class="fu">charCodeAt</span><span class="op">()</span> <span class="op">-</span> <span class="dv">77</span><span class="op">)</span></span>
<span id="cb35-788"><a href="#cb35-788" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> zone<span class="op">;</span></span>
<span id="cb35-789"><a href="#cb35-789" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-790"><a href="#cb35-790" aria-hidden="true" tabindex="-1"></a>function <span class="fu">deco2doty</span><span class="op">(</span>timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-791"><a href="#cb35-791" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> arr <span class="op">=</span> timestamp<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">split</span><span class="op">(/(?=[+-]|[</span>a<span class="op">-</span>zA<span class="op">-</span>Z<span class="op">])/,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb35-792"><a href="#cb35-792" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span> <span class="op">(</span>arr<span class="op">.</span><span class="fu">length</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-793"><a href="#cb35-793" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span> <span class="cf">return</span> <span class="op">[</span><span class="fu">unix2doty</span><span class="op">(</span><span class="bu">Date</span><span class="op">.</span><span class="fu">now</span><span class="op">())[</span><span class="dv">0</span><span class="op">],</span> <span class="fu">parseFloat</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">0</span><span class="op">]),</span> <span class="dv">0</span><span class="op">];</span></span>
<span id="cb35-794"><a href="#cb35-794" aria-hidden="true" tabindex="-1"></a>        <span class="cf">case</span> <span class="dv">2</span><span class="op">:</span> <span class="cf">return</span> <span class="op">(/^[</span>a<span class="op">-</span>zA<span class="op">-</span>Z<span class="op">]+</span>$<span class="op">/.</span><span class="fu">test</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">1</span><span class="op">]))</span></span>
<span id="cb35-795"><a href="#cb35-795" aria-hidden="true" tabindex="-1"></a>            <span class="op">?</span> <span class="op">[</span><span class="fu">unix2doty</span><span class="op">(</span><span class="bu">Date</span><span class="op">.</span><span class="fu">now</span><span class="op">())[</span><span class="dv">0</span><span class="op">],</span> <span class="fu">parseFloat</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">0</span><span class="op">]),</span> <span class="fu">zone2hour</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">1</span><span class="op">])</span> <span class="op">/</span> <span class="dv">24</span><span class="op">]</span></span>
<span id="cb35-796"><a href="#cb35-796" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="op">[</span><span class="fu">parseFloat</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">0</span><span class="op">]),</span> <span class="fu">parseFloat</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">1</span><span class="op">]),</span> <span class="dv">0</span><span class="op">];</span></span>
<span id="cb35-797"><a href="#cb35-797" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb35-798"><a href="#cb35-798" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">[</span><span class="fu">parseFloat</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">0</span><span class="op">]),</span> <span class="fu">parseFloat</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">1</span><span class="op">]),</span> <span class="op">/^[</span>a<span class="op">-</span>zA<span class="op">-</span>Z<span class="op">]+</span>$<span class="op">/.</span><span class="fu">test</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">2</span><span class="op">])</span></span>
<span id="cb35-799"><a href="#cb35-799" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> <span class="fu">zone2hour</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">2</span><span class="op">])</span> <span class="op">/</span> <span class="dv">24</span></span>
<span id="cb35-800"><a href="#cb35-800" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="fu">parseFloat</span><span class="op">(</span>arr<span class="op">[</span><span class="dv">2</span><span class="op">].</span><span class="fu">replace</span><span class="op">(/([+-])/,</span> <span class="st">"$1</span><span class="er">\.</span><span class="st">"</span><span class="op">))];</span></span>
<span id="cb35-801"><a href="#cb35-801" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-802"><a href="#cb35-802" aria-hidden="true" tabindex="-1"></a>function <span class="fu">deco2deco</span><span class="op">(</span>timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-803"><a href="#cb35-803" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2deco</span><span class="op">(</span><span class="fu">deco2doty</span><span class="op">(</span>timestamp<span class="op">))</span></span>
<span id="cb35-804"><a href="#cb35-804" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-805"><a href="#cb35-805" aria-hidden="true" tabindex="-1"></a>function <span class="fu">doty2doty</span><span class="op">(</span>year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-806"><a href="#cb35-806" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2doty</span><span class="op">(</span><span class="fu">doty2dote</span><span class="op">(</span>year<span class="op">,</span> doty<span class="op">,</span> zone<span class="op">));</span></span>
<span id="cb35-807"><a href="#cb35-807" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-808"><a href="#cb35-808" aria-hidden="true" tabindex="-1"></a>function <span class="fu">doty2unix</span><span class="op">(</span>year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-809"><a href="#cb35-809" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="fu">doty2dote</span><span class="op">(</span>year<span class="op">,</span> doty<span class="op">,</span> zone<span class="op">)</span> <span class="op">-</span> <span class="dv">719468</span><span class="op">)</span> <span class="op">*</span> <span class="dv">86400000</span><span class="op">;</span></span>
<span id="cb35-810"><a href="#cb35-810" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-811"><a href="#cb35-811" aria-hidden="true" tabindex="-1"></a>function <span class="fu">doty2isoc</span><span class="op">(</span>year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-812"><a href="#cb35-812" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="bu">Date</span><span class="op">(</span><span class="fu">doty2unix</span><span class="op">(</span>year<span class="op">,</span> doty<span class="op">,</span> zone<span class="op">)).</span><span class="fu">toISOString</span><span class="op">().</span><span class="fu">split</span><span class="op">(</span><span class="st">"."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb35-813"><a href="#cb35-813" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-814"><a href="#cb35-814" aria-hidden="true" tabindex="-1"></a>function <span class="fu">deco2isoc</span><span class="op">(</span>timestamp <span class="op">=</span> <span class="st">"1969+306.00000Z"</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-815"><a href="#cb35-815" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">doty2isoc</span><span class="op">(</span><span class="kw">...</span><span class="fu">deco2doty</span><span class="op">(</span>timestamp<span class="op">))</span></span>
<span id="cb35-816"><a href="#cb35-816" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-817"><a href="#cb35-817" aria-hidden="true" tabindex="-1"></a>function <span class="fu">unix2dote</span><span class="op">(</span>ms <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-818"><a href="#cb35-818" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ms <span class="op">/</span> <span class="dv">86400000</span> <span class="op">+</span> <span class="dv">719468</span><span class="op">;</span></span>
<span id="cb35-819"><a href="#cb35-819" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-820"><a href="#cb35-820" aria-hidden="true" tabindex="-1"></a>function <span class="fu">dote2year</span><span class="op">(</span>days <span class="op">=</span> <span class="dv">719468</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-821"><a href="#cb35-821" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> era <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">((</span>days <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> days <span class="op">:</span> days <span class="op">-</span> <span class="dv">146096</span><span class="op">)</span> <span class="op">/</span> <span class="dv">146097</span><span class="op">),</span></span>
<span id="cb35-822"><a href="#cb35-822" aria-hidden="true" tabindex="-1"></a>        dotc <span class="op">=</span> days <span class="op">-</span> era <span class="op">*</span> <span class="dv">146097</span><span class="op">,</span></span>
<span id="cb35-823"><a href="#cb35-823" aria-hidden="true" tabindex="-1"></a>        yotc <span class="op">=</span> <span class="op">(</span>dotc <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">(</span>dotc <span class="op">/</span> <span class="dv">1460</span><span class="op">)</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">(</span>dotc <span class="op">/</span> <span class="dv">36524</span><span class="op">)</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span><span class="op">(</span>dotc <span class="op">/</span> <span class="dv">146096</span><span class="op">))</span> <span class="op">/</span> <span class="dv">365</span><span class="op">;</span></span>
<span id="cb35-824"><a href="#cb35-824" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> yotc <span class="op">+</span> era <span class="op">*</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb35-825"><a href="#cb35-825" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-826"><a href="#cb35-826" aria-hidden="true" tabindex="-1"></a>function <span class="fu">doty2year</span><span class="op">(</span>year <span class="op">=</span> <span class="dv">1969</span><span class="op">,</span> doty <span class="op">=</span> <span class="dv">306</span><span class="op">,</span> zone <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-827"><a href="#cb35-827" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2year</span><span class="op">(</span><span class="fu">doty2dote</span><span class="op">(</span>year<span class="op">,</span> doty<span class="op">,</span> zone<span class="op">));</span></span>
<span id="cb35-828"><a href="#cb35-828" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-829"><a href="#cb35-829" aria-hidden="true" tabindex="-1"></a>function <span class="fu">unix2year</span><span class="op">(</span>ms <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-830"><a href="#cb35-830" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">dote2year</span><span class="op">(</span><span class="fu">unix2dote</span><span class="op">(</span>ms<span class="op">));</span></span>
<span id="cb35-831"><a href="#cb35-831" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb35-832"><a href="#cb35-832" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-833"><a href="#cb35-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-834"><a href="#cb35-834" aria-hidden="true" tabindex="-1"></a>##### Variables <span class="op">{.</span><span class="fu">appendix</span><span class="op">}</span></span>
<span id="cb35-835"><a href="#cb35-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-838"><a href="#cb35-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-839"><a href="#cb35-839" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: all</span></span>
<span id="cb35-840"><a href="#cb35-840" aria-hidden="true" tabindex="-1"></a>tzOffsetInMs <span class="op">=</span> inputDatetime<span class="op">.</span><span class="fu">getTimezoneOffset</span><span class="op">()</span> <span class="op">*</span> <span class="dv">60000</span></span>
<span id="cb35-841"><a href="#cb35-841" aria-hidden="true" tabindex="-1"></a>utcDatetime <span class="op">=</span> inputDatetime <span class="op">-</span> tzOffsetInMs</span>
<span id="cb35-842"><a href="#cb35-842" aria-hidden="true" tabindex="-1"></a>outputDatetimeDeco <span class="op">=</span> <span class="fu">unix2deco</span><span class="op">(</span>utcDatetime<span class="op">)</span></span>
<span id="cb35-843"><a href="#cb35-843" aria-hidden="true" tabindex="-1"></a>dtDoty <span class="op">=</span> outputDatetimeDeco<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="st">"+"</span><span class="op">)[</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb35-844"><a href="#cb35-844" aria-hidden="true" tabindex="-1"></a>dtDotyDateRaw <span class="op">=</span> dtDoty<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="st">"."</span><span class="op">)[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb35-845"><a href="#cb35-845" aria-hidden="true" tabindex="-1"></a>dtDotyTimeRaw <span class="op">=</span> dtDoty<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="st">"."</span><span class="op">)[</span><span class="dv">1</span><span class="op">].</span><span class="fu">slice</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">5</span><span class="op">)</span></span>
<span id="cb35-846"><a href="#cb35-846" aria-hidden="true" tabindex="-1"></a>outputDatetimeYear <span class="op">=</span> <span class="fu">unix2year</span><span class="op">(</span>utcDatetime<span class="op">).</span><span class="fu">toString</span><span class="op">().</span><span class="fu">slice</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">8</span><span class="op">)</span></span>
<span id="cb35-847"><a href="#cb35-847" aria-hidden="true" tabindex="-1"></a>dtDotyTimeDelimiter <span class="op">=</span> dtDotyTimeRaw <span class="op">?</span> <span class="st">"."</span> <span class="op">:</span> <span class="st">""</span></span>
<span id="cb35-848"><a href="#cb35-848" aria-hidden="true" tabindex="-1"></a>outputDecoYear <span class="op">=</span> <span class="fu">doty2year</span><span class="op">(</span><span class="kw">...</span>yd<span class="op">).</span><span class="fu">toString</span><span class="op">().</span><span class="fu">slice</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">8</span><span class="op">)</span></span>
<span id="cb35-849"><a href="#cb35-849" aria-hidden="true" tabindex="-1"></a>outputIsoc <span class="op">=</span> <span class="fu">doty2isoc</span><span class="op">(</span><span class="kw">...</span>yd<span class="op">)</span></span>
<span id="cb35-850"><a href="#cb35-850" aria-hidden="true" tabindex="-1"></a>yearDate <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span><span class="op">(</span><span class="fu">unix2year</span><span class="op">(</span>unix<span class="op">)</span> <span class="op">*</span> <span class="fl">1e3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e3</span></span>
<span id="cb35-851"><a href="#cb35-851" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-852"><a href="#cb35-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-855"><a href="#cb35-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-856"><a href="#cb35-856" aria-hidden="true" tabindex="-1"></a>dtYear <span class="op">=</span> <span class="fu">setStyle</span><span class="op">(</span>outputDatetimeDeco<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="st">"+"</span><span class="op">)[</span><span class="dv">0</span><span class="op">],</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">10</span><span class="op">])</span></span>
<span id="cb35-857"><a href="#cb35-857" aria-hidden="true" tabindex="-1"></a>dtDotyDate <span class="op">=</span> <span class="fu">setStyle</span><span class="op">(</span>dtDotyDateRaw<span class="op">,</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">1</span><span class="op">])</span></span>
<span id="cb35-858"><a href="#cb35-858" aria-hidden="true" tabindex="-1"></a>dtDotyTime <span class="op">=</span> dtDotyTimeRaw <span class="op">?</span> <span class="fu">setStyle</span><span class="op">(</span>dtDotyTimeRaw<span class="op">,</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">2</span><span class="op">])</span> <span class="op">:</span> <span class="st">""</span></span>
<span id="cb35-859"><a href="#cb35-859" aria-hidden="true" tabindex="-1"></a>styledIsocYear <span class="op">=</span> <span class="fu">setStyle</span><span class="op">(</span>outputIsoc<span class="op">.</span><span class="fu">split</span><span class="op">(/(?=-)/)[</span><span class="dv">0</span><span class="op">],</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">10</span><span class="op">])</span></span>
<span id="cb35-860"><a href="#cb35-860" aria-hidden="true" tabindex="-1"></a>styledIsocMd <span class="op">=</span> <span class="fu">setStyle</span><span class="op">(</span>outputIsoc<span class="op">.</span><span class="fu">slice</span><span class="op">(</span>outputIsoc<span class="op">.</span><span class="fu">split</span><span class="op">(/(?=-)/)[</span><span class="dv">0</span><span class="op">].</span><span class="fu">length</span><span class="op">+</span><span class="dv">1</span><span class="op">,</span>outputIsoc<span class="op">.</span><span class="fu">split</span><span class="op">(/(?=-)/)[</span><span class="dv">0</span><span class="op">].</span><span class="fu">length</span><span class="op">+</span><span class="dv">6</span><span class="op">),</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">5</span><span class="op">])</span></span>
<span id="cb35-861"><a href="#cb35-861" aria-hidden="true" tabindex="-1"></a>styledIsocTime <span class="op">=</span> <span class="fu">setStyle</span><span class="op">(</span>outputIsoc<span class="op">.</span><span class="fu">slice</span><span class="op">(</span>outputIsoc<span class="op">.</span><span class="fu">split</span><span class="op">(/(?=-)/)[</span><span class="dv">0</span><span class="op">].</span><span class="fu">length</span><span class="op">+</span><span class="dv">7</span><span class="op">),</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">4</span><span class="op">])</span></span>
<span id="cb35-862"><a href="#cb35-862" aria-hidden="true" tabindex="-1"></a>styledOutputDatetimeYear <span class="op">=</span> <span class="fu">setStyle</span><span class="op">(</span>outputDatetimeYear<span class="op">,</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">10</span><span class="op">])</span></span>
<span id="cb35-863"><a href="#cb35-863" aria-hidden="true" tabindex="-1"></a>styledOutputDecoYear <span class="op">=</span> <span class="fu">setStyle</span><span class="op">(</span>outputDecoYear<span class="op">,</span> d3<span class="op">.</span><span class="fu">schemePaired</span><span class="op">[</span><span class="dv">10</span><span class="op">])</span></span>
<span id="cb35-864"><a href="#cb35-864" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-865"><a href="#cb35-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-866"><a href="#cb35-866" aria-hidden="true" tabindex="-1"></a>## Dek <span class="op">{</span>#sec<span class="op">-</span>intro<span class="op">-</span>dek<span class="op">}</span></span>
<span id="cb35-867"><a href="#cb35-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-868"><a href="#cb35-868" aria-hidden="true" tabindex="-1"></a>As mentioned in <span class="at">@sec</span><span class="op">-</span>intro<span class="op">-</span>doty<span class="op">,</span> `deks` function as both months and weeks in `Decalendar`<span class="op">.</span> <span class="fu">A</span> `dek` consists of <span class="dv">2</span> groups of <span class="dv">5</span> days called `pents`<span class="op">[^</span><span class="dv">13</span><span class="op">].</span> <span class="fu">Each</span> `pent` can follow a sequence of workdays and restdays called a `pently` schedule<span class="op">[^</span><span class="dv">14</span><span class="op">].</span> <span class="fu">fig</span><span class="op">-</span>schedules compares the typical weekly schedule and the `Schedule` `<span class="dv">3</span>` `pently` schedule<span class="op">.</span> <span class="fu">Like</span> other `pently` schedules<span class="op">,</span> `Schedule` `<span class="dv">3</span>` is named after the number of workdays it contains<span class="op">.</span> <span class="fu">The</span> <span class="dv">3</span> workdays in `Schedule` `<span class="dv">3</span>` are followed by a <span class="dv">2</span><span class="op">-</span>day `pentend`<span class="op">,</span> the `Decalender` equivalent of a weekend<span class="op">.</span></span>
<span id="cb35-869"><a href="#cb35-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-870"><a href="#cb35-870" aria-hidden="true" tabindex="-1"></a><span class="op">[^</span><span class="dv">13</span><span class="op">]:</span> `pent`<span class="op">:</span> a group of <span class="dv">5</span> days<span class="op">;</span> half of a `dek`</span>
<span id="cb35-871"><a href="#cb35-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-872"><a href="#cb35-872" aria-hidden="true" tabindex="-1"></a><span class="op">[^</span><span class="dv">14</span><span class="op">]:</span> `pently` schedule<span class="op">:</span> one of a set of workday and restday schedules <span class="cf">for</span> the <span class="dv">5</span> days of the `pent`</span>
<span id="cb35-873"><a href="#cb35-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-874"><a href="#cb35-874" aria-hidden="true" tabindex="-1"></a>Unlike `Schedule` `<span class="dv">3</span>` and the other `pently` schedules<span class="op">,</span> the weekly schedule is asymmetric and divides up workdays into proportions that are easier to express as fractions<span class="op">:</span> <span class="dv">3</span><span class="op">/</span><span class="dv">8</span> <span class="op">(</span><span class="fl">.375</span><span class="op">),</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span> <span class="op">(</span><span class="fl">.3</span>̅<span class="op">),</span> and <span class="dv">7</span><span class="op">/</span><span class="dv">24</span> <span class="op">(</span><span class="fl">0.2916</span>̅<span class="op">).</span> <span class="fu">In</span> contrast<span class="op">,</span> `pently` schedules divides each workday into simple<span class="op">,</span> symmetrical proportions that are never <span class="op">[</span>repeating decimal<span class="op">](</span>https<span class="op">:</span><span class="co">//en.wikipedia.org/wiki/Repeating_decimal) numbers. The `Schedule` `3` workday is longer the typical 9-to-5, but the longer workday is compensated by more frequent restdays.</span></span>
<span id="cb35-875"><a href="#cb35-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-876"><a href="#cb35-876" aria-hidden="true" tabindex="-1"></a><span class="at">@exm</span><span class="op">-</span>intro<span class="op">-</span>pent provides the opportunity to explore all four of the `pently` schedules<span class="op">.</span> `Schedule` `<span class="dv">3</span>` is the <span class="kw">default</span> `pently` schedule<span class="op">,</span> and should be followed unless there is a compelling reason to <span class="cf">do</span> otherwise<span class="op">.</span> <span class="fu">Despite</span> having different numbers of workdays<span class="op">,</span> all `pently` schedules keep the amount of spent at work constant at <span class="fl">1.2</span> <span class="fu">days</span> <span class="op">(</span><span class="dv">120</span> `cents`<span class="op">)</span> per `pent`<span class="op">.</span> <span class="fu">Every</span> `pently` schedule also splits up workdays symmetrically so that the time before work is equal to the time after work<span class="op">.</span> <span class="fu">You</span> can select which schedule to view in <span class="at">@exm</span><span class="op">-</span>intro<span class="op">-</span>pent using the <span class="op">[</span><span class="bu">Observable</span><span class="op">](</span>https<span class="op">:</span><span class="co">//observablehq.com/about) [radio inputs](https://observablehq.com/@observablehq/input-radio).</span></span>
<span id="cb35-877"><a href="#cb35-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-878"><a href="#cb35-878" aria-hidden="true" tabindex="-1"></a>You can also use the <span class="op">[</span>interval sliders<span class="op">](</span>https<span class="op">:</span><span class="co">//observablehq.com/@mootari/range-slider) to create a custom schedule and the Download⬇️button to obtain the schedule data. Each interval is summarized by a `Declock` `slice` shown next to its slider. `Decalendar` and `Declock` `slices` are inspired by [array slicing](https://en.wikipedia.org/wiki/Array_slicing#:~:text=In%20computer%20programming%2C%20array%20slicing%20is%20an%20operation%20that%20extracts%20a%20subset%20of%20elements%20from%20an%20array%20and%20packages%20them%20as%20another%20array) in computer programming and are used to represent date and time intervals. The `slice` that summarizes the `Schedule` `3` workday is `.3:.7`, where .3 (7.2 hours) is the `start` and .7 (16.8 hours) is the `stop`.</span></span>
<span id="cb35-879"><a href="#cb35-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-880"><a href="#cb35-880" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> <span class="op">{</span>#exm<span class="op">-</span>intro<span class="op">-</span>pent<span class="op">}</span></span>
<span id="cb35-881"><a href="#cb35-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-882"><a href="#cb35-882" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> grid</span>
<span id="cb35-883"><a href="#cb35-883" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> g<span class="op">-</span>col<span class="op">-</span><span class="dv">7</span></span>
<span id="cb35-886"><a href="#cb35-886" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-887"><a href="#cb35-887" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-888"><a href="#cb35-888" aria-hidden="true" tabindex="-1"></a>viewof intervals <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span><span class="op">([</span></span>
<span id="cb35-889"><a href="#cb35-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span><span class="op">([</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="fl">.01</span><span class="op">,</span> value<span class="op">:</span> <span class="op">[</span><span class="fl">.3</span><span class="op">,</span> <span class="fl">.7</span><span class="op">],</span> label<span class="op">:</span> <span class="er">'</span><span class="dv">0</span> or <span class="dv">5</span><span class="er">'</span><span class="op">,</span> width<span class="op">:</span> <span class="dv">250</span><span class="op">,</span> format<span class="op">:</span> <span class="op">([</span>start<span class="op">,</span> end<span class="op">])</span> <span class="op">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> `$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>start<span class="op">)}:</span>$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>end<span class="op">)}</span>`<span class="op">}),</span></span>
<span id="cb35-890"><a href="#cb35-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span><span class="op">([</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="fl">.01</span><span class="op">,</span> value<span class="op">:</span> <span class="op">[</span><span class="fl">.3</span><span class="op">,</span> <span class="fl">.7</span><span class="op">],</span> label<span class="op">:</span> <span class="er">'</span><span class="dv">1</span> or <span class="dv">6</span><span class="er">'</span><span class="op">,</span> width<span class="op">:</span> <span class="dv">250</span><span class="op">,</span> format<span class="op">:</span> <span class="op">([</span>start<span class="op">,</span> end<span class="op">])</span> <span class="op">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> `$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>start<span class="op">)}:</span>$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>end<span class="op">)}</span>`<span class="op">}),</span></span>
<span id="cb35-891"><a href="#cb35-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span><span class="op">([</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="fl">.01</span><span class="op">,</span> value<span class="op">:</span> <span class="op">[</span><span class="fl">.3</span><span class="op">,</span> <span class="fl">.7</span><span class="op">],</span> label<span class="op">:</span> <span class="er">'</span><span class="dv">2</span> or <span class="dv">7</span><span class="er">'</span><span class="op">,</span> width<span class="op">:</span> <span class="dv">250</span><span class="op">,</span> format<span class="op">:</span> <span class="op">([</span>start<span class="op">,</span> end<span class="op">])</span> <span class="op">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> `$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>start<span class="op">)}:</span>$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>end<span class="op">)}</span>`<span class="op">}),</span></span>
<span id="cb35-892"><a href="#cb35-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span><span class="op">([</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="fl">.01</span><span class="op">,</span> value<span class="op">:</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">],</span> label<span class="op">:</span> <span class="er">'</span><span class="dv">3</span> or <span class="dv">8</span><span class="er">'</span><span class="op">,</span> width<span class="op">:</span> <span class="dv">250</span><span class="op">,</span> format<span class="op">:</span> <span class="op">([</span>start<span class="op">,</span> end<span class="op">])</span> <span class="op">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> `$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>start<span class="op">)}:</span>$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>end<span class="op">)}</span>`<span class="op">}),</span></span>
<span id="cb35-893"><a href="#cb35-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interval</span><span class="op">([</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="fl">.01</span><span class="op">,</span> value<span class="op">:</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">],</span> label<span class="op">:</span> <span class="er">'</span><span class="dv">4</span> or <span class="dv">9</span><span class="er">'</span><span class="op">,</span> width<span class="op">:</span> <span class="dv">250</span><span class="op">,</span> format<span class="op">:</span> <span class="op">([</span>start<span class="op">,</span> end<span class="op">])</span> <span class="op">=&gt;</span> start <span class="op">===</span> end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> `$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>start<span class="op">)}:</span>$<span class="op">{</span><span class="fu">formatDecimal</span><span class="op">(</span>end<span class="op">)}</span>`<span class="op">}),</span></span>
<span id="cb35-894"><a href="#cb35-894" aria-hidden="true" tabindex="-1"></a><span class="op">])</span></span>
<span id="cb35-895"><a href="#cb35-895" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-896"><a href="#cb35-896" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-897"><a href="#cb35-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-898"><a href="#cb35-898" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> g<span class="op">-</span>col<span class="op">-</span><span class="dv">5</span></span>
<span id="cb35-901"><a href="#cb35-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-902"><a href="#cb35-902" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-903"><a href="#cb35-903" aria-hidden="true" tabindex="-1"></a>viewof schedule <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span><span class="op">([</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">],</span> <span class="op">{</span>label<span class="op">:</span> <span class="st">"sched."</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">3</span><span class="op">})</span></span>
<span id="cb35-904"><a href="#cb35-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-905"><a href="#cb35-905" aria-hidden="true" tabindex="-1"></a>viewof filename <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span><span class="op">({</span>label<span class="op">:</span> <span class="st">"name"</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter the filename"</span><span class="op">,</span> value<span class="op">:</span> `schedule$<span class="op">{</span>schedule<span class="op">}.</span><span class="fu">csv</span>`<span class="op">})</span></span>
<span id="cb35-906"><a href="#cb35-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-907"><a href="#cb35-907" aria-hidden="true" tabindex="-1"></a><span class="fu">button</span><span class="op">(</span>durations<span class="op">,</span> filename<span class="op">)</span></span>
<span id="cb35-908"><a href="#cb35-908" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-909"><a href="#cb35-909" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-910"><a href="#cb35-910" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-911"><a href="#cb35-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-914"><a href="#cb35-914" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-915"><a href="#cb35-915" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-916"><a href="#cb35-916" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: fig-intro-dek</span></span>
<span id="cb35-917"><a href="#cb35-917" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-cap: "Pently schedule explorer"</span></span>
<span id="cb35-918"><a href="#cb35-918" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-cap-location: margin</span></span>
<span id="cb35-919"><a href="#cb35-919" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-align: center</span></span>
<span id="cb35-920"><a href="#cb35-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-921"><a href="#cb35-921" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dec/pent</span></span>
<span id="cb35-922"><a href="#cb35-922" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span><span class="op">({</span></span>
<span id="cb35-923"><a href="#cb35-923" aria-hidden="true" tabindex="-1"></a>  className<span class="op">:</span> <span class="st">"schedule-explorer"</span><span class="op">,</span></span>
<span id="cb35-924"><a href="#cb35-924" aria-hidden="true" tabindex="-1"></a>  x<span class="op">:</span> <span class="op">{</span>label<span class="op">:</span> <span class="kw">null</span><span class="op">},</span></span>
<span id="cb35-925"><a href="#cb35-925" aria-hidden="true" tabindex="-1"></a>  color<span class="op">:</span> <span class="op">{</span>scheme<span class="op">:</span> <span class="st">"Set1"</span><span class="op">,</span> legend<span class="op">:</span> <span class="st">"swatches"</span><span class="op">,</span> reverse<span class="op">:</span> <span class="kw">true</span><span class="op">},</span></span>
<span id="cb35-926"><a href="#cb35-926" aria-hidden="true" tabindex="-1"></a>  y<span class="op">:</span> <span class="op">{</span>label<span class="op">:</span> <span class="kw">null</span><span class="op">,</span> domain<span class="op">:</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">]},</span></span>
<span id="cb35-927"><a href="#cb35-927" aria-hidden="true" tabindex="-1"></a>  marks<span class="op">:</span> <span class="op">[</span></span>
<span id="cb35-928"><a href="#cb35-928" aria-hidden="true" tabindex="-1"></a>  Plot<span class="op">.</span><span class="fu">barY</span><span class="op">(</span>durations<span class="op">,</span> <span class="op">{</span>x<span class="op">:</span> <span class="st">"label"</span><span class="op">,</span> y<span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span> fill<span class="op">:</span> <span class="st">"group"</span><span class="op">}),</span></span>
<span id="cb35-929"><a href="#cb35-929" aria-hidden="true" tabindex="-1"></a>  Plot<span class="op">.</span><span class="fu">textY</span><span class="op">(</span></span>
<span id="cb35-930"><a href="#cb35-930" aria-hidden="true" tabindex="-1"></a>      durations<span class="op">,</span></span>
<span id="cb35-931"><a href="#cb35-931" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">stackY</span><span class="op">(</span></span>
<span id="cb35-932"><a href="#cb35-932" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">groupX</span><span class="op">(</span></span>
<span id="cb35-933"><a href="#cb35-933" aria-hidden="true" tabindex="-1"></a>          <span class="op">{</span> y<span class="op">:</span> <span class="st">"first"</span><span class="op">,</span> text<span class="op">:</span> <span class="st">"first"</span> <span class="op">},</span></span>
<span id="cb35-934"><a href="#cb35-934" aria-hidden="true" tabindex="-1"></a>          <span class="op">{</span></span>
<span id="cb35-935"><a href="#cb35-935" aria-hidden="true" tabindex="-1"></a>            x<span class="op">:</span> <span class="st">"label"</span><span class="op">,</span></span>
<span id="cb35-936"><a href="#cb35-936" aria-hidden="true" tabindex="-1"></a>            z<span class="op">:</span> <span class="st">"group"</span><span class="op">,</span></span>
<span id="cb35-937"><a href="#cb35-937" aria-hidden="true" tabindex="-1"></a>            y<span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span></span>
<span id="cb35-938"><a href="#cb35-938" aria-hidden="true" tabindex="-1"></a>            text<span class="op">:</span> <span class="op">(</span>d<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">(</span>d<span class="op">.</span><span class="fu">duration</span> <span class="op">&lt;</span> <span class="fl">.0001</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="fu">formatDecimal</span><span class="op">(</span>d<span class="op">.</span><span class="fu">duration</span><span class="op">)),</span></span>
<span id="cb35-939"><a href="#cb35-939" aria-hidden="true" tabindex="-1"></a>            fill<span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb35-940"><a href="#cb35-940" aria-hidden="true" tabindex="-1"></a>            stroke<span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb35-941"><a href="#cb35-941" aria-hidden="true" tabindex="-1"></a>            fontSize<span class="op">:</span> <span class="dv">36</span><span class="op">,</span></span>
<span id="cb35-942"><a href="#cb35-942" aria-hidden="true" tabindex="-1"></a>          <span class="op">}</span></span>
<span id="cb35-943"><a href="#cb35-943" aria-hidden="true" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb35-944"><a href="#cb35-944" aria-hidden="true" tabindex="-1"></a>      <span class="op">)</span></span>
<span id="cb35-945"><a href="#cb35-945" aria-hidden="true" tabindex="-1"></a>    <span class="op">),</span></span>
<span id="cb35-946"><a href="#cb35-946" aria-hidden="true" tabindex="-1"></a>  <span class="op">]})</span></span>
<span id="cb35-947"><a href="#cb35-947" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-948"><a href="#cb35-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-949"><a href="#cb35-949" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-950"><a href="#cb35-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-951"><a href="#cb35-951" aria-hidden="true" tabindex="-1"></a>`Slices` can be used to select `Declock` time intervals<span class="op">,</span> as in <span class="at">@exm</span><span class="op">-</span>intro<span class="op">-</span>pent above<span class="op">,</span> or `Decalendar` date intervals<span class="op">,</span> as in <span class="at">@exm</span><span class="op">-</span>intro<span class="op">-</span>dotd below<span class="op">.</span> `Decalendar` date intervals can represent events take place over multiple days<span class="op">.</span> <span class="fu">In</span> addition to `slices`<span class="op">,</span> `Decalendar` and `Declock` intervals can also be chosen using `spreads`<span class="op">.</span> <span class="fu">Use</span> the <span class="op">[</span><span class="bu">Observable</span><span class="op">](</span>https<span class="op">:</span><span class="co">//observablehq.com/about) [button](https://observablehq.com/@observablehq/input-button) and [checkbox](https://observablehq.com/@observablehq/input-checkbox) inputs in @exm-intro-dotd to display different `dotd` combinations in @fig-intro-dotd. @fig-intro-dotd shows dates selected by a `slice` in [blue]{.blue}, dates selected by a `spread` in [orange]{.orange}, dates selected by both in [green]{.green}, and dates selected by neither in [gray]{.gray}.</span></span>
<span id="cb35-952"><a href="#cb35-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-953"><a href="#cb35-953" aria-hidden="true" tabindex="-1"></a>The <span class="at">@exm</span><span class="op">-</span>intro<span class="op">-</span>dotd button and checkbox inputs will modify the associated `slice` and `spread` text and numeric inputs as needed to select the desired days<span class="op">-</span>of<span class="op">-</span>the<span class="op">-</span>`dek`<span class="op">.</span> <span class="fu">The</span> numeric inputs <span class="cf">for</span> `slices` are the `start`🎬index<span class="op">,</span> the `stop`🛑index<span class="op">,</span> and the `step`👣size<span class="op">,</span> which are separated by <span class="fu">colons</span> <span class="op">(</span>`start<span class="op">:</span>stop<span class="op">:</span>step`<span class="op">)</span> when combined into a `slice`<span class="op">.</span> <span class="fu">Similarly</span><span class="op">,</span> the numeric inputs <span class="cf">for</span> `spreads` are the `start`🎬or🛑`stop` index<span class="op">,</span> the `span`🪽size<span class="op">,</span> the `split` size<span class="op">,</span> and the `space` size<span class="op">,</span> which are typically delimited by greater<span class="op">-</span>than <span class="fu">signs</span> <span class="op">(</span>`start<span class="op">&gt;</span>span<span class="op">&gt;</span>split<span class="op">&gt;</span>space`<span class="op">)</span> or a mix of greater<span class="op">-</span>than and less<span class="op">-</span>than <span class="fu">signs</span> <span class="op">(</span>`stop<span class="op">&lt;</span>span<span class="op">&gt;</span>split<span class="op">&gt;</span>space`<span class="op">).</span></span>
<span id="cb35-954"><a href="#cb35-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-955"><a href="#cb35-955" aria-hidden="true" tabindex="-1"></a><span class="fu">The</span> numeric inputs in <span class="at">@exm</span><span class="op">-</span>intro<span class="op">-</span>dotd cannot capture the full power of `spreads` and `slices`<span class="op">,</span> because `slices` can have any number of `steps` and<span class="op">,</span> likewise<span class="op">,</span> `spreads` can have any number of alternating `split` and `space` sizes<span class="op">.</span> <span class="fu">We</span> can select all even or odd days<span class="op">-</span>of<span class="op">-</span>the<span class="op">-</span>`dek` using a `slice` with a single `step` <span class="op">(</span>`<span class="op">::</span><span class="dv">2</span>` or `<span class="dv">1</span><span class="op">::</span><span class="dv">2</span>`<span class="op">)</span> or a `spread` with one `split`<span class="op">-</span>`space` <span class="fu">pair</span> <span class="op">(</span>`<span class="op">&gt;&gt;&gt;</span><span class="dv">1</span>` or `<span class="dv">1</span><span class="op">&gt;&gt;&gt;</span><span class="dv">1</span>`<span class="op">).</span> <span class="fu">More</span> complex patterns<span class="op">,</span> such as prime or composite days<span class="op">-</span>of<span class="op">-</span>the<span class="op">-</span>`dek`<span class="op">,</span> require multiple `step` sizes <span class="cf">for</span> `slices` <span class="op">(</span>`<span class="dv">2</span><span class="op">:::</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span>` or `<span class="dv">4</span><span class="op">::</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span><span class="op">::</span><span class="dv">5</span>`<span class="op">)</span> or multiple `split`<span class="op">-</span>`space` <span class="fu">pairs</span> <span class="op">(</span>`<span class="dv">2</span><span class="op">&gt;&gt;</span><span class="dv">2</span><span class="op">&gt;</span><span class="dv">1</span><span class="op">&gt;&gt;</span><span class="dv">1</span><span class="op">&gt;&gt;</span><span class="dv">4</span>` or `<span class="dv">4</span><span class="op">&gt;&gt;&gt;</span><span class="dv">1</span><span class="op">&gt;&gt;</span><span class="dv">1</span><span class="op">&gt;</span><span class="dv">2</span><span class="op">&gt;</span><span class="dv">4</span>`<span class="op">).</span></span>
<span id="cb35-956"><a href="#cb35-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-957"><a href="#cb35-957" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> <span class="op">{</span>#exm<span class="op">-</span>intro<span class="op">-</span>dotd<span class="op">}</span></span>
<span id="cb35-958"><a href="#cb35-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-961"><a href="#cb35-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-962"><a href="#cb35-962" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-963"><a href="#cb35-963" aria-hidden="true" tabindex="-1"></a>viewof sliceDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span><span class="op">([</span><span class="kw">...</span><span class="bu">Array</span><span class="op">(</span><span class="dv">10</span><span class="op">).</span><span class="fu">keys</span><span class="op">()],</span> <span class="op">{</span>label<span class="op">:</span> <span class="st">"slice"</span><span class="op">,</span> value<span class="op">:</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">6</span><span class="op">]})</span></span>
<span id="cb35-964"><a href="#cb35-964" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-965"><a href="#cb35-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-968"><a href="#cb35-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-969"><a href="#cb35-969" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-970"><a href="#cb35-970" aria-hidden="true" tabindex="-1"></a>viewof spreadDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span><span class="op">([</span><span class="kw">...</span><span class="bu">Array</span><span class="op">(</span><span class="dv">10</span><span class="op">).</span><span class="fu">keys</span><span class="op">()],</span> <span class="op">{</span>label<span class="op">:</span> <span class="st">"spread"</span><span class="op">,</span> value<span class="op">:</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">6</span><span class="op">]})</span></span>
<span id="cb35-971"><a href="#cb35-971" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-972"><a href="#cb35-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-975"><a href="#cb35-975" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-976"><a href="#cb35-976" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-977"><a href="#cb35-977" aria-hidden="true" tabindex="-1"></a>viewof togglePlot <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">button</span><span class="op">([</span></span>
<span id="cb35-978"><a href="#cb35-978" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span>invertDotd <span class="op">?</span> <span class="st">"None"</span> <span class="op">:</span> <span class="st">"All"</span><span class="op">,</span> value <span class="op">=&gt;</span> <span class="op">[</span><span class="kw">...</span><span class="bu">Array</span><span class="op">(</span><span class="dv">10</span><span class="op">).</span><span class="fu">keys</span><span class="op">()]],</span></span>
<span id="cb35-979"><a href="#cb35-979" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span>invertDotd <span class="op">?</span> <span class="st">"Even"</span> <span class="op">:</span> <span class="st">"Odd"</span><span class="op">,</span> value <span class="op">=&gt;</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">9</span><span class="op">]],</span></span>
<span id="cb35-980"><a href="#cb35-980" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span>invertDotd <span class="op">?</span> html`<span class="op">&lt;</span>s<span class="op">&gt;</span>Prime<span class="op">&lt;/</span>s<span class="op">&gt;</span>` <span class="op">:</span> <span class="st">"Prime"</span><span class="op">,</span> value <span class="op">=&gt;</span> <span class="op">[</span><span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">]],</span></span>
<span id="cb35-981"><a href="#cb35-981" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span>invertDotd <span class="op">?</span> html`<span class="op">&lt;</span>s<span class="op">&gt;</span><span class="bu">Composite</span><span class="op">&lt;/</span>s<span class="op">&gt;</span>` <span class="op">:</span> <span class="st">"Composite"</span><span class="op">,</span> value <span class="op">=&gt;</span> <span class="op">[</span><span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">9</span><span class="op">]],</span></span>
<span id="cb35-982"><a href="#cb35-982" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span>invertDotd <span class="op">?</span> html`<span class="op">&lt;</span>s<span class="op">&gt;</span>Schedule2<span class="op">&lt;/</span>s<span class="op">&gt;</span>` <span class="op">:</span> <span class="st">"Schedule2"</span><span class="op">,</span> value <span class="op">=&gt;</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">]],</span></span>
<span id="cb35-983"><a href="#cb35-983" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span>invertDotd <span class="op">?</span> html`<span class="op">&lt;</span>s<span class="op">&gt;</span>Schedule3<span class="op">&lt;/</span>s<span class="op">&gt;</span>` <span class="op">:</span> <span class="st">"Schedule3"</span><span class="op">,</span> value <span class="op">=&gt;</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">]],</span></span>
<span id="cb35-984"><a href="#cb35-984" aria-hidden="true" tabindex="-1"></a>  <span class="op">[</span>invertDotd <span class="op">?</span> html`<span class="op">&lt;</span>s<span class="op">&gt;</span>Schedule4<span class="op">&lt;/</span>s<span class="op">&gt;</span>` <span class="op">:</span> <span class="st">"Schedule4"</span><span class="op">,</span> value <span class="op">=&gt;</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">]],</span></span>
<span id="cb35-985"><a href="#cb35-985" aria-hidden="true" tabindex="-1"></a><span class="op">],</span> <span class="op">{</span>value<span class="op">:</span> <span class="op">[],</span> label<span class="op">:</span> <span class="st">"select"</span><span class="op">})</span></span>
<span id="cb35-986"><a href="#cb35-986" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-987"><a href="#cb35-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-988"><a href="#cb35-988" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> grid</span>
<span id="cb35-989"><a href="#cb35-989" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> g<span class="op">-</span>col<span class="op">-</span><span class="dv">6</span></span>
<span id="cb35-992"><a href="#cb35-992" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-993"><a href="#cb35-993" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-994"><a href="#cb35-994" aria-hidden="true" tabindex="-1"></a><span class="co">//| classes: btn-row</span></span>
<span id="cb35-995"><a href="#cb35-995" aria-hidden="true" tabindex="-1"></a>viewof invertDotd <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span><span class="op">({</span>label<span class="op">:</span> <span class="st">"invert"</span><span class="op">})</span></span>
<span id="cb35-996"><a href="#cb35-996" aria-hidden="true" tabindex="-1"></a>viewof sliceOrSpread <span class="op">=</span> <span class="fu">toggleSwitch</span><span class="op">({</span>textOn<span class="op">:</span> invertDotd <span class="op">?</span> <span class="st">"Spread"</span> <span class="op">:</span> <span class="er">'</span>Slice<span class="er">'</span> <span class="op">,</span> textOff<span class="op">:</span> invertDotd <span class="op">?</span> <span class="st">"Slice"</span> <span class="op">:</span> <span class="er">'</span>Spread<span class="er">'</span><span class="op">})</span></span>
<span id="cb35-997"><a href="#cb35-997" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-998"><a href="#cb35-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1001"><a href="#cb35-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1002"><a href="#cb35-1002" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-1003"><a href="#cb35-1003" aria-hidden="true" tabindex="-1"></a>viewof sliceInputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span><span class="op">([</span></span>
<span id="cb35-1004"><a href="#cb35-1004" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span><span class="op">([-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> label<span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter start index"</span><span class="op">}),</span></span>
<span id="cb35-1005"><a href="#cb35-1005" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span><span class="op">([-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> label<span class="op">:</span> <span class="st">"stop"</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">366</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter stop index"</span><span class="op">}),</span></span>
<span id="cb35-1006"><a href="#cb35-1006" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span><span class="op">([-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> label<span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">5</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter step size"</span><span class="op">}),</span></span>
<span id="cb35-1007"><a href="#cb35-1007" aria-hidden="true" tabindex="-1"></a><span class="op">])</span></span>
<span id="cb35-1008"><a href="#cb35-1008" aria-hidden="true" tabindex="-1"></a>viewof sliceString <span class="op">=</span> <span class="fu">transformInput</span><span class="op">(</span></span>
<span id="cb35-1009"><a href="#cb35-1009" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span><span class="op">({</span>label<span class="op">:</span> <span class="st">"slice"</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter slice string"</span><span class="op">,</span> value<span class="op">:</span> <span class="st">"0:366"</span><span class="op">}),</span></span>
<span id="cb35-1010"><a href="#cb35-1010" aria-hidden="true" tabindex="-1"></a><span class="op">{</span>bind<span class="op">:</span> viewof sliceInputs<span class="op">,</span> transform<span class="op">:</span> encodeSlice<span class="op">,</span> invert<span class="op">:</span> decodeSlice<span class="op">});</span></span>
<span id="cb35-1011"><a href="#cb35-1011" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-1012"><a href="#cb35-1012" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-1013"><a href="#cb35-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1014"><a href="#cb35-1014" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> g<span class="op">-</span>col<span class="op">-</span><span class="dv">6</span></span>
<span id="cb35-1017"><a href="#cb35-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1018"><a href="#cb35-1018" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-1019"><a href="#cb35-1019" aria-hidden="true" tabindex="-1"></a>viewof spreadInputs <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span><span class="op">([</span></span>
<span id="cb35-1020"><a href="#cb35-1020" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span><span class="op">([-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> label<span class="op">:</span> <span class="st">"start"</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">0</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter start index"</span><span class="op">}),</span></span>
<span id="cb35-1021"><a href="#cb35-1021" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span><span class="op">([-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> label<span class="op">:</span> <span class="st">"span"</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">366</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter span size"</span><span class="op">}),</span></span>
<span id="cb35-1022"><a href="#cb35-1022" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span><span class="op">([-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> label<span class="op">:</span> <span class="st">"split"</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">3</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter split size"</span><span class="op">}),</span></span>
<span id="cb35-1023"><a href="#cb35-1023" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">number</span><span class="op">([-</span><span class="dv">366</span><span class="op">,</span> <span class="dv">366</span><span class="op">],</span> <span class="op">{</span>step<span class="op">:</span> <span class="dv">1</span><span class="op">,</span> label<span class="op">:</span> <span class="st">"space"</span><span class="op">,</span> value<span class="op">:</span> <span class="dv">2</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter space size"</span><span class="op">}),</span></span>
<span id="cb35-1024"><a href="#cb35-1024" aria-hidden="true" tabindex="-1"></a><span class="op">])</span></span>
<span id="cb35-1025"><a href="#cb35-1025" aria-hidden="true" tabindex="-1"></a>viewof spreadString <span class="op">=</span> <span class="fu">transformInput</span><span class="op">(</span></span>
<span id="cb35-1026"><a href="#cb35-1026" aria-hidden="true" tabindex="-1"></a>  Inputs<span class="op">.</span><span class="fu">text</span><span class="op">({</span>label<span class="op">:</span> <span class="st">"spread"</span><span class="op">,</span> placeholder<span class="op">:</span> <span class="st">"Enter spread string"</span><span class="op">,</span> value<span class="op">:</span> <span class="st">"0&gt;366&gt;3&gt;2"</span><span class="op">}),</span></span>
<span id="cb35-1027"><a href="#cb35-1027" aria-hidden="true" tabindex="-1"></a><span class="op">{</span>bind<span class="op">:</span> viewof spreadInputs<span class="op">,</span> transform<span class="op">:</span> encodeSpread<span class="op">,</span> invert<span class="op">:</span> decodeSpread<span class="op">});</span></span>
<span id="cb35-1028"><a href="#cb35-1028" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-1029"><a href="#cb35-1029" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-1030"><a href="#cb35-1030" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-1031"><a href="#cb35-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1034"><a href="#cb35-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1035"><a href="#cb35-1035" aria-hidden="true" tabindex="-1"></a><span class="co">//| echo: false</span></span>
<span id="cb35-1036"><a href="#cb35-1036" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: fig-intro-dotd</span></span>
<span id="cb35-1037"><a href="#cb35-1037" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-cap: "Decalendar date selector"</span></span>
<span id="cb35-1038"><a href="#cb35-1038" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-cap-location: margin</span></span>
<span id="cb35-1039"><a href="#cb35-1039" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-align: center</span></span>
<span id="cb35-1040"><a href="#cb35-1040" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@dec/dotd</span></span>
<span id="cb35-1041"><a href="#cb35-1041" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span><span class="op">({</span></span>
<span id="cb35-1042"><a href="#cb35-1042" aria-hidden="true" tabindex="-1"></a>  className<span class="op">:</span> <span class="st">"date-selector"</span><span class="op">,</span></span>
<span id="cb35-1043"><a href="#cb35-1043" aria-hidden="true" tabindex="-1"></a>  padding<span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb35-1044"><a href="#cb35-1044" aria-hidden="true" tabindex="-1"></a>  x<span class="op">:</span> <span class="op">{</span>axis<span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> label<span class="op">:</span> <span class="kw">null</span><span class="op">,</span> type<span class="op">:</span> <span class="st">"band"</span><span class="op">},</span></span>
<span id="cb35-1045"><a href="#cb35-1045" aria-hidden="true" tabindex="-1"></a>  y<span class="op">:</span> <span class="op">{</span>label<span class="op">:</span> <span class="kw">null</span><span class="op">,</span> type<span class="op">:</span> <span class="st">"band"</span><span class="op">},</span></span>
<span id="cb35-1046"><a href="#cb35-1046" aria-hidden="true" tabindex="-1"></a>  marks<span class="op">:</span> <span class="op">[</span></span>
<span id="cb35-1047"><a href="#cb35-1047" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">cell</span><span class="op">(</span>dates<span class="op">,</span> <span class="op">{</span>x<span class="op">:</span> d <span class="op">=&gt;</span> d<span class="op">[</span><span class="dv">2</span><span class="op">],</span> y<span class="op">:</span> d <span class="op">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">),</span> fill<span class="op">:</span> d <span class="op">=&gt;</span></span>
<span id="cb35-1048"><a href="#cb35-1048" aria-hidden="true" tabindex="-1"></a>      sliceArray<span class="op">.</span><span class="fu">includes</span><span class="op">(</span>d<span class="op">)</span> <span class="op">&amp;&amp;</span> spreadArray<span class="op">.</span><span class="fu">includes</span><span class="op">(</span>d<span class="op">)</span> <span class="op">?</span> <span class="st">"green"</span> <span class="op">:</span></span>
<span id="cb35-1049"><a href="#cb35-1049" aria-hidden="true" tabindex="-1"></a>      sliceArray<span class="op">.</span><span class="fu">includes</span><span class="op">(</span>d<span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>spreadArray<span class="op">.</span><span class="fu">includes</span><span class="op">(</span>d<span class="op">)</span> <span class="op">?</span> <span class="st">"blue"</span> <span class="op">:</span></span>
<span id="cb35-1050"><a href="#cb35-1050" aria-hidden="true" tabindex="-1"></a>      <span class="op">!</span>sliceArray<span class="op">.</span><span class="fu">includes</span><span class="op">(</span>d<span class="op">)</span> <span class="op">&amp;&amp;</span> spreadArray<span class="op">.</span><span class="fu">includes</span><span class="op">(</span>d<span class="op">)</span> <span class="op">?</span> <span class="st">"orange"</span> <span class="op">:</span> <span class="st">"grey"</span><span class="op">,</span></span>
<span id="cb35-1051"><a href="#cb35-1051" aria-hidden="true" tabindex="-1"></a>      inset<span class="op">:</span> <span class="fl">0.5</span><span class="op">}),</span></span>
<span id="cb35-1052"><a href="#cb35-1052" aria-hidden="true" tabindex="-1"></a>    Plot<span class="op">.</span><span class="fu">text</span><span class="op">(</span>dates<span class="op">,</span> <span class="op">{</span></span>
<span id="cb35-1053"><a href="#cb35-1053" aria-hidden="true" tabindex="-1"></a>    x<span class="op">:</span> d <span class="op">=&gt;</span> d<span class="op">[</span><span class="dv">2</span><span class="op">],</span></span>
<span id="cb35-1054"><a href="#cb35-1054" aria-hidden="true" tabindex="-1"></a>    y<span class="op">:</span> d <span class="op">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">),</span></span>
<span id="cb35-1055"><a href="#cb35-1055" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb35-1056"><a href="#cb35-1056" aria-hidden="true" tabindex="-1"></a>    stroke<span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb35-1057"><a href="#cb35-1057" aria-hidden="true" tabindex="-1"></a>    fontSize<span class="op">:</span> <span class="dv">20</span><span class="op">})</span></span>
<span id="cb35-1058"><a href="#cb35-1058" aria-hidden="true" tabindex="-1"></a>  <span class="op">]</span></span>
<span id="cb35-1059"><a href="#cb35-1059" aria-hidden="true" tabindex="-1"></a><span class="op">})</span></span>
<span id="cb35-1060"><a href="#cb35-1060" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-1061"><a href="#cb35-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1062"><a href="#cb35-1062" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-1063"><a href="#cb35-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1064"><a href="#cb35-1064" aria-hidden="true" tabindex="-1"></a>#### `Dek` <span class="bu">Observable</span> code <span class="op">{</span>#sec<span class="op">-</span>ojs<span class="op">-</span>code<span class="op">-</span>dek <span class="op">.</span><span class="fu">appendix</span><span class="op">}</span></span>
<span id="cb35-1065"><a href="#cb35-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1066"><a href="#cb35-1066" aria-hidden="true" tabindex="-1"></a>##### Functions <span class="op">{.</span><span class="fu">appendix</span><span class="op">}</span></span>
<span id="cb35-1067"><a href="#cb35-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1070"><a href="#cb35-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1071"><a href="#cb35-1071" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@mootari/range-slider</span></span>
<span id="cb35-1072"><a href="#cb35-1072" aria-hidden="true" tabindex="-1"></a>function <span class="fu">interval</span><span class="op">(</span>range <span class="op">=</span> <span class="op">[],</span> options <span class="op">=</span> <span class="op">{})</span> <span class="op">{</span></span>
<span id="cb35-1073"><a href="#cb35-1073" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> <span class="op">[</span>min <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> max <span class="op">=</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> range<span class="op">;</span></span>
<span id="cb35-1074"><a href="#cb35-1074" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> <span class="op">{</span></span>
<span id="cb35-1075"><a href="#cb35-1075" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="fl">.001</span><span class="op">,</span></span>
<span id="cb35-1076"><a href="#cb35-1076" aria-hidden="true" tabindex="-1"></a>    label <span class="op">=</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb35-1077"><a href="#cb35-1077" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> <span class="op">[</span>min<span class="op">,</span> max<span class="op">],</span></span>
<span id="cb35-1078"><a href="#cb35-1078" aria-hidden="true" tabindex="-1"></a>    format <span class="op">=</span> <span class="op">([</span>start<span class="op">,</span> end<span class="op">])</span> <span class="op">=&gt;</span> `$<span class="op">{</span>start<span class="op">}</span> … $<span class="op">{</span>end<span class="op">}</span>`<span class="op">,</span></span>
<span id="cb35-1079"><a href="#cb35-1079" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb35-1080"><a href="#cb35-1080" aria-hidden="true" tabindex="-1"></a>    width<span class="op">,</span></span>
<span id="cb35-1081"><a href="#cb35-1081" aria-hidden="true" tabindex="-1"></a>    theme<span class="op">,</span></span>
<span id="cb35-1082"><a href="#cb35-1082" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="op">=</span> options<span class="op">;</span></span>
<span id="cb35-1083"><a href="#cb35-1083" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> __ns__ <span class="op">=</span> DOM<span class="op">.</span><span class="fu">uid</span><span class="op">(</span><span class="er">'</span>scope<span class="er">'</span><span class="op">).</span><span class="fu">id</span><span class="op">;</span></span>
<span id="cb35-1084"><a href="#cb35-1084" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> css <span class="op">=</span> `</span>
<span id="cb35-1085"><a href="#cb35-1085" aria-hidden="true" tabindex="-1"></a>#$<span class="op">{</span>__ns__<span class="op">}</span> <span class="op">{</span></span>
<span id="cb35-1086"><a href="#cb35-1086" aria-hidden="true" tabindex="-1"></a>  font<span class="op">:</span> <span class="er">13</span>px<span class="op">/</span><span class="fl">1.2</span> <span class="dt">var</span><span class="op">(--</span>sans<span class="op">-</span>serif<span class="op">);</span></span>
<span id="cb35-1087"><a href="#cb35-1087" aria-hidden="true" tabindex="-1"></a>  display<span class="op">:</span> flex<span class="op">;</span></span>
<span id="cb35-1088"><a href="#cb35-1088" aria-hidden="true" tabindex="-1"></a>  align<span class="op">-</span>items<span class="op">:</span> baseline<span class="op">;</span></span>
<span id="cb35-1089"><a href="#cb35-1089" aria-hidden="true" tabindex="-1"></a>  flex<span class="op">-</span>wrap<span class="op">:</span> wrap<span class="op">;</span></span>
<span id="cb35-1090"><a href="#cb35-1090" aria-hidden="true" tabindex="-1"></a>  max<span class="op">-</span>width<span class="op">:</span> <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb35-1091"><a href="#cb35-1091" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> auto<span class="op">;</span></span>
<span id="cb35-1092"><a href="#cb35-1092" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1093"><a href="#cb35-1093" aria-hidden="true" tabindex="-1"></a><span class="at">@media</span> only screen <span class="fu">and</span> <span class="op">(</span>min<span class="op">-</span>width<span class="op">:</span> <span class="er">30</span>em<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1094"><a href="#cb35-1094" aria-hidden="true" tabindex="-1"></a>  #$<span class="op">{</span>__ns__<span class="op">}</span> <span class="op">{</span></span>
<span id="cb35-1095"><a href="#cb35-1095" aria-hidden="true" tabindex="-1"></a>    flex<span class="op">-</span>wrap<span class="op">:</span> nowrap<span class="op">;</span></span>
<span id="cb35-1096"><a href="#cb35-1096" aria-hidden="true" tabindex="-1"></a>    width<span class="op">:</span> <span class="er">360</span>px<span class="op">;</span></span>
<span id="cb35-1097"><a href="#cb35-1097" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1098"><a href="#cb35-1098" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1099"><a href="#cb35-1099" aria-hidden="true" tabindex="-1"></a>#$<span class="op">{</span>__ns__<span class="op">}</span> <span class="op">.</span><span class="fu">label</span> <span class="op">{</span></span>
<span id="cb35-1100"><a href="#cb35-1100" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="er">50</span>px<span class="op">;</span></span>
<span id="cb35-1101"><a href="#cb35-1101" aria-hidden="true" tabindex="-1"></a>  padding<span class="op">:</span> <span class="er">5</span>px <span class="dv">0</span> <span class="er">4</span>px <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-1102"><a href="#cb35-1102" aria-hidden="true" tabindex="-1"></a>  margin<span class="op">-</span>right<span class="op">:</span> <span class="op">.</span><span class="er">5</span>px<span class="op">;</span></span>
<span id="cb35-1103"><a href="#cb35-1103" aria-hidden="true" tabindex="-1"></a>  flex<span class="op">-</span>shrink<span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-1104"><a href="#cb35-1104" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1105"><a href="#cb35-1105" aria-hidden="true" tabindex="-1"></a>#$<span class="op">{</span>__ns__<span class="op">}</span> <span class="op">.</span><span class="fu">form</span> <span class="op">{</span></span>
<span id="cb35-1106"><a href="#cb35-1106" aria-hidden="true" tabindex="-1"></a>  display<span class="op">:</span> flex<span class="op">;</span></span>
<span id="cb35-1107"><a href="#cb35-1107" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb35-1108"><a href="#cb35-1108" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1109"><a href="#cb35-1109" aria-hidden="true" tabindex="-1"></a>#$<span class="op">{</span>__ns__<span class="op">}</span> <span class="op">.</span><span class="fu">range</span> <span class="op">{</span></span>
<span id="cb35-1110"><a href="#cb35-1110" aria-hidden="true" tabindex="-1"></a>  flex<span class="op">-</span>shrink<span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-1111"><a href="#cb35-1111" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb35-1112"><a href="#cb35-1112" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1113"><a href="#cb35-1113" aria-hidden="true" tabindex="-1"></a>#$<span class="op">{</span>__ns__<span class="op">}</span> <span class="op">.</span><span class="fu">range</span><span class="op">-</span>slider <span class="op">{</span></span>
<span id="cb35-1114"><a href="#cb35-1114" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb35-1115"><a href="#cb35-1115" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1116"><a href="#cb35-1116" aria-hidden="true" tabindex="-1"></a>  `<span class="op">;</span></span>
<span id="cb35-1117"><a href="#cb35-1117" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> $range <span class="op">=</span> <span class="fu">rangeInput</span><span class="op">({</span>min<span class="op">,</span> max<span class="op">,</span> value<span class="op">:</span> <span class="op">[</span>value<span class="op">[</span><span class="dv">0</span><span class="op">],</span> value<span class="op">[</span><span class="dv">1</span><span class="op">]],</span> step<span class="op">,</span> color<span class="op">,</span> width<span class="op">,</span> theme<span class="op">});</span></span>
<span id="cb35-1118"><a href="#cb35-1118" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> $output <span class="op">=</span> html`<span class="op">&lt;</span>output<span class="op">&gt;</span>`<span class="op">;</span></span>
<span id="cb35-1119"><a href="#cb35-1119" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> $view <span class="op">=</span> html`<span class="op">&lt;</span>div id<span class="op">=</span>$<span class="op">{</span>__ns__<span class="op">}&gt;</span></span>
<span id="cb35-1120"><a href="#cb35-1120" aria-hidden="true" tabindex="-1"></a>$<span class="op">{</span>label <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="er">''</span> <span class="op">:</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span><span class="st">"label"</span><span class="op">&gt;</span>$<span class="op">{</span>label<span class="op">}</span>`<span class="op">}</span></span>
<span id="cb35-1121"><a href="#cb35-1121" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span>form<span class="op">&gt;</span></span>
<span id="cb35-1122"><a href="#cb35-1122" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span>range<span class="op">&gt;</span></span>
<span id="cb35-1123"><a href="#cb35-1123" aria-hidden="true" tabindex="-1"></a>    $<span class="op">{</span>$range<span class="op">}&lt;</span>div <span class="kw">class</span><span class="op">=</span>range<span class="op">-</span>output style<span class="op">=</span><span class="st">"display: inline-block;"</span><span class="op">&gt;</span>$<span class="op">{</span>$output<span class="op">}&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb35-1124"><a href="#cb35-1124" aria-hidden="true" tabindex="-1"></a>  <span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb35-1125"><a href="#cb35-1125" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;/</span>div<span class="op">&gt;</span></span>
<span id="cb35-1126"><a href="#cb35-1126" aria-hidden="true" tabindex="-1"></a>$<span class="op">{</span>html`<span class="op">&lt;</span>style<span class="op">&gt;</span>$<span class="op">{</span>css<span class="op">}</span>`<span class="op">}</span></span>
<span id="cb35-1127"><a href="#cb35-1127" aria-hidden="true" tabindex="-1"></a>  `<span class="op">;</span></span>
<span id="cb35-1128"><a href="#cb35-1128" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> update <span class="op">=</span> <span class="op">()</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1129"><a href="#cb35-1129" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> content <span class="op">=</span> <span class="fu">format</span><span class="op">([</span>$range<span class="op">.</span><span class="fu">value</span><span class="op">[</span><span class="dv">0</span><span class="op">],</span> $range<span class="op">.</span><span class="fu">value</span><span class="op">[</span><span class="dv">1</span><span class="op">]]);</span></span>
<span id="cb35-1130"><a href="#cb35-1130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>typeof content <span class="op">===</span> <span class="er">'</span>string<span class="er">'</span><span class="op">)</span> $output<span class="op">.</span><span class="fu">value</span> <span class="op">=</span> content<span class="op">;</span></span>
<span id="cb35-1131"><a href="#cb35-1131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb35-1132"><a href="#cb35-1132" aria-hidden="true" tabindex="-1"></a>      <span class="cf">while</span><span class="op">(</span>$output<span class="op">.</span><span class="fu">lastChild</span><span class="op">)</span> $output<span class="op">.</span><span class="fu">lastChild</span><span class="op">.</span><span class="fu">remove</span><span class="op">();</span></span>
<span id="cb35-1133"><a href="#cb35-1133" aria-hidden="true" tabindex="-1"></a>      $output<span class="op">.</span><span class="fu">appendChild</span><span class="op">(</span>content<span class="op">);</span></span>
<span id="cb35-1134"><a href="#cb35-1134" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-1135"><a href="#cb35-1135" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1136"><a href="#cb35-1136" aria-hidden="true" tabindex="-1"></a>  $range<span class="op">.</span><span class="fu">oninput</span> <span class="op">=</span> update<span class="op">;</span></span>
<span id="cb35-1137"><a href="#cb35-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span><span class="op">();</span></span>
<span id="cb35-1138"><a href="#cb35-1138" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">defineProperty</span><span class="op">(</span>$view<span class="op">,</span> <span class="er">'</span>value<span class="er">'</span><span class="op">,</span> <span class="op">{</span></span>
<span id="cb35-1139"><a href="#cb35-1139" aria-hidden="true" tabindex="-1"></a>    get<span class="op">:</span> <span class="op">()</span> <span class="op">=&gt;</span> $range<span class="op">.</span><span class="fu">value</span><span class="op">,</span></span>
<span id="cb35-1140"><a href="#cb35-1140" aria-hidden="true" tabindex="-1"></a>    set<span class="op">:</span> <span class="op">([</span>a<span class="op">,</span> b<span class="op">])</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1141"><a href="#cb35-1141" aria-hidden="true" tabindex="-1"></a>      $range<span class="op">.</span><span class="fu">value</span> <span class="op">=</span> <span class="op">[</span>a<span class="op">,</span> b<span class="op">];</span></span>
<span id="cb35-1142"><a href="#cb35-1142" aria-hidden="true" tabindex="-1"></a>      <span class="fu">update</span><span class="op">();</span></span>
<span id="cb35-1143"><a href="#cb35-1143" aria-hidden="true" tabindex="-1"></a>    <span class="op">},</span></span>
<span id="cb35-1144"><a href="#cb35-1144" aria-hidden="true" tabindex="-1"></a>  <span class="op">});</span></span>
<span id="cb35-1145"><a href="#cb35-1145" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1146"><a href="#cb35-1146" aria-hidden="true" tabindex="-1"></a>cssLength <span class="op">=</span> v <span class="op">=&gt;</span> v <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> typeof v <span class="op">===</span> <span class="er">'</span>number<span class="er">'</span> <span class="op">?</span> `$<span class="op">{</span>v<span class="op">}</span>px` <span class="op">:</span> `$<span class="op">{</span>v<span class="op">}</span>`</span>
<span id="cb35-1147"><a href="#cb35-1147" aria-hidden="true" tabindex="-1"></a>function <span class="fu">randomScope</span><span class="op">(</span>prefix <span class="op">=</span> <span class="er">'</span>scope<span class="op">-</span><span class="er">'</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1148"><a href="#cb35-1148" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> prefix <span class="op">+</span> <span class="op">(</span>performance<span class="op">.</span><span class="fu">now</span><span class="op">()</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span><span class="op">()).</span><span class="fu">toString</span><span class="op">(</span><span class="dv">32</span><span class="op">).</span><span class="fu">replace</span><span class="op">(</span><span class="ch">'.'</span><span class="op">,</span> <span class="ch">'-'</span><span class="op">);</span></span>
<span id="cb35-1149"><a href="#cb35-1149" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1150"><a href="#cb35-1150" aria-hidden="true" tabindex="-1"></a>function <span class="fu">rangeInput</span><span class="op">(</span>options <span class="op">=</span> <span class="op">{})</span> <span class="op">{</span></span>
<span id="cb35-1151"><a href="#cb35-1151" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> <span class="op">{</span></span>
<span id="cb35-1152"><a href="#cb35-1152" aria-hidden="true" tabindex="-1"></a>    min <span class="op">=</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb35-1153"><a href="#cb35-1153" aria-hidden="true" tabindex="-1"></a>    max <span class="op">=</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb35-1154"><a href="#cb35-1154" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="er">'</span>any<span class="er">'</span><span class="op">,</span></span>
<span id="cb35-1155"><a href="#cb35-1155" aria-hidden="true" tabindex="-1"></a>    value<span class="op">:</span> defaultValue <span class="op">=</span> <span class="op">[</span>min<span class="op">,</span> max<span class="op">],</span></span>
<span id="cb35-1156"><a href="#cb35-1156" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb35-1157"><a href="#cb35-1157" aria-hidden="true" tabindex="-1"></a>    width<span class="op">,</span></span>
<span id="cb35-1158"><a href="#cb35-1158" aria-hidden="true" tabindex="-1"></a>    theme <span class="op">=</span> theme_Flat<span class="op">,</span></span>
<span id="cb35-1159"><a href="#cb35-1159" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="op">=</span> options<span class="op">;</span></span>
<span id="cb35-1160"><a href="#cb35-1160" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> controls <span class="op">=</span> <span class="op">{};</span></span>
<span id="cb35-1161"><a href="#cb35-1161" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> scope <span class="op">=</span> <span class="fu">randomScope</span><span class="op">();</span></span>
<span id="cb35-1162"><a href="#cb35-1162" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> clamp <span class="op">=</span> <span class="op">(</span>a<span class="op">,</span> b<span class="op">,</span> v<span class="op">)</span> <span class="op">=&gt;</span> v <span class="op">&lt;</span> a <span class="op">?</span> a <span class="op">:</span> v <span class="op">&gt;</span> b <span class="op">?</span> b <span class="op">:</span> v<span class="op">;</span></span>
<span id="cb35-1163"><a href="#cb35-1163" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> html <span class="op">=</span> htl<span class="op">.</span><span class="fu">html</span><span class="op">;</span></span>
<span id="cb35-1164"><a href="#cb35-1164" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Will be used to sanitize values while avoiding floating point issues.</span></span>
<span id="cb35-1165"><a href="#cb35-1165" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> input <span class="op">=</span> html`<span class="op">&lt;</span>input type<span class="op">=</span>range $<span class="op">{{</span>min<span class="op">,</span> max<span class="op">,</span> step<span class="op">}}&gt;</span>`<span class="op">;</span></span>
<span id="cb35-1166"><a href="#cb35-1166" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> dom <span class="op">=</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span>$<span class="op">{</span>`$<span class="op">{</span>scope<span class="op">}</span> range<span class="op">-</span>slider`<span class="op">}</span> style<span class="op">=</span>$<span class="op">{{</span></span>
<span id="cb35-1167"><a href="#cb35-1167" aria-hidden="true" tabindex="-1"></a>    color<span class="op">,</span></span>
<span id="cb35-1168"><a href="#cb35-1168" aria-hidden="true" tabindex="-1"></a>    width<span class="op">:</span> <span class="fu">cssLength</span><span class="op">(</span>width<span class="op">),</span></span>
<span id="cb35-1169"><a href="#cb35-1169" aria-hidden="true" tabindex="-1"></a>  <span class="op">}}&gt;</span></span>
<span id="cb35-1170"><a href="#cb35-1170" aria-hidden="true" tabindex="-1"></a>  $<span class="op">{</span>controls<span class="op">.</span><span class="fu">track</span> <span class="op">=</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span><span class="st">"range-track"</span><span class="op">&gt;</span></span>
<span id="cb35-1171"><a href="#cb35-1171" aria-hidden="true" tabindex="-1"></a>    $<span class="op">{</span>controls<span class="op">.</span><span class="fu">zone</span> <span class="op">=</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span><span class="st">"range-track-zone"</span><span class="op">&gt;</span></span>
<span id="cb35-1172"><a href="#cb35-1172" aria-hidden="true" tabindex="-1"></a>      $<span class="op">{</span>controls<span class="op">.</span><span class="fu">range</span> <span class="op">=</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span><span class="st">"range-select"</span> tabindex<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span></span>
<span id="cb35-1173"><a href="#cb35-1173" aria-hidden="true" tabindex="-1"></a>        $<span class="op">{</span>controls<span class="op">.</span><span class="fu">min</span> <span class="op">=</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span><span class="st">"thumb thumb-min"</span> tabindex<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span>`<span class="op">}</span></span>
<span id="cb35-1174"><a href="#cb35-1174" aria-hidden="true" tabindex="-1"></a>        $<span class="op">{</span>controls<span class="op">.</span><span class="fu">max</span> <span class="op">=</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span><span class="st">"thumb thumb-max"</span> tabindex<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span>`<span class="op">}</span></span>
<span id="cb35-1175"><a href="#cb35-1175" aria-hidden="true" tabindex="-1"></a>      `<span class="op">}</span></span>
<span id="cb35-1176"><a href="#cb35-1176" aria-hidden="true" tabindex="-1"></a>    `<span class="op">}</span></span>
<span id="cb35-1177"><a href="#cb35-1177" aria-hidden="true" tabindex="-1"></a>  `<span class="op">}</span></span>
<span id="cb35-1178"><a href="#cb35-1178" aria-hidden="true" tabindex="-1"></a>  $<span class="op">{</span>html`<span class="op">&lt;</span>style<span class="op">&gt;</span>$<span class="op">{</span>theme<span class="op">.</span><span class="fu">replace</span><span class="op">(/:</span>scope\b<span class="op">/</span>g<span class="op">,</span> <span class="ch">'.'</span><span class="op">+</span>scope<span class="op">)}</span>`<span class="op">}</span></span>
<span id="cb35-1179"><a href="#cb35-1179" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;/</span>div<span class="op">&gt;</span>`<span class="op">;</span></span>
<span id="cb35-1180"><a href="#cb35-1180" aria-hidden="true" tabindex="-1"></a>  let value <span class="op">=</span> <span class="op">[],</span> changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb35-1181"><a href="#cb35-1181" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">defineProperty</span><span class="op">(</span>dom<span class="op">,</span> <span class="er">'</span>value<span class="er">'</span><span class="op">,</span> <span class="op">{</span></span>
<span id="cb35-1182"><a href="#cb35-1182" aria-hidden="true" tabindex="-1"></a>    get<span class="op">:</span> <span class="op">()</span> <span class="op">=&gt;</span> <span class="op">[</span><span class="kw">...</span>value<span class="op">],</span></span>
<span id="cb35-1183"><a href="#cb35-1183" aria-hidden="true" tabindex="-1"></a>    set<span class="op">:</span> <span class="op">([</span>a<span class="op">,</span> b<span class="op">])</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1184"><a href="#cb35-1184" aria-hidden="true" tabindex="-1"></a>      value <span class="op">=</span> <span class="fu">sanitize</span><span class="op">(</span>a<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb35-1185"><a href="#cb35-1185" aria-hidden="true" tabindex="-1"></a>      <span class="fu">updateRange</span><span class="op">();</span></span>
<span id="cb35-1186"><a href="#cb35-1186" aria-hidden="true" tabindex="-1"></a>    <span class="op">},</span></span>
<span id="cb35-1187"><a href="#cb35-1187" aria-hidden="true" tabindex="-1"></a>  <span class="op">});</span></span>
<span id="cb35-1188"><a href="#cb35-1188" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> sanitize <span class="op">=</span> <span class="op">(</span>a<span class="op">,</span> b<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1189"><a href="#cb35-1189" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="fu">isNaN</span><span class="op">(</span>a<span class="op">)</span> <span class="op">?</span> min <span class="op">:</span> <span class="op">((</span>input<span class="op">.</span><span class="fu">value</span> <span class="op">=</span> a<span class="op">),</span> input<span class="op">.</span><span class="fu">valueAsNumber</span><span class="op">);</span></span>
<span id="cb35-1190"><a href="#cb35-1190" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="fu">isNaN</span><span class="op">(</span>b<span class="op">)</span> <span class="op">?</span> max <span class="op">:</span> <span class="op">((</span>input<span class="op">.</span><span class="fu">value</span> <span class="op">=</span> b<span class="op">),</span> input<span class="op">.</span><span class="fu">valueAsNumber</span><span class="op">);</span></span>
<span id="cb35-1191"><a href="#cb35-1191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">[</span><span class="bu">Math</span><span class="op">.</span><span class="fu">min</span><span class="op">(</span>a<span class="op">,</span> b<span class="op">),</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span>a<span class="op">,</span> b<span class="op">)];</span></span>
<span id="cb35-1192"><a href="#cb35-1192" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1193"><a href="#cb35-1193" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> updateRange <span class="op">=</span> <span class="op">()</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1194"><a href="#cb35-1194" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> ratio <span class="op">=</span> v <span class="op">=&gt;</span> <span class="op">(</span>v <span class="op">-</span> min<span class="op">)</span> <span class="op">/</span> <span class="op">(</span>max <span class="op">-</span> min<span class="op">);</span></span>
<span id="cb35-1195"><a href="#cb35-1195" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="fu">style</span><span class="op">.</span><span class="fu">setProperty</span><span class="op">(</span><span class="er">'</span><span class="op">--</span>range<span class="op">-</span>min<span class="er">'</span><span class="op">,</span> `$<span class="op">{</span><span class="fu">ratio</span><span class="op">(</span>value<span class="op">[</span><span class="dv">0</span><span class="op">])</span> <span class="op">*</span> <span class="dv">100</span><span class="op">}%</span>`<span class="op">);</span></span>
<span id="cb35-1196"><a href="#cb35-1196" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="fu">style</span><span class="op">.</span><span class="fu">setProperty</span><span class="op">(</span><span class="er">'</span><span class="op">--</span>range<span class="op">-</span>max<span class="er">'</span><span class="op">,</span> `$<span class="op">{</span><span class="fu">ratio</span><span class="op">(</span>value<span class="op">[</span><span class="dv">1</span><span class="op">])</span> <span class="op">*</span> <span class="dv">100</span><span class="op">}%</span>`<span class="op">);</span></span>
<span id="cb35-1197"><a href="#cb35-1197" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1198"><a href="#cb35-1198" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> dispatch <span class="op">=</span> name <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1199"><a href="#cb35-1199" aria-hidden="true" tabindex="-1"></a>    dom<span class="op">.</span><span class="fu">dispatchEvent</span><span class="op">(</span><span class="kw">new</span> <span class="bu">Event</span><span class="op">(</span>name<span class="op">,</span> <span class="op">{</span>bubbles<span class="op">:</span> <span class="kw">true</span><span class="op">}));</span></span>
<span id="cb35-1200"><a href="#cb35-1200" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1201"><a href="#cb35-1201" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> setValue <span class="op">=</span> <span class="op">(</span>vmin<span class="op">,</span> vmax<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1202"><a href="#cb35-1202" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> <span class="op">[</span>pmin<span class="op">,</span> pmax<span class="op">]</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb35-1203"><a href="#cb35-1203" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> <span class="fu">sanitize</span><span class="op">(</span>vmin<span class="op">,</span> vmax<span class="op">);</span></span>
<span id="cb35-1204"><a href="#cb35-1204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateRange</span><span class="op">();</span></span>
<span id="cb35-1205"><a href="#cb35-1205" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Only dispatch if values have changed.</span></span>
<span id="cb35-1206"><a href="#cb35-1206" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>pmin <span class="op">===</span> value<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">&amp;&amp;</span> pmax <span class="op">===</span> value<span class="op">[</span><span class="dv">1</span><span class="op">])</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb35-1207"><a href="#cb35-1207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispatch</span><span class="op">(</span><span class="er">'</span>input<span class="er">'</span><span class="op">);</span></span>
<span id="cb35-1208"><a href="#cb35-1208" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb35-1209"><a href="#cb35-1209" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1210"><a href="#cb35-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setValue</span><span class="op">(</span><span class="kw">...</span>defaultValue<span class="op">);</span></span>
<span id="cb35-1211"><a href="#cb35-1211" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Mousemove handlers.</span></span>
<span id="cb35-1212"><a href="#cb35-1212" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> handlers <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span><span class="op">([</span></span>
<span id="cb35-1213"><a href="#cb35-1213" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>controls<span class="op">.</span><span class="fu">min</span><span class="op">,</span> <span class="op">(</span>dt<span class="op">,</span> ov<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1214"><a href="#cb35-1214" aria-hidden="true" tabindex="-1"></a>      <span class="dt">const</span> v <span class="op">=</span> <span class="fu">clamp</span><span class="op">(</span>min<span class="op">,</span> ov<span class="op">[</span><span class="dv">1</span><span class="op">],</span> ov<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> dt <span class="op">*</span> <span class="op">(</span>max <span class="op">-</span> min<span class="op">));</span></span>
<span id="cb35-1215"><a href="#cb35-1215" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span><span class="op">(</span>v<span class="op">,</span> ov<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb35-1216"><a href="#cb35-1216" aria-hidden="true" tabindex="-1"></a>    <span class="op">}],</span></span>
<span id="cb35-1217"><a href="#cb35-1217" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>controls<span class="op">.</span><span class="fu">max</span><span class="op">,</span> <span class="op">(</span>dt<span class="op">,</span> ov<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1218"><a href="#cb35-1218" aria-hidden="true" tabindex="-1"></a>      <span class="dt">const</span> v <span class="op">=</span> <span class="fu">clamp</span><span class="op">(</span>ov<span class="op">[</span><span class="dv">0</span><span class="op">],</span> max<span class="op">,</span> ov<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> dt <span class="op">*</span> <span class="op">(</span>max <span class="op">-</span> min<span class="op">));</span></span>
<span id="cb35-1219"><a href="#cb35-1219" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span><span class="op">(</span>ov<span class="op">[</span><span class="dv">0</span><span class="op">],</span> v<span class="op">);</span></span>
<span id="cb35-1220"><a href="#cb35-1220" aria-hidden="true" tabindex="-1"></a>    <span class="op">}],</span></span>
<span id="cb35-1221"><a href="#cb35-1221" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>controls<span class="op">.</span><span class="fu">range</span><span class="op">,</span> <span class="op">(</span>dt<span class="op">,</span> ov<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1222"><a href="#cb35-1222" aria-hidden="true" tabindex="-1"></a>      <span class="dt">const</span> d <span class="op">=</span> ov<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">-</span> ov<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb35-1223"><a href="#cb35-1223" aria-hidden="true" tabindex="-1"></a>      <span class="dt">const</span> v <span class="op">=</span> <span class="fu">clamp</span><span class="op">(</span>min<span class="op">,</span> max <span class="op">-</span> d<span class="op">,</span> ov<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> dt <span class="op">*</span> <span class="op">(</span>max <span class="op">-</span> min<span class="op">));</span></span>
<span id="cb35-1224"><a href="#cb35-1224" aria-hidden="true" tabindex="-1"></a>      <span class="fu">setValue</span><span class="op">(</span>v<span class="op">,</span> v <span class="op">+</span> d<span class="op">);</span></span>
<span id="cb35-1225"><a href="#cb35-1225" aria-hidden="true" tabindex="-1"></a>    <span class="op">}],</span></span>
<span id="cb35-1226"><a href="#cb35-1226" aria-hidden="true" tabindex="-1"></a>  <span class="op">]);</span></span>
<span id="cb35-1227"><a href="#cb35-1227" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Returns client offset object.</span></span>
<span id="cb35-1228"><a href="#cb35-1228" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> pointer <span class="op">=</span> e <span class="op">=&gt;</span> e<span class="op">.</span><span class="fu">touches</span> <span class="op">?</span> e<span class="op">.</span><span class="fu">touches</span><span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">:</span> e<span class="op">;</span></span>
<span id="cb35-1229"><a href="#cb35-1229" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Note: Chrome defaults "passive" for touch events to true.</span></span>
<span id="cb35-1230"><a href="#cb35-1230" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> on  <span class="op">=</span> <span class="op">(</span>e<span class="op">,</span> fn<span class="op">)</span> <span class="op">=&gt;</span> e<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="ch">' '</span><span class="op">).</span><span class="fu">map</span><span class="op">(</span>e <span class="op">=&gt;</span> document<span class="op">.</span><span class="fu">addEventListener</span><span class="op">(</span>e<span class="op">,</span> fn<span class="op">,</span> <span class="op">{</span>passive<span class="op">:</span> <span class="kw">false</span><span class="op">}));</span></span>
<span id="cb35-1231"><a href="#cb35-1231" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> off <span class="op">=</span> <span class="op">(</span>e<span class="op">,</span> fn<span class="op">)</span> <span class="op">=&gt;</span> e<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="ch">' '</span><span class="op">).</span><span class="fu">map</span><span class="op">(</span>e <span class="op">=&gt;</span> document<span class="op">.</span><span class="fu">removeEventListener</span><span class="op">(</span>e<span class="op">,</span> fn<span class="op">,</span> <span class="op">{</span>passive<span class="op">:</span> <span class="kw">false</span><span class="op">}));</span></span>
<span id="cb35-1232"><a href="#cb35-1232" aria-hidden="true" tabindex="-1"></a>  let initialX<span class="op">,</span> initialV<span class="op">,</span> target<span class="op">,</span> dragging <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb35-1233"><a href="#cb35-1233" aria-hidden="true" tabindex="-1"></a>  function <span class="fu">handleDrag</span><span class="op">(</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1234"><a href="#cb35-1234" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Gracefully handle exit and reentry of the viewport.</span></span>
<span id="cb35-1235"><a href="#cb35-1235" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>e<span class="op">.</span><span class="fu">buttons</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>e<span class="op">.</span><span class="fu">touches</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1236"><a href="#cb35-1236" aria-hidden="true" tabindex="-1"></a>      <span class="fu">handleDragStop</span><span class="op">();</span></span>
<span id="cb35-1237"><a href="#cb35-1237" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb35-1238"><a href="#cb35-1238" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-1239"><a href="#cb35-1239" aria-hidden="true" tabindex="-1"></a>    dragging <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb35-1240"><a href="#cb35-1240" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> w <span class="op">=</span> controls<span class="op">.</span><span class="fu">zone</span><span class="op">.</span><span class="fu">getBoundingClientRect</span><span class="op">().</span><span class="fu">width</span><span class="op">;</span></span>
<span id="cb35-1241"><a href="#cb35-1241" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">preventDefault</span><span class="op">();</span></span>
<span id="cb35-1242"><a href="#cb35-1242" aria-hidden="true" tabindex="-1"></a>    handlers<span class="op">.</span><span class="fu">get</span><span class="op">(</span>target<span class="op">)((</span><span class="fu">pointer</span><span class="op">(</span>e<span class="op">).</span><span class="fu">clientX</span> <span class="op">-</span> initialX<span class="op">)</span> <span class="op">/</span> w<span class="op">,</span> initialV<span class="op">);</span></span>
<span id="cb35-1243"><a href="#cb35-1243" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1244"><a href="#cb35-1244" aria-hidden="true" tabindex="-1"></a>  function <span class="fu">handleDragStop</span><span class="op">(</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1245"><a href="#cb35-1245" aria-hidden="true" tabindex="-1"></a>    <span class="fu">off</span><span class="op">(</span><span class="er">'</span>mousemove touchmove<span class="er">'</span><span class="op">,</span> handleDrag<span class="op">);</span></span>
<span id="cb35-1246"><a href="#cb35-1246" aria-hidden="true" tabindex="-1"></a>    <span class="fu">off</span><span class="op">(</span><span class="er">'</span>mouseup touchend<span class="er">'</span><span class="op">,</span> handleDragStop<span class="op">);</span></span>
<span id="cb35-1247"><a href="#cb35-1247" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>changed<span class="op">)</span> <span class="fu">dispatch</span><span class="op">(</span><span class="er">'</span>change<span class="er">'</span><span class="op">);</span></span>
<span id="cb35-1248"><a href="#cb35-1248" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1249"><a href="#cb35-1249" aria-hidden="true" tabindex="-1"></a>  invalidation<span class="op">.</span><span class="fu">then</span><span class="op">(</span>handleDragStop<span class="op">);</span></span>
<span id="cb35-1250"><a href="#cb35-1250" aria-hidden="true" tabindex="-1"></a>  dom<span class="op">.</span><span class="fu">ontouchstart</span> <span class="op">=</span> dom<span class="op">.</span><span class="fu">onmousedown</span> <span class="op">=</span> e <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1251"><a href="#cb35-1251" aria-hidden="true" tabindex="-1"></a>    dragging <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb35-1252"><a href="#cb35-1252" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb35-1253"><a href="#cb35-1253" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(!</span>handlers<span class="op">.</span><span class="fu">has</span><span class="op">(</span>e<span class="op">.</span><span class="fu">target</span><span class="op">))</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb35-1254"><a href="#cb35-1254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on</span><span class="op">(</span><span class="er">'</span>mousemove touchmove<span class="er">'</span><span class="op">,</span> handleDrag<span class="op">);</span></span>
<span id="cb35-1255"><a href="#cb35-1255" aria-hidden="true" tabindex="-1"></a>    <span class="fu">on</span><span class="op">(</span><span class="er">'</span>mouseup touchend<span class="er">'</span><span class="op">,</span> handleDragStop<span class="op">);</span></span>
<span id="cb35-1256"><a href="#cb35-1256" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">preventDefault</span><span class="op">();</span></span>
<span id="cb35-1257"><a href="#cb35-1257" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">stopPropagation</span><span class="op">();</span></span>
<span id="cb35-1258"><a href="#cb35-1258" aria-hidden="true" tabindex="-1"></a>    target <span class="op">=</span> e<span class="op">.</span><span class="fu">target</span><span class="op">;</span></span>
<span id="cb35-1259"><a href="#cb35-1259" aria-hidden="true" tabindex="-1"></a>    initialX <span class="op">=</span> <span class="fu">pointer</span><span class="op">(</span>e<span class="op">).</span><span class="fu">clientX</span><span class="op">;</span></span>
<span id="cb35-1260"><a href="#cb35-1260" aria-hidden="true" tabindex="-1"></a>    initialV <span class="op">=</span> value<span class="op">.</span><span class="fu">slice</span><span class="op">();</span></span>
<span id="cb35-1261"><a href="#cb35-1261" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1262"><a href="#cb35-1262" aria-hidden="true" tabindex="-1"></a>  controls<span class="op">.</span><span class="fu">track</span><span class="op">.</span><span class="fu">onclick</span> <span class="op">=</span> e <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1263"><a href="#cb35-1263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>dragging<span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb35-1264"><a href="#cb35-1264" aria-hidden="true" tabindex="-1"></a>    changed <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb35-1265"><a href="#cb35-1265" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> r <span class="op">=</span> controls<span class="op">.</span><span class="fu">zone</span><span class="op">.</span><span class="fu">getBoundingClientRect</span><span class="op">();</span></span>
<span id="cb35-1266"><a href="#cb35-1266" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> t <span class="op">=</span> <span class="fu">clamp</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="fu">pointer</span><span class="op">(</span>e<span class="op">).</span><span class="fu">clientX</span> <span class="op">-</span> r<span class="op">.</span><span class="fu">left</span><span class="op">)</span> <span class="op">/</span> r<span class="op">.</span><span class="fu">width</span><span class="op">);</span></span>
<span id="cb35-1267"><a href="#cb35-1267" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> v <span class="op">=</span> min <span class="op">+</span> t <span class="op">*</span> <span class="op">(</span>max <span class="op">-</span> min<span class="op">);</span></span>
<span id="cb35-1268"><a href="#cb35-1268" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> <span class="op">[</span>vmin<span class="op">,</span> vmax<span class="op">]</span> <span class="op">=</span> value<span class="op">,</span> d <span class="op">=</span> vmax <span class="op">-</span> vmin<span class="op">;</span></span>
<span id="cb35-1269"><a href="#cb35-1269" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>v <span class="op">&lt;</span> vmin<span class="op">)</span> <span class="fu">setValue</span><span class="op">(</span>v<span class="op">,</span> v <span class="op">+</span> d<span class="op">);</span></span>
<span id="cb35-1270"><a href="#cb35-1270" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>v <span class="op">&gt;</span> vmax<span class="op">)</span> <span class="fu">setValue</span><span class="op">(</span>v <span class="op">-</span> d<span class="op">,</span> v<span class="op">);</span></span>
<span id="cb35-1271"><a href="#cb35-1271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>changed<span class="op">)</span> <span class="fu">dispatch</span><span class="op">(</span><span class="er">'</span>change<span class="er">'</span><span class="op">);</span></span>
<span id="cb35-1272"><a href="#cb35-1272" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1273"><a href="#cb35-1273" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dom<span class="op">;</span></span>
<span id="cb35-1274"><a href="#cb35-1274" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1275"><a href="#cb35-1275" aria-hidden="true" tabindex="-1"></a>function <span class="fu">formatDecimal</span><span class="op">(</span>number<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1276"><a href="#cb35-1276" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> number <span class="op">==</span> <span class="dv">1</span> <span class="op">?</span> number <span class="op">:</span> <span class="op">(</span><span class="bu">Math</span><span class="op">.</span><span class="fu">round</span><span class="op">(</span>number <span class="op">*</span> <span class="dv">100</span><span class="op">)</span> <span class="op">/</span> <span class="dv">100</span><span class="op">).</span><span class="fu">toString</span><span class="op">().</span><span class="fu">slice</span><span class="op">(</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb35-1277"><a href="#cb35-1277" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1278"><a href="#cb35-1278" aria-hidden="true" tabindex="-1"></a>button <span class="op">=</span> <span class="op">(</span>data<span class="op">,</span> filename <span class="op">=</span> <span class="er">'</span>data<span class="op">.</span><span class="fu">csv</span><span class="er">'</span><span class="op">)</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1279"><a href="#cb35-1279" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(!</span>data<span class="op">)</span> <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span><span class="op">(</span><span class="er">'</span>Array of data required as first argument<span class="er">'</span><span class="op">);</span></span>
<span id="cb35-1280"><a href="#cb35-1280" aria-hidden="true" tabindex="-1"></a>  let downloadData<span class="op">;</span></span>
<span id="cb35-1281"><a href="#cb35-1281" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>filename<span class="op">.</span><span class="fu">includes</span><span class="op">(</span><span class="er">'</span><span class="op">.</span><span class="fu">csv</span><span class="er">'</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb35-1282"><a href="#cb35-1282" aria-hidden="true" tabindex="-1"></a>    downloadData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span><span class="op">([</span>d3<span class="op">.</span><span class="fu">csvFormat</span><span class="op">(</span>data<span class="op">)],</span> <span class="op">{</span> type<span class="op">:</span> <span class="st">"text/csv"</span> <span class="op">});</span></span>
<span id="cb35-1283"><a href="#cb35-1283" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb35-1284"><a href="#cb35-1284" aria-hidden="true" tabindex="-1"></a>    downloadData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span><span class="op">([</span>JSON<span class="op">.</span><span class="fu">stringify</span><span class="op">(</span>data<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span><span class="op">)],</span> <span class="op">{</span></span>
<span id="cb35-1285"><a href="#cb35-1285" aria-hidden="true" tabindex="-1"></a>      type<span class="op">:</span> <span class="st">"application/json"</span></span>
<span id="cb35-1286"><a href="#cb35-1286" aria-hidden="true" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb35-1287"><a href="#cb35-1287" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1288"><a href="#cb35-1288" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> DOM<span class="op">.</span><span class="fu">download</span><span class="op">(</span></span>
<span id="cb35-1289"><a href="#cb35-1289" aria-hidden="true" tabindex="-1"></a>    downloadData<span class="op">,</span></span>
<span id="cb35-1290"><a href="#cb35-1290" aria-hidden="true" tabindex="-1"></a>    filename<span class="op">,</span></span>
<span id="cb35-1291"><a href="#cb35-1291" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Download"</span></span>
<span id="cb35-1292"><a href="#cb35-1292" aria-hidden="true" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb35-1293"><a href="#cb35-1293" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1294"><a href="#cb35-1294" aria-hidden="true" tabindex="-1"></a>function <span class="fu">invert</span><span class="op">(</span>arr<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1295"><a href="#cb35-1295" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> invertDotd <span class="op">?</span> <span class="op">[</span><span class="kw">...</span><span class="bu">Array</span><span class="op">(</span><span class="dv">10</span><span class="op">).</span><span class="fu">keys</span><span class="op">()].</span><span class="fu">map</span><span class="op">(</span>n <span class="op">=&gt;</span> <span class="op">!</span>arr<span class="op">.</span><span class="fu">includes</span><span class="op">(</span>n<span class="op">)).</span><span class="fu">map</span><span class="op">((</span>x<span class="op">,</span> i<span class="op">)</span> <span class="op">=&gt;</span> x <span class="op">?</span> i <span class="op">:</span> <span class="kw">null</span><span class="op">).</span><span class="fu">filter</span><span class="op">(</span>i <span class="op">=&gt;</span> i <span class="op">!==</span> <span class="kw">null</span><span class="op">)</span> <span class="op">:</span> arr</span>
<span id="cb35-1296"><a href="#cb35-1296" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1297"><a href="#cb35-1297" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb35-1298"><a href="#cb35-1298" aria-hidden="true" tabindex="-1"></a>function <span class="fu">toggleSwitch</span><span class="op">(</span>options <span class="op">=</span> <span class="op">{</span> textOn<span class="op">:</span> <span class="er">'</span>True<span class="er">'</span><span class="op">,</span> textOff<span class="op">:</span> <span class="er">'</span>False<span class="er">'</span> <span class="op">})</span> <span class="op">{</span></span>
<span id="cb35-1299"><a href="#cb35-1299" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> button <span class="op">=</span> html`<span class="op">&lt;</span>div <span class="kw">class</span><span class="op">=</span><span class="st">"button-switch""&gt;&lt;/div&gt;`;</span></span>
<span id="cb35-1300"><a href="#cb35-1300" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="fu">innerText</span> <span class="op">=</span> options<span class="op">.</span><span class="fu">textOn</span><span class="op">;</span></span>
<span id="cb35-1301"><a href="#cb35-1301" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="fu">value</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb35-1302"><a href="#cb35-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1303"><a href="#cb35-1303" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="fu">onclick</span> <span class="op">=</span> <span class="op">()</span> <span class="op">=&gt;</span> <span class="op">{</span></span>
<span id="cb35-1304"><a href="#cb35-1304" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="fu">value</span> <span class="op">=</span> <span class="op">!</span>button<span class="op">.</span><span class="fu">value</span><span class="op">;</span></span>
<span id="cb35-1305"><a href="#cb35-1305" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="fu">innerText</span> <span class="op">=</span> button<span class="op">.</span><span class="fu">value</span> <span class="op">?</span> options<span class="op">.</span><span class="fu">textOn</span> <span class="op">:</span> options<span class="op">.</span><span class="fu">textOff</span><span class="op">;</span></span>
<span id="cb35-1306"><a href="#cb35-1306" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="fu">dispatchEvent</span><span class="op">(</span><span class="kw">new</span> <span class="fu">CustomEvent</span><span class="op">(</span><span class="st">"input"</span><span class="op">));</span></span>
<span id="cb35-1307"><a href="#cb35-1307" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1308"><a href="#cb35-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1309"><a href="#cb35-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addButtonStyle</span><span class="op">()</span></span>
<span id="cb35-1310"><a href="#cb35-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1311"><a href="#cb35-1311" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> button<span class="op">;</span></span>
<span id="cb35-1312"><a href="#cb35-1312" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1313"><a href="#cb35-1313" aria-hidden="true" tabindex="-1"></a><span class="co">// https://observablehq.com/@chrispahm/toggle-switch-input-button</span></span>
<span id="cb35-1314"><a href="#cb35-1314" aria-hidden="true" tabindex="-1"></a>function <span class="fu">addButtonStyle</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb35-1315"><a href="#cb35-1315" aria-hidden="true" tabindex="-1"></a>  <span class="dt">var</span> el <span class="op">=</span> document<span class="op">.</span><span class="fu">createElement</span><span class="op">(</span><span class="er">'</span>style<span class="er">'</span><span class="op">);</span></span>
<span id="cb35-1316"><a href="#cb35-1316" aria-hidden="true" tabindex="-1"></a>  el<span class="op">.</span><span class="fu">setAttribute</span><span class="op">(</span><span class="er">'</span>type<span class="er">'</span><span class="op">,</span> <span class="er">'</span>text<span class="op">/</span>css<span class="er">'</span><span class="op">);</span></span>
<span id="cb35-1317"><a href="#cb35-1317" aria-hidden="true" tabindex="-1"></a>  document<span class="op">.</span><span class="fu">head</span><span class="op">.</span><span class="fu">appendChild</span><span class="op">(</span>el<span class="op">);</span></span>
<span id="cb35-1318"><a href="#cb35-1318" aria-hidden="true" tabindex="-1"></a>  <span class="dt">var</span> sheet <span class="op">=</span> el<span class="op">.</span><span class="fu">sheet</span><span class="op">;</span></span>
<span id="cb35-1319"><a href="#cb35-1319" aria-hidden="true" tabindex="-1"></a>  function <span class="fu">addRule</span><span class="op">(</span>rule<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1320"><a href="#cb35-1320" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb35-1321"><a href="#cb35-1321" aria-hidden="true" tabindex="-1"></a>      sheet<span class="op">.</span><span class="fu">insertRule</span><span class="op">(</span>rule<span class="op">,</span> sheet<span class="op">.</span><span class="fu">cssRules</span><span class="op">.</span><span class="fu">length</span><span class="op">);</span></span>
<span id="cb35-1322"><a href="#cb35-1322" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span>e<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1323"><a href="#cb35-1323" aria-hidden="true" tabindex="-1"></a>      console<span class="op">.</span><span class="fu">warn</span><span class="op">(</span><span class="er">'</span>Error inserting rule<span class="er">'</span><span class="op">,</span> rule<span class="op">,</span> e<span class="op">);</span></span>
<span id="cb35-1324"><a href="#cb35-1324" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-1325"><a href="#cb35-1325" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1326"><a href="#cb35-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span><span class="op">(</span></span>
<span id="cb35-1327"><a href="#cb35-1327" aria-hidden="true" tabindex="-1"></a>    <span class="er">'</span><span class="op">.</span><span class="fu">button</span><span class="op">-</span><span class="cf">switch</span> <span class="op">{</span> <span class="op">-</span>webkit<span class="op">-</span>touch<span class="op">-</span>callout<span class="op">:</span> none<span class="op">;-</span>webkit<span class="op">-</span>user<span class="op">-</span>select<span class="op">:</span> none<span class="op">;-</span>khtml<span class="op">-</span>user<span class="op">-</span>select<span class="op">:</span> none<span class="op">;-</span>moz<span class="op">-</span>user<span class="op">-</span>select<span class="op">:</span> none<span class="op">;-</span>ms<span class="op">-</span>user<span class="op">-</span>select<span class="op">:</span> none<span class="op">;</span>user<span class="op">-</span>select<span class="op">:</span> none<span class="op">;</span>display<span class="op">:</span> inline<span class="op">-</span>block<span class="op">;-</span>webkit<span class="op">-</span>border<span class="op">-</span>radius<span class="op">:</span> <span class="er">2</span>px<span class="op">;-</span>moz<span class="op">-</span>border<span class="op">-</span>radius<span class="op">:</span> <span class="er">2</span>px<span class="op">;</span>border<span class="op">-</span>radius<span class="op">:</span> <span class="er">2</span>px<span class="op">;</span>background<span class="op">-</span>color<span class="op">:</span> #EFEFEF<span class="op">;</span>padding<span class="op">:</span> <span class="er">0</span>px <span class="er">7</span>px <span class="er">0</span>px <span class="er">7</span>px<span class="op">;</span>text<span class="op">-</span>align<span class="op">:</span> center<span class="op">;</span>border<span class="op">:</span> <span class="er">1</span>px solid grey<span class="op">;</span>width<span class="op">:</span> auto<span class="op">;</span>color<span class="op">:</span> #<span class="er">1</span>c1c1c<span class="op">;</span>font<span class="op">-</span>size<span class="op">:</span> <span class="er">14</span>px<span class="op">;</span>font<span class="op">-</span>family<span class="op">:</span> sans<span class="op">-</span>serif<span class="op">;</span>text<span class="op">-</span>decoration<span class="op">:</span> none<span class="op">;</span> <span class="op">}</span><span class="er">'</span></span>
<span id="cb35-1328"><a href="#cb35-1328" aria-hidden="true" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb35-1329"><a href="#cb35-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span><span class="op">(</span></span>
<span id="cb35-1330"><a href="#cb35-1330" aria-hidden="true" tabindex="-1"></a>    <span class="er">'</span><span class="op">.</span><span class="fu">button</span><span class="op">-</span><span class="cf">switch</span><span class="op">:</span>hover <span class="op">{</span> background<span class="op">-</span>color<span class="op">:</span> #E5E5E5<span class="op">;</span>border<span class="op">:</span> <span class="er">1</span>px solid #<span class="dv">454545</span><span class="op">;</span> <span class="op">}</span><span class="er">'</span></span>
<span id="cb35-1331"><a href="#cb35-1331" aria-hidden="true" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb35-1332"><a href="#cb35-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addRule</span><span class="op">(</span></span>
<span id="cb35-1333"><a href="#cb35-1333" aria-hidden="true" tabindex="-1"></a>    <span class="er">'</span><span class="op">.</span><span class="fu">button</span><span class="op">-</span><span class="cf">switch</span><span class="op">:</span>active <span class="op">{</span> background<span class="op">-</span>color<span class="op">:</span> #f5f5f5<span class="op">;</span>border<span class="op">:</span> <span class="er">1</span>px solid grey<span class="op">;</span> <span class="op">}</span><span class="er">'</span></span>
<span id="cb35-1334"><a href="#cb35-1334" aria-hidden="true" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb35-1335"><a href="#cb35-1335" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1336"><a href="#cb35-1336" aria-hidden="true" tabindex="-1"></a>function <span class="fu">setSpreadDotd</span><span class="op">(</span>dotd<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1337"><a href="#cb35-1337" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> dotdLength <span class="op">=</span> dotd<span class="op">.</span><span class="fu">length</span><span class="op">;</span></span>
<span id="cb35-1338"><a href="#cb35-1338" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>dotdLength <span class="op">===</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span><span class="cf">return</span> <span class="st">"&gt;"</span><span class="op">}</span></span>
<span id="cb35-1339"><a href="#cb35-1339" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>dotdLength <span class="op">===</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span><span class="cf">return</span> <span class="st">"&gt;0"</span><span class="op">}</span></span>
<span id="cb35-1340"><a href="#cb35-1340" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>dotdLength <span class="op">===</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span><span class="cf">return</span> `$<span class="op">{</span>dotd<span class="op">[</span><span class="dv">0</span><span class="op">]}&gt;&gt;</span><span class="dv">1</span><span class="op">&gt;</span><span class="dv">9</span>`<span class="op">}</span></span>
<span id="cb35-1341"><a href="#cb35-1341" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> steps <span class="op">=</span> dotd<span class="op">.</span><span class="fu">map</span><span class="op">((</span>x<span class="op">,</span> i<span class="op">)</span> <span class="op">=&gt;</span> dotd<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> x<span class="op">)</span></span>
<span id="cb35-1342"><a href="#cb35-1342" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span><span class="op">(</span>i <span class="op">=&gt;</span> <span class="op">!</span><span class="fu">isNaN</span><span class="op">(</span>i<span class="op">)),</span></span>
<span id="cb35-1343"><a href="#cb35-1343" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="op">[];</span></span>
<span id="cb35-1344"><a href="#cb35-1344" aria-hidden="true" tabindex="-1"></a>  let split <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-1345"><a href="#cb35-1345" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">const</span> step of steps<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1346"><a href="#cb35-1346" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>step <span class="op">!==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1347"><a href="#cb35-1347" aria-hidden="true" tabindex="-1"></a>       result<span class="op">.</span><span class="fu">push</span><span class="op">([</span>split<span class="op">,</span> step <span class="op">-</span> <span class="dv">1</span><span class="op">])</span></span>
<span id="cb35-1348"><a href="#cb35-1348" aria-hidden="true" tabindex="-1"></a>       split <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb35-1349"><a href="#cb35-1349" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb35-1350"><a href="#cb35-1350" aria-hidden="true" tabindex="-1"></a>      split <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb35-1351"><a href="#cb35-1351" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-1352"><a href="#cb35-1352" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1353"><a href="#cb35-1353" aria-hidden="true" tabindex="-1"></a>  result<span class="op">.</span><span class="fu">push</span><span class="op">(</span>split<span class="op">)</span></span>
<span id="cb35-1354"><a href="#cb35-1354" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> flat <span class="op">=</span> <span class="op">[].</span><span class="fu">concat</span><span class="op">(</span><span class="kw">...</span>result<span class="op">),</span></span>
<span id="cb35-1355"><a href="#cb35-1355" aria-hidden="true" tabindex="-1"></a>    resultSum <span class="op">=</span> flat<span class="op">.</span><span class="fu">reduce</span><span class="op">((</span>a<span class="op">,</span> b<span class="op">)</span> <span class="op">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span><span class="op">),</span></span>
<span id="cb35-1356"><a href="#cb35-1356" aria-hidden="true" tabindex="-1"></a>    uniq <span class="op">=</span> <span class="op">[</span><span class="kw">...new</span> <span class="bu">Set</span><span class="op">(</span>flat<span class="op">)];</span></span>
<span id="cb35-1357"><a href="#cb35-1357" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="op">[</span>dotd<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">?</span> dotd<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">null</span><span class="op">].</span><span class="fu">concat</span><span class="op">(</span>JSON<span class="op">.</span><span class="fu">stringify</span><span class="op">(</span>uniq<span class="op">)</span> <span class="op">===</span> <span class="st">"[1]"</span> <span class="op">?</span> <span class="op">[</span><span class="kw">null</span><span class="op">,</span> <span class="dv">1</span><span class="op">]</span> <span class="op">:</span> uniq<span class="op">.</span><span class="fu">length</span> <span class="op">===</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> uniq<span class="op">.</span><span class="fu">reduce</span><span class="op">((</span>a<span class="op">,</span> b<span class="op">)</span> <span class="op">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">===</span> <span class="dv">5</span> <span class="op">?</span> uniq <span class="op">:</span> flat<span class="op">.</span><span class="fu">concat</span><span class="op">(</span><span class="dv">10</span> <span class="op">-</span> resultSum<span class="op">).</span><span class="fu">map</span><span class="op">((</span>x<span class="op">,</span> i<span class="op">)</span> <span class="op">=&gt;</span> i <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> x <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> x<span class="op">)).</span><span class="fu">join</span><span class="op">(</span><span class="st">"&gt;"</span><span class="op">)</span></span>
<span id="cb35-1358"><a href="#cb35-1358" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1359"><a href="#cb35-1359" aria-hidden="true" tabindex="-1"></a>function <span class="fu">setSliceDotd</span><span class="op">(</span>dotd<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1360"><a href="#cb35-1360" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> dotdLength <span class="op">=</span> dotd<span class="op">.</span><span class="fu">length</span><span class="op">;</span></span>
<span id="cb35-1361"><a href="#cb35-1361" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>dotdLength <span class="op">===</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span><span class="cf">return</span> <span class="st">":"</span><span class="op">}</span></span>
<span id="cb35-1362"><a href="#cb35-1362" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>dotdLength <span class="op">===</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span><span class="cf">return</span> <span class="st">":0"</span><span class="op">}</span></span>
<span id="cb35-1363"><a href="#cb35-1363" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> steps <span class="op">=</span> dotd<span class="op">.</span><span class="fu">map</span><span class="op">((</span>x<span class="op">,</span> i<span class="op">)</span> <span class="op">=&gt;</span> dotd<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> x<span class="op">)</span></span>
<span id="cb35-1364"><a href="#cb35-1364" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span><span class="op">(</span>i <span class="op">=&gt;</span> <span class="op">!</span><span class="fu">isNaN</span><span class="op">(</span>i<span class="op">)),</span></span>
<span id="cb35-1365"><a href="#cb35-1365" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">=</span> steps<span class="op">.</span><span class="fu">reduce</span><span class="op">((</span>a<span class="op">,</span> b<span class="op">)</span> <span class="op">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span><span class="op">),</span></span>
<span id="cb35-1366"><a href="#cb35-1366" aria-hidden="true" tabindex="-1"></a>    uniq <span class="op">=</span> <span class="op">[</span><span class="kw">...new</span> <span class="bu">Set</span><span class="op">(</span>steps<span class="op">.</span><span class="fu">concat</span><span class="op">(</span><span class="dv">10</span> <span class="op">-</span> stepSum<span class="op">))];</span></span>
<span id="cb35-1367"><a href="#cb35-1367" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="op">[</span>dotd<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">?</span> dotd<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">null</span><span class="op">].</span><span class="fu">concat</span><span class="op">(</span>uniq<span class="op">.</span><span class="fu">length</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> uniq <span class="op">:</span> JSON<span class="op">.</span><span class="fu">stringify</span><span class="op">(</span>steps<span class="op">)</span> <span class="op">===</span> <span class="st">"[1,4,1]"</span> <span class="op">?</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">4</span><span class="op">]</span> <span class="op">:</span> JSON<span class="op">.</span><span class="fu">stringify</span><span class="op">(</span>steps<span class="op">)</span> <span class="op">===</span> <span class="st">"[1,1,3,1,1]"</span> <span class="op">?</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">]</span> <span class="op">:</span> JSON<span class="op">.</span><span class="fu">stringify</span><span class="op">(</span>steps<span class="op">)</span> <span class="op">===</span> <span class="st">"[1,1,1,2,1,1,1]"</span> <span class="op">?</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">]</span> <span class="op">:</span> steps<span class="op">.</span><span class="fu">concat</span><span class="op">(</span><span class="dv">10</span> <span class="op">-</span> stepSum<span class="op">).</span><span class="fu">map</span><span class="op">(</span>x <span class="op">=&gt;</span> x <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> x<span class="op">)).</span><span class="fu">join</span><span class="op">(</span><span class="st">":"</span><span class="op">);</span></span>
<span id="cb35-1368"><a href="#cb35-1368" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1369"><a href="#cb35-1369" aria-hidden="true" tabindex="-1"></a>function <span class="fu">encodeSlice</span><span class="op">(</span><span class="kw">...</span>args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1370"><a href="#cb35-1370" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> args<span class="op">.</span><span class="fu">join</span><span class="op">().</span><span class="fu">replaceAll</span><span class="op">(</span><span class="st">","</span><span class="op">,</span> <span class="st">":"</span><span class="op">)</span></span>
<span id="cb35-1371"><a href="#cb35-1371" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1372"><a href="#cb35-1372" aria-hidden="true" tabindex="-1"></a>function <span class="fu">decodeSlice</span><span class="op">(</span>s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1373"><a href="#cb35-1373" aria-hidden="true" tabindex="-1"></a>  let <span class="op">[</span>start<span class="op">,</span> stop<span class="op">,</span> <span class="kw">...</span>steps<span class="op">]</span> <span class="op">=</span> s<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="st">":"</span><span class="op">).</span><span class="fu">map</span><span class="op">(</span>i <span class="op">=&gt;</span> i <span class="op">===</span> <span class="st">""</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span><span class="op">(</span>i<span class="op">))</span></span>
<span id="cb35-1374"><a href="#cb35-1374" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> step <span class="op">=</span> steps<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span><span class="op">:</span> steps<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb35-1375"><a href="#cb35-1375" aria-hidden="true" tabindex="-1"></a>  start <span class="op">=</span> start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">365</span> <span class="op">:</span> start<span class="op">;</span></span>
<span id="cb35-1376"><a href="#cb35-1376" aria-hidden="true" tabindex="-1"></a>  stop <span class="op">=</span> stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> step <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">366</span> <span class="op">:</span> stop<span class="op">;</span></span>
<span id="cb35-1377"><a href="#cb35-1377" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="op">[</span>start<span class="op">,</span> stop<span class="op">,</span> step<span class="op">]</span></span>
<span id="cb35-1378"><a href="#cb35-1378" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1379"><a href="#cb35-1379" aria-hidden="true" tabindex="-1"></a>function <span class="fu">decodeSpread</span><span class="op">(</span>spread<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1380"><a href="#cb35-1380" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> spread<span class="op">.</span><span class="fu">replace</span><span class="op">(/^&lt;/,</span> <span class="st">"366&lt;"</span><span class="op">).</span><span class="fu">replace</span><span class="op">(/^&gt;/,</span> <span class="st">"0&gt;"</span><span class="op">)</span></span>
<span id="cb35-1381"><a href="#cb35-1381" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">split</span><span class="op">(/(?=^</span>\d<span class="op">|&lt;|&gt;)/).</span><span class="fu">map</span><span class="op">(</span>s <span class="op">=&gt;</span> s<span class="op">.</span><span class="fu">replace</span><span class="op">(</span><span class="st">"&lt;"</span><span class="op">,</span> <span class="st">"-"</span><span class="op">)</span></span>
<span id="cb35-1382"><a href="#cb35-1382" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">replace</span><span class="op">(</span><span class="st">"&gt;"</span><span class="op">,</span> <span class="st">""</span><span class="op">)).</span><span class="fu">map</span><span class="op">(</span>s <span class="op">=&gt;</span> s <span class="op">===</span> <span class="st">""</span> <span class="op">||</span> <span class="fu">isNaN</span><span class="op">(</span>s<span class="op">)</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span><span class="op">(</span>s<span class="op">))</span></span>
<span id="cb35-1383"><a href="#cb35-1383" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1384"><a href="#cb35-1384" aria-hidden="true" tabindex="-1"></a>function <span class="fu">encodeSpread</span><span class="op">(</span>args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1385"><a href="#cb35-1385" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> args<span class="op">.</span><span class="fu">map</span><span class="op">(</span>a <span class="op">=&gt;</span> <span class="fu">isNaN</span><span class="op">(</span>a<span class="op">)</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> a<span class="op">).</span><span class="fu">join</span><span class="op">(</span><span class="st">"&gt;"</span><span class="op">).</span><span class="fu">replace</span><span class="op">(</span><span class="st">"&gt;-"</span><span class="op">,</span> <span class="st">"&lt;"</span><span class="op">)</span></span>
<span id="cb35-1386"><a href="#cb35-1386" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1387"><a href="#cb35-1387" aria-hidden="true" tabindex="-1"></a>function <span class="fu">slice</span><span class="op">(</span>self<span class="op">,</span> start<span class="op">,</span> stop<span class="op">,</span> steps<span class="op">,</span> <span class="kw">...</span>args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1388"><a href="#cb35-1388" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> len <span class="op">=</span> self<span class="op">.</span><span class="fu">length</span><span class="op">,</span> result <span class="op">=</span> <span class="op">[];</span></span>
<span id="cb35-1389"><a href="#cb35-1389" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>steps <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> len <span class="op">===</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> result <span class="op">};</span></span>
<span id="cb35-1390"><a href="#cb35-1390" aria-hidden="true" tabindex="-1"></a>  steps <span class="op">=</span> <span class="op">(!</span>steps <span class="op">||</span> steps<span class="op">.</span><span class="fu">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">:</span></span>
<span id="cb35-1391"><a href="#cb35-1391" aria-hidden="true" tabindex="-1"></a>    typeof steps <span class="op">===</span> <span class="st">"number"</span> <span class="op">?</span> <span class="op">[</span>steps<span class="op">]</span> <span class="op">:</span></span>
<span id="cb35-1392"><a href="#cb35-1392" aria-hidden="true" tabindex="-1"></a>    typeof steps <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span><span class="op">(</span>steps<span class="op">,</span> <span class="bu">Number</span><span class="op">)</span> <span class="op">:</span></span>
<span id="cb35-1393"><a href="#cb35-1393" aria-hidden="true" tabindex="-1"></a>    steps<span class="op">).</span><span class="fu">concat</span><span class="op">(</span>args<span class="op">.</span><span class="fu">map</span><span class="op">(</span>i <span class="op">=&gt;</span> i <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> i<span class="op">));</span></span>
<span id="cb35-1394"><a href="#cb35-1394" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> stepCount <span class="op">=</span> steps<span class="op">.</span><span class="fu">length</span><span class="op">,</span></span>
<span id="cb35-1395"><a href="#cb35-1395" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">=</span> steps<span class="op">.</span><span class="fu">reduce</span><span class="op">((</span>a<span class="op">,</span> b<span class="op">)</span> <span class="op">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb35-1396"><a href="#cb35-1396" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>stepSum <span class="op">===</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> result <span class="op">};</span></span>
<span id="cb35-1397"><a href="#cb35-1397" aria-hidden="true" tabindex="-1"></a>  start <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span></span>
<span id="cb35-1398"><a href="#cb35-1398" aria-hidden="true" tabindex="-1"></a>    start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span></span>
<span id="cb35-1399"><a href="#cb35-1399" aria-hidden="true" tabindex="-1"></a>    start <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span></span>
<span id="cb35-1400"><a href="#cb35-1400" aria-hidden="true" tabindex="-1"></a>    start <span class="op">&gt;=</span> len <span class="op">?</span> len <span class="op">-</span> <span class="dv">1</span> <span class="op">:</span></span>
<span id="cb35-1401"><a href="#cb35-1401" aria-hidden="true" tabindex="-1"></a>    start <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> start <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb35-1402"><a href="#cb35-1402" aria-hidden="true" tabindex="-1"></a>    start<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb35-1403"><a href="#cb35-1403" aria-hidden="true" tabindex="-1"></a>  stop <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span></span>
<span id="cb35-1404"><a href="#cb35-1404" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb35-1405"><a href="#cb35-1405" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> stepSum <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span><span class="dv">1</span> <span class="op">:</span></span>
<span id="cb35-1406"><a href="#cb35-1406" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">&gt;=</span> len <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb35-1407"><a href="#cb35-1407" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> stop <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb35-1408"><a href="#cb35-1408" aria-hidden="true" tabindex="-1"></a>    stop<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb35-1409"><a href="#cb35-1409" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span></span>
<span id="cb35-1410"><a href="#cb35-1410" aria-hidden="true" tabindex="-1"></a>    let i <span class="op">=</span> start<span class="op">,</span> counter <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb35-1411"><a href="#cb35-1411" aria-hidden="true" tabindex="-1"></a>    stepSum <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> i <span class="op">&lt;</span> stop <span class="op">:</span> i <span class="op">&gt;</span> stop<span class="op">;</span></span>
<span id="cb35-1412"><a href="#cb35-1412" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> steps<span class="op">[</span>counter<span class="op">]</span></span>
<span id="cb35-1413"><a href="#cb35-1413" aria-hidden="true" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1414"><a href="#cb35-1414" aria-hidden="true" tabindex="-1"></a>    result<span class="op">.</span><span class="fu">push</span><span class="op">(</span>self<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb35-1415"><a href="#cb35-1415" aria-hidden="true" tabindex="-1"></a>    counter <span class="op">=</span> <span class="op">(</span>counter <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> stepCount<span class="op">;</span></span>
<span id="cb35-1416"><a href="#cb35-1416" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1417"><a href="#cb35-1417" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb35-1418"><a href="#cb35-1418" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1419"><a href="#cb35-1419" aria-hidden="true" tabindex="-1"></a>function <span class="fu">spread</span><span class="op">(</span>self<span class="op">,</span> startOrStop<span class="op">,</span> span<span class="op">,</span> splitsAndSpaces<span class="op">,</span> <span class="kw">...</span>args<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1420"><a href="#cb35-1420" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> len <span class="op">=</span> self<span class="op">.</span><span class="fu">length</span><span class="op">,</span> result <span class="op">=</span> <span class="op">[];</span></span>
<span id="cb35-1421"><a href="#cb35-1421" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>span <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> len <span class="op">===</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> result <span class="op">};</span></span>
<span id="cb35-1422"><a href="#cb35-1422" aria-hidden="true" tabindex="-1"></a>  splitsAndSpaces <span class="op">=</span> <span class="op">(!</span>splitsAndSpaces <span class="op">||</span> splitsAndSpaces<span class="op">.</span><span class="fu">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">:</span></span>
<span id="cb35-1423"><a href="#cb35-1423" aria-hidden="true" tabindex="-1"></a>    typeof splitsAndSpaces <span class="op">===</span> <span class="st">"number"</span> <span class="op">?</span> <span class="op">[</span>splitsAndSpaces<span class="op">]</span> <span class="op">:</span></span>
<span id="cb35-1424"><a href="#cb35-1424" aria-hidden="true" tabindex="-1"></a>    typeof splitsAndSpaces <span class="op">===</span> <span class="st">"string"</span> <span class="op">?</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span><span class="op">(</span>splitsAndSpaces<span class="op">,</span> <span class="bu">Number</span><span class="op">)</span> <span class="op">:</span></span>
<span id="cb35-1425"><a href="#cb35-1425" aria-hidden="true" tabindex="-1"></a>    splitsAndSpaces<span class="op">).</span><span class="fu">concat</span><span class="op">(</span>args<span class="op">.</span><span class="fu">map</span><span class="op">(</span>i <span class="op">=&gt;</span> i <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> i<span class="op">));</span></span>
<span id="cb35-1426"><a href="#cb35-1426" aria-hidden="true" tabindex="-1"></a>    <span class="dt">const</span> splitCount <span class="op">=</span> splitsAndSpaces<span class="op">.</span><span class="fu">length</span><span class="op">,</span></span>
<span id="cb35-1427"><a href="#cb35-1427" aria-hidden="true" tabindex="-1"></a>    splitSpaceSum <span class="op">=</span> splitsAndSpaces<span class="op">.</span><span class="fu">reduce</span><span class="op">((</span>a<span class="op">,</span> b<span class="op">)</span> <span class="op">=&gt;</span> a <span class="op">+</span> b<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb35-1428"><a href="#cb35-1428" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>splitSpaceSum <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> result <span class="op">};</span></span>
<span id="cb35-1429"><a href="#cb35-1429" aria-hidden="true" tabindex="-1"></a>  startOrStop <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span><span class="op">(</span></span>
<span id="cb35-1430"><a href="#cb35-1430" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">||</span> startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> span <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span></span>
<span id="cb35-1431"><a href="#cb35-1431" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> startOrStop <span class="op">&gt;</span> len <span class="op">&amp;&amp;</span> span <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> len <span class="op">:</span></span>
<span id="cb35-1432"><a href="#cb35-1432" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">+</span> len <span class="op">:</span></span>
<span id="cb35-1433"><a href="#cb35-1433" aria-hidden="true" tabindex="-1"></a>    startOrStop<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb35-1434"><a href="#cb35-1434" aria-hidden="true" tabindex="-1"></a>  span <span class="op">=</span> span <span class="op">==</span> <span class="kw">null</span> <span class="op">||</span> startOrStop <span class="op">+</span> span <span class="op">&gt;</span> len <span class="op">?</span> len <span class="op">-</span> startOrStop <span class="op">:</span></span>
<span id="cb35-1435"><a href="#cb35-1435" aria-hidden="true" tabindex="-1"></a>    startOrStop <span class="op">+</span> span <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="op">-</span>startOrStop<span class="op">:</span> span<span class="op">;</span></span>
<span id="cb35-1436"><a href="#cb35-1436" aria-hidden="true" tabindex="-1"></a>  <span class="dt">const</span> start <span class="op">=</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">:</span> startOrStop <span class="op">+</span> span<span class="op">,</span></span>
<span id="cb35-1437"><a href="#cb35-1437" aria-hidden="true" tabindex="-1"></a>    stop <span class="op">=</span> span <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> startOrStop <span class="op">+</span> span <span class="op">:</span> startOrStop<span class="op">;</span></span>
<span id="cb35-1438"><a href="#cb35-1438" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>let i <span class="op">=</span> start<span class="op">,</span> c <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> arr <span class="op">=</span> <span class="op">[];</span> i <span class="op">&lt;</span> stop<span class="op">;</span> i <span class="op">+=</span> splitsAndSpaces<span class="op">[</span>c<span class="op">])</span> <span class="op">{</span></span>
<span id="cb35-1439"><a href="#cb35-1439" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span>c <span class="op">=</span> <span class="op">(</span>c <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">%</span> splitCount<span class="op">)</span> <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> i <span class="op">+</span> splitsAndSpaces<span class="op">[</span>c<span class="op">]</span> <span class="op">&lt;=</span> stop<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1440"><a href="#cb35-1440" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">((</span>arr <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span><span class="op">({</span>length<span class="op">:</span> splitsAndSpaces<span class="op">[</span>c<span class="op">]},</span> <span class="op">(</span>_<span class="op">,</span> j<span class="op">)</span> <span class="op">=&gt;</span> j <span class="op">+</span> i<span class="op">).</span><span class="fu">map</span><span class="op">(</span></span>
<span id="cb35-1441"><a href="#cb35-1441" aria-hidden="true" tabindex="-1"></a>        index <span class="op">=&gt;</span> self<span class="op">[</span>index<span class="op">]).</span><span class="fu">filter</span><span class="op">(</span>item <span class="op">=&gt;</span> item <span class="op">!==</span> undefined<span class="op">)</span></span>
<span id="cb35-1442"><a href="#cb35-1442" aria-hidden="true" tabindex="-1"></a>          <span class="op">).</span><span class="fu">length</span> <span class="op">==</span> splitsAndSpaces<span class="op">[</span>c<span class="op">])</span> <span class="op">{</span> result<span class="op">.</span><span class="fu">push</span><span class="op">(</span>arr<span class="op">)</span> <span class="op">}</span></span>
<span id="cb35-1443"><a href="#cb35-1443" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb35-1444"><a href="#cb35-1444" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-1445"><a href="#cb35-1445" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb35-1446"><a href="#cb35-1446" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1447"><a href="#cb35-1447" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-1448"><a href="#cb35-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1449"><a href="#cb35-1449" aria-hidden="true" tabindex="-1"></a>##### Variables <span class="op">{.</span><span class="fu">appendix</span><span class="op">}</span></span>
<span id="cb35-1450"><a href="#cb35-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1453"><a href="#cb35-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1454"><a href="#cb35-1454" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: all</span></span>
<span id="cb35-1455"><a href="#cb35-1455" aria-hidden="true" tabindex="-1"></a>nested <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span><span class="op">({</span>length<span class="op">:</span> intervals<span class="op">.</span><span class="fu">length</span><span class="op">},</span> <span class="op">(</span>_<span class="op">,</span> i<span class="op">)</span> <span class="op">=&gt;</span> <span class="op">([</span></span>
<span id="cb35-1456"><a href="#cb35-1456" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb35-1457"><a href="#cb35-1457" aria-hidden="true" tabindex="-1"></a>  label<span class="op">:</span> `$<span class="op">{</span>i<span class="op">}</span> or $<span class="op">{</span>i<span class="op">+</span><span class="dv">5</span><span class="op">}</span>`<span class="op">,</span></span>
<span id="cb35-1458"><a href="#cb35-1458" aria-hidden="true" tabindex="-1"></a>  duration<span class="op">:</span> intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">!==</span> intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">?</span> intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb35-1459"><a href="#cb35-1459" aria-hidden="true" tabindex="-1"></a>  group<span class="op">:</span> <span class="st">"Rest"</span></span>
<span id="cb35-1460"><a href="#cb35-1460" aria-hidden="true" tabindex="-1"></a><span class="op">},</span></span>
<span id="cb35-1461"><a href="#cb35-1461" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb35-1462"><a href="#cb35-1462" aria-hidden="true" tabindex="-1"></a>  label<span class="op">:</span> `$<span class="op">{</span>i<span class="op">}</span> or $<span class="op">{</span>i<span class="op">+</span><span class="dv">5</span><span class="op">}</span>`<span class="op">,</span></span>
<span id="cb35-1463"><a href="#cb35-1463" aria-hidden="true" tabindex="-1"></a>  duration<span class="op">:</span> intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">1</span><span class="op">]-</span>intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb35-1464"><a href="#cb35-1464" aria-hidden="true" tabindex="-1"></a>  group<span class="op">:</span> <span class="st">"Work"</span></span>
<span id="cb35-1465"><a href="#cb35-1465" aria-hidden="true" tabindex="-1"></a><span class="op">},</span></span>
<span id="cb35-1466"><a href="#cb35-1466" aria-hidden="true" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb35-1467"><a href="#cb35-1467" aria-hidden="true" tabindex="-1"></a>  label<span class="op">:</span> `$<span class="op">{</span>i<span class="op">}</span> or $<span class="op">{</span>i<span class="op">+</span><span class="dv">5</span><span class="op">}</span>`<span class="op">,</span></span>
<span id="cb35-1468"><a href="#cb35-1468" aria-hidden="true" tabindex="-1"></a>  duration<span class="op">:</span> intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">!==</span> intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">?</span> <span class="dv">1</span><span class="op">-</span>intervals<span class="op">[</span>i<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb35-1469"><a href="#cb35-1469" aria-hidden="true" tabindex="-1"></a>  group<span class="op">:</span> <span class="st">"Rest"</span></span>
<span id="cb35-1470"><a href="#cb35-1470" aria-hidden="true" tabindex="-1"></a>  <span class="op">}]))</span></span>
<span id="cb35-1471"><a href="#cb35-1471" aria-hidden="true" tabindex="-1"></a>durations <span class="op">=</span> <span class="op">[].</span><span class="fu">concat</span><span class="op">(</span><span class="kw">...</span>nested<span class="op">)</span></span>
<span id="cb35-1472"><a href="#cb35-1472" aria-hidden="true" tabindex="-1"></a>theme_Flat <span class="op">=</span> `</span>
<span id="cb35-1473"><a href="#cb35-1473" aria-hidden="true" tabindex="-1"></a><span class="co">/* Options */</span></span>
<span id="cb35-1474"><a href="#cb35-1474" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">{</span></span>
<span id="cb35-1475"><a href="#cb35-1475" aria-hidden="true" tabindex="-1"></a>  color<span class="op">:</span> #<span class="er">3</span>b99fc<span class="op">;</span></span>
<span id="cb35-1476"><a href="#cb35-1476" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="er">240</span>px<span class="op">;</span></span>
<span id="cb35-1477"><a href="#cb35-1477" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1478"><a href="#cb35-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1479"><a href="#cb35-1479" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">{</span></span>
<span id="cb35-1480"><a href="#cb35-1480" aria-hidden="true" tabindex="-1"></a>  position<span class="op">:</span> relative<span class="op">;</span></span>
<span id="cb35-1481"><a href="#cb35-1481" aria-hidden="true" tabindex="-1"></a>  display<span class="op">:</span> inline<span class="op">-</span>block<span class="op">;</span></span>
<span id="cb35-1482"><a href="#cb35-1482" aria-hidden="true" tabindex="-1"></a>  <span class="op">--</span>thumb<span class="op">-</span>size<span class="op">:</span> <span class="er">15</span>px<span class="op">;</span></span>
<span id="cb35-1483"><a href="#cb35-1483" aria-hidden="true" tabindex="-1"></a>  <span class="op">--</span>thumb<span class="op">-</span>radius<span class="op">:</span> <span class="fu">calc</span><span class="op">(</span><span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>size<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb35-1484"><a href="#cb35-1484" aria-hidden="true" tabindex="-1"></a>  padding<span class="op">:</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>radius<span class="op">)</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-1485"><a href="#cb35-1485" aria-hidden="true" tabindex="-1"></a>  margin<span class="op">:</span> <span class="er">2</span>px<span class="op">;</span></span>
<span id="cb35-1486"><a href="#cb35-1486" aria-hidden="true" tabindex="-1"></a>  vertical<span class="op">-</span>align<span class="op">:</span> middle<span class="op">;</span></span>
<span id="cb35-1487"><a href="#cb35-1487" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1488"><a href="#cb35-1488" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">range</span><span class="op">-</span>track <span class="op">{</span></span>
<span id="cb35-1489"><a href="#cb35-1489" aria-hidden="true" tabindex="-1"></a>  box<span class="op">-</span>sizing<span class="op">:</span> border<span class="op">-</span>box<span class="op">;</span></span>
<span id="cb35-1490"><a href="#cb35-1490" aria-hidden="true" tabindex="-1"></a>  position<span class="op">:</span> relative<span class="op">;</span></span>
<span id="cb35-1491"><a href="#cb35-1491" aria-hidden="true" tabindex="-1"></a>  height<span class="op">:</span> <span class="er">7</span>px<span class="op">;</span></span>
<span id="cb35-1492"><a href="#cb35-1492" aria-hidden="true" tabindex="-1"></a>  background<span class="op">-</span>color<span class="op">:</span> <span class="fu">hsl</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">%,</span> <span class="dv">80</span><span class="op">%);</span></span>
<span id="cb35-1493"><a href="#cb35-1493" aria-hidden="true" tabindex="-1"></a>  overflow<span class="op">:</span> visible<span class="op">;</span></span>
<span id="cb35-1494"><a href="#cb35-1494" aria-hidden="true" tabindex="-1"></a>  border<span class="op">-</span>radius<span class="op">:</span> <span class="er">4</span>px<span class="op">;</span></span>
<span id="cb35-1495"><a href="#cb35-1495" aria-hidden="true" tabindex="-1"></a>  padding<span class="op">:</span> <span class="dv">0</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>radius<span class="op">);</span></span>
<span id="cb35-1496"><a href="#cb35-1496" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1497"><a href="#cb35-1497" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">range</span><span class="op">-</span>track<span class="op">-</span>zone <span class="op">{</span></span>
<span id="cb35-1498"><a href="#cb35-1498" aria-hidden="true" tabindex="-1"></a>  box<span class="op">-</span>sizing<span class="op">:</span> border<span class="op">-</span>box<span class="op">;</span></span>
<span id="cb35-1499"><a href="#cb35-1499" aria-hidden="true" tabindex="-1"></a>  position<span class="op">:</span> relative<span class="op">;</span></span>
<span id="cb35-1500"><a href="#cb35-1500" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1501"><a href="#cb35-1501" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">range</span><span class="op">-</span>select <span class="op">{</span></span>
<span id="cb35-1502"><a href="#cb35-1502" aria-hidden="true" tabindex="-1"></a>  box<span class="op">-</span>sizing<span class="op">:</span> border<span class="op">-</span>box<span class="op">;</span></span>
<span id="cb35-1503"><a href="#cb35-1503" aria-hidden="true" tabindex="-1"></a>  position<span class="op">:</span> relative<span class="op">;</span></span>
<span id="cb35-1504"><a href="#cb35-1504" aria-hidden="true" tabindex="-1"></a>  left<span class="op">:</span> <span class="dt">var</span><span class="op">(--</span>range<span class="op">-</span>min<span class="op">);</span></span>
<span id="cb35-1505"><a href="#cb35-1505" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="fu">calc</span><span class="op">(</span><span class="dt">var</span><span class="op">(--</span>range<span class="op">-</span>max<span class="op">)</span> <span class="op">-</span> <span class="dt">var</span><span class="op">(--</span>range<span class="op">-</span>min<span class="op">));</span></span>
<span id="cb35-1506"><a href="#cb35-1506" aria-hidden="true" tabindex="-1"></a>  cursor<span class="op">:</span> ew<span class="op">-</span>resize<span class="op">;</span></span>
<span id="cb35-1507"><a href="#cb35-1507" aria-hidden="true" tabindex="-1"></a>  background<span class="op">:</span> currentColor<span class="op">;</span></span>
<span id="cb35-1508"><a href="#cb35-1508" aria-hidden="true" tabindex="-1"></a>  height<span class="op">:</span> <span class="er">7</span>px<span class="op">;</span></span>
<span id="cb35-1509"><a href="#cb35-1509" aria-hidden="true" tabindex="-1"></a>  border<span class="op">:</span> inherit<span class="op">;</span></span>
<span id="cb35-1510"><a href="#cb35-1510" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1511"><a href="#cb35-1511" aria-hidden="true" tabindex="-1"></a><span class="co">/* Expands the hotspot area. */</span></span>
<span id="cb35-1512"><a href="#cb35-1512" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">range</span><span class="op">-</span>select<span class="op">:</span>before <span class="op">{</span></span>
<span id="cb35-1513"><a href="#cb35-1513" aria-hidden="true" tabindex="-1"></a>  content<span class="op">:</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb35-1514"><a href="#cb35-1514" aria-hidden="true" tabindex="-1"></a>  position<span class="op">:</span> absolute<span class="op">;</span></span>
<span id="cb35-1515"><a href="#cb35-1515" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb35-1516"><a href="#cb35-1516" aria-hidden="true" tabindex="-1"></a>  height<span class="op">:</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>size<span class="op">);</span></span>
<span id="cb35-1517"><a href="#cb35-1517" aria-hidden="true" tabindex="-1"></a>  left<span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-1518"><a href="#cb35-1518" aria-hidden="true" tabindex="-1"></a>  top<span class="op">:</span> <span class="fu">calc</span><span class="op">(</span><span class="er">2</span>px <span class="op">-</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>radius<span class="op">));</span></span>
<span id="cb35-1519"><a href="#cb35-1519" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1520"><a href="#cb35-1520" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">range</span><span class="op">-</span>select<span class="op">:</span>focus<span class="op">,</span></span>
<span id="cb35-1521"><a href="#cb35-1521" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">thumb</span><span class="op">:</span>focus <span class="op">{</span></span>
<span id="cb35-1522"><a href="#cb35-1522" aria-hidden="true" tabindex="-1"></a>  outline<span class="op">:</span> none<span class="op">;</span></span>
<span id="cb35-1523"><a href="#cb35-1523" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1524"><a href="#cb35-1524" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">thumb</span> <span class="op">{</span></span>
<span id="cb35-1525"><a href="#cb35-1525" aria-hidden="true" tabindex="-1"></a>  box<span class="op">-</span>sizing<span class="op">:</span> border<span class="op">-</span>box<span class="op">;</span></span>
<span id="cb35-1526"><a href="#cb35-1526" aria-hidden="true" tabindex="-1"></a>  position<span class="op">:</span> absolute<span class="op">;</span></span>
<span id="cb35-1527"><a href="#cb35-1527" aria-hidden="true" tabindex="-1"></a>  width<span class="op">:</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>size<span class="op">);</span></span>
<span id="cb35-1528"><a href="#cb35-1528" aria-hidden="true" tabindex="-1"></a>  height<span class="op">:</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>size<span class="op">);</span></span>
<span id="cb35-1529"><a href="#cb35-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1530"><a href="#cb35-1530" aria-hidden="true" tabindex="-1"></a>  background<span class="op">:</span> #fcfcfc<span class="op">;</span></span>
<span id="cb35-1531"><a href="#cb35-1531" aria-hidden="true" tabindex="-1"></a>  top<span class="op">:</span> <span class="op">-</span><span class="er">4</span>px<span class="op">;</span></span>
<span id="cb35-1532"><a href="#cb35-1532" aria-hidden="true" tabindex="-1"></a>  border<span class="op">-</span>radius<span class="op">:</span> <span class="dv">100</span><span class="op">%;</span></span>
<span id="cb35-1533"><a href="#cb35-1533" aria-hidden="true" tabindex="-1"></a>  border<span class="op">:</span> <span class="er">1</span>px solid <span class="fu">hsl</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">%,</span><span class="dv">55</span><span class="op">%);</span></span>
<span id="cb35-1534"><a href="#cb35-1534" aria-hidden="true" tabindex="-1"></a>  cursor<span class="op">:</span> <span class="kw">default</span><span class="op">;</span></span>
<span id="cb35-1535"><a href="#cb35-1535" aria-hidden="true" tabindex="-1"></a>  margin<span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-1536"><a href="#cb35-1536" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1537"><a href="#cb35-1537" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">thumb</span><span class="op">:</span>active <span class="op">{</span></span>
<span id="cb35-1538"><a href="#cb35-1538" aria-hidden="true" tabindex="-1"></a>  box<span class="op">-</span>shadow<span class="op">:</span> inset <span class="dv">0</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>size<span class="op">)</span> #<span class="bn">0002</span><span class="op">;</span></span>
<span id="cb35-1539"><a href="#cb35-1539" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1540"><a href="#cb35-1540" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">thumb</span><span class="op">-</span>min <span class="op">{</span></span>
<span id="cb35-1541"><a href="#cb35-1541" aria-hidden="true" tabindex="-1"></a>  left<span class="op">:</span> <span class="fu">calc</span><span class="op">(-</span><span class="er">1</span>px <span class="op">-</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>radius<span class="op">));</span></span>
<span id="cb35-1542"><a href="#cb35-1542" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1543"><a href="#cb35-1543" aria-hidden="true" tabindex="-1"></a><span class="op">:</span>scope <span class="op">.</span><span class="fu">thumb</span><span class="op">-</span>max <span class="op">{</span></span>
<span id="cb35-1544"><a href="#cb35-1544" aria-hidden="true" tabindex="-1"></a>  right<span class="op">:</span> <span class="fu">calc</span><span class="op">(-</span><span class="er">1</span>px <span class="op">-</span> <span class="dt">var</span><span class="op">(--</span>thumb<span class="op">-</span>radius<span class="op">));</span></span>
<span id="cb35-1545"><a href="#cb35-1545" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1546"><a href="#cb35-1546" aria-hidden="true" tabindex="-1"></a>`</span>
<span id="cb35-1547"><a href="#cb35-1547" aria-hidden="true" tabindex="-1"></a>schedules <span class="op">=</span> <span class="op">[</span></span>
<span id="cb35-1548"><a href="#cb35-1548" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="fl">.2</span><span class="op">,</span> <span class="fl">.8</span><span class="op">],</span> <span class="op">[</span><span class="fl">.2</span><span class="op">,</span> <span class="fl">.8</span><span class="op">],</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">],</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">],</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">]],</span></span>
<span id="cb35-1549"><a href="#cb35-1549" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="fl">.3</span><span class="op">,</span> <span class="fl">.7</span><span class="op">],</span> <span class="op">[</span><span class="fl">.3</span><span class="op">,</span> <span class="fl">.7</span><span class="op">],</span> <span class="op">[</span><span class="fl">.3</span><span class="op">,</span> <span class="fl">.7</span><span class="op">],</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">],</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">]],</span></span>
<span id="cb35-1550"><a href="#cb35-1550" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="fl">.35</span><span class="op">,</span> <span class="fl">.65</span><span class="op">],</span> <span class="op">[</span><span class="fl">.35</span><span class="op">,</span> <span class="fl">.65</span><span class="op">],</span> <span class="op">[</span><span class="fl">.35</span><span class="op">,</span> <span class="fl">.65</span><span class="op">],</span> <span class="op">[</span><span class="fl">.35</span><span class="op">,</span> <span class="fl">.65</span><span class="op">],</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">]],</span></span>
<span id="cb35-1551"><a href="#cb35-1551" aria-hidden="true" tabindex="-1"></a>  <span class="op">[[</span><span class="fl">.38</span><span class="op">,</span> <span class="fl">.62</span><span class="op">],</span> <span class="op">[</span><span class="fl">.38</span><span class="op">,</span> <span class="fl">.62</span><span class="op">],</span> <span class="op">[</span><span class="fl">.38</span><span class="op">,</span> <span class="fl">.62</span><span class="op">],</span> <span class="op">[</span><span class="fl">.38</span><span class="op">,</span> <span class="fl">.62</span><span class="op">],</span> <span class="op">[</span><span class="fl">.38</span><span class="op">,</span> <span class="fl">.62</span><span class="op">]],</span></span>
<span id="cb35-1552"><a href="#cb35-1552" aria-hidden="true" tabindex="-1"></a><span class="op">]</span></span>
<span id="cb35-1553"><a href="#cb35-1553" aria-hidden="true" tabindex="-1"></a>dates <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span><span class="op">({</span>length<span class="op">:</span> <span class="dv">366</span><span class="op">},</span> <span class="op">(</span>_<span class="op">,</span> i<span class="op">)</span> <span class="op">=&gt;</span> i<span class="op">.</span><span class="fu">toString</span><span class="op">().</span><span class="fu">padStart</span><span class="op">(</span><span class="dv">3</span><span class="op">,</span> <span class="st">"0"</span><span class="op">))</span></span>
<span id="cb35-1554"><a href="#cb35-1554" aria-hidden="true" tabindex="-1"></a>sliceArray <span class="op">=</span> <span class="fu">slice</span><span class="op">(</span>dates<span class="op">,</span> <span class="kw">...</span>sliceString<span class="op">.</span><span class="fu">split</span><span class="op">(</span><span class="st">":"</span><span class="op">).</span><span class="fu">map</span><span class="op">(</span>i <span class="op">=&gt;</span> i <span class="op">===</span> <span class="st">""</span> <span class="op">?</span> <span class="kw">null</span> <span class="op">:</span> <span class="bu">Number</span><span class="op">(</span>i<span class="op">)))</span></span>
<span id="cb35-1555"><a href="#cb35-1555" aria-hidden="true" tabindex="-1"></a>spreadArray <span class="op">=</span> <span class="op">[].</span><span class="fu">concat</span><span class="op">(</span><span class="kw">...</span><span class="fu">spread</span><span class="op">(</span>dates<span class="op">,</span> <span class="kw">...</span><span class="fu">decodeSpread</span><span class="op">(</span>spreadString<span class="op">)))</span></span>
<span id="cb35-1556"><a href="#cb35-1556" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-1557"><a href="#cb35-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1558"><a href="#cb35-1558" aria-hidden="true" tabindex="-1"></a>##### <span class="bu">Set</span> values <span class="op">{.</span><span class="fu">appendix</span><span class="op">}</span></span>
<span id="cb35-1559"><a href="#cb35-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1562"><a href="#cb35-1562" aria-hidden="true" tabindex="-1"></a><span class="in">```{ojs}</span></span>
<span id="cb35-1563"><a href="#cb35-1563" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: false</span></span>
<span id="cb35-1564"><a href="#cb35-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">set</span><span class="op">(</span>viewof intervals<span class="op">,</span> schedules<span class="op">[</span>schedule<span class="op">-</span><span class="dv">2</span><span class="op">])</span></span>
<span id="cb35-1565"><a href="#cb35-1565" aria-hidden="true" tabindex="-1"></a><span class="fu">set</span><span class="op">(</span>viewof spreadString<span class="op">,</span> <span class="fu">setSpreadDotd</span><span class="op">(</span>spreadDotd<span class="op">))</span></span>
<span id="cb35-1566"><a href="#cb35-1566" aria-hidden="true" tabindex="-1"></a><span class="fu">set</span><span class="op">(</span>viewof sliceString<span class="op">,</span> <span class="fu">setSliceDotd</span><span class="op">(</span>sliceDotd<span class="op">))</span></span>
<span id="cb35-1567"><a href="#cb35-1567" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb35-1568"><a href="#cb35-1568" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>invertDotd <span class="op">?</span> <span class="op">!</span>sliceOrSpread <span class="op">:</span> sliceOrSpread<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-1569"><a href="#cb35-1569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span><span class="op">(</span>viewof sliceDotd<span class="op">,</span> <span class="fu">invert</span><span class="op">(</span>togglePlot<span class="op">))</span></span>
<span id="cb35-1570"><a href="#cb35-1570" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb35-1571"><a href="#cb35-1571" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set</span><span class="op">(</span>viewof spreadDotd<span class="op">,</span> <span class="fu">invert</span><span class="op">(</span>togglePlot<span class="op">))</span></span>
<span id="cb35-1572"><a href="#cb35-1572" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb35-1573"><a href="#cb35-1573" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb35-1574"><a href="#cb35-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1575"><a href="#cb35-1575" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb35-1576"><a href="#cb35-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1577"><a href="#cb35-1577" aria-hidden="true" tabindex="-1"></a># References</span>
<span id="cb35-1578"><a href="#cb35-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1579"><a href="#cb35-1579" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span> <span class="op">{</span>#refs<span class="op">}</span></span>
<span id="cb35-1580"><a href="#cb35-1580" aria-hidden="true" tabindex="-1"></a><span class="op">:::</span></span>
<span id="cb35-1581"><a href="#cb35-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1582"><a href="#cb35-1582" aria-hidden="true" tabindex="-1"></a># Appendix <span class="op">{</span>#appendix<span class="op">}</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Martin Laptev</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/maptv/maptv.github.io/blob/main/observable/index.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maptv" target="_blank">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/maptv" target="_blank">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link active" href="mailto:maptv@engineer.com" aria-current="page">
      <i class="bi bi-envelope-at" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>